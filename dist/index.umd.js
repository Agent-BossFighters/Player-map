(function(da,gi){typeof exports=="object"&&typeof module<"u"?gi(exports,require("react")):typeof define=="function"&&define.amd?define(["exports","react"],gi):(da=typeof globalThis<"u"?globalThis:da||self,gi(da.PlayerMap={},da.React))})(this,function(da,gi){"use strict";var bRe=Object.defineProperty;var _Re=(da,gi,Rh)=>gi in da?bRe(da,gi,{enumerable:!0,configurable:!0,writable:!0,value:Rh}):da[gi]=Rh;var N0=(da,gi,Rh)=>_Re(da,typeof gi!="symbol"?gi+"":gi,Rh);var Rh={exports:{}},O0={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hL;function AH(){if(hL)return O0;hL=1;var r=gi,e=Symbol.for("react.element"),i=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function l(u,c,h){var p,f={},m=null,g=null;h!==void 0&&(m=""+h),c.key!==void 0&&(m=""+c.key),c.ref!==void 0&&(g=c.ref);for(p in c)n.call(c,p)&&!o.hasOwnProperty(p)&&(f[p]=c[p]);if(u&&u.defaultProps)for(p in c=u.defaultProps,c)f[p]===void 0&&(f[p]=c[p]);return{$$typeof:e,type:u,key:m,ref:g,props:f,_owner:s.current}}return O0.Fragment=i,O0.jsx=l,O0.jsxs=l,O0}var P0={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dL;function yH(){return dL||(dL=1,process.env.NODE_ENV!=="production"&&function(){var r=gi,e=Symbol.for("react.element"),i=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),u=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),p=Symbol.for("react.suspense_list"),f=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),g=Symbol.for("react.offscreen"),y=Symbol.iterator,x="@@iterator";function v(me){if(me===null||typeof me!="object")return null;var ct=y&&me[y]||me[x];return typeof ct=="function"?ct:null}var _=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function T(me){{for(var ct=arguments.length,St=new Array(ct>1?ct-1:0),Xt=1;Xt<ct;Xt++)St[Xt-1]=arguments[Xt];w("error",me,St)}}function w(me,ct,St){{var Xt=_.ReactDebugCurrentFrame,Bi=Xt.getStackAddendum();Bi!==""&&(ct+="%s",St=St.concat([Bi]));var ar=St.map(function(Li){return String(Li)});ar.unshift("Warning: "+ct),Function.prototype.apply.call(console[me],console,ar)}}var S=!1,R=!1,B=!1,I=!1,D=!1,L;L=Symbol.for("react.module.reference");function O(me){return!!(typeof me=="string"||typeof me=="function"||me===n||me===o||D||me===s||me===h||me===p||I||me===g||S||R||B||typeof me=="object"&&me!==null&&(me.$$typeof===m||me.$$typeof===f||me.$$typeof===l||me.$$typeof===u||me.$$typeof===c||me.$$typeof===L||me.getModuleId!==void 0))}function U(me,ct,St){var Xt=me.displayName;if(Xt)return Xt;var Bi=ct.displayName||ct.name||"";return Bi!==""?St+"("+Bi+")":St}function Z(me){return me.displayName||"Context"}function G(me){if(me==null)return null;if(typeof me.tag=="number"&&T("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof me=="function")return me.displayName||me.name||null;if(typeof me=="string")return me;switch(me){case n:return"Fragment";case i:return"Portal";case o:return"Profiler";case s:return"StrictMode";case h:return"Suspense";case p:return"SuspenseList"}if(typeof me=="object")switch(me.$$typeof){case u:var ct=me;return Z(ct)+".Consumer";case l:var St=me;return Z(St._context)+".Provider";case c:return U(me,me.render,"ForwardRef");case f:var Xt=me.displayName||null;return Xt!==null?Xt:G(me.type)||"Memo";case m:{var Bi=me,ar=Bi._payload,Li=Bi._init;try{return G(Li(ar))}catch{return null}}}return null}var z=Object.assign,$=0,Q,H,V,ne,Y,ae,xe;function fe(){}fe.__reactDisabledLog=!0;function de(){{if($===0){Q=console.log,H=console.info,V=console.warn,ne=console.error,Y=console.group,ae=console.groupCollapsed,xe=console.groupEnd;var me={configurable:!0,enumerable:!0,value:fe,writable:!0};Object.defineProperties(console,{info:me,log:me,warn:me,error:me,group:me,groupCollapsed:me,groupEnd:me})}$++}}function Ie(){{if($--,$===0){var me={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:z({},me,{value:Q}),info:z({},me,{value:H}),warn:z({},me,{value:V}),error:z({},me,{value:ne}),group:z({},me,{value:Y}),groupCollapsed:z({},me,{value:ae}),groupEnd:z({},me,{value:xe})})}$<0&&T("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var Ge=_.ReactCurrentDispatcher,Xe;function $e(me,ct,St){{if(Xe===void 0)try{throw Error()}catch(Bi){var Xt=Bi.stack.trim().match(/\n( *(at )?)/);Xe=Xt&&Xt[1]||""}return`
`+Xe+me}}var lt=!1,At;{var Gt=typeof WeakMap=="function"?WeakMap:Map;At=new Gt}function gt(me,ct){if(!me||lt)return"";{var St=At.get(me);if(St!==void 0)return St}var Xt;lt=!0;var Bi=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var ar;ar=Ge.current,Ge.current=null,de();try{if(ct){var Li=function(){throw Error()};if(Object.defineProperty(Li.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Li,[])}catch(ot){Xt=ot}Reflect.construct(me,[],Li)}else{try{Li.call()}catch(ot){Xt=ot}me.call(Li.prototype)}}else{try{throw Error()}catch(ot){Xt=ot}me()}}catch(ot){if(ot&&Xt&&typeof ot.stack=="string"){for(var Pi=ot.stack.split(`
`),Be=Xt.stack.split(`
`),se=Pi.length-1,ge=Be.length-1;se>=1&&ge>=0&&Pi[se]!==Be[ge];)ge--;for(;se>=1&&ge>=0;se--,ge--)if(Pi[se]!==Be[ge]){if(se!==1||ge!==1)do if(se--,ge--,ge<0||Pi[se]!==Be[ge]){var Ne=`
`+Pi[se].replace(" at new "," at ");return me.displayName&&Ne.includes("<anonymous>")&&(Ne=Ne.replace("<anonymous>",me.displayName)),typeof me=="function"&&At.set(me,Ne),Ne}while(se>=1&&ge>=0);break}}}finally{lt=!1,Ge.current=ar,Ie(),Error.prepareStackTrace=Bi}var Fe=me?me.displayName||me.name:"",Ke=Fe?$e(Fe):"";return typeof me=="function"&&At.set(me,Ke),Ke}function xi(me,ct,St){return gt(me,!1)}function Ze(me){var ct=me.prototype;return!!(ct&&ct.isReactComponent)}function Ui(me,ct,St){if(me==null)return"";if(typeof me=="function")return gt(me,Ze(me));if(typeof me=="string")return $e(me);switch(me){case h:return $e("Suspense");case p:return $e("SuspenseList")}if(typeof me=="object")switch(me.$$typeof){case c:return xi(me.render);case f:return Ui(me.type,ct,St);case m:{var Xt=me,Bi=Xt._payload,ar=Xt._init;try{return Ui(ar(Bi),ct,St)}catch{}}}return""}var di=Object.prototype.hasOwnProperty,Ii={},Ti=_.ReactDebugCurrentFrame;function ir(me){if(me){var ct=me._owner,St=Ui(me.type,me._source,ct?ct.type:null);Ti.setExtraStackFrame(St)}else Ti.setExtraStackFrame(null)}function Gi(me,ct,St,Xt,Bi){{var ar=Function.call.bind(di);for(var Li in me)if(ar(me,Li)){var Pi=void 0;try{if(typeof me[Li]!="function"){var Be=Error((Xt||"React class")+": "+St+" type `"+Li+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof me[Li]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw Be.name="Invariant Violation",Be}Pi=me[Li](ct,Li,Xt,St,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(se){Pi=se}Pi&&!(Pi instanceof Error)&&(ir(Bi),T("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",Xt||"React class",St,Li,typeof Pi),ir(null)),Pi instanceof Error&&!(Pi.message in Ii)&&(Ii[Pi.message]=!0,ir(Bi),T("Failed %s type: %s",St,Pi.message),ir(null))}}}var Qe=Array.isArray;function Ce(me){return Qe(me)}function yt(me){{var ct=typeof Symbol=="function"&&Symbol.toStringTag,St=ct&&me[Symbol.toStringTag]||me.constructor.name||"Object";return St}}function Ot(me){try{return Jt(me),!1}catch{return!0}}function Jt(me){return""+me}function zt(me){if(Ot(me))return T("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",yt(me)),Jt(me)}var _i=_.ReactCurrentOwner,vt={key:!0,ref:!0,__self:!0,__source:!0},ye,ve;function Le(me){if(di.call(me,"ref")){var ct=Object.getOwnPropertyDescriptor(me,"ref").get;if(ct&&ct.isReactWarning)return!1}return me.ref!==void 0}function Te(me){if(di.call(me,"key")){var ct=Object.getOwnPropertyDescriptor(me,"key").get;if(ct&&ct.isReactWarning)return!1}return me.key!==void 0}function ke(me,ct){typeof me.ref=="string"&&_i.current}function Pe(me,ct){{var St=function(){ye||(ye=!0,T("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",ct))};St.isReactWarning=!0,Object.defineProperty(me,"key",{get:St,configurable:!0})}}function F(me,ct){{var St=function(){ve||(ve=!0,T("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",ct))};St.isReactWarning=!0,Object.defineProperty(me,"ref",{get:St,configurable:!0})}}var J=function(me,ct,St,Xt,Bi,ar,Li){var Pi={$$typeof:e,type:me,key:ct,ref:St,props:Li,_owner:ar};return Pi._store={},Object.defineProperty(Pi._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(Pi,"_self",{configurable:!1,enumerable:!1,writable:!1,value:Xt}),Object.defineProperty(Pi,"_source",{configurable:!1,enumerable:!1,writable:!1,value:Bi}),Object.freeze&&(Object.freeze(Pi.props),Object.freeze(Pi)),Pi};function ie(me,ct,St,Xt,Bi){{var ar,Li={},Pi=null,Be=null;St!==void 0&&(zt(St),Pi=""+St),Te(ct)&&(zt(ct.key),Pi=""+ct.key),Le(ct)&&(Be=ct.ref,ke(ct,Bi));for(ar in ct)di.call(ct,ar)&&!vt.hasOwnProperty(ar)&&(Li[ar]=ct[ar]);if(me&&me.defaultProps){var se=me.defaultProps;for(ar in se)Li[ar]===void 0&&(Li[ar]=se[ar])}if(Pi||Be){var ge=typeof me=="function"?me.displayName||me.name||"Unknown":me;Pi&&Pe(Li,ge),Be&&F(Li,ge)}return J(me,Pi,Be,Bi,Xt,_i.current,Li)}}var Re=_.ReactCurrentOwner,ce=_.ReactDebugCurrentFrame;function Ue(me){if(me){var ct=me._owner,St=Ui(me.type,me._source,ct?ct.type:null);ce.setExtraStackFrame(St)}else ce.setExtraStackFrame(null)}var je;je=!1;function dt(me){return typeof me=="object"&&me!==null&&me.$$typeof===e}function It(){{if(Re.current){var me=G(Re.current.type);if(me)return`

Check the render method of \``+me+"`."}return""}}function bt(me){return""}var Ut={};function pi(me){{var ct=It();if(!ct){var St=typeof me=="string"?me:me.displayName||me.name;St&&(ct=`

Check the top-level render call using <`+St+">.")}return ct}}function Er(me,ct){{if(!me._store||me._store.validated||me.key!=null)return;me._store.validated=!0;var St=pi(ct);if(Ut[St])return;Ut[St]=!0;var Xt="";me&&me._owner&&me._owner!==Re.current&&(Xt=" It was passed a child from "+G(me._owner.type)+"."),Ue(me),T('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',St,Xt),Ue(null)}}function ki(me,ct){{if(typeof me!="object")return;if(Ce(me))for(var St=0;St<me.length;St++){var Xt=me[St];dt(Xt)&&Er(Xt,ct)}else if(dt(me))me._store&&(me._store.validated=!0);else if(me){var Bi=v(me);if(typeof Bi=="function"&&Bi!==me.entries)for(var ar=Bi.call(me),Li;!(Li=ar.next()).done;)dt(Li.value)&&Er(Li.value,ct)}}}function An(me){{var ct=me.type;if(ct==null||typeof ct=="string")return;var St;if(typeof ct=="function")St=ct.propTypes;else if(typeof ct=="object"&&(ct.$$typeof===c||ct.$$typeof===f))St=ct.propTypes;else return;if(St){var Xt=G(ct);Gi(St,me.props,"prop",Xt,me)}else if(ct.PropTypes!==void 0&&!je){je=!0;var Bi=G(ct);T("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",Bi||"Unknown")}typeof ct.getDefaultProps=="function"&&!ct.getDefaultProps.isReactClassApproved&&T("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function Ur(me){{for(var ct=Object.keys(me.props),St=0;St<ct.length;St++){var Xt=ct[St];if(Xt!=="children"&&Xt!=="key"){Ue(me),T("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",Xt),Ue(null);break}}me.ref!==null&&(Ue(me),T("Invalid attribute `ref` supplied to `React.Fragment`."),Ue(null))}}var sn={};function xs(me,ct,St,Xt,Bi,ar){{var Li=O(me);if(!Li){var Pi="";(me===void 0||typeof me=="object"&&me!==null&&Object.keys(me).length===0)&&(Pi+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var Be=bt();Be?Pi+=Be:Pi+=It();var se;me===null?se="null":Ce(me)?se="array":me!==void 0&&me.$$typeof===e?(se="<"+(G(me.type)||"Unknown")+" />",Pi=" Did you accidentally export a JSX literal instead of a component?"):se=typeof me,T("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",se,Pi)}var ge=ie(me,ct,St,Bi,ar);if(ge==null)return ge;if(Li){var Ne=ct.children;if(Ne!==void 0)if(Xt)if(Ce(Ne)){for(var Fe=0;Fe<Ne.length;Fe++)ki(Ne[Fe],me);Object.freeze&&Object.freeze(Ne)}else T("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else ki(Ne,me)}if(di.call(ct,"key")){var Ke=G(me),ot=Object.keys(ct).filter(function(Kt){return Kt!=="key"}),wt=ot.length>0?"{key: someKey, "+ot.join(": ..., ")+": ...}":"{key: someKey}";if(!sn[Ke+wt]){var qt=ot.length>0?"{"+ot.join(": ..., ")+": ...}":"{}";T(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,wt,Ke,qt,Ke),sn[Ke+wt]=!0}}return me===n?Ur(ge):An(ge),ge}}function yn(me,ct,St){return xs(me,ct,St,!0)}function Ls(me,ct,St){return xs(me,ct,St,!1)}var rs=Ls,bs=yn;P0.Fragment=n,P0.jsx=rs,P0.jsxs=bs}()),P0}process.env.NODE_ENV==="production"?Rh.exports=AH():Rh.exports=yH();var Bt=Rh.exports;const pL="data:image/svg+xml,%3csvg%20width='300'%20height='50'%20viewBox='0%200%20500%2084'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3crect%20width='500'%20height='84'%20fill='url(%23pattern0_10_2)'/%3e%3cdefs%3e%3cpattern%20id='pattern0_10_2'%20patternContentUnits='objectBoundingBox'%20width='1'%20height='1'%3e%3cuse%20xlink:href='%23image0_10_2'%20transform='scale(0.002%200.0119048)'/%3e%3c/pattern%3e%3cimage%20id='image0_10_2'%20width='500'%20height='84'%20preserveAspectRatio='none'%20xlink:href='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfQAAABUCAYAAAB0vcXQAAAAAXNSR0IArs4c6QAAIABJREFUeF7tXQeYJFW5vfdWro4zw2wgioCoJEUMwDOsGEAFFR/6RFEREAH1IUpQQaIEFcWEiiAGVIKib0URFFBEfQbQJ+CCgODCssvuhE5VXfm+PjVVQ01vz0x3T/eE3arvQ2S6wr3/Def+6fyULPC1YcOGjKZpewiC8JwgCPZkjD07CIIVlNICISRPCMG/JUJImVJa4ZzXov//YBAED3iet0bTtPtVVX2MUore8AXuUvr5VAKpBFIJpBJYaAkADjpGg64eWuieTn4/RMD5vsrl8m6CILyRc/56wsl/EEoEQkhXbclms8S2beL7/oZ6vf6rTCbzy2q1euuyZcs2RO/seEh7Io+lPS96IoIt9SWLeWgXc9u21PmwNPqVzoylMU5za2VXINrNJyuVyrMppScSQt5KCFk+zTtcQsjDhJDHCSElQgg08rLImOdzDk09RwjJEkKWEUKeTQgZEASBQDN3HIcwxggAvlarBZIk/da27Svuv//+H++///4WpXRhgL0bYaXPpBJIJZBKIJVAKoEOJdBXQOecy4Zh/GcQBO8jhLxcEAROOKEBD2LT+AOc819QSv9IKV2TyWTWUEoB6m1d1Wp1med5z1UUZR/XdV8tCMIrGGMZ3/eJ53kEYC8IwngQBN+2bfvr22yzDb5HU3BvS7zpTakEUgmkEghNp6k2tDQmQl8AnXPODMN4G2PsfELILgBYzAhBFIDkd/i+f4PnebcMDAw81ksxcc4Vy7IO9DzvMELIkZIkDQdBwD3PA4jjoHC14zjnDw0NPbFVA3u6Qns57dJ3TfFttTe52rsrFW1/JJBKvz9yXfi39hzQa7XaqznnFxPC9+WchOZwTdVGOeFXm6Z5RaFQeKhVtzdt2pTLZDLPIYQ8k3P+TELIDoQQJTKzi5xzh1I6TiktE0I2BEHwD8YYAuIeb6VxP/TQQ8qKFSveFATBcYyxgxhjOGTSIAjqlmV9yXXdc1euXFlPtfWFn4RpCxa/BBYvBCzels06qku46bP2Lb1hQSTQM0Avl8uDjLEvEkLeEVloKOd8I6X0vGw2eyUhBIA8abnZuHFjVtO0QxhjLyOEHEgI2ZsQwjoNjvN9v+L7/p2MsdsEQbgtm83e26x912q1vSilnyKEHCpJEszx9+i6/oI77rhDXLVqlTdXyafrcq4STJ9PJZBKIJVAKoG5SqAngF6r1V7LOb8qCILt0CDGWKWhWV+azWY/Rwg3KA21YwKfer1eP6yRavY2SunrCCE6Atmmv0KletqfgyD0xYe+crwn8p0/LEkSDhDf13X98SS4V6vVV8iyfKrrul/MZrO3wDVAKZ14SXqlEkglsMQkkB6ll9iApc3tswTmBOgAaNu2P+e67kmKohDDMACs/2NZ1vHLli2Ddh4C+djYWIEx9n7G2AcppTHo96RrUe755Ls47PwTl885/7nv+58qFAp/BLAzSjlv2gOq1eqwIAhfC4IAloT/26p96z0ZkS3kJYsSKxa4UQvw+QX45BYygdNubI0S6BrQOecF0zSv9X3/YKSMqapq+L5/WqFQuDwGRZDGKIpyKmX0I5TQDCLTAMAza+WdDcNmgB7AcT/lHdDAb23cd46u6yGwxwcNBNHZtn1BEAQfJYSMEkJO0nX9ulRz72wM0rtTCcwsgRSW0xmSSmA+JNAVoI+Pjz+DMXaTJEl7oJGyJP/JcZ0jdF1fi/8GaG7cuPFwxtjndF3fMdmRGTTqrvrb7vtgWuecX+O67smFQqEEUOecC7Ztn8A5/1Kk2duO45xXLBYvxG+UUr+rRs36ULrBzSqi9IYF5UXa8sW/BNbgEmjilj9PllYP2wP0xMSqVqugab0d5C6+73NBEG7UNO2dlFIbWL5hw4Zl+Xz+SsbYoa7rclEUN/tGwiwO8J9RYhGoIvCtEGnOUzT8DgA9/A6ldF2DrObDuq7fEGvrlmW9LgiC6wkhGdd1EST3tUKh8MFegXq6LpfWokhbm0oglUAqgaUogfYAPepZvV7fyfO83wmCAD84kPhyTdM+FAeWIWXN87zvSpIEJrfQvN58wdwOf3u1WiW5XA6sbrgFh4E/U0p/Rwj5P9/3/8UYezSXy21MPj86OpoXBGFIFMXdGWNIcXs+53wVIWT7yIwOtXvGcdA0jZTLZV/TtKtWr1594hFHHAEbfLBx48bnZbPZnzRy1XdCRH6Dhe4Luq6f1itQX4qTI21zswTSo1k6J1IJpBJYvBJoG9BHRka203X9TkrpMwOwtXB+Rjab/UxsYq9Wqx9paLifCdngpglNjwEeLG6O4xiiKK5uAPN1uVzuFkqp1Y2YoGU7jrN7EARv5py/mxCye5w2F78vBnlExeP/4x+krzmO8wdZlo/QNO1JHAg2bNiwcz6f/xVy4aM0u0s1Tft4CurdjEz6TCqBVAKpBFIJzKcE2gJ05Jjruv5by7KeyzkPBEH4VCaT+WQE5uKGDRs+VywWEcHOgyCY7Z3ws3++Xq9/c2hoqNpLVkGAe71eP4Axdirn/I0T7vwwrn3StA8gB7BblkWgrQtUeNxyrNcjfx33VSqV3ZHPTgjZjlJaJ4Scoev6F1NQn2ZapkrrfK7X9FupBFIJpBKYVgKzgS+AkNm2/UPHcd4MwBYE4Yu6rp8cgaRcq9WuURTlCPjLZyGFGSGEfELX9asIIUG/Gdocx3keUtE454fiEIJ+oM2u64bsdbIsh8Cuqiqqta13HOcNxWLxHtyDOAEQ1QRBsFwQhDHP896Yz+fv6k30e6cIGN3f6WPppE8lMC8SSCfmvIg5ZVSfHzEv8a/MCOjQbqvV6oc555dCyaWM3pjP5f8TfQbL2gEHHHBlEAQwc4eacNJ/DV85gNO2bT+fz39t7dq1Z+24445hdPl8yQxtMk3zjZTSLxNCto0APfTtx4CONkeuAJRbfaOu63/CfeVy+SXw6cuyjAPNg47jvHCbbbYxQjnMYx/mS1bpd7ZGCfQKjHv1nq1xDNI+b7kSmP91MSOgR6D2W865SAh5NAiCfQcGBkrQVGu12qWe552squqkZh4DOv4d5Zo/6TjOewuFAljZFqzKWalUGpAk6TJK6btgHYgoZjebR5zzfzuO8woUjYGJ3TTNoxtEON/ww+oy5Ke5XA5+epFSOme62C13Eqc9SyWQSiCVwGYSCNENezFjDKWv4drcidKQnwRlsaEQViilcMM+Rjh/SNW0+yilYdR0erUngWkBnXOeaZQ+vS8IgmegoIkkSQdmMpm/ApgrlcpJmqZ9SZIkblnWlHfAhA2zdr1e/61hGIevXLlydDFotADoer2OeuyXRaLZjHMWB5Eg8P9qGOZLV6xYYYBvXlXVy2VZPooQUmtYG84qFAqXzbc/vdNzHudcN03zlYj+B2Ne5AoJXxMVtMEhbU60t/fdd5+84447vkiW5X0453bDvcFAwYsrNNdQqvi+/0Qmk/lJ94e5mXsev9c0zR0YY6+PDl7hQ4IgiEEQoJDPbyMK4Fn7G7+vUqlgwwE1MZ4X4n61t6R6ehcOy4wxhnKBd6mq+uBs43bOOeewc845JxgdHd1eUZSXc87zeD6ymIXvqtfrvykUCg/P9q5OehLLrlarreCcv5wxNgQPVyKZXhIE4Zeqqj7U5XfDcUX/zjjjjNfatr1rIzDXUlUVQAAXXoYx9ntZlv88e7spmXgk5KLI1uv1VzPGtvN9H9k2s7ohZ39/d3f4vo9GyaIoPqiq6u/aDRSO5Wnb9uGc822xHqPOId5JHR0d/eOKFSvu6R+vRuv+xnOxVqs9jzH2XyhxTSndBwuqVQZU01swNmD7vJtzfhvn/Lv5fP6B7iTb/VOJef0aSukzpnsTCodpmnZjv2UMZlPG2JswT5P7EmLCKKU/bDl50YlarXYeIeTMaHP+YC6X+wo6MzIy8iJFUe4KgkDM5XIUL8KFAUL0OnLTGWM/yuVy72wuyNK9WHv3pGVZr25YGlaDD6dZU58A9AB9+Vk2m30DvooNShTFO0VB3K1m1NbWarV9t9tuu/HFaHpPbqqMse8TQpDSB0CfQNqJcbpC07TjQdtLKUV6XkdX/A0ARaVSuViWZRDzuJxzKcEAGFptMMkrlcopy5Yt+9Zf/vIXab/99tus1n2nh5VkY+ODlWVZB3POb/Y8zxcEgWEOSpLEgiBYyxh7n6qqsBDNalmJi/VUKpVjRFG8EhtjVPEvdst0JKse3Bxbv1AV8ERN074FOUelgFu+Pu5nuVx+ra7rV3qeh0NdXK+Acc7rmqYdSyn9/nRj0k27E7I7kFJ6FWMM2SaYezg4A6iEIAiOymaz17QzFhO4+rR3Lp53aPNuu+22WlXVgz3P83Bwi9JM5Qbz40Wapn3i6TPl9O69GATr9fozOOc3CIKwH+ZPEARCksmyDeDpRlyTzzS5KXFwE13Xva7BXIk9d1M7h+F4LVuWdTeldN84Zgjr0nVdKZvNXvjkk09esMMOO9Tbed+cOjQhfHbDDTeIr3zlK4+UZRnxVnvLskxh6OxEnvF+HGctNep//Mn3/cvy+fwPZ1oDc21/qz2mWq3eyBhDHFkr7pTY6ntoJpO5aWKj7WW499MtMgzjhZyQ/6UTB/1QnpATlGjP8/ZpCejlcnk3Qsh9jYkgG4bxx3w+/xK8EuYSURTv4ZyDKW4SyOPPAfwJId/KZDLvnY+JM+1paRZZ1uv1l4LnHcVhpgF1qwF2H89ms5/H0NRqtYMymcwvy+WyA6DM5/NHt7cp9XJqzf6uhQD0fD5/Qr1edz3Pk0RRTC7YcJIHQfBX0zTfMDw8/GSXmtm0HY8BfXR09OBMJnOz67q+KIoMAZqqquLfay3Let/Q0FBHgF6v148RBAFgOAnos0u/L3fMCdBxKGn0Y3ts8FHrmOd59SAIji0UCn0F9Gw2u3u9XofRBBtPoOu6UKlUjioUCm0C+lR5JgF9r732Wi3L8sGWZXlQLHAw1TRNrlarF+Xz+Y4B3XXdGxob8X6I9/F9fzNA79PeHHYwCeiiKIaAXq/XrzNN84MrV67sCNBN07y7kQocAjrk7vu+m81mpWq1emG5XO47oCcOSdj/z0EJ7BiUY/DpdJUkQD0Ul67riIt6pGFN+ditt95641vf+tY+sXlOtDTeYwDogiC8eYb2Y61uaGjpe1NKEQDelwuATgDolIYAHAM6Dkuu624O6BgU0zRvcl33kIaGDl/x/sVi8S9YUIZhXNXwMx8dmW6nHAaik9f/aJoWdnoxmNlnkqhpmijZ+uvoLDWpwSYmEEhtXpHL5dagVjui83VdPyIIgk2lUumNQ0NDf+gYoPq5M0SUu5A7rArTaegNk9wVmUymJxp6uVy+uFAonGCaZgjoSAlsxdzXcNt8K5vN4hA0o3bZ6QpIAno2m70ZG3IUxMgzeobZjt01oEuidKXjOimgtzkosYY+NjZ2oCRJV80HoNfrdS86WHcN6KCxFgThhmw2u59lWf6E0j+5HXSkUbYpqim3NQO6wATRsq3rqtVqx4BuGMbdqqzs6wV+4HleCOi5XK7vgB7vgxs2bNgTAdBROezJAwusnq0UwHbk1QToRNd1YppmkM1m2fj4+K0o+lUsFh9t513d3BPvMZVK5UZRFGcDdPhwrlqzZs0JrayRU77fJRZ0DOgjIyMHybL8K1mWkVP+ZV3XP4SG1Ov1lwVB8Jtm0pbEBv47TdPgt3UXO5jHgjVNExH7NyTN0skFFgTBXblc7qW4v1qtPldTtb+7novVfqemaS/vpcmym8nW/Eyzhk4pXQU/VNLk3ktAh8kdGjoAHaY9ZA40AXqoYQqCMMI5P1lRlO/10rKRBPRcLnczNmRFUZhlWRwL3rKsmQG9aVHFoNSJhh6fkKcxxU07rLGcZmE2XHIa+qICdEZ5wmrfDKRhTEUM6Llcbj9YFJoBvbmQVKvxwj2Rq64llXUrM3Pze/DfgiAg1kF0HGcaQG+NArHJvVqt3q3r+r6e54WA7nmem8/n+wro8RrctGnTkaqqfqmR1jyYFHRzPzsxuTdbMPDfiqyQag1xc4TDtaYoSo1zflQ+n4cbtedXM6DPss4RswC31iGqqv6i540hBBVNO9PQy+XyzfBP+b5fdhxn52KxOI4JY5omcrTDYizJK+rgJvhudF1/oh+d6Nc7oTFalgUSmk9NgDoVnrZOhl81HMc5aWBg4Nucc81xnNNQtc3zvBHHcd5WLBZv71hL71dnWmjojLFVQRAsJKAD4AP4s13XvbtUKr1uxYoVG3slszkDetNYJAGdMXZlFCSlzDRkmP/YzKHVxUyE7WxaKaB3linSyuTeCw0dPvTY5I4DIUzuSQ29HUDH/YgfSgI7TKDxe2YD9Bj0ouDH0Ideq9U61tA7A/QuVcTEYogP57Va7dOiKJ6M/bTVQaUZL6JgyTWEkH8QQtYhsj0IAsT0aBGh13M8z3suBgJyTI4BfMUIvMZag8yjIDSBc35cLpf7ZkxD3qtttkNADy3TjuMAB59XKBTGetWO+D0dAXqtVtuLMfZ3xhg0g0sbJVEBdmBfOwkVyaZpHMxeh2az2b6cSHotkBZabb5er/+UEPKyViltvu8/cPPNN+8JXw247CmliDTGxF2t6zrS2HpqRp5Lf5sijb8vy/JmgB4EQc9M7m1o6OFJmjEWchRwzq/UNO24bmXWvAX1GtDj9zXiRg4RBOEizvmTQRBI041JvNFgY1EUBUE/iPZHENreyX0vChAE6+CaRnAbXDl4ZxjxhY1phgvZAogIRkzHF9sJ7ksGxS2ED31Raegz8EXEh0q4pxqgcJYois/zPK+GbA2MRzy2Sd9vkkI6jiKnlO4niuKAbdsIxAQNNZixmSiKjzLGUJMCAzzpnmw2IcdjH5mlfUTr+77/C9d1vzw4OFhuJxYp1tDL5fLd2Wx2XjT0eJ4ZhoFg6eNjK+A0h9l4kv8MMVaapv0ySk/bbOonMk1Qs+OVnPNjRVE8yLbt8KDVrCFH6ydWWj6QzWa/1stI81aAPuOCnZgkmB5fVVUVdU56muLcDOhxW1r60E3TvIYQ8o4G3SlC13eDxo2a4fV6HSku2Kg2w0Pf96/O5/PHTJ14cz/9zQXY2n92op22bT/H9/2/hZOSEiE200FIQRDYkiR9Utf1T8OXLsvyhaqqfoBzDiKaV0SpRH3PsW9HoklAD4Lg+6qqropSuSadggsA6CGoR3mmALMPRTXnZ406n20cew3os31vloUc9qdaraJs8I8ScZlh6hmlFBv88aqq/rKXbocWB9SwHYhyTwG9PyRWEZ00DlqeaZq3y5K8yqybcPcInuc5uq7LlmVd8Mgjj5y/5557Ou2A8hznXpixUiqV7s7lcn0H9Hj+joyMnK9p2qlxJgj60AToMZD/oHGw+aSqqv/qpJ+x3EZHR587MDBwvmEYb2SMPR3gMPVAHIP6W3O5HNyoPbm6APTwnB6t+YM0TUNl0p5dk4DOKEu6k1oCumEYb2qkGv13o8jJo3Gkummax4BcZZoWbWyYh56Tz+fH5+43bweyeiaXKS/CBK3X6x9tTMyLmtO8wPduGMZD2Wz2WXhobGxsb0VR/k8URQsap6qqKLM6Z3DqRc+aAV3X9FWu504xufcS0Gu12sXZbLalDz3BwBfB+cQkD4LgT4899tghe+yxx9hspvfZZsRSAXSEeWNNpYDe2yj3uZjc57LemgEdB+darearqhoCOiLuOwH02eb5bG2NNfTx8fG7G77kvgJ6vObK5TJKZn+ZUlqILLqhFSIC9DiN65+NctXHNWKr7pytD7MclsN4B6Sn+r7/1YaWP10+eBjxTik9UNf1P7b7zZnk3yWgx/mW/7Zt+/kgY2u3LbPd15GGHr8s7kRExoJk/l1bfAj86CdmMpmv9/sEOlsne/F7tVpdJgjCXyIylnBe4H8cx4E51ajVascODw9fi9Q9ALksy4cLgvCIqqoguEgBfSIoboIOkPN/c87/jzF2WOKAFGrpCJyrVqtfKxaLJ4CcBhpMt+O3KAA92g3iOZDU0CfCF2iYE+/7/qOc8+Oz2WyqoXexXnrtQ+92zuG5dgDdNM0LHn300XnV0PsN6EnSIkmSfpPL5Z5pmuaUGh6xT9v3/Rsx3/P5fE9SuCKZY+8YFEXxes45ArCbr7A4mCAID3ie99K5fzskIIIlxo+j3BMWiNjq+GtUIEWKHhZ7HByZCB7/gqZpH+mVG6ArQI+lVK1WXyEIwh0RiUpzzvq/VVXdZT4Krcxl8bX7LCbr6aef/i7O+dVRup6Y9Jl5nvebgYGBVyCyfeedd37z4ODgda7rbqpWq+8cGhq6dTZts912zOW+djR0PwiuyPYoba2Fhh5omsYQk+D7/scFQbg38iHBTIb5EyA/3LKsDZZlIdgQi77rw9CiAPRowFoBekSkgUhcBAWmgN7jPPRuNPS5asPNgN7I/rk91tA1VRNcz3VUVZUrlcoFjz/++BYF6HHsi2EYq4MgOLQ5YBCHd/ANVKvVq2zb/vDw8HC118oe1jzGoFwug4sAbI5TLrgYZVlGMN1n1q1bd9Zuu+2G1NOOr3iezKChx5U8f8YYu5wQ8kPf9xHUl7xAqISYjP/Qdf134Q9znICtAD2Oy2iZhx63BgNhmuY3KKXHhO2gU/AcDf1vVVW/3OsB61jyPXwgotX7Kwq5RBGrYaejwIuNkiT9B6grx8bGdmwUpXlUEAQwn10xMDDwobkA0/Rd6Gz02wH0zk3urRm7wBTXAtB9TdMEwzRvzWYyrzVN8zMNLma4MqCFg5kvFCdA3ff9Pzz66KMH77rrrtVzzz2Xgq6006FsBnTbsny5k7S1Tj84w/3x+I+Pjx8uy3LoQ4+icLmu6cyyLeTKphp6D4llugH0Xgx5UkOfAuiKJniB5yiKssUBerzWTNMEvSxcsEhPS2rnoWvP9/0fB0FwTJQd1ZfYIrQFe8Zpp52GNOoDmscUwfFIP6xWq3utWLHivrmM+WyAzjn/RaOg1+vq9fqXfd9/f0TVPAmjEW7+U9O0/XrBSz8zoE/DFIfWRHzg6yml+WZAB6WnoiioXgbO4HmrnjaXgZl4dmaAhAl4l112Oc0PgvMFxkIayERUJWgTP5nNZj+L+vCEkG/m8/k3mqa5JpPJoE78gke79wfQp0o9Sf3aDOiiJPkZXQdn/h26rr8SZWglSfpOwPm+NKKgrdfrXNO0kIfY87yv6Lr+gVlN79MMWysNHcQyjuOEeeiGYax1HKdtprju51domtssKA4aOo7xuVwOZE1LEtDbPVIuNWKZ7sd6qsl9Og29XKlc8MQWpKEntHNUo0Qu9BRNFEDGOX/IcZxXDQ4Oru2noheb30dGRlZkMhn4ymHuDpXOaL8OMw0459fCVYq6HN2O90yAjk+6rvvz0dHRt3iex1esWHE/YwxW68krwkcso4s1TTuzG9N7cg1OZ3KHlm7b9gRTXLVaBWe7Aw7zXC53P/5mGMbr8N8JHt3JUwch5GpN05oi27sV2eJ6zrKsXV3XfUiSJM/3fWzSk2QRKJCh6zpoYxXXdY8SBOEbrus+ZVkWaqmDTW/WAiD97O1CA7okSaHJDZucrusHoa+QDeccaYFIbwxN70jlgaxc133Stu33DQ8P/6wbC8fiAfRwk587oLeLnm1YCtIo9/5Vd5xWQ99CTe4J7fwIzvnXCSEDMS7g0CpJEiyVkm3brykWi7/s5x4Xv/v6668XolRiMFCiPDZovAnop23bRtqhp+u6uH79+uduu+22yHnv6moH0HO53OGUUrtWq72qkcYILvdJ7oqmIMGXtBWsN8M+0Bagl8vl9YSQFZIkfVfXdfiR6fj4+CW6riMPfYogOAh6PP+gXC4Hc8cWd3HOC9VqdbWiKC9DTimYfxKHmg3j4+N7bbvttiOVSmV3RVEesG27ZNv2GcPDwwgODAMoFkoorQDdcZ2+EcvEGnqtVnMFQZDgv8pms+Dsvq1QKLwKIPfYY4+JQ0NDZ+dyuTMqlQoOjTK0c1EUA4EJMEX/Znx8/JDtt98+rPLTicWnHUAPguB9Ufnern317Yxn66C4AO4ans/nQw09DYrrbZQ7uNw9zxMFQeiY+rWdMZ3unukAHSlVMa/8YvGhg/q1VqvNics9jqI3TRNVz6YEo6GgDdL1KKXfrtVqHxoaGqr0UztPjkm85iqVyl2NSn4HxnnqcHXBnw8OB8/zPpfL5T7WTSEqvCTeY0ql0o2SJIXFWaIrdDd4nvdzlNWO31+pVL4my/Jx8J0joLqJRvh+VVVfRCk1u51/MaAna5DEhEahhl4qlXaRZflhfMBxnBOLxeJXoT1VKpU/KoqyXzOge543msvltmlv0HqgcnTb8y6fwySpVCof1DTtc7Ztx9Wcwrdxzsu+778zn8/fZBgGXA5/C4JgIAiCbxQKhRPxLKPUmzgCzX/fJ8aE8VqtugJ56EhbmxHQGXWmo8acaTOLyk5O+tCTgA4N3XXd21RVfdWTTz6pb7vttmalUnmWIAjX6rr+fNM0w4WGVJcoIh7z7rP5fP7UWU3vTY1KAX3zUZqWWGbC29n34iybEct4PmNC/4qzpIAe7kthHnqrKPe5AnpsdYzWMHKqt4sVnCi2yBVFUWpUsNwX5bW73Ha7eixuW7lcfp0kSdcxxrIRgVW4XUf/bNQ07TmU0VKne12ngI72rF+/Xi0UCn8XRTE0vcOCkTwANIrmnJfNZs+dYLTrHCOSgB4HMDQD+ltkWf5hBOgvKBaLqKaWN02zFEUxTomGa5wCflwsFhEY0ZeAh65GtscPjY+PPz+Tydxj23Y4WROvBw3UZzKZzJmVSmXI87zv5XP517qeCx77/+gUkHrc7DCdJi7O0hagz7F8arOGjtN6LpeDyf02XdehoatxnAUWnaqqcOGEpnekl8D0HuVow+fWdpnTyRUSWURQbS3mckeKGPxZ8KHXarW1862hR0FDk8QyqPxWKBRSDb1P1dYWG6BDLwKxzJaiocdZq3WfAAAgAElEQVQHxFKpdFqj+BIqqGmxXxjWSKxlz/MQ9f6efgbCTbdXxvU0fNe/16ibe4rilMI6UNVF3/dflc1mb+tmv51NQ4cPPZ/Phxp6vP9Wq9VXMsZ+LoqikgD08HwA/nnf918MF2037Wmloce005Zl7QNa1zMdxzkf0cf5fD4Hc4BpmjAL/DEqh5oEdG7b9n8PDAx8qW1A7/wQ0k0/e/JMYkCWaar2QN2qF0RRRA8mSBMYJb7n35LJZA4Ga1yj3vAnBgcGT3c9d+0ll1yy89lnnw3zPDTQBQkUXMyA/uijj6rDw8PnqIp6uh/4DrJL4OuC6T2TySCV7XZN0+IKfziZzCrDVhp6CugTvvytwYe+GE3uWyCgxyx0N0uSdHBTthPKSaPOx9sHBwev7ckm3OFL4j2gWq2eBUXLtm05YVUOrYG2bV9aKBQ+3o3ZvRNAjzT6MI6qVCp9nVJ6LPajZJcAvo7j/K1UKh2A+vQddneyOEvS5D4F0CuVyncIIQjwAjvcMwEKhmG8UxTF77TgmQZbz8sHBwfv6rQhS+n+0dHRPOhJKaUHJ/jdQwtHEAQP6rr+bJi5KpXKEblc7hrHcdY7jrMqn88/GJMvLER/FwugW5Z1m6ZpoYYOHvLYNGZZ1rMopZDr81AFDoUwoopJ4EHHYfHTxWLxjHYtHSmgd2Byn7h1/k3ufa6Hnmro/TO5x7EC5557bvChD33oHwMDA7ujkmHCn4hUU8+27T2KxeIjbSt5Pdwc429GDJ6/EUWxmDRz43dFVv53vDT+GuTFd/rp2QCdc/5z1PRIHhZi0/vAwMDfBUHYBQVlEKxnWVaY9YK6Dw1r5lnZbPbCTovJzKqhVyqVOwRBeAWlNEw1igD9U6IofiyuHpUQQuD7/rJcLjfWjgbVqfAWy/2PP/64tnLlys+g0hpjLA4qiwF93U033bQTIiwty3qVLMu/bMQebISpdXBw8HcLGem+WAE9OrmG7oBKpXKoIAiroUVGla3w95Aq0vf9xzzPQw7r7XEa1ExzIgX0RQzomezudauOQxu8KgFiKyo9JpZJNfSJ8e+XDz3ey0ql0n6SJP2PKIqIG8JJHBbL0NzeIE35VRAER+ZyuU0LAehR/8OUYcMwHmOMoYDWZNEj3/c9TdUFs24M5/P50U4xpktAD/e6Uqn0almWf0opVSRRIo47ESQXFfJBsa8XDA4O/r2TNs0K6MijJoQ8mxDyA13Xj8QgVqvVb8qy/O4WgD6WyWSGFmrgOun4lHs7NPvDb7Rx48b/Hh4e/qzjOKEfJllgxLbtA3AiXbdu3fNXrlx5j+M4I6ihPTAwsDpOp+i6rW0+2KpLSwHQYXpfuXLlOYqinO44Tmh6b0rt+KWqqjC9h0EtMx0cU0DvDNA5Dk2eVw+C4NhCofD92P/Y5pSb8bZZ89A1XahUt/wo98Vucg84p6wNd1YElGHWjmmab3Uc56uodS6KYlxNDLEwKPV6SS6XQ5BXx+bjXsy7qJ2hm6lULv1YkZU3xeVs8Zvv+66malLdqu+Ry+VQrrWjqxtAj9oUmt4bwdNX+L5/LA5BoL2O0+oa8QgA9r888cQTB3ZCfz0roBuGsYkQgqj1L2SzWdS0RTDRjyRJelMzoKN0aGRu3gIC4mZG+dHR0bcV8oVrPT/MgQgBHYDJGButVquv32abbRBj8AwU3bAsa9y27Y8ODAx8cyFT1xYzoCcnOUzvhBBEpYamdxD4JOI1YAW6MJfLnTWb6T0F9M4APTW5d7SXT3vzTGlrMaCXKpUL1i0CYpm5RLnHAXGWZaGi2jmSJOkIOPU8D/ugSylFqupxuq5f1RuLbYeaVzRCCdC9RBCEU2RZDmm7gV8TGromVqqVwwYHB8GH0dHVLaDH+93dd9+t7rrrrv+QZXknpNOhTYqiEATLwvQuMvFUJrJL25VfO4BeI4RkGtScF2YymU9EgH6bJEmvaOFD/5Ou6y9echp6R0M4cXO5XH490tOQupYEdLDkua77ZuThm6a5g+/7axljtcYJ7Nx8Pv/ZdkzF0zenuwkdv2+xA3o0ycPD4NjY2KGZTGY1fHAA9JjrPTLz/ct13ffk8/nfznRA6j2gdy//ePNLo9zHDpQk6apsNrt7vZ6a3OezfGqv09ZidjjTNC/mnJ8C8hhkPgGYkPuPgDjP8w7OZrO3dLHFTvtIp6sw3gfK5fJJoih+VhRFFdgVFUoJq+CBMS6Xy13dqc96joAe7nXIwpEkCdzzSO9L9pvDSskY2wfxV+3IcFZAr1arYPmBBnoOTCeRyf1/ZVl+YQtAj9ORtgANfWbxlUqlgwqFwq+QuoaJDA0dqVacc5TCOzKTydxsmub2vu8/EqViXZDP5y/qhvGsnYFs556lBOiIDWlUajq7kdb2McZYyPWOU7VpmsHQ0BCsRLdeeumlh5x9Nm5pbXrvJaB3uok0j0cK6HeIq1at8jbLQ0996PNWD71fgG4YxhcJISdFNb6hXcJ0bGuapjTW6QH5fP4P7exP/bonkY/+TlmWEV2ux9gFl0EE6B/KZrOXd0r8NRdAb7JKXmnb9nslSZqSNYYsKtd1f7dmzZpV++23H7BmxmtWQK9UKsdFdJx/ymazf4s09DslSTqwBaDfqev6y7cGDX18fPzlxWLx10lAR7+DIAC5zLsadYdXxxo6IaTWOPmB5/3zc9PQZxvOmX9fCoDeNMl355zfEATBXgg+hKaOaHdMelhGcrncBYIgnDud6X1isTF/dHSkZR56tVZby+eZKS7V0FMNHXnoi4XLfS4m93jdwQ9MCAFOhFzpAHRJkkJAL5VK+w4MDPx1ITEhBnTTNN8CxjpYnIFdsCYAwMFkZxjGGZlMBqbtkEau3WuugB5bJR988MHstttue68oijslvw0XBkDd9/3/zmazX2plem/F5T5t2loLTSPUjiRJOqgFoP9Z1/UXLeTgtTsQc72vUqm8IZfL/bTZ5B4EwXgQBG/J5XJ3mKa5o+/7/4aF3vf9j0UsewtG/7pUAD1pejcMAzXTEUEbRr1H/smwIlsjffLhRsGHdxQKhT+1Mr33UkOf63xJNfQeaugtzCXx3EYg35577bVakeWD0yj3iVnbxyj3OHocXOknxCACk3sM6JVK5SWFQgEFUhbsigG9Xq+/g3OOw0fI6w6LX6yhV6vVk/P5/JfnW0NP7nVPPfXUa3K5HLjeJ8nKIl8/r9frKLs7q+l9Vg29eRSQR33qqaf+BPVu8VuSi5YQ8kAjP/s5WwGg03K5fGQ+n7+mGdBd1x21bfvg4eHhv4yPj+9ULBYfq9Vq457npUFxEVNccx56q5UezyHOuVatVs/XNf0jjuvAPBmWWVVVNfA8j9m2vRpV7aIUGZTtnSScSfjODs7omZuRJgUiB2j5uq6nTHGieKUgCNs3qgTGjrulmYdO4e+aYEEEoO+1117wRy4AoE+cNNoJitsSmOISPvRPN1yNJwdBEAIRQEiSpNCH7rpu1yxsvToBxPuAYRjHU0o/TynVYgrYIAh81KmvGbXjCoXCN+fTh57sX7zfGYaBAMKjGUMQ/EThr8jXj9vvUFX1NTNZEToGdHy4XC5fpSjK0fHgJRpm6LoOvtwt2ocOs/n+++9/kqIolzUDuiAIm+r1+oGFQuEhy7LCAi2NogRjrut+YHBw8AdbXZR7JnNCzTCmFGdpB9CjuRWmdlSr1eeKongd53zPOL8VmzcmPefcbvC+n60oyiXNpvctD9Dn6sl/uupbkiku4DwI38w5Djt9TVurVCoHUko3C4rTNA31qY8q9LAeeqqh91dDj9Maa7Uaipuc5fs+gDJcl6iwhih3UL5qmgYz94JdCUA/v5E+dzraFbPFxVHu1Vr1LQMDAzd22shemNzjbwI3YXpfsWLFvbqu7xQxZU7+HBGXnaDrOuIAWjJldgXotVrtzAYbxHlg3EHeXOJCStHKbDa7qd0w+04FuBjuh9ZYqVQ+qygKCq6E9IFxHnq9Xn8SBW123nlna3R09DWDg4O31Gq1jZ7nvXVgYOA3cyOWmduGvhAm90wmc4LRJaAnzVEjIyOH5/P5HzHKPNux4bagoIUVRRFVi9ZUKpV3LFu2DL66SZfGlgfoc5/9yeIsjLErZVkONfTIfbYggC4IAlwobQD69PM/aXJfOA19EkDRUMxDL1kPHdXWFnseeifKWBwPVKvV3hEEwZcFQSiiemAjroUKghBn/5wry/JFKB8699nb3RviOV+r1b7PGPuvuOgT3pYA9OcPDAz8rdMvzAbolNKfq6o6hSluum/Esi+Xy4dQSuFmhEtjsjx3hDEmpXRPTdMea/UeAHoQBP8Ltqb49ynUr7VaDb5yfCCXy+WOj5jiQDBzDZLfm/zoMIO+AulEnQpmKd0/NjZWyGazNzDKXu16Lsy8k8LjnD+A6j2gNa3VakcjctI0zXX1ev3FQ0NDT6KfC3XYgSI2UW2t1l61tR4UZ9F1/QTTNEMNHYcfaGK2bU+hfp1p7ONJjspsy5cvP58xdoplWa7neWGKDMBAURSQHd2Yz+ffkjS9p4C+uWRnAnQcNoMg6LuGLoriVZqmTaatRWOI1KEJDT3gImUdByctApP71gXoMUkWrC6SJN2gKMpKwzBiQA8ZNBljq+v1+nvBwtbJYaGXeJBwDSD1C/TSkyCJ+rq6pot1qw6GU3CudHT1EtCTCsy6deu+OTg4+J7IfTOlTZzzW3Vdf10rf/+sgF6pVD4my/KF9Xqdj4yMFHfbbbfK6OjoSzRN+wOS35vD7B3HOb1YLH5moQZvsudzU2ZbDmrcp2q1Oqyp2n1+4G+DVLW4OEs0IDfpun4oKtI1ZHa27/unMMYey2QyO8cTq60ZM5f2T/NsJxp6wLnM5gjotm1fLAriCXWr3jWgRzINTe+2bT8XXO9BEOzpum4Y9Q5mKpj4CCF1zvmZuq5/Lja9twJ0aPQLXW2NEDKl2hrqodfr9UcZY8erqvrLfqY2JgGdUnqlqqrbQz3HPAZblWEYnq7rx+bz+W93NF+bJnXzFEzUg18lSdKViqI807Ks8LsYW1mSBcu2jspms9d00//pNHTXdcN66GFkebl8UbFY/ERMAtWvg/VmPnRFXVUzauC4ndTQt4Qo96if9KmnntIYY38dHh7eDTiBAYVsAZyU0hHDMF40MDDw2EJgQgyI9Xp9B0opyrcORntKyASG+aer+t9LldJLUau9rb05cVO8x1QqlRtFUZxSDz3q7+Ya+ix7e2x632677e4jhOyYULbDpkd4c0zDLI+8+Smm9xjQ4wDFSOkJFe+w2trY2NjrFEX5Gf5gmuaBy5cv/z3nXK9UKuMSVPSo0ljcR9/3f4KC7gsxeJ0ORrf3G4YB7uI/gzYwGZFICHE555fpun5auVwelCTpakVRDjNN8w+5XO6A2ZjNum1Pu891AuhxZGy7747vSwSz5QHojLETkNoHDR0WLqSIOI7Ttobe/F6kfTHGftQAbxyuoQGEZVajCXw/TGqKotwXaephFGu5XJ4MiltUgE4JcR2XLwSg12q1VwVBAEDfKQZ0RCdnMhlqWdaJmUzmq3MB9OZ5E4M0uPobmtzXBSasdFwniOdLNC5H6rqOOJOQqrOtuRdtjosa0FV1Va2WAHRNlyvVygWPd8QU1/0Jv19R7hifhx56SNltt91szvntKEAVB5tFYO4ITJAN0zikUCj8oq3x7OVNE8GSoQvO9/2TbNv+LKVUTVRbC8szW5Z1eaFQOKUbt0BXgD5LHxOm99cSQn4mJmu+RkYgQojR2Af3aja9zwroIyMj2ymK8kRUJP3EXC6HhQ4T512SJO0fCicx13zfH8lmsytQhaxfJ+Bejnmn78JmU6/XTxZF8TPwv0SbT/gaznm5QfX67kwm8z+GYayklP5JUZRtDdO4Jp/Lv7uX3Nidtjtpztnc5I4YgImDHtI6MpkMXCthWcTZvzN1o+k3oOMwaRjGBaIofrhRnjZ5oApPro3KTjcUi8W3YlzQ9qhU6OIEdJwA3XkH9HCDq1QqL+WcX5nRM8/yA9/H4QjzGeZHyujHBEG4uJcH0PhwALO6JEmXB0GA4NmQ0Rc+V/AMeJ73Nl3XcVhrH9CjCbqkAH3e6qFPRt2Ha7nXxDLRfhGmrm3cuPF8SZJO0zQNWSjhWmSMxfXGr6xWqx9etmxZbb4VvXjPrVQqqLT2stjcjnmH9iEUp16vHz4wMPDj2fe6KVAX75fxempfQ2/jQ7GcKpXKtymlR8WKc1Jb55zflMlkDkvibLlcfmGjCuj/xm7gzTR0fBt87r7vb0MI+XY+nw/t+q7rfsbzvI80t822bZiWXl8oFLqj++v+INqGmOZ+C+e8UK/X/0dgwssDHkDDgDk4Lkiw3jTN5wwODpYNw3g+pfQe3/dLnPPT8/n8FQsZ4T4zoBOYArsE9KkybQZ0SukJjuOEGjqARBIlwfXcjjX0qP2TUe/gepckaU/45eGrwyYCDukgCIxGyszHdV3/YlyeddFq6AsI6JifnucB0PeNAT0IAheBOJzzr+i6/gHM7dkK4LS7ouIDYr1eP7MRRHo+rAJRVS4uyzLjnCO188hsNvuLbsiXthRAb739zW1T7KeGHgf5btq0ab9MJvNTxhiUuRjQQ6u27/uB67rPLRQK4I3oLgOqCxHEpao3bdq0r6Iot6uqWoAVKtpL0EZY9mxd13eklHZcaS16T18APd6vCSGFWq12LyFke/wtAeihuwCV7AqFwg/iddgWoJdKJQQ8/CfnfKOu68vx8FNPPfVqTdNuFQQhtumH70SUIyHkqlwud1zXg9fuLrEA99m2/Rzf9/+B012sBcbNoJT+TlXV/0AUfBAE76OUXua67nrUiEca20LLYyFM7r0E9OShZHx8/HBoc0EQYIWGXO+R6ZiJongvY+ytSBnEM7Va7WBRFG+Oa3V25UPvYkNJTs8kscwC+9DDQxFoiV3XBaC/1g+gHHsiNHRFUUTTNG8qFovHUEo3zi0rY/KQmIz6/gal9FhYV5C3jDFBhLtt22sEQXhPI9inJUnQbEt9SwH02frZze/9BHS0JxGz8kfLsl6U8POGFrIgCGAtu1jTNFRds7rpQzfPJNw8P5Jl+fCwbKrvT5RpjCOEOf8WAne7bVc/TO4J5WqypLQkST9GzFDMcBdjre/7Y6g3v3z58qfwtxjQYx86ItynRLnjpvHx8aNVVUWlMOI4zguKxeI9mCRI0eKcDzULm1JaMgxjx2222QaUpy3z5boZoIV+BhN3l112Oa0xiMhnjDXDuFmYqOc16A4vgv9cFMVv6rr+xtHR0Xu32WabvbvxR84RQzYT15YE6DC927Z9QWMOTzG9J6qyXavr+tt7BuhznHyLCNAnNaRSqXRlNpM9xg/8MGsAByJBEJC6tk6SJKz5ngToxZveyMjIszOZzNWEkJcgngIHMdd1QzO/WTdvFkXx/bqur+3mELFVAXqHG0O/AT2e2yMjIydkMplPE0KyCVDHksRYwwoDLf6vSRftHJfVtI/HcwhZWqIoIgi1EGdkRQxxobmdc/5iHCK7bUc/AT2pwNTr9e8EQfBOaOVJLd11XZrP528477zz/uucc84J2gL0arW6TBTF9RBSo/73mcVi8VNYQJZlXYHayc3CQJCS4zgfKRQKly20VtrtQLV6DnJolI0Fnz3MSriSRPo4Ib1Y07R/m6a5neM4DzHGRFSW0jTthG78gt20faa1viUAejTJJ03vjLEbGGPPjQEiAejVRs4vTO9fRiCWLMur56ShdzMYiWcWC6BH8gv9nqVS6YxsJnsRNHTf98WoSpYnorKGbX8in89f2It5Gx9mK5XKsZIkgSZUiTd813WdTCYjG4ZxaT6f/2hyE+tE5FsVoHcimD5SvyY1SRzObrjhBn7ooYf+nRCC9Zi03MbKz69d1z0in8+PdIILHZ5fwmYBaO+//35h1113vYcQskccrBeB+UT+Lue3GYbx5uHhYewVXV39BvR4PTz22GOF7bff/l7HcULTe3xBYQbXO2PsCFEUf1gqlfZjjIFqN0ylbqmh44d6vf5nnLAIIX/XdX0f/K1arb6SMXZb0+CFdn7XdR/J5XK7bynBcRi4SqXyflmWsSHFpAlJ2f5S07TXQIvfYYcd3pbP57/DOR91HOe9qqqujnM2u5o1PXpoSwH05KZvmuZbGWOonR6WWY3SCMOod0rpfVbdeqkkSy8QRfFXSxLQu9nNZpkvidS1gxtpa1dyzreDdg4qXUEQfEVWBLNu/r4RDHusoihr5hL7EfsxEc9g2zZS0t6SWD/cdd2QVKZer7+rUCh8t9sDRAro0w96vzX0aD2GgYzIkGi4HC+Blt5gcMT5GmyOuCXcMymln1EU5ewGY1t98xb3ZrLHc2j9+vXXDgwMvC2Oao//jXZG7tKX6rp+11y21/kA9Lh9hmEcQghBzfYw5im2OAC0HccZFUVxD8/zdmgL0E3TRGT35z3Pw2YJQSB9DXzYf2WM7Z04McT/F/edrOv6lzo5jc1FuP18tlarLaeU/rmRuxufkELtXNM0UiqVEIh1Qjab/W6lUhmilF6fzWZfOT4+/uDg4OCzu92ket2fLRHQN2zYkCkWixdJkvRBFyHjnMeFDeJAxUtN0/xJoVD4rWGavhTloWeyWWbUamsR64AAzn6P0SLT0EMLR6lUGtAA6IQcHsUihJkBYPmCT73BAnmOoigomdx1QaFYOx8bGztBUZQvwmqVUADCNEbbtv/i+/4x2Wz2791+a94AvQ3MQVvaY4p74vw999xj3sqnjo2P313I5/fFHo7Dm+d57lyqrTXvT3FEuWEYd+m6HlbjdJynE2UApDBz+76PaPjLYCXqwx4XztVyufxlRVHej3FIpKmFOBiZ/7+naRrinMy5tGG+AD2e36Zp4tD7jtg63ETs9r0gCLDGfh+Dfssod3T40UcfLW6zzTbrwNfLGEO0+9GR2f3oIAiuagHo+NOm9evX7/bMZz6zspR96diUIrrbTzb7zmGm9DwvBG50eGx8bK+B4sDfDcMwfN//fKFQOCsJFm3sB3OZXzM+uyUB+oRWEDBKGQhn9ooIZ8DQNxn1Hk36hx3HuUfTtNc3MjMy0Bq6Coqb06iAmSoINRjk0S9kUFzcjRhoLcuCO+jyUJWi4RkV/xPn9YPd67iGRe7H3Rx4EsQ+LwTNbCaT2RtZMPFmg1QqSqncCKQ9W9O08yIg7IpJcd4AvY150D6gP37+nnvuOW+A3o+0taQ4Yr+14zgvNE1ztaqqKxIusLC0ahwk1zhQnJfNZkEJ27MguWi+cZRzdRznPcjfnqBKmaysNpEnScg4IWS/6ehT2xjiyVvmC9CjPtBSqVQQRfE+xth2SS090ebzG8kzIE8KTe7TAjp+rFQq3yGEHKUoirFhw4Yddtppp3FEdNdqtX9F6QrhoCUubBJX4iTUfy29f1BZrVb3IIQgchq87VPI60VRBFXmqaqqfgXaoizLZw0MDJxeq9UQcwAa3H920/d+9GZLA/R4kuOwWK1W3yYIwrURIUkY9R4v5KhgRPgvzE9oKNlsdsGqrS0SQJ+MdscaJYSAxCLpSgqB13Gch3VdP0aSpDs7SSeLXUylUmlnWZavliUZaZ7wesQpkuH7KaVrGkyK75Fluavo9sQBpSX166Jgimsmlpm3PPQJ6cyHyT0xDuHBtVKpfLxxuD5LlmU1tshEgA5Tcch7EATBTz3PO3FoaOiJTkC0+d54X1u/fv0zMpnMtzzPezksp7Ish7XZE1fMG3KYqqowXc/5mk9AjxtbqVQOEwQBhWTCqPemKz6Mh3+eDdAPlGX5rojeL6RRhDBN0zyGEPINvKAJ0DGZfNu23zQ4OIg6r0vuAm87AqoopS+L4gEmedvRGUmS/vmpT33qOYgwtCxrV8dx7ofWkc1mb6WUvrab6PZ+CWlLBnQcpvL5PE78H0R6N4Ym4TObKEHIWIjyKaBPzLBEtayjKKXfEARBSWpUmO9RkYcNlUrlw8PDw9e2E4Eeb3Ku677M87zLVVXdA77ySqXCsNFGBZ1Csz6l9COg623nvVPWRdOJN9XQp9815hPQowNECOqGYXybMfau+GAdAzrWJaxkWJOc8zFVVc99/PHHrwDjXKd7H+bNr3/9a3nPPfc8qVGs6ZOKouTjXPNcLkdQsSy6QqroRq2C0zOZzOfaZiKcpUHtAzpzYvKuTvuYvD+e55VK5buCIISm9xagPvnIjICOu0ql0q9lWX657/s1y7KeNTw8DE1Usizr7iAI9trsuBAEGLwnZVneT9f1DUvJ9A5aw+XLl58jCMIZcRR104HFqFarxy9fvvx7GzduzEqSdGGxWPygZVkjoigeIUnSrzveqOYy2rNPvlCLma/iLKB+7XUeeqsuJlJU9hIE4XpCCNwfoQYYRbVO1hRuR0Pvk3VkUZnco012wsY+YeH4vKIoJyMXHcFLsZwTAA9T5Q8aVqqzVFX9VyurUzwOqHXQMKWeQSmFjzKZwoTqVkRRlPDA1eB0QEnck6LCHaHFoNvpv7QAXZMrlWqH1K/dSmZ+NfTEvArHs16v39SwvrwOwBqnW8U1vjEXMPfAFOi67kOCIFzNGPuOruvrZuptPNaWZe3SKIb1X5xz1DnfYZq9Afjjy7Ii+L73JdBy98HMD+bFnjLFzdZ/RL0PDQ3d1ziIh6b36a5ZAX18fPxliqL8BoQylNIvyLL8YbwMpUJ1Xb8lIpaZtLvjhZIoEddz/zIyMvKy7bff3poJ1PuxmXa7FEZHR5EKcL0oikm/3+TrfN+/JZfLHRz1fw/4NmRZhqZ+88DAwBsWmuq1ud/NGrqqqqsw2WOfZrQYO6R+nfqV+BsoTjMF0EVBomRuTHEzTvKAU8ooN03zbZTSayPzMQAdh5jNAD2TyTDDMBY8KA6aSi6Xm7fiLC3mRLjx4pAniuIVhBAUFpoE9URAURxk6HPOUWbyds75w0EQlKHJc7Bb0nwAABCXSURBVM5znPNnSJIESlnkmYem1lD40RUdrnwBYbmE/M3zvPciL7nbQLhWmgvWXLJ8ampynwrouWwOzIBhUBxqUWSzWcQHXVguly/YYYcdUOCoOya3pokVxRGwc889lx9//PHXDwwMvEUUROBAeCfmAgAdU6F5jhFC/kEIgQsG1dE2MMYQuIZEjFwEYLtSSl/aYC7dOXatTU6zKTRnIbWyr2u6UK1VL4VFuRu+9lnANcEUJ7054XGOwlLaL5+62XdmAcNKpfJGzvmNyVKpze8A/ka07bBW7DPFIR4NBMjsb/I8DyH0lmVZzxseHn4QA1gul78uSdJxyTS2BKAjze3Hy5YtO7xXk6ZboG7nuVKp9BpBEG5GEFUS8BL70yZBEHC4eQDaeaFQ+IrjOO+SJGnj2NjYIdtuuy3Id+akdbTTzk7uSQI65/z7jYPZvAA6omkppSh36ouCKDiuc1sjXeRVMTVrJ32Y7t7EQSJbr9dhev9AVCwnrCkcmtwngnLCnaERhLWoAN2yrEcppX2vtjaNFhNuSrC4BUEAJje4l8KDXiy32NKRLD0Zb8RJk19TZagpLjgcHJD/6/v+Y/Cba5r2m16AebQvbeZDt23bcxxn4autLSIf+nwBeuIQF84tWIBEUTwpWcyqOZ2sk33g6X14etTDdxs0w4JhGB8dHBz8Qq/M7E0Hyb5Rv85ykAjne7VaRY33t89kdoeLC7+3BHR8BNy4siz/WZIkZtv2XcViEaT3OJHkGlG8IBZ4RrIxSF1AgIKu6wisu64RKHZkrziiO5kE7d6LwhWCINzCGINPEcmUk49GEwk5lGdEfOEoVPP6XC63GnW/GyQn12ua9s62o4Ln0STRDOiyLK9ClFK/NHTXdS/mnJ8wH4AeHzajMqt7+b4/aXrHom4GdFVVmWma/dHQW4zpdGlrvu9zWAts254fQJ9mvsWHz3q9vhMh5GuEEFieQr9jrElNKNZP57+2A+gA+Oi+cJ4pinJ/rVZ7b6FQmFMQXAtLw6IEdMuybsfBOa62hsh+FDCpVDqtttbu7rX5fUkfeiaT2Re0p9DQwd0PDb1cLl9YrVZ7qqE/vWE+XfHM87y3eJ6HGgvbxvMoeUCM/9Z8KGzV8+ZYraZ7Yj19bePw+J5cLndH99Kb+cn2fejtFLrqrJXYz6vV6iD4NhprNiY72+wlWLdYw67rbq6hx6fher2O0pinVatVrmnaKdls9jL8BjCklN4RBAHL6BnquE54So9P+AhYkCTpJw3CirdBg1psPnWYMQRBuA4aZcQmNEVAUYWo67LZbEgrCk5smIdEUVzped6/gyB4SSaTCXl1p+vbPGJ4c9snfejQ0AHoiDiNS41Gbb5C07QOqq1NnT/NJncAOni7EWcB0pJ+aegJjSA+uU5GvUf9S1qbUH+b1a16fwC9xbpsBeiRL5Hrug4GxvkB9Bn2jMTYabZtgyXuZByEkN4PP6eiKOHGkNQGmjWD5s0Y2oFpmr6macg3v85xnFOGh4dBGd1T61XSh/6sZz1rNVxh0NAjAhEkQ6MK2EWaps1rPXTP9W4nhKyyncl0vbA2e6lUumDdunXzmraGOCfG2PwCejTf4pREQkjRtu1PEUKOBZd/xE4Y3oWIdIDPxBxqsp3PgnUJgEccBv65zDCM8+bCAtcOvC4koMftq1arSIW9IU5VizA6/BlyiU3u0wJ69AC4tP8qy/KzKpVKzXXdFwwPD4cpWtVq9RhZlr8hSRJ3HGdqHtvT2u6fG7z+/wnu5nYE1+97MDD1ev0E3/e/BOBJaq3Jb7uu+7exsbH9d955Zwum9lwu93XG2JEonep53knZbPZ7vTIj9rrPzRq6JEmoXzwF0JHD2Qh07Amg12q1UEMXRXHeAR1jgzxXQRA+0KJufYD627ZtLzigY+dSZIW5nrvggJ44FMUpbQcSQj7ted4BiJkBqEeRyZNTcxZABwsc5PwAKg42tMPV0YM9P9P2B9C7a2YyDx2A7npueHBmjOFQ4xQKBbnhCrjgoYcemhbQu/ty6x0j1tA3btx4d6FQ2BeABw0dGKqqqmQYRs996NPtXYmAtmc1SpEj2PjtnuepOCjOrJnPDPCR8mRTSr/FOb+oJa70UqhPH1QWxOTeLF+Y3iHLxBqeBPQY4D3Pa62hxw+Zpnmg7/u/1VSN2o695sknn3zJbrvtVonqpV8ERiBVVaeMRBNrz8YgCN6Nkon98au3N4KIymWMXS4Iwn/Cv5o86TQJ7hFN0w6ilP4boF2tVt8ty/JVoB31PO+HKAbStqm912idfN/0ZtVQe0Uqnqqqx4ADPaopjsUdHrwcx7mzUChc00nOcfLT8Tg+/vjj2rJly94siuJrXdc1okNOIDIx53jO3bquf74XKX2tuhprf+VyeVfG2IdEUZzkDo/XoSAIsud5T/m+f00ul7u/1xpj8/DG70fZUsYYGKzCtB1ciqLIqMrHGPueoij/6Hdb2p168Vi6rnug67of9DwPZvhCssJiC0CP1zvcUncJgvDFhx9++NZ+E6jEbUX++2GHHXZSvV5/kaqq1Qi4EOQ3wDm/Pp/P/6Rfh4qEXOF/xFpD2dBTXNeFVlxF4ZswSEvX85s2bbp+zZo1P1+1atVEPc8+XvFaLpVKn9A0bXfOuRmVrsUhIxsEwY26rv+sH8xtswF7pVJBWW7sE9g794+CKTuRhkEIATPatbZj/2hwYBBBmvN2JTI73i+K4vOjfTQs6BbRT9+rKMpX++G/T3YSckRZ4hC7OD7OJzb0hIbemH/nbRYU17x5VyqVcxog+Mkw+E2SVqPCGO7BJDrggAOu9n3/nTPZT+BDlGX5GhRzyWazI52a4NuD7NbjC57p00477U0wzzRKvu4giii+M8E93LxRcc6fCILgtblcDhGYKFP3WkrpL2BSbORa/qvBjLTvwMAASP6xkreYCnPztjLm40MdTJYObp2Pli/oN5KHtEKhgOIP+zcyCZAauDwIgoGocVWUVxYE4Z9Icbdt5/eDgwPl/hzUF1Qc6cf7JIE77rhDffGLX7xfI3Ib1SkRyQ53ZoEQko+yVqAYlBhjj3POH6GU/p+qaXcz2nv/dJ+6uOCvnRHQ0bqoAhvK070JKWtBEFyYyWTOjH4TTNNEgM2xEcht9r6EqWUUJwxN05A6M2NqWy+kAk2pkSP7Wc75K+P0mmSIf1ydB9+CJsc5P7RQKMBNgPrazwuC4E5CSE4QhDFK6WG6rv9usWhWvZBP+o5UAqkEUgm0JYH09NuWmBbDTbMCegTcecuyfh8EwR4wWTfyWM8Ea1cM6rVa7XMwfTbnpUa/N/dzQ6PW9aeDIPguyuz1UggAXMuykKp1KmMMVJeT7oA4cC8iO5gMzmgQ4T/kuu5h+Xz+gUgz3xU5uBGRQVUURXBdX7cYqqn1Ulbpu1IJTCeBdP9O50YqgaUpgbYAHV0rlUq7MMZ+SwhZGUUZop7yxRFogx72+IYfC7mAYMufQjbRLJrI3G03yrWCLvZ7vu/fMTAwUOpYhDR0VFLX9fYG4UgQBEcIggC/KmeMTelbHCUZR/GiDb7v/8nzvEOXL1++CRaG9evX75HJZH5GCEFqj9Uo1XlusVhE4FfX1ag67lP6wAwS6DHU9Ph16dDNXQKLYUgWQxvmLsn0DVujBNoGdAinUqkg4OI38K0xxhDxc04ul4OjPrzK5fJLGqVWbxQEATlz4bubguTC+2L/deI3BI78JQiCuxhjawgha1zXBaF/eWhoqBK9R/7nP/+ZX7Zs2XaCIIBBCCQZCLI4UBAEBL1NUCBF/vHpCDDANW2apjc2Nvb1crl8yh577BGm1o2MjLxoYGDgZ4ZhIIgDZQC/ksvlTl4yYJ7uQlvj+k373BcJpIupL2JNX9p3CXQE6GhNtVpFCUsk8i8HXsuy/JMHH3zwqH322QfRiPh9mSAIl9m2/XYEoTVrytNo69N2NCa7iG+Ahp0Mq49z8JooBiff10xQ4Pv+esuy3jc8PHxTHNBTLpdfLEnS7b7v65qqOa7nXqJp2ieXDJj3fZosxQ8stk15sbVnKY5p2uZUAqkEZpJAx4CeAHUA4jOhEbuue3cmk3mTruuTZfJc1z2oXq9/DSbwuQxBi+puHb0u8Ty07m+WSqUzV6xYEfru42j1Rm72tg061z8ODQ0NBUHwcZDopGDekZh7cHMKeD0QYvqKVAKpBLZiCXQF6JBXqVQaUBTle5ZlHZLJZBApPo5SiZqmXZ1gpNINwziRUvrRSKPfTNSzUPzNOjStTPrJhwDalNJbkDOfzWbvbZVmg7+Zpvk83/dfkM/nr0yj2WcV+ww3pMA8F+kttWfT0V5qI7ZE25tOtLYGrmtAx9tBHFKtVi+WZfkU0EY2ctZRC/mnpmm+H/SPcQsaUe0A9hMopScTQpB7OHFxQujU2LW2Gp28KU6Liw8GCYB3KaPX8YB/Lqr4FLnYuWqa5qt93/9DFGWfTpWOpb40HkgHdmmM05bSynS+bSkjuXT7MSdAj7sdcc1eHgTBchRp4ZyPNwpeXfLII498ee+99zZj0zbM2IZhHEQIOZpSCoIaNVl+cVoxTrNSwBMMAIcfHQQwEQ/7Pb7v/wBlUXVdB0HBZLlAwzBe6Ps+ige8WJblr2madmJqWl+6kzdteSqBVAKpBFIJPC2BngA6XgcTvCRJn6WUvtdxnDAYznXdjYqiXJzJZC4H62iSYY1znjFNE1XcXtWgkMQ/e0zHrz7TgPm+/ySi40VRvLPBSX1roVB4qNmsDqKYBuif4/s+6suGbHGSJD1Uq9X2HR4eRi3elP1tK1wVqUa1dAe9p2PX05ctXZmmLV/6EugZoMeisCzr9ZzzS0BCI0kSMQyDaJoGJrarbdu+slgsPtJKbA3CfcUwjN0ZY8+JCtsPUErBz1yMABfpa14QBBsZY/8mhPyLc/6viKR/syUZuQMOkSQJhUhQ2x0XtHWHc/7VtWvXnrX77rvXUhrXpT+J0x6kEtgaJJCeO5b4KM/DAPYc0CHyiC72yIZJ/BxCyC4om4cLVc4YY0h5Q/nSW3tdiQ2ad71eh1n9aM75mwVBWI5CEw2CGGpZliOK4reDILi4WCziMDBpiu94mszDwHTcpj49sBV1tU8STF+bSiCVQFsSSDebtsQ00019AfT4gyjrZ1nW213XfR/n/ACUW03UzUU6+T8opTejjq8kSfdls9kH2q1ag/esXbu26HlesMsuu4QVeFABLJ/Pf1UUxXfj7yihGQRBSVEUpKt9ddmyZQ/PCcjnLO70BakEUgmkEkglsPVIYH5PKX0F9OSgVavVPRhjJzRA/K2EkOHI/h0WaMcF9rhGDrjDGHuYUrqRcz5KCEFBl1KjIIxMKdUJIVIjqG2wkU++oyiKuzqOgzq7nxwcHAQ9a/iier3+X5RS1I69pUGCc10QBNcvX758MjBv65lIaU9TCaQSSCWwdUpgfmG0lYwXpgXzBugJrZ0ahrE3pfQNCIjzff+lbOIKA96RhjbbFfGwE9Ri55xfq2nakXG0esN/r61bt25o++23B8nNwkh1tg6kv6cSSCWQSiCVwFYlgafBqH+wNO+A3jyCyFE3TXMPx3H2lCRpz6gO8yDnHJr4UKPgC4LjUCcXjviaKIp1z/PWIijOdd1/EULuKRaLv5rRlN4/+W1VEzLtbCqBVAKpBFIJLF4J/D/xclRhztyp5QAAAABJRU5ErkJggg=='/%3e%3c/defs%3e%3c/svg%3e",Wv="0x1A6950807E33d5bC9975067e6D6b5Ea4cD661665",vH=BigInt("2000000000000000"),xH=84532,Qv=[{type:"function",name:"getAtomByOwner",inputs:[{name:"owner",type:"address",internalType:"address"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"function",name:"balanceOf",inputs:[{name:"owner",type:"address",internalType:"address"}],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"atomsByHash",inputs:[{name:"atomHash",type:"bytes32",internalType:"bytes32"}],outputs:[{name:"atomId",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"createAtom",inputs:[{name:"atomUri",type:"bytes",internalType:"bytes"}],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"payable"},{type:"fallback",stateMutability:"payable"},{type:"receive",stateMutability:"payable"}];function t2(r,{strict:e=!0}={}){return!r||typeof r!="string"?!1:e?/^0x[0-9a-fA-F]*$/.test(r):r.startsWith("0x")}function fL(r){return t2(r,{strict:!1})?Math.ceil((r.length-2)/2):r.length}const mL="2.29.0";let k0={getDocsUrl:({docsBaseUrl:r,docsPath:e="",docsSlug:i})=>e?`${r??"https://viem.sh"}${e}${i?`#${i}`:""}`:void 0,version:`viem@${mL}`};class Xd extends Error{constructor(e,i={}){var u;const n=(()=>{var c;return i.cause instanceof Xd?i.cause.details:(c=i.cause)!=null&&c.message?i.cause.message:i.details})(),s=i.cause instanceof Xd&&i.cause.docsPath||i.docsPath,o=(u=k0.getDocsUrl)==null?void 0:u.call(k0,{...i,docsPath:s}),l=[e||"An error occurred.","",...i.metaMessages?[...i.metaMessages,""]:[],...o?[`Docs: ${o}`]:[],...n?[`Details: ${n}`]:[],...k0.version?[`Version: ${k0.version}`]:[]].join(`
`);super(l,i.cause?{cause:i.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=n,this.docsPath=s,this.metaMessages=i.metaMessages,this.name=i.name??this.name,this.shortMessage=e,this.version=mL}walk(e){return gL(this,e)}}function gL(r,e){return e!=null&&e(r)?r:r&&typeof r=="object"&&"cause"in r&&r.cause!==void 0?gL(r.cause,e):e?null:r}class AL extends Xd{constructor({size:e,targetSize:i,type:n}){super(`${n.charAt(0).toUpperCase()}${n.slice(1).toLowerCase()} size (${e}) exceeds padding size (${i}).`,{name:"SizeExceedsPaddingSizeError"})}}function Of(r,{dir:e,size:i=32}={}){return typeof r=="string"?bH(r,{dir:e,size:i}):_H(r,{dir:e,size:i})}function bH(r,{dir:e,size:i=32}={}){if(i===null)return r;const n=r.replace("0x","");if(n.length>i*2)throw new AL({size:Math.ceil(n.length/2),targetSize:i,type:"hex"});return`0x${n[e==="right"?"padEnd":"padStart"](i*2,"0")}`}function _H(r,{dir:e,size:i=32}={}){if(i===null)return r;if(r.length>i)throw new AL({size:r.length,targetSize:i,type:"bytes"});const n=new Uint8Array(i);for(let s=0;s<i;s++){const o=e==="right";n[o?s:i-s-1]=r[o?s:r.length-s-1]}return n}class EH extends Xd{constructor({max:e,min:i,signed:n,size:s,value:o}){super(`Number "${o}" is not in safe ${s?`${s*8}-bit ${n?"signed":"unsigned"} `:""}integer range ${e?`(${i} to ${e})`:`(above ${i})`}`,{name:"IntegerOutOfRangeError"})}}class wH extends Xd{constructor({givenSize:e,maxSize:i}){super(`Size cannot exceed ${i} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}}function F0(r,{size:e}){if(fL(r)>e)throw new wH({givenSize:fL(r),maxSize:e})}const CH=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function yL(r,e={}){return typeof r=="number"||typeof r=="bigint"?xL(r,e):typeof r=="string"?MH(r,e):typeof r=="boolean"?SH(r,e):vL(r,e)}function SH(r,e={}){const i=`0x${Number(r)}`;return typeof e.size=="number"?(F0(i,{size:e.size}),Of(i,{size:e.size})):i}function vL(r,e={}){let i="";for(let s=0;s<r.length;s++)i+=CH[r[s]];const n=`0x${i}`;return typeof e.size=="number"?(F0(n,{size:e.size}),Of(n,{dir:"right",size:e.size})):n}function xL(r,e={}){const{signed:i,size:n}=e,s=BigInt(r);let o;n?i?o=(1n<<BigInt(n)*8n-1n)-1n:o=2n**(BigInt(n)*8n)-1n:typeof r=="number"&&(o=BigInt(Number.MAX_SAFE_INTEGER));const l=typeof o=="bigint"&&i?-o-1n:0;if(o&&s>o||s<l){const c=typeof r=="bigint"?"n":"";throw new EH({max:o?`${o}${c}`:void 0,min:`${l}${c}`,signed:i,size:n,value:`${r}${c}`})}const u=`0x${(i&&s<0?(1n<<BigInt(n*8))+BigInt(s):s).toString(16)}`;return n?Of(u,{size:n}):u}const TH=new TextEncoder;function MH(r,e={}){const i=TH.encode(r);return vL(i,e)}const RH=new TextEncoder;function IH(r,e={}){return typeof r=="number"||typeof r=="bigint"?NH(r,e):typeof r=="boolean"?BH(r,e):t2(r)?_L(r,e):LH(r,e)}function BH(r,e={}){const i=new Uint8Array(1);return i[0]=Number(r),typeof e.size=="number"?(F0(i,{size:e.size}),Of(i,{size:e.size})):i}const ou={zero:48,nine:57,A:65,F:70,a:97,f:102};function bL(r){if(r>=ou.zero&&r<=ou.nine)return r-ou.zero;if(r>=ou.A&&r<=ou.F)return r-(ou.A-10);if(r>=ou.a&&r<=ou.f)return r-(ou.a-10)}function _L(r,e={}){let i=r;e.size&&(F0(i,{size:e.size}),i=Of(i,{dir:"right",size:e.size}));let n=i.slice(2);n.length%2&&(n=`0${n}`);const s=n.length/2,o=new Uint8Array(s);for(let l=0,u=0;l<s;l++){const c=bL(n.charCodeAt(u++)),h=bL(n.charCodeAt(u++));if(c===void 0||h===void 0)throw new Xd(`Invalid byte sequence ("${n[u-2]}${n[u-1]}" in "${n}").`);o[l]=c*16+h}return o}function NH(r,e){const i=xL(r,e);return _L(i)}function LH(r,e={}){const i=RH.encode(r);return typeof e.size=="number"?(F0(i,{size:e.size}),Of(i,{dir:"right",size:e.size})):i}function EL(r){if(!Number.isSafeInteger(r)||r<0)throw new Error("positive integer expected, got "+r)}function DH(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function i2(r,...e){if(!DH(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function wL(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function OH(r,e){i2(r);const i=e.outputLen;if(r.length<i)throw new Error("digestInto() expects output buffer of length at least "+i)}const qv=BigInt(2**32-1),CL=BigInt(32);function PH(r,e=!1){return e?{h:Number(r&qv),l:Number(r>>CL&qv)}:{h:Number(r>>CL&qv)|0,l:Number(r&qv)|0}}function kH(r,e=!1){let i=new Uint32Array(r.length),n=new Uint32Array(r.length);for(let s=0;s<r.length;s++){const{h:o,l}=PH(r[s],e);[i[s],n[s]]=[o,l]}return[i,n]}const FH=(r,e,i)=>r<<i|e>>>32-i,UH=(r,e,i)=>e<<i|r>>>32-i,zH=(r,e,i)=>e<<i-32|r>>>64-i,jH=(r,e,i)=>r<<i-32|e>>>64-i;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function VH(r){return new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4))}const SL=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function GH(r){return r<<24&4278190080|r<<8&16711680|r>>>8&65280|r>>>24&255}function TL(r){for(let e=0;e<r.length;e++)r[e]=GH(r[e])}typeof Uint8Array.from([]).toHex=="function"&&Uint8Array.fromHex;function HH(r){if(typeof r!="string")throw new Error("utf8ToBytes expected string, got "+typeof r);return new Uint8Array(new TextEncoder().encode(r))}function ML(r){return typeof r=="string"&&(r=HH(r)),i2(r),r}class WH{clone(){return this._cloneInto()}}function QH(r){const e=n=>r().update(ML(n)).digest(),i=r();return e.outputLen=i.outputLen,e.blockLen=i.blockLen,e.create=()=>r(),e}const RL=[],IL=[],BL=[],qH=BigInt(0),U0=BigInt(1),XH=BigInt(2),YH=BigInt(7),KH=BigInt(256),JH=BigInt(113);for(let r=0,e=U0,i=1,n=0;r<24;r++){[i,n]=[n,(2*i+3*n)%5],RL.push(2*(5*n+i)),IL.push((r+1)*(r+2)/2%64);let s=qH;for(let o=0;o<7;o++)e=(e<<U0^(e>>YH)*JH)%KH,e&XH&&(s^=U0<<(U0<<BigInt(o))-U0);BL.push(s)}const[ZH,$H]=kH(BL,!0),NL=(r,e,i)=>i>32?zH(r,e,i):FH(r,e,i),LL=(r,e,i)=>i>32?jH(r,e,i):UH(r,e,i);function eW(r,e=24){const i=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let l=0;l<10;l++)i[l]=r[l]^r[l+10]^r[l+20]^r[l+30]^r[l+40];for(let l=0;l<10;l+=2){const u=(l+8)%10,c=(l+2)%10,h=i[c],p=i[c+1],f=NL(h,p,1)^i[u],m=LL(h,p,1)^i[u+1];for(let g=0;g<50;g+=10)r[l+g]^=f,r[l+g+1]^=m}let s=r[2],o=r[3];for(let l=0;l<24;l++){const u=IL[l],c=NL(s,o,u),h=LL(s,o,u),p=RL[l];s=r[p],o=r[p+1],r[p]=c,r[p+1]=h}for(let l=0;l<50;l+=10){for(let u=0;u<10;u++)i[u]=r[l+u];for(let u=0;u<10;u++)r[l+u]^=~i[(u+2)%10]&i[(u+4)%10]}r[0]^=ZH[n],r[1]^=$H[n]}i.fill(0)}class r2 extends WH{constructor(e,i,n,s=!1,o=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=i,this.outputLen=n,this.enableXOF=s,this.rounds=o,EL(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=VH(this.state)}keccak(){SL||TL(this.state32),eW(this.state32,this.rounds),SL||TL(this.state32),this.posOut=0,this.pos=0}update(e){wL(this);const{blockLen:i,state:n}=this;e=ML(e);const s=e.length;for(let o=0;o<s;){const l=Math.min(i-this.pos,s-o);for(let u=0;u<l;u++)n[this.pos++]^=e[o++];this.pos===i&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:i,pos:n,blockLen:s}=this;e[n]^=i,i&128&&n===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){wL(this,!1),i2(e),this.finish();const i=this.state,{blockLen:n}=this;for(let s=0,o=e.length;s<o;){this.posOut>=n&&this.keccak();const l=Math.min(n-this.posOut,o-s);e.set(i.subarray(this.posOut,this.posOut+l),s),this.posOut+=l,s+=l}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return EL(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(OH(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:i,suffix:n,outputLen:s,rounds:o,enableXOF:l}=this;return e||(e=new r2(i,n,s,l,o)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=o,e.suffix=n,e.outputLen=s,e.enableXOF=l,e.destroyed=this.destroyed,e}}const tW=((r,e,i)=>QH(()=>new r2(e,r,i)))(1,136,256/8);function iW(r,e){const i=tW(t2(r,{strict:!1})?IH(r):r);return yL(i)}function DL(r,e){return function(){return r.apply(e,arguments)}}const{toString:rW}=Object.prototype,{getPrototypeOf:n2}=Object,{iterator:Xv,toStringTag:OL}=Symbol,Yv=(r=>e=>{const i=rW.call(e);return r[i]||(r[i]=i.slice(8,-1).toLowerCase())})(Object.create(null)),Xl=r=>(r=r.toLowerCase(),e=>Yv(e)===r),Kv=r=>e=>typeof e===r,{isArray:Pf}=Array,z0=Kv("undefined");function nW(r){return r!==null&&!z0(r)&&r.constructor!==null&&!z0(r.constructor)&&Po(r.constructor.isBuffer)&&r.constructor.isBuffer(r)}const PL=Xl("ArrayBuffer");function sW(r){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(r):e=r&&r.buffer&&PL(r.buffer),e}const aW=Kv("string"),Po=Kv("function"),kL=Kv("number"),Jv=r=>r!==null&&typeof r=="object",oW=r=>r===!0||r===!1,Zv=r=>{if(Yv(r)!=="object")return!1;const e=n2(r);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(OL in r)&&!(Xv in r)},lW=Xl("Date"),cW=Xl("File"),uW=Xl("Blob"),hW=Xl("FileList"),dW=r=>Jv(r)&&Po(r.pipe),pW=r=>{let e;return r&&(typeof FormData=="function"&&r instanceof FormData||Po(r.append)&&((e=Yv(r))==="formdata"||e==="object"&&Po(r.toString)&&r.toString()==="[object FormData]"))},fW=Xl("URLSearchParams"),[mW,gW,AW,yW]=["ReadableStream","Request","Response","Headers"].map(Xl),vW=r=>r.trim?r.trim():r.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function j0(r,e,{allOwnKeys:i=!1}={}){if(r===null||typeof r>"u")return;let n,s;if(typeof r!="object"&&(r=[r]),Pf(r))for(n=0,s=r.length;n<s;n++)e.call(null,r[n],n,r);else{const o=i?Object.getOwnPropertyNames(r):Object.keys(r),l=o.length;let u;for(n=0;n<l;n++)u=o[n],e.call(null,r[u],u,r)}}function FL(r,e){e=e.toLowerCase();const i=Object.keys(r);let n=i.length,s;for(;n-- >0;)if(s=i[n],e===s.toLowerCase())return s;return null}const Yd=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,UL=r=>!z0(r)&&r!==Yd;function s2(){const{caseless:r}=UL(this)&&this||{},e={},i=(n,s)=>{const o=r&&FL(e,s)||s;Zv(e[o])&&Zv(n)?e[o]=s2(e[o],n):Zv(n)?e[o]=s2({},n):Pf(n)?e[o]=n.slice():e[o]=n};for(let n=0,s=arguments.length;n<s;n++)arguments[n]&&j0(arguments[n],i);return e}const xW=(r,e,i,{allOwnKeys:n}={})=>(j0(e,(s,o)=>{i&&Po(s)?r[o]=DL(s,i):r[o]=s},{allOwnKeys:n}),r),bW=r=>(r.charCodeAt(0)===65279&&(r=r.slice(1)),r),_W=(r,e,i,n)=>{r.prototype=Object.create(e.prototype,n),r.prototype.constructor=r,Object.defineProperty(r,"super",{value:e.prototype}),i&&Object.assign(r.prototype,i)},EW=(r,e,i,n)=>{let s,o,l;const u={};if(e=e||{},r==null)return e;do{for(s=Object.getOwnPropertyNames(r),o=s.length;o-- >0;)l=s[o],(!n||n(l,r,e))&&!u[l]&&(e[l]=r[l],u[l]=!0);r=i!==!1&&n2(r)}while(r&&(!i||i(r,e))&&r!==Object.prototype);return e},wW=(r,e,i)=>{r=String(r),(i===void 0||i>r.length)&&(i=r.length),i-=e.length;const n=r.indexOf(e,i);return n!==-1&&n===i},CW=r=>{if(!r)return null;if(Pf(r))return r;let e=r.length;if(!kL(e))return null;const i=new Array(e);for(;e-- >0;)i[e]=r[e];return i},SW=(r=>e=>r&&e instanceof r)(typeof Uint8Array<"u"&&n2(Uint8Array)),TW=(r,e)=>{const n=(r&&r[Xv]).call(r);let s;for(;(s=n.next())&&!s.done;){const o=s.value;e.call(r,o[0],o[1])}},MW=(r,e)=>{let i;const n=[];for(;(i=r.exec(e))!==null;)n.push(i);return n},RW=Xl("HTMLFormElement"),IW=r=>r.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(i,n,s){return n.toUpperCase()+s}),zL=(({hasOwnProperty:r})=>(e,i)=>r.call(e,i))(Object.prototype),BW=Xl("RegExp"),jL=(r,e)=>{const i=Object.getOwnPropertyDescriptors(r),n={};j0(i,(s,o)=>{let l;(l=e(s,o,r))!==!1&&(n[o]=l||s)}),Object.defineProperties(r,n)},NW=r=>{jL(r,(e,i)=>{if(Po(r)&&["arguments","caller","callee"].indexOf(i)!==-1)return!1;const n=r[i];if(Po(n)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+i+"'")})}})},LW=(r,e)=>{const i={},n=s=>{s.forEach(o=>{i[o]=!0})};return Pf(r)?n(r):n(String(r).split(e)),i},DW=()=>{},OW=(r,e)=>r!=null&&Number.isFinite(r=+r)?r:e;function PW(r){return!!(r&&Po(r.append)&&r[OL]==="FormData"&&r[Xv])}const kW=r=>{const e=new Array(10),i=(n,s)=>{if(Jv(n)){if(e.indexOf(n)>=0)return;if(!("toJSON"in n)){e[s]=n;const o=Pf(n)?[]:{};return j0(n,(l,u)=>{const c=i(l,s+1);!z0(c)&&(o[u]=c)}),e[s]=void 0,o}}return n};return i(r,0)},FW=Xl("AsyncFunction"),UW=r=>r&&(Jv(r)||Po(r))&&Po(r.then)&&Po(r.catch),VL=((r,e)=>r?setImmediate:e?((i,n)=>(Yd.addEventListener("message",({source:s,data:o})=>{s===Yd&&o===i&&n.length&&n.shift()()},!1),s=>{n.push(s),Yd.postMessage(i,"*")}))(`axios@${Math.random()}`,[]):i=>setTimeout(i))(typeof setImmediate=="function",Po(Yd.postMessage)),zW=typeof queueMicrotask<"u"?queueMicrotask.bind(Yd):typeof process<"u"&&process.nextTick||VL,Vt={isArray:Pf,isArrayBuffer:PL,isBuffer:nW,isFormData:pW,isArrayBufferView:sW,isString:aW,isNumber:kL,isBoolean:oW,isObject:Jv,isPlainObject:Zv,isReadableStream:mW,isRequest:gW,isResponse:AW,isHeaders:yW,isUndefined:z0,isDate:lW,isFile:cW,isBlob:uW,isRegExp:BW,isFunction:Po,isStream:dW,isURLSearchParams:fW,isTypedArray:SW,isFileList:hW,forEach:j0,merge:s2,extend:xW,trim:vW,stripBOM:bW,inherits:_W,toFlatObject:EW,kindOf:Yv,kindOfTest:Xl,endsWith:wW,toArray:CW,forEachEntry:TW,matchAll:MW,isHTMLForm:RW,hasOwnProperty:zL,hasOwnProp:zL,reduceDescriptors:jL,freezeMethods:NW,toObjectSet:LW,toCamelCase:IW,noop:DW,toFiniteNumber:OW,findKey:FL,global:Yd,isContextDefined:UL,isSpecCompliantForm:PW,toJSONObject:kW,isAsyncFn:FW,isThenable:UW,setImmediate:VL,asap:zW,isIterable:r=>r!=null&&Po(r[Xv])};function tn(r,e,i,n,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=r,this.name="AxiosError",e&&(this.code=e),i&&(this.config=i),n&&(this.request=n),s&&(this.response=s,this.status=s.status?s.status:null)}Vt.inherits(tn,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Vt.toJSONObject(this.config),code:this.code,status:this.status}}});const GL=tn.prototype,HL={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(r=>{HL[r]={value:r}}),Object.defineProperties(tn,HL),Object.defineProperty(GL,"isAxiosError",{value:!0}),tn.from=(r,e,i,n,s,o)=>{const l=Object.create(GL);return Vt.toFlatObject(r,l,function(c){return c!==Error.prototype},u=>u!=="isAxiosError"),tn.call(l,r.message,e,i,n,s),l.cause=r,l.name=r.name,o&&Object.assign(l,o),l};const jW=null;function a2(r){return Vt.isPlainObject(r)||Vt.isArray(r)}function WL(r){return Vt.endsWith(r,"[]")?r.slice(0,-2):r}function QL(r,e,i){return r?r.concat(e).map(function(s,o){return s=WL(s),!i&&o?"["+s+"]":s}).join(i?".":""):e}function VW(r){return Vt.isArray(r)&&!r.some(a2)}const GW=Vt.toFlatObject(Vt,{},null,function(e){return/^is[A-Z]/.test(e)});function $v(r,e,i){if(!Vt.isObject(r))throw new TypeError("target must be an object");e=e||new FormData,i=Vt.toFlatObject(i,{metaTokens:!0,dots:!1,indexes:!1},!1,function(x,v){return!Vt.isUndefined(v[x])});const n=i.metaTokens,s=i.visitor||p,o=i.dots,l=i.indexes,c=(i.Blob||typeof Blob<"u"&&Blob)&&Vt.isSpecCompliantForm(e);if(!Vt.isFunction(s))throw new TypeError("visitor must be a function");function h(y){if(y===null)return"";if(Vt.isDate(y))return y.toISOString();if(!c&&Vt.isBlob(y))throw new tn("Blob is not supported. Use a Buffer instead.");return Vt.isArrayBuffer(y)||Vt.isTypedArray(y)?c&&typeof Blob=="function"?new Blob([y]):Buffer.from(y):y}function p(y,x,v){let _=y;if(y&&!v&&typeof y=="object"){if(Vt.endsWith(x,"{}"))x=n?x:x.slice(0,-2),y=JSON.stringify(y);else if(Vt.isArray(y)&&VW(y)||(Vt.isFileList(y)||Vt.endsWith(x,"[]"))&&(_=Vt.toArray(y)))return x=WL(x),_.forEach(function(w,S){!(Vt.isUndefined(w)||w===null)&&e.append(l===!0?QL([x],S,o):l===null?x:x+"[]",h(w))}),!1}return a2(y)?!0:(e.append(QL(v,x,o),h(y)),!1)}const f=[],m=Object.assign(GW,{defaultVisitor:p,convertValue:h,isVisitable:a2});function g(y,x){if(!Vt.isUndefined(y)){if(f.indexOf(y)!==-1)throw Error("Circular reference detected in "+x.join("."));f.push(y),Vt.forEach(y,function(_,T){(!(Vt.isUndefined(_)||_===null)&&s.call(e,_,Vt.isString(T)?T.trim():T,x,m))===!0&&g(_,x?x.concat(T):[T])}),f.pop()}}if(!Vt.isObject(r))throw new TypeError("data must be an object");return g(r),e}function qL(r){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(r).replace(/[!'()~]|%20|%00/g,function(n){return e[n]})}function o2(r,e){this._pairs=[],r&&$v(r,this,e)}const XL=o2.prototype;XL.append=function(e,i){this._pairs.push([e,i])},XL.toString=function(e){const i=e?function(n){return e.call(this,n,qL)}:qL;return this._pairs.map(function(s){return i(s[0])+"="+i(s[1])},"").join("&")};function HW(r){return encodeURIComponent(r).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function YL(r,e,i){if(!e)return r;const n=i&&i.encode||HW;Vt.isFunction(i)&&(i={serialize:i});const s=i&&i.serialize;let o;if(s?o=s(e,i):o=Vt.isURLSearchParams(e)?e.toString():new o2(e,i).toString(n),o){const l=r.indexOf("#");l!==-1&&(r=r.slice(0,l)),r+=(r.indexOf("?")===-1?"?":"&")+o}return r}class KL{constructor(){this.handlers=[]}use(e,i,n){return this.handlers.push({fulfilled:e,rejected:i,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Vt.forEach(this.handlers,function(n){n!==null&&e(n)})}}const JL={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},WW={isBrowser:!0,classes:{URLSearchParams:typeof URLSearchParams<"u"?URLSearchParams:o2,FormData:typeof FormData<"u"?FormData:null,Blob:typeof Blob<"u"?Blob:null},protocols:["http","https","file","blob","url","data"]},l2=typeof window<"u"&&typeof document<"u",c2=typeof navigator=="object"&&navigator||void 0,QW=l2&&(!c2||["ReactNative","NativeScript","NS"].indexOf(c2.product)<0),qW=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",XW=l2&&window.location.href||"http://localhost",Ja={...Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:l2,hasStandardBrowserEnv:QW,hasStandardBrowserWebWorkerEnv:qW,navigator:c2,origin:XW},Symbol.toStringTag,{value:"Module"})),...WW};function YW(r,e){return $v(r,new Ja.classes.URLSearchParams,Object.assign({visitor:function(i,n,s,o){return Ja.isNode&&Vt.isBuffer(i)?(this.append(n,i.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)}},e))}function KW(r){return Vt.matchAll(/\w+|\[(\w*)]/g,r).map(e=>e[0]==="[]"?"":e[1]||e[0])}function JW(r){const e={},i=Object.keys(r);let n;const s=i.length;let o;for(n=0;n<s;n++)o=i[n],e[o]=r[o];return e}function ZL(r){function e(i,n,s,o){let l=i[o++];if(l==="__proto__")return!0;const u=Number.isFinite(+l),c=o>=i.length;return l=!l&&Vt.isArray(s)?s.length:l,c?(Vt.hasOwnProp(s,l)?s[l]=[s[l],n]:s[l]=n,!u):((!s[l]||!Vt.isObject(s[l]))&&(s[l]=[]),e(i,n,s[l],o)&&Vt.isArray(s[l])&&(s[l]=JW(s[l])),!u)}if(Vt.isFormData(r)&&Vt.isFunction(r.entries)){const i={};return Vt.forEachEntry(r,(n,s)=>{e(KW(n),s,i,0)}),i}return null}function ZW(r,e,i){if(Vt.isString(r))try{return(e||JSON.parse)(r),Vt.trim(r)}catch(n){if(n.name!=="SyntaxError")throw n}return(i||JSON.stringify)(r)}const V0={transitional:JL,adapter:["xhr","http","fetch"],transformRequest:[function(e,i){const n=i.getContentType()||"",s=n.indexOf("application/json")>-1,o=Vt.isObject(e);if(o&&Vt.isHTMLForm(e)&&(e=new FormData(e)),Vt.isFormData(e))return s?JSON.stringify(ZL(e)):e;if(Vt.isArrayBuffer(e)||Vt.isBuffer(e)||Vt.isStream(e)||Vt.isFile(e)||Vt.isBlob(e)||Vt.isReadableStream(e))return e;if(Vt.isArrayBufferView(e))return e.buffer;if(Vt.isURLSearchParams(e))return i.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let u;if(o){if(n.indexOf("application/x-www-form-urlencoded")>-1)return YW(e,this.formSerializer).toString();if((u=Vt.isFileList(e))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return $v(u?{"files[]":e}:e,c&&new c,this.formSerializer)}}return o||s?(i.setContentType("application/json",!1),ZW(e)):e}],transformResponse:[function(e){const i=this.transitional||V0.transitional,n=i&&i.forcedJSONParsing,s=this.responseType==="json";if(Vt.isResponse(e)||Vt.isReadableStream(e))return e;if(e&&Vt.isString(e)&&(n&&!this.responseType||s)){const l=!(i&&i.silentJSONParsing)&&s;try{return JSON.parse(e)}catch(u){if(l)throw u.name==="SyntaxError"?tn.from(u,tn.ERR_BAD_RESPONSE,this,null,this.response):u}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ja.classes.FormData,Blob:Ja.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Vt.forEach(["delete","get","head","post","put","patch"],r=>{V0.headers[r]={}});const $W=Vt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),eQ=r=>{const e={};let i,n,s;return r&&r.split(`
`).forEach(function(l){s=l.indexOf(":"),i=l.substring(0,s).trim().toLowerCase(),n=l.substring(s+1).trim(),!(!i||e[i]&&$W[i])&&(i==="set-cookie"?e[i]?e[i].push(n):e[i]=[n]:e[i]=e[i]?e[i]+", "+n:n)}),e},$L=Symbol("internals");function G0(r){return r&&String(r).trim().toLowerCase()}function ex(r){return r===!1||r==null?r:Vt.isArray(r)?r.map(ex):String(r)}function tQ(r){const e=Object.create(null),i=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=i.exec(r);)e[n[1]]=n[2];return e}const iQ=r=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(r.trim());function u2(r,e,i,n,s){if(Vt.isFunction(n))return n.call(this,e,i);if(s&&(e=i),!!Vt.isString(e)){if(Vt.isString(n))return e.indexOf(n)!==-1;if(Vt.isRegExp(n))return n.test(e)}}function rQ(r){return r.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,i,n)=>i.toUpperCase()+n)}function nQ(r,e){const i=Vt.toCamelCase(" "+e);["get","set","has"].forEach(n=>{Object.defineProperty(r,n+i,{value:function(s,o,l){return this[n].call(this,e,s,o,l)},configurable:!0})})}let ko=class{constructor(e){e&&this.set(e)}set(e,i,n){const s=this;function o(u,c,h){const p=G0(c);if(!p)throw new Error("header name must be a non-empty string");const f=Vt.findKey(s,p);(!f||s[f]===void 0||h===!0||h===void 0&&s[f]!==!1)&&(s[f||c]=ex(u))}const l=(u,c)=>Vt.forEach(u,(h,p)=>o(h,p,c));if(Vt.isPlainObject(e)||e instanceof this.constructor)l(e,i);else if(Vt.isString(e)&&(e=e.trim())&&!iQ(e))l(eQ(e),i);else if(Vt.isObject(e)&&Vt.isIterable(e)){let u={},c,h;for(const p of e){if(!Vt.isArray(p))throw TypeError("Object iterator must return a key-value pair");u[h=p[0]]=(c=u[h])?Vt.isArray(c)?[...c,p[1]]:[c,p[1]]:p[1]}l(u,i)}else e!=null&&o(i,e,n);return this}get(e,i){if(e=G0(e),e){const n=Vt.findKey(this,e);if(n){const s=this[n];if(!i)return s;if(i===!0)return tQ(s);if(Vt.isFunction(i))return i.call(this,s,n);if(Vt.isRegExp(i))return i.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,i){if(e=G0(e),e){const n=Vt.findKey(this,e);return!!(n&&this[n]!==void 0&&(!i||u2(this,this[n],n,i)))}return!1}delete(e,i){const n=this;let s=!1;function o(l){if(l=G0(l),l){const u=Vt.findKey(n,l);u&&(!i||u2(n,n[u],u,i))&&(delete n[u],s=!0)}}return Vt.isArray(e)?e.forEach(o):o(e),s}clear(e){const i=Object.keys(this);let n=i.length,s=!1;for(;n--;){const o=i[n];(!e||u2(this,this[o],o,e,!0))&&(delete this[o],s=!0)}return s}normalize(e){const i=this,n={};return Vt.forEach(this,(s,o)=>{const l=Vt.findKey(n,o);if(l){i[l]=ex(s),delete i[o];return}const u=e?rQ(o):String(o).trim();u!==o&&delete i[o],i[u]=ex(s),n[u]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const i=Object.create(null);return Vt.forEach(this,(n,s)=>{n!=null&&n!==!1&&(i[s]=e&&Vt.isArray(n)?n.join(", "):n)}),i}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,i])=>e+": "+i).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...i){const n=new this(e);return i.forEach(s=>n.set(s)),n}static accessor(e){const n=(this[$L]=this[$L]={accessors:{}}).accessors,s=this.prototype;function o(l){const u=G0(l);n[u]||(nQ(s,l),n[u]=!0)}return Vt.isArray(e)?e.forEach(o):o(e),this}};ko.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),Vt.reduceDescriptors(ko.prototype,({value:r},e)=>{let i=e[0].toUpperCase()+e.slice(1);return{get:()=>r,set(n){this[i]=n}}}),Vt.freezeMethods(ko);function h2(r,e){const i=this||V0,n=e||i,s=ko.from(n.headers);let o=n.data;return Vt.forEach(r,function(u){o=u.call(i,o,s.normalize(),e?e.status:void 0)}),s.normalize(),o}function eD(r){return!!(r&&r.__CANCEL__)}function kf(r,e,i){tn.call(this,r??"canceled",tn.ERR_CANCELED,e,i),this.name="CanceledError"}Vt.inherits(kf,tn,{__CANCEL__:!0});function tD(r,e,i){const n=i.config.validateStatus;!i.status||!n||n(i.status)?r(i):e(new tn("Request failed with status code "+i.status,[tn.ERR_BAD_REQUEST,tn.ERR_BAD_RESPONSE][Math.floor(i.status/100)-4],i.config,i.request,i))}function sQ(r){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(r);return e&&e[1]||""}function aQ(r,e){r=r||10;const i=new Array(r),n=new Array(r);let s=0,o=0,l;return e=e!==void 0?e:1e3,function(c){const h=Date.now(),p=n[o];l||(l=h),i[s]=c,n[s]=h;let f=o,m=0;for(;f!==s;)m+=i[f++],f=f%r;if(s=(s+1)%r,s===o&&(o=(o+1)%r),h-l<e)return;const g=p&&h-p;return g?Math.round(m*1e3/g):void 0}}function oQ(r,e){let i=0,n=1e3/e,s,o;const l=(h,p=Date.now())=>{i=p,s=null,o&&(clearTimeout(o),o=null),r.apply(null,h)};return[(...h)=>{const p=Date.now(),f=p-i;f>=n?l(h,p):(s=h,o||(o=setTimeout(()=>{o=null,l(s)},n-f)))},()=>s&&l(s)]}const tx=(r,e,i=3)=>{let n=0;const s=aQ(50,250);return oQ(o=>{const l=o.loaded,u=o.lengthComputable?o.total:void 0,c=l-n,h=s(c),p=l<=u;n=l;const f={loaded:l,total:u,progress:u?l/u:void 0,bytes:c,rate:h||void 0,estimated:h&&u&&p?(u-l)/h:void 0,event:o,lengthComputable:u!=null,[e?"download":"upload"]:!0};r(f)},i)},iD=(r,e)=>{const i=r!=null;return[n=>e[0]({lengthComputable:i,total:r,loaded:n}),e[1]]},rD=r=>(...e)=>Vt.asap(()=>r(...e)),lQ=Ja.hasStandardBrowserEnv?((r,e)=>i=>(i=new URL(i,Ja.origin),r.protocol===i.protocol&&r.host===i.host&&(e||r.port===i.port)))(new URL(Ja.origin),Ja.navigator&&/(msie|trident)/i.test(Ja.navigator.userAgent)):()=>!0,cQ=Ja.hasStandardBrowserEnv?{write(r,e,i,n,s,o){const l=[r+"="+encodeURIComponent(e)];Vt.isNumber(i)&&l.push("expires="+new Date(i).toGMTString()),Vt.isString(n)&&l.push("path="+n),Vt.isString(s)&&l.push("domain="+s),o===!0&&l.push("secure"),document.cookie=l.join("; ")},read(r){const e=document.cookie.match(new RegExp("(^|;\\s*)("+r+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(r){this.write(r,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function uQ(r){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(r)}function hQ(r,e){return e?r.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):r}function nD(r,e,i){let n=!uQ(e);return r&&(n||i==!1)?hQ(r,e):e}const sD=r=>r instanceof ko?{...r}:r;function Kd(r,e){e=e||{};const i={};function n(h,p,f,m){return Vt.isPlainObject(h)&&Vt.isPlainObject(p)?Vt.merge.call({caseless:m},h,p):Vt.isPlainObject(p)?Vt.merge({},p):Vt.isArray(p)?p.slice():p}function s(h,p,f,m){if(Vt.isUndefined(p)){if(!Vt.isUndefined(h))return n(void 0,h,f,m)}else return n(h,p,f,m)}function o(h,p){if(!Vt.isUndefined(p))return n(void 0,p)}function l(h,p){if(Vt.isUndefined(p)){if(!Vt.isUndefined(h))return n(void 0,h)}else return n(void 0,p)}function u(h,p,f){if(f in e)return n(h,p);if(f in r)return n(void 0,h)}const c={url:o,method:o,data:o,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:u,headers:(h,p,f)=>s(sD(h),sD(p),f,!0)};return Vt.forEach(Object.keys(Object.assign({},r,e)),function(p){const f=c[p]||s,m=f(r[p],e[p],p);Vt.isUndefined(m)&&f!==u||(i[p]=m)}),i}const aD=r=>{const e=Kd({},r);let{data:i,withXSRFToken:n,xsrfHeaderName:s,xsrfCookieName:o,headers:l,auth:u}=e;e.headers=l=ko.from(l),e.url=YL(nD(e.baseURL,e.url,e.allowAbsoluteUrls),r.params,r.paramsSerializer),u&&l.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):"")));let c;if(Vt.isFormData(i)){if(Ja.hasStandardBrowserEnv||Ja.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if((c=l.getContentType())!==!1){const[h,...p]=c?c.split(";").map(f=>f.trim()).filter(Boolean):[];l.setContentType([h||"multipart/form-data",...p].join("; "))}}if(Ja.hasStandardBrowserEnv&&(n&&Vt.isFunction(n)&&(n=n(e)),n||n!==!1&&lQ(e.url))){const h=s&&o&&cQ.read(o);h&&l.set(s,h)}return e},dQ=typeof XMLHttpRequest<"u"&&function(r){return new Promise(function(i,n){const s=aD(r);let o=s.data;const l=ko.from(s.headers).normalize();let{responseType:u,onUploadProgress:c,onDownloadProgress:h}=s,p,f,m,g,y;function x(){g&&g(),y&&y(),s.cancelToken&&s.cancelToken.unsubscribe(p),s.signal&&s.signal.removeEventListener("abort",p)}let v=new XMLHttpRequest;v.open(s.method.toUpperCase(),s.url,!0),v.timeout=s.timeout;function _(){if(!v)return;const w=ko.from("getAllResponseHeaders"in v&&v.getAllResponseHeaders()),R={data:!u||u==="text"||u==="json"?v.responseText:v.response,status:v.status,statusText:v.statusText,headers:w,config:r,request:v};tD(function(I){i(I),x()},function(I){n(I),x()},R),v=null}"onloadend"in v?v.onloadend=_:v.onreadystatechange=function(){!v||v.readyState!==4||v.status===0&&!(v.responseURL&&v.responseURL.indexOf("file:")===0)||setTimeout(_)},v.onabort=function(){v&&(n(new tn("Request aborted",tn.ECONNABORTED,r,v)),v=null)},v.onerror=function(){n(new tn("Network Error",tn.ERR_NETWORK,r,v)),v=null},v.ontimeout=function(){let S=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const R=s.transitional||JL;s.timeoutErrorMessage&&(S=s.timeoutErrorMessage),n(new tn(S,R.clarifyTimeoutError?tn.ETIMEDOUT:tn.ECONNABORTED,r,v)),v=null},o===void 0&&l.setContentType(null),"setRequestHeader"in v&&Vt.forEach(l.toJSON(),function(S,R){v.setRequestHeader(R,S)}),Vt.isUndefined(s.withCredentials)||(v.withCredentials=!!s.withCredentials),u&&u!=="json"&&(v.responseType=s.responseType),h&&([m,y]=tx(h,!0),v.addEventListener("progress",m)),c&&v.upload&&([f,g]=tx(c),v.upload.addEventListener("progress",f),v.upload.addEventListener("loadend",g)),(s.cancelToken||s.signal)&&(p=w=>{v&&(n(!w||w.type?new kf(null,r,v):w),v.abort(),v=null)},s.cancelToken&&s.cancelToken.subscribe(p),s.signal&&(s.signal.aborted?p():s.signal.addEventListener("abort",p)));const T=sQ(s.url);if(T&&Ja.protocols.indexOf(T)===-1){n(new tn("Unsupported protocol "+T+":",tn.ERR_BAD_REQUEST,r));return}v.send(o||null)})},pQ=(r,e)=>{const{length:i}=r=r?r.filter(Boolean):[];if(e||i){let n=new AbortController,s;const o=function(h){if(!s){s=!0,u();const p=h instanceof Error?h:this.reason;n.abort(p instanceof tn?p:new kf(p instanceof Error?p.message:p))}};let l=e&&setTimeout(()=>{l=null,o(new tn(`timeout ${e} of ms exceeded`,tn.ETIMEDOUT))},e);const u=()=>{r&&(l&&clearTimeout(l),l=null,r.forEach(h=>{h.unsubscribe?h.unsubscribe(o):h.removeEventListener("abort",o)}),r=null)};r.forEach(h=>h.addEventListener("abort",o));const{signal:c}=n;return c.unsubscribe=()=>Vt.asap(u),c}},fQ=function*(r,e){let i=r.byteLength;if(i<e){yield r;return}let n=0,s;for(;n<i;)s=n+e,yield r.slice(n,s),n=s},mQ=async function*(r,e){for await(const i of gQ(r))yield*fQ(i,e)},gQ=async function*(r){if(r[Symbol.asyncIterator]){yield*r;return}const e=r.getReader();try{for(;;){const{done:i,value:n}=await e.read();if(i)break;yield n}}finally{await e.cancel()}},oD=(r,e,i,n)=>{const s=mQ(r,e);let o=0,l,u=c=>{l||(l=!0,n&&n(c))};return new ReadableStream({async pull(c){try{const{done:h,value:p}=await s.next();if(h){u(),c.close();return}let f=p.byteLength;if(i){let m=o+=f;i(m)}c.enqueue(new Uint8Array(p))}catch(h){throw u(h),h}},cancel(c){return u(c),s.return()}},{highWaterMark:2})},ix=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",lD=ix&&typeof ReadableStream=="function",AQ=ix&&(typeof TextEncoder=="function"?(r=>e=>r.encode(e))(new TextEncoder):async r=>new Uint8Array(await new Response(r).arrayBuffer())),cD=(r,...e)=>{try{return!!r(...e)}catch{return!1}},yQ=lD&&cD(()=>{let r=!1;const e=new Request(Ja.origin,{body:new ReadableStream,method:"POST",get duplex(){return r=!0,"half"}}).headers.has("Content-Type");return r&&!e}),uD=64*1024,d2=lD&&cD(()=>Vt.isReadableStream(new Response("").body)),rx={stream:d2&&(r=>r.body)};ix&&(r=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!rx[e]&&(rx[e]=Vt.isFunction(r[e])?i=>i[e]():(i,n)=>{throw new tn(`Response type '${e}' is not supported`,tn.ERR_NOT_SUPPORT,n)})})})(new Response);const vQ=async r=>{if(r==null)return 0;if(Vt.isBlob(r))return r.size;if(Vt.isSpecCompliantForm(r))return(await new Request(Ja.origin,{method:"POST",body:r}).arrayBuffer()).byteLength;if(Vt.isArrayBufferView(r)||Vt.isArrayBuffer(r))return r.byteLength;if(Vt.isURLSearchParams(r)&&(r=r+""),Vt.isString(r))return(await AQ(r)).byteLength},xQ=async(r,e)=>{const i=Vt.toFiniteNumber(r.getContentLength());return i??vQ(e)},p2={http:jW,xhr:dQ,fetch:ix&&(async r=>{let{url:e,method:i,data:n,signal:s,cancelToken:o,timeout:l,onDownloadProgress:u,onUploadProgress:c,responseType:h,headers:p,withCredentials:f="same-origin",fetchOptions:m}=aD(r);h=h?(h+"").toLowerCase():"text";let g=pQ([s,o&&o.toAbortSignal()],l),y;const x=g&&g.unsubscribe&&(()=>{g.unsubscribe()});let v;try{if(c&&yQ&&i!=="get"&&i!=="head"&&(v=await xQ(p,n))!==0){let R=new Request(e,{method:"POST",body:n,duplex:"half"}),B;if(Vt.isFormData(n)&&(B=R.headers.get("content-type"))&&p.setContentType(B),R.body){const[I,D]=iD(v,tx(rD(c)));n=oD(R.body,uD,I,D)}}Vt.isString(f)||(f=f?"include":"omit");const _="credentials"in Request.prototype;y=new Request(e,{...m,signal:g,method:i.toUpperCase(),headers:p.normalize().toJSON(),body:n,duplex:"half",credentials:_?f:void 0});let T=await fetch(y);const w=d2&&(h==="stream"||h==="response");if(d2&&(u||w&&x)){const R={};["status","statusText","headers"].forEach(L=>{R[L]=T[L]});const B=Vt.toFiniteNumber(T.headers.get("content-length")),[I,D]=u&&iD(B,tx(rD(u),!0))||[];T=new Response(oD(T.body,uD,I,()=>{D&&D(),x&&x()}),R)}h=h||"text";let S=await rx[Vt.findKey(rx,h)||"text"](T,r);return!w&&x&&x(),await new Promise((R,B)=>{tD(R,B,{data:S,headers:ko.from(T.headers),status:T.status,statusText:T.statusText,config:r,request:y})})}catch(_){throw x&&x(),_&&_.name==="TypeError"&&/Load failed|fetch/i.test(_.message)?Object.assign(new tn("Network Error",tn.ERR_NETWORK,r,y),{cause:_.cause||_}):tn.from(_,_&&_.code,r,y)}})};Vt.forEach(p2,(r,e)=>{if(r){try{Object.defineProperty(r,"name",{value:e})}catch{}Object.defineProperty(r,"adapterName",{value:e})}});const hD=r=>`- ${r}`,bQ=r=>Vt.isFunction(r)||r===null||r===!1,dD={getAdapter:r=>{r=Vt.isArray(r)?r:[r];const{length:e}=r;let i,n;const s={};for(let o=0;o<e;o++){i=r[o];let l;if(n=i,!bQ(i)&&(n=p2[(l=String(i)).toLowerCase()],n===void 0))throw new tn(`Unknown adapter '${l}'`);if(n)break;s[l||"#"+o]=n}if(!n){const o=Object.entries(s).map(([u,c])=>`adapter ${u} `+(c===!1?"is not supported by the environment":"is not available in the build"));let l=e?o.length>1?`since :
`+o.map(hD).join(`
`):" "+hD(o[0]):"as no adapter specified";throw new tn("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return n},adapters:p2};function f2(r){if(r.cancelToken&&r.cancelToken.throwIfRequested(),r.signal&&r.signal.aborted)throw new kf(null,r)}function pD(r){return f2(r),r.headers=ko.from(r.headers),r.data=h2.call(r,r.transformRequest),["post","put","patch"].indexOf(r.method)!==-1&&r.headers.setContentType("application/x-www-form-urlencoded",!1),dD.getAdapter(r.adapter||V0.adapter)(r).then(function(n){return f2(r),n.data=h2.call(r,r.transformResponse,n),n.headers=ko.from(n.headers),n},function(n){return eD(n)||(f2(r),n&&n.response&&(n.response.data=h2.call(r,r.transformResponse,n.response),n.response.headers=ko.from(n.response.headers))),Promise.reject(n)})}const fD="1.9.0",nx={};["object","boolean","number","function","string","symbol"].forEach((r,e)=>{nx[r]=function(n){return typeof n===r||"a"+(e<1?"n ":" ")+r}});const mD={};nx.transitional=function(e,i,n){function s(o,l){return"[Axios v"+fD+"] Transitional option '"+o+"'"+l+(n?". "+n:"")}return(o,l,u)=>{if(e===!1)throw new tn(s(l," has been removed"+(i?" in "+i:"")),tn.ERR_DEPRECATED);return i&&!mD[l]&&(mD[l]=!0,console.warn(s(l," has been deprecated since v"+i+" and will be removed in the near future"))),e?e(o,l,u):!0}},nx.spelling=function(e){return(i,n)=>(console.warn(`${n} is likely a misspelling of ${e}`),!0)};function _Q(r,e,i){if(typeof r!="object")throw new tn("options must be an object",tn.ERR_BAD_OPTION_VALUE);const n=Object.keys(r);let s=n.length;for(;s-- >0;){const o=n[s],l=e[o];if(l){const u=r[o],c=u===void 0||l(u,o,r);if(c!==!0)throw new tn("option "+o+" must be "+c,tn.ERR_BAD_OPTION_VALUE);continue}if(i!==!0)throw new tn("Unknown option "+o,tn.ERR_BAD_OPTION)}}const sx={assertOptions:_Q,validators:nx},Pc=sx.validators;let Jd=class{constructor(e){this.defaults=e||{},this.interceptors={request:new KL,response:new KL}}async request(e,i){try{return await this._request(e,i)}catch(n){if(n instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const o=s.stack?s.stack.replace(/^.+\n/,""):"";try{n.stack?o&&!String(n.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+o):n.stack=o}catch{}}throw n}}_request(e,i){typeof e=="string"?(i=i||{},i.url=e):i=e||{},i=Kd(this.defaults,i);const{transitional:n,paramsSerializer:s,headers:o}=i;n!==void 0&&sx.assertOptions(n,{silentJSONParsing:Pc.transitional(Pc.boolean),forcedJSONParsing:Pc.transitional(Pc.boolean),clarifyTimeoutError:Pc.transitional(Pc.boolean)},!1),s!=null&&(Vt.isFunction(s)?i.paramsSerializer={serialize:s}:sx.assertOptions(s,{encode:Pc.function,serialize:Pc.function},!0)),i.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?i.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:i.allowAbsoluteUrls=!0),sx.assertOptions(i,{baseUrl:Pc.spelling("baseURL"),withXsrfToken:Pc.spelling("withXSRFToken")},!0),i.method=(i.method||this.defaults.method||"get").toLowerCase();let l=o&&Vt.merge(o.common,o[i.method]);o&&Vt.forEach(["delete","get","head","post","put","patch","common"],y=>{delete o[y]}),i.headers=ko.concat(l,o);const u=[];let c=!0;this.interceptors.request.forEach(function(x){typeof x.runWhen=="function"&&x.runWhen(i)===!1||(c=c&&x.synchronous,u.unshift(x.fulfilled,x.rejected))});const h=[];this.interceptors.response.forEach(function(x){h.push(x.fulfilled,x.rejected)});let p,f=0,m;if(!c){const y=[pD.bind(this),void 0];for(y.unshift.apply(y,u),y.push.apply(y,h),m=y.length,p=Promise.resolve(i);f<m;)p=p.then(y[f++],y[f++]);return p}m=u.length;let g=i;for(f=0;f<m;){const y=u[f++],x=u[f++];try{g=y(g)}catch(v){x.call(this,v);break}}try{p=pD.call(this,g)}catch(y){return Promise.reject(y)}for(f=0,m=h.length;f<m;)p=p.then(h[f++],h[f++]);return p}getUri(e){e=Kd(this.defaults,e);const i=nD(e.baseURL,e.url,e.allowAbsoluteUrls);return YL(i,e.params,e.paramsSerializer)}};Vt.forEach(["delete","get","head","options"],function(e){Jd.prototype[e]=function(i,n){return this.request(Kd(n||{},{method:e,url:i,data:(n||{}).data}))}}),Vt.forEach(["post","put","patch"],function(e){function i(n){return function(o,l,u){return this.request(Kd(u||{},{method:e,headers:n?{"Content-Type":"multipart/form-data"}:{},url:o,data:l}))}}Jd.prototype[e]=i(),Jd.prototype[e+"Form"]=i(!0)});let EQ=class tH{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let i;this.promise=new Promise(function(o){i=o});const n=this;this.promise.then(s=>{if(!n._listeners)return;let o=n._listeners.length;for(;o-- >0;)n._listeners[o](s);n._listeners=null}),this.promise.then=s=>{let o;const l=new Promise(u=>{n.subscribe(u),o=u}).then(s);return l.cancel=function(){n.unsubscribe(o)},l},e(function(o,l,u){n.reason||(n.reason=new kf(o,l,u),i(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const i=this._listeners.indexOf(e);i!==-1&&this._listeners.splice(i,1)}toAbortSignal(){const e=new AbortController,i=n=>{e.abort(n)};return this.subscribe(i),e.signal.unsubscribe=()=>this.unsubscribe(i),e.signal}static source(){let e;return{token:new tH(function(s){e=s}),cancel:e}}};function wQ(r){return function(i){return r.apply(null,i)}}function CQ(r){return Vt.isObject(r)&&r.isAxiosError===!0}const m2={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(m2).forEach(([r,e])=>{m2[e]=r});function gD(r){const e=new Jd(r),i=DL(Jd.prototype.request,e);return Vt.extend(i,Jd.prototype,e,{allOwnKeys:!0}),Vt.extend(i,e,null,{allOwnKeys:!0}),i.create=function(s){return gD(Kd(r,s))},i}const Rs=gD(V0);Rs.Axios=Jd,Rs.CanceledError=kf,Rs.CancelToken=EQ,Rs.isCancel=eD,Rs.VERSION=fD,Rs.toFormData=$v,Rs.AxiosError=tn,Rs.Cancel=Rs.CanceledError,Rs.all=function(e){return Promise.all(e)},Rs.spread=wQ,Rs.isAxiosError=CQ,Rs.mergeConfig=Kd,Rs.AxiosHeaders=ko,Rs.formToJSON=r=>ZL(Vt.isHTMLForm(r)?new FormData(r):r),Rs.getAdapter=dD.getAdapter,Rs.HttpStatusCode=m2,Rs.default=Rs;const{Axios:BRe,AxiosError:NRe,CanceledError:LRe,isCancel:DRe,CancelToken:ORe,VERSION:PRe,all:kRe,Cancel:FRe,isAxiosError:URe,spread:zRe,toFormData:jRe,AxiosHeaders:VRe,HttpStatusCode:GRe,formToJSON:HRe,getAdapter:WRe,mergeConfig:QRe}=Rs,AD=r=>{localStorage.setItem("auth_token",r)},g2=()=>localStorage.getItem("auth_token"),ax=()=>!!g2(),SQ=()=>{localStorage.removeItem("auth_token")},A2=()=>{const r=g2();return r?`Bearer ${r}`:""};let ox=null;const lx=()=>{if(!ox)throw new Error("Configuration Player-map non initialisée. Utilisez PlayerMapConfig.init() pour configurer la bibliothèque.");return{...ox}},TQ=r=>{if(!r.apiUrl)throw new Error("L'URL de l'API est requise pour initialiser Player-map");ox={apiUrl:r.apiUrl},console.log("Configuration Player-map initialisée:",ox)},MQ=async r=>{try{if(!ax())throw new Error("Vous devez être connecté pour envoyer des données à IPFS");const{apiUrl:e}=lx(),i=`${e}/ipfs/hash_data`;console.log("Hashing data to:",i);const n=await Rs.post(i,{data:r},{headers:{"Content-Type":"application/json",Authorization:A2()}});return{ipfsHash:n.data.ipfs_hash,httpUrl:n.data.http_url}}catch(e){throw e instanceof Error&&e.message.includes("Configuration Player-map non initialisée")?(console.error("Erreur de configuration Player-map:",e.message),new Error("Erreur de configuration: Initialisez la bibliothèque Player-map avec PlayerMapConfig.init() avant utilisation")):(console.error("Erreur lors du hachage de données vers IPFS:",e),e)}},RQ=async r=>{try{const e=new FormData;if(e.append("file",r),!ax())throw new Error("Vous devez être connecté pour téléverser des fichiers");const{apiUrl:i}=lx(),n=`${i}/ipfs/upload_file`;return console.log("Uploading to:",n),(await Rs.post(n,e,{headers:{"Content-Type":"multipart/form-data",Authorization:A2()}})).data.ipfs_url}catch(e){throw e instanceof Error&&e.message.includes("Configuration Player-map non initialisée")?(console.error("Erreur de configuration Player-map:",e.message),new Error("Erreur de configuration: Initialisez la bibliothèque Player-map avec PlayerMapConfig.init() avant utilisation")):(console.error("Erreur lors du téléversement vers le serveur:",e),new Error("Échec du téléversement de l'image vers IPFS"))}},y2=r=>r?r.startsWith("ipfs://"):!1,yD=async r=>{if(!y2(r))return r;try{let e=sessionStorage.getItem("ipfs_gateway");if(!e){if(!ax())throw new Error("Vous devez être connecté pour accéder à la passerelle IPFS");const{apiUrl:n}=lx();if(e=(await Rs.get(`${n}/ipfs/gateway_url`,{headers:{Authorization:A2()}})).data.gateway_url,e)sessionStorage.setItem("ipfs_gateway",e);else throw new Error("Aucune passerelle IPFS configurée")}const i=r.replace("ipfs://","");return`https://${e}/ipfs/${i}`}catch(e){throw e instanceof Error&&e.message.includes("Configuration Player-map non initialisée")?(console.error("Erreur de configuration Player-map:",e.message),new Error("Erreur de configuration: Initialisez la bibliothèque Player-map avec PlayerMapConfig.init() avant utilisation")):(console.error("Erreur lors de la récupération du gateway URL:",e),e)}},IQ=({walletConnected:r,walletAddress:e})=>({createAtom:async n=>{if(!r||!e)throw new Error("Wallet not connected");try{const s={"@context":"https://schema.org/","@type":"Thing",...n};s.image&&y2(s.image)&&(s.image=await yD(s.image));const{ipfsHash:o}=await MQ(s),l=yL(o),u=iW(l);try{const f=await r.readContract({address:Wv,abi:Qv,functionName:"atomsByHash",args:[u]});if(f&&BigInt(f)!==0n)return{atomId:BigInt(f),ipfsHash:o}}catch(f){console.error("Error checking if atom exists:",f)}const h=await(await r.writeContract({address:Wv,abi:Qv,functionName:"createAtom",args:[l],value:vH})).wait(),p=await r.readContract({address:Wv,abi:Qv,functionName:"atomsByHash",args:[u]});return{atomId:BigInt(p),ipfsHash:o}}catch(s){throw console.error("Error creating atom:",s),s}}}),vD=({isOpen:r,onClose:e,walletConnected:i,walletAddress:n,wagmiConfig:s,walletHooks:o})=>{const[l,u]=gi.useState({pseudo:"",userId:"",image:""}),[c,h]=gi.useState(!1),[p,f]=gi.useState(!1),[m,g]=gi.useState(!1),[y,x]=gi.useState(null);s==null||s.publicClient;const[v,_]=gi.useState(!1),T=gi.useRef(null),{createAtom:w}=IQ({walletConnected:i,walletAddress:n});gi.useEffect(()=>{(async()=>{if(!(!n||!i))try{const D=await i.readContract({address:Wv,abi:Qv,functionName:"balanceOf",args:[n]});h(D>0)}catch(D){console.error("Error checking atom balance:",D)}})()},[n,i]);const S=I=>{const{name:D,value:L}=I.target;u(O=>({...O,[D]:L}))},R=async I=>{if(!I.target.files||I.target.files.length===0)return;const D=I.target.files[0];try{_(!0);const L=await RQ(D);u(O=>({...O,image:L})),_(!1)}catch(L){console.error("Erreur lors du téléversement de l'image:",L),alert("Erreur lors du téléversement de l'image. Veuillez réessayer."),_(!1)}},B=async()=>{if(!n||!i){alert("Please connect your wallet first");return}if(c){alert("You already have an atom!");return}if(!l.pseudo||!l.userId){alert("Please fill in all fields");return}try{f(!0);const I=await w({name:l.pseudo,description:l.userId,image:l.image||void 0});x(I.atomId.toString()),g(!0),f(!1),setTimeout(()=>{e()},3e3)}catch(I){console.error("Error creating atom:",I),alert("Error creating atom. Please try again."),f(!1)}};return r?Bt.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.7)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},children:Bt.jsxs("div",{style:{backgroundColor:"#101020",color:"#fff",padding:"30px",borderRadius:"10px",maxWidth:"760px",width:"90%",position:"relative",border:"1px solid #FFD32A"},children:[Bt.jsxs("div",{style:{position:"absolute",top:"40px",right:"10px",fontSize:"10px",color:"#666",textAlign:"left",backgroundColor:"rgba(0,0,0,0.3)",padding:"5px",borderRadius:"3px",maxWidth:"200px",overflow:"hidden"},children:[Bt.jsxs("div",{children:["Wallet:"," ",n?n.slice(0,6)+"..."+n.slice(-4):"Not connected"]}),Bt.jsxs("div",{children:["Connected: ",String(!!i)]}),Bt.jsxs("div",{children:["Has Atom: ",String(c)]})]}),Bt.jsx("button",{onClick:e,style:{position:"absolute",top:"10px",right:"10px",backgroundColor:"transparent",border:"none",color:"#fff",fontSize:"20px",cursor:"pointer"},children:"✕"}),Bt.jsxs("div",{style:{textAlign:"center",marginBottom:"20px"},children:[Bt.jsx("img",{src:pL,alt:"Intuition Logo",style:{width:"120px",marginBottom:"10px"}}),Bt.jsx("h3",{style:{color:"#FFD32A",fontSize:"1em",margin:"10px 0"},children:"CREATE YOUR ATOM"}),Bt.jsxs("p",{style:{fontSize:"0.8em",color:"#aaa"},children:["Réseau: Base Sepolia (Chain ID: ",xH,")"]})]}),m?Bt.jsxs("div",{style:{textAlign:"center",color:"#4CAF50"},children:[Bt.jsx("h3",{style:{color:"#4CAF50",marginBottom:"10px"},children:"Success!"}),Bt.jsx("p",{children:"Your atom has been created successfully."}),Bt.jsxs("p",{children:["Atom ID: ",y]}),Bt.jsx("p",{children:"This window will close automatically..."})]}):n?c?Bt.jsx("p",{style:{textAlign:"center",color:"#ff4444"},children:"You already have an atom associated with this wallet"}):Bt.jsxs(Bt.Fragment,{children:[Bt.jsxs("div",{style:{marginBottom:"15px"},children:[Bt.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"0.9em",textAlign:"left"},children:"Pseudo"}),Bt.jsx("input",{type:"text",name:"pseudo",value:l.pseudo,onChange:S,placeholder:"Enter your pseudo",style:{width:"100%",padding:"8px",backgroundColor:"#1e1e30",border:"1px solid #333",color:"#fff",borderRadius:"4px"}})]}),Bt.jsxs("div",{style:{marginBottom:"15px"},children:[Bt.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"0.9em",textAlign:"left"},children:"User ID"}),Bt.jsx("input",{type:"text",name:"userId",value:l.userId,onChange:S,placeholder:"Enter your BossFighters user ID",style:{width:"100%",padding:"8px",backgroundColor:"#1e1e30",border:"1px solid #333",color:"#fff",borderRadius:"4px"}})]}),Bt.jsxs("div",{style:{marginBottom:"15px"},children:[Bt.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"0.9em",textAlign:"left"},children:"Profile picture (optional)"}),Bt.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[Bt.jsxs("div",{children:[Bt.jsx("button",{onClick:()=>{var I;return(I=T.current)==null?void 0:I.click()},style:{padding:"8px 15px",backgroundColor:"#2e2e40",color:"#fff",border:"1px solid #333",borderRadius:"4px",cursor:"pointer",marginRight:"10px"},disabled:v,children:v?"Uploading...":"Choose an image"}),Bt.jsx("input",{ref:T,type:"file",accept:"image/*",onChange:R,style:{display:"none"}})]}),Bt.jsx("p",{style:{fontSize:"0.8em",color:"#aaa",marginTop:"0px"},children:"This image will be used as your Atom's profile picture."}),l.image&&Bt.jsxs("div",{style:{marginTop:"10px"},children:[Bt.jsx("p",{style:{fontSize:"0.8em",color:"#aaa",marginBottom:"5px"},children:"Preview of the image:"}),Bt.jsx(BQ,{src:l.image})]})]})]}),Bt.jsx("div",{style:{textAlign:"center"},children:Bt.jsx("button",{onClick:B,disabled:p||v,style:{padding:"8px 20px",backgroundColor:"#FFD32A",color:"#000",border:"none",borderRadius:"5px",cursor:"pointer",fontWeight:"bold",opacity:p||v?.7:1},children:p?"Creation...":"CREATE YOUR ATOM"})})]}):Bt.jsx("div",{children:Bt.jsx("p",{style:{textAlign:"center",color:"#ff4444"},children:"Please connect your wallet first"})})]})}):null},BQ=({src:r})=>{const[e,i]=gi.useState(null);return gi.useEffect(()=>{(async()=>{if(y2(r)){const s=await yD(r);i(s)}else i(r)})()},[r]),e?Bt.jsx("img",{src:e,alt:"preview",style:{width:"100%",maxHeight:"150px",objectFit:"contain"}}):Bt.jsx("div",{children:"Loading image..."})},xD=({walletConnected:r,walletAddress:e,wagmiConfig:i,walletHooks:n,onClose:s,isOpen:o})=>{const[l,u]=gi.useState(!1),c=()=>{u(!0)},h=()=>{u(!1),s&&s()};return Bt.jsxs("div",{style:{backgroundColor:"#101020",color:"#fff",padding:"20px",textAlign:"center",border:"4px solid #0078D4",borderRadius:"5px",display:"flex",flexDirection:"column",alignItems:"center",maxWidth:"960px",margin:"0 auto",position:"relative",overflow:"hidden"},children:[Bt.jsx("div",{style:{position:"absolute",top:"0",left:"0",width:"100%",height:"4px",backgroundColor:"#0078D4"}}),Bt.jsx("div",{style:{position:"absolute",bottom:"0",left:"0",width:"100%",height:"4px",backgroundColor:"#0078D4"}}),Bt.jsx("img",{src:pL,alt:"Intuition Logo",style:{width:"200px",marginBottom:"10px",marginTop:"20px"}}),Bt.jsx("h2",{style:{fontSize:"1.2em",margin:"0 0 20px 0",color:"#FFD32A"},children:"BOSS FIGHTERS COMMUNITY PLAYER MAP"}),Bt.jsxs("div",{style:{maxWidth:"80%",margin:"0 auto"},children:[Bt.jsx("p",{style:{fontSize:"0.9em",lineHeight:"1.5"},children:"At first, there was nothing. And then, suddenly, the whole community appeared !"}),Bt.jsx("p",{style:{fontSize:"0.9em",lineHeight:"1.5"},children:"Everything of which the Boss Fighters community would one day be composed, would be born in an instant."}),Bt.jsx("p",{style:{fontSize:"0.9em",lineHeight:"1.5"},children:"A single species of condensed matter, exploding in a vast universe."}),Bt.jsx("p",{style:{fontSize:"0.9em",lineHeight:"1.5"},children:"Although energy would neither be created nor destroyed, the interaction between these newly-created atoms would continue to create something beautiful..."}),Bt.jsx("p",{style:{fontSize:"0.9em",lineHeight:"1.5"},children:"What had been separate would become whole again. And what would be created in the process would be even more beautiful than what came before..."}),Bt.jsx("p",{style:{fontSize:"0.9em",lineHeight:"1.5"},children:"Our story begins with the atom. The cornerstone of our ecosystem."}),Bt.jsx("p",{style:{fontSize:"0.9em",lineHeight:"1.5"},children:'And our "atoms" start with you !'}),Bt.jsx("p",{style:{fontSize:"0.9em",lineHeight:"1.5"},children:"Every contribution will help build our ecosystem and make it healthy..."})]}),Bt.jsxs("div",{style:{border:"1px solid #FFD32A",borderRadius:"10px",padding:"15px",margin:"20px 0",display:"inline-block",backgroundColor:"rgba(0, 0, 0, 0.3)",width:"80%",maxWidth:"700px"},children:[Bt.jsx("p",{style:{fontSize:"0.9em",margin:"0 0 10px 0",textAlign:"left"},children:'Claims in Intuition, also referred to as "Triples" structured in Semantic Triple format :'}),Bt.jsx("p",{style:{fontSize:"0.9em",margin:"0 0 10px 0",textAlign:"left"},children:"[Subject] ⇒ [Predicate] ⇒ [Object] (For example, a triple could be : [SciFi] [is] [strong Boss])"}),Bt.jsx("p",{style:{fontSize:"0.9em",margin:"0",textAlign:"left"},children:"This keeps our attestations tidy !"})]}),Bt.jsx("button",{onClick:c,style:{marginTop:"20px",marginBottom:"20px",padding:"10px 20px",backgroundColor:"#FFD32A",color:"#000",border:"none",cursor:"pointer",borderRadius:"5px",fontSize:"1em",fontWeight:"bold"},children:"CREATE YOUR PLAYER"}),Bt.jsx(vD,{isOpen:l,onClose:h,walletConnected:r,walletAddress:e,wagmiConfig:i,walletHooks:n})]})};var NQ=Object.defineProperty,LQ=(r,e,i)=>e in r?NQ(r,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):r[e]=i,H0=(r,e,i)=>LQ(r,typeof e!="symbol"?e+"":e,i);function v2(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function x2(r){if(r.__esModule)return r;var e=r.default;if(typeof e=="function"){var i=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};i.prototype=e.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(r).forEach(function(n){var s=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(i,n,s.get?s:{enumerable:!0,get:function(){return r[n]}})}),i}var b2={exports:{}},W0={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bD;function DQ(){if(bD)return W0;bD=1;var r=gi,e=Symbol.for("react.element"),i=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function l(u,c,h){var p,f={},m=null,g=null;h!==void 0&&(m=""+h),c.key!==void 0&&(m=""+c.key),c.ref!==void 0&&(g=c.ref);for(p in c)n.call(c,p)&&!o.hasOwnProperty(p)&&(f[p]=c[p]);if(u&&u.defaultProps)for(p in c=u.defaultProps,c)f[p]===void 0&&(f[p]=c[p]);return{$$typeof:e,type:u,key:m,ref:g,props:f,_owner:s.current}}return W0.Fragment=i,W0.jsx=l,W0.jsxs=l,W0}var cx={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _D;function OQ(){return _D||(_D=1,process.env.NODE_ENV!=="production"&&function(){var r=gi,e=Symbol.for("react.element"),i=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),u=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),p=Symbol.for("react.suspense_list"),f=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),g=Symbol.for("react.offscreen"),y=Symbol.iterator,x="@@iterator";function v(me){if(me===null||typeof me!="object")return null;var ct=y&&me[y]||me[x];return typeof ct=="function"?ct:null}var _=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function T(me){{for(var ct=arguments.length,St=new Array(ct>1?ct-1:0),Xt=1;Xt<ct;Xt++)St[Xt-1]=arguments[Xt];w("error",me,St)}}function w(me,ct,St){{var Xt=_.ReactDebugCurrentFrame,Bi=Xt.getStackAddendum();Bi!==""&&(ct+="%s",St=St.concat([Bi]));var ar=St.map(function(Li){return String(Li)});ar.unshift("Warning: "+ct),Function.prototype.apply.call(console[me],console,ar)}}var S=!1,R=!1,B=!1,I=!1,D=!1,L;L=Symbol.for("react.module.reference");function O(me){return!!(typeof me=="string"||typeof me=="function"||me===n||me===o||D||me===s||me===h||me===p||I||me===g||S||R||B||typeof me=="object"&&me!==null&&(me.$$typeof===m||me.$$typeof===f||me.$$typeof===l||me.$$typeof===u||me.$$typeof===c||me.$$typeof===L||me.getModuleId!==void 0))}function U(me,ct,St){var Xt=me.displayName;if(Xt)return Xt;var Bi=ct.displayName||ct.name||"";return Bi!==""?St+"("+Bi+")":St}function Z(me){return me.displayName||"Context"}function G(me){if(me==null)return null;if(typeof me.tag=="number"&&T("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof me=="function")return me.displayName||me.name||null;if(typeof me=="string")return me;switch(me){case n:return"Fragment";case i:return"Portal";case o:return"Profiler";case s:return"StrictMode";case h:return"Suspense";case p:return"SuspenseList"}if(typeof me=="object")switch(me.$$typeof){case u:var ct=me;return Z(ct)+".Consumer";case l:var St=me;return Z(St._context)+".Provider";case c:return U(me,me.render,"ForwardRef");case f:var Xt=me.displayName||null;return Xt!==null?Xt:G(me.type)||"Memo";case m:{var Bi=me,ar=Bi._payload,Li=Bi._init;try{return G(Li(ar))}catch{return null}}}return null}var z=Object.assign,$=0,Q,H,V,ne,Y,ae,xe;function fe(){}fe.__reactDisabledLog=!0;function de(){{if($===0){Q=console.log,H=console.info,V=console.warn,ne=console.error,Y=console.group,ae=console.groupCollapsed,xe=console.groupEnd;var me={configurable:!0,enumerable:!0,value:fe,writable:!0};Object.defineProperties(console,{info:me,log:me,warn:me,error:me,group:me,groupCollapsed:me,groupEnd:me})}$++}}function Ie(){{if($--,$===0){var me={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:z({},me,{value:Q}),info:z({},me,{value:H}),warn:z({},me,{value:V}),error:z({},me,{value:ne}),group:z({},me,{value:Y}),groupCollapsed:z({},me,{value:ae}),groupEnd:z({},me,{value:xe})})}$<0&&T("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var Ge=_.ReactCurrentDispatcher,Xe;function $e(me,ct,St){{if(Xe===void 0)try{throw Error()}catch(Bi){var Xt=Bi.stack.trim().match(/\n( *(at )?)/);Xe=Xt&&Xt[1]||""}return`
`+Xe+me}}var lt=!1,At;{var Gt=typeof WeakMap=="function"?WeakMap:Map;At=new Gt}function gt(me,ct){if(!me||lt)return"";{var St=At.get(me);if(St!==void 0)return St}var Xt;lt=!0;var Bi=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var ar;ar=Ge.current,Ge.current=null,de();try{if(ct){var Li=function(){throw Error()};if(Object.defineProperty(Li.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Li,[])}catch(ot){Xt=ot}Reflect.construct(me,[],Li)}else{try{Li.call()}catch(ot){Xt=ot}me.call(Li.prototype)}}else{try{throw Error()}catch(ot){Xt=ot}me()}}catch(ot){if(ot&&Xt&&typeof ot.stack=="string"){for(var Pi=ot.stack.split(`
`),Be=Xt.stack.split(`
`),se=Pi.length-1,ge=Be.length-1;se>=1&&ge>=0&&Pi[se]!==Be[ge];)ge--;for(;se>=1&&ge>=0;se--,ge--)if(Pi[se]!==Be[ge]){if(se!==1||ge!==1)do if(se--,ge--,ge<0||Pi[se]!==Be[ge]){var Ne=`
`+Pi[se].replace(" at new "," at ");return me.displayName&&Ne.includes("<anonymous>")&&(Ne=Ne.replace("<anonymous>",me.displayName)),typeof me=="function"&&At.set(me,Ne),Ne}while(se>=1&&ge>=0);break}}}finally{lt=!1,Ge.current=ar,Ie(),Error.prepareStackTrace=Bi}var Fe=me?me.displayName||me.name:"",Ke=Fe?$e(Fe):"";return typeof me=="function"&&At.set(me,Ke),Ke}function xi(me,ct,St){return gt(me,!1)}function Ze(me){var ct=me.prototype;return!!(ct&&ct.isReactComponent)}function Ui(me,ct,St){if(me==null)return"";if(typeof me=="function")return gt(me,Ze(me));if(typeof me=="string")return $e(me);switch(me){case h:return $e("Suspense");case p:return $e("SuspenseList")}if(typeof me=="object")switch(me.$$typeof){case c:return xi(me.render);case f:return Ui(me.type,ct,St);case m:{var Xt=me,Bi=Xt._payload,ar=Xt._init;try{return Ui(ar(Bi),ct,St)}catch{}}}return""}var di=Object.prototype.hasOwnProperty,Ii={},Ti=_.ReactDebugCurrentFrame;function ir(me){if(me){var ct=me._owner,St=Ui(me.type,me._source,ct?ct.type:null);Ti.setExtraStackFrame(St)}else Ti.setExtraStackFrame(null)}function Gi(me,ct,St,Xt,Bi){{var ar=Function.call.bind(di);for(var Li in me)if(ar(me,Li)){var Pi=void 0;try{if(typeof me[Li]!="function"){var Be=Error((Xt||"React class")+": "+St+" type `"+Li+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof me[Li]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw Be.name="Invariant Violation",Be}Pi=me[Li](ct,Li,Xt,St,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(se){Pi=se}Pi&&!(Pi instanceof Error)&&(ir(Bi),T("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",Xt||"React class",St,Li,typeof Pi),ir(null)),Pi instanceof Error&&!(Pi.message in Ii)&&(Ii[Pi.message]=!0,ir(Bi),T("Failed %s type: %s",St,Pi.message),ir(null))}}}var Qe=Array.isArray;function Ce(me){return Qe(me)}function yt(me){{var ct=typeof Symbol=="function"&&Symbol.toStringTag,St=ct&&me[Symbol.toStringTag]||me.constructor.name||"Object";return St}}function Ot(me){try{return Jt(me),!1}catch{return!0}}function Jt(me){return""+me}function zt(me){if(Ot(me))return T("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",yt(me)),Jt(me)}var _i=_.ReactCurrentOwner,vt={key:!0,ref:!0,__self:!0,__source:!0},ye,ve;function Le(me){if(di.call(me,"ref")){var ct=Object.getOwnPropertyDescriptor(me,"ref").get;if(ct&&ct.isReactWarning)return!1}return me.ref!==void 0}function Te(me){if(di.call(me,"key")){var ct=Object.getOwnPropertyDescriptor(me,"key").get;if(ct&&ct.isReactWarning)return!1}return me.key!==void 0}function ke(me,ct){typeof me.ref=="string"&&_i.current}function Pe(me,ct){{var St=function(){ye||(ye=!0,T("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",ct))};St.isReactWarning=!0,Object.defineProperty(me,"key",{get:St,configurable:!0})}}function F(me,ct){{var St=function(){ve||(ve=!0,T("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",ct))};St.isReactWarning=!0,Object.defineProperty(me,"ref",{get:St,configurable:!0})}}var J=function(me,ct,St,Xt,Bi,ar,Li){var Pi={$$typeof:e,type:me,key:ct,ref:St,props:Li,_owner:ar};return Pi._store={},Object.defineProperty(Pi._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(Pi,"_self",{configurable:!1,enumerable:!1,writable:!1,value:Xt}),Object.defineProperty(Pi,"_source",{configurable:!1,enumerable:!1,writable:!1,value:Bi}),Object.freeze&&(Object.freeze(Pi.props),Object.freeze(Pi)),Pi};function ie(me,ct,St,Xt,Bi){{var ar,Li={},Pi=null,Be=null;St!==void 0&&(zt(St),Pi=""+St),Te(ct)&&(zt(ct.key),Pi=""+ct.key),Le(ct)&&(Be=ct.ref,ke(ct));for(ar in ct)di.call(ct,ar)&&!vt.hasOwnProperty(ar)&&(Li[ar]=ct[ar]);if(me&&me.defaultProps){var se=me.defaultProps;for(ar in se)Li[ar]===void 0&&(Li[ar]=se[ar])}if(Pi||Be){var ge=typeof me=="function"?me.displayName||me.name||"Unknown":me;Pi&&Pe(Li,ge),Be&&F(Li,ge)}return J(me,Pi,Be,Bi,Xt,_i.current,Li)}}var Re=_.ReactCurrentOwner,ce=_.ReactDebugCurrentFrame;function Ue(me){if(me){var ct=me._owner,St=Ui(me.type,me._source,ct?ct.type:null);ce.setExtraStackFrame(St)}else ce.setExtraStackFrame(null)}var je;je=!1;function dt(me){return typeof me=="object"&&me!==null&&me.$$typeof===e}function It(){{if(Re.current){var me=G(Re.current.type);if(me)return`

Check the render method of \``+me+"`."}return""}}function bt(me){return""}var Ut={};function pi(me){{var ct=It();if(!ct){var St=typeof me=="string"?me:me.displayName||me.name;St&&(ct=`

Check the top-level render call using <`+St+">.")}return ct}}function Er(me,ct){{if(!me._store||me._store.validated||me.key!=null)return;me._store.validated=!0;var St=pi(ct);if(Ut[St])return;Ut[St]=!0;var Xt="";me&&me._owner&&me._owner!==Re.current&&(Xt=" It was passed a child from "+G(me._owner.type)+"."),Ue(me),T('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',St,Xt),Ue(null)}}function ki(me,ct){{if(typeof me!="object")return;if(Ce(me))for(var St=0;St<me.length;St++){var Xt=me[St];dt(Xt)&&Er(Xt,ct)}else if(dt(me))me._store&&(me._store.validated=!0);else if(me){var Bi=v(me);if(typeof Bi=="function"&&Bi!==me.entries)for(var ar=Bi.call(me),Li;!(Li=ar.next()).done;)dt(Li.value)&&Er(Li.value,ct)}}}function An(me){{var ct=me.type;if(ct==null||typeof ct=="string")return;var St;if(typeof ct=="function")St=ct.propTypes;else if(typeof ct=="object"&&(ct.$$typeof===c||ct.$$typeof===f))St=ct.propTypes;else return;if(St){var Xt=G(ct);Gi(St,me.props,"prop",Xt,me)}else if(ct.PropTypes!==void 0&&!je){je=!0;var Bi=G(ct);T("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",Bi||"Unknown")}typeof ct.getDefaultProps=="function"&&!ct.getDefaultProps.isReactClassApproved&&T("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function Ur(me){{for(var ct=Object.keys(me.props),St=0;St<ct.length;St++){var Xt=ct[St];if(Xt!=="children"&&Xt!=="key"){Ue(me),T("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",Xt),Ue(null);break}}me.ref!==null&&(Ue(me),T("Invalid attribute `ref` supplied to `React.Fragment`."),Ue(null))}}var sn={};function xs(me,ct,St,Xt,Bi,ar){{var Li=O(me);if(!Li){var Pi="";(me===void 0||typeof me=="object"&&me!==null&&Object.keys(me).length===0)&&(Pi+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var Be=bt();Be?Pi+=Be:Pi+=It();var se;me===null?se="null":Ce(me)?se="array":me!==void 0&&me.$$typeof===e?(se="<"+(G(me.type)||"Unknown")+" />",Pi=" Did you accidentally export a JSX literal instead of a component?"):se=typeof me,T("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",se,Pi)}var ge=ie(me,ct,St,Bi,ar);if(ge==null)return ge;if(Li){var Ne=ct.children;if(Ne!==void 0)if(Xt)if(Ce(Ne)){for(var Fe=0;Fe<Ne.length;Fe++)ki(Ne[Fe],me);Object.freeze&&Object.freeze(Ne)}else T("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else ki(Ne,me)}if(di.call(ct,"key")){var Ke=G(me),ot=Object.keys(ct).filter(function(Kt){return Kt!=="key"}),wt=ot.length>0?"{key: someKey, "+ot.join(": ..., ")+": ...}":"{key: someKey}";if(!sn[Ke+wt]){var qt=ot.length>0?"{"+ot.join(": ..., ")+": ...}":"{}";T(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,wt,Ke,qt,Ke),sn[Ke+wt]=!0}}return me===n?Ur(ge):An(ge),ge}}function yn(me,ct,St){return xs(me,ct,St,!0)}function Ls(me,ct,St){return xs(me,ct,St,!1)}var rs=Ls,bs=yn;cx.Fragment=n,cx.jsx=rs,cx.jsxs=bs}()),cx}process.env.NODE_ENV==="production"?b2.exports=DQ():b2.exports=OQ();var rr=b2.exports;function PQ(r,e){var i=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(i!=null){var n,s,o,l,u=[],c=!0,h=!1;try{if(o=(i=i.call(r)).next,e===0){if(Object(i)!==i)return;c=!1}else for(;!(c=(n=o.call(i)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(p){h=!0,s=p}finally{try{if(!c&&i.return!=null&&(l=i.return(),Object(l)!==l))return}finally{if(h)throw s}}return u}}function kQ(r,e,i){return e=WQ(e),e in r?Object.defineProperty(r,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[e]=i,r}function ED(r,e){return zQ(r)||PQ(r,e)||wD(r,e)||GQ()}function FQ(r){return UQ(r)||jQ(r)||wD(r)||VQ()}function UQ(r){if(Array.isArray(r))return _2(r)}function zQ(r){if(Array.isArray(r))return r}function jQ(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function wD(r,e){if(r){if(typeof r=="string")return _2(r,e);var i=Object.prototype.toString.call(r).slice(8,-1);if(i==="Object"&&r.constructor&&(i=r.constructor.name),i==="Map"||i==="Set")return Array.from(r);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return _2(r,e)}}function _2(r,e){(e==null||e>r.length)&&(e=r.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=r[i];return n}function VQ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GQ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HQ(r,e){if(typeof r!="object"||r===null)return r;var i=r[Symbol.toPrimitive];if(i!==void 0){var n=i.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function WQ(r){var e=HQ(r,"string");return typeof e=="symbol"?e:String(e)}var QQ=function(r,e){var i=new Set(e);return Object.assign.apply(Object,[{}].concat(FQ(Object.entries(r).filter(function(n){var s=ED(n,1),o=s[0];return!i.has(o)}).map(function(n){var s=ED(n,2),o=s[0],l=s[1];return kQ({},o,l)}))))};function E2(r,e){(e==null||e>r.length)&&(e=r.length);for(var i=0,n=Array(e);i<e;i++)n[i]=r[i];return n}function qQ(r){if(Array.isArray(r))return r}function XQ(r){if(Array.isArray(r))return E2(r)}function YQ(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function KQ(r,e){var i=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(i!=null){var n,s,o,l,u=[],c=!0,h=!1;try{if(o=(i=i.call(r)).next,e!==0)for(;!(c=(n=o.call(i)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(p){h=!0,s=p}finally{try{if(!c&&i.return!=null&&(l=i.return(),Object(l)!==l))return}finally{if(h)throw s}}return u}}function JQ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZQ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $Q(r,e){return qQ(r)||KQ(r,e)||SD(r,e)||JQ()}function CD(r){return XQ(r)||YQ(r)||SD(r)||ZQ()}function SD(r,e){if(r){if(typeof r=="string")return E2(r,e);var i={}.toString.call(r).slice(8,-1);return i==="Object"&&r.constructor&&(i=r.constructor.name),i==="Map"||i==="Set"?Array.from(r):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?E2(r,e):void 0}}function ux(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=e.wrapperElementType,n=i===void 0?"div":i,s=e.nodeMapper,o=s===void 0?function(p){return p}:s,l=e.methodNames,u=l===void 0?[]:l,c=e.initPropNames,h=c===void 0?[]:c;return gi.forwardRef(function(p,f){var m=gi.useRef(),g=gi.useMemo(function(){var v=Object.fromEntries(h.filter(function(_){return p.hasOwnProperty(_)}).map(function(_){return[_,p[_]]}));return r(v)},[]);TD(function(){g(o(m.current))},gi.useLayoutEffect),TD(function(){return g._destructor instanceof Function?g._destructor:void 0});var y=gi.useCallback(function(v){for(var _=arguments.length,T=new Array(_>1?_-1:0),w=1;w<_;w++)T[w-1]=arguments[w];return g[v]instanceof Function?g[v].apply(g,T):void 0},[g]),x=gi.useRef({});return Object.keys(QQ(p,[].concat(CD(u),CD(h)))).filter(function(v){return x.current[v]!==p[v]}).forEach(function(v){return y(v,p[v])}),x.current=p,gi.useImperativeHandle(f,function(){return Object.fromEntries(u.map(function(v){return[v,function(){for(var _=arguments.length,T=new Array(_),w=0;w<_;w++)T[w]=arguments[w];return y.apply(void 0,[v].concat(T))}]}))},[y]),gi.createElement(n,{ref:m})})}function TD(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:gi.useEffect,i=gi.useRef(),n=gi.useRef(!1),s=gi.useRef(!1),o=gi.useState(0),l=$Q(o,2);l[0];var u=l[1];n.current&&(s.current=!0),e(function(){return n.current||(i.current=r(),n.current=!0),u(function(c){return c+1}),function(){s.current&&i.current&&i.current()}},[])}var eq={exports:{}};(function(r,e){(function(i,n){r.exports=n()})(self,()=>(()=>{var i={"./node_modules/an-array/index.js":l=>{var u=Object.prototype.toString;l.exports=c;function c(h){return h.BYTES_PER_ELEMENT&&u.call(h.buffer)==="[object ArrayBuffer]"||Array.isArray(h)}},"./node_modules/as-number/index.js":l=>{l.exports=function(u,c){return typeof u=="number"?u:typeof c=="number"?c:0}},"./node_modules/base64-js/index.js":(l,u)=>{u.byteLength=x,u.toByteArray=_,u.fromByteArray=S;for(var c=[],h=[],p=typeof Uint8Array<"u"?Uint8Array:Array,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",m=0,g=f.length;m<g;++m)c[m]=f[m],h[f.charCodeAt(m)]=m;h[45]=62,h[95]=63;function y(R){var B=R.length;if(B%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var I=R.indexOf("=");I===-1&&(I=B);var D=I===B?0:4-I%4;return[I,D]}function x(R){var B=y(R),I=B[0],D=B[1];return(I+D)*3/4-D}function v(R,B,I){return(B+I)*3/4-I}function _(R){var B,I=y(R),D=I[0],L=I[1],O=new p(v(R,D,L)),U=0,Z=L>0?D-4:D,G;for(G=0;G<Z;G+=4)B=h[R.charCodeAt(G)]<<18|h[R.charCodeAt(G+1)]<<12|h[R.charCodeAt(G+2)]<<6|h[R.charCodeAt(G+3)],O[U++]=B>>16&255,O[U++]=B>>8&255,O[U++]=B&255;return L===2&&(B=h[R.charCodeAt(G)]<<2|h[R.charCodeAt(G+1)]>>4,O[U++]=B&255),L===1&&(B=h[R.charCodeAt(G)]<<10|h[R.charCodeAt(G+1)]<<4|h[R.charCodeAt(G+2)]>>2,O[U++]=B>>8&255,O[U++]=B&255),O}function T(R){return c[R>>18&63]+c[R>>12&63]+c[R>>6&63]+c[R&63]}function w(R,B,I){for(var D,L=[],O=B;O<I;O+=3)D=(R[O]<<16&16711680)+(R[O+1]<<8&65280)+(R[O+2]&255),L.push(T(D));return L.join("")}function S(R){for(var B,I=R.length,D=I%3,L=[],O=16383,U=0,Z=I-D;U<Z;U+=O)L.push(w(R,U,U+O>Z?Z:U+O));return D===1?(B=R[I-1],L.push(c[B>>2]+c[B<<4&63]+"==")):D===2&&(B=(R[I-2]<<8)+R[I-1],L.push(c[B>>10]+c[B>>4&63]+c[B<<2&63]+"=")),L.join("")}},"./node_modules/buffer-equal/index.js":(l,u,c)=>{var h=c("./node_modules/buffer/index.js").Buffer;l.exports=function(p,f){if(h.isBuffer(p)&&h.isBuffer(f)){if(typeof p.equals=="function")return p.equals(f);if(p.length!==f.length)return!1;for(var m=0;m<p.length;m++)if(p[m]!==f[m])return!1;return!0}}},"./node_modules/buffer/index.js":(l,u,c)=>{/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */const h=c("./node_modules/base64-js/index.js"),p=c("./node_modules/ieee754/index.js"),f=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;u.Buffer=x,u.SlowBuffer=O,u.INSPECT_MAX_BYTES=50;const m=2147483647;u.kMaxLength=m,x.TYPED_ARRAY_SUPPORT=g(),!x.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function g(){try{const F=new Uint8Array(1),J={foo:function(){return 42}};return Object.setPrototypeOf(J,Uint8Array.prototype),Object.setPrototypeOf(F,J),F.foo()===42}catch{return!1}}Object.defineProperty(x.prototype,"parent",{enumerable:!0,get:function(){if(x.isBuffer(this))return this.buffer}}),Object.defineProperty(x.prototype,"offset",{enumerable:!0,get:function(){if(x.isBuffer(this))return this.byteOffset}});function y(F){if(F>m)throw new RangeError('The value "'+F+'" is invalid for option "size"');const J=new Uint8Array(F);return Object.setPrototypeOf(J,x.prototype),J}function x(F,J,ie){if(typeof F=="number"){if(typeof J=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return w(F)}return v(F,J,ie)}x.poolSize=8192;function v(F,J,ie){if(typeof F=="string")return S(F,J);if(ArrayBuffer.isView(F))return B(F);if(F==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof F);if(ve(F,ArrayBuffer)||F&&ve(F.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(ve(F,SharedArrayBuffer)||F&&ve(F.buffer,SharedArrayBuffer)))return I(F,J,ie);if(typeof F=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const Re=F.valueOf&&F.valueOf();if(Re!=null&&Re!==F)return x.from(Re,J,ie);const ce=D(F);if(ce)return ce;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof F[Symbol.toPrimitive]=="function")return x.from(F[Symbol.toPrimitive]("string"),J,ie);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof F)}x.from=function(F,J,ie){return v(F,J,ie)},Object.setPrototypeOf(x.prototype,Uint8Array.prototype),Object.setPrototypeOf(x,Uint8Array);function _(F){if(typeof F!="number")throw new TypeError('"size" argument must be of type number');if(F<0)throw new RangeError('The value "'+F+'" is invalid for option "size"')}function T(F,J,ie){return _(F),F<=0?y(F):J!==void 0?typeof ie=="string"?y(F).fill(J,ie):y(F).fill(J):y(F)}x.alloc=function(F,J,ie){return T(F,J,ie)};function w(F){return _(F),y(F<0?0:L(F)|0)}x.allocUnsafe=function(F){return w(F)},x.allocUnsafeSlow=function(F){return w(F)};function S(F,J){if((typeof J!="string"||J==="")&&(J="utf8"),!x.isEncoding(J))throw new TypeError("Unknown encoding: "+J);const ie=U(F,J)|0;let Re=y(ie);const ce=Re.write(F,J);return ce!==ie&&(Re=Re.slice(0,ce)),Re}function R(F){const J=F.length<0?0:L(F.length)|0,ie=y(J);for(let Re=0;Re<J;Re+=1)ie[Re]=F[Re]&255;return ie}function B(F){if(ve(F,Uint8Array)){const J=new Uint8Array(F);return I(J.buffer,J.byteOffset,J.byteLength)}return R(F)}function I(F,J,ie){if(J<0||F.byteLength<J)throw new RangeError('"offset" is outside of buffer bounds');if(F.byteLength<J+(ie||0))throw new RangeError('"length" is outside of buffer bounds');let Re;return J===void 0&&ie===void 0?Re=new Uint8Array(F):ie===void 0?Re=new Uint8Array(F,J):Re=new Uint8Array(F,J,ie),Object.setPrototypeOf(Re,x.prototype),Re}function D(F){if(x.isBuffer(F)){const J=L(F.length)|0,ie=y(J);return ie.length===0||F.copy(ie,0,0,J),ie}if(F.length!==void 0)return typeof F.length!="number"||Le(F.length)?y(0):R(F);if(F.type==="Buffer"&&Array.isArray(F.data))return R(F.data)}function L(F){if(F>=m)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+m.toString(16)+" bytes");return F|0}function O(F){return+F!=F&&(F=0),x.alloc(+F)}x.isBuffer=function(F){return F!=null&&F._isBuffer===!0&&F!==x.prototype},x.compare=function(F,J){if(ve(F,Uint8Array)&&(F=x.from(F,F.offset,F.byteLength)),ve(J,Uint8Array)&&(J=x.from(J,J.offset,J.byteLength)),!x.isBuffer(F)||!x.isBuffer(J))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(F===J)return 0;let ie=F.length,Re=J.length;for(let ce=0,Ue=Math.min(ie,Re);ce<Ue;++ce)if(F[ce]!==J[ce]){ie=F[ce],Re=J[ce];break}return ie<Re?-1:Re<ie?1:0},x.isEncoding=function(F){switch(String(F).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},x.concat=function(F,J){if(!Array.isArray(F))throw new TypeError('"list" argument must be an Array of Buffers');if(F.length===0)return x.alloc(0);let ie;if(J===void 0)for(J=0,ie=0;ie<F.length;++ie)J+=F[ie].length;const Re=x.allocUnsafe(J);let ce=0;for(ie=0;ie<F.length;++ie){let Ue=F[ie];if(ve(Ue,Uint8Array))ce+Ue.length>Re.length?(x.isBuffer(Ue)||(Ue=x.from(Ue)),Ue.copy(Re,ce)):Uint8Array.prototype.set.call(Re,Ue,ce);else if(x.isBuffer(Ue))Ue.copy(Re,ce);else throw new TypeError('"list" argument must be an Array of Buffers');ce+=Ue.length}return Re};function U(F,J){if(x.isBuffer(F))return F.length;if(ArrayBuffer.isView(F)||ve(F,ArrayBuffer))return F.byteLength;if(typeof F!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof F);const ie=F.length,Re=arguments.length>2&&arguments[2]===!0;if(!Re&&ie===0)return 0;let ce=!1;for(;;)switch(J){case"ascii":case"latin1":case"binary":return ie;case"utf8":case"utf-8":return Jt(F).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ie*2;case"hex":return ie>>>1;case"base64":return vt(F).length;default:if(ce)return Re?-1:Jt(F).length;J=(""+J).toLowerCase(),ce=!0}}x.byteLength=U;function Z(F,J,ie){let Re=!1;if((J===void 0||J<0)&&(J=0),J>this.length||((ie===void 0||ie>this.length)&&(ie=this.length),ie<=0)||(ie>>>=0,J>>>=0,ie<=J))return"";for(F||(F="utf8");;)switch(F){case"hex":return Xe(this,J,ie);case"utf8":case"utf-8":return xe(this,J,ie);case"ascii":return Ie(this,J,ie);case"latin1":case"binary":return Ge(this,J,ie);case"base64":return ae(this,J,ie);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return $e(this,J,ie);default:if(Re)throw new TypeError("Unknown encoding: "+F);F=(F+"").toLowerCase(),Re=!0}}x.prototype._isBuffer=!0;function G(F,J,ie){const Re=F[J];F[J]=F[ie],F[ie]=Re}x.prototype.swap16=function(){const F=this.length;if(F%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let J=0;J<F;J+=2)G(this,J,J+1);return this},x.prototype.swap32=function(){const F=this.length;if(F%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let J=0;J<F;J+=4)G(this,J,J+3),G(this,J+1,J+2);return this},x.prototype.swap64=function(){const F=this.length;if(F%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let J=0;J<F;J+=8)G(this,J,J+7),G(this,J+1,J+6),G(this,J+2,J+5),G(this,J+3,J+4);return this},x.prototype.toString=function(){const F=this.length;return F===0?"":arguments.length===0?xe(this,0,F):Z.apply(this,arguments)},x.prototype.toLocaleString=x.prototype.toString,x.prototype.equals=function(F){if(!x.isBuffer(F))throw new TypeError("Argument must be a Buffer");return this===F?!0:x.compare(this,F)===0},x.prototype.inspect=function(){let F="";const J=u.INSPECT_MAX_BYTES;return F=this.toString("hex",0,J).replace(/(.{2})/g,"$1 ").trim(),this.length>J&&(F+=" ... "),"<Buffer "+F+">"},f&&(x.prototype[f]=x.prototype.inspect),x.prototype.compare=function(F,J,ie,Re,ce){if(ve(F,Uint8Array)&&(F=x.from(F,F.offset,F.byteLength)),!x.isBuffer(F))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof F);if(J===void 0&&(J=0),ie===void 0&&(ie=F?F.length:0),Re===void 0&&(Re=0),ce===void 0&&(ce=this.length),J<0||ie>F.length||Re<0||ce>this.length)throw new RangeError("out of range index");if(Re>=ce&&J>=ie)return 0;if(Re>=ce)return-1;if(J>=ie)return 1;if(J>>>=0,ie>>>=0,Re>>>=0,ce>>>=0,this===F)return 0;let Ue=ce-Re,je=ie-J;const dt=Math.min(Ue,je),It=this.slice(Re,ce),bt=F.slice(J,ie);for(let Ut=0;Ut<dt;++Ut)if(It[Ut]!==bt[Ut]){Ue=It[Ut],je=bt[Ut];break}return Ue<je?-1:je<Ue?1:0};function z(F,J,ie,Re,ce){if(F.length===0)return-1;if(typeof ie=="string"?(Re=ie,ie=0):ie>2147483647?ie=2147483647:ie<-2147483648&&(ie=-2147483648),ie=+ie,Le(ie)&&(ie=ce?0:F.length-1),ie<0&&(ie=F.length+ie),ie>=F.length){if(ce)return-1;ie=F.length-1}else if(ie<0)if(ce)ie=0;else return-1;if(typeof J=="string"&&(J=x.from(J,Re)),x.isBuffer(J))return J.length===0?-1:$(F,J,ie,Re,ce);if(typeof J=="number")return J=J&255,typeof Uint8Array.prototype.indexOf=="function"?ce?Uint8Array.prototype.indexOf.call(F,J,ie):Uint8Array.prototype.lastIndexOf.call(F,J,ie):$(F,[J],ie,Re,ce);throw new TypeError("val must be string, number or Buffer")}function $(F,J,ie,Re,ce){let Ue=1,je=F.length,dt=J.length;if(Re!==void 0&&(Re=String(Re).toLowerCase(),Re==="ucs2"||Re==="ucs-2"||Re==="utf16le"||Re==="utf-16le")){if(F.length<2||J.length<2)return-1;Ue=2,je/=2,dt/=2,ie/=2}function It(Ut,pi){return Ue===1?Ut[pi]:Ut.readUInt16BE(pi*Ue)}let bt;if(ce){let Ut=-1;for(bt=ie;bt<je;bt++)if(It(F,bt)===It(J,Ut===-1?0:bt-Ut)){if(Ut===-1&&(Ut=bt),bt-Ut+1===dt)return Ut*Ue}else Ut!==-1&&(bt-=bt-Ut),Ut=-1}else for(ie+dt>je&&(ie=je-dt),bt=ie;bt>=0;bt--){let Ut=!0;for(let pi=0;pi<dt;pi++)if(It(F,bt+pi)!==It(J,pi)){Ut=!1;break}if(Ut)return bt}return-1}x.prototype.includes=function(F,J,ie){return this.indexOf(F,J,ie)!==-1},x.prototype.indexOf=function(F,J,ie){return z(this,F,J,ie,!0)},x.prototype.lastIndexOf=function(F,J,ie){return z(this,F,J,ie,!1)};function Q(F,J,ie,Re){ie=Number(ie)||0;const ce=F.length-ie;Re?(Re=Number(Re),Re>ce&&(Re=ce)):Re=ce;const Ue=J.length;Re>Ue/2&&(Re=Ue/2);let je;for(je=0;je<Re;++je){const dt=parseInt(J.substr(je*2,2),16);if(Le(dt))return je;F[ie+je]=dt}return je}function H(F,J,ie,Re){return ye(Jt(J,F.length-ie),F,ie,Re)}function V(F,J,ie,Re){return ye(zt(J),F,ie,Re)}function ne(F,J,ie,Re){return ye(vt(J),F,ie,Re)}function Y(F,J,ie,Re){return ye(_i(J,F.length-ie),F,ie,Re)}x.prototype.write=function(F,J,ie,Re){if(J===void 0)Re="utf8",ie=this.length,J=0;else if(ie===void 0&&typeof J=="string")Re=J,ie=this.length,J=0;else if(isFinite(J))J=J>>>0,isFinite(ie)?(ie=ie>>>0,Re===void 0&&(Re="utf8")):(Re=ie,ie=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const ce=this.length-J;if((ie===void 0||ie>ce)&&(ie=ce),F.length>0&&(ie<0||J<0)||J>this.length)throw new RangeError("Attempt to write outside buffer bounds");Re||(Re="utf8");let Ue=!1;for(;;)switch(Re){case"hex":return Q(this,F,J,ie);case"utf8":case"utf-8":return H(this,F,J,ie);case"ascii":case"latin1":case"binary":return V(this,F,J,ie);case"base64":return ne(this,F,J,ie);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Y(this,F,J,ie);default:if(Ue)throw new TypeError("Unknown encoding: "+Re);Re=(""+Re).toLowerCase(),Ue=!0}},x.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function ae(F,J,ie){return J===0&&ie===F.length?h.fromByteArray(F):h.fromByteArray(F.slice(J,ie))}function xe(F,J,ie){ie=Math.min(F.length,ie);const Re=[];let ce=J;for(;ce<ie;){const Ue=F[ce];let je=null,dt=Ue>239?4:Ue>223?3:Ue>191?2:1;if(ce+dt<=ie){let It,bt,Ut,pi;switch(dt){case 1:Ue<128&&(je=Ue);break;case 2:It=F[ce+1],(It&192)===128&&(pi=(Ue&31)<<6|It&63,pi>127&&(je=pi));break;case 3:It=F[ce+1],bt=F[ce+2],(It&192)===128&&(bt&192)===128&&(pi=(Ue&15)<<12|(It&63)<<6|bt&63,pi>2047&&(pi<55296||pi>57343)&&(je=pi));break;case 4:It=F[ce+1],bt=F[ce+2],Ut=F[ce+3],(It&192)===128&&(bt&192)===128&&(Ut&192)===128&&(pi=(Ue&15)<<18|(It&63)<<12|(bt&63)<<6|Ut&63,pi>65535&&pi<1114112&&(je=pi))}}je===null?(je=65533,dt=1):je>65535&&(je-=65536,Re.push(je>>>10&1023|55296),je=56320|je&1023),Re.push(je),ce+=dt}return de(Re)}const fe=4096;function de(F){const J=F.length;if(J<=fe)return String.fromCharCode.apply(String,F);let ie="",Re=0;for(;Re<J;)ie+=String.fromCharCode.apply(String,F.slice(Re,Re+=fe));return ie}function Ie(F,J,ie){let Re="";ie=Math.min(F.length,ie);for(let ce=J;ce<ie;++ce)Re+=String.fromCharCode(F[ce]&127);return Re}function Ge(F,J,ie){let Re="";ie=Math.min(F.length,ie);for(let ce=J;ce<ie;++ce)Re+=String.fromCharCode(F[ce]);return Re}function Xe(F,J,ie){const Re=F.length;(!J||J<0)&&(J=0),(!ie||ie<0||ie>Re)&&(ie=Re);let ce="";for(let Ue=J;Ue<ie;++Ue)ce+=Te[F[Ue]];return ce}function $e(F,J,ie){const Re=F.slice(J,ie);let ce="";for(let Ue=0;Ue<Re.length-1;Ue+=2)ce+=String.fromCharCode(Re[Ue]+Re[Ue+1]*256);return ce}x.prototype.slice=function(F,J){const ie=this.length;F=~~F,J=J===void 0?ie:~~J,F<0?(F+=ie,F<0&&(F=0)):F>ie&&(F=ie),J<0?(J+=ie,J<0&&(J=0)):J>ie&&(J=ie),J<F&&(J=F);const Re=this.subarray(F,J);return Object.setPrototypeOf(Re,x.prototype),Re};function lt(F,J,ie){if(F%1!==0||F<0)throw new RangeError("offset is not uint");if(F+J>ie)throw new RangeError("Trying to access beyond buffer length")}x.prototype.readUintLE=x.prototype.readUIntLE=function(F,J,ie){F=F>>>0,J=J>>>0,ie||lt(F,J,this.length);let Re=this[F],ce=1,Ue=0;for(;++Ue<J&&(ce*=256);)Re+=this[F+Ue]*ce;return Re},x.prototype.readUintBE=x.prototype.readUIntBE=function(F,J,ie){F=F>>>0,J=J>>>0,ie||lt(F,J,this.length);let Re=this[F+--J],ce=1;for(;J>0&&(ce*=256);)Re+=this[F+--J]*ce;return Re},x.prototype.readUint8=x.prototype.readUInt8=function(F,J){return F=F>>>0,J||lt(F,1,this.length),this[F]},x.prototype.readUint16LE=x.prototype.readUInt16LE=function(F,J){return F=F>>>0,J||lt(F,2,this.length),this[F]|this[F+1]<<8},x.prototype.readUint16BE=x.prototype.readUInt16BE=function(F,J){return F=F>>>0,J||lt(F,2,this.length),this[F]<<8|this[F+1]},x.prototype.readUint32LE=x.prototype.readUInt32LE=function(F,J){return F=F>>>0,J||lt(F,4,this.length),(this[F]|this[F+1]<<8|this[F+2]<<16)+this[F+3]*16777216},x.prototype.readUint32BE=x.prototype.readUInt32BE=function(F,J){return F=F>>>0,J||lt(F,4,this.length),this[F]*16777216+(this[F+1]<<16|this[F+2]<<8|this[F+3])},x.prototype.readBigUInt64LE=ke(function(F){F=F>>>0,Qe(F,"offset");const J=this[F],ie=this[F+7];(J===void 0||ie===void 0)&&Ce(F,this.length-8);const Re=J+this[++F]*2**8+this[++F]*2**16+this[++F]*2**24,ce=this[++F]+this[++F]*2**8+this[++F]*2**16+ie*2**24;return BigInt(Re)+(BigInt(ce)<<BigInt(32))}),x.prototype.readBigUInt64BE=ke(function(F){F=F>>>0,Qe(F,"offset");const J=this[F],ie=this[F+7];(J===void 0||ie===void 0)&&Ce(F,this.length-8);const Re=J*2**24+this[++F]*2**16+this[++F]*2**8+this[++F],ce=this[++F]*2**24+this[++F]*2**16+this[++F]*2**8+ie;return(BigInt(Re)<<BigInt(32))+BigInt(ce)}),x.prototype.readIntLE=function(F,J,ie){F=F>>>0,J=J>>>0,ie||lt(F,J,this.length);let Re=this[F],ce=1,Ue=0;for(;++Ue<J&&(ce*=256);)Re+=this[F+Ue]*ce;return ce*=128,Re>=ce&&(Re-=Math.pow(2,8*J)),Re},x.prototype.readIntBE=function(F,J,ie){F=F>>>0,J=J>>>0,ie||lt(F,J,this.length);let Re=J,ce=1,Ue=this[F+--Re];for(;Re>0&&(ce*=256);)Ue+=this[F+--Re]*ce;return ce*=128,Ue>=ce&&(Ue-=Math.pow(2,8*J)),Ue},x.prototype.readInt8=function(F,J){return F=F>>>0,J||lt(F,1,this.length),this[F]&128?(255-this[F]+1)*-1:this[F]},x.prototype.readInt16LE=function(F,J){F=F>>>0,J||lt(F,2,this.length);const ie=this[F]|this[F+1]<<8;return ie&32768?ie|4294901760:ie},x.prototype.readInt16BE=function(F,J){F=F>>>0,J||lt(F,2,this.length);const ie=this[F+1]|this[F]<<8;return ie&32768?ie|4294901760:ie},x.prototype.readInt32LE=function(F,J){return F=F>>>0,J||lt(F,4,this.length),this[F]|this[F+1]<<8|this[F+2]<<16|this[F+3]<<24},x.prototype.readInt32BE=function(F,J){return F=F>>>0,J||lt(F,4,this.length),this[F]<<24|this[F+1]<<16|this[F+2]<<8|this[F+3]},x.prototype.readBigInt64LE=ke(function(F){F=F>>>0,Qe(F,"offset");const J=this[F],ie=this[F+7];(J===void 0||ie===void 0)&&Ce(F,this.length-8);const Re=this[F+4]+this[F+5]*2**8+this[F+6]*2**16+(ie<<24);return(BigInt(Re)<<BigInt(32))+BigInt(J+this[++F]*256+this[++F]*65536+this[++F]*16777216)}),x.prototype.readBigInt64BE=ke(function(F){F=F>>>0,Qe(F,"offset");const J=this[F],ie=this[F+7];(J===void 0||ie===void 0)&&Ce(F,this.length-8);const Re=(J<<24)+this[++F]*2**16+this[++F]*2**8+this[++F];return(BigInt(Re)<<BigInt(32))+BigInt(this[++F]*16777216+this[++F]*65536+this[++F]*256+ie)}),x.prototype.readFloatLE=function(F,J){return F=F>>>0,J||lt(F,4,this.length),p.read(this,F,!0,23,4)},x.prototype.readFloatBE=function(F,J){return F=F>>>0,J||lt(F,4,this.length),p.read(this,F,!1,23,4)},x.prototype.readDoubleLE=function(F,J){return F=F>>>0,J||lt(F,8,this.length),p.read(this,F,!0,52,8)},x.prototype.readDoubleBE=function(F,J){return F=F>>>0,J||lt(F,8,this.length),p.read(this,F,!1,52,8)};function At(F,J,ie,Re,ce,Ue){if(!x.isBuffer(F))throw new TypeError('"buffer" argument must be a Buffer instance');if(J>ce||J<Ue)throw new RangeError('"value" argument is out of bounds');if(ie+Re>F.length)throw new RangeError("Index out of range")}x.prototype.writeUintLE=x.prototype.writeUIntLE=function(F,J,ie,Re){if(F=+F,J=J>>>0,ie=ie>>>0,!Re){const je=Math.pow(2,8*ie)-1;At(this,F,J,ie,je,0)}let ce=1,Ue=0;for(this[J]=F&255;++Ue<ie&&(ce*=256);)this[J+Ue]=F/ce&255;return J+ie},x.prototype.writeUintBE=x.prototype.writeUIntBE=function(F,J,ie,Re){if(F=+F,J=J>>>0,ie=ie>>>0,!Re){const je=Math.pow(2,8*ie)-1;At(this,F,J,ie,je,0)}let ce=ie-1,Ue=1;for(this[J+ce]=F&255;--ce>=0&&(Ue*=256);)this[J+ce]=F/Ue&255;return J+ie},x.prototype.writeUint8=x.prototype.writeUInt8=function(F,J,ie){return F=+F,J=J>>>0,ie||At(this,F,J,1,255,0),this[J]=F&255,J+1},x.prototype.writeUint16LE=x.prototype.writeUInt16LE=function(F,J,ie){return F=+F,J=J>>>0,ie||At(this,F,J,2,65535,0),this[J]=F&255,this[J+1]=F>>>8,J+2},x.prototype.writeUint16BE=x.prototype.writeUInt16BE=function(F,J,ie){return F=+F,J=J>>>0,ie||At(this,F,J,2,65535,0),this[J]=F>>>8,this[J+1]=F&255,J+2},x.prototype.writeUint32LE=x.prototype.writeUInt32LE=function(F,J,ie){return F=+F,J=J>>>0,ie||At(this,F,J,4,4294967295,0),this[J+3]=F>>>24,this[J+2]=F>>>16,this[J+1]=F>>>8,this[J]=F&255,J+4},x.prototype.writeUint32BE=x.prototype.writeUInt32BE=function(F,J,ie){return F=+F,J=J>>>0,ie||At(this,F,J,4,4294967295,0),this[J]=F>>>24,this[J+1]=F>>>16,this[J+2]=F>>>8,this[J+3]=F&255,J+4};function Gt(F,J,ie,Re,ce){Gi(J,Re,ce,F,ie,7);let Ue=Number(J&BigInt(4294967295));F[ie++]=Ue,Ue=Ue>>8,F[ie++]=Ue,Ue=Ue>>8,F[ie++]=Ue,Ue=Ue>>8,F[ie++]=Ue;let je=Number(J>>BigInt(32)&BigInt(4294967295));return F[ie++]=je,je=je>>8,F[ie++]=je,je=je>>8,F[ie++]=je,je=je>>8,F[ie++]=je,ie}function gt(F,J,ie,Re,ce){Gi(J,Re,ce,F,ie,7);let Ue=Number(J&BigInt(4294967295));F[ie+7]=Ue,Ue=Ue>>8,F[ie+6]=Ue,Ue=Ue>>8,F[ie+5]=Ue,Ue=Ue>>8,F[ie+4]=Ue;let je=Number(J>>BigInt(32)&BigInt(4294967295));return F[ie+3]=je,je=je>>8,F[ie+2]=je,je=je>>8,F[ie+1]=je,je=je>>8,F[ie]=je,ie+8}x.prototype.writeBigUInt64LE=ke(function(F,J=0){return Gt(this,F,J,BigInt(0),BigInt("0xffffffffffffffff"))}),x.prototype.writeBigUInt64BE=ke(function(F,J=0){return gt(this,F,J,BigInt(0),BigInt("0xffffffffffffffff"))}),x.prototype.writeIntLE=function(F,J,ie,Re){if(F=+F,J=J>>>0,!Re){const dt=Math.pow(2,8*ie-1);At(this,F,J,ie,dt-1,-dt)}let ce=0,Ue=1,je=0;for(this[J]=F&255;++ce<ie&&(Ue*=256);)F<0&&je===0&&this[J+ce-1]!==0&&(je=1),this[J+ce]=(F/Ue>>0)-je&255;return J+ie},x.prototype.writeIntBE=function(F,J,ie,Re){if(F=+F,J=J>>>0,!Re){const dt=Math.pow(2,8*ie-1);At(this,F,J,ie,dt-1,-dt)}let ce=ie-1,Ue=1,je=0;for(this[J+ce]=F&255;--ce>=0&&(Ue*=256);)F<0&&je===0&&this[J+ce+1]!==0&&(je=1),this[J+ce]=(F/Ue>>0)-je&255;return J+ie},x.prototype.writeInt8=function(F,J,ie){return F=+F,J=J>>>0,ie||At(this,F,J,1,127,-128),F<0&&(F=255+F+1),this[J]=F&255,J+1},x.prototype.writeInt16LE=function(F,J,ie){return F=+F,J=J>>>0,ie||At(this,F,J,2,32767,-32768),this[J]=F&255,this[J+1]=F>>>8,J+2},x.prototype.writeInt16BE=function(F,J,ie){return F=+F,J=J>>>0,ie||At(this,F,J,2,32767,-32768),this[J]=F>>>8,this[J+1]=F&255,J+2},x.prototype.writeInt32LE=function(F,J,ie){return F=+F,J=J>>>0,ie||At(this,F,J,4,2147483647,-2147483648),this[J]=F&255,this[J+1]=F>>>8,this[J+2]=F>>>16,this[J+3]=F>>>24,J+4},x.prototype.writeInt32BE=function(F,J,ie){return F=+F,J=J>>>0,ie||At(this,F,J,4,2147483647,-2147483648),F<0&&(F=4294967295+F+1),this[J]=F>>>24,this[J+1]=F>>>16,this[J+2]=F>>>8,this[J+3]=F&255,J+4},x.prototype.writeBigInt64LE=ke(function(F,J=0){return Gt(this,F,J,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),x.prototype.writeBigInt64BE=ke(function(F,J=0){return gt(this,F,J,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function xi(F,J,ie,Re,ce,Ue){if(ie+Re>F.length)throw new RangeError("Index out of range");if(ie<0)throw new RangeError("Index out of range")}function Ze(F,J,ie,Re,ce){return J=+J,ie=ie>>>0,ce||xi(F,J,ie,4),p.write(F,J,ie,Re,23,4),ie+4}x.prototype.writeFloatLE=function(F,J,ie){return Ze(this,F,J,!0,ie)},x.prototype.writeFloatBE=function(F,J,ie){return Ze(this,F,J,!1,ie)};function Ui(F,J,ie,Re,ce){return J=+J,ie=ie>>>0,ce||xi(F,J,ie,8),p.write(F,J,ie,Re,52,8),ie+8}x.prototype.writeDoubleLE=function(F,J,ie){return Ui(this,F,J,!0,ie)},x.prototype.writeDoubleBE=function(F,J,ie){return Ui(this,F,J,!1,ie)},x.prototype.copy=function(F,J,ie,Re){if(!x.isBuffer(F))throw new TypeError("argument should be a Buffer");if(ie||(ie=0),!Re&&Re!==0&&(Re=this.length),J>=F.length&&(J=F.length),J||(J=0),Re>0&&Re<ie&&(Re=ie),Re===ie||F.length===0||this.length===0)return 0;if(J<0)throw new RangeError("targetStart out of bounds");if(ie<0||ie>=this.length)throw new RangeError("Index out of range");if(Re<0)throw new RangeError("sourceEnd out of bounds");Re>this.length&&(Re=this.length),F.length-J<Re-ie&&(Re=F.length-J+ie);const ce=Re-ie;return this===F&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(J,ie,Re):Uint8Array.prototype.set.call(F,this.subarray(ie,Re),J),ce},x.prototype.fill=function(F,J,ie,Re){if(typeof F=="string"){if(typeof J=="string"?(Re=J,J=0,ie=this.length):typeof ie=="string"&&(Re=ie,ie=this.length),Re!==void 0&&typeof Re!="string")throw new TypeError("encoding must be a string");if(typeof Re=="string"&&!x.isEncoding(Re))throw new TypeError("Unknown encoding: "+Re);if(F.length===1){const Ue=F.charCodeAt(0);(Re==="utf8"&&Ue<128||Re==="latin1")&&(F=Ue)}}else typeof F=="number"?F=F&255:typeof F=="boolean"&&(F=Number(F));if(J<0||this.length<J||this.length<ie)throw new RangeError("Out of range index");if(ie<=J)return this;J=J>>>0,ie=ie===void 0?this.length:ie>>>0,F||(F=0);let ce;if(typeof F=="number")for(ce=J;ce<ie;++ce)this[ce]=F;else{const Ue=x.isBuffer(F)?F:x.from(F,Re),je=Ue.length;if(je===0)throw new TypeError('The value "'+F+'" is invalid for argument "value"');for(ce=0;ce<ie-J;++ce)this[ce+J]=Ue[ce%je]}return this};const di={};function Ii(F,J,ie){di[F]=class extends ie{constructor(){super(),Object.defineProperty(this,"message",{value:J.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${F}]`,this.stack,delete this.name}get code(){return F}set code(Re){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Re,writable:!0})}toString(){return`${this.name} [${F}]: ${this.message}`}}}Ii("ERR_BUFFER_OUT_OF_BOUNDS",function(F){return F?`${F} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Ii("ERR_INVALID_ARG_TYPE",function(F,J){return`The "${F}" argument must be of type number. Received type ${typeof J}`},TypeError),Ii("ERR_OUT_OF_RANGE",function(F,J,ie){let Re=`The value of "${F}" is out of range.`,ce=ie;return Number.isInteger(ie)&&Math.abs(ie)>4294967296?ce=Ti(String(ie)):typeof ie=="bigint"&&(ce=String(ie),(ie>BigInt(2)**BigInt(32)||ie<-(BigInt(2)**BigInt(32)))&&(ce=Ti(ce)),ce+="n"),Re+=` It must be ${J}. Received ${ce}`,Re},RangeError);function Ti(F){let J="",ie=F.length;const Re=F[0]==="-"?1:0;for(;ie>=Re+4;ie-=3)J=`_${F.slice(ie-3,ie)}${J}`;return`${F.slice(0,ie)}${J}`}function ir(F,J,ie){Qe(J,"offset"),(F[J]===void 0||F[J+ie]===void 0)&&Ce(J,F.length-(ie+1))}function Gi(F,J,ie,Re,ce,Ue){if(F>ie||F<J){const je=typeof J=="bigint"?"n":"";let dt;throw J===0||J===BigInt(0)?dt=`>= 0${je} and < 2${je} ** ${(Ue+1)*8}${je}`:dt=`>= -(2${je} ** ${(Ue+1)*8-1}${je}) and < 2 ** ${(Ue+1)*8-1}${je}`,new di.ERR_OUT_OF_RANGE("value",dt,F)}ir(Re,ce,Ue)}function Qe(F,J){if(typeof F!="number")throw new di.ERR_INVALID_ARG_TYPE(J,"number",F)}function Ce(F,J,ie){throw Math.floor(F)!==F?(Qe(F,ie),new di.ERR_OUT_OF_RANGE("offset","an integer",F)):J<0?new di.ERR_BUFFER_OUT_OF_BOUNDS:new di.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${J}`,F)}const yt=/[^+/0-9A-Za-z-_]/g;function Ot(F){if(F=F.split("=")[0],F=F.trim().replace(yt,""),F.length<2)return"";for(;F.length%4!==0;)F=F+"=";return F}function Jt(F,J){J=J||1/0;let ie;const Re=F.length;let ce=null;const Ue=[];for(let je=0;je<Re;++je){if(ie=F.charCodeAt(je),ie>55295&&ie<57344){if(!ce){if(ie>56319){(J-=3)>-1&&Ue.push(239,191,189);continue}else if(je+1===Re){(J-=3)>-1&&Ue.push(239,191,189);continue}ce=ie;continue}if(ie<56320){(J-=3)>-1&&Ue.push(239,191,189),ce=ie;continue}ie=(ce-55296<<10|ie-56320)+65536}else ce&&(J-=3)>-1&&Ue.push(239,191,189);if(ce=null,ie<128){if((J-=1)<0)break;Ue.push(ie)}else if(ie<2048){if((J-=2)<0)break;Ue.push(ie>>6|192,ie&63|128)}else if(ie<65536){if((J-=3)<0)break;Ue.push(ie>>12|224,ie>>6&63|128,ie&63|128)}else if(ie<1114112){if((J-=4)<0)break;Ue.push(ie>>18|240,ie>>12&63|128,ie>>6&63|128,ie&63|128)}else throw new Error("Invalid code point")}return Ue}function zt(F){const J=[];for(let ie=0;ie<F.length;++ie)J.push(F.charCodeAt(ie)&255);return J}function _i(F,J){let ie,Re,ce;const Ue=[];for(let je=0;je<F.length&&!((J-=2)<0);++je)ie=F.charCodeAt(je),Re=ie>>8,ce=ie%256,Ue.push(ce),Ue.push(Re);return Ue}function vt(F){return h.toByteArray(Ot(F))}function ye(F,J,ie,Re){let ce;for(ce=0;ce<Re&&!(ce+ie>=J.length||ce>=F.length);++ce)J[ce+ie]=F[ce];return ce}function ve(F,J){return F instanceof J||F!=null&&F.constructor!=null&&F.constructor.name!=null&&F.constructor.name===J.name}function Le(F){return F!==F}const Te=function(){const F="0123456789abcdef",J=new Array(256);for(let ie=0;ie<16;++ie){const Re=ie*16;for(let ce=0;ce<16;++ce)J[Re+ce]=F[ie]+F[ce]}return J}();function ke(F){return typeof BigInt>"u"?Pe:F}function Pe(){throw new Error("BigInt not supported")}},"./node_modules/css-loader/dist/runtime/api.js":l=>{l.exports=function(u){var c=[];return c.toString=function(){return this.map(function(h){var p="",f=typeof h[5]<"u";return h[4]&&(p+="@supports (".concat(h[4],") {")),h[2]&&(p+="@media ".concat(h[2]," {")),f&&(p+="@layer".concat(h[5].length>0?" ".concat(h[5]):""," {")),p+=u(h),f&&(p+="}"),h[2]&&(p+="}"),h[4]&&(p+="}"),p}).join("")},c.i=function(h,p,f,m,g){typeof h=="string"&&(h=[[null,h,void 0]]);var y={};if(f)for(var x=0;x<this.length;x++){var v=this[x][0];v!=null&&(y[v]=!0)}for(var _=0;_<h.length;_++){var T=[].concat(h[_]);f&&y[T[0]]||(typeof g<"u"&&(typeof T[5]>"u"||(T[1]="@layer".concat(T[5].length>0?" ".concat(T[5]):""," {").concat(T[1],"}")),T[5]=g),p&&(T[2]&&(T[1]="@media ".concat(T[2]," {").concat(T[1],"}")),T[2]=p),m&&(T[4]?(T[1]="@supports (".concat(T[4],") {").concat(T[1],"}"),T[4]=m):T[4]="".concat(m)),c.push(T))}},c}},"./node_modules/css-loader/dist/runtime/getUrl.js":l=>{l.exports=function(u,c){return c||(c={}),u&&(u=String(u.__esModule?u.default:u),/^['"].*['"]$/.test(u)&&(u=u.slice(1,-1)),c.hash&&(u+=c.hash),/["'() \t\n]|(%20)/.test(u)||c.needQuotes?'"'.concat(u.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):u)}},"./node_modules/css-loader/dist/runtime/sourceMaps.js":l=>{l.exports=function(u){var c=u[1],h=u[3];if(!h)return c;if(typeof btoa=="function"){var p=btoa(unescape(encodeURIComponent(JSON.stringify(h)))),f="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(p),m="/*# ".concat(f," */");return[c].concat([m]).join(`
`)}return[c].join(`
`)}},"./node_modules/debug/src/browser.js":(l,u,c)=>{u.formatArgs=p,u.save=f,u.load=m,u.useColors=h,u.storage=g(),u.destroy=(()=>{let x=!1;return()=>{x||(x=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),u.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function h(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function p(x){if(x[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+x[0]+(this.useColors?"%c ":" ")+"+"+l.exports.humanize(this.diff),!this.useColors)return;const v="color: "+this.color;x.splice(1,0,v,"color: inherit");let _=0,T=0;x[0].replace(/%[a-zA-Z%]/g,w=>{w!=="%%"&&(_++,w==="%c"&&(T=_))}),x.splice(T,0,v)}u.log=console.debug||console.log||(()=>{});function f(x){try{x?u.storage.setItem("debug",x):u.storage.removeItem("debug")}catch{}}function m(){let x;try{x=u.storage.getItem("debug")}catch{}return!x&&typeof process<"u"&&"env"in process&&(x=process.env.DEBUG),x}function g(){try{return localStorage}catch{}}l.exports=c("./node_modules/debug/src/common.js")(u);const{formatters:y}=l.exports;y.j=function(x){try{return JSON.stringify(x)}catch(v){return"[UnexpectedJSONParseError]: "+v.message}}},"./node_modules/debug/src/common.js":(l,u,c)=>{function h(p){m.debug=m,m.default=m,m.coerce=T,m.disable=x,m.enable=y,m.enabled=v,m.humanize=c("./node_modules/ms/index.js"),m.destroy=w,Object.keys(p).forEach(S=>{m[S]=p[S]}),m.names=[],m.skips=[],m.formatters={};function f(S){let R=0;for(let B=0;B<S.length;B++)R=(R<<5)-R+S.charCodeAt(B),R|=0;return m.colors[Math.abs(R)%m.colors.length]}m.selectColor=f;function m(S){let R,B=null,I,D;function L(...O){if(!L.enabled)return;const U=L,Z=Number(new Date),G=Z-(R||Z);U.diff=G,U.prev=R,U.curr=Z,R=Z,O[0]=m.coerce(O[0]),typeof O[0]!="string"&&O.unshift("%O");let z=0;O[0]=O[0].replace(/%([a-zA-Z%])/g,($,Q)=>{if($==="%%")return"%";z++;const H=m.formatters[Q];if(typeof H=="function"){const V=O[z];$=H.call(U,V),O.splice(z,1),z--}return $}),m.formatArgs.call(U,O),(U.log||m.log).apply(U,O)}return L.namespace=S,L.useColors=m.useColors(),L.color=m.selectColor(S),L.extend=g,L.destroy=m.destroy,Object.defineProperty(L,"enabled",{enumerable:!0,configurable:!1,get:()=>B!==null?B:(I!==m.namespaces&&(I=m.namespaces,D=m.enabled(S)),D),set:O=>{B=O}}),typeof m.init=="function"&&m.init(L),L}function g(S,R){const B=m(this.namespace+(typeof R>"u"?":":R)+S);return B.log=this.log,B}function y(S){m.save(S),m.namespaces=S,m.names=[],m.skips=[];let R;const B=(typeof S=="string"?S:"").split(/[\s,]+/),I=B.length;for(R=0;R<I;R++)B[R]&&(S=B[R].replace(/\*/g,".*?"),S[0]==="-"?m.skips.push(new RegExp("^"+S.slice(1)+"$")):m.names.push(new RegExp("^"+S+"$")))}function x(){const S=[...m.names.map(_),...m.skips.map(_).map(R=>"-"+R)].join(",");return m.enable(""),S}function v(S){if(S[S.length-1]==="*")return!0;let R,B;for(R=0,B=m.skips.length;R<B;R++)if(m.skips[R].test(S))return!1;for(R=0,B=m.names.length;R<B;R++)if(m.names[R].test(S))return!0;return!1}function _(S){return S.toString().substring(2,S.toString().length-2).replace(/\.\*\?$/,"*")}function T(S){return S instanceof Error?S.stack||S.message:S}function w(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return m.enable(m.load()),m}l.exports=h},"./node_modules/deep-assign/index.js":(l,u,c)=>{var h=c("./node_modules/is-obj/index.js"),p=Object.prototype.hasOwnProperty,f=Object.prototype.propertyIsEnumerable;function m(x){if(x==null)throw new TypeError("Sources cannot be null or undefined");return Object(x)}function g(x,v,_){var T=v[_];if(T!=null){if(p.call(x,_)&&(x[_]===void 0||x[_]===null))throw new TypeError("Cannot convert undefined or null to object ("+_+")");!p.call(x,_)||!h(T)?x[_]=T:x[_]=y(Object(x[_]),v[_])}}function y(x,v){if(x===v)return x;v=Object(v);for(var _ in v)p.call(v,_)&&g(x,v,_);if(Object.getOwnPropertySymbols)for(var T=Object.getOwnPropertySymbols(v),w=0;w<T.length;w++)f.call(v,T[w])&&g(x,v,T[w]);return x}l.exports=function(x){x=m(x);for(var v=1;v<arguments.length;v++)y(x,arguments[v]);return x}},"./node_modules/dtype/index.js":l=>{l.exports=function(u){switch(u){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},"./node_modules/global/window.js":(l,u,c)=>{var h;typeof window<"u"?h=window:typeof c.g<"u"?h=c.g:typeof self<"u"?h=self:h={},l.exports=h},"./node_modules/ieee754/index.js":(l,u)=>{/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */u.read=function(c,h,p,f,m){var g,y,x=m*8-f-1,v=(1<<x)-1,_=v>>1,T=-7,w=p?m-1:0,S=p?-1:1,R=c[h+w];for(w+=S,g=R&(1<<-T)-1,R>>=-T,T+=x;T>0;g=g*256+c[h+w],w+=S,T-=8);for(y=g&(1<<-T)-1,g>>=-T,T+=f;T>0;y=y*256+c[h+w],w+=S,T-=8);if(g===0)g=1-_;else{if(g===v)return y?NaN:(R?-1:1)*(1/0);y=y+Math.pow(2,f),g=g-_}return(R?-1:1)*y*Math.pow(2,g-f)},u.write=function(c,h,p,f,m,g){var y,x,v,_=g*8-m-1,T=(1<<_)-1,w=T>>1,S=m===23?Math.pow(2,-24)-Math.pow(2,-77):0,R=f?0:g-1,B=f?1:-1,I=h<0||h===0&&1/h<0?1:0;for(h=Math.abs(h),isNaN(h)||h===1/0?(x=isNaN(h)?1:0,y=T):(y=Math.floor(Math.log(h)/Math.LN2),h*(v=Math.pow(2,-y))<1&&(y--,v*=2),y+w>=1?h+=S/v:h+=S*Math.pow(2,1-w),h*v>=2&&(y++,v/=2),y+w>=T?(x=0,y=T):y+w>=1?(x=(h*v-1)*Math.pow(2,m),y=y+w):(x=h*Math.pow(2,w-1)*Math.pow(2,m),y=0));m>=8;c[p+R]=x&255,R+=B,x/=256,m-=8);for(y=y<<m|x,_+=m;_>0;c[p+R]=y&255,R+=B,y/=256,_-=8);c[p+R-B]|=I*128}},"./node_modules/is-buffer/index.js":l=>{/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */l.exports=function(h){return h!=null&&(u(h)||c(h)||!!h._isBuffer)};function u(h){return!!h.constructor&&typeof h.constructor.isBuffer=="function"&&h.constructor.isBuffer(h)}function c(h){return typeof h.readFloatLE=="function"&&typeof h.slice=="function"&&u(h.slice(0,0))}},"./node_modules/is-function/index.js":l=>{l.exports=c;var u=Object.prototype.toString;function c(h){if(!h)return!1;var p=u.call(h);return p==="[object Function]"||typeof h=="function"&&p!=="[object RegExp]"||typeof window<"u"&&(h===window.setTimeout||h===window.alert||h===window.confirm||h===window.prompt)}},"./node_modules/is-obj/index.js":l=>{l.exports=function(u){var c=typeof u;return u!==null&&(c==="object"||c==="function")}},"./node_modules/layout-bmfont-text/index.js":(l,u,c)=>{var h=c("./node_modules/word-wrapper/index.js"),p=c("./node_modules/xtend/immutable.js"),f=c("./node_modules/as-number/index.js"),m=["x","e","a","o","n","s","r","c","u","m","v","w","z"],g=["m","w"],y=["H","I","N","E","F","K","L","T","U","V","W","X","Y","Z"],x=9,v=32,_=0,T=1,w=2;l.exports=function(z){return new S(z)};function S(z){this.glyphs=[],this._measure=this.computeMetrics.bind(this),this.update(z)}S.prototype.update=function(z){if(z=p({measure:this._measure},z),this._opt=z,this._opt.tabSize=f(this._opt.tabSize,4),!z.font)throw new Error("must provide a valid bitmap font");var $=this.glyphs,Q=z.text||"",H=z.font;this._setupSpaceGlyphs(H);var V=h.lines(Q,z),ne=z.width||0;$.length=0;var Y=V.reduce(function(At,Gt){return Math.max(At,Gt.width,ne)},0),ae=0,xe=0,fe=f(z.lineHeight,H.common.lineHeight),de=H.common.base,Ie=fe-de,Ge=z.letterSpacing||0,Xe=fe*V.length-Ie,$e=Z(this._opt.align);xe-=Xe,this._width=Y,this._height=Xe,this._descender=fe-de,this._baseline=de,this._xHeight=D(H),this._capHeight=O(H),this._lineHeight=fe,this._ascender=fe-Ie-this._xHeight;var lt=this;V.forEach(function(At,Gt){for(var gt=At.start,xi=At.end,Ze=At.width,Ui,di=gt;di<xi;di++){var Ii=Q.charCodeAt(di),Ti=lt.getGlyph(H,Ii);if(Ti){Ui&&(ae+=U(H,Ui.id,Ti.id));var ir=ae;$e===T?ir+=(Y-Ze)/2:$e===w&&(ir+=Y-Ze),$.push({position:[ir,xe],data:Ti,index:di,line:Gt}),ae+=Ti.xadvance+Ge,Ui=Ti}}xe+=fe,ae=0}),this._linesTotal=V.length},S.prototype._setupSpaceGlyphs=function(z){if(this._fallbackSpaceGlyph=null,this._fallbackTabGlyph=null,!(!z.chars||z.chars.length===0)){var $=I(z,v)||L(z)||z.chars[0],Q=this._opt.tabSize*$.xadvance;this._fallbackSpaceGlyph=$,this._fallbackTabGlyph=p($,{x:0,y:0,xadvance:Q,id:x,xoffset:0,yoffset:0,width:0,height:0})}},S.prototype.getGlyph=function(z,$){var Q=I(z,$);return Q||($===x?this._fallbackTabGlyph:$===v?this._fallbackSpaceGlyph:null)},S.prototype.computeMetrics=function(z,$,Q,H){var V=this._opt.letterSpacing||0,ne=this._opt.font,Y=0,ae=0,xe=0,fe,de;if(!ne.chars||ne.chars.length===0)return{start:$,end:$,width:0};Q=Math.min(z.length,Q);for(var Ie=$;Ie<Q;Ie++){var Ge=z.charCodeAt(Ie),fe=this.getGlyph(ne,Ge);if(fe){fe.xoffset;var Xe=de?U(ne,de.id,fe.id):0;Y+=Xe;var $e=Y+fe.xadvance+V,lt=Y+fe.width;if(lt>=H||$e>=H)break;Y=$e,ae=lt,de=fe}xe++}return de&&(ae+=de.xoffset),{start:$,end:$+xe,width:ae}},["width","height","descender","ascender","xHeight","baseline","capHeight","lineHeight"].forEach(R);function R(z){Object.defineProperty(S.prototype,z,{get:B(z),configurable:!0})}function B(z){return new Function(["return function "+z+"() {","  return this._"+z,"}"].join(`
`))()}function I(z,$){if(!z.chars||z.chars.length===0)return null;var Q=G(z.chars,$);return Q>=0?z.chars[Q]:null}function D(z){for(var $=0;$<m.length;$++){var Q=m[$].charCodeAt(0),H=G(z.chars,Q);if(H>=0)return z.chars[H].height}return 0}function L(z){for(var $=0;$<g.length;$++){var Q=g[$].charCodeAt(0),H=G(z.chars,Q);if(H>=0)return z.chars[H]}return 0}function O(z){for(var $=0;$<y.length;$++){var Q=y[$].charCodeAt(0),H=G(z.chars,Q);if(H>=0)return z.chars[H].height}return 0}function U(z,$,Q){if(!z.kernings||z.kernings.length===0)return 0;for(var H=z.kernings,V=0;V<H.length;V++){var ne=H[V];if(ne.first===$&&ne.second===Q)return ne.amount}return 0}function Z(z){return z==="center"?T:z==="right"?w:_}function G(z,$,Q){Q=Q||0;for(var H=Q;H<z.length;H++)if(z[H].id===$)return H;return-1}},"./node_modules/load-bmfont/browser.js":(l,u,c)=>{var h=c("./node_modules/buffer/index.js").Buffer,p=c("./node_modules/xhr/index.js"),f=function(){},m=c("./node_modules/parse-bmfont-ascii/index.js"),g=c("./node_modules/parse-bmfont-xml/lib/browser.js"),y=c("./node_modules/parse-bmfont-binary/index.js"),x=c("./node_modules/load-bmfont/lib/is-binary.js"),v=c("./node_modules/xtend/immutable.js"),_=function(){return self.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}();l.exports=function(S,R){R=typeof R=="function"?R:f,typeof S=="string"?S={uri:S}:S||(S={});var B=S.binary;B&&(S=w(S)),p(S,function(I,D,L){if(I)return R(I);if(!/^2/.test(D.statusCode))return R(new Error("http status code: "+D.statusCode));if(!L)return R(new Error("no body result"));var O=!1;if(T(L)){var U=new Uint8Array(L);L=h.from(U,"binary")}x(L)&&(O=!0,typeof L=="string"&&(L=h.from(L,"binary"))),O||(h.isBuffer(L)&&(L=L.toString(S.encoding)),L=L.trim());var Z;try{var G=D.headers["content-type"];O?Z=y(L):/json/.test(G)||L.charAt(0)==="{"?Z=JSON.parse(L):/xml/.test(G)||L.charAt(0)==="<"?Z=g(L):Z=m(L)}catch(z){R(new Error("error parsing font "+z.message)),R=f}R(null,Z)})};function T(S){var R=Object.prototype.toString;return R.call(S)==="[object ArrayBuffer]"}function w(S){if(_)return v(S,{responseType:"arraybuffer"});if(typeof self.XMLHttpRequest>"u")throw new Error("your browser does not support XHR loading");var R=new self.XMLHttpRequest;return R.overrideMimeType("text/plain; charset=x-user-defined"),v({xhr:R},S)}},"./node_modules/load-bmfont/lib/is-binary.js":(l,u,c)=>{var h=c("./node_modules/buffer/index.js").Buffer,p=c("./node_modules/buffer-equal/index.js"),f=h.from([66,77,70,3]);l.exports=function(m){return typeof m=="string"?m.substring(0,3)==="BMF":m.length>4&&p(m.slice(0,4),f)}},"./node_modules/ms/index.js":l=>{var u=1e3,c=u*60,h=c*60,p=h*24,f=p*7,m=p*365.25;l.exports=function(_,T){T=T||{};var w=typeof _;if(w==="string"&&_.length>0)return g(_);if(w==="number"&&isFinite(_))return T.long?x(_):y(_);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(_))};function g(_){if(_=String(_),!(_.length>100)){var T=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(_);if(T){var w=parseFloat(T[1]),S=(T[2]||"ms").toLowerCase();switch(S){case"years":case"year":case"yrs":case"yr":case"y":return w*m;case"weeks":case"week":case"w":return w*f;case"days":case"day":case"d":return w*p;case"hours":case"hour":case"hrs":case"hr":case"h":return w*h;case"minutes":case"minute":case"mins":case"min":case"m":return w*c;case"seconds":case"second":case"secs":case"sec":case"s":return w*u;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return w;default:return}}}}function y(_){var T=Math.abs(_);return T>=p?Math.round(_/p)+"d":T>=h?Math.round(_/h)+"h":T>=c?Math.round(_/c)+"m":T>=u?Math.round(_/u)+"s":_+"ms"}function x(_){var T=Math.abs(_);return T>=p?v(_,T,p,"day"):T>=h?v(_,T,h,"hour"):T>=c?v(_,T,c,"minute"):T>=u?v(_,T,u,"second"):_+" ms"}function v(_,T,w,S){var R=T>=w*1.5;return Math.round(_/w)+" "+S+(R?"s":"")}},"./node_modules/parse-bmfont-ascii/index.js":l=>{l.exports=function(p){if(!p)throw new Error("no data provided");p=p.toString().trim();var f={pages:[],chars:[],kernings:[]},m=p.split(/\r\n?|\n/g);if(m.length===0)throw new Error("no data in BMFont file");for(var g=0;g<m.length;g++){var y=u(m[g],g);if(y)if(y.key==="page"){if(typeof y.data.id!="number")throw new Error("malformed file at line "+g+" -- needs page id=N");if(typeof y.data.file!="string")throw new Error("malformed file at line "+g+' -- needs page file="path"');f.pages[y.data.id]=y.data.file}else y.key==="chars"||y.key==="kernings"||(y.key==="char"?f.chars.push(y.data):y.key==="kerning"?f.kernings.push(y.data):f[y.key]=y.data)}return f};function u(p,f){if(p=p.replace(/\t+/g," ").trim(),!p)return null;var m=p.indexOf(" ");if(m===-1)throw new Error("no named row at line "+f);var g=p.substring(0,m);p=p.substring(m+1),p=p.replace(/letter=[\'\"]\S+[\'\"]/gi,""),p=p.split("="),p=p.map(function(T){return T.trim().match(/(".*?"|[^"\s]+)+(?=\s*|\s*$)/g)});for(var y=[],x=0;x<p.length;x++){var v=p[x];x===0?y.push({key:v[0],data:""}):x===p.length-1?y[y.length-1].data=c(v[0]):(y[y.length-1].data=c(v[0]),y.push({key:v[1],data:""}))}var _={key:g,data:{}};return y.forEach(function(T){_.data[T.key]=T.data}),_}function c(p){return!p||p.length===0?"":p.indexOf('"')===0||p.indexOf("'")===0?p.substring(1,p.length-1):p.indexOf(",")!==-1?h(p):parseInt(p,10)}function h(p){return p.split(",").map(function(f){return parseInt(f,10)})}},"./node_modules/parse-bmfont-binary/index.js":l=>{var u=[66,77,70];l.exports=function(v){if(v.length<6)throw new Error("invalid buffer length for BMFont");var _=u.every(function(B,I){return v.readUInt8(I)===B});if(!_)throw new Error("BMFont missing BMF byte header");var T=3,w=v.readUInt8(T++);if(w>3)throw new Error("Only supports BMFont Binary v3 (BMFont App v1.10)");for(var S={kernings:[],chars:[]},R=0;R<5;R++)T+=c(S,v,T);return S};function c(v,_,T){if(T>_.length-1)return 0;var w=_.readUInt8(T++),S=_.readInt32LE(T);switch(T+=4,w){case 1:v.info=h(_,T);break;case 2:v.common=p(_,T);break;case 3:v.pages=f(_,T,S);break;case 4:v.chars=m(_,T,S);break;case 5:v.kernings=g(_,T,S);break}return 5+S}function h(v,_){var T={};T.size=v.readInt16LE(_);var w=v.readUInt8(_+2);return T.smooth=w>>7&1,T.unicode=w>>6&1,T.italic=w>>5&1,T.bold=w>>4&1,w>>3&1&&(T.fixedHeight=1),T.charset=v.readUInt8(_+3)||"",T.stretchH=v.readUInt16LE(_+4),T.aa=v.readUInt8(_+6),T.padding=[v.readInt8(_+7),v.readInt8(_+8),v.readInt8(_+9),v.readInt8(_+10)],T.spacing=[v.readInt8(_+11),v.readInt8(_+12)],T.outline=v.readUInt8(_+13),T.face=x(v,_+14),T}function p(v,_){var T={};return T.lineHeight=v.readUInt16LE(_),T.base=v.readUInt16LE(_+2),T.scaleW=v.readUInt16LE(_+4),T.scaleH=v.readUInt16LE(_+6),T.pages=v.readUInt16LE(_+8),v.readUInt8(_+10),T.packed=0,T.alphaChnl=v.readUInt8(_+11),T.redChnl=v.readUInt8(_+12),T.greenChnl=v.readUInt8(_+13),T.blueChnl=v.readUInt8(_+14),T}function f(v,_,T){for(var w=[],S=y(v,_),R=S.length+1,B=T/R,I=0;I<B;I++)w[I]=v.slice(_,_+S.length).toString("utf8"),_+=R;return w}function m(v,_,T){for(var w=[],S=T/20,R=0;R<S;R++){var B={},I=R*20;B.id=v.readUInt32LE(_+0+I),B.x=v.readUInt16LE(_+4+I),B.y=v.readUInt16LE(_+6+I),B.width=v.readUInt16LE(_+8+I),B.height=v.readUInt16LE(_+10+I),B.xoffset=v.readInt16LE(_+12+I),B.yoffset=v.readInt16LE(_+14+I),B.xadvance=v.readInt16LE(_+16+I),B.page=v.readUInt8(_+18+I),B.chnl=v.readUInt8(_+19+I),w[R]=B}return w}function g(v,_,T){for(var w=[],S=T/10,R=0;R<S;R++){var B={},I=R*10;B.first=v.readUInt32LE(_+0+I),B.second=v.readUInt32LE(_+4+I),B.amount=v.readInt16LE(_+8+I),w[R]=B}return w}function y(v,_){for(var T=_;T<v.length&&v[T]!==0;T++);return v.slice(_,T)}function x(v,_){return y(v,_).toString("utf8")}},"./node_modules/parse-bmfont-xml/lib/browser.js":(l,u,c)=>{var h=c("./node_modules/parse-bmfont-xml/lib/parse-attribs.js"),p=c("./node_modules/xml-parse-from-string/index.js"),f={scaleh:"scaleH",scalew:"scaleW",stretchh:"stretchH",lineheight:"lineHeight",alphachnl:"alphaChnl",redchnl:"redChnl",greenchnl:"greenChnl",bluechnl:"blueChnl"};l.exports=function(x){x=x.toString();var v=p(x),_={pages:[],chars:[],kernings:[]};["info","common"].forEach(function(D){var L=v.getElementsByTagName(D)[0];L&&(_[D]=h(m(L)))});var T=v.getElementsByTagName("pages")[0];if(!T)throw new Error("malformed file -- no <pages> element");for(var w=T.getElementsByTagName("page"),S=0;S<w.length;S++){var R=w[S],B=parseInt(R.getAttribute("id"),10),I=R.getAttribute("file");if(isNaN(B))throw new Error('malformed file -- page "id" attribute is NaN');if(!I)throw new Error('malformed file -- needs page "file" attribute');_.pages[parseInt(B,10)]=I}return["chars","kernings"].forEach(function(D){var L=v.getElementsByTagName(D)[0];if(L)for(var O=D.substring(0,D.length-1),U=L.getElementsByTagName(O),Z=0;Z<U.length;Z++){var G=U[Z];_[D].push(h(m(G)))}}),_};function m(x){var v=g(x);return v.reduce(function(_,T){var w=y(T.nodeName);return _[w]=T.nodeValue,_},{})}function g(x){for(var v=[],_=0;_<x.attributes.length;_++)v.push(x.attributes[_]);return v}function y(x){return f[x.toLowerCase()]||x}},"./node_modules/parse-bmfont-xml/lib/parse-attribs.js":l=>{var u="chasrset";l.exports=function(h){u in h&&(h.charset=h[u],delete h[u]);for(var p in h)p==="face"||p==="charset"||(p==="padding"||p==="spacing"?h[p]=c(h[p]):h[p]=parseInt(h[p],10));return h};function c(h){return h.split(",").map(function(p){return parseInt(p,10)})}},"./node_modules/parse-headers/parse-headers.js":l=>{var u=function(h){return h.replace(/^\s+|\s+$/g,"")},c=function(h){return Object.prototype.toString.call(h)==="[object Array]"};l.exports=function(h){if(!h)return{};for(var p={},f=u(h).split(`
`),m=0;m<f.length;m++){var g=f[m],y=g.indexOf(":"),x=u(g.slice(0,y)).toLowerCase(),v=u(g.slice(y+1));typeof p[x]>"u"?p[x]=v:c(p[x])?p[x].push(v):p[x]=[p[x],v]}return p}},"./node_modules/quad-indices/index.js":(l,u,c)=>{var h=c("./node_modules/dtype/index.js"),p=c("./node_modules/an-array/index.js"),f=c("./node_modules/is-buffer/index.js"),m=[0,2,3],g=[2,1,3];l.exports=function(y,x){(!y||!(p(y)||f(y)))&&(x=y||{},y=null),typeof x=="number"?x={count:x}:x=x||{};for(var v=typeof x.type=="string"?x.type:"uint16",_=typeof x.count=="number"?x.count:1,T=x.start||0,w=x.clockwise!==!1?m:g,S=w[0],R=w[1],B=w[2],I=_*6,D=y||new(h(v))(I),L=0,O=0;L<I;L+=6,O+=4){var U=L+T;D[U+0]=O+0,D[U+1]=O+1,D[U+2]=O+2,D[U+3]=O+S,D[U+4]=O+R,D[U+5]=O+B}return D}},"./node_modules/super-animejs/lib/anime.es.js":(l,u,c)=>{c.r(u),c.d(u,{default:()=>Be});var h={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0},p={duration:1e3,delay:0,endDelay:0,easing:"easeOutElastic(1, .5)",round:0},f=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective"],m={CSS:{},springs:{}};function g(se,ge,Ne){return Math.min(Math.max(se,ge),Ne)}function y(se,ge){return se.indexOf(ge)>-1}function x(se,ge){return se.apply(null,ge)}var v=/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i,_=/^rgb/,T=/^hsl/,w={arr:function(se){return Array.isArray(se)},obj:function(se){return y(Object.prototype.toString.call(se),"Object")},pth:function(se){return w.obj(se)&&se.hasOwnProperty("totalLength")},svg:function(se){return se instanceof SVGElement},inp:function(se){return se instanceof HTMLInputElement},dom:function(se){return se.nodeType||w.svg(se)},str:function(se){return typeof se=="string"},fnc:function(se){return typeof se=="function"},und:function(se){return typeof se>"u"},hex:function(se){return v.test(se)},rgb:function(se){return _.test(se)},hsl:function(se){return T.test(se)},col:function(se){return w.hex(se)||w.rgb(se)||w.hsl(se)},key:function(se){return!h.hasOwnProperty(se)&&!p.hasOwnProperty(se)&&se!=="targets"&&se!=="keyframes"}},S=/\(([^)]+)\)/;function R(se){var ge=S.exec(se);return ge?ge[1].split(",").map(function(Ne){return parseFloat(Ne)}):[]}function B(se,ge){var Ne=R(se),Fe=g(w.und(Ne[0])?1:Ne[0],.1,100),Ke=g(w.und(Ne[1])?100:Ne[1],.1,100),ot=g(w.und(Ne[2])?10:Ne[2],.1,100),wt=g(w.und(Ne[3])?0:Ne[3],.1,100),qt=Math.sqrt(Ke/Fe),Kt=ot/(2*Math.sqrt(Ke*Fe)),Mt=Kt<1?qt*Math.sqrt(1-Kt*Kt):0,ti=1,Ei=Kt<1?(Kt*qt+-wt)/Mt:-wt+qt;function Fi(hr){var Zi=ge?ge*hr/1e3:hr;return Kt<1?Zi=Math.exp(-Zi*Kt*qt)*(ti*Math.cos(Mt*Zi)+Ei*Math.sin(Mt*Zi)):Zi=(ti+Ei*Zi)*Math.exp(-Zi*qt),hr===0||hr===1?hr:1-Zi}function Tr(){var hr=m.springs[se];if(hr)return hr;for(var Zi=.16666666666666666,bi=0,Bn=0;;)if(bi+=Zi,Fi(bi)===1){if(Bn++,Bn>=16)break}else Bn=0;var Jn=bi*Zi*1e3;return m.springs[se]=Jn,Jn}return ge?Fi:Tr}function I(se,ge){se===void 0&&(se=1),ge===void 0&&(ge=.5);var Ne=g(se,1,10),Fe=g(ge,.1,2);return function(Ke){return Ke===0||Ke===1?Ke:-Ne*Math.pow(2,10*(Ke-1))*Math.sin((Ke-1-Fe/(Math.PI*2)*Math.asin(1/Ne))*(Math.PI*2)/Fe)}}function D(se){return se===void 0&&(se=10),function(ge){return Math.round(ge*se)*(1/se)}}var L=function(){var se=11,ge=1/(se-1);function Ne(ti,Ei){return 1-3*Ei+3*ti}function Fe(ti,Ei){return 3*Ei-6*ti}function Ke(ti){return 3*ti}function ot(ti,Ei,Fi){return((Ne(Ei,Fi)*ti+Fe(Ei,Fi))*ti+Ke(Ei))*ti}function wt(ti,Ei,Fi){return 3*Ne(Ei,Fi)*ti*ti+2*Fe(Ei,Fi)*ti+Ke(Ei)}function qt(ti,Ei,Fi,Tr,hr){var Zi,bi,Bn=0;do bi=Ei+(Fi-Ei)/2,Zi=ot(bi,Tr,hr)-ti,Zi>0?Fi=bi:Ei=bi;while(Math.abs(Zi)>1e-7&&++Bn<10);return bi}function Kt(ti,Ei,Fi,Tr){for(var hr=0;hr<4;++hr){var Zi=wt(Ei,Fi,Tr);if(Zi===0)return Ei;var bi=ot(Ei,Fi,Tr)-ti;Ei-=bi/Zi}return Ei}function Mt(ti,Ei,Fi,Tr){if(!(0<=ti&&ti<=1&&0<=Fi&&Fi<=1))return;var hr=new Float32Array(se);if(ti!==Ei||Fi!==Tr)for(var Zi=0;Zi<se;++Zi)hr[Zi]=ot(Zi*ge,ti,Fi);function bi(Bn){for(var Jn=0,Ri=1,or=se-1;Ri!==or&&hr[Ri]<=Bn;++Ri)Jn+=ge;--Ri;var pn=(Bn-hr[Ri])/(hr[Ri+1]-hr[Ri]),Yr=Jn+pn*ge,W=wt(Yr,ti,Fi);return W>=.001?Kt(Bn,Yr,ti,Fi):W===0?Yr:qt(Bn,Jn,Jn+ge,ti,Fi)}return function(Bn){return ti===Ei&&Fi===Tr||Bn===0||Bn===1?Bn:ot(bi(Bn),Ei,Tr)}}return Mt}(),O=function(){var se=["Quad","Cubic","Quart","Quint","Sine","Expo","Circ","Back","Elastic"],ge={In:[[.55,.085,.68,.53],[.55,.055,.675,.19],[.895,.03,.685,.22],[.755,.05,.855,.06],[.47,0,.745,.715],[.95,.05,.795,.035],[.6,.04,.98,.335],[.6,-.28,.735,.045],I],Out:[[.25,.46,.45,.94],[.215,.61,.355,1],[.165,.84,.44,1],[.23,1,.32,1],[.39,.575,.565,1],[.19,1,.22,1],[.075,.82,.165,1],[.175,.885,.32,1.275],function(wt,qt){return function(Kt){return 1-I(wt,qt)(1-Kt)}}],InOut:[[.455,.03,.515,.955],[.645,.045,.355,1],[.77,0,.175,1],[.86,0,.07,1],[.445,.05,.55,.95],[1,0,0,1],[.785,.135,.15,.86],[.68,-.55,.265,1.55],function(wt,qt){return function(Kt){return Kt<.5?I(wt,qt)(Kt*2)/2:1-I(wt,qt)(Kt*-2+2)/2}}]},Ne={linear:[.25,.25,.75,.75]};for(var Fe in ge)for(var Ke=0,ot=ge[Fe].length;Ke<ot;Ke++)Ne["ease"+Fe+se[Ke]]=ge[Fe][Ke];return Ne}();function U(se,ge){if(w.fnc(se))return se;var Ne=se.split("(")[0],Fe=O[Ne],Ke=R(se);switch(Ne){case"spring":return B(se,ge);case"cubicBezier":return x(L,Ke);case"steps":return x(D,Ke);default:return w.fnc(Fe)?x(Fe,Ke):x(L,Fe)}}function Z(se){try{var ge=document.querySelectorAll(se);return ge}catch{return}}var G=[];function z(se,ge){for(var Ne=G,Fe=se.length,Ke=arguments.length>=2?arguments[1]:void 0,ot=0;ot<Fe;ot++)if(ot in se){var wt=se[ot];ge.call(Ke,wt,ot,se)&&Ne.push(wt)}return G=se,G.length=0,Ne}function $(se,ge){ge||(ge=[]);for(var Ne=0,Fe=se.length;Ne<Fe;Ne++){var Ke=se[Ne];Array.isArray(Ke)?$(Ke,ge):ge.push(Ke)}return ge}function Q(se){return w.arr(se)?se:(w.str(se)&&(se=Z(se)||se),se instanceof NodeList||se instanceof HTMLCollection?[].slice.call(se):[se])}function H(se,ge){return se.some(function(Ne){return Ne===ge})}function V(se){var ge={};for(var Ne in se)ge[Ne]=se[Ne];return ge}function ne(se,ge){var Ne=V(se);for(var Fe in se)Ne[Fe]=ge.hasOwnProperty(Fe)?ge[Fe]:se[Fe];return Ne}function Y(se,ge){var Ne=V(se);for(var Fe in ge)Ne[Fe]=w.und(se[Fe])?ge[Fe]:se[Fe];return Ne}var ae=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g;function xe(se){var ge=ae.exec(se);return ge?"rgba("+ge[1]+",1)":se}var fe=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,de=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i;function Ie(se){var ge=se.replace(fe,function(wt,qt,Kt,Mt){return qt+qt+Kt+Kt+Mt+Mt}),Ne=de.exec(ge),Fe=parseInt(Ne[1],16),Ke=parseInt(Ne[2],16),ot=parseInt(Ne[3],16);return"rgba("+Fe+","+Ke+","+ot+",1)"}var Ge=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g,Xe=/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g;function $e(se){var ge=Ge.exec(se)||Xe.exec(se),Ne=parseInt(ge[1],10)/360,Fe=parseInt(ge[2],10)/100,Ke=parseInt(ge[3],10)/100,ot=ge[4]||1;function wt(Fi,Tr,hr){return hr<0&&(hr+=1),hr>1&&(hr-=1),hr<.16666666666666666?Fi+(Tr-Fi)*6*hr:hr<.5?Tr:hr<.6666666666666666?Fi+(Tr-Fi)*(.6666666666666666-hr)*6:Fi}var qt,Kt,Mt;if(Fe==0)qt=Kt=Mt=Ke;else{var ti=Ke<.5?Ke*(1+Fe):Ke+Fe-Ke*Fe,Ei=2*Ke-ti;qt=wt(Ei,ti,Ne+.3333333333333333),Kt=wt(Ei,ti,Ne),Mt=wt(Ei,ti,Ne-.3333333333333333)}return"rgba("+qt*255+","+Kt*255+","+Mt*255+","+ot+")"}function lt(se){if(w.rgb(se))return xe(se);if(w.hex(se))return Ie(se);if(w.hsl(se))return $e(se)}var At=/([\+\-]?[0-9#\.]+)(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/;function Gt(se){var ge=At.exec(se);if(ge)return ge[2]}function gt(se){if(y(se,"translate")||se==="perspective")return"px";if(y(se,"rotate")||y(se,"skew"))return"deg"}function xi(se,ge){return w.fnc(se)?se(ge.target,ge.id,ge.total):se}function Ze(se,ge){return se.getAttribute(ge)}function Ui(se,ge,Ne){var Fe=Gt(ge);if(H([Ne,"deg","rad","turn"],Fe))return ge;var Ke=m.CSS[ge+Ne];if(!w.und(Ke))return Ke;var ot=100,wt=document.createElement(se.tagName),qt=se.parentNode&&se.parentNode!==document?se.parentNode:document.body;qt.appendChild(wt),wt.style.position="absolute",wt.style.width=ot+Ne;var Kt=ot/wt.offsetWidth;qt.removeChild(wt);var Mt=Kt*parseFloat(ge);return m.CSS[ge+Ne]=Mt,Mt}function di(se,ge,Ne){if(ge in se.style){var Fe=ge.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),Ke=se.style[ge]||getComputedStyle(se).getPropertyValue(Fe)||"0";return Ne?Ui(se,Ke,Ne):Ke}}function Ii(se,ge){if(w.dom(se)&&!w.inp(se)&&(Ze(se,ge)||w.svg(se)&&se[ge]))return"attribute";if(w.dom(se)&&H(f,ge))return"transform";if(w.dom(se)&&ge!=="transform"&&di(se,ge))return"css";if(se[ge]!=null)return"object"}var Ti=/(\w+)\(([^)]*)\)/g;function ir(se){if(w.dom(se)){for(var ge=se.style.transform||"",Ne=new Map,Fe;Fe=Ti.exec(ge);)Ne.set(Fe[1],Fe[2]);return Ne}}function Gi(se,ge,Ne,Fe){var Ke=y(ge,"scale")?1:0+gt(ge),ot=ir(se).get(ge)||Ke;return Ne&&(Ne.transforms.list.set(ge,ot),Ne.transforms.last=ge),Fe?Ui(se,ot,Fe):ot}function Qe(se,ge,Ne,Fe){switch(Ii(se,ge)){case"transform":return Gi(se,ge,Fe,Ne);case"css":return di(se,ge,Ne);case"attribute":return Ze(se,ge);default:return se[ge]||0}}var Ce=/^(\*=|\+=|-=)/;function yt(se,ge){var Ne=Ce.exec(se);if(!Ne)return se;var Fe=Gt(se)||0,Ke=parseFloat(ge),ot=parseFloat(se.replace(Ne[0],""));switch(Ne[0][0]){case"+":return Ke+ot+Fe;case"-":return Ke-ot+Fe;case"*":return Ke*ot+Fe}}var Ot=/\s/g;function Jt(se,ge){if(w.col(se))return lt(se);var Ne=Gt(se),Fe=Ne?se.substr(0,se.length-Ne.length):se;return ge&&!Ot.test(se)?Fe+ge:Fe}function zt(se,ge){return Math.sqrt(Math.pow(ge.x-se.x,2)+Math.pow(ge.y-se.y,2))}function _i(se){return Math.PI*2*Ze(se,"r")}function vt(se){return Ze(se,"width")*2+Ze(se,"height")*2}function ye(se){return zt({x:Ze(se,"x1"),y:Ze(se,"y1")},{x:Ze(se,"x2"),y:Ze(se,"y2")})}function ve(se){for(var ge=se.points,Ne=0,Fe,Ke=0;Ke<ge.numberOfItems;Ke++){var ot=ge.getItem(Ke);Ke>0&&(Ne+=zt(Fe,ot)),Fe=ot}return Ne}function Le(se){var ge=se.points;return ve(se)+zt(ge.getItem(ge.numberOfItems-1),ge.getItem(0))}function Te(se){if(se.getTotalLength)return se.getTotalLength();switch(se.tagName.toLowerCase()){case"circle":return _i(se);case"rect":return vt(se);case"line":return ye(se);case"polyline":return ve(se);case"polygon":return Le(se)}}function ke(se){var ge=Te(se);return se.setAttribute("stroke-dasharray",ge),ge}function Pe(se){for(var ge=se.parentNode;w.svg(ge)&&(ge=ge.parentNode,!!w.svg(ge.parentNode)););return ge}function F(se,ge){var Ne=ge||{},Fe=Ne.el||Pe(se),Ke=Fe.getBoundingClientRect(),ot=Ze(Fe,"viewBox"),wt=Ke.width,qt=Ke.height,Kt=Ne.viewBox||(ot?ot.split(" "):[0,0,wt,qt]);return{el:Fe,viewBox:Kt,x:Kt[0]/1,y:Kt[1]/1,w:wt/Kt[2],h:qt/Kt[3]}}function J(se,ge){var Ne=w.str(se)?Z(se)[0]:se,Fe=ge||100;return function(Ke){return{property:Ke,el:Ne,svg:F(Ne),totalLength:Te(Ne)*(Fe/100)}}}function ie(se,ge){function Ne(qt){qt===void 0&&(qt=0);var Kt=ge+qt>=1?ge+qt:0;return se.el.getPointAtLength(Kt)}var Fe=F(se.el,se.svg),Ke=Ne(),ot=Ne(-1),wt=Ne(1);switch(se.property){case"x":return(Ke.x-Fe.x)*Fe.w;case"y":return(Ke.y-Fe.y)*Fe.h;case"angle":return Math.atan2(wt.y-ot.y,wt.x-ot.x)*180/Math.PI}}var Re=/-?\d*\.?\d+/g;function ce(se,ge){var Ne=Jt(w.pth(se)?se.totalLength:se,ge)+"";return{original:Ne,numbers:Ne.match(Re)?Ne.match(Re).map(Number):[0],strings:w.str(se)||ge?Ne.split(Re):[]}}function Ue(se){var ge=se?$(w.arr(se)?se.map(Q):Q(se)):[];return z(ge,function(Ne,Fe,Ke){return Ke.indexOf(Ne)===Fe})}function je(se){var ge=Ue(se);return ge.map(function(Ne,Fe){return{target:Ne,id:Fe,total:ge.length,transforms:{list:ir(Ne)}}})}var dt=/^spring/;function It(se,ge){var Ne=V(ge);if(dt.test(Ne.easing)&&(Ne.duration=B(Ne.easing)),w.arr(se)){var Fe=se.length,Ke=Fe===2&&!w.obj(se[0]);Ke?se={value:se}:w.fnc(ge.duration)||(Ne.duration=ge.duration/Fe)}var ot=w.arr(se)?se:[se];return ot.map(function(wt,qt){var Kt=w.obj(wt)&&!w.pth(wt)?wt:{value:wt};return w.und(Kt.delay)&&(Kt.delay=qt?0:ge.delay),w.und(Kt.endDelay)&&(Kt.endDelay=qt===ot.length-1?ge.endDelay:0),Kt}).map(function(wt){return Y(wt,Ne)})}function bt(se){for(var ge=z($(se.map(function(ot){return Object.keys(ot)})),function(ot){return w.key(ot)}).reduce(function(ot,wt){return ot.indexOf(wt)<0&&ot.push(wt),ot},[]),Ne={},Fe=function(ot){var wt=ge[ot];Ne[wt]=se.map(function(qt){var Kt={};for(var Mt in qt)w.key(Mt)?Mt==wt&&(Kt.value=qt[Mt]):Kt[Mt]=qt[Mt];return Kt})},Ke=0;Ke<ge.length;Ke++)Fe(Ke);return Ne}function Ut(se,ge){var Ne=[],Fe=ge.keyframes;Fe&&(ge=Y(bt(Fe),ge));for(var Ke in ge)w.key(Ke)&&Ne.push({name:Ke,tweens:It(ge[Ke],se)});return Ne}function pi(se,ge){var Ne={};for(var Fe in se){var Ke=xi(se[Fe],ge);w.arr(Ke)&&(Ke=Ke.map(function(ot){return xi(ot,ge)}),Ke.length===1&&(Ke=Ke[0])),Ne[Fe]=Ke}return Ne.duration=parseFloat(Ne.duration),Ne.delay=parseFloat(Ne.delay),Ne}function Er(se,ge){var Ne;return se.tweens.map(function(Fe){var Ke=pi(Fe,ge),ot=Ke.value,wt=w.arr(ot)?ot[1]:ot,qt=Gt(wt),Kt=Qe(ge.target,se.name,qt,ge),Mt=Ne?Ne.to.original:Kt,ti=w.arr(ot)?ot[0]:Mt,Ei=Gt(ti)||Gt(Kt),Fi=qt||Ei;return w.und(wt)&&(wt=Mt),Ke.from=ce(ti,Fi),Ke.to=ce(yt(wt,ti),Fi),Ke.start=Ne?Ne.end:0,Ke.end=Ke.start+Ke.delay+Ke.duration+Ke.endDelay,Ke.easing=U(Ke.easing,Ke.duration),Ke.isPath=w.pth(ot),Ke.isColor=w.col(Ke.from.original),Ke.isColor&&(Ke.round=1),Ne=Ke,Ke})}var ki={css:function(se,ge,Ne){return se.style[ge]=Ne},attribute:function(se,ge,Ne){return se.setAttribute(ge,Ne)},object:function(se,ge,Ne){return se[ge]=Ne},transform:function(se,ge,Ne,Fe,Ke){if(Fe.list.set(ge,Ne),ge===Fe.last||Ke){var ot="";Fe.list.forEach(function(wt,qt){ot+=qt+"("+wt+") "}),se.style.transform=ot}}};function An(se,ge){for(var Ne=je(se),Fe=0,Ke=Ne.length;Fe<Ke;Fe++){var ot=Ne[Fe];for(var wt in ge){var qt=xi(ge[wt],ot),Kt=ot.target,Mt=Gt(qt),ti=Qe(Kt,wt,Mt,ot),Ei=Mt||Gt(ti),Fi=yt(Jt(qt,Ei),ti),Tr=Ii(Kt,wt);ki[Tr](Kt,wt,Fi,ot.transforms,!0)}}}function Ur(se,ge){var Ne=Ii(se.target,ge.name);if(Ne){var Fe=Er(ge,se),Ke=Fe[Fe.length-1];return{type:Ne,property:ge.name,animatable:se,tweens:Fe,duration:Ke.end,delay:Fe[0].delay,endDelay:Ke.endDelay}}}function sn(se,ge){return z($(se.map(function(Ne){return ge.map(function(Fe){return Ur(Ne,Fe)})})),function(Ne){return!w.und(Ne)})}function xs(se,ge){var Ne=se.length,Fe=function(ot){return ot.timelineOffset?ot.timelineOffset:0},Ke={};return Ke.duration=Ne?Math.max.apply(Math,se.map(function(ot){return Fe(ot)+ot.duration})):ge.duration,Ke.delay=Ne?Math.min.apply(Math,se.map(function(ot){return Fe(ot)+ot.delay})):ge.delay,Ke.endDelay=Ne?Ke.duration-Math.max.apply(Math,se.map(function(ot){return Fe(ot)+ot.duration-ot.endDelay})):ge.endDelay,Ke}var yn=0;function Ls(se){var ge=ne(h,se),Ne=ne(p,se),Fe=Ut(Ne,se),Ke=je(se.targets),ot=sn(Ke,Fe),wt=xs(ot,Ne),qt=yn;return yn++,Y(ge,{id:qt,children:[],animatables:Ke,animations:ot,duration:wt.duration,delay:wt.delay,endDelay:wt.endDelay})}var rs=[],bs=[],me,ct=function(){function se(){me=requestAnimationFrame(ge)}function ge(Ne){var Fe=rs.length;if(Fe){for(var Ke=0;Ke<Fe;){var ot=rs[Ke];if(!ot.paused)ot.tick(Ne);else{var wt=rs.indexOf(ot);wt>-1&&(rs.splice(wt,1),Fe=rs.length)}Ke++}se()}else me=cancelAnimationFrame(me)}return se}();function St(){if(document.hidden){for(var se=0,ge=rs.length;se<ge;se++)activeInstance[se].pause();bs=rs.slice(0),rs=[]}else for(var Ne=0,Fe=bs.length;Ne<Fe;Ne++)bs[Ne].play()}document.addEventListener("visibilitychange",St);function Xt(se){se===void 0&&(se={});var ge=0,Ne=0,Fe=0,Ke,ot=0,wt=null;function qt(){return window.Promise&&new Promise(function(Ri){return wt=Ri})}var Kt=qt(),Mt=Ls(se);function ti(){Mt.reversed=!Mt.reversed;for(var Ri=0,or=Ke.length;Ri<or;Ri++)Ke[Ri].reversed=Mt.reversed}function Ei(Ri){return Mt.reversed?Mt.duration-Ri:Ri}function Fi(){ge=0,Ne=Ei(Mt.currentTime)*(1/Xt.speed)}function Tr(Ri,or){or&&or.seek(Ri-or.timelineOffset)}function hr(Ri){if(Mt.reversePlayback)for(var or=ot;or--;)Tr(Ri,Ke[or]);else for(var pn=0;pn<ot;pn++)Tr(Ri,Ke[pn])}function Zi(Ri){for(var or=0,pn=Mt.animations,Yr=pn.length;or<Yr;){var W=pn[or],ue=W.animatable,Ae=W.tweens,Se=Ae.length-1,We=Ae[Se];Se&&(We=z(Ae,function(pr){return Ri<pr.end})[0]||We);for(var Ye=g(Ri-We.start-We.delay,0,We.duration)/We.duration,ft=isNaN(Ye)?1:We.easing(Ye),he=We.to.strings,le=We.round,pe=[],be=We.to.numbers.length,Ee=void 0,st=0;st<be;st++){var Ct=void 0,Ht=We.to.numbers[st],ii=We.from.numbers[st]||0;We.isPath?Ct=ie(We.value,ft*Ht):Ct=ii+ft*(Ht-ii),le&&(We.isColor&&st>2||(Ct=Math.round(Ct*le)/le)),pe.push(Ct)}var Ai=he.length;if(!Ai)Ee=pe[0];else{Ee=he[0];for(var Wt=0;Wt<Ai;Wt++){he[Wt];var Ni=he[Wt+1],xr=pe[Wt];isNaN(xr)||(Ni?Ee+=xr+Ni:Ee+=xr+" ")}}ki[W.type](ue.target,W.property,Ee,ue.transforms),W.currentValue=Ee,or++}}function bi(Ri){Mt[Ri]&&!Mt.passThrough&&Mt[Ri](Mt)}function Bn(){Mt.remaining&&Mt.remaining!==!0&&Mt.remaining--}function Jn(Ri){var or=Mt.duration,pn=Mt.delay,Yr=or-Mt.endDelay,W=Ei(Ri);Mt.progress=g(W/or*100,0,100),Mt.reversePlayback=W<Mt.currentTime,Ke&&hr(W),!Mt.began&&Mt.currentTime>0&&(Mt.began=!0,bi("begin"),bi("loopBegin")),W<=pn&&Mt.currentTime!==0&&Zi(0),(W>=Yr&&Mt.currentTime!==or||!or)&&Zi(or),W>pn&&W<Yr?(Mt.changeBegan||(Mt.changeBegan=!0,Mt.changeCompleted=!1,bi("changeBegin")),bi("change"),Zi(W)):Mt.changeBegan&&(Mt.changeCompleted=!0,Mt.changeBegan=!1,bi("changeComplete")),Mt.currentTime=g(W,0,or),Mt.began&&bi("update"),Ri>=or&&(Ne=0,Bn(),Mt.remaining?(ge=Fe,bi("loopComplete"),bi("loopBegin"),Mt.direction==="alternate"&&ti()):(Mt.paused=!0,Mt.completed||(Mt.completed=!0,bi("loopComplete"),bi("complete"),"Promise"in window&&(wt(),Kt=qt()))))}return Mt.reset=function(){var Ri=Mt.direction;Mt.passThrough=!1,Mt.currentTime=0,Mt.progress=0,Mt.paused=!0,Mt.began=!1,Mt.changeBegan=!1,Mt.completed=!1,Mt.changeCompleted=!1,Mt.reversePlayback=!1,Mt.reversed=Ri==="reverse",Mt.remaining=Mt.loop,Ke=Mt.children,ot=Ke.length;for(var or=ot;or--;)Mt.children[or].reset();(Mt.reversed&&Mt.loop!==!0||Ri==="alternate"&&Mt.loop===1)&&Mt.remaining++,Zi(0)},Mt.set=function(Ri,or){return An(Ri,or),Mt},Mt.tick=function(Ri){Fe=Ri,ge||(ge=Fe),Jn((Fe+(Ne-ge))*Xt.speed)},Mt.seek=function(Ri){Jn(Ei(Ri))},Mt.pause=function(){Mt.paused=!0,Fi()},Mt.play=function(){Mt.paused&&(Mt.paused=!1,rs.push(Mt),Fi(),me||ct())},Mt.reverse=function(){ti(),Fi()},Mt.restart=function(){Mt.reset(),Mt.play()},Mt.finished=Kt,Mt.reset(),Mt.autoplay&&Mt.play(),Mt}function Bi(se,ge){for(var Ne=ge.length;Ne--;)H(se,ge[Ne].animatable.target)&&ge.splice(Ne,1)}function ar(se){for(var ge=Ue(se),Ne=rs.length;Ne--;){var Fe=rs[Ne],Ke=Fe.animations,ot=Fe.children;Bi(ge,Ke);for(var wt=ot.length;wt--;){var qt=ot[wt],Kt=qt.animations;Bi(ge,Kt),!Kt.length&&!qt.children.length&&ot.splice(wt,1)}!Ke.length&&!ot.length&&Fe.pause()}}function Li(se,ge){ge===void 0&&(ge={});var Ne=ge.direction||"normal",Fe=ge.easing?U(ge.easing):null,Ke=ge.grid,ot=ge.axis,wt=ge.from||0,qt=wt==="first",Kt=wt==="center",Mt=wt==="last",ti=w.arr(se),Ei=parseFloat(ti?se[0]:se),Fi=ti?parseFloat(se[1]):0,Tr=Gt(ti?se[1]:se)||0,hr=ge.start||0+(ti?Ei:0),Zi=[],bi=0;return function(Bn,Jn,Ri){if(qt&&(wt=0),Kt&&(wt=(Ri-1)/2),Mt&&(wt=Ri-1),!Zi.length){for(var or=0;or<Ri;or++){if(!Ke)Zi.push(Math.abs(wt-or));else{var pn=Kt?(Ke[0]-1)/2:wt%Ke[0],Yr=Kt?(Ke[1]-1)/2:Math.floor(wt/Ke[0]),W=or%Ke[0],ue=Math.floor(or/Ke[0]),Ae=pn-W,Se=Yr-ue,We=Math.sqrt(Ae*Ae+Se*Se);ot==="x"&&(We=-Ae),ot==="y"&&(We=-Se),Zi.push(We)}bi=Math.max.apply(Math,Zi)}Fe&&(Zi=Zi.map(function(ft){return Fe(ft/bi)*bi})),Ne==="reverse"&&(Zi=Zi.map(function(ft){return ot?ft<0?ft*-1:-ft:Math.abs(bi-ft)}))}var Ye=ti?(Fi-Ei)/bi:Ei;return hr+Ye*(Math.round(Zi[Jn]*100)/100)+Tr}}function Pi(se){se===void 0&&(se={});var ge=Xt(se);return ge.duration=0,ge.add=function(Ne,Fe){var Ke=rs.indexOf(ge),ot=ge.children;Ke>-1&&rs.splice(Ke,1);function wt(Fi){Fi.passThrough=!0}for(var qt=0;qt<ot.length;qt++)wt(ot[qt]);var Kt=Y(Ne,ne(p,se));Kt.targets=Kt.targets||se.targets;var Mt=ge.duration;Kt.autoplay=!1,Kt.direction=ge.direction,Kt.timelineOffset=w.und(Fe)?Mt:yt(Fe,Mt),wt(ge),ge.seek(Kt.timelineOffset);var ti=Xt(Kt);wt(ti),ot.push(ti);var Ei=xs(ot,se);return ge.delay=Ei.delay,ge.endDelay=Ei.endDelay,ge.duration=Ei.duration,ge.seek(0),ge.reset(),ge.autoplay&&ge.play(),ge},ge}Xt.version="3.0.0",Xt.speed=1,Xt.running=rs,Xt.remove=ar,Xt.get=Qe,Xt.set=An,Xt.convertPx=Ui,Xt.path=J,Xt.setDashoffset=ke,Xt.stagger=Li,Xt.timeline=Pi,Xt.easing=U,Xt.penner=O,Xt.random=function(se,ge){return Math.floor(Math.random()*(ge-se+1))+se};const Be=Xt},"./node_modules/three-bmfont-text/index.js":(l,u,c)=>{var h=c("./node_modules/layout-bmfont-text/index.js"),p=c("./node_modules/quad-indices/index.js"),f=c("./node_modules/three-bmfont-text/lib/vertices.js"),m=c("./node_modules/three-bmfont-text/lib/utils.js");l.exports=function(y){return new g(y)};class g extends THREE.BufferGeometry{constructor(x){super(),typeof x=="string"&&(x={text:x}),this._opt=Object.assign({},x),x&&this.update(x)}update(x){if(typeof x=="string"&&(x={text:x}),x=Object.assign({},this._opt,x),!x.font)throw new TypeError("must specify a { font } in options");this.layout=h(x);var v=x.flipY!==!1,_=x.font,T=_.common.scaleW,w=_.common.scaleH,S=this.layout.glyphs.filter(function(L){var O=L.data;return O.width*O.height>0});this.visibleGlyphs=S;var R=f.positions(S),B=f.uvs(S,T,w,v),I=p([],{clockwise:!0,type:"uint16",count:S.length});if(this.setIndex(I),this.setAttribute("position",new THREE.BufferAttribute(R,2)),this.setAttribute("uv",new THREE.BufferAttribute(B,2)),!x.multipage&&"page"in this.attributes)this.removeAttribute("page");else if(x.multipage){var D=f.pages(S);this.setAttribute("page",new THREE.BufferAttribute(D,1))}this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere()}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new THREE.Sphere);var x=this.attributes.position.array,v=this.attributes.position.itemSize;if(!x||!v||x.length<2){this.boundingSphere.radius=0,this.boundingSphere.center.set(0,0,0);return}m.computeSphere(x,this.boundingSphere),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new THREE.Box3);var x=this.boundingBox,v=this.attributes.position.array,_=this.attributes.position.itemSize;if(!v||!_||v.length<2){x.makeEmpty();return}m.computeBox(v,x)}}},"./node_modules/three-bmfont-text/lib/utils.js":l=>{var u=2,c={min:[0,0],max:[0,0]};function h(p){var f=p.length/u;c.min[0]=p[0],c.min[1]=p[1],c.max[0]=p[0],c.max[1]=p[1];for(var m=0;m<f;m++){var g=p[m*u+0],y=p[m*u+1];c.min[0]=Math.min(g,c.min[0]),c.min[1]=Math.min(y,c.min[1]),c.max[0]=Math.max(g,c.max[0]),c.max[1]=Math.max(y,c.max[1])}}l.exports.computeBox=function(p,f){h(p),f.min.set(c.min[0],c.min[1],0),f.max.set(c.max[0],c.max[1],0)},l.exports.computeSphere=function(p,f){h(p);var m=c.min[0],g=c.min[1],y=c.max[0],x=c.max[1],v=y-m,_=x-g,T=Math.sqrt(v*v+_*_);f.center.set(m+v/2,g+_/2,0),f.radius=T/2}},"./node_modules/three-bmfont-text/lib/vertices.js":l=>{l.exports.pages=function(u){var c=new Float32Array(u.length*4*1),h=0;return u.forEach(function(p){var f=p.data.page||0;c[h++]=f,c[h++]=f,c[h++]=f,c[h++]=f}),c},l.exports.uvs=function(u,c,h,p){var f=new Float32Array(u.length*4*2),m=0;return u.forEach(function(g){var y=g.data,x=y.x+y.width,v=y.y+y.height,_=y.x/c,T=y.y/h,w=x/c,S=v/h;p&&(T=(h-y.y)/h,S=(h-v)/h),f[m++]=_,f[m++]=T,f[m++]=_,f[m++]=S,f[m++]=w,f[m++]=S,f[m++]=w,f[m++]=T}),f},l.exports.positions=function(u){var c=new Float32Array(u.length*4*2),h=0;return u.forEach(function(p){var f=p.data,m=p.position[0]+f.xoffset,g=p.position[1]+f.yoffset,y=f.width,x=f.height;c[h++]=m,c[h++]=g,c[h++]=m,c[h++]=g+x,c[h++]=m+y,c[h++]=g+x,c[h++]=m+y,c[h++]=g}),c}},"./node_modules/webvr-polyfill/build/webvr-polyfill.js":function(l,u,c){/**
 * @license
 * webvr-polyfill
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * cardboard-vr-display
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * webvr-polyfill-dpdb 
 * Copyright (c) 2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * wglu-preserve-state
 * Copyright (c) 2016, Brandon Jones.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *//**
 * @license
 * nosleep.js
 * Copyright (c) 2017, Rich Tibbett
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */(function(h,p){l.exports=p()})(this,function(){var h=typeof window<"u"?window:typeof c.g<"u"?c.g:typeof self<"u"?self:{};function p(I){return I&&I.__esModule&&Object.prototype.hasOwnProperty.call(I,"default")?I.default:I}function f(I,D){return D={exports:{}},I(D,D.exports),D.exports}var m=function(){return/Android/i.test(navigator.userAgent)||/iPhone|iPad|iPod/i.test(navigator.userAgent)},g=function(I,D){for(var L=0,O=I.length;L<O;L++)D[L]=I[L]},y=function(I,D){for(var L in D)D.hasOwnProperty(L)&&(I[L]=D[L]);return I},x=f(function(I,D){/**
 * @license
 * cardboard-vr-display
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * gl-preserve-state
 * Copyright (c) 2016, Brandon Jones.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *//**
 * @license
 * webvr-polyfill-dpdb
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * nosleep.js
 * Copyright (c) 2017, Rich Tibbett
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */(function(L,O){I.exports=O()})(h,function(){var L=function(W,ue){if(!(W instanceof ue))throw new TypeError("Cannot call a class as a function")},O=function(){function W(ue,Ae){for(var Se=0;Se<Ae.length;Se++){var We=Ae[Se];We.enumerable=We.enumerable||!1,We.configurable=!0,"value"in We&&(We.writable=!0),Object.defineProperty(ue,We.key,We)}}return function(ue,Ae,Se){return Ae&&W(ue.prototype,Ae),Se&&W(ue,Se),ue}}(),U=function(){function W(ue,Ae){var Se=[],We=!0,Ye=!1,ft=void 0;try{for(var he=ue[Symbol.iterator](),le;!(We=(le=he.next()).done)&&(Se.push(le.value),!(Ae&&Se.length===Ae));We=!0);}catch(pe){Ye=!0,ft=pe}finally{try{!We&&he.return&&he.return()}finally{if(Ye)throw ft}}return Se}return function(ue,Ae){if(Array.isArray(ue))return ue;if(Symbol.iterator in Object(ue))return W(ue,Ae);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),Z=.001,G=1,z=function(W,ue){return"data:"+W+","+encodeURIComponent(ue)},$=function(W,ue,Ae){return W+(ue-W)*Ae},Q=function(){var W=/iPad|iPhone|iPod/.test(navigator.platform);return function(){return W}}(),H=function(){var W=navigator.userAgent.indexOf("Version")!==-1&&navigator.userAgent.indexOf("Android")!==-1&&navigator.userAgent.indexOf("Chrome")!==-1;return function(){return W}}(),V=function(){var W=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);return function(){return W}}(),ne=function(){var W=navigator.userAgent.indexOf("Firefox")!==-1&&navigator.userAgent.indexOf("Android")!==-1;return function(){return W}}(),Y=function(){var W=navigator.userAgent.match(/.*Chrome\/([0-9]+)/),ue=W?parseInt(W[1],10):null;return function(){return ue}}(),ae=function(){var W=!1;return W=Q()&&V()&&navigator.userAgent.indexOf("13_4")!==-1,function(){return W}}(),xe=function(){var W=!1;if(Y()===65){var ue=navigator.userAgent.match(/.*Chrome\/([0-9\.]*)/);if(ue){var Ae=ue[1].split("."),Se=U(Ae,4);Se[0],Se[1];var We=Se[2],Ye=Se[3];W=parseInt(We,10)===3325&&parseInt(Ye,10)<148}}return function(){return W}}(),fe=function(){var W=navigator.userAgent.indexOf("R7 Build")!==-1;return function(){return W}}(),de=function(){var W=window.orientation==90||window.orientation==-90;return fe()?!W:W},Ie=function(W){return!(isNaN(W)||W<=Z||W>G)},Ge=function(){return Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio},Xe=function(){return Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio},$e=function(W){if(H())return!1;if(W.requestFullscreen)W.requestFullscreen();else if(W.webkitRequestFullscreen)W.webkitRequestFullscreen();else if(W.mozRequestFullScreen)W.mozRequestFullScreen();else if(W.msRequestFullscreen)W.msRequestFullscreen();else return!1;return!0},lt=function(){if(document.exitFullscreen)document.exitFullscreen();else if(document.webkitExitFullscreen)document.webkitExitFullscreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else if(document.msExitFullscreen)document.msExitFullscreen();else return!1;return!0},At=function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},Gt=function(W,ue,Ae,Se){var We=W.createShader(W.VERTEX_SHADER);W.shaderSource(We,ue),W.compileShader(We);var Ye=W.createShader(W.FRAGMENT_SHADER);W.shaderSource(Ye,Ae),W.compileShader(Ye);var ft=W.createProgram();W.attachShader(ft,We),W.attachShader(ft,Ye);for(var he in Se)W.bindAttribLocation(ft,Se[he],he);return W.linkProgram(ft),W.deleteShader(We),W.deleteShader(Ye),ft},gt=function(W,ue){for(var Ae={},Se=W.getProgramParameter(ue,W.ACTIVE_UNIFORMS),We="",Ye=0;Ye<Se;Ye++){var ft=W.getActiveUniform(ue,Ye);We=ft.name.replace("[0]",""),Ae[We]=W.getUniformLocation(ue,We)}return Ae},xi=function(W,ue,Ae,Se,We,Ye,ft){var he=1/(ue-Ae),le=1/(Se-We),pe=1/(Ye-ft);return W[0]=-2*he,W[1]=0,W[2]=0,W[3]=0,W[4]=0,W[5]=-2*le,W[6]=0,W[7]=0,W[8]=0,W[9]=0,W[10]=2*pe,W[11]=0,W[12]=(ue+Ae)*he,W[13]=(We+Se)*le,W[14]=(ft+Ye)*pe,W[15]=1,W},Ze=function(){var W=!1;return function(ue){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(ue)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(ue.substr(0,4)))&&(W=!0)}(navigator.userAgent||navigator.vendor||window.opera),W},Ui=function(W,ue){for(var Ae in ue)ue.hasOwnProperty(Ae)&&(W[Ae]=ue[Ae]);return W},di=function(W){if(Q()){var ue=W.style.width,Ae=W.style.height;W.style.width=parseInt(ue)+1+"px",W.style.height=parseInt(Ae)+"px",setTimeout(function(){W.style.width=ue,W.style.height=Ae},100)}window.canvas=W},Ii=function(){var W=Math.PI/180,ue=Math.PI*.25;function Ae(pe,be,Ee,st){var Ct=Math.tan(be?be.upDegrees*W:ue),Ht=Math.tan(be?be.downDegrees*W:ue),ii=Math.tan(be?be.leftDegrees*W:ue),Ai=Math.tan(be?be.rightDegrees*W:ue),Wt=2/(ii+Ai),Ni=2/(Ct+Ht);return pe[0]=Wt,pe[1]=0,pe[2]=0,pe[3]=0,pe[4]=0,pe[5]=Ni,pe[6]=0,pe[7]=0,pe[8]=-((ii-Ai)*Wt*.5),pe[9]=(Ct-Ht)*Ni*.5,pe[10]=st/(Ee-st),pe[11]=-1,pe[12]=0,pe[13]=0,pe[14]=st*Ee/(Ee-st),pe[15]=0,pe}function Se(pe,be,Ee){var st=be[0],Ct=be[1],Ht=be[2],ii=be[3],Ai=st+st,Wt=Ct+Ct,Ni=Ht+Ht,xr=st*Ai,pr=st*Wt,fr=st*Ni,Wi=Ct*Wt,Cr=Ct*Ni,Mr=Ht*Ni,zr=ii*Ai,Hr=ii*Wt,_n=ii*Ni;return pe[0]=1-(Wi+Mr),pe[1]=pr+_n,pe[2]=fr-Hr,pe[3]=0,pe[4]=pr-_n,pe[5]=1-(xr+Mr),pe[6]=Cr+zr,pe[7]=0,pe[8]=fr+Hr,pe[9]=Cr-zr,pe[10]=1-(xr+Wi),pe[11]=0,pe[12]=Ee[0],pe[13]=Ee[1],pe[14]=Ee[2],pe[15]=1,pe}function We(pe,be,Ee){var st=Ee[0],Ct=Ee[1],Ht=Ee[2],ii,Ai,Wt,Ni,xr,pr,fr,Wi,Cr,Mr,zr,Hr;return be===pe?(pe[12]=be[0]*st+be[4]*Ct+be[8]*Ht+be[12],pe[13]=be[1]*st+be[5]*Ct+be[9]*Ht+be[13],pe[14]=be[2]*st+be[6]*Ct+be[10]*Ht+be[14],pe[15]=be[3]*st+be[7]*Ct+be[11]*Ht+be[15]):(ii=be[0],Ai=be[1],Wt=be[2],Ni=be[3],xr=be[4],pr=be[5],fr=be[6],Wi=be[7],Cr=be[8],Mr=be[9],zr=be[10],Hr=be[11],pe[0]=ii,pe[1]=Ai,pe[2]=Wt,pe[3]=Ni,pe[4]=xr,pe[5]=pr,pe[6]=fr,pe[7]=Wi,pe[8]=Cr,pe[9]=Mr,pe[10]=zr,pe[11]=Hr,pe[12]=ii*st+xr*Ct+Cr*Ht+be[12],pe[13]=Ai*st+pr*Ct+Mr*Ht+be[13],pe[14]=Wt*st+fr*Ct+zr*Ht+be[14],pe[15]=Ni*st+Wi*Ct+Hr*Ht+be[15]),pe}function Ye(pe,be){var Ee=be[0],st=be[1],Ct=be[2],Ht=be[3],ii=be[4],Ai=be[5],Wt=be[6],Ni=be[7],xr=be[8],pr=be[9],fr=be[10],Wi=be[11],Cr=be[12],Mr=be[13],zr=be[14],Hr=be[15],_n=Ee*Ai-st*ii,Gr=Ee*Wt-Ct*ii,ps=Ee*Ni-Ht*ii,Or=st*Wt-Ct*Ai,_l=st*Ni-Ht*Ai,$o=Ct*Ni-Ht*Wt,Rc=xr*Mr-pr*Cr,$c=xr*zr-fr*Cr,eu=xr*Hr-Wi*Cr,co=pr*zr-fr*Mr,tu=pr*Hr-Wi*Mr,Xa=fr*Hr-Wi*zr,kn=_n*Xa-Gr*tu+ps*co+Or*eu-_l*$c+$o*Rc;return kn?(kn=1/kn,pe[0]=(Ai*Xa-Wt*tu+Ni*co)*kn,pe[1]=(Ct*tu-st*Xa-Ht*co)*kn,pe[2]=(Mr*$o-zr*_l+Hr*Or)*kn,pe[3]=(fr*_l-pr*$o-Wi*Or)*kn,pe[4]=(Wt*eu-ii*Xa-Ni*$c)*kn,pe[5]=(Ee*Xa-Ct*eu+Ht*$c)*kn,pe[6]=(zr*ps-Cr*$o-Hr*Gr)*kn,pe[7]=(xr*$o-fr*ps+Wi*Gr)*kn,pe[8]=(ii*tu-Ai*eu+Ni*Rc)*kn,pe[9]=(st*eu-Ee*tu-Ht*Rc)*kn,pe[10]=(Cr*_l-Mr*ps+Hr*_n)*kn,pe[11]=(pr*ps-xr*_l-Wi*_n)*kn,pe[12]=(Ai*$c-ii*co-Wt*Rc)*kn,pe[13]=(Ee*co-st*$c+Ct*Rc)*kn,pe[14]=(Mr*Gr-Cr*Or-zr*_n)*kn,pe[15]=(xr*Or-pr*Gr+fr*_n)*kn,pe):null}var ft=new Float32Array([0,0,0,1]),he=new Float32Array([0,0,0]);function le(pe,be,Ee,st,Ct,Ht){Ae(pe,st||null,Ht.depthNear,Ht.depthFar);var ii=Ee.orientation||ft,Ai=Ee.position||he;Se(be,ii,Ai),Ct&&We(be,be,Ct),Ye(be,be)}return function(pe,be,Ee){return!pe||!be?!1:(pe.pose=be,pe.timestamp=be.timestamp,le(pe.leftProjectionMatrix,pe.leftViewMatrix,be,Ee._getFieldOfView("left"),Ee._getEyeOffset("left"),Ee),le(pe.rightProjectionMatrix,pe.rightViewMatrix,be,Ee._getFieldOfView("right"),Ee._getEyeOffset("right"),Ee),!0)}}(),Ti=function(){var W=window.self!==window.top,ue=ir(document.referrer),Ae=ir(window.location.href);return W&&ue!==Ae},ir=function(W){var ue,Ae=W.indexOf("://");Ae!==-1?ue=Ae+3:ue=0;var Se=W.indexOf("/",ue);return Se===-1&&(Se=W.length),W.substring(0,Se)},Gi=function(W){if(W.w>1)return console.warn("getQuaternionAngle: w > 1"),0;var ue=2*Math.acos(W.w);return ue},Qe=function(){var W={};return function(ue,Ae){W[ue]===void 0&&(console.warn("webvr-polyfill: "+Ae),W[ue]=!0)}}(),Ce=function(W,ue){var Ae=ue?"Please use "+ue+" instead.":"";Qe(W,W+" has been deprecated. This may not work on native WebVR displays. "+Ae)};function yt(W,ue,Ae){if(!ue){Ae(W);return}for(var Se=[],We=null,Ye=0;Ye<ue.length;++Ye){var ft=ue[Ye];switch(ft){case W.TEXTURE_BINDING_2D:case W.TEXTURE_BINDING_CUBE_MAP:var he=ue[++Ye];if(he<W.TEXTURE0||he>W.TEXTURE31){console.error("TEXTURE_BINDING_2D or TEXTURE_BINDING_CUBE_MAP must be followed by a valid texture unit"),Se.push(null,null);break}We||(We=W.getParameter(W.ACTIVE_TEXTURE)),W.activeTexture(he),Se.push(W.getParameter(ft),null);break;case W.ACTIVE_TEXTURE:We=W.getParameter(W.ACTIVE_TEXTURE),Se.push(null);break;default:Se.push(W.getParameter(ft));break}}Ae(W);for(var Ye=0;Ye<ue.length;++Ye){var ft=ue[Ye],le=Se[Ye];switch(ft){case W.ACTIVE_TEXTURE:break;case W.ARRAY_BUFFER_BINDING:W.bindBuffer(W.ARRAY_BUFFER,le);break;case W.COLOR_CLEAR_VALUE:W.clearColor(le[0],le[1],le[2],le[3]);break;case W.COLOR_WRITEMASK:W.colorMask(le[0],le[1],le[2],le[3]);break;case W.CURRENT_PROGRAM:W.useProgram(le);break;case W.ELEMENT_ARRAY_BUFFER_BINDING:W.bindBuffer(W.ELEMENT_ARRAY_BUFFER,le);break;case W.FRAMEBUFFER_BINDING:W.bindFramebuffer(W.FRAMEBUFFER,le);break;case W.RENDERBUFFER_BINDING:W.bindRenderbuffer(W.RENDERBUFFER,le);break;case W.TEXTURE_BINDING_2D:var he=ue[++Ye];if(he<W.TEXTURE0||he>W.TEXTURE31)break;W.activeTexture(he),W.bindTexture(W.TEXTURE_2D,le);break;case W.TEXTURE_BINDING_CUBE_MAP:var he=ue[++Ye];if(he<W.TEXTURE0||he>W.TEXTURE31)break;W.activeTexture(he),W.bindTexture(W.TEXTURE_CUBE_MAP,le);break;case W.VIEWPORT:W.viewport(le[0],le[1],le[2],le[3]);break;case W.BLEND:case W.CULL_FACE:case W.DEPTH_TEST:case W.SCISSOR_TEST:case W.STENCIL_TEST:le?W.enable(ft):W.disable(ft);break;default:console.log("No GL restore behavior for 0x"+ft.toString(16));break}We&&W.activeTexture(We)}}var Ot=yt,Jt=["attribute vec2 position;","attribute vec3 texCoord;","varying vec2 vTexCoord;","uniform vec4 viewportOffsetScale[2];","void main() {","  vec4 viewport = viewportOffsetScale[int(texCoord.z)];","  vTexCoord = (texCoord.xy * viewport.zw) + viewport.xy;","  gl_Position = vec4( position, 1.0, 1.0 );","}"].join(`
`),zt=["precision mediump float;","uniform sampler2D diffuse;","varying vec2 vTexCoord;","void main() {","  gl_FragColor = texture2D(diffuse, vTexCoord);","}"].join(`
`);function _i(W,ue,Ae,Se){this.gl=W,this.cardboardUI=ue,this.bufferScale=Ae,this.dirtySubmitFrameBindings=Se,this.ctxAttribs=W.getContextAttributes(),this.instanceExt=W.getExtension("ANGLE_instanced_arrays"),this.meshWidth=20,this.meshHeight=20,this.bufferWidth=W.drawingBufferWidth,this.bufferHeight=W.drawingBufferHeight,this.realBindFramebuffer=W.bindFramebuffer,this.realEnable=W.enable,this.realDisable=W.disable,this.realColorMask=W.colorMask,this.realClearColor=W.clearColor,this.realViewport=W.viewport,Q()||(this.realCanvasWidth=Object.getOwnPropertyDescriptor(W.canvas.__proto__,"width"),this.realCanvasHeight=Object.getOwnPropertyDescriptor(W.canvas.__proto__,"height")),this.isPatched=!1,this.lastBoundFramebuffer=null,this.cullFace=!1,this.depthTest=!1,this.blend=!1,this.scissorTest=!1,this.stencilTest=!1,this.viewport=[0,0,0,0],this.colorMask=[!0,!0,!0,!0],this.clearColor=[0,0,0,0],this.attribs={position:0,texCoord:1},this.program=Gt(W,Jt,zt,this.attribs),this.uniforms=gt(W,this.program),this.viewportOffsetScale=new Float32Array(8),this.setTextureBounds(),this.vertexBuffer=W.createBuffer(),this.indexBuffer=W.createBuffer(),this.indexCount=0,this.renderTarget=W.createTexture(),this.framebuffer=W.createFramebuffer(),this.depthStencilBuffer=null,this.depthBuffer=null,this.stencilBuffer=null,this.ctxAttribs.depth&&this.ctxAttribs.stencil?this.depthStencilBuffer=W.createRenderbuffer():this.ctxAttribs.depth?this.depthBuffer=W.createRenderbuffer():this.ctxAttribs.stencil&&(this.stencilBuffer=W.createRenderbuffer()),this.patch(),this.onResize()}_i.prototype.destroy=function(){var W=this.gl;this.unpatch(),W.deleteProgram(this.program),W.deleteBuffer(this.vertexBuffer),W.deleteBuffer(this.indexBuffer),W.deleteTexture(this.renderTarget),W.deleteFramebuffer(this.framebuffer),this.depthStencilBuffer&&W.deleteRenderbuffer(this.depthStencilBuffer),this.depthBuffer&&W.deleteRenderbuffer(this.depthBuffer),this.stencilBuffer&&W.deleteRenderbuffer(this.stencilBuffer),this.cardboardUI&&this.cardboardUI.destroy()},_i.prototype.onResize=function(){var W=this.gl,ue=this,Ae=[W.RENDERBUFFER_BINDING,W.TEXTURE_BINDING_2D,W.TEXTURE0];Ot(W,Ae,function(Se){ue.realBindFramebuffer.call(Se,Se.FRAMEBUFFER,null),ue.scissorTest&&ue.realDisable.call(Se,Se.SCISSOR_TEST),ue.realColorMask.call(Se,!0,!0,!0,!0),ue.realViewport.call(Se,0,0,Se.drawingBufferWidth,Se.drawingBufferHeight),ue.realClearColor.call(Se,0,0,0,1),Se.clear(Se.COLOR_BUFFER_BIT),ue.realBindFramebuffer.call(Se,Se.FRAMEBUFFER,ue.framebuffer),Se.bindTexture(Se.TEXTURE_2D,ue.renderTarget),Se.texImage2D(Se.TEXTURE_2D,0,ue.ctxAttribs.alpha?Se.RGBA:Se.RGB,ue.bufferWidth,ue.bufferHeight,0,ue.ctxAttribs.alpha?Se.RGBA:Se.RGB,Se.UNSIGNED_BYTE,null),Se.texParameteri(Se.TEXTURE_2D,Se.TEXTURE_MAG_FILTER,Se.LINEAR),Se.texParameteri(Se.TEXTURE_2D,Se.TEXTURE_MIN_FILTER,Se.LINEAR),Se.texParameteri(Se.TEXTURE_2D,Se.TEXTURE_WRAP_S,Se.CLAMP_TO_EDGE),Se.texParameteri(Se.TEXTURE_2D,Se.TEXTURE_WRAP_T,Se.CLAMP_TO_EDGE),Se.framebufferTexture2D(Se.FRAMEBUFFER,Se.COLOR_ATTACHMENT0,Se.TEXTURE_2D,ue.renderTarget,0),ue.ctxAttribs.depth&&ue.ctxAttribs.stencil?(Se.bindRenderbuffer(Se.RENDERBUFFER,ue.depthStencilBuffer),Se.renderbufferStorage(Se.RENDERBUFFER,Se.DEPTH_STENCIL,ue.bufferWidth,ue.bufferHeight),Se.framebufferRenderbuffer(Se.FRAMEBUFFER,Se.DEPTH_STENCIL_ATTACHMENT,Se.RENDERBUFFER,ue.depthStencilBuffer)):ue.ctxAttribs.depth?(Se.bindRenderbuffer(Se.RENDERBUFFER,ue.depthBuffer),Se.renderbufferStorage(Se.RENDERBUFFER,Se.DEPTH_COMPONENT16,ue.bufferWidth,ue.bufferHeight),Se.framebufferRenderbuffer(Se.FRAMEBUFFER,Se.DEPTH_ATTACHMENT,Se.RENDERBUFFER,ue.depthBuffer)):ue.ctxAttribs.stencil&&(Se.bindRenderbuffer(Se.RENDERBUFFER,ue.stencilBuffer),Se.renderbufferStorage(Se.RENDERBUFFER,Se.STENCIL_INDEX8,ue.bufferWidth,ue.bufferHeight),Se.framebufferRenderbuffer(Se.FRAMEBUFFER,Se.STENCIL_ATTACHMENT,Se.RENDERBUFFER,ue.stencilBuffer)),!Se.checkFramebufferStatus(Se.FRAMEBUFFER)===Se.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer incomplete!"),ue.realBindFramebuffer.call(Se,Se.FRAMEBUFFER,ue.lastBoundFramebuffer),ue.scissorTest&&ue.realEnable.call(Se,Se.SCISSOR_TEST),ue.realColorMask.apply(Se,ue.colorMask),ue.realViewport.apply(Se,ue.viewport),ue.realClearColor.apply(Se,ue.clearColor)}),this.cardboardUI&&this.cardboardUI.onResize()},_i.prototype.patch=function(){if(!this.isPatched){var W=this,ue=this.gl.canvas,Ae=this.gl;Q()||(ue.width=Ge()*this.bufferScale,ue.height=Xe()*this.bufferScale,Object.defineProperty(ue,"width",{configurable:!0,enumerable:!0,get:function(){return W.bufferWidth},set:function(Se){W.bufferWidth=Se,W.realCanvasWidth.set.call(ue,Se),W.onResize()}}),Object.defineProperty(ue,"height",{configurable:!0,enumerable:!0,get:function(){return W.bufferHeight},set:function(Se){W.bufferHeight=Se,W.realCanvasHeight.set.call(ue,Se),W.onResize()}})),this.lastBoundFramebuffer=Ae.getParameter(Ae.FRAMEBUFFER_BINDING),this.lastBoundFramebuffer==null&&(this.lastBoundFramebuffer=this.framebuffer,this.gl.bindFramebuffer(Ae.FRAMEBUFFER,this.framebuffer)),this.gl.bindFramebuffer=function(Se,We){W.lastBoundFramebuffer=We||W.framebuffer,W.realBindFramebuffer.call(Ae,Se,W.lastBoundFramebuffer)},this.cullFace=Ae.getParameter(Ae.CULL_FACE),this.depthTest=Ae.getParameter(Ae.DEPTH_TEST),this.blend=Ae.getParameter(Ae.BLEND),this.scissorTest=Ae.getParameter(Ae.SCISSOR_TEST),this.stencilTest=Ae.getParameter(Ae.STENCIL_TEST),Ae.enable=function(Se){switch(Se){case Ae.CULL_FACE:W.cullFace=!0;break;case Ae.DEPTH_TEST:W.depthTest=!0;break;case Ae.BLEND:W.blend=!0;break;case Ae.SCISSOR_TEST:W.scissorTest=!0;break;case Ae.STENCIL_TEST:W.stencilTest=!0;break}W.realEnable.call(Ae,Se)},Ae.disable=function(Se){switch(Se){case Ae.CULL_FACE:W.cullFace=!1;break;case Ae.DEPTH_TEST:W.depthTest=!1;break;case Ae.BLEND:W.blend=!1;break;case Ae.SCISSOR_TEST:W.scissorTest=!1;break;case Ae.STENCIL_TEST:W.stencilTest=!1;break}W.realDisable.call(Ae,Se)},this.colorMask=Ae.getParameter(Ae.COLOR_WRITEMASK),Ae.colorMask=function(Se,We,Ye,ft){W.colorMask[0]=Se,W.colorMask[1]=We,W.colorMask[2]=Ye,W.colorMask[3]=ft,W.realColorMask.call(Ae,Se,We,Ye,ft)},this.clearColor=Ae.getParameter(Ae.COLOR_CLEAR_VALUE),Ae.clearColor=function(Se,We,Ye,ft){W.clearColor[0]=Se,W.clearColor[1]=We,W.clearColor[2]=Ye,W.clearColor[3]=ft,W.realClearColor.call(Ae,Se,We,Ye,ft)},this.viewport=Ae.getParameter(Ae.VIEWPORT),Ae.viewport=function(Se,We,Ye,ft){W.viewport[0]=Se,W.viewport[1]=We,W.viewport[2]=Ye,W.viewport[3]=ft,W.realViewport.call(Ae,Se,We,Ye,ft)},this.isPatched=!0,di(ue)}},_i.prototype.unpatch=function(){if(this.isPatched){var W=this.gl,ue=this.gl.canvas;Q()||(Object.defineProperty(ue,"width",this.realCanvasWidth),Object.defineProperty(ue,"height",this.realCanvasHeight)),ue.width=this.bufferWidth,ue.height=this.bufferHeight,W.bindFramebuffer=this.realBindFramebuffer,W.enable=this.realEnable,W.disable=this.realDisable,W.colorMask=this.realColorMask,W.clearColor=this.realClearColor,W.viewport=this.realViewport,this.lastBoundFramebuffer==this.framebuffer&&W.bindFramebuffer(W.FRAMEBUFFER,null),this.isPatched=!1,setTimeout(function(){di(ue)},1)}},_i.prototype.setTextureBounds=function(W,ue){W||(W=[0,0,.5,1]),ue||(ue=[.5,0,.5,1]),this.viewportOffsetScale[0]=W[0],this.viewportOffsetScale[1]=W[1],this.viewportOffsetScale[2]=W[2],this.viewportOffsetScale[3]=W[3],this.viewportOffsetScale[4]=ue[0],this.viewportOffsetScale[5]=ue[1],this.viewportOffsetScale[6]=ue[2],this.viewportOffsetScale[7]=ue[3]},_i.prototype.submitFrame=function(){var W=this.gl,ue=this,Ae=[];if(this.dirtySubmitFrameBindings||Ae.push(W.CURRENT_PROGRAM,W.ARRAY_BUFFER_BINDING,W.ELEMENT_ARRAY_BUFFER_BINDING,W.TEXTURE_BINDING_2D,W.TEXTURE0),Ot(W,Ae,function(We){ue.realBindFramebuffer.call(We,We.FRAMEBUFFER,null);var Ye=0,ft=0;ue.instanceExt&&(Ye=We.getVertexAttrib(ue.attribs.position,ue.instanceExt.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE),ft=We.getVertexAttrib(ue.attribs.texCoord,ue.instanceExt.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE)),ue.cullFace&&ue.realDisable.call(We,We.CULL_FACE),ue.depthTest&&ue.realDisable.call(We,We.DEPTH_TEST),ue.blend&&ue.realDisable.call(We,We.BLEND),ue.scissorTest&&ue.realDisable.call(We,We.SCISSOR_TEST),ue.stencilTest&&ue.realDisable.call(We,We.STENCIL_TEST),ue.realColorMask.call(We,!0,!0,!0,!0),ue.realViewport.call(We,0,0,We.drawingBufferWidth,We.drawingBufferHeight),(ue.ctxAttribs.alpha||Q())&&(ue.realClearColor.call(We,0,0,0,1),We.clear(We.COLOR_BUFFER_BIT)),We.useProgram(ue.program),We.bindBuffer(We.ELEMENT_ARRAY_BUFFER,ue.indexBuffer),We.bindBuffer(We.ARRAY_BUFFER,ue.vertexBuffer),We.enableVertexAttribArray(ue.attribs.position),We.enableVertexAttribArray(ue.attribs.texCoord),We.vertexAttribPointer(ue.attribs.position,2,We.FLOAT,!1,20,0),We.vertexAttribPointer(ue.attribs.texCoord,3,We.FLOAT,!1,20,8),ue.instanceExt&&(Ye!=0&&ue.instanceExt.vertexAttribDivisorANGLE(ue.attribs.position,0),ft!=0&&ue.instanceExt.vertexAttribDivisorANGLE(ue.attribs.texCoord,0)),We.activeTexture(We.TEXTURE0),We.uniform1i(ue.uniforms.diffuse,0),We.bindTexture(We.TEXTURE_2D,ue.renderTarget),We.uniform4fv(ue.uniforms.viewportOffsetScale,ue.viewportOffsetScale),We.drawElements(We.TRIANGLES,ue.indexCount,We.UNSIGNED_SHORT,0),ue.cardboardUI&&ue.cardboardUI.renderNoState(),ue.realBindFramebuffer.call(ue.gl,We.FRAMEBUFFER,ue.framebuffer),ue.ctxAttribs.preserveDrawingBuffer||(ue.realClearColor.call(We,0,0,0,0),We.clear(We.COLOR_BUFFER_BIT)),ue.dirtySubmitFrameBindings||ue.realBindFramebuffer.call(We,We.FRAMEBUFFER,ue.lastBoundFramebuffer),ue.cullFace&&ue.realEnable.call(We,We.CULL_FACE),ue.depthTest&&ue.realEnable.call(We,We.DEPTH_TEST),ue.blend&&ue.realEnable.call(We,We.BLEND),ue.scissorTest&&ue.realEnable.call(We,We.SCISSOR_TEST),ue.stencilTest&&ue.realEnable.call(We,We.STENCIL_TEST),ue.realColorMask.apply(We,ue.colorMask),ue.realViewport.apply(We,ue.viewport),(ue.ctxAttribs.alpha||!ue.ctxAttribs.preserveDrawingBuffer)&&ue.realClearColor.apply(We,ue.clearColor),ue.instanceExt&&(Ye!=0&&ue.instanceExt.vertexAttribDivisorANGLE(ue.attribs.position,Ye),ft!=0&&ue.instanceExt.vertexAttribDivisorANGLE(ue.attribs.texCoord,ft))}),Q()){var Se=W.canvas;(Se.width!=ue.bufferWidth||Se.height!=ue.bufferHeight)&&(ue.bufferWidth=Se.width,ue.bufferHeight=Se.height,ue.onResize())}},_i.prototype.updateDeviceInfo=function(W){var ue=this.gl,Ae=this,Se=[ue.ARRAY_BUFFER_BINDING,ue.ELEMENT_ARRAY_BUFFER_BINDING];Ot(ue,Se,function(We){var Ye=Ae.computeMeshVertices_(Ae.meshWidth,Ae.meshHeight,W);if(We.bindBuffer(We.ARRAY_BUFFER,Ae.vertexBuffer),We.bufferData(We.ARRAY_BUFFER,Ye,We.STATIC_DRAW),!Ae.indexCount){var ft=Ae.computeMeshIndices_(Ae.meshWidth,Ae.meshHeight);We.bindBuffer(We.ELEMENT_ARRAY_BUFFER,Ae.indexBuffer),We.bufferData(We.ELEMENT_ARRAY_BUFFER,ft,We.STATIC_DRAW),Ae.indexCount=ft.length}})},_i.prototype.computeMeshVertices_=function(W,ue,Ae){for(var Se=new Float32Array(2*W*ue*5),We=Ae.getLeftEyeVisibleTanAngles(),Ye=Ae.getLeftEyeNoLensTanAngles(),ft=Ae.getLeftEyeVisibleScreenRect(Ye),he=0,le=0;le<2;le++){for(var pe=0;pe<ue;pe++)for(var be=0;be<W;be++,he++){var Ee=be/(W-1),st=pe/(ue-1),Ct=Ee,Ht=st,ii=$(We[0],We[2],Ee),Ai=$(We[3],We[1],st),Wt=Math.sqrt(ii*ii+Ai*Ai),Ni=Ae.distortion.distortInverse(Wt),xr=ii*Ni/Wt,pr=Ai*Ni/Wt;Ee=(xr-Ye[0])/(Ye[2]-Ye[0]),st=(pr-Ye[3])/(Ye[1]-Ye[3]),Ee=(ft.x+Ee*ft.width-.5)*2,st=(ft.y+st*ft.height-.5)*2,Se[he*5+0]=Ee,Se[he*5+1]=st,Se[he*5+2]=Ct,Se[he*5+3]=Ht,Se[he*5+4]=le}var fr=We[2]-We[0];We[0]=-(fr+We[0]),We[2]=fr-We[2],fr=Ye[2]-Ye[0],Ye[0]=-(fr+Ye[0]),Ye[2]=fr-Ye[2],ft.x=1-(ft.x+ft.width)}return Se},_i.prototype.computeMeshIndices_=function(W,ue){for(var Ae=new Uint16Array(2*(W-1)*(ue-1)*6),Se=W/2,We=ue/2,Ye=0,ft=0,he=0;he<2;he++)for(var le=0;le<ue;le++)for(var pe=0;pe<W;pe++,Ye++)pe==0||le==0||(pe<=Se==le<=We?(Ae[ft++]=Ye,Ae[ft++]=Ye-W-1,Ae[ft++]=Ye-W,Ae[ft++]=Ye-W-1,Ae[ft++]=Ye,Ae[ft++]=Ye-1):(Ae[ft++]=Ye-1,Ae[ft++]=Ye-W,Ae[ft++]=Ye,Ae[ft++]=Ye-W,Ae[ft++]=Ye-1,Ae[ft++]=Ye-W-1));return Ae},_i.prototype.getOwnPropertyDescriptor_=function(W,ue){var Ae=Object.getOwnPropertyDescriptor(W,ue);return(Ae.get===void 0||Ae.set===void 0)&&(Ae.configurable=!0,Ae.enumerable=!0,Ae.get=function(){return this.getAttribute(ue)},Ae.set=function(Se){this.setAttribute(ue,Se)}),Ae};var vt=["attribute vec2 position;","uniform mat4 projectionMat;","void main() {","  gl_Position = projectionMat * vec4( position, -1.0, 1.0 );","}"].join(`
`),ye=["precision mediump float;","uniform vec4 color;","void main() {","  gl_FragColor = color;","}"].join(`
`),ve=Math.PI/180,Le=60,Te=12,ke=20,Pe=1,F=.75,J=.3125,ie=4,Re=28,ce=1.5;function Ue(W){this.gl=W,this.attribs={position:0},this.program=Gt(W,vt,ye,this.attribs),this.uniforms=gt(W,this.program),this.vertexBuffer=W.createBuffer(),this.gearOffset=0,this.gearVertexCount=0,this.arrowOffset=0,this.arrowVertexCount=0,this.projMat=new Float32Array(16),this.listener=null,this.onResize()}Ue.prototype.destroy=function(){var W=this.gl;this.listener&&W.canvas.removeEventListener("click",this.listener,!1),W.deleteProgram(this.program),W.deleteBuffer(this.vertexBuffer)},Ue.prototype.listen=function(W,ue){var Ae=this.gl.canvas;this.listener=function(Se){var We=Ae.clientWidth/2,Ye=Re*ce;Se.clientX>We-Ye&&Se.clientX<We+Ye&&Se.clientY>Ae.clientHeight-Ye?W(Se):Se.clientX<Ye&&Se.clientY<Ye&&ue(Se)},Ae.addEventListener("click",this.listener,!1)},Ue.prototype.onResize=function(){var W=this.gl,ue=this,Ae=[W.ARRAY_BUFFER_BINDING];Ot(W,Ae,function(Se){var We=[],Ye=Se.drawingBufferWidth/2,ft=Math.max(screen.width,screen.height)*window.devicePixelRatio,he=Se.drawingBufferWidth/ft,le=he*window.devicePixelRatio,pe=ie*le/2,be=Re*ce*le,Ee=Re*le/2,st=(Re*ce-Re)*le;We.push(Ye-pe,be),We.push(Ye-pe,Se.drawingBufferHeight),We.push(Ye+pe,be),We.push(Ye+pe,Se.drawingBufferHeight),ue.gearOffset=We.length/2;function Ct(Ni,xr){var pr=(90-Ni)*ve,fr=Math.cos(pr),Wi=Math.sin(pr);We.push(J*fr*Ee+Ye,J*Wi*Ee+Ee),We.push(xr*fr*Ee+Ye,xr*Wi*Ee+Ee)}for(var Ht=0;Ht<=6;Ht++){var ii=Ht*Le;Ct(ii,Pe),Ct(ii+Te,Pe),Ct(ii+ke,F),Ct(ii+(Le-ke),F),Ct(ii+(Le-Te),Pe)}ue.gearVertexCount=We.length/2-ue.gearOffset,ue.arrowOffset=We.length/2;function Ai(Ni,xr){We.push(st+Ni,Se.drawingBufferHeight-st-xr)}var Wt=pe/Math.sin(45*ve);Ai(0,Ee),Ai(Ee,0),Ai(Ee+Wt,Wt),Ai(Wt,Ee+Wt),Ai(Wt,Ee-Wt),Ai(0,Ee),Ai(Ee,Ee*2),Ai(Ee+Wt,Ee*2-Wt),Ai(Wt,Ee-Wt),Ai(0,Ee),Ai(Wt,Ee-pe),Ai(Re*le,Ee-pe),Ai(Wt,Ee+pe),Ai(Re*le,Ee+pe),ue.arrowVertexCount=We.length/2-ue.arrowOffset,Se.bindBuffer(Se.ARRAY_BUFFER,ue.vertexBuffer),Se.bufferData(Se.ARRAY_BUFFER,new Float32Array(We),Se.STATIC_DRAW)})},Ue.prototype.render=function(){var W=this.gl,ue=this,Ae=[W.CULL_FACE,W.DEPTH_TEST,W.BLEND,W.SCISSOR_TEST,W.STENCIL_TEST,W.COLOR_WRITEMASK,W.VIEWPORT,W.CURRENT_PROGRAM,W.ARRAY_BUFFER_BINDING];Ot(W,Ae,function(Se){Se.disable(Se.CULL_FACE),Se.disable(Se.DEPTH_TEST),Se.disable(Se.BLEND),Se.disable(Se.SCISSOR_TEST),Se.disable(Se.STENCIL_TEST),Se.colorMask(!0,!0,!0,!0),Se.viewport(0,0,Se.drawingBufferWidth,Se.drawingBufferHeight),ue.renderNoState()})},Ue.prototype.renderNoState=function(){var W=this.gl;W.useProgram(this.program),W.bindBuffer(W.ARRAY_BUFFER,this.vertexBuffer),W.enableVertexAttribArray(this.attribs.position),W.vertexAttribPointer(this.attribs.position,2,W.FLOAT,!1,8,0),W.uniform4f(this.uniforms.color,1,1,1,1),xi(this.projMat,0,W.drawingBufferWidth,0,W.drawingBufferHeight,.1,1024),W.uniformMatrix4fv(this.uniforms.projectionMat,!1,this.projMat),W.drawArrays(W.TRIANGLE_STRIP,0,4),W.drawArrays(W.TRIANGLE_STRIP,this.gearOffset,this.gearVertexCount),W.drawArrays(W.TRIANGLE_STRIP,this.arrowOffset,this.arrowVertexCount)};function je(W){this.coefficients=W}je.prototype.distortInverse=function(W){for(var ue=0,Ae=1,Se=W-this.distort(ue);Math.abs(Ae-ue)>1e-4;){var We=W-this.distort(Ae),Ye=Ae-We*((Ae-ue)/(We-Se));ue=Ae,Ae=Ye,Se=We}return Ae},je.prototype.distort=function(W){for(var ue=W*W,Ae=0,Se=0;Se<this.coefficients.length;Se++)Ae=ue*(Ae+this.coefficients[Se]);return(Ae+1)*W};var dt=Math.PI/180,It=180/Math.PI,bt=function(W,ue,Ae){this.x=W||0,this.y=ue||0,this.z=Ae||0};bt.prototype={constructor:bt,set:function(W,ue,Ae){return this.x=W,this.y=ue,this.z=Ae,this},copy:function(W){return this.x=W.x,this.y=W.y,this.z=W.z,this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){var W=this.length();if(W!==0){var ue=1/W;this.multiplyScalar(ue)}else this.x=0,this.y=0,this.z=0;return this},multiplyScalar:function(W){this.x*=W,this.y*=W,this.z*=W},applyQuaternion:function(W){var ue=this.x,Ae=this.y,Se=this.z,We=W.x,Ye=W.y,ft=W.z,he=W.w,le=he*ue+Ye*Se-ft*Ae,pe=he*Ae+ft*ue-We*Se,be=he*Se+We*Ae-Ye*ue,Ee=-We*ue-Ye*Ae-ft*Se;return this.x=le*he+Ee*-We+pe*-ft-be*-Ye,this.y=pe*he+Ee*-Ye+be*-We-le*-ft,this.z=be*he+Ee*-ft+le*-Ye-pe*-We,this},dot:function(W){return this.x*W.x+this.y*W.y+this.z*W.z},crossVectors:function(W,ue){var Ae=W.x,Se=W.y,We=W.z,Ye=ue.x,ft=ue.y,he=ue.z;return this.x=Se*he-We*ft,this.y=We*Ye-Ae*he,this.z=Ae*ft-Se*Ye,this}};var Ut=function(W,ue,Ae,Se){this.x=W||0,this.y=ue||0,this.z=Ae||0,this.w=Se!==void 0?Se:1};Ut.prototype={constructor:Ut,set:function(W,ue,Ae,Se){return this.x=W,this.y=ue,this.z=Ae,this.w=Se,this},copy:function(W){return this.x=W.x,this.y=W.y,this.z=W.z,this.w=W.w,this},setFromEulerXYZ:function(W,ue,Ae){var Se=Math.cos(W/2),We=Math.cos(ue/2),Ye=Math.cos(Ae/2),ft=Math.sin(W/2),he=Math.sin(ue/2),le=Math.sin(Ae/2);return this.x=ft*We*Ye+Se*he*le,this.y=Se*he*Ye-ft*We*le,this.z=Se*We*le+ft*he*Ye,this.w=Se*We*Ye-ft*he*le,this},setFromEulerYXZ:function(W,ue,Ae){var Se=Math.cos(W/2),We=Math.cos(ue/2),Ye=Math.cos(Ae/2),ft=Math.sin(W/2),he=Math.sin(ue/2),le=Math.sin(Ae/2);return this.x=ft*We*Ye+Se*he*le,this.y=Se*he*Ye-ft*We*le,this.z=Se*We*le-ft*he*Ye,this.w=Se*We*Ye+ft*he*le,this},setFromAxisAngle:function(W,ue){var Ae=ue/2,Se=Math.sin(Ae);return this.x=W.x*Se,this.y=W.y*Se,this.z=W.z*Se,this.w=Math.cos(Ae),this},multiply:function(W){return this.multiplyQuaternions(this,W)},multiplyQuaternions:function(W,ue){var Ae=W.x,Se=W.y,We=W.z,Ye=W.w,ft=ue.x,he=ue.y,le=ue.z,pe=ue.w;return this.x=Ae*pe+Ye*ft+Se*le-We*he,this.y=Se*pe+Ye*he+We*ft-Ae*le,this.z=We*pe+Ye*le+Ae*he-Se*ft,this.w=Ye*pe-Ae*ft-Se*he-We*le,this},inverse:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this.normalize(),this},normalize:function(){var W=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return W===0?(this.x=0,this.y=0,this.z=0,this.w=1):(W=1/W,this.x=this.x*W,this.y=this.y*W,this.z=this.z*W,this.w=this.w*W),this},slerp:function(W,ue){if(ue===0)return this;if(ue===1)return this.copy(W);var Ae=this.x,Se=this.y,We=this.z,Ye=this.w,ft=Ye*W.w+Ae*W.x+Se*W.y+We*W.z;if(ft<0?(this.w=-W.w,this.x=-W.x,this.y=-W.y,this.z=-W.z,ft=-ft):this.copy(W),ft>=1)return this.w=Ye,this.x=Ae,this.y=Se,this.z=We,this;var he=Math.acos(ft),le=Math.sqrt(1-ft*ft);if(Math.abs(le)<.001)return this.w=.5*(Ye+this.w),this.x=.5*(Ae+this.x),this.y=.5*(Se+this.y),this.z=.5*(We+this.z),this;var pe=Math.sin((1-ue)*he)/le,be=Math.sin(ue*he)/le;return this.w=Ye*pe+this.w*be,this.x=Ae*pe+this.x*be,this.y=Se*pe+this.y*be,this.z=We*pe+this.z*be,this},setFromUnitVectors:function(){var W,ue,Ae=1e-6;return function(Se,We){return W===void 0&&(W=new bt),ue=Se.dot(We)+1,ue<Ae?(ue=0,Math.abs(Se.x)>Math.abs(Se.z)?W.set(-Se.y,Se.x,0):W.set(0,-Se.z,Se.y)):W.crossVectors(Se,We),this.x=W.x,this.y=W.y,this.z=W.z,this.w=ue,this.normalize(),this}}()};function pi(W){this.width=W.width||Ge(),this.height=W.height||Xe(),this.widthMeters=W.widthMeters,this.heightMeters=W.heightMeters,this.bevelMeters=W.bevelMeters}var Er=new pi({widthMeters:.11,heightMeters:.062,bevelMeters:.004}),ki=new pi({widthMeters:.1038,heightMeters:.0584,bevelMeters:.004}),An={CardboardV1:new sn({id:"CardboardV1",label:"Cardboard I/O 2014",fov:40,interLensDistance:.06,baselineLensDistance:.035,screenLensDistance:.042,distortionCoefficients:[.441,.156],inverseCoefficients:[-.4410035,.42756155,-.4804439,.5460139,-.58821183,.5733938,-.48303202,.33299083,-.17573841,.0651772,-.01488963,.001559834]}),CardboardV2:new sn({id:"CardboardV2",label:"Cardboard I/O 2015",fov:60,interLensDistance:.064,baselineLensDistance:.035,screenLensDistance:.039,distortionCoefficients:[.34,.55],inverseCoefficients:[-.33836704,-.18162185,.862655,-1.2462051,1.0560602,-.58208317,.21609078,-.05444823,.009177956,-.0009904169,6183535e-11,-16981803e-13]})};function Ur(W,ue){this.viewer=An.CardboardV2,this.updateDeviceParams(W),this.distortion=new je(this.viewer.distortionCoefficients);for(var Ae=0;Ae<ue.length;Ae++){var Se=ue[Ae];An[Se.id]=new sn(Se)}}Ur.prototype.updateDeviceParams=function(W){this.device=this.determineDevice_(W)||this.device},Ur.prototype.getDevice=function(){return this.device},Ur.prototype.setViewer=function(W){this.viewer=W,this.distortion=new je(this.viewer.distortionCoefficients)},Ur.prototype.determineDevice_=function(W){if(!W)return Q()?(console.warn("Using fallback iOS device measurements."),ki):(console.warn("Using fallback Android device measurements."),Er);var ue=.0254,Ae=ue/W.xdpi,Se=ue/W.ydpi,We=Ge(),Ye=Xe();return new pi({widthMeters:Ae*We,heightMeters:Se*Ye,bevelMeters:W.bevelMm*.001})},Ur.prototype.getDistortedFieldOfViewLeftEye=function(){var W=this.viewer,ue=this.device,Ae=this.distortion,Se=W.screenLensDistance,We=(ue.widthMeters-W.interLensDistance)/2,Ye=W.interLensDistance/2,ft=W.baselineLensDistance-ue.bevelMeters,he=ue.heightMeters-ft,le=It*Math.atan(Ae.distort(We/Se)),pe=It*Math.atan(Ae.distort(Ye/Se)),be=It*Math.atan(Ae.distort(ft/Se)),Ee=It*Math.atan(Ae.distort(he/Se));return{leftDegrees:Math.min(le,W.fov),rightDegrees:Math.min(pe,W.fov),downDegrees:Math.min(be,W.fov),upDegrees:Math.min(Ee,W.fov)}},Ur.prototype.getLeftEyeVisibleTanAngles=function(){var W=this.viewer,ue=this.device,Ae=this.distortion,Se=Math.tan(-dt*W.fov),We=Math.tan(dt*W.fov),Ye=Math.tan(dt*W.fov),ft=Math.tan(-dt*W.fov),he=ue.widthMeters/4,le=ue.heightMeters/2,pe=W.baselineLensDistance-ue.bevelMeters-le,be=W.interLensDistance/2-he,Ee=-pe,st=W.screenLensDistance,Ct=Ae.distort((be-he)/st),Ht=Ae.distort((Ee+le)/st),ii=Ae.distort((be+he)/st),Ai=Ae.distort((Ee-le)/st),Wt=new Float32Array(4);return Wt[0]=Math.max(Se,Ct),Wt[1]=Math.min(We,Ht),Wt[2]=Math.min(Ye,ii),Wt[3]=Math.max(ft,Ai),Wt},Ur.prototype.getLeftEyeNoLensTanAngles=function(){var W=this.viewer,ue=this.device,Ae=this.distortion,Se=new Float32Array(4),We=Ae.distortInverse(Math.tan(-dt*W.fov)),Ye=Ae.distortInverse(Math.tan(dt*W.fov)),ft=Ae.distortInverse(Math.tan(dt*W.fov)),he=Ae.distortInverse(Math.tan(-dt*W.fov)),le=ue.widthMeters/4,pe=ue.heightMeters/2,be=W.baselineLensDistance-ue.bevelMeters-pe,Ee=W.interLensDistance/2-le,st=-be,Ct=W.screenLensDistance,Ht=(Ee-le)/Ct,ii=(st+pe)/Ct,Ai=(Ee+le)/Ct,Wt=(st-pe)/Ct;return Se[0]=Math.max(We,Ht),Se[1]=Math.min(Ye,ii),Se[2]=Math.min(ft,Ai),Se[3]=Math.max(he,Wt),Se},Ur.prototype.getLeftEyeVisibleScreenRect=function(W){var ue=this.viewer,Ae=this.device,Se=ue.screenLensDistance,We=(Ae.widthMeters-ue.interLensDistance)/2,Ye=ue.baselineLensDistance-Ae.bevelMeters,ft=(W[0]*Se+We)/Ae.widthMeters,he=(W[1]*Se+Ye)/Ae.heightMeters,le=(W[2]*Se+We)/Ae.widthMeters,pe=(W[3]*Se+Ye)/Ae.heightMeters;return{x:ft,y:pe,width:le-ft,height:he-pe}},Ur.prototype.getFieldOfViewLeftEye=function(W){return W?this.getUndistortedFieldOfViewLeftEye():this.getDistortedFieldOfViewLeftEye()},Ur.prototype.getFieldOfViewRightEye=function(W){var ue=this.getFieldOfViewLeftEye(W);return{leftDegrees:ue.rightDegrees,rightDegrees:ue.leftDegrees,upDegrees:ue.upDegrees,downDegrees:ue.downDegrees}},Ur.prototype.getUndistortedFieldOfViewLeftEye=function(){var W=this.getUndistortedParams_();return{leftDegrees:It*Math.atan(W.outerDist),rightDegrees:It*Math.atan(W.innerDist),downDegrees:It*Math.atan(W.bottomDist),upDegrees:It*Math.atan(W.topDist)}},Ur.prototype.getUndistortedViewportLeftEye=function(){var W=this.getUndistortedParams_(),ue=this.viewer,Ae=this.device,Se=ue.screenLensDistance,We=Ae.widthMeters/Se,Ye=Ae.heightMeters/Se,ft=Ae.width/We,he=Ae.height/Ye,le=Math.round((W.eyePosX-W.outerDist)*ft),pe=Math.round((W.eyePosY-W.bottomDist)*he);return{x:le,y:pe,width:Math.round((W.eyePosX+W.innerDist)*ft)-le,height:Math.round((W.eyePosY+W.topDist)*he)-pe}},Ur.prototype.getUndistortedParams_=function(){var W=this.viewer,ue=this.device,Ae=this.distortion,Se=W.screenLensDistance,We=W.interLensDistance/2/Se,Ye=ue.widthMeters/Se,ft=ue.heightMeters/Se,he=Ye/2-We,le=(W.baselineLensDistance-ue.bevelMeters)/Se,pe=W.fov,be=Ae.distortInverse(Math.tan(dt*pe)),Ee=Math.min(he,be),st=Math.min(We,be),Ct=Math.min(le,be),Ht=Math.min(ft-le,be);return{outerDist:Ee,innerDist:st,topDist:Ht,bottomDist:Ct,eyePosX:he,eyePosY:le}};function sn(W){this.id=W.id,this.label=W.label,this.fov=W.fov,this.interLensDistance=W.interLensDistance,this.baselineLensDistance=W.baselineLensDistance,this.screenLensDistance=W.screenLensDistance,this.distortionCoefficients=W.distortionCoefficients,this.inverseCoefficients=W.inverseCoefficients}Ur.Viewers=An;var xs=1,yn="2019-11-09T17:36:14Z",Ls=[{type:"android",rules:[{mdmh:"asus/*/Nexus 7/*"},{ua:"Nexus 7"}],dpi:[320.8,323],bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X00PD/*"},{ua:"ASUS_X00PD"}],dpi:245,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X008D/*"},{ua:"ASUS_X008D"}],dpi:282,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_Z00AD/*"},{ua:"ASUS_Z00AD"}],dpi:[403,404.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2 XL/*"},{ua:"Pixel 2 XL"}],dpi:537.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3 XL/*"},{ua:"Pixel 3 XL"}],dpi:[558.5,553.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel XL/*"},{ua:"Pixel XL"}],dpi:[537.9,533],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3/*"},{ua:"Pixel 3"}],dpi:442.4,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2/*"},{ua:"Pixel 2"}],dpi:441,bw:3,ac:500},{type:"android",rules:[{mdmh:"Google/*/Pixel/*"},{ua:"Pixel"}],dpi:[432.6,436.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC6435LVW/*"},{ua:"HTC6435LVW"}],dpi:[449.7,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC One XL/*"},{ua:"HTC One XL"}],dpi:[315.3,314.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"htc/*/Nexus 9/*"},{ua:"Nexus 9"}],dpi:289,bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One M9/*"},{ua:"HTC One M9"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One_M8/*"},{ua:"HTC One_M8"}],dpi:[449.7,447.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One/*"},{ua:"HTC One"}],dpi:472.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/Nexus 6P/*"},{ua:"Nexus 6P"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/BLN-L24/*"},{ua:"HONORBLN-L24"}],dpi:480,bw:4,ac:500},{type:"android",rules:[{mdmh:"Huawei/*/BKL-L09/*"},{ua:"BKL-L09"}],dpi:403,bw:3.47,ac:500},{type:"android",rules:[{mdmh:"LENOVO/*/Lenovo PB2-690Y/*"},{ua:"Lenovo PB2-690Y"}],dpi:[457.2,454.713],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5X/*"},{ua:"Nexus 5X"}],dpi:[422,419.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS345/*"},{ua:"LGMS345"}],dpi:[221.7,219.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D800/*"},{ua:"LG-D800"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D850/*"},{ua:"LG-D850"}],dpi:[537.9,541.9],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/VS985 4G/*"},{ua:"VS985 4G"}],dpi:[537.9,535.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5/*"},{ua:"Nexus 5 B"}],dpi:[442.4,444.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 4/*"},{ua:"Nexus 4"}],dpi:[319.8,318.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LG-P769/*"},{ua:"LG-P769"}],dpi:[240.6,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS323/*"},{ua:"LGMS323"}],dpi:[206.6,204.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGLS996/*"},{ua:"LGLS996"}],dpi:[403.4,401.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/4560MMX/*"},{ua:"4560MMX"}],dpi:[240,219.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/A250/*"},{ua:"Micromax A250"}],dpi:[480,446.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/Micromax AQ4501/*"},{ua:"Micromax AQ4501"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/G5/*"},{ua:"Moto G (5) Plus"}],dpi:[403.4,403],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/DROID RAZR/*"},{ua:"DROID RAZR"}],dpi:[368.1,256.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT830C/*"},{ua:"XT830C"}],dpi:[254,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1021/*"},{ua:"XT1021"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1023/*"},{ua:"XT1023"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1028/*"},{ua:"XT1028"}],dpi:[326.6,327.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1034/*"},{ua:"XT1034"}],dpi:[326.6,328.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1053/*"},{ua:"XT1053"}],dpi:[315.3,316.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1562/*"},{ua:"XT1562"}],dpi:[403.4,402.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/Nexus 6/*"},{ua:"Nexus 6 B"}],dpi:[494.3,489.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1063/*"},{ua:"XT1063"}],dpi:[295,296.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1064/*"},{ua:"XT1064"}],dpi:[295,295.6],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1092/*"},{ua:"XT1092"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1095/*"},{ua:"XT1095"}],dpi:[422,423.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/G4/*"},{ua:"Moto G (4)"}],dpi:401,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/A0001/*"},{ua:"A0001"}],dpi:[403.4,401],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1001/*"},{ua:"ONE E1001"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1003/*"},{ua:"ONE E1003"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1005/*"},{ua:"ONE E1005"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2001/*"},{ua:"ONE A2001"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2003/*"},{ua:"ONE A2003"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2005/*"},{ua:"ONE A2005"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3000/*"},{ua:"ONEPLUS A3000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3003/*"},{ua:"ONEPLUS A3003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3010/*"},{ua:"ONEPLUS A3010"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A5000/*"},{ua:"ONEPLUS A5000 "}],dpi:[403.411,399.737],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A5010/*"},{ua:"ONEPLUS A5010"}],dpi:[403,400],bw:2,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6000/*"},{ua:"ONEPLUS A6000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6003/*"},{ua:"ONEPLUS A6003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6010/*"},{ua:"ONEPLUS A6010"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6013/*"},{ua:"ONEPLUS A6013"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OPPO/*/X909/*"},{ua:"X909"}],dpi:[442.4,444.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9082/*"},{ua:"GT-I9082"}],dpi:[184.7,185.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G360P/*"},{ua:"SM-G360P"}],dpi:[196.7,205.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Nexus S/*"},{ua:"Nexus S"}],dpi:[234.5,229.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[304.8,303.9],bw:5,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-T230NU/*"},{ua:"SM-T230NU"}],dpi:216,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SGH-T399/*"},{ua:"SGH-T399"}],dpi:[217.7,231.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SGH-M919/*"},{ua:"SGH-M919"}],dpi:[440.8,437.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N9005/*"},{ua:"SM-N9005"}],dpi:[386.4,387],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SM-N900A/*"},{ua:"SAMSUNG-SM-N900A"}],dpi:[386.4,387.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9500/*"},{ua:"GT-I9500"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/GT-I9505/*"},{ua:"GT-I9505"}],dpi:439.4,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900F/*"},{ua:"SM-G900F"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900M/*"},{ua:"SM-G900M"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G800F/*"},{ua:"SM-G800F"}],dpi:326.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G906S/*"},{ua:"SM-G906S"}],dpi:[562.7,572.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[306.7,304.8],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-T535/*"},{ua:"SM-T535"}],dpi:[142.6,136.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-N920C/*"},{ua:"SM-N920C"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920P/*"},{ua:"SM-N920P"}],dpi:[386.3655,390.144],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920W8/*"},{ua:"SM-N920W8"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300I/*"},{ua:"GT-I9300I"}],dpi:[304.8,305.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9195/*"},{ua:"GT-I9195"}],dpi:[249.4,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SPH-L520/*"},{ua:"SPH-L520"}],dpi:[249.4,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SGH-I717/*"},{ua:"SAMSUNG-SGH-I717"}],dpi:285.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SPH-D710/*"},{ua:"SPH-D710"}],dpi:[217.7,204.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-N7100/*"},{ua:"GT-N7100"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SCH-I605/*"},{ua:"SCH-I605"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Galaxy Nexus/*"},{ua:"Galaxy Nexus"}],dpi:[315.3,314.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910H/*"},{ua:"SM-N910H"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910C/*"},{ua:"SM-N910C"}],dpi:[515.2,520.2],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G130M/*"},{ua:"SM-G130M"}],dpi:[165.9,164.8],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G928I/*"},{ua:"SM-G928I"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G920F/*"},{ua:"SM-G920F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G920P/*"},{ua:"SM-G920P"}],dpi:[522.5,577],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G925F/*"},{ua:"SM-G925F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G925V/*"},{ua:"SM-G925V"}],dpi:[522.5,576.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G930F/*"},{ua:"SM-G930F"}],dpi:576.6,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G935F/*"},{ua:"SM-G935F"}],dpi:533,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G950F/*"},{ua:"SM-G950F"}],dpi:[562.707,565.293],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955U/*"},{ua:"SM-G955U"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955F/*"},{ua:"SM-G955F"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G960F/*"},{ua:"SM-G960F"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9600/*"},{ua:"SM-G9600"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960T/*"},{ua:"SM-G960T"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960N/*"},{ua:"SM-G960N"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960U/*"},{ua:"SM-G960U"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9608/*"},{ua:"SM-G9608"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960FD/*"},{ua:"SM-G960FD"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960W/*"},{ua:"SM-G960W"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G965F/*"},{ua:"SM-G965F"}],dpi:529,bw:2,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/C6903/*"},{ua:"C6903"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/D6653/*"},{ua:"D6653"}],dpi:[428.6,427.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6653/*"},{ua:"E6653"}],dpi:[428.6,425.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6853/*"},{ua:"E6853"}],dpi:[403.4,401.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/SGP321/*"},{ua:"SGP321"}],dpi:[224.7,224.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"TCT/*/ALCATEL ONE TOUCH Fierce/*"},{ua:"ALCATEL ONE TOUCH Fierce"}],dpi:[240,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"THL/*/thl 5000/*"},{ua:"thl 5000"}],dpi:[480,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Fly/*/IQ4412/*"},{ua:"IQ4412"}],dpi:307.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"ZTE/*/ZTE Blade L2/*"},{ua:"ZTE Blade L2"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"BENEVE/*/VR518/*"},{ua:"VR518"}],dpi:480,bw:3,ac:500},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,328.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[640,1136]}],dpi:[317.1,320.2],bw:3,ac:1e3},{type:"ios",rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1e3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2001]}],dpi:[410.9,415.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2436]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/EML-L29/*"},{ua:"EML-L29"}],dpi:428,bw:3.45,ac:500},{type:"android",rules:[{mdmh:"Nokia/*/Nokia 7.1/*"},{ua:"Nokia 7.1"}],dpi:[432,431.9],bw:3,ac:500},{type:"ios",rules:[{res:[1242,2688]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G570M/*"},{ua:"SM-G570M"}],dpi:320,bw:3.684,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G970F/*"},{ua:"SM-G970F"}],dpi:438,bw:2.281,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G973F/*"},{ua:"SM-G973F"}],dpi:550,bw:2.002,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G975F/*"},{ua:"SM-G975F"}],dpi:522,bw:2.054,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G977F/*"},{ua:"SM-G977F"}],dpi:505,bw:2.334,ac:500},{type:"ios",rules:[{res:[828,1792]}],dpi:326,bw:5,ac:500}],rs={format:xs,last_updated:yn,devices:Ls};function bs(W,ue){if(this.dpdb=rs,this.recalculateDeviceParams_(),W){this.onDeviceParamsUpdated=ue;var Ae=new XMLHttpRequest,Se=this;Ae.open("GET",W,!0),Ae.addEventListener("load",function(){Se.loading=!1,Ae.status>=200&&Ae.status<=299?(Se.dpdb=JSON.parse(Ae.response),Se.recalculateDeviceParams_()):console.error("Error loading online DPDB!")}),Ae.send()}}bs.prototype.getDeviceParams=function(){return this.deviceParams},bs.prototype.recalculateDeviceParams_=function(){var W=this.calcDeviceParams_();W?(this.deviceParams=W,this.onDeviceParamsUpdated&&this.onDeviceParamsUpdated(this.deviceParams)):console.error("Failed to recalculate device parameters.")},bs.prototype.calcDeviceParams_=function(){var W=this.dpdb;if(!W)return console.error("DPDB not available."),null;if(W.format!=1)return console.error("DPDB has unexpected format version."),null;if(!W.devices||!W.devices.length)return console.error("DPDB does not have a devices section."),null;var ue=navigator.userAgent||navigator.vendor||window.opera,Ae=Ge(),Se=Xe();if(!W.devices)return console.error("DPDB has no devices section."),null;for(var We=0;We<W.devices.length;We++){var Ye=W.devices[We];if(!Ye.rules){console.warn("Device["+We+"] has no rules section.");continue}if(Ye.type!="ios"&&Ye.type!="android"){console.warn("Device["+We+"] has invalid type.");continue}if(Q()==(Ye.type=="ios")){for(var ft=!1,he=0;he<Ye.rules.length;he++){var le=Ye.rules[he];if(this.ruleMatches_(le,ue,Ae,Se)){ft=!0;break}}if(ft){var pe=Ye.dpi[0]||Ye.dpi,be=Ye.dpi[1]||Ye.dpi;return new me({xdpi:pe,ydpi:be,bevelMm:Ye.bw})}}}return console.warn("No DPDB device match."),null},bs.prototype.ruleMatches_=function(W,ue,Ae,Se){if(!W.ua&&!W.res||(W.ua&&W.ua.substring(0,2)==="SM"&&(W.ua=W.ua.substring(0,7)),W.ua&&ue.indexOf(W.ua)<0))return!1;if(W.res){if(!W.res[0]||!W.res[1])return!1;var We=W.res[0],Ye=W.res[1];if(Math.min(Ae,Se)!=Math.min(We,Ye)||Math.max(Ae,Se)!=Math.max(We,Ye))return!1}return!0};function me(W){this.xdpi=W.xdpi,this.ydpi=W.ydpi,this.bevelMm=W.bevelMm}function ct(W,ue){this.set(W,ue)}ct.prototype.set=function(W,ue){this.sample=W,this.timestampS=ue},ct.prototype.copy=function(W){this.set(W.sample,W.timestampS)};function St(W,ue){this.kFilter=W,this.isDebug=ue,this.currentAccelMeasurement=new ct,this.currentGyroMeasurement=new ct,this.previousGyroMeasurement=new ct,Q()?this.filterQ=new Ut(-1,0,0,1):this.filterQ=new Ut(1,0,0,1),this.previousFilterQ=new Ut,this.previousFilterQ.copy(this.filterQ),this.accelQ=new Ut,this.isOrientationInitialized=!1,this.estimatedGravity=new bt,this.measuredGravity=new bt,this.gyroIntegralQ=new Ut}St.prototype.addAccelMeasurement=function(W,ue){this.currentAccelMeasurement.set(W,ue)},St.prototype.addGyroMeasurement=function(W,ue){this.currentGyroMeasurement.set(W,ue);var Ae=ue-this.previousGyroMeasurement.timestampS;Ie(Ae)&&this.run_(),this.previousGyroMeasurement.copy(this.currentGyroMeasurement)},St.prototype.run_=function(){if(!this.isOrientationInitialized){this.accelQ=this.accelToQuaternion_(this.currentAccelMeasurement.sample),this.previousFilterQ.copy(this.accelQ),this.isOrientationInitialized=!0;return}var W=this.currentGyroMeasurement.timestampS-this.previousGyroMeasurement.timestampS,ue=this.gyroToQuaternionDelta_(this.currentGyroMeasurement.sample,W);this.gyroIntegralQ.multiply(ue),this.filterQ.copy(this.previousFilterQ),this.filterQ.multiply(ue);var Ae=new Ut;Ae.copy(this.filterQ),Ae.inverse(),this.estimatedGravity.set(0,0,-1),this.estimatedGravity.applyQuaternion(Ae),this.estimatedGravity.normalize(),this.measuredGravity.copy(this.currentAccelMeasurement.sample),this.measuredGravity.normalize();var Se=new Ut;Se.setFromUnitVectors(this.estimatedGravity,this.measuredGravity),Se.inverse(),this.isDebug&&console.log("Delta: %d deg, G_est: (%s, %s, %s), G_meas: (%s, %s, %s)",It*Gi(Se),this.estimatedGravity.x.toFixed(1),this.estimatedGravity.y.toFixed(1),this.estimatedGravity.z.toFixed(1),this.measuredGravity.x.toFixed(1),this.measuredGravity.y.toFixed(1),this.measuredGravity.z.toFixed(1));var We=new Ut;We.copy(this.filterQ),We.multiply(Se),this.filterQ.slerp(We,1-this.kFilter),this.previousFilterQ.copy(this.filterQ)},St.prototype.getOrientation=function(){return this.filterQ},St.prototype.accelToQuaternion_=function(W){var ue=new bt;ue.copy(W),ue.normalize();var Ae=new Ut;return Ae.setFromUnitVectors(new bt(0,0,-1),ue),Ae.inverse(),Ae},St.prototype.gyroToQuaternionDelta_=function(W,ue){var Ae=new Ut,Se=new bt;return Se.copy(W),Se.normalize(),Ae.setFromAxisAngle(Se,W.length()*ue),Ae};function Xt(W,ue){this.predictionTimeS=W,this.isDebug=ue,this.previousQ=new Ut,this.previousTimestampS=null,this.deltaQ=new Ut,this.outQ=new Ut}Xt.prototype.getPrediction=function(W,ue,Ae){if(!this.previousTimestampS)return this.previousQ.copy(W),this.previousTimestampS=Ae,W;var Se=new bt;Se.copy(ue),Se.normalize();var We=ue.length();if(We<dt*20)return this.isDebug&&console.log("Moving slowly, at %s deg/s: no prediction",(It*We).toFixed(1)),this.outQ.copy(W),this.previousQ.copy(W),this.outQ;var Ye=We*this.predictionTimeS;return this.deltaQ.setFromAxisAngle(Se,Ye),this.outQ.copy(this.previousQ),this.outQ.multiply(this.deltaQ),this.previousQ.copy(W),this.previousTimestampS=Ae,this.outQ};function Bi(W,ue,Ae,Se){this.yawOnly=Ae,this.accelerometer=new bt,this.gyroscope=new bt,this.filter=new St(W,Se),this.posePredictor=new Xt(ue,Se),this.isFirefoxAndroid=ne(),this.isIOS=Q();var We=Y();this.isDeviceMotionInRadians=!this.isIOS&&We&&We<66,this.isWithoutDeviceMotion=xe()||ae(),this.filterToWorldQ=new Ut,Q()?this.filterToWorldQ.setFromAxisAngle(new bt(1,0,0),Math.PI/2):this.filterToWorldQ.setFromAxisAngle(new bt(1,0,0),-Math.PI/2),this.inverseWorldToScreenQ=new Ut,this.worldToScreenQ=new Ut,this.originalPoseAdjustQ=new Ut,this.originalPoseAdjustQ.setFromAxisAngle(new bt(0,0,1),-window.orientation*Math.PI/180),this.setScreenTransform_(),de()&&this.filterToWorldQ.multiply(this.inverseWorldToScreenQ),this.resetQ=new Ut,this.orientationOut_=new Float32Array(4),this.start()}Bi.prototype.getPosition=function(){return null},Bi.prototype.getOrientation=function(){var W=void 0;if(this.isWithoutDeviceMotion&&this._deviceOrientationQ){this.deviceOrientationFixQ=this.deviceOrientationFixQ||function(){var We=new Ut().setFromAxisAngle(new bt(0,0,-1),0),Ye=new Ut;return window.orientation===-90?Ye.setFromAxisAngle(new bt(0,1,0),Math.PI/-2):Ye.setFromAxisAngle(new bt(0,1,0),Math.PI/2),We.multiply(Ye)}(),this.deviceOrientationFilterToWorldQ=this.deviceOrientationFilterToWorldQ||function(){var We=new Ut;return We.setFromAxisAngle(new bt(1,0,0),-Math.PI/2),We}(),W=this._deviceOrientationQ;var Ae=new Ut;return Ae.copy(W),Ae.multiply(this.deviceOrientationFilterToWorldQ),Ae.multiply(this.resetQ),Ae.multiply(this.worldToScreenQ),Ae.multiplyQuaternions(this.deviceOrientationFixQ,Ae),this.yawOnly&&(Ae.x=0,Ae.z=0,Ae.normalize()),this.orientationOut_[0]=Ae.x,this.orientationOut_[1]=Ae.y,this.orientationOut_[2]=Ae.z,this.orientationOut_[3]=Ae.w,this.orientationOut_}else{var ue=this.filter.getOrientation();W=this.posePredictor.getPrediction(ue,this.gyroscope,this.previousTimestampS)}var Ae=new Ut;return Ae.copy(this.filterToWorldQ),Ae.multiply(this.resetQ),Ae.multiply(W),Ae.multiply(this.worldToScreenQ),this.yawOnly&&(Ae.x=0,Ae.z=0,Ae.normalize()),this.orientationOut_[0]=Ae.x,this.orientationOut_[1]=Ae.y,this.orientationOut_[2]=Ae.z,this.orientationOut_[3]=Ae.w,this.orientationOut_},Bi.prototype.resetPose=function(){this.resetQ.copy(this.filter.getOrientation()),this.resetQ.x=0,this.resetQ.y=0,this.resetQ.z*=-1,this.resetQ.normalize(),de()&&this.resetQ.multiply(this.inverseWorldToScreenQ),this.resetQ.multiply(this.originalPoseAdjustQ)},Bi.prototype.onDeviceOrientation_=function(W){this._deviceOrientationQ=this._deviceOrientationQ||new Ut;var ue=W.alpha,Ae=W.beta,Se=W.gamma;ue=(ue||0)*Math.PI/180,Ae=(Ae||0)*Math.PI/180,Se=(Se||0)*Math.PI/180,this._deviceOrientationQ.setFromEulerYXZ(Ae,ue,-Se)},Bi.prototype.onDeviceMotion_=function(W){this.updateDeviceMotion_(W)},Bi.prototype.updateDeviceMotion_=function(W){var ue=W.accelerationIncludingGravity,Ae=W.rotationRate,Se=W.timeStamp/1e3,We=Se-this.previousTimestampS;if(We<0){Qe("fusion-pose-sensor:invalid:non-monotonic","Invalid timestamps detected: non-monotonic timestamp from devicemotion"),this.previousTimestampS=Se;return}else if(We<=Z||We>G){Qe("fusion-pose-sensor:invalid:outside-threshold","Invalid timestamps detected: Timestamp from devicemotion outside expected range."),this.previousTimestampS=Se;return}this.accelerometer.set(-ue.x,-ue.y,-ue.z),Ae&&(fe()?this.gyroscope.set(-Ae.beta,Ae.alpha,Ae.gamma):this.gyroscope.set(Ae.alpha,Ae.beta,Ae.gamma),this.isDeviceMotionInRadians||this.gyroscope.multiplyScalar(Math.PI/180),this.filter.addGyroMeasurement(this.gyroscope,Se)),this.filter.addAccelMeasurement(this.accelerometer,Se),this.previousTimestampS=Se},Bi.prototype.onOrientationChange_=function(W){this.setScreenTransform_()},Bi.prototype.onMessage_=function(W){var ue=W.data;if(!(!ue||!ue.type)){var Ae=ue.type.toLowerCase();Ae==="devicemotion"&&this.updateDeviceMotion_(ue.deviceMotionEvent)}},Bi.prototype.setScreenTransform_=function(){switch(this.worldToScreenQ.set(0,0,0,1),window.orientation){case 0:break;case 90:this.worldToScreenQ.setFromAxisAngle(new bt(0,0,1),-Math.PI/2);break;case-90:this.worldToScreenQ.setFromAxisAngle(new bt(0,0,1),Math.PI/2);break}this.inverseWorldToScreenQ.copy(this.worldToScreenQ),this.inverseWorldToScreenQ.inverse()},Bi.prototype.start=function(){this.onDeviceMotionCallback_=this.onDeviceMotion_.bind(this),this.onOrientationChangeCallback_=this.onOrientationChange_.bind(this),this.onMessageCallback_=this.onMessage_.bind(this),this.onDeviceOrientationCallback_=this.onDeviceOrientation_.bind(this),Q()&&Ti()&&window.addEventListener("message",this.onMessageCallback_),window.addEventListener("orientationchange",this.onOrientationChangeCallback_),this.isWithoutDeviceMotion?window.addEventListener("deviceorientation",this.onDeviceOrientationCallback_):window.addEventListener("devicemotion",this.onDeviceMotionCallback_)},Bi.prototype.stop=function(){window.removeEventListener("devicemotion",this.onDeviceMotionCallback_),window.removeEventListener("deviceorientation",this.onDeviceOrientationCallback_),window.removeEventListener("orientationchange",this.onOrientationChangeCallback_),window.removeEventListener("message",this.onMessageCallback_)};var ar=60,Li=new bt(1,0,0),Pi=new bt(0,0,1),Be=new Ut;Be.setFromAxisAngle(Li,-Math.PI/2),Be.multiply(new Ut().setFromAxisAngle(Pi,Math.PI/2));var se=function(){function W(ue){L(this,W),this.config=ue,this.sensor=null,this.fusionSensor=null,this._out=new Float32Array(4),this.api=null,this.errors=[],this._sensorQ=new Ut,this._outQ=new Ut,this._onSensorRead=this._onSensorRead.bind(this),this._onSensorError=this._onSensorError.bind(this),this.init()}return O(W,[{key:"init",value:function(){var ue=null;try{ue=new RelativeOrientationSensor({frequency:ar,referenceFrame:"screen"}),ue.addEventListener("error",this._onSensorError)}catch(Ae){this.errors.push(Ae),Ae.name==="SecurityError"?(console.error("Cannot construct sensors due to the Feature Policy"),console.warn('Attempting to fall back using "devicemotion"; however this will fail in the future without correct permissions.'),this.useDeviceMotion()):Ae.name==="ReferenceError"?this.useDeviceMotion():console.error(Ae)}ue&&(this.api="sensor",this.sensor=ue,this.sensor.addEventListener("reading",this._onSensorRead),this.sensor.start())}},{key:"useDeviceMotion",value:function(){this.api="devicemotion",this.fusionSensor=new Bi(this.config.K_FILTER,this.config.PREDICTION_TIME_S,this.config.YAW_ONLY,this.config.DEBUG),this.sensor&&(this.sensor.removeEventListener("reading",this._onSensorRead),this.sensor.removeEventListener("error",this._onSensorError),this.sensor=null)}},{key:"getOrientation",value:function(){if(this.fusionSensor)return this.fusionSensor.getOrientation();if(!this.sensor||!this.sensor.quaternion)return this._out[0]=this._out[1]=this._out[2]=0,this._out[3]=1,this._out;var ue=this.sensor.quaternion;this._sensorQ.set(ue[0],ue[1],ue[2],ue[3]);var Ae=this._outQ;return Ae.copy(Be),Ae.multiply(this._sensorQ),this.config.YAW_ONLY&&(Ae.x=Ae.z=0,Ae.normalize()),this._out[0]=Ae.x,this._out[1]=Ae.y,this._out[2]=Ae.z,this._out[3]=Ae.w,this._out}},{key:"_onSensorError",value:function(ue){this.errors.push(ue.error),ue.error.name==="NotAllowedError"?console.error("Permission to access sensor was denied"):ue.error.name==="NotReadableError"?console.error("Sensor could not be read"):console.error(ue.error),this.useDeviceMotion()}},{key:"_onSensorRead",value:function(){}}]),W}(),ge="<svg width='198' height='240' viewBox='0 0 198 240' xmlns='http://www.w3.org/2000/svg'><g fill='none' fill-rule='evenodd'><path d='M149.625 109.527l6.737 3.891v.886c0 .177.013.36.038.549.01.081.02.162.027.242.14 1.415.974 2.998 2.105 3.999l5.72 5.062.081-.09s4.382-2.53 5.235-3.024l25.97 14.993v54.001c0 .771-.386 1.217-.948 1.217-.233 0-.495-.076-.772-.236l-23.967-13.838-.014.024-27.322 15.775-.85-1.323c-4.731-1.529-9.748-2.74-14.951-3.61a.27.27 0 0 0-.007.024l-5.067 16.961-7.891 4.556-.037-.063v27.59c0 .772-.386 1.217-.948 1.217-.232 0-.495-.076-.772-.236l-42.473-24.522c-.95-.549-1.72-1.877-1.72-2.967v-1.035l-.021.047a5.111 5.111 0 0 0-1.816-.399 5.682 5.682 0 0 0-.546.001 13.724 13.724 0 0 1-1.918-.041c-1.655-.153-3.2-.6-4.404-1.296l-46.576-26.89.005.012-10.278-18.75c-1.001-1.827-.241-4.216 1.698-5.336l56.011-32.345a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.659 3.227 1.853l.005-.003.227.413-.006.004a9.63 9.63 0 0 0 1.477 2.018l.277.27c1.914 1.85 4.468 2.801 7.113 2.801 1.949 0 3.948-.517 5.775-1.572.013 0 7.319-4.219 7.319-4.219a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.658 3.226 1.853l3.25 5.928.022-.018 6.785 3.917-.105-.182 46.881-26.965m0-1.635c-.282 0-.563.073-.815.218l-46.169 26.556-5.41-3.124-3.005-5.481c-.913-1.667-2.699-2.702-4.66-2.703-1.011 0-2.02.274-2.917.792a3825 3825 0 0 1-7.275 4.195l-.044.024a9.937 9.937 0 0 1-4.957 1.353c-2.292 0-4.414-.832-5.976-2.342l-.252-.245a7.992 7.992 0 0 1-1.139-1.534 1.379 1.379 0 0 0-.06-.122l-.227-.414a1.718 1.718 0 0 0-.095-.154c-.938-1.574-2.673-2.545-4.571-2.545-1.011 0-2.02.274-2.917.792L3.125 155.502c-2.699 1.559-3.738 4.94-2.314 7.538l10.278 18.75c.177.323.448.563.761.704l46.426 26.804c1.403.81 3.157 1.332 5.072 1.508a15.661 15.661 0 0 0 2.146.046 4.766 4.766 0 0 1 .396 0c.096.004.19.011.283.022.109 1.593 1.159 3.323 2.529 4.114l42.472 24.522c.524.302 1.058.455 1.59.455 1.497 0 2.583-1.2 2.583-2.852v-26.562l7.111-4.105a1.64 1.64 0 0 0 .749-.948l4.658-15.593c4.414.797 8.692 1.848 12.742 3.128l.533.829a1.634 1.634 0 0 0 2.193.531l26.532-15.317L193 192.433c.523.302 1.058.455 1.59.455 1.497 0 2.583-1.199 2.583-2.852v-54.001c0-.584-.312-1.124-.818-1.416l-25.97-14.993a1.633 1.633 0 0 0-1.636.001c-.606.351-2.993 1.73-4.325 2.498l-4.809-4.255c-.819-.725-1.461-1.933-1.561-2.936a7.776 7.776 0 0 0-.033-.294 2.487 2.487 0 0 1-.023-.336v-.886c0-.584-.312-1.123-.817-1.416l-6.739-3.891a1.633 1.633 0 0 0-.817-.219' fill='#455A64'/><path d='M96.027 132.636l46.576 26.891c1.204.695 1.979 1.587 2.242 2.541l-.01.007-81.374 46.982h-.001c-1.654-.152-3.199-.6-4.403-1.295l-46.576-26.891 83.546-48.235' fill='#FAFAFA'/><path d='M63.461 209.174c-.008 0-.015 0-.022-.002-1.693-.156-3.228-.609-4.441-1.309l-46.576-26.89a.118.118 0 0 1 0-.203l83.546-48.235a.117.117 0 0 1 .117 0l46.576 26.891c1.227.708 2.021 1.612 2.296 2.611a.116.116 0 0 1-.042.124l-.021.016-81.375 46.981a.11.11 0 0 1-.058.016zm-50.747-28.303l46.401 26.79c1.178.68 2.671 1.121 4.32 1.276l81.272-46.922c-.279-.907-1.025-1.73-2.163-2.387l-46.517-26.857-83.313 48.1z' fill='#607D8B'/><path d='M148.327 165.471a5.85 5.85 0 0 1-.546.001c-1.894-.083-3.302-1.038-3.145-2.132a2.693 2.693 0 0 0-.072-1.105l-81.103 46.822c.628.058 1.272.073 1.918.042.182-.009.364-.009.546-.001 1.894.083 3.302 1.038 3.145 2.132l79.257-45.759' fill='#FFF'/><path d='M69.07 211.347a.118.118 0 0 1-.115-.134c.045-.317-.057-.637-.297-.925-.505-.61-1.555-1.022-2.738-1.074a5.966 5.966 0 0 0-.535.001 14.03 14.03 0 0 1-1.935-.041.117.117 0 0 1-.103-.092.116.116 0 0 1 .055-.126l81.104-46.822a.117.117 0 0 1 .171.07c.104.381.129.768.074 1.153-.045.316.057.637.296.925.506.61 1.555 1.021 2.739 1.073.178.008.357.008.535-.001a.117.117 0 0 1 .064.218l-79.256 45.759a.114.114 0 0 1-.059.016zm-3.405-2.372c.089 0 .177.002.265.006 1.266.056 2.353.488 2.908 1.158.227.274.35.575.36.882l78.685-45.429c-.036 0-.072-.001-.107-.003-1.267-.056-2.354-.489-2.909-1.158-.282-.34-.402-.724-.347-1.107a2.604 2.604 0 0 0-.032-.91L63.846 208.97a13.91 13.91 0 0 0 1.528.012c.097-.005.194-.007.291-.007z' fill='#607D8B'/><path d='M2.208 162.134c-1.001-1.827-.241-4.217 1.698-5.337l56.011-32.344c1.939-1.12 4.324-.546 5.326 1.281l.232.41a9.344 9.344 0 0 0 1.47 2.021l.278.27c3.325 3.214 8.583 3.716 12.888 1.23l7.319-4.22c1.94-1.119 4.324-.546 5.325 1.282l3.25 5.928-83.519 48.229-10.278-18.75z' fill='#FAFAFA'/><path d='M12.486 181.001a.112.112 0 0 1-.031-.005.114.114 0 0 1-.071-.056L2.106 162.19c-1.031-1.88-.249-4.345 1.742-5.494l56.01-32.344a4.328 4.328 0 0 1 2.158-.588c1.415 0 2.65.702 3.311 1.882.01.008.018.017.024.028l.227.414a.122.122 0 0 1 .013.038 9.508 9.508 0 0 0 1.439 1.959l.275.266c1.846 1.786 4.344 2.769 7.031 2.769 1.977 0 3.954-.538 5.717-1.557a.148.148 0 0 1 .035-.013l7.284-4.206a4.321 4.321 0 0 1 2.157-.588c1.427 0 2.672.716 3.329 1.914l3.249 5.929a.116.116 0 0 1-.044.157l-83.518 48.229a.116.116 0 0 1-.059.016zm49.53-57.004c-.704 0-1.41.193-2.041.557l-56.01 32.345c-1.882 1.086-2.624 3.409-1.655 5.179l10.221 18.645 83.317-48.112-3.195-5.829c-.615-1.122-1.783-1.792-3.124-1.792a4.08 4.08 0 0 0-2.04.557l-7.317 4.225a.148.148 0 0 1-.035.013 11.7 11.7 0 0 1-5.801 1.569c-2.748 0-5.303-1.007-7.194-2.835l-.278-.27a9.716 9.716 0 0 1-1.497-2.046.096.096 0 0 1-.013-.037l-.191-.347a.11.11 0 0 1-.023-.029c-.615-1.123-1.783-1.793-3.124-1.793z' fill='#607D8B'/><path d='M42.434 155.808c-2.51-.001-4.697-1.258-5.852-3.365-1.811-3.304-.438-7.634 3.059-9.654l12.291-7.098a7.599 7.599 0 0 1 3.789-1.033c2.51 0 4.697 1.258 5.852 3.365 1.811 3.304.439 7.634-3.059 9.654l-12.291 7.098a7.606 7.606 0 0 1-3.789 1.033zm13.287-20.683a7.128 7.128 0 0 0-3.555.971l-12.291 7.098c-3.279 1.893-4.573 5.942-2.883 9.024 1.071 1.955 3.106 3.122 5.442 3.122a7.13 7.13 0 0 0 3.556-.97l12.291-7.098c3.279-1.893 4.572-5.942 2.883-9.024-1.072-1.955-3.106-3.123-5.443-3.123z' fill='#607D8B'/><path d='M149.588 109.407l6.737 3.89v.887c0 .176.013.36.037.549.011.081.02.161.028.242.14 1.415.973 2.998 2.105 3.999l7.396 6.545c.177.156.358.295.541.415 1.579 1.04 2.95.466 3.062-1.282.049-.784.057-1.595.023-2.429l-.003-.16v-1.151l25.987 15.003v54c0 1.09-.77 1.53-1.72.982l-42.473-24.523c-.95-.548-1.72-1.877-1.72-2.966v-34.033' fill='#FAFAFA'/><path d='M194.553 191.25c-.257 0-.54-.085-.831-.253l-42.472-24.521c-.981-.567-1.779-1.943-1.779-3.068v-34.033h.234v34.033c0 1.051.745 2.336 1.661 2.866l42.473 24.521c.424.245.816.288 1.103.122.285-.164.442-.52.442-1.002v-53.933l-25.753-14.868.003 1.106c.034.832.026 1.654-.024 2.439-.054.844-.396 1.464-.963 1.746-.619.309-1.45.173-2.28-.373a5.023 5.023 0 0 1-.553-.426l-7.397-6.544c-1.158-1.026-1.999-2.625-2.143-4.076a9.624 9.624 0 0 0-.027-.238 4.241 4.241 0 0 1-.038-.564v-.82l-6.68-3.856.117-.202 6.738 3.89.058.034v.954c0 .171.012.351.036.533.011.083.021.165.029.246.138 1.395.948 2.935 2.065 3.923l7.397 6.545c.173.153.35.289.527.406.758.499 1.504.63 2.047.359.49-.243.786-.795.834-1.551.05-.778.057-1.591.024-2.417l-.004-.163v-1.355l.175.1 25.987 15.004.059.033v54.068c0 .569-.198.996-.559 1.204a1.002 1.002 0 0 1-.506.131' fill='#607D8B'/><path d='M145.685 163.161l24.115 13.922-25.978 14.998-1.462-.307c-6.534-2.17-13.628-3.728-21.019-4.616-4.365-.524-8.663 1.096-9.598 3.62a2.746 2.746 0 0 0-.011 1.928c1.538 4.267 4.236 8.363 7.995 12.135l.532.845-25.977 14.997-24.115-13.922 75.518-43.6' fill='#FFF'/><path d='M94.282 220.818l-.059-.033-24.29-14.024.175-.101 75.577-43.634.058.033 24.29 14.024-26.191 15.122-.045-.01-1.461-.307c-6.549-2.174-13.613-3.725-21.009-4.614a13.744 13.744 0 0 0-1.638-.097c-3.758 0-7.054 1.531-7.837 3.642a2.62 2.62 0 0 0-.01 1.848c1.535 4.258 4.216 8.326 7.968 12.091l.016.021.526.835.006.01.064.102-.105.061-25.977 14.998-.058.033zm-23.881-14.057l23.881 13.788 24.802-14.32c.546-.315.846-.489 1.017-.575l-.466-.74c-3.771-3.787-6.467-7.881-8.013-12.168a2.851 2.851 0 0 1 .011-2.008c.815-2.199 4.203-3.795 8.056-3.795.557 0 1.117.033 1.666.099 7.412.891 14.491 2.445 21.041 4.621.836.175 1.215.254 1.39.304l25.78-14.884-23.881-13.788-75.284 43.466z' fill='#607D8B'/><path d='M167.23 125.979v50.871l-27.321 15.773-6.461-14.167c-.91-1.996-3.428-1.738-5.624.574a10.238 10.238 0 0 0-2.33 4.018l-6.46 21.628-27.322 15.774v-50.871l75.518-43.6' fill='#FFF'/><path d='M91.712 220.567a.127.127 0 0 1-.059-.016.118.118 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.519-43.6a.117.117 0 0 1 .175.101v50.871c0 .041-.023.08-.059.1l-27.321 15.775a.118.118 0 0 1-.094.01.12.12 0 0 1-.071-.063l-6.46-14.168c-.375-.822-1.062-1.275-1.934-1.275-1.089 0-2.364.686-3.5 1.881a10.206 10.206 0 0 0-2.302 3.972l-6.46 21.627a.118.118 0 0 1-.054.068L91.77 220.551a.12.12 0 0 1-.058.016zm.117-50.92v50.601l27.106-15.65 6.447-21.583a10.286 10.286 0 0 1 2.357-4.065c1.18-1.242 2.517-1.954 3.669-1.954.969 0 1.731.501 2.146 1.411l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M168.543 126.213v50.87l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.624.574a10.248 10.248 0 0 0-2.33 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6' fill='#FFF'/><path d='M93.025 220.8a.123.123 0 0 1-.059-.015.12.12 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.518-43.6a.112.112 0 0 1 .117 0c.036.02.059.059.059.1v50.871a.116.116 0 0 1-.059.101l-27.321 15.774a.111.111 0 0 1-.094.01.115.115 0 0 1-.071-.062l-6.46-14.168c-.375-.823-1.062-1.275-1.935-1.275-1.088 0-2.363.685-3.499 1.881a10.19 10.19 0 0 0-2.302 3.971l-6.461 21.628a.108.108 0 0 1-.053.067l-27.322 15.775a.12.12 0 0 1-.058.015zm.117-50.919v50.6l27.106-15.649 6.447-21.584a10.293 10.293 0 0 1 2.357-4.065c1.179-1.241 2.516-1.954 3.668-1.954.969 0 1.732.502 2.147 1.412l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M169.8 177.083l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.625.574a10.246 10.246 0 0 0-2.329 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6v50.87z' fill='#FAFAFA'/><path d='M94.282 220.917a.234.234 0 0 1-.234-.233v-50.871c0-.083.045-.161.117-.202l75.518-43.601a.234.234 0 1 1 .35.202v50.871a.233.233 0 0 1-.116.202l-27.322 15.775a.232.232 0 0 1-.329-.106l-6.461-14.168c-.36-.789-.992-1.206-1.828-1.206-1.056 0-2.301.672-3.415 1.844a10.099 10.099 0 0 0-2.275 3.924l-6.46 21.628a.235.235 0 0 1-.107.136l-27.322 15.774a.23.23 0 0 1-.116.031zm.233-50.969v50.331l26.891-15.525 6.434-21.539a10.41 10.41 0 0 1 2.384-4.112c1.201-1.265 2.569-1.991 3.753-1.991 1.018 0 1.818.526 2.253 1.48l6.354 13.934 26.982-15.578v-50.331l-75.051 43.331z' fill='#607D8B'/><path d='M109.894 199.943c-1.774 0-3.241-.725-4.244-2.12a.224.224 0 0 1 .023-.294.233.233 0 0 1 .301-.023c.78.547 1.705.827 2.75.827 1.323 0 2.754-.439 4.256-1.306 5.311-3.067 9.631-10.518 9.631-16.611 0-1.927-.442-3.56-1.278-4.724a.232.232 0 0 1 .323-.327c1.671 1.172 2.591 3.381 2.591 6.219 0 6.242-4.426 13.863-9.865 17.003-1.574.908-3.084 1.356-4.488 1.356zm-2.969-1.542c.813.651 1.82.877 2.968.877h.001c1.321 0 2.753-.327 4.254-1.194 5.311-3.067 9.632-10.463 9.632-16.556 0-1.979-.463-3.599-1.326-4.761.411 1.035.625 2.275.625 3.635 0 6.243-4.426 13.883-9.865 17.023-1.574.909-3.084 1.317-4.49 1.317-.641 0-1.243-.149-1.799-.341z' fill='#607D8B'/><path d='M113.097 197.23c5.384-3.108 9.748-10.636 9.748-16.814 0-2.051-.483-3.692-1.323-4.86-1.784-1.252-4.374-1.194-7.257.47-5.384 3.108-9.748 10.636-9.748 16.814 0 2.051.483 3.692 1.323 4.86 1.784 1.252 4.374 1.194 7.257-.47' fill='#FAFAFA'/><path d='M108.724 198.614c-1.142 0-2.158-.213-3.019-.817-.021-.014-.04.014-.055-.007-.894-1.244-1.367-2.948-1.367-4.973 0-6.242 4.426-13.864 9.865-17.005 1.574-.908 3.084-1.363 4.49-1.363 1.142 0 2.158.309 3.018.913a.23.23 0 0 1 .056.056c.894 1.244 1.367 2.972 1.367 4.997 0 6.243-4.426 13.783-9.865 16.923-1.574.909-3.084 1.276-4.49 1.276zm-2.718-1.109c.774.532 1.688.776 2.718.776 1.323 0 2.754-.413 4.256-1.28 5.311-3.066 9.631-10.505 9.631-16.598 0-1.909-.434-3.523-1.255-4.685-.774-.533-1.688-.799-2.718-.799-1.323 0-2.755.441-4.256 1.308-5.311 3.066-9.631 10.506-9.631 16.599 0 1.909.434 3.517 1.255 4.679z' fill='#607D8B'/><path d='M149.318 114.262l-9.984 8.878 15.893 11.031 5.589-6.112-11.498-13.797' fill='#FAFAFA'/><path d='M169.676 120.84l-9.748 5.627c-3.642 2.103-9.528 2.113-13.147.024-3.62-2.089-3.601-5.488.041-7.591l9.495-5.608-6.729-3.885-81.836 47.071 45.923 26.514 3.081-1.779c.631-.365.869-.898.618-1.39-2.357-4.632-2.593-9.546-.683-14.262 5.638-13.92 24.509-24.815 48.618-28.07 8.169-1.103 16.68-.967 24.704.394.852.145 1.776.008 2.407-.357l3.081-1.778-25.825-14.91' fill='#FAFAFA'/><path d='M113.675 183.459a.47.47 0 0 1-.233-.062l-45.924-26.515a.468.468 0 0 1 .001-.809l81.836-47.071a.467.467 0 0 1 .466 0l6.729 3.885a.467.467 0 0 1-.467.809l-6.496-3.75-80.9 46.533 44.988 25.973 2.848-1.644c.192-.111.62-.409.435-.773-2.416-4.748-2.658-9.814-.7-14.65 2.806-6.927 8.885-13.242 17.582-18.263 8.657-4.998 19.518-8.489 31.407-10.094 8.198-1.107 16.79-.97 24.844.397.739.125 1.561.007 2.095-.301l2.381-1.374-25.125-14.506a.467.467 0 0 1 .467-.809l25.825 14.91a.467.467 0 0 1 0 .809l-3.081 1.779c-.721.417-1.763.575-2.718.413-7.963-1.351-16.457-1.486-24.563-.392-11.77 1.589-22.512 5.039-31.065 9.977-8.514 4.916-14.456 11.073-17.183 17.805-1.854 4.578-1.623 9.376.666 13.875.37.725.055 1.513-.8 2.006l-3.081 1.78a.476.476 0 0 1-.234.062' fill='#455A64'/><path d='M153.316 128.279c-2.413 0-4.821-.528-6.652-1.586-1.818-1.049-2.82-2.461-2.82-3.975 0-1.527 1.016-2.955 2.861-4.02l9.493-5.607a.233.233 0 1 1 .238.402l-9.496 5.609c-1.696.979-2.628 2.263-2.628 3.616 0 1.34.918 2.608 2.585 3.571 3.549 2.049 9.343 2.038 12.914-.024l9.748-5.628a.234.234 0 0 1 .234.405l-9.748 5.628c-1.858 1.072-4.296 1.609-6.729 1.609' fill='#607D8B'/><path d='M113.675 182.992l-45.913-26.508M113.675 183.342a.346.346 0 0 1-.175-.047l-45.913-26.508a.35.35 0 1 1 .35-.607l45.913 26.508a.35.35 0 0 1-.175.654' fill='#455A64'/><path d='M67.762 156.484v54.001c0 1.09.77 2.418 1.72 2.967l42.473 24.521c.95.549 1.72.11 1.72-.98v-54.001' fill='#FAFAFA'/><path d='M112.727 238.561c-.297 0-.62-.095-.947-.285l-42.473-24.521c-1.063-.613-1.895-2.05-1.895-3.27v-54.001a.35.35 0 1 1 .701 0v54.001c0 .96.707 2.18 1.544 2.663l42.473 24.522c.344.198.661.243.87.122.206-.119.325-.411.325-.799v-54.001a.35.35 0 1 1 .7 0v54.001c0 .655-.239 1.154-.675 1.406a1.235 1.235 0 0 1-.623.162' fill='#455A64'/><path d='M112.86 147.512h-.001c-2.318 0-4.499-.522-6.142-1.471-1.705-.984-2.643-2.315-2.643-3.749 0-1.445.952-2.791 2.68-3.788l12.041-6.953c1.668-.962 3.874-1.493 6.212-1.493 2.318 0 4.499.523 6.143 1.472 1.704.984 2.643 2.315 2.643 3.748 0 1.446-.952 2.791-2.68 3.789l-12.042 6.952c-1.668.963-3.874 1.493-6.211 1.493zm12.147-16.753c-2.217 0-4.298.497-5.861 1.399l-12.042 6.952c-1.502.868-2.33 1.998-2.33 3.182 0 1.173.815 2.289 2.293 3.142 1.538.889 3.596 1.378 5.792 1.378h.001c2.216 0 4.298-.497 5.861-1.399l12.041-6.953c1.502-.867 2.33-1.997 2.33-3.182 0-1.172-.814-2.288-2.292-3.142-1.539-.888-3.596-1.377-5.793-1.377z' fill='#607D8B'/><path d='M165.63 123.219l-5.734 3.311c-3.167 1.828-8.286 1.837-11.433.02-3.147-1.817-3.131-4.772.036-6.601l5.734-3.31 11.397 6.58' fill='#FAFAFA'/><path d='M154.233 117.448l9.995 5.771-4.682 2.704c-1.434.827-3.352 1.283-5.399 1.283-2.029 0-3.923-.449-5.333-1.263-1.29-.744-2-1.694-2-2.674 0-.991.723-1.955 2.036-2.713l5.383-3.108m0-.809l-5.734 3.31c-3.167 1.829-3.183 4.784-.036 6.601 1.568.905 3.623 1.357 5.684 1.357 2.077 0 4.159-.46 5.749-1.377l5.734-3.311-11.397-6.58M145.445 179.667c-1.773 0-3.241-.85-4.243-2.245-.067-.092-.057-.275.023-.356.08-.081.207-.12.3-.055.781.548 1.706.812 2.751.811 1.322 0 2.754-.446 4.256-1.313 5.31-3.066 9.631-10.522 9.631-16.615 0-1.927-.442-3.562-1.279-4.726a.235.235 0 0 1 .024-.301.232.232 0 0 1 .3-.027c1.67 1.172 2.59 3.38 2.59 6.219 0 6.242-4.425 13.987-9.865 17.127-1.573.908-3.083 1.481-4.488 1.481zM142.476 178c.814.651 1.82 1.002 2.969 1.002 1.322 0 2.753-.452 4.255-1.32 5.31-3.065 9.631-10.523 9.631-16.617 0-1.98-.463-3.63-1.325-4.793.411 1.035.624 2.26.624 3.62 0 6.242-4.425 13.875-9.865 17.015-1.573.909-3.084 1.376-4.489 1.376a5.49 5.49 0 0 1-1.8-.283z' fill='#607D8B'/><path d='M148.648 176.704c5.384-3.108 9.748-10.636 9.748-16.813 0-2.052-.483-3.693-1.322-4.861-1.785-1.252-4.375-1.194-7.258.471-5.383 3.108-9.748 10.636-9.748 16.813 0 2.051.484 3.692 1.323 4.86 1.785 1.253 4.374 1.195 7.257-.47' fill='#FAFAFA'/><path d='M144.276 178.276c-1.143 0-2.158-.307-3.019-.911a.217.217 0 0 1-.055-.054c-.895-1.244-1.367-2.972-1.367-4.997 0-6.241 4.425-13.875 9.865-17.016 1.573-.908 3.084-1.369 4.489-1.369 1.143 0 2.158.307 3.019.91a.24.24 0 0 1 .055.055c.894 1.244 1.367 2.971 1.367 4.997 0 6.241-4.425 13.875-9.865 17.016-1.573.908-3.084 1.369-4.489 1.369zm-2.718-1.172c.773.533 1.687.901 2.718.901 1.322 0 2.754-.538 4.256-1.405 5.31-3.066 9.631-10.567 9.631-16.661 0-1.908-.434-3.554-1.256-4.716-.774-.532-1.688-.814-2.718-.814-1.322 0-2.754.433-4.256 1.3-5.31 3.066-9.631 10.564-9.631 16.657 0 1.91.434 3.576 1.256 4.738z' fill='#607D8B'/><path d='M150.72 172.361l-.363-.295a24.105 24.105 0 0 0 2.148-3.128 24.05 24.05 0 0 0 1.977-4.375l.443.149a24.54 24.54 0 0 1-2.015 4.46 24.61 24.61 0 0 1-2.19 3.189M115.917 191.514l-.363-.294a24.174 24.174 0 0 0 2.148-3.128 24.038 24.038 0 0 0 1.976-4.375l.443.148a24.48 24.48 0 0 1-2.015 4.461 24.662 24.662 0 0 1-2.189 3.188M114 237.476V182.584 237.476' fill='#607D8B'/><g><path d='M81.822 37.474c.017-.135-.075-.28-.267-.392-.327-.188-.826-.21-1.109-.045l-6.012 3.471c-.131.076-.194.178-.191.285.002.132.002.461.002.578v.043l-.007.128-6.591 3.779c-.001 0-2.077 1.046-2.787 5.192 0 0-.912 6.961-.898 19.745.015 12.57.606 17.07 1.167 21.351.22 1.684 3.001 2.125 3.001 2.125.331.04.698-.027 1.08-.248l75.273-43.551c1.808-1.069 2.667-3.719 3.056-6.284 1.213-7.99 1.675-32.978-.275-39.878-.196-.693-.51-1.083-.868-1.282l-2.086-.79c-.727.028-1.416.467-1.534.535L82.032 37.072l-.21.402' fill='#FFF'/><path d='M144.311 1.701l2.085.79c.358.199.672.589.868 1.282 1.949 6.9 1.487 31.887.275 39.878-.39 2.565-1.249 5.215-3.056 6.284L69.21 93.486a1.78 1.78 0 0 1-.896.258l-.183-.011c0 .001-2.782-.44-3.003-2.124-.56-4.282-1.151-8.781-1.165-21.351-.015-12.784.897-19.745.897-19.745.71-4.146 2.787-5.192 2.787-5.192l6.591-3.779.007-.128v-.043c0-.117 0-.446-.002-.578-.003-.107.059-.21.191-.285l6.012-3.472a.98.98 0 0 1 .481-.11c.218 0 .449.053.627.156.193.112.285.258.268.392l.211-.402 60.744-34.836c.117-.068.806-.507 1.534-.535m0-.997l-.039.001c-.618.023-1.283.244-1.974.656l-.021.012-60.519 34.706a2.358 2.358 0 0 0-.831-.15c-.365 0-.704.084-.98.244l-6.012 3.471c-.442.255-.699.69-.689 1.166l.001.15-6.08 3.487c-.373.199-2.542 1.531-3.29 5.898l-.006.039c-.009.07-.92 7.173-.906 19.875.014 12.62.603 17.116 1.172 21.465l.002.015c.308 2.355 3.475 2.923 3.836 2.98l.034.004c.101.013.204.019.305.019a2.77 2.77 0 0 0 1.396-.392l75.273-43.552c1.811-1.071 2.999-3.423 3.542-6.997 1.186-7.814 1.734-33.096-.301-40.299-.253-.893-.704-1.527-1.343-1.882l-.132-.062-2.085-.789a.973.973 0 0 0-.353-.065' fill='#455A64'/><path d='M128.267 11.565l1.495.434-56.339 32.326' fill='#FFF'/><path d='M74.202 90.545a.5.5 0 0 1-.25-.931l18.437-10.645a.499.499 0 1 1 .499.864L74.451 90.478l-.249.067M75.764 42.654l-.108-.062.046-.171 5.135-2.964.17.045-.045.171-5.135 2.964-.063.017M70.52 90.375V46.421l.063-.036L137.84 7.554v43.954l-.062.036L70.52 90.375zm.25-43.811v43.38l66.821-38.579V7.985L70.77 46.564z' fill='#607D8B'/><path d='M86.986 83.182c-.23.149-.612.384-.849.523l-11.505 6.701c-.237.139-.206.252.068.252h.565c.275 0 .693-.113.93-.252L87.7 83.705c.237-.139.428-.253.425-.256a11.29 11.29 0 0 1-.006-.503c0-.274-.188-.377-.418-.227l-.715.463' fill='#607D8B'/><path d='M75.266 90.782H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.236-.138.615-.371.844-.519l.715-.464a.488.488 0 0 1 .266-.089c.172 0 .345.13.345.421 0 .214.001.363.003.437l.006.004-.004.069c-.003.075-.003.075-.486.356l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.108.866-.234l11.505-6.702c.168-.098.294-.173.361-.214-.004-.084-.004-.218-.004-.437l-.095-.171-.131.049-.714.463c-.232.15-.616.386-.854.525l-11.505 6.702-.029.018z' fill='#607D8B'/><path d='M75.266 89.871H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.258-.151.694-.268.993-.268h.565c.2 0 .316.056.346.166.03.11-.043.217-.215.317l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.107.866-.234l11.505-6.702.03-.018-.035-.001h-.565c-.252 0-.649.108-.867.234l-11.505 6.702-.029.018zM74.37 90.801v-1.247 1.247' fill='#607D8B'/><path d='M68.13 93.901c-.751-.093-1.314-.737-1.439-1.376-.831-4.238-1.151-8.782-1.165-21.352-.015-12.784.897-19.745.897-19.745.711-4.146 2.787-5.192 2.787-5.192l74.859-43.219c.223-.129 2.487-1.584 3.195.923 1.95 6.9 1.488 31.887.275 39.878-.389 2.565-1.248 5.215-3.056 6.283L69.21 93.653c-.382.221-.749.288-1.08.248 0 0-2.781-.441-3.001-2.125-.561-4.281-1.152-8.781-1.167-21.351-.014-12.784.898-19.745.898-19.745.71-4.146 2.787-5.191 2.787-5.191l6.598-3.81.871-.119 6.599-3.83.046-.461L68.13 93.901' fill='#FAFAFA'/><path d='M68.317 94.161l-.215-.013h-.001l-.244-.047c-.719-.156-2.772-.736-2.976-2.292-.568-4.34-1.154-8.813-1.168-21.384-.014-12.654.891-19.707.9-19.777.725-4.231 2.832-5.338 2.922-5.382l6.628-3.827.87-.119 6.446-3.742.034-.334a.248.248 0 0 1 .273-.223.248.248 0 0 1 .223.272l-.059.589-6.752 3.919-.87.118-6.556 3.785c-.031.016-1.99 1.068-2.666 5.018-.007.06-.908 7.086-.894 19.702.014 12.539.597 16.996 1.161 21.305.091.691.689 1.154 1.309 1.452a1.95 1.95 0 0 1-.236-.609c-.781-3.984-1.155-8.202-1.17-21.399-.014-12.653.891-19.707.9-19.777.725-4.231 2.832-5.337 2.922-5.382-.004.001 74.444-42.98 74.846-43.212l.028-.017c.904-.538 1.72-.688 2.36-.433.555.221.949.733 1.172 1.52 2.014 7.128 1.46 32.219.281 39.983-.507 3.341-1.575 5.515-3.175 6.462L69.335 93.869a2.023 2.023 0 0 1-1.018.292zm-.147-.507c.293.036.604-.037.915-.217l75.273-43.551c1.823-1.078 2.602-3.915 2.934-6.106 1.174-7.731 1.731-32.695-.268-39.772-.178-.631-.473-1.032-.876-1.192-.484-.193-1.166-.052-1.921.397l-.034.021-74.858 43.218c-.031.017-1.989 1.069-2.666 5.019-.007.059-.908 7.085-.894 19.702.015 13.155.386 17.351 1.161 21.303.09.461.476.983 1.037 1.139.114.025.185.037.196.039h.001z' fill='#455A64'/><path d='M69.317 68.982c.489-.281.885-.056.885.505 0 .56-.396 1.243-.885 1.525-.488.282-.884.057-.884-.504 0-.56.396-1.243.884-1.526' fill='#FFF'/><path d='M68.92 71.133c-.289 0-.487-.228-.487-.625 0-.56.396-1.243.884-1.526a.812.812 0 0 1 .397-.121c.289 0 .488.229.488.626 0 .56-.396 1.243-.885 1.525a.812.812 0 0 1-.397.121m.794-2.459a.976.976 0 0 0-.49.147c-.548.317-.978 1.058-.978 1.687 0 .486.271.812.674.812a.985.985 0 0 0 .491-.146c.548-.317.978-1.057.978-1.687 0-.486-.272-.813-.675-.813' fill='#8097A2'/><path d='M68.92 70.947c-.271 0-.299-.307-.299-.439 0-.491.361-1.116.79-1.363a.632.632 0 0 1 .303-.096c.272 0 .301.306.301.438 0 .491-.363 1.116-.791 1.364a.629.629 0 0 1-.304.096m.794-2.086a.812.812 0 0 0-.397.121c-.488.283-.884.966-.884 1.526 0 .397.198.625.487.625a.812.812 0 0 0 .397-.121c.489-.282.885-.965.885-1.525 0-.397-.199-.626-.488-.626' fill='#8097A2'/><path d='M69.444 85.35c.264-.152.477-.031.477.272 0 .303-.213.67-.477.822-.263.153-.477.031-.477-.271 0-.302.214-.671.477-.823' fill='#FFF'/><path d='M69.23 86.51c-.156 0-.263-.123-.263-.337 0-.302.214-.671.477-.823a.431.431 0 0 1 .214-.066c.156 0 .263.124.263.338 0 .303-.213.67-.477.822a.431.431 0 0 1-.214.066m.428-1.412c-.1 0-.203.029-.307.09-.32.185-.57.618-.57.985 0 .309.185.524.449.524a.63.63 0 0 0 .308-.09c.32-.185.57-.618.57-.985 0-.309-.185-.524-.45-.524' fill='#8097A2'/><path d='M69.23 86.322l-.076-.149c0-.235.179-.544.384-.661l.12-.041.076.151c0 .234-.179.542-.383.66l-.121.04m.428-1.038a.431.431 0 0 0-.214.066c-.263.152-.477.521-.477.823 0 .214.107.337.263.337a.431.431 0 0 0 .214-.066c.264-.152.477-.519.477-.822 0-.214-.107-.338-.263-.338' fill='#8097A2'/><path d='M139.278 7.769v43.667L72.208 90.16V46.493l67.07-38.724' fill='#455A64'/><path d='M72.083 90.375V46.421l.063-.036 67.257-38.831v43.954l-.062.036-67.258 38.831zm.25-43.811v43.38l66.821-38.579V7.985L72.333 46.564z' fill='#607D8B'/></g><path d='M125.737 88.647l-7.639 3.334V84l-11.459 4.713v8.269L99 100.315l13.369 3.646 13.368-15.314' fill='#455A64'/></g></svg>";function Ne(){this.loadIcon_();var W=document.createElement("div"),ft=W.style;ft.position="fixed",ft.top=0,ft.right=0,ft.bottom=0,ft.left=0,ft.backgroundColor="gray",ft.fontFamily="sans-serif",ft.zIndex=1e6;var ue=document.createElement("img");ue.src=this.icon;var ft=ue.style;ft.marginLeft="25%",ft.marginTop="25%",ft.width="50%",W.appendChild(ue);var Ae=document.createElement("div"),ft=Ae.style;ft.textAlign="center",ft.fontSize="16px",ft.lineHeight="24px",ft.margin="24px 25%",ft.width="50%",Ae.innerHTML="Place your phone into your Cardboard viewer.",W.appendChild(Ae);var Se=document.createElement("div"),ft=Se.style;ft.backgroundColor="#CFD8DC",ft.position="fixed",ft.bottom=0,ft.width="100%",ft.height="48px",ft.padding="14px 24px",ft.boxSizing="border-box",ft.color="#656A6B",W.appendChild(Se);var We=document.createElement("div");We.style.float="left",We.innerHTML="No Cardboard viewer?";var Ye=document.createElement("a");Ye.href="https://www.google.com/get/cardboard/get-cardboard/",Ye.innerHTML="get one",Ye.target="_blank";var ft=Ye.style;ft.float="right",ft.fontWeight=600,ft.textTransform="uppercase",ft.borderLeft="1px solid gray",ft.paddingLeft="24px",ft.textDecoration="none",ft.color="#656A6B",Se.appendChild(We),Se.appendChild(Ye),this.overlay=W,this.text=Ae,this.hide()}Ne.prototype.show=function(W){!W&&!this.overlay.parentElement?document.body.appendChild(this.overlay):W&&(this.overlay.parentElement&&this.overlay.parentElement!=W&&this.overlay.parentElement.removeChild(this.overlay),W.appendChild(this.overlay)),this.overlay.style.display="block";var ue=this.overlay.querySelector("img"),Ae=ue.style;de()?(Ae.width="20%",Ae.marginLeft="40%",Ae.marginTop="3%"):(Ae.width="50%",Ae.marginLeft="25%",Ae.marginTop="25%")},Ne.prototype.hide=function(){this.overlay.style.display="none"},Ne.prototype.showTemporarily=function(W,ue){this.show(ue),this.timer=setTimeout(this.hide.bind(this),W)},Ne.prototype.disableShowTemporarily=function(){clearTimeout(this.timer)},Ne.prototype.update=function(){this.disableShowTemporarily(),!de()&&Ze()?this.show():this.hide()},Ne.prototype.loadIcon_=function(){this.icon=z("image/svg+xml",ge)};var Fe="CardboardV1",Ke="WEBVR_CARDBOARD_VIEWER",ot="webvr-polyfill-viewer-selector";function wt(W){try{this.selectedKey=localStorage.getItem(Ke)}catch(ue){console.error("Failed to load viewer profile: %s",ue)}this.selectedKey||(this.selectedKey=W||Fe),this.dialog=this.createDialog_(Ur.Viewers),this.root=null,this.onChangeCallbacks_=[]}wt.prototype.show=function(W){this.root=W,W.appendChild(this.dialog);var ue=this.dialog.querySelector("#"+this.selectedKey);ue.checked=!0,this.dialog.style.display="block"},wt.prototype.hide=function(){this.root&&this.root.contains(this.dialog)&&this.root.removeChild(this.dialog),this.dialog.style.display="none"},wt.prototype.getCurrentViewer=function(){return Ur.Viewers[this.selectedKey]},wt.prototype.getSelectedKey_=function(){var W=this.dialog.querySelector("input[name=field]:checked");return W?W.id:null},wt.prototype.onChange=function(W){this.onChangeCallbacks_.push(W)},wt.prototype.fireOnChange_=function(W){for(var ue=0;ue<this.onChangeCallbacks_.length;ue++)this.onChangeCallbacks_[ue](W)},wt.prototype.onSave_=function(){if(this.selectedKey=this.getSelectedKey_(),!this.selectedKey||!Ur.Viewers[this.selectedKey]){console.error("ViewerSelector.onSave_: this should never happen!");return}this.fireOnChange_(Ur.Viewers[this.selectedKey]);try{localStorage.setItem(Ke,this.selectedKey)}catch(W){console.error("Failed to save viewer profile: %s",W)}this.hide()},wt.prototype.createDialog_=function(W){var ue=document.createElement("div");ue.classList.add(ot),ue.style.display="none";var Ae=document.createElement("div"),Ye=Ae.style;Ye.position="fixed",Ye.left=0,Ye.top=0,Ye.width="100%",Ye.height="100%",Ye.background="rgba(0, 0, 0, 0.3)",Ae.addEventListener("click",this.hide.bind(this));var Se=280,We=document.createElement("div"),Ye=We.style;Ye.boxSizing="border-box",Ye.position="fixed",Ye.top="24px",Ye.left="50%",Ye.marginLeft=-280/2+"px",Ye.width=Se+"px",Ye.padding="24px",Ye.overflow="hidden",Ye.background="#fafafa",Ye.fontFamily="'Roboto', sans-serif",Ye.boxShadow="0px 5px 20px #666",We.appendChild(this.createH1_("Select your viewer"));for(var ft in W)We.appendChild(this.createChoice_(ft,W[ft].label));return We.appendChild(this.createButton_("Save",this.onSave_.bind(this))),ue.appendChild(Ae),ue.appendChild(We),ue},wt.prototype.createH1_=function(W){var ue=document.createElement("h1"),Ae=ue.style;return Ae.color="black",Ae.fontSize="20px",Ae.fontWeight="bold",Ae.marginTop=0,Ae.marginBottom="24px",ue.innerHTML=W,ue},wt.prototype.createChoice_=function(W,ue){var Ae=document.createElement("div");Ae.style.marginTop="8px",Ae.style.color="black";var Se=document.createElement("input");Se.style.fontSize="30px",Se.setAttribute("id",W),Se.setAttribute("type","radio"),Se.setAttribute("value",W),Se.setAttribute("name","field");var We=document.createElement("label");return We.style.marginLeft="4px",We.setAttribute("for",W),We.innerHTML=ue,Ae.appendChild(Se),Ae.appendChild(We),Ae},wt.prototype.createButton_=function(W,ue){var Ae=document.createElement("button");Ae.innerHTML=W;var Se=Ae.style;return Se.float="right",Se.textTransform="uppercase",Se.color="#1094f7",Se.fontSize="14px",Se.letterSpacing=0,Se.border=0,Se.background="none",Se.marginTop="16px",Ae.addEventListener("click",ue),Ae};var qt=typeof window<"u"?window:typeof h<"u"?h:typeof self<"u"?self:{};function Kt(W){return W&&W.__esModule&&Object.prototype.hasOwnProperty.call(W,"default")?W.default:W}function Mt(W,ue){return ue={exports:{}},W(ue,ue.exports),ue.exports}var ti=Mt(function(W,ue){(function(Ae,Se){W.exports=Se()})(qt,function(){return function(Ae){var Se={};function We(Ye){if(Se[Ye])return Se[Ye].exports;var ft=Se[Ye]={i:Ye,l:!1,exports:{}};return Ae[Ye].call(ft.exports,ft,ft.exports,We),ft.l=!0,ft.exports}return We.m=Ae,We.c=Se,We.d=function(Ye,ft,he){We.o(Ye,ft)||Object.defineProperty(Ye,ft,{configurable:!1,enumerable:!0,get:he})},We.n=function(Ye){var ft=Ye&&Ye.__esModule?function(){return Ye.default}:function(){return Ye};return We.d(ft,"a",ft),ft},We.o=function(Ye,ft){return Object.prototype.hasOwnProperty.call(Ye,ft)},We.p="",We(We.s=0)}([function(Ae,Se,We){var Ye=function(){function be(Ee,st){for(var Ct=0;Ct<st.length;Ct++){var Ht=st[Ct];Ht.enumerable=Ht.enumerable||!1,Ht.configurable=!0,"value"in Ht&&(Ht.writable=!0),Object.defineProperty(Ee,Ht.key,Ht)}}return function(Ee,st,Ct){return st&&be(Ee.prototype,st),Ct&&be(Ee,Ct),Ee}}();function ft(be,Ee){if(!(be instanceof Ee))throw new TypeError("Cannot call a class as a function")}var he=We(1),le=typeof navigator<"u"&&parseFloat((""+(/CPU.*OS ([0-9_]{3,4})[0-9_]{0,1}|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))<10&&!window.MSStream,pe=function(){function be(){ft(this,be),le?this.noSleepTimer=null:(this.noSleepVideo=document.createElement("video"),this.noSleepVideo.setAttribute("playsinline",""),this.noSleepVideo.setAttribute("src",he),this.noSleepVideo.addEventListener("timeupdate",(function(Ee){this.noSleepVideo.currentTime>.5&&(this.noSleepVideo.currentTime=Math.random())}).bind(this)))}return Ye(be,[{key:"enable",value:function(){le?(this.disable(),this.noSleepTimer=window.setInterval(function(){window.location.href="/",window.setTimeout(window.stop,0)},15e3)):this.noSleepVideo.play()}},{key:"disable",value:function(){le?this.noSleepTimer&&(window.clearInterval(this.noSleepTimer),this.noSleepTimer=null):this.noSleepVideo.pause()}}]),be}();Ae.exports=pe},function(Ae,Se,We){Ae.exports="data:video/mp4;base64,AAAAIGZ0eXBtcDQyAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAACKBtZGF0AAAC8wYF///v3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE0MiByMjQ3OSBkZDc5YTYxIC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAxNCAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTEgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MToweDExMSBtZT1oZXggc3VibWU9MiBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVkX3JlZj0wIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MCA4eDhkY3Q9MCBjcW09MCBkZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0wIHRocmVhZHM9NiBsb29rYWhlYWRfdGhyZWFkcz0xIHNsaWNlZF90aHJlYWRzPTAgbnI9MCBkZWNpbWF0ZT0xIGludGVybGFjZWQ9MCBibHVyYXlfY29tcGF0PTAgY29uc3RyYWluZWRfaW50cmE9MCBiZnJhbWVzPTMgYl9weXJhbWlkPTIgYl9hZGFwdD0xIGJfYmlhcz0wIGRpcmVjdD0xIHdlaWdodGI9MSBvcGVuX2dvcD0wIHdlaWdodHA9MSBrZXlpbnQ9MzAwIGtleWludF9taW49MzAgc2NlbmVjdXQ9NDAgaW50cmFfcmVmcmVzaD0wIHJjX2xvb2thaGVhZD0xMCByYz1jcmYgbWJ0cmVlPTEgY3JmPTIwLjAgcWNvbXA9MC42MCBxcG1pbj0wIHFwbWF4PTY5IHFwc3RlcD00IHZidl9tYXhyYXRlPTIwMDAwIHZidl9idWZzaXplPTI1MDAwIGNyZl9tYXg9MC4wIG5hbF9ocmQ9bm9uZSBmaWxsZXI9MCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAAOWWIhAA3//p+C7v8tDDSTjf97w55i3SbRPO4ZY+hkjD5hbkAkL3zpJ6h/LR1CAABzgB1kqqzUorlhQAAAAxBmiQYhn/+qZYADLgAAAAJQZ5CQhX/AAj5IQADQGgcIQADQGgcAAAACQGeYUQn/wALKCEAA0BoHAAAAAkBnmNEJ/8ACykhAANAaBwhAANAaBwAAAANQZpoNExDP/6plgAMuSEAA0BoHAAAAAtBnoZFESwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBnqVEJ/8ACykhAANAaBwAAAAJAZ6nRCf/AAsoIQADQGgcIQADQGgcAAAADUGarDRMQz/+qZYADLghAANAaBwAAAALQZ7KRRUsK/8ACPkhAANAaBwAAAAJAZ7pRCf/AAsoIQADQGgcIQADQGgcAAAACQGe60Qn/wALKCEAA0BoHAAAAA1BmvA0TEM//qmWAAy5IQADQGgcIQADQGgcAAAAC0GfDkUVLCv/AAj5IQADQGgcAAAACQGfLUQn/wALKSEAA0BoHCEAA0BoHAAAAAkBny9EJ/8ACyghAANAaBwAAAANQZs0NExDP/6plgAMuCEAA0BoHAAAAAtBn1JFFSwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBn3FEJ/8ACyghAANAaBwAAAAJAZ9zRCf/AAsoIQADQGgcIQADQGgcAAAADUGbeDRMQz/+qZYADLkhAANAaBwAAAALQZ+WRRUsK/8ACPghAANAaBwhAANAaBwAAAAJAZ+1RCf/AAspIQADQGgcAAAACQGft0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bm7w0TEM//qmWAAy4IQADQGgcAAAAC0Gf2kUVLCv/AAj5IQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHAAAAAkBn/tEJ/8ACykhAANAaBwAAAANQZvgNExDP/6plgAMuSEAA0BoHCEAA0BoHAAAAAtBnh5FFSwr/wAI+CEAA0BoHAAAAAkBnj1EJ/8ACyghAANAaBwhAANAaBwAAAAJAZ4/RCf/AAspIQADQGgcAAAADUGaJDRMQz/+qZYADLghAANAaBwAAAALQZ5CRRUsK/8ACPkhAANAaBwhAANAaBwAAAAJAZ5hRCf/AAsoIQADQGgcAAAACQGeY0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bmmg0TEM//qmWAAy5IQADQGgcAAAAC0GehkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGepUQn/wALKSEAA0BoHAAAAAkBnqdEJ/8ACyghAANAaBwAAAANQZqsNExDP/6plgAMuCEAA0BoHCEAA0BoHAAAAAtBnspFFSwr/wAI+SEAA0BoHAAAAAkBnulEJ/8ACyghAANAaBwhAANAaBwAAAAJAZ7rRCf/AAsoIQADQGgcAAAADUGa8DRMQz/+qZYADLkhAANAaBwhAANAaBwAAAALQZ8ORRUsK/8ACPkhAANAaBwAAAAJAZ8tRCf/AAspIQADQGgcIQADQGgcAAAACQGfL0Qn/wALKCEAA0BoHAAAAA1BmzQ0TEM//qmWAAy4IQADQGgcAAAAC0GfUkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGfcUQn/wALKCEAA0BoHAAAAAkBn3NEJ/8ACyghAANAaBwhAANAaBwAAAANQZt4NExC//6plgAMuSEAA0BoHAAAAAtBn5ZFFSwr/wAI+CEAA0BoHCEAA0BoHAAAAAkBn7VEJ/8ACykhAANAaBwAAAAJAZ+3RCf/AAspIQADQGgcAAAADUGbuzRMQn/+nhAAYsAhAANAaBwhAANAaBwAAAAJQZ/aQhP/AAspIQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHAAACiFtb292AAAAbG12aGQAAAAA1YCCX9WAgl8AAAPoAAAH/AABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAGGlvZHMAAAAAEICAgAcAT////v7/AAAF+XRyYWsAAABcdGtoZAAAAAPVgIJf1YCCXwAAAAEAAAAAAAAH0AAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAygAAAMoAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAB9AAABdwAAEAAAAABXFtZGlhAAAAIG1kaGQAAAAA1YCCX9WAgl8AAV+QAAK/IFXEAAAAAAAtaGRscgAAAAAAAAAAdmlkZQAAAAAAAAAAAAAAAFZpZGVvSGFuZGxlcgAAAAUcbWluZgAAABR2bWhkAAAAAQAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAAE3HN0YmwAAACYc3RzZAAAAAAAAAABAAAAiGF2YzEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAygDKAEgAAABIAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAY//8AAAAyYXZjQwFNQCj/4QAbZ01AKOyho3ySTUBAQFAAAAMAEAAr8gDxgxlgAQAEaO+G8gAAABhzdHRzAAAAAAAAAAEAAAA8AAALuAAAABRzdHNzAAAAAAAAAAEAAAABAAAB8GN0dHMAAAAAAAAAPAAAAAEAABdwAAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAAC7gAAAAAQAAF3AAAAABAAAAAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAEEc3RzegAAAAAAAAAAAAAAPAAAAzQAAAAQAAAADQAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAANAAAADQAAAQBzdGNvAAAAAAAAADwAAAAwAAADZAAAA3QAAAONAAADoAAAA7kAAAPQAAAD6wAAA/4AAAQXAAAELgAABEMAAARcAAAEbwAABIwAAAShAAAEugAABM0AAATkAAAE/wAABRIAAAUrAAAFQgAABV0AAAVwAAAFiQAABaAAAAW1AAAFzgAABeEAAAX+AAAGEwAABiwAAAY/AAAGVgAABnEAAAaEAAAGnQAABrQAAAbPAAAG4gAABvUAAAcSAAAHJwAAB0AAAAdTAAAHcAAAB4UAAAeeAAAHsQAAB8gAAAfjAAAH9gAACA8AAAgmAAAIQQAACFQAAAhnAAAIhAAACJcAAAMsdHJhawAAAFx0a2hkAAAAA9WAgl/VgIJfAAAAAgAAAAAAAAf8AAAAAAAAAAAAAAABAQAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAACsm1kaWEAAAAgbWRoZAAAAADVgIJf1YCCXwAArEQAAWAAVcQAAAAAACdoZGxyAAAAAAAAAABzb3VuAAAAAAAAAAAAAAAAU3RlcmVvAAAAAmNtaW5mAAAAEHNtaGQAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAidzdGJsAAAAZ3N0c2QAAAAAAAAAAQAAAFdtcDRhAAAAAAAAAAEAAAAAAAAAAAACABAAAAAArEQAAAAAADNlc2RzAAAAAAOAgIAiAAIABICAgBRAFQAAAAADDUAAAAAABYCAgAISEAaAgIABAgAAABhzdHRzAAAAAAAAAAEAAABYAAAEAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAAUc3RzegAAAAAAAAAGAAAAWAAAAXBzdGNvAAAAAAAAAFgAAAOBAAADhwAAA5oAAAOtAAADswAAA8oAAAPfAAAD5QAAA/gAAAQLAAAEEQAABCgAAAQ9AAAEUAAABFYAAARpAAAEgAAABIYAAASbAAAErgAABLQAAATHAAAE3gAABPMAAAT5AAAFDAAABR8AAAUlAAAFPAAABVEAAAVXAAAFagAABX0AAAWDAAAFmgAABa8AAAXCAAAFyAAABdsAAAXyAAAF+AAABg0AAAYgAAAGJgAABjkAAAZQAAAGZQAABmsAAAZ+AAAGkQAABpcAAAauAAAGwwAABskAAAbcAAAG7wAABwYAAAcMAAAHIQAABzQAAAc6AAAHTQAAB2QAAAdqAAAHfwAAB5IAAAeYAAAHqwAAB8IAAAfXAAAH3QAAB/AAAAgDAAAICQAACCAAAAg1AAAIOwAACE4AAAhhAAAIeAAACH4AAAiRAAAIpAAACKoAAAiwAAAItgAACLwAAAjCAAAAFnVkdGEAAAAObmFtZVN0ZXJlbwAAAHB1ZHRhAAAAaG1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAAO2lsc3QAAAAzqXRvbwAAACtkYXRhAAAAAQAAAABIYW5kQnJha2UgMC4xMC4yIDIwMTUwNjExMDA="}])})}),Ei=Kt(ti),Fi=1e3,Tr=[0,0,.5,1],hr=[.5,0,.5,1],Zi=window.requestAnimationFrame,bi=window.cancelAnimationFrame;function Bn(){this.leftProjectionMatrix=new Float32Array(16),this.leftViewMatrix=new Float32Array(16),this.rightProjectionMatrix=new Float32Array(16),this.rightViewMatrix=new Float32Array(16),this.pose=null}function Jn(W){Object.defineProperties(this,{hasPosition:{writable:!1,enumerable:!0,value:W.hasPosition},hasExternalDisplay:{writable:!1,enumerable:!0,value:W.hasExternalDisplay},canPresent:{writable:!1,enumerable:!0,value:W.canPresent},maxLayers:{writable:!1,enumerable:!0,value:W.maxLayers},hasOrientation:{enumerable:!0,get:function(){return Ce("VRDisplayCapabilities.prototype.hasOrientation","VRDisplay.prototype.getFrameData"),W.hasOrientation}}})}function Ri(W){W=W||{};var ue="wakelock"in W?W.wakelock:!0;this.isPolyfilled=!0,this.displayId=Fi++,this.displayName="",this.depthNear=.01,this.depthFar=1e4,this.isPresenting=!1,Object.defineProperty(this,"isConnected",{get:function(){return Ce("VRDisplay.prototype.isConnected","VRDisplayCapabilities.prototype.hasExternalDisplay"),!1}}),this.capabilities=new Jn({hasPosition:!1,hasOrientation:!1,hasExternalDisplay:!1,canPresent:!1,maxLayers:1}),this.stageParameters=null,this.waitingForPresent_=!1,this.layer_=null,this.originalParent_=null,this.fullscreenElement_=null,this.fullscreenWrapper_=null,this.fullscreenElementCachedStyle_=null,this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null,ue&&Ze()&&(this.wakelock_=new Ei)}Ri.prototype.getFrameData=function(W){return Ii(W,this._getPose(),this)},Ri.prototype.getPose=function(){return Ce("VRDisplay.prototype.getPose","VRDisplay.prototype.getFrameData"),this._getPose()},Ri.prototype.resetPose=function(){return Ce("VRDisplay.prototype.resetPose"),this._resetPose()},Ri.prototype.getImmediatePose=function(){return Ce("VRDisplay.prototype.getImmediatePose","VRDisplay.prototype.getFrameData"),this._getPose()},Ri.prototype.requestAnimationFrame=function(W){return Zi(W)},Ri.prototype.cancelAnimationFrame=function(W){return bi(W)},Ri.prototype.wrapForFullscreen=function(W){if(Q())return W;if(!this.fullscreenWrapper_){this.fullscreenWrapper_=document.createElement("div");var ue=["height: "+Math.min(screen.height,screen.width)+"px !important","top: 0 !important","left: 0 !important","right: 0 !important","border: 0","margin: 0","padding: 0","z-index: 999999 !important","position: fixed"];this.fullscreenWrapper_.setAttribute("style",ue.join("; ")+";"),this.fullscreenWrapper_.classList.add("webvr-polyfill-fullscreen-wrapper")}if(this.fullscreenElement_==W)return this.fullscreenWrapper_;if(this.fullscreenElement_&&(this.originalParent_?this.originalParent_.appendChild(this.fullscreenElement_):this.fullscreenElement_.parentElement.removeChild(this.fullscreenElement_)),this.fullscreenElement_=W,this.originalParent_=W.parentElement,this.originalParent_||document.body.appendChild(W),!this.fullscreenWrapper_.parentElement){var Ae=this.fullscreenElement_.parentElement;Ae.insertBefore(this.fullscreenWrapper_,this.fullscreenElement_),Ae.removeChild(this.fullscreenElement_)}this.fullscreenWrapper_.insertBefore(this.fullscreenElement_,this.fullscreenWrapper_.firstChild),this.fullscreenElementCachedStyle_=this.fullscreenElement_.getAttribute("style");var Se=this;function We(){if(Se.fullscreenElement_){var Ye=["position: absolute","top: 0","left: 0","width: "+Math.max(screen.width,screen.height)+"px","height: "+Math.min(screen.height,screen.width)+"px","border: 0","margin: 0","padding: 0"];Se.fullscreenElement_.setAttribute("style",Ye.join("; ")+";")}}return We(),this.fullscreenWrapper_},Ri.prototype.removeFullscreenWrapper=function(){if(this.fullscreenElement_){var W=this.fullscreenElement_;this.fullscreenElementCachedStyle_?W.setAttribute("style",this.fullscreenElementCachedStyle_):W.removeAttribute("style"),this.fullscreenElement_=null,this.fullscreenElementCachedStyle_=null;var ue=this.fullscreenWrapper_.parentElement;return this.fullscreenWrapper_.removeChild(W),this.originalParent_===ue?ue.insertBefore(W,this.fullscreenWrapper_):this.originalParent_&&this.originalParent_.appendChild(W),ue.removeChild(this.fullscreenWrapper_),W}},Ri.prototype.requestPresent=function(W){var ue=this.isPresenting,Ae=this;return W instanceof Array||(Ce("VRDisplay.prototype.requestPresent with non-array argument","an array of VRLayers as the first argument"),W=[W]),new Promise(function(Se,We){if(!Ae.capabilities.canPresent){We(new Error("VRDisplay is not capable of presenting."));return}if(W.length==0||W.length>Ae.capabilities.maxLayers){We(new Error("Invalid number of layers."));return}var Ye=W[0];if(!Ye.source){Se();return}var ft=Ye.leftBounds||Tr,he=Ye.rightBounds||hr;if(ue){var le=Ae.layer_;le.source!==Ye.source&&(le.source=Ye.source);for(var pe=0;pe<4;pe++)le.leftBounds[pe]=ft[pe],le.rightBounds[pe]=he[pe];Ae.wrapForFullscreen(Ae.layer_.source),Ae.updatePresent_(),Se();return}if(Ae.layer_={predistorted:Ye.predistorted,source:Ye.source,leftBounds:ft.slice(0),rightBounds:he.slice(0)},Ae.waitingForPresent_=!1,Ae.layer_&&Ae.layer_.source){var be=Ae.wrapForFullscreen(Ae.layer_.source),Ee=function(){var Ct=At();Ae.isPresenting=be===Ct,Ae.isPresenting?(screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape-primary").catch(function(Ht){console.error("screen.orientation.lock() failed due to",Ht.message)}),Ae.waitingForPresent_=!1,Ae.beginPresent_(),Se()):(screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),Ae.removeFullscreenWrapper(),Ae.disableWakeLock(),Ae.endPresent_(),Ae.removeFullscreenListeners_()),Ae.fireVRDisplayPresentChange_()},st=function(){Ae.waitingForPresent_&&(Ae.removeFullscreenWrapper(),Ae.removeFullscreenListeners_(),Ae.disableWakeLock(),Ae.waitingForPresent_=!1,Ae.isPresenting=!1,We(new Error("Unable to present.")))};Ae.addFullscreenListeners_(be,Ee,st),$e(be)?(Ae.enableWakeLock(),Ae.waitingForPresent_=!0):(Q()||H())&&(Ae.enableWakeLock(),Ae.isPresenting=!0,Ae.beginPresent_(),Ae.fireVRDisplayPresentChange_(),Se())}!Ae.waitingForPresent_&&!Q()&&(lt(),We(new Error("Unable to present.")))})},Ri.prototype.exitPresent=function(){var W=this.isPresenting,ue=this;return this.isPresenting=!1,this.layer_=null,this.disableWakeLock(),new Promise(function(Ae,Se){W?(!lt()&&Q()&&(ue.endPresent_(),ue.fireVRDisplayPresentChange_()),H()&&(ue.removeFullscreenWrapper(),ue.removeFullscreenListeners_(),ue.endPresent_(),ue.fireVRDisplayPresentChange_()),Ae()):Se(new Error("Was not presenting to VRDisplay."))})},Ri.prototype.getLayers=function(){return this.layer_?[this.layer_]:[]},Ri.prototype.fireVRDisplayPresentChange_=function(){var W=new CustomEvent("vrdisplaypresentchange",{detail:{display:this}});window.dispatchEvent(W)},Ri.prototype.fireVRDisplayConnect_=function(){var W=new CustomEvent("vrdisplayconnect",{detail:{display:this}});window.dispatchEvent(W)},Ri.prototype.addFullscreenListeners_=function(W,ue,Ae){this.removeFullscreenListeners_(),this.fullscreenEventTarget_=W,this.fullscreenChangeHandler_=ue,this.fullscreenErrorHandler_=Ae,ue&&(document.fullscreenEnabled?W.addEventListener("fullscreenchange",ue,!1):document.webkitFullscreenEnabled?W.addEventListener("webkitfullscreenchange",ue,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenchange",ue,!1):document.msFullscreenEnabled&&W.addEventListener("msfullscreenchange",ue,!1)),Ae&&(document.fullscreenEnabled?W.addEventListener("fullscreenerror",Ae,!1):document.webkitFullscreenEnabled?W.addEventListener("webkitfullscreenerror",Ae,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenerror",Ae,!1):document.msFullscreenEnabled&&W.addEventListener("msfullscreenerror",Ae,!1))},Ri.prototype.removeFullscreenListeners_=function(){if(this.fullscreenEventTarget_){var W=this.fullscreenEventTarget_;if(this.fullscreenChangeHandler_){var ue=this.fullscreenChangeHandler_;W.removeEventListener("fullscreenchange",ue,!1),W.removeEventListener("webkitfullscreenchange",ue,!1),document.removeEventListener("mozfullscreenchange",ue,!1),W.removeEventListener("msfullscreenchange",ue,!1)}if(this.fullscreenErrorHandler_){var Ae=this.fullscreenErrorHandler_;W.removeEventListener("fullscreenerror",Ae,!1),W.removeEventListener("webkitfullscreenerror",Ae,!1),document.removeEventListener("mozfullscreenerror",Ae,!1),W.removeEventListener("msfullscreenerror",Ae,!1)}this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null}},Ri.prototype.enableWakeLock=function(){this.wakelock_&&this.wakelock_.enable()},Ri.prototype.disableWakeLock=function(){this.wakelock_&&this.wakelock_.disable()},Ri.prototype.beginPresent_=function(){},Ri.prototype.endPresent_=function(){},Ri.prototype.submitFrame=function(W){},Ri.prototype.getEyeParameters=function(W){return null};var or={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",MOBILE_WAKE_LOCK:!0,DEBUG:!1,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1},pn={LEFT:"left",RIGHT:"right"};function Yr(W){var ue=Ui({},or);W=Ui(ue,W||{}),Ri.call(this,{wakelock:W.MOBILE_WAKE_LOCK}),this.config=W,this.displayName="Cardboard VRDisplay",this.capabilities=new Jn({hasPosition:!1,hasOrientation:!0,hasExternalDisplay:!1,canPresent:!0,maxLayers:1}),this.stageParameters=null,this.bufferScale_=this.config.BUFFER_SCALE,this.poseSensor_=new se(this.config),this.distorter_=null,this.cardboardUI_=null,this.dpdb_=new bs(this.config.DPDB_URL,this.onDeviceParamsUpdated_.bind(this)),this.deviceInfo_=new Ur(this.dpdb_.getDeviceParams(),W.ADDITIONAL_VIEWERS),this.viewerSelector_=new wt(W.DEFAULT_VIEWER),this.viewerSelector_.onChange(this.onViewerChanged_.bind(this)),this.deviceInfo_.setViewer(this.viewerSelector_.getCurrentViewer()),this.config.ROTATE_INSTRUCTIONS_DISABLED||(this.rotateInstructions_=new Ne),Q()&&window.addEventListener("resize",this.onResize_.bind(this))}return Yr.prototype=Object.create(Ri.prototype),Yr.prototype._getPose=function(){return{position:null,orientation:this.poseSensor_.getOrientation(),linearVelocity:null,linearAcceleration:null,angularVelocity:null,angularAcceleration:null}},Yr.prototype._resetPose=function(){this.poseSensor_.resetPose&&this.poseSensor_.resetPose()},Yr.prototype._getFieldOfView=function(W){var ue;if(W==pn.LEFT)ue=this.deviceInfo_.getFieldOfViewLeftEye();else if(W==pn.RIGHT)ue=this.deviceInfo_.getFieldOfViewRightEye();else return console.error("Invalid eye provided: %s",W),null;return ue},Yr.prototype._getEyeOffset=function(W){var ue;if(W==pn.LEFT)ue=[-this.deviceInfo_.viewer.interLensDistance*.5,0,0];else if(W==pn.RIGHT)ue=[this.deviceInfo_.viewer.interLensDistance*.5,0,0];else return console.error("Invalid eye provided: %s",W),null;return ue},Yr.prototype.getEyeParameters=function(W){var ue=this._getEyeOffset(W),Ae=this._getFieldOfView(W),Se={offset:ue,renderWidth:this.deviceInfo_.device.width*.5*this.bufferScale_,renderHeight:this.deviceInfo_.device.height*this.bufferScale_};return Object.defineProperty(Se,"fieldOfView",{enumerable:!0,get:function(){return Ce("VRFieldOfView","VRFrameData's projection matrices"),Ae}}),Se},Yr.prototype.onDeviceParamsUpdated_=function(W){this.config.DEBUG&&console.log("DPDB reported that device params were updated."),this.deviceInfo_.updateDeviceParams(W),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_)},Yr.prototype.updateBounds_=function(){this.layer_&&this.distorter_&&(this.layer_.leftBounds||this.layer_.rightBounds)&&this.distorter_.setTextureBounds(this.layer_.leftBounds,this.layer_.rightBounds)},Yr.prototype.beginPresent_=function(){var W=this.layer_.source.getContext("webgl");W||(W=this.layer_.source.getContext("experimental-webgl")),W||(W=this.layer_.source.getContext("webgl2")),W&&(this.layer_.predistorted?this.config.CARDBOARD_UI_DISABLED||(W.canvas.width=Ge()*this.bufferScale_,W.canvas.height=Xe()*this.bufferScale_,this.cardboardUI_=new Ue(W)):(this.config.CARDBOARD_UI_DISABLED||(this.cardboardUI_=new Ue(W)),this.distorter_=new _i(W,this.cardboardUI_,this.config.BUFFER_SCALE,this.config.DIRTY_SUBMIT_FRAME_BINDINGS),this.distorter_.updateDeviceInfo(this.deviceInfo_)),this.cardboardUI_&&this.cardboardUI_.listen((function(ue){this.viewerSelector_.show(this.layer_.source.parentElement),ue.stopPropagation(),ue.preventDefault()}).bind(this),(function(ue){this.exitPresent(),ue.stopPropagation(),ue.preventDefault()}).bind(this)),this.rotateInstructions_&&(de()&&Ze()?this.rotateInstructions_.showTemporarily(3e3,this.layer_.source.parentElement):this.rotateInstructions_.update()),this.orientationHandler=this.onOrientationChange_.bind(this),window.addEventListener("orientationchange",this.orientationHandler),this.vrdisplaypresentchangeHandler=this.updateBounds_.bind(this),window.addEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler),this.fireVRDisplayDeviceParamsChange_())},Yr.prototype.endPresent_=function(){this.distorter_&&(this.distorter_.destroy(),this.distorter_=null),this.cardboardUI_&&(this.cardboardUI_.destroy(),this.cardboardUI_=null),this.rotateInstructions_&&this.rotateInstructions_.hide(),this.viewerSelector_.hide(),window.removeEventListener("orientationchange",this.orientationHandler),window.removeEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler)},Yr.prototype.updatePresent_=function(){this.endPresent_(),this.beginPresent_()},Yr.prototype.submitFrame=function(W){if(this.distorter_)this.updateBounds_(),this.distorter_.submitFrame();else if(this.cardboardUI_&&this.layer_){var ue=this.layer_.source.getContext("webgl");ue||(ue=this.layer_.source.getContext("experimental-webgl")),ue||(ue=this.layer_.source.getContext("webgl2"));var Ae=ue.canvas;(Ae.width!=this.lastWidth||Ae.height!=this.lastHeight)&&this.cardboardUI_.onResize(),this.lastWidth=Ae.width,this.lastHeight=Ae.height,this.cardboardUI_.render()}},Yr.prototype.onOrientationChange_=function(W){this.viewerSelector_.hide(),this.rotateInstructions_&&this.rotateInstructions_.update(),this.onResize_()},Yr.prototype.onResize_=function(W){if(this.layer_){var ue=this.layer_.source.getContext("webgl");ue||(ue=this.layer_.source.getContext("experimental-webgl")),ue||(ue=this.layer_.source.getContext("webgl2"));var Ae=["position: absolute","top: 0","left: 0","width: 100vw","height: 100vh","border: 0","margin: 0","padding: 0px","box-sizing: content-box"];ue.canvas.setAttribute("style",Ae.join("; ")+";"),di(ue.canvas)}},Yr.prototype.onViewerChanged_=function(W){this.deviceInfo_.setViewer(W),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_),this.fireVRDisplayDeviceParamsChange_()},Yr.prototype.fireVRDisplayDeviceParamsChange_=function(){var W=new CustomEvent("vrdisplaydeviceparamschange",{detail:{vrdisplay:this,deviceInfo:this.deviceInfo_}});window.dispatchEvent(W)},Yr.VRFrameData=Bn,Yr.VRDisplay=Ri,Yr})}),v=p(x),_="0.10.12",T={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",PROVIDE_MOBILE_VRDISPLAY:!0,MOBILE_WAKE_LOCK:!0,DEBUG:!1,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1};function w(I){this.config=y(y({},T),I),this.polyfillDisplays=[],this.enabled=!1,this.hasNative="getVRDisplays"in navigator,this.native={},this.native.getVRDisplays=navigator.getVRDisplays,this.native.VRFrameData=window.VRFrameData,this.native.VRDisplay=window.VRDisplay,(!this.hasNative||this.config.PROVIDE_MOBILE_VRDISPLAY&&m())&&(this.enable(),this.getVRDisplays().then(function(D){D&&D[0]&&D[0].fireVRDisplayConnect_&&D[0].fireVRDisplayConnect_()}))}w.prototype.getPolyfillDisplays=function(){if(this._polyfillDisplaysPopulated)return this.polyfillDisplays;if(m()){var I=new v({ADDITIONAL_VIEWERS:this.config.ADDITIONAL_VIEWERS,DEFAULT_VIEWER:this.config.DEFAULT_VIEWER,MOBILE_WAKE_LOCK:this.config.MOBILE_WAKE_LOCK,DEBUG:this.config.DEBUG,DPDB_URL:this.config.DPDB_URL,CARDBOARD_UI_DISABLED:this.config.CARDBOARD_UI_DISABLED,K_FILTER:this.config.K_FILTER,PREDICTION_TIME_S:this.config.PREDICTION_TIME_S,ROTATE_INSTRUCTIONS_DISABLED:this.config.ROTATE_INSTRUCTIONS_DISABLED,YAW_ONLY:this.config.YAW_ONLY,BUFFER_SCALE:this.config.BUFFER_SCALE,DIRTY_SUBMIT_FRAME_BINDINGS:this.config.DIRTY_SUBMIT_FRAME_BINDINGS});this.polyfillDisplays.push(I)}return this._polyfillDisplaysPopulated=!0,this.polyfillDisplays},w.prototype.enable=function(){if(this.enabled=!0,this.hasNative&&this.native.VRFrameData){var I=this.native.VRFrameData,D=new this.native.VRFrameData,L=this.native.VRDisplay.prototype.getFrameData;window.VRDisplay.prototype.getFrameData=function(O){if(O instanceof I){L.call(this,O);return}L.call(this,D),O.pose=D.pose,g(D.leftProjectionMatrix,O.leftProjectionMatrix),g(D.rightProjectionMatrix,O.rightProjectionMatrix),g(D.leftViewMatrix,O.leftViewMatrix),g(D.rightViewMatrix,O.rightViewMatrix)}}navigator.getVRDisplays=this.getVRDisplays.bind(this),window.VRDisplay=v.VRDisplay,window.VRFrameData=v.VRFrameData},w.prototype.getVRDisplays=function(){var I=this;return this.config,this.hasNative?this.native.getVRDisplays.call(navigator).then(function(D){return D.length>0?D:I.getPolyfillDisplays()}):Promise.resolve(this.getPolyfillDisplays())},w.version=_,w.VRFrameData=v.VRFrameData,w.VRDisplay=v.VRDisplay;var S=Object.freeze({default:w}),R=S&&w||S;typeof h<"u"&&h.window&&(h.document||(h.document=h.window.document),h.navigator||(h.navigator=h.window.navigator));var B=R;return B})},"./node_modules/word-wrapper/index.js":l=>{var u=/\n/,c=`
`,h=/\s/;l.exports=function(x,v){var _=l.exports.lines(x,v);return _.map(function(T){return x.substring(T.start,T.end)}).join(`
`)},l.exports.lines=function(x,v){if(v=v||{},v.width===0&&v.mode!=="nowrap")return[];x=x||"";var _=typeof v.width=="number"?v.width:Number.MAX_VALUE,T=Math.max(0,v.start||0),w=typeof v.end=="number"?v.end:x.length,S=v.mode,R=v.measure||y;return S==="pre"?m(R,x,T,w,_):g(R,x,T,w,_,S)};function p(x,v,_,T){var w=x.indexOf(v,_);return w===-1||w>T?T:w}function f(x){return h.test(x)}function m(x,v,_,T,w){for(var S=[],R=_,B=_;B<T&&B<v.length;B++){var I=v.charAt(B),D=u.test(I);if(D||B===T-1){var L=D?B:B+1,O=x(v,R,L,w);S.push(O),R=B+1}}return S}function g(x,v,_,T,w,S){var R=[],B=w;for(S==="nowrap"&&(B=Number.MAX_VALUE);_<T&&_<v.length;){for(var I=p(v,c,_,T);_<I&&f(v.charAt(_));)_++;var D=x(v,_,I,B),L=_+(D.end-D.start),O=L+c.length;if(L<I){for(;L>_&&!f(v.charAt(L));)L--;if(L===_)O>_+c.length&&O--,L=O;else for(O=L;L>_&&f(v.charAt(L-c.length));)L--}if(L>=_){var U=x(v,_,L,B);R.push(U)}_=O}return R}function y(x,v,_,T){var w=Math.min(T,_-v);return{start:v,end:v+w}}},"./node_modules/xhr/index.js":(l,u,c)=>{var h=c("./node_modules/global/window.js"),p=c("./node_modules/is-function/index.js"),f=c("./node_modules/parse-headers/parse-headers.js"),m=c("./node_modules/xtend/immutable.js");l.exports=v,l.exports.default=v,v.XMLHttpRequest=h.XMLHttpRequest||w,v.XDomainRequest="withCredentials"in new v.XMLHttpRequest?v.XMLHttpRequest:h.XDomainRequest,g(["get","put","post","patch","head","delete"],function(S){v[S==="delete"?"del":S]=function(R,B,I){return B=x(R,B,I),B.method=S.toUpperCase(),_(B)}});function g(S,R){for(var B=0;B<S.length;B++)R(S[B])}function y(S){for(var R in S)if(S.hasOwnProperty(R))return!1;return!0}function x(S,R,B){var I=S;return p(R)?(B=R,typeof S=="string"&&(I={uri:S})):I=m(R,{uri:S}),I.callback=B,I}function v(S,R,B){return R=x(S,R,B),_(R)}function _(S){if(typeof S.callback>"u")throw new Error("callback argument missing");var R=!1,B=function(xe,fe,de){R||(R=!0,S.callback(xe,fe,de))};function I(){U.readyState===4&&setTimeout(O,0)}function D(){var xe=void 0;if(U.response?xe=U.response:xe=U.responseText||T(U),ne)try{xe=JSON.parse(xe)}catch{}return xe}function L(xe){return clearTimeout(Y),xe instanceof Error||(xe=new Error(""+(xe||"Unknown XMLHttpRequest Error"))),xe.statusCode=0,B(xe,ae)}function O(){if(!G){var xe;clearTimeout(Y),S.useXDR&&U.status===void 0?xe=200:xe=U.status===1223?204:U.status;var fe=ae,de=null;return xe!==0?(fe={body:D(),statusCode:xe,method:$,headers:{},url:z,rawRequest:U},U.getAllResponseHeaders&&(fe.headers=f(U.getAllResponseHeaders()))):de=new Error("Internal XMLHttpRequest Error"),B(de,fe,fe.body)}}var U=S.xhr||null;U||(S.cors||S.useXDR?U=new v.XDomainRequest:U=new v.XMLHttpRequest);var Z,G,z=U.url=S.uri||S.url,$=U.method=S.method||"GET",Q=S.body||S.data,H=U.headers=S.headers||{},V=!!S.sync,ne=!1,Y,ae={body:void 0,headers:{},statusCode:0,method:$,url:z,rawRequest:U};if("json"in S&&S.json!==!1&&(ne=!0,H.accept||H.Accept||(H.Accept="application/json"),$!=="GET"&&$!=="HEAD"&&(H["content-type"]||H["Content-Type"]||(H["Content-Type"]="application/json"),Q=JSON.stringify(S.json===!0?Q:S.json))),U.onreadystatechange=I,U.onload=O,U.onerror=L,U.onprogress=function(){},U.onabort=function(){G=!0},U.ontimeout=L,U.open($,z,!V,S.username,S.password),V||(U.withCredentials=!!S.withCredentials),!V&&S.timeout>0&&(Y=setTimeout(function(){if(!G){G=!0,U.abort("timeout");var xe=new Error("XMLHttpRequest timeout");xe.code="ETIMEDOUT",L(xe)}},S.timeout)),U.setRequestHeader)for(Z in H)H.hasOwnProperty(Z)&&U.setRequestHeader(Z,H[Z]);else if(S.headers&&!y(S.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in S&&(U.responseType=S.responseType),"beforeSend"in S&&typeof S.beforeSend=="function"&&S.beforeSend(U),U.send(Q||null),U}function T(S){try{if(S.responseType==="document")return S.responseXML;var R=S.responseXML&&S.responseXML.documentElement.nodeName==="parsererror";if(S.responseType===""&&!R)return S.responseXML}catch{}return null}function w(){}},"./node_modules/xml-parse-from-string/index.js":l=>{l.exports=function(){return typeof self.DOMParser<"u"?function(u){var c=new self.DOMParser;return c.parseFromString(u,"application/xml")}:typeof self.ActiveXObject<"u"&&new self.ActiveXObject("Microsoft.XMLDOM")?function(u){var c=new self.ActiveXObject("Microsoft.XMLDOM");return c.async="false",c.loadXML(u),c}:function(u){var c=document.createElement("div");return c.innerHTML=u,c}}()},"./node_modules/xtend/immutable.js":l=>{l.exports=c;var u=Object.prototype.hasOwnProperty;function c(){for(var h={},p=0;p<arguments.length;p++){var f=arguments[p];for(var m in f)u.call(f,m)&&(h[m]=f[m])}return h}},"./src/components/anchored.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent,p=c("./src/utils/index.js"),f=p.debug("components:anchored:warn");l.exports.Component=h("anchored",{schema:{persistent:{default:!1}},init:function(){var g=this.el.sceneEl,y=g.getAttribute("webxr"),x=y.optionalFeatures;x.indexOf("anchors")===-1&&(x.push("anchors"),this.el.sceneEl.setAttribute("webxr",y)),this.auxQuaternion=new THREE.Quaternion,this.onEnterVR=this.onEnterVR.bind(this),this.el.sceneEl.addEventListener("enter-vr",this.onEnterVR)},onEnterVR:function(){this.anchor=void 0,this.requestPersistentAnchorPending=this.data.persistent,this.requestAnchorPending=!this.data.persistent},tick:function(){var g=this.el.sceneEl,y=g.renderer.xr,x,v,_,T=this.el.object3D;!g.is("ar-mode")&&!g.is("vr-mode")||(!this.anchor&&this.requestPersistentAnchorPending&&this.restorePersistentAnchor(),!this.anchor&&this.requestAnchorPending&&this.createAnchor(),this.anchor&&(x=g.frame,v=y.getReferenceSpace(),_=x.getPose(this.anchor.anchorSpace,v),T.matrix.elements=_.transform.matrix,T.matrix.decompose(T.position,T.rotation,T.scale)))},createAnchor:async function(g,y){var x=this.el.sceneEl,v=x.renderer.xr,_,T,w,S,R=this.el.object3D;if(g=g||R.position,y=y||this.auxQuaternion.setFromEuler(R.rotation),!m(x)){f("This browser doesn't support the WebXR anchors module");return}this.anchor&&this.deleteAnchor(),_=x.frame,T=v.getReferenceSpace(),w=new XRRigidTransform({x:g.x,y:g.y,z:g.z},{x:y.x,y:y.y,z:y.z,w:y.w}),this.requestAnchorPending=!1,S=await _.createAnchor(w,T),this.data.persistent&&(this.el.id?(this.persistentHandle=await S.requestPersistentHandle(),localStorage.setItem(this.el.id,this.persistentHandle)):f("The anchor won't be persisted because the entity has no assigned id.")),x.object3D.attach(this.el.object3D),this.anchor=S},restorePersistentAnchor:async function(){var g=this.el.sceneEl.renderer.xr,y=g.getSession(),x=y.persistentAnchors,v;if(this.requestPersistentAnchorPending=!1,!this.el.id){f("The entity associated to the persistent anchor cannot be retrieved because it doesn't have an assigned id."),this.requestAnchorPending=!0;return}if(x){v=localStorage.getItem(this.el.id);for(var _=0;_<x.length;++_)if(v===x[_]){this.anchor=await y.restorePersistentAnchor(x[_]),this.anchor&&(this.persistentHandle=x[_]);break}this.anchor||(this.requestAnchorPending=!0)}else this.requestPersistentAnchorPending=!0},deleteAnchor:function(){var g,y,x=this.anchor;x&&(g=this.el.sceneEl.renderer.xr,y=g.getSession(),x.delete(),this.el.sceneEl.object3D.add(this.el.object3D),this.persistentHandle&&y.deletePersistentAnchor(this.persistentHandle),this.anchor=void 0)}});function m(g){var y=g.renderer.xr,x=y.getSession();return x&&x.restorePersistentAnchor}},"./src/components/animation.js":(l,u,c)=>{var h=c("./node_modules/super-animejs/lib/anime.es.js").default,p=c("./src/core/component.js").components,f=c("./src/core/component.js").registerComponent,m=c("./src/lib/three.js"),g=c("./src/utils/index.js"),y=new m.Color,x=new m.Color,v=g.entity.getComponentProperty,_=g.entity.setComponentProperty,T={},w="color",S="position",R="rotation",B="scale",I="components",D="object3D";l.exports.Component=f("animation",{schema:{autoplay:{default:!0},delay:{default:0},dir:{default:""},dur:{default:1e3},easing:{default:"easeInQuad"},elasticity:{default:400},enabled:{default:!0},from:{default:""},loop:{default:0,parse:function(H){return H===!0||H==="true"?!0:H===!1||H==="false"?!1:parseInt(H,10)}},property:{default:""},startEvents:{type:"array"},pauseEvents:{type:"array"},resumeEvents:{type:"array"},round:{default:!1},to:{default:""},type:{default:""},isRawProperty:{default:!1}},multiple:!0,init:function(){var H=this;this.eventDetail={name:this.attrName},this.time=0,this.animation=null,this.animationIsPlaying=!1,this.onStartEvent=this.onStartEvent.bind(this),this.beginAnimation=this.beginAnimation.bind(this),this.pauseAnimation=this.pauseAnimation.bind(this),this.resumeAnimation=this.resumeAnimation.bind(this),this.fromColor={},this.toColor={},this.targets={},this.targetsArray=[],this.updateConfigForDefault=this.updateConfigForDefault.bind(this),this.updateConfigForRawColor=this.updateConfigForRawColor.bind(this),this.config={complete:function(){H.animationIsPlaying=!1,H.el.emit("animationcomplete",H.eventDetail,!1),H.id&&H.el.emit("animationcomplete__"+H.id,H.eventDetail,!1)}}},update:function(H){var V=this.config,ne=this.data;this.animationIsPlaying=!1,this.data.enabled&&ne.property&&(V.autoplay=!1,V.direction=ne.dir,V.duration=ne.dur,V.easing=ne.easing,V.elasticity=ne.elasticity,V.loop=ne.loop,V.round=ne.round,this.createAndStartAnimation())},tick:function(H,V){this.animationIsPlaying&&(this.time+=V,this.animation.tick(this.time))},remove:function(){this.pauseAnimation(),this.removeEventListeners()},pause:function(){this.paused=!0,this.pausedWasPlaying=this.animationIsPlaying,this.pauseAnimation(),this.removeEventListeners()},play:function(){this.paused&&(this.paused=!1,this.addEventListeners(),this.pausedWasPlaying&&(this.resumeAnimation(),this.pausedWasPlaying=!1))},createAndStartAnimation:function(){var H=this.data;if(this.updateConfig(),this.animationIsPlaying=!1,this.animation=h(this.config),this.animation.began=!0,this.removeEventListeners(),this.addEventListeners(),!(!H.autoplay||H.startEvents&&H.startEvents.length)){if(H.delay){setTimeout(this.beginAnimation,H.delay);return}this.beginAnimation()}},beginAnimation:function(){this.updateConfig(),this.animation.began=!0,this.time=0,this.animationIsPlaying=!0,this.stopRelatedAnimations(),this.el.emit("animationbegin",this.eventDetail,!1)},pauseAnimation:function(){this.animationIsPlaying=!1},resumeAnimation:function(){this.animationIsPlaying=!0},onStartEvent:function(){if(this.data.enabled){if(this.updateConfig(),this.animation&&this.animation.pause(),this.animation=h(this.config),this.data.delay){setTimeout(this.beginAnimation,this.data.delay);return}this.beginAnimation()}},updateConfigForRawColor:function(){var H=this.config,V=this.data,ne=this.el,Y,ae,xe;if(!this.waitComponentInitRawProperty(this.updateConfigForRawColor)){Y=V.from===""?G(ne,V.property):V.from,xe=V.to,this.setColorConfig(Y,xe),Y=this.fromColor,xe=this.toColor,this.targetsArray.length=0,this.targetsArray.push(Y),H.targets=this.targetsArray;for(ae in xe)H[ae]=xe[ae];H.update=function(){var fe={};return function(de){var Ie;Ie=de.animatables[0].target,!(Ie.r===fe.r&&Ie.g===fe.g&&Ie.b===fe.b)&&z(ne,V.property,Ie,V.type)}}()}},updateConfigForDefault:function(){var H=this.config,V=this.data,ne=this.el,Y,ae,xe,fe;this.waitComponentInitRawProperty(this.updateConfigForDefault)||(V.from===""?Y=Q(V)?G(ne,V.property):v(ne,V.property):Y=V.from,fe=V.to,xe=!isNaN(Y||fe),xe?(Y=parseFloat(Y),fe=parseFloat(fe)):(Y=Y&&Y.toString(),fe=fe&&fe.toString()),ae=V.to==="true"||V.to==="false"||V.to===!0||V.to===!1,ae&&(Y=V.from==="true"||V.from===!0?1:0,fe=V.to==="true"||V.to===!0?1:0),this.targets.aframeProperty=Y,H.targets=this.targets,H.aframeProperty=fe,H.update=function(){var de;return function(Ie){var Ge;Ge=Ie.animatables[0].target.aframeProperty,Ge!==de&&(de=Ge,ae&&(Ge=Ge>=1),Q(V)?z(ne,V.property,Ge,V.type):_(ne,V.property,Ge))}}())},updateConfigForVector:function(){var H=this.config,V=this.data,ne=this.el,Y,ae,xe;ae=V.from!==""?g.coordinates.parse(V.from):v(ne,V.property),xe=g.coordinates.parse(V.to),V.property===R&&(O(ae),O(xe)),this.targetsArray.length=0,this.targetsArray.push(ae),H.targets=this.targetsArray;for(Y in xe)H[Y]=xe[Y];if(V.property===S||V.property===R||V.property===B){H.update=function(){var fe={};return function(de){var Ie=de.animatables[0].target;Ie.x===fe.x&&Ie.y===fe.y&&Ie.z===fe.z||(fe.x=Ie.x,fe.y=Ie.y,fe.z=Ie.z,ne.object3D[V.property].set(Ie.x,Ie.y,Ie.z))}}();return}H.update=function(){var fe={};return function(de){var Ie=de.animatables[0].target;Ie.x===fe.x&&Ie.y===fe.y&&Ie.z===fe.z||(fe.x=Ie.x,fe.y=Ie.y,fe.z=Ie.z,_(ne,V.property,Ie))}}()},updateConfig:function(){var H;H=L(this.el,this.data.property),Q(this.data)&&this.data.type===w?this.updateConfigForRawColor():H==="vec2"||H==="vec3"||H==="vec4"?this.updateConfigForVector():this.updateConfigForDefault()},waitComponentInitRawProperty:function(H){var V,ne=this.data,Y=this.el,ae=this;return ne.from!==""||!ne.property.startsWith(I)||(V=$(ne.property)[1],Y.components[V])?!1:(Y.addEventListener("componentinitialized",function xe(fe){fe.detail.name===V&&(H(),ae.animation=h(ae.config),Y.removeEventListener("componentinitialized",xe))}),!0)},stopRelatedAnimations:function(){var H,V;for(V in this.el.components)H=this.el.components[V],V!==this.attrName&&H.name==="animation"&&H.animationIsPlaying&&H.data.property===this.data.property&&(H.animationIsPlaying=!1)},addEventListeners:function(){var H=this.data,V=this.el;U(V,H.startEvents,this.onStartEvent),U(V,H.pauseEvents,this.pauseAnimation),U(V,H.resumeEvents,this.resumeAnimation)},removeEventListeners:function(){var H=this.data,V=this.el;Z(V,H.startEvents,this.onStartEvent),Z(V,H.pauseEvents,this.pauseAnimation),Z(V,H.resumeEvents,this.resumeAnimation)},setColorConfig:function(H,V){y.set(H),x.set(V),H=this.fromColor,V=this.toColor,H.r=y.r,H.g=y.g,H.b=y.b,V.r=x.r,V.g=x.g,V.b=x.b}});function L(H,V){var ne,Y,ae,xe;return ae=V.split("."),Y=ae[0],xe=ae[1],ne=H.components[Y]||p[Y],!ne||xe&&!ne.schema[xe]?null:xe?ne.schema[xe].type:ne.schema.type}function O(H){H.x=m.MathUtils.degToRad(H.x),H.y=m.MathUtils.degToRad(H.y),H.z=m.MathUtils.degToRad(H.z)}function U(H,V,ne){var Y;for(Y=0;Y<V.length;Y++)H.addEventListener(V[Y],ne)}function Z(H,V,ne){var Y;for(Y=0;Y<V.length;Y++)H.removeEventListener(V[Y],ne)}function G(H,V){var ne,Y,ae;for(Y=$(V),ae=H,ne=0;ne<Y.length;ne++)ae=ae[Y[ne]];if(ae===void 0)throw console.log(H),new Error("[animation] property ("+V+") could not be found");return ae}function z(H,V,ne,Y){var ae,xe,fe,de;for(V.startsWith("object3D.rotation")&&(ne=m.MathUtils.degToRad(ne)),xe=$(V),de=H,ae=0;ae<xe.length-1;ae++)de=de[xe[ae]];if(fe=xe[xe.length-1],Y===w){"r"in de[fe]?(de[fe].r=ne.r,de[fe].g=ne.g,de[fe].b=ne.b):(de[fe].x=ne.r,de[fe].y=ne.g,de[fe].z=ne.b);return}de[fe]=ne}function $(H){return H in T||(T[H]=H.split(".")),T[H]}function Q(H){return H.isRawProperty||H.property.startsWith(I)||H.property.startsWith(D)}},"./src/components/camera.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent,p=c("./src/lib/three.js");l.exports.Component=h("camera",{schema:{active:{default:!0},far:{default:1e4},fov:{default:80,min:0},near:{default:.005,min:0},spectator:{default:!1},zoom:{default:1,min:0}},init:function(){var f,m=this.el;f=this.camera=new p.PerspectiveCamera,m.setObject3D("camera",f)},update:function(f){var m=this.data,g=this.camera;g.aspect=m.aspect||window.innerWidth/window.innerHeight,g.far=m.far,g.fov=m.fov,g.near=m.near,g.zoom=m.zoom,g.updateProjectionMatrix(),this.updateActiveCamera(f),this.updateSpectatorCamera(f)},updateActiveCamera:function(f){var m=this.data,g=this.el,y=this.system;f&&f.active===m.active||m.spectator||(m.active&&y.activeCameraEl!==g?y.setActiveCamera(g):!m.active&&y.activeCameraEl===g&&y.disableActiveCamera())},updateSpectatorCamera:function(f){var m=this.data,g=this.el,y=this.system;f&&f.spectator===m.spectator||(m.spectator&&y.spectatorCameraEl!==g?y.setSpectatorCamera(g):!m.spectator&&y.spectatorCameraEl===g&&y.disableSpectatorCamera())},remove:function(){this.el.removeObject3D("camera")}})},"./src/components/cursor.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent,p=c("./src/utils/index.js"),f={CLICK:"click",FUSING:"fusing",MOUSEENTER:"mouseenter",MOUSEDOWN:"mousedown",MOUSELEAVE:"mouseleave",MOUSEUP:"mouseup"},m={FUSING:"cursor-fusing",HOVERING:"cursor-hovering",HOVERED:"cursor-hovered"},g={DOWN:["mousedown","touchstart"],UP:["mouseup","touchend"]},y={DOWN:["selectstart"],UP:["selectend"]},x="a-mouse-cursor-hover";l.exports.Component=h("cursor",{dependencies:["raycaster"],schema:{downEvents:{default:[]},fuse:{default:p.device.isMobile()},fuseTimeout:{default:1500,min:0},mouseCursorStylesEnabled:{default:!0},upEvents:{default:[]},rayOrigin:{default:"entity",oneOf:["mouse","entity","xrselect"]}},after:["tracked-controls"],multiple:!0,init:function(){var v=this;this.fuseTimeout=void 0,this.cursorDownEl=null,this.intersectedEl=null,this.canvasBounds=document.body.getBoundingClientRect(),this.isCursorDown=!1,this.activeXRInput=null,this.updateCanvasBounds=p.debounce(function(){v.canvasBounds=v.el.sceneEl.canvas.getBoundingClientRect()},500),this.eventDetail={},this.intersectedEventDetail={cursorEl:this.el},this.onCursorDown=this.onCursorDown.bind(this),this.onCursorUp=this.onCursorUp.bind(this),this.onIntersection=this.onIntersection.bind(this),this.onIntersectionCleared=this.onIntersectionCleared.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onEnterVR=this.onEnterVR.bind(this)},update:function(v){this.data.rayOrigin!==v.rayOrigin&&this.updateMouseEventListeners()},tick:function(){var v=this.el.sceneEl.frame,_=this.activeXRInput;this.data.rayOrigin==="xrselect"&&v&&_&&this.onMouseMove({frame:v,inputSource:_,type:"fakeselectevent"})},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){var v=this.el;v.removeState(m.HOVERING),v.removeState(m.FUSING),clearTimeout(this.fuseTimeout),this.intersectedEl&&this.intersectedEl.removeState(m.HOVERED),this.removeEventListeners()},addEventListeners:function(){var v,_=this.data,T=this.el,w=this;function S(){v=T.sceneEl.canvas,!(_.downEvents.length||_.upEvents.length)&&(g.DOWN.forEach(function(R){v.addEventListener(R,w.onCursorDown,{passive:!1})}),g.UP.forEach(function(R){v.addEventListener(R,w.onCursorUp,{passive:!1})}))}v=T.sceneEl.canvas,v?S():T.sceneEl.addEventListener("render-target-loaded",S),_.downEvents.forEach(function(R){T.addEventListener(R,w.onCursorDown)}),_.upEvents.forEach(function(R){T.addEventListener(R,w.onCursorUp)}),T.addEventListener("raycaster-intersection",this.onIntersection),T.addEventListener("raycaster-closest-entity-changed",this.onIntersection),T.addEventListener("raycaster-intersection-cleared",this.onIntersectionCleared),T.sceneEl.addEventListener("rendererresize",this.updateCanvasBounds),T.sceneEl.addEventListener("enter-vr",this.onEnterVR),window.addEventListener("resize",this.updateCanvasBounds),window.addEventListener("scroll",this.updateCanvasBounds),this.updateMouseEventListeners()},removeEventListeners:function(){var v,_=this.data,T=this.el,w=this;v=T.sceneEl.canvas,v&&!_.downEvents.length&&!_.upEvents.length&&(g.DOWN.forEach(function(S){v.removeEventListener(S,w.onCursorDown)}),g.UP.forEach(function(S){v.removeEventListener(S,w.onCursorUp)})),_.downEvents.forEach(function(S){T.removeEventListener(S,w.onCursorDown)}),_.upEvents.forEach(function(S){T.removeEventListener(S,w.onCursorUp)}),T.removeEventListener("raycaster-intersection",this.onIntersection),T.removeEventListener("raycaster-intersection-cleared",this.onIntersectionCleared),v.removeEventListener("mousemove",this.onMouseMove),v.removeEventListener("touchstart",this.onMouseMove),v.removeEventListener("touchmove",this.onMouseMove),T.sceneEl.removeEventListener("rendererresize",this.updateCanvasBounds),T.sceneEl.removeEventListener("enter-vr",this.onEnterVR),window.removeEventListener("resize",this.updateCanvasBounds),window.removeEventListener("scroll",this.updateCanvasBounds)},updateMouseEventListeners:function(){var v,_=this.el;v=_.sceneEl.canvas,v.removeEventListener("mousemove",this.onMouseMove),v.removeEventListener("touchmove",this.onMouseMove),_.setAttribute("raycaster","useWorldCoordinates",!1),this.data.rayOrigin==="mouse"&&(v.addEventListener("mousemove",this.onMouseMove),v.addEventListener("touchmove",this.onMouseMove,{passive:!1}),_.setAttribute("raycaster","useWorldCoordinates",!0),this.updateCanvasBounds())},onMouseMove:function(){var v=new THREE.Vector3,_=new THREE.Vector2,T=new THREE.Vector3,w={origin:T,direction:v};return function(S){var R=this.canvasBounds,B=this.el.sceneEl.camera,I,D,L,O,U,Z,G,z;B.parent.updateMatrixWorld(),S.type==="touchmove"||S.type==="touchstart"?D=S.touches.item(0):D=S,I=D.clientX-R.left,L=D.clientY-R.top,_.x=I/R.width*2-1,_.y=-(L/R.height)*2+1,this.data.rayOrigin==="xrselect"&&(S.type==="selectstart"||S.type==="fakeselectevent")?(O=S.frame,U=S.inputSource,Z=this.el.renderer.xr.getReferenceSpace(),G=O.getPose(U.targetRaySpace,Z),z=G.transform,v.set(0,0,-1),v.applyQuaternion(z.orientation),T.copy(z.position)):S.type==="fakeselectout"?(v.set(0,1,0),T.set(0,9999,0)):B&&B.isPerspectiveCamera?(T.setFromMatrixPosition(B.matrixWorld),v.set(_.x,_.y,.5).unproject(B).sub(T).normalize()):B&&B.isOrthographicCamera?(T.set(_.x,_.y,(B.near+B.far)/(B.near-B.far)).unproject(B),v.set(0,0,-1).transformDirection(B.matrixWorld)):console.error("AFRAME.Raycaster: Unsupported camera type: "+B.type),this.el.setAttribute("raycaster",w),S.type==="touchmove"&&S.preventDefault()}}(),onCursorDown:function(v){this.isCursorDown=!0,this.data.rayOrigin==="mouse"&&v.type==="touchstart"&&(this.onMouseMove(v),this.el.components.raycaster.checkIntersections(),v.preventDefault()),this.data.rayOrigin==="xrselect"&&v.type==="selectstart"&&(this.activeXRInput=v.inputSource,this.onMouseMove(v),this.el.components.raycaster.checkIntersections(),this.el.components.raycaster.intersectedEls.length&&this.el.sceneEl.components["ar-hit-test"]!==void 0&&this.el.sceneEl.getAttribute("ar-hit-test").enabled&&(this.el.sceneEl.setAttribute("ar-hit-test","enabled",!1),this.reenableARHitTest=!0)),this.twoWayEmit(f.MOUSEDOWN,v),this.cursorDownEl=this.intersectedEl},onCursorUp:function(v){if(this.isCursorDown){this.isCursorDown=!1;var _=this.data;this.twoWayEmit(f.MOUSEUP,v),this.reenableARHitTest===!0&&(this.el.sceneEl.setAttribute("ar-hit-test","enabled",!0),this.reenableARHitTest=void 0),this.cursorDownEl&&this.cursorDownEl!==this.intersectedEl&&(this.intersectedEventDetail.intersection=null,this.cursorDownEl.emit(f.MOUSEUP,this.intersectedEventDetail)),(!_.fuse||_.rayOrigin==="mouse"||_.rayOrigin==="xrselect")&&this.intersectedEl&&this.cursorDownEl===this.intersectedEl&&this.twoWayEmit(f.CLICK,v),_.rayOrigin==="xrselect"&&this.activeXRInput===v.inputSource&&this.onMouseMove({type:"fakeselectout"}),this.activeXRInput=null,this.cursorDownEl=null,v.type==="touchend"&&v.preventDefault()}},onIntersection:function(v){var _,T=this.el,w,S,R;w=v.detail.els[0]===T?1:0,R=v.detail.intersections[w],S=v.detail.els[w],S&&this.intersectedEl!==S&&(this.intersectedEl&&(_=this.el.components.raycaster.getIntersection(this.intersectedEl),_&&_.distance<=R.distance)||(this.clearCurrentIntersection(!0),this.setIntersection(S,R)))},onIntersectionCleared:function(v){var _=v.detail.clearedEls;_.indexOf(this.intersectedEl)!==-1&&this.clearCurrentIntersection()},onEnterVR:function(){this.clearCurrentIntersection(!0);var v=this.el.sceneEl.xrSession,_=this;v&&this.data.rayOrigin!=="mouse"&&(y.DOWN.forEach(function(T){v.addEventListener(T,_.onCursorDown)}),y.UP.forEach(function(T){v.addEventListener(T,_.onCursorUp)}))},setIntersection:function(v,_){var T=this.el,w=this.data,S=this;this.intersectedEl!==v&&(this.intersectedEl=v,T.addState(m.HOVERING),v.addState(m.HOVERED),this.twoWayEmit(f.MOUSEENTER),this.data.mouseCursorStylesEnabled&&this.data.rayOrigin==="mouse"&&this.el.sceneEl.canvas.classList.add(x),!(w.fuseTimeout===0||!w.fuse||w.rayOrigin==="xrselect"||w.rayOrigin==="mouse")&&(T.addState(m.FUSING),this.twoWayEmit(f.FUSING),this.fuseTimeout=setTimeout(function(){T.removeState(m.FUSING),S.twoWayEmit(f.CLICK)},w.fuseTimeout)))},clearCurrentIntersection:function(v){var _,T,w,S=this.el;this.intersectedEl&&(this.intersectedEl.removeState(m.HOVERED),S.removeState(m.HOVERING),S.removeState(m.FUSING),this.twoWayEmit(f.MOUSELEAVE),this.data.mouseCursorStylesEnabled&&this.data.rayOrigin==="mouse"&&this.el.sceneEl.canvas.classList.remove(x),this.intersectedEl=null,clearTimeout(this.fuseTimeout),v!==!0&&(w=this.el.components.raycaster.intersections,w.length!==0&&(_=w[0].object.el===S?1:0,T=w[_],T&&this.setIntersection(T.object.el,T))))},twoWayEmit:function(v,_){var T=this.el,w=this.intersectedEl,S;function R(B,I){_ instanceof MouseEvent?B.mouseEvent=_:typeof TouchEvent<"u"&&_ instanceof TouchEvent&&(B.touchEvent=_)}S=this.el.components.raycaster.getIntersection(w),this.eventDetail.intersectedEl=w,this.eventDetail.intersection=S,R(this.eventDetail),T.emit(v,this.eventDetail),w&&(this.intersectedEventDetail.intersection=S,R(this.intersectedEventDetail),w.emit(v,this.intersectedEventDetail))}})},"./src/components/generic-tracked-controller-controls.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent,p=c("./src/utils/tracked-controls.js"),f=p.checkControllerPresentAndSetup,m=p.emitIfAxesChanged,g=p.onButtonEvent,y="generic",x={axes:{touchpad:[0,1],thumbstick:[2,3]},buttons:["trigger","squeeze","touchpad","thumbstick"]};l.exports.Component=h("generic-tracked-controller-controls",{schema:{hand:{default:""},defaultModel:{default:!0},defaultModelColor:{default:"gray"},orientationOffset:{type:"vec3"},disabled:{default:!1}},after:["tracked-controls"],mapping:x,bindMethods:function(){this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},init:function(){var v=this;this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(_){g(_.detail.id,"down",v)},this.onButtonUp=function(_){g(_.detail.id,"up",v)},this.onButtonTouchStart=function(_){g(_.detail.id,"touchstart",v)},this.onButtonTouchEnd=function(_){g(_.detail.id,"touchend",v)},this.controllerPresent=!1,this.wasControllerConnected=!1,this.lastControllerCheck=0,this.bindMethods(),this.el.addEventListener("controllerconnected",function(_){_.detail.name!==v.name&&(v.wasControllerConnected=!0,v.removeEventListeners(),v.removeControllersUpdateListener())})},addEventListeners:function(){var v=this.el;v.addEventListener("buttonchanged",this.onButtonChanged),v.addEventListener("buttondown",this.onButtonDown),v.addEventListener("buttonup",this.onButtonUp),v.addEventListener("touchstart",this.onButtonTouchStart),v.addEventListener("touchend",this.onButtonTouchEnd),v.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var v=this.el;v.removeEventListener("buttonchanged",this.onButtonChanged),v.removeEventListener("buttondown",this.onButtonDown),v.removeEventListener("buttonup",this.onButtonUp),v.removeEventListener("touchstart",this.onButtonTouchStart),v.removeEventListener("touchend",this.onButtonTouchEnd),v.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var v=this.data,_=v.hand?v.hand:void 0;f(this,y,{hand:_,iterateControllerProfiles:!0})},play:function(){this.wasControllerConnected||(this.checkIfControllerPresent(),this.addControllersUpdateListener())},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var v=this.el,_=this.data;if(this.el.components["tracked-controls"]){this.removeEventListeners();return}v.setAttribute("tracked-controls",{hand:_.hand,idPrefix:y,orientationOffset:_.orientationOffset,iterateControllerProfiles:!0}),this.data.defaultModel&&this.initDefaultModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.wasControllerConnected&&this.checkIfControllerPresent()},onButtonChanged:function(v){var _=this.mapping.buttons[v.detail.id];_&&this.el.emit(_+"changed",v.detail.state)},onAxisMoved:function(v){m(this,this.mapping.axes,v)},initDefaultModel:function(){var v=this.modelEl=document.createElement("a-entity");v.setAttribute("geometry",{primitive:"sphere",radius:.03}),v.setAttribute("material",{color:this.data.color}),this.el.appendChild(v),this.el.emit("controllermodelready",{name:"generic-tracked-controller-controls",model:this.modelEl,rayOrigin:{origin:{x:0,y:0,z:-.01},direction:{x:0,y:0,z:-1}}})}})},"./src/components/geometry.js":(l,u,c)=>{var h=c("./src/core/geometry.js").geometries,p=c("./src/core/geometry.js").geometryNames,f=c("./src/core/component.js").registerComponent,m=c("./src/lib/three.js"),g=new m.BufferGeometry;l.exports.Component=f("geometry",{schema:{buffer:{default:!0},primitive:{default:"box",oneOf:p,schemaChange:!0},skipCache:{default:!1}},init:function(){this.geometry=null},update:function(y){var x=this.data,v=this.el,_,T=this.system;this.geometry&&(T.unuseGeometry(y),this.geometry=null),this.geometry=T.getOrCreateGeometry(x),_=v.getObject3D("mesh"),_?_.geometry=this.geometry:(_=new m.Mesh,_.geometry=this.geometry,this.el.getAttribute("material")||(_.material=new m.MeshStandardMaterial({color:Math.random()*16777215,metalness:0,roughness:.5})),v.setObject3D("mesh",_))},remove:function(){this.system.unuseGeometry(this.data),this.el.getObject3D("mesh").geometry=g,this.geometry=null},updateSchema:function(y){var x=this.oldData&&this.oldData.primitive,v=y.primitive,_=h[v]&&h[v].schema;if(!_)throw new Error("Unknown geometry schema `"+v+"`");x&&x===v||this.extendSchema(_)}})},"./src/components/gltf-model.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent,p=c("./src/lib/three.js"),f=c("./src/utils/index.js"),m=f.debug("components:gltf-model:warn");l.exports.Component=h("gltf-model",{schema:{type:"model"},init:function(){var g=this,y=this.system.getDRACOLoader(),x=this.system.getMeshoptDecoder(),v=this.system.getKTX2Loader();this.model=null,this.loader=new p.GLTFLoader,y&&this.loader.setDRACOLoader(y),x?this.ready=x.then(function(_){g.loader.setMeshoptDecoder(_)}):this.ready=Promise.resolve(),v&&this.loader.setKTX2Loader(v)},update:function(){var g=this,y=this.el,x=this.data;x&&(this.remove(),this.ready.then(function(){g.loader.load(x,function(v){g.model=v.scene||v.scenes[0],g.model.animations=v.animations,y.setObject3D("mesh",g.model),y.emit("model-loaded",{format:"gltf",model:g.model})},void 0,function(v){var _=v&&v.message?v.message:"Failed to load glTF model";m(_),y.emit("model-error",{format:"gltf",src:x})})}))},remove:function(){this.model&&this.el.removeObject3D("mesh")}})},"./src/components/grabbable.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent;h("grabbable",{init:function(){this.el.setAttribute("obb-collider","centerModel: true")}})},"./src/components/hand-controls.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent,p=c("./src/constants/index.js").AFRAME_CDN_ROOT,f={toonLeft:p+"controllers/hands/leftHand.glb",toonRight:p+"controllers/hands/rightHand.glb",lowPolyLeft:p+"controllers/hands/leftHandLow.glb",lowPolyRight:p+"controllers/hands/rightHandLow.glb",highPolyLeft:p+"controllers/hands/leftHandHigh.glb",highPolyRight:p+"controllers/hands/rightHandHigh.glb"},m={open:"Open",point:"Point",pointThumb:"Point + Thumb",fist:"Fist",hold:"Hold",thumbUp:"Thumb Up"},g={};g[m.fist]="grip",g[m.thumbUp]="pistol",g[m.point]="pointing",l.exports.Component=h("hand-controls",{schema:{color:{default:"white",type:"color"},hand:{default:"left"},handModelStyle:{default:"lowPoly",oneOf:["lowPoly","highPoly","toon"]}},after:["tracked-controls"],init:function(){var v=this,_=this.el;this.pressedButtons={},this.touchedButtons={},this.loader=new THREE.GLTFLoader,this.loader.setCrossOrigin("anonymous"),this.onGripDown=function(){v.handleButton("grip","down")},this.onGripUp=function(){v.handleButton("grip","up")},this.onTrackpadDown=function(){v.handleButton("trackpad","down")},this.onTrackpadUp=function(){v.handleButton("trackpad","up")},this.onTrackpadTouchStart=function(){v.handleButton("trackpad","touchstart")},this.onTrackpadTouchEnd=function(){v.handleButton("trackpad","touchend")},this.onTriggerDown=function(){v.handleButton("trigger","down")},this.onTriggerUp=function(){v.handleButton("trigger","up")},this.onTriggerTouchStart=function(){v.handleButton("trigger","touchstart")},this.onTriggerTouchEnd=function(){v.handleButton("trigger","touchend")},this.onGripTouchStart=function(){v.handleButton("grip","touchstart")},this.onGripTouchEnd=function(){v.handleButton("grip","touchend")},this.onThumbstickDown=function(){v.handleButton("thumbstick","down")},this.onThumbstickUp=function(){v.handleButton("thumbstick","up")},this.onAorXTouchStart=function(){v.handleButton("AorX","touchstart")},this.onAorXTouchEnd=function(){v.handleButton("AorX","touchend")},this.onBorYTouchStart=function(){v.handleButton("BorY","touchstart")},this.onBorYTouchEnd=function(){v.handleButton("BorY","touchend")},this.onSurfaceTouchStart=function(){v.handleButton("surface","touchstart")},this.onSurfaceTouchEnd=function(){v.handleButton("surface","touchend")},this.onControllerConnected=this.onControllerConnected.bind(this),this.onControllerDisconnected=this.onControllerDisconnected.bind(this),_.addEventListener("controllerconnected",this.onControllerConnected),_.addEventListener("controllerdisconnected",this.onControllerDisconnected),_.object3D.visible=!1},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},tick:function(v,_){var T=this.el.getObject3D("mesh");!T||!T.mixer||T.mixer.update(_/1e3)},onControllerConnected:function(){this.el.object3D.visible=!0},onControllerDisconnected:function(){this.el.object3D.visible=!1},addEventListeners:function(){var v=this.el;v.addEventListener("gripdown",this.onGripDown),v.addEventListener("gripup",this.onGripUp),v.addEventListener("trackpaddown",this.onTrackpadDown),v.addEventListener("trackpadup",this.onTrackpadUp),v.addEventListener("trackpadtouchstart",this.onTrackpadTouchStart),v.addEventListener("trackpadtouchend",this.onTrackpadTouchEnd),v.addEventListener("triggerdown",this.onTriggerDown),v.addEventListener("triggerup",this.onTriggerUp),v.addEventListener("triggertouchstart",this.onTriggerTouchStart),v.addEventListener("triggertouchend",this.onTriggerTouchEnd),v.addEventListener("griptouchstart",this.onGripTouchStart),v.addEventListener("griptouchend",this.onGripTouchEnd),v.addEventListener("thumbstickdown",this.onThumbstickDown),v.addEventListener("thumbstickup",this.onThumbstickUp),v.addEventListener("abuttontouchstart",this.onAorXTouchStart),v.addEventListener("abuttontouchend",this.onAorXTouchEnd),v.addEventListener("bbuttontouchstart",this.onBorYTouchStart),v.addEventListener("bbuttontouchend",this.onBorYTouchEnd),v.addEventListener("xbuttontouchstart",this.onAorXTouchStart),v.addEventListener("xbuttontouchend",this.onAorXTouchEnd),v.addEventListener("ybuttontouchstart",this.onBorYTouchStart),v.addEventListener("ybuttontouchend",this.onBorYTouchEnd),v.addEventListener("surfacetouchstart",this.onSurfaceTouchStart),v.addEventListener("surfacetouchend",this.onSurfaceTouchEnd)},removeEventListeners:function(){var v=this.el;v.removeEventListener("gripdown",this.onGripDown),v.removeEventListener("gripup",this.onGripUp),v.removeEventListener("trackpaddown",this.onTrackpadDown),v.removeEventListener("trackpadup",this.onTrackpadUp),v.removeEventListener("trackpadtouchstart",this.onTrackpadTouchStart),v.removeEventListener("trackpadtouchend",this.onTrackpadTouchEnd),v.removeEventListener("triggerdown",this.onTriggerDown),v.removeEventListener("triggerup",this.onTriggerUp),v.removeEventListener("triggertouchstart",this.onTriggerTouchStart),v.removeEventListener("triggertouchend",this.onTriggerTouchEnd),v.removeEventListener("griptouchstart",this.onGripTouchStart),v.removeEventListener("griptouchend",this.onGripTouchEnd),v.removeEventListener("thumbstickdown",this.onThumbstickDown),v.removeEventListener("thumbstickup",this.onThumbstickUp),v.removeEventListener("abuttontouchstart",this.onAorXTouchStart),v.removeEventListener("abuttontouchend",this.onAorXTouchEnd),v.removeEventListener("bbuttontouchstart",this.onBorYTouchStart),v.removeEventListener("bbuttontouchend",this.onBorYTouchEnd),v.removeEventListener("xbuttontouchstart",this.onAorXTouchStart),v.removeEventListener("xbuttontouchend",this.onAorXTouchEnd),v.removeEventListener("ybuttontouchstart",this.onBorYTouchStart),v.removeEventListener("ybuttontouchend",this.onBorYTouchEnd),v.removeEventListener("surfacetouchstart",this.onSurfaceTouchStart),v.removeEventListener("surfacetouchend",this.onSurfaceTouchEnd)},update:function(v){var _,T=this.el,w=this.data.hand,S=this.data.handModelStyle,R=this.data.color,B=this;if(_={hand:w,model:!1},w!==v){var I=f[S+w.charAt(0).toUpperCase()+w.slice(1)];this.loader.load(I,function(D){var L=D.scene.children[0],O=w==="left"?Math.PI/2:-Math.PI/2,U=T.sceneEl.hasWebXR?-Math.PI/2:0;L.mixer=new THREE.AnimationMixer(L),B.clips=D.animations,T.setObject3D("mesh",L),L.traverse(function(Z){Z.isMesh&&(Z.material.color=new THREE.Color(R))}),L.position.set(0,0,0),L.rotation.set(U,0,O),T.setAttribute("magicleap-controls",_),T.setAttribute("vive-controls",_),T.setAttribute("oculus-touch-controls",_),T.setAttribute("pico-controls",_),T.setAttribute("windows-motion-controls",_),T.setAttribute("hp-mixed-reality-controls",_)})}},remove:function(){this.el.removeObject3D("mesh")},handleButton:function(v,_){var T,w=_==="down",S=_==="touchstart";if(_.indexOf("touch")===0){if(S===this.touchedButtons[v])return;this.touchedButtons[v]=S}else{if(w===this.pressedButtons[v])return;this.pressedButtons[v]=w}T=this.gesture,this.gesture=this.determineGesture(),this.gesture!==T&&(this.animateGesture(this.gesture,T),this.emitGestureEvents(this.gesture,T))},determineGesture:function(){var v,_=this.pressedButtons.grip,T=this.pressedButtons.surface||this.touchedButtons.surface,w=this.pressedButtons.trackpad||this.touchedButtons.trackpad,S=this.pressedButtons.trigger||this.touchedButtons.trigger,R=this.touchedButtons.AorX||this.touchedButtons.BorY,B=x(this.el.components["tracked-controls"]);return B?_||S?v=m.fist:w&&(v=m.point):_?T||R||w?v=S?m.fist:m.point:v=S?m.thumbUp:m.pointThumb:S&&(v=m.hold),v},getClip:function(v){var _,T;for(T=0;T<this.clips.length;T++)if(_=this.clips[T],_.name===v)return _},animateGesture:function(v,_){if(v){this.playAnimation(v||m.open,_,!1);return}this.playAnimation(_,_,!0)},emitGestureEvents:function(v,_){var T=this.el,w;_!==v&&(w=y(_,!1),w&&T.emit(w),w=y(v,!0),w&&T.emit(w))},playAnimation:function(v,_,T){var w,S,R=this.el.getObject3D("mesh"),B;if(R){if(w=this.getClip(v),B=R.mixer.clipAction(w),T){B.paused=!1,B.timeScale=-1;return}if(B.clampWhenFinished=!0,B.loop=THREE.LoopOnce,B.repetitions=0,B.timeScale=1,B.time=0,B.weight=1,!_){R.mixer.stopAllAction(),B.play();return}w=this.getClip(_),B.reset(),B.play(),S=R.mixer.clipAction(w),S.crossFadeTo(B,.15,!0)}}});function y(v,_){var T;if(v){if(T=g[v],T==="grip")return T+(_?"close":"open");if(T==="point")return T+(_?"up":"down");if(T==="pointing"||T==="pistol")return T+(_?"start":"end")}}function x(v){var _=v&&v.controller,T=_&&(_.id&&_.id.indexOf("OpenVR ")===0||_.profiles&&_.profiles[0]&&_.profiles[0]==="htc-vive");return T}},"./src/components/hand-tracking-controls.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent,p=c("./src/core/a-entity.js").AEntity,f=c("./src/utils/tracked-controls.js"),m=f.checkControllerPresentAndSetup,g=c("./src/constants/index.js").AFRAME_CDN_ROOT,y=g+"controllers/oculus-hands/v4/left.glb",x=g+"controllers/oculus-hands/v4/right.glb",v=["wrist","thumb-metacarpal","thumb-phalanx-proximal","thumb-phalanx-distal","thumb-tip","index-finger-metacarpal","index-finger-phalanx-proximal","index-finger-phalanx-intermediate","index-finger-phalanx-distal","index-finger-tip","middle-finger-metacarpal","middle-finger-phalanx-proximal","middle-finger-phalanx-intermediate","middle-finger-phalanx-distal","middle-finger-tip","ring-finger-metacarpal","ring-finger-phalanx-proximal","ring-finger-phalanx-intermediate","ring-finger-phalanx-distal","ring-finger-tip","pinky-finger-metacarpal","pinky-finger-phalanx-proximal","pinky-finger-phalanx-intermediate","pinky-finger-phalanx-distal","pinky-finger-tip"],_=0,T=4,w=9,S=.015,R=.1;l.exports.Component=h("hand-tracking-controls",{schema:{hand:{default:"right",oneOf:["left","right"]},modelStyle:{default:"mesh",oneOf:["dots","mesh"]},modelColor:{default:"white"},modelOpacity:{default:1}},after:["tracked-controls"],bindMethods:function(){this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this)},addEventListeners:function(){this.el.addEventListener("model-loaded",this.onModelLoaded);for(var B=0;B<this.jointEls.length;++B)this.jointEls[B].object3D.visible=!0},removeEventListeners:function(){this.el.removeEventListener("model-loaded",this.onModelLoaded);for(var B=0;B<this.jointEls.length;++B)this.jointEls[B].object3D.visible=!1},init:function(){var B=this.el.sceneEl,I=B.getAttribute("webxr"),D=I.optionalFeatures;D.indexOf("hand-tracking")===-1&&(D.push("hand-tracking"),B.setAttribute("webxr",I)),this.wristObject3D=new THREE.Object3D,this.el.sceneEl.object3D.add(this.wristObject3D),this.onModelLoaded=this.onModelLoaded.bind(this),this.onChildAttached=this.onChildAttached.bind(this),this.jointEls=[],this.controllerPresent=!1,this.isPinched=!1,this.pinchEventDetail={position:new THREE.Vector3,wristRotation:new THREE.Quaternion},this.indexTipPosition=new THREE.Vector3,this.hasPoses=!1,this.jointPoses=new Float32Array(16*v.length),this.jointRadii=new Float32Array(v.length),this.bindMethods(),this.updateReferenceSpace=this.updateReferenceSpace.bind(this),this.el.sceneEl.addEventListener("enter-vr",this.updateReferenceSpace),this.el.sceneEl.addEventListener("exit-vr",this.updateReferenceSpace),this.el.addEventListener("child-attached",this.onChildAttached),this.el.object3D.visible=!1,this.wristObject3D.visible=!1},onChildAttached:function(B){this.addChildEntity(B.detail.el)},update:function(){this.updateModelMaterial()},updateModelMaterial:function(){var B=this.jointEls,I=this.skinnedMesh,D=this.data.modelOpacity!==1;I&&(this.skinnedMesh.material.color.set(this.data.modelColor),this.skinnedMesh.material.transparent=D,this.skinnedMesh.material.opacity=this.data.modelOpacity);for(var L=0;L<B.length;L++)B[L].setAttribute("material",{color:this.data.modelColor,transparent:D,opacity:this.data.modelOpacity})},updateReferenceSpace:function(){var B=this,I=this.el.sceneEl.xrSession;if(this.referenceSpace=void 0,!!I){var D=B.el.sceneEl.systems.webxr.sessionReferenceSpaceType;I.requestReferenceSpace(D).then(function(L){B.referenceSpace=L}).catch(function(L){throw B.el.sceneEl.systems.webxr.warnIfFeatureNotRequested(D,"tracked-controls-webxr uses reference space "+D),L})}},checkIfControllerPresent:function(){var B=this.data,I=B.hand?B.hand:void 0;m(this,"",{hand:I,iterateControllerProfiles:!0,handTracking:!0})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},tick:function(){var B=this.el.sceneEl,I=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,D=B.frame,L=this.el.components["tracked-controls-webxr"],O=this.referenceSpace;!I||!D||!O||!L||(this.hasPoses=!1,I.hand&&(this.el.object3D.position.set(0,0,0),this.el.object3D.rotation.set(0,0,0),this.hasPoses=D.fillPoses(I.hand.values(),O,this.jointPoses)&&D.fillJointRadii(I.hand.values(),this.jointRadii),this.updateHandModel(),this.detectGesture(),this.updateWristObject()))},updateWristObject:function(){var B=new THREE.Matrix4;return function(){var I=this.wristObject3D;!I||!this.hasPoses||(B.fromArray(this.jointPoses,_*16),I.position.setFromMatrixPosition(B),I.quaternion.setFromRotationMatrix(B))}}(),updateHandModel:function(){this.data.modelStyle==="dots"&&this.updateHandDotsModel(),this.data.modelStyle==="mesh"&&this.updateHandMeshModel()},getBone:function(B){for(var I=this.bones,D=0;D<I.length;D++)if(I[D].name===B)return I[D];return null},updateHandMeshModel:function(){var B=new THREE.Matrix4;return function(){var I=0,D=this.jointPoses,L=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller;if(!(!L||!this.mesh)&&(this.mesh.visible=!1,!!this.hasPoses))for(var O of L.hand.values()){var U=this.getBone(O.jointName);U!=null&&(this.mesh.visible=!0,B.fromArray(D,I*16),U.position.setFromMatrixPosition(B),U.quaternion.setFromRotationMatrix(B)),I++}}}(),updateHandDotsModel:function(){for(var B=this.jointPoses,I=this.jointRadii,D=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,L,O,U=0;U<D.hand.size;U++)L=this.jointEls[U],O=L.object3D,L.object3D.visible=this.hasPoses,this.hasPoses&&(O.matrix.fromArray(B,U*16),O.matrix.decompose(O.position,O.rotation,O.scale),L.setAttribute("scale",{x:I[U],y:I[U],z:I[U]}))},detectGesture:function(){this.detectPinch()},detectPinch:function(){var B=new THREE.Vector3,I=new THREE.Matrix4;return function(){var D=this.indexTipPosition,L=this.pinchEventDetail;if(this.hasPoses){B.setFromMatrixPosition(I.fromArray(this.jointPoses,T*16)),D.setFromMatrixPosition(I.fromArray(this.jointPoses,w*16)),L.wristRotation.setFromRotationMatrix(I.fromArray(this.jointPoses,_*16));var O=D.distanceTo(B);O<S&&this.isPinched===!1&&(this.isPinched=!0,this.pinchDistance=O,L.position.copy(D).add(B).multiplyScalar(.5),this.el.emit("pinchstarted",L)),O>this.pinchDistance+this.pinchDistance*R&&this.isPinched===!0&&(this.isPinched=!1,L.position.copy(D).add(B).multiplyScalar(.5),this.el.emit("pinchended",L)),this.isPinched&&(L.position.copy(D).add(B).multiplyScalar(.5),this.el.emit("pinchmoved",L))}}}(),pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var B=this.el,I=this.data;if(B.setAttribute("tracked-controls",{id:"",hand:I.hand,iterateControllerProfiles:!0,handTrackingEnabled:!0}),this.mesh){this.mesh!==B.getObject3D("mesh")&&B.setObject3D("mesh",this.mesh);return}this.initDefaultModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){var B=this.el,I;this.checkIfControllerPresent(),I=B.components["tracked-controls"]&&B.components["tracked-controls"].controller,this.mesh&&I&&I.hand&&I.hand instanceof XRHand&&B.setObject3D("mesh",this.mesh)},initDefaultModel:function(){var B=this.data;B.modelStyle==="dots"&&this.initDotsModel(),B.modelStyle==="mesh"&&this.initMeshHandModel(),this.el.object3D.visible=!0,this.wristObject3D.visible=!0},initDotsModel:function(){if(this.jointEls.length===0){for(var B=0;B<v.length;++B){var I=this.jointEl=document.createElement("a-entity");I.setAttribute("geometry",{primitive:"sphere",radius:1}),I.object3D.visible=!1,this.el.appendChild(I),this.jointEls.push(I)}this.updateModelMaterial()}},initMeshHandModel:function(){var B=this.data.hand==="left"?y:x;this.el.setAttribute("gltf-model",B)},onModelLoaded:function(){var B=this.mesh=this.el.getObject3D("mesh").children[0],I=this.skinnedMesh=B.getObjectByProperty("type","SkinnedMesh");this.skinnedMesh&&(this.bones=I.skeleton.bones,this.el.removeObject3D("mesh"),B.position.set(0,0,0),B.rotation.set(0,0,0),I.frustumCulled=!1,I.material=new THREE.MeshStandardMaterial,this.updateModelMaterial(),this.setupChildrenEntities(),this.el.setObject3D("mesh",B))},setupChildrenEntities:function(){for(var B=this.el.children,I=0;I<B.length;++I)B[I]instanceof p&&this.addChildEntity(B[I])},addChildEntity:function(B){B instanceof p&&this.wristObject3D.add(B.object3D)}})},"./src/components/hand-tracking-grab-controls.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent,p=c("./src/lib/three.js");h("hand-tracking-grab-controls",{schema:{hand:{default:"right",oneOf:["left","right"]},color:{type:"color",default:"white"},hoverColor:{type:"color",default:"#538df1"},hoverEnabled:{default:!1}},init:function(){var f=this.el,m=this.data,g;m.hand==="right"?g="components.hand-tracking-controls.bones.3":g="components.hand-tracking-controls.bones.21",f.setAttribute("hand-tracking-controls",{hand:m.hand}),f.setAttribute("obb-collider",{trackedObject3D:g,size:.04}),this.auxMatrix=new p.Matrix4,this.auxQuaternion=new p.Quaternion,this.auxQuaternion2=new p.Quaternion,this.auxVector=new p.Vector3,this.auxVector2=new p.Vector3,this.grabbingObjectPosition=new p.Vector3,this.grabbedObjectPosition=new p.Vector3,this.grabbedObjectPositionDelta=new p.Vector3,this.grabDeltaPosition=new p.Vector3,this.grabInitialRotation=new p.Quaternion,this.onCollisionStarted=this.onCollisionStarted.bind(this),this.el.addEventListener("obbcollisionstarted",this.onCollisionStarted),this.onCollisionEnded=this.onCollisionEnded.bind(this),this.el.addEventListener("obbcollisionended",this.onCollisionEnded),this.onPinchStarted=this.onPinchStarted.bind(this),this.el.addEventListener("pinchstarted",this.onPinchStarted),this.onPinchEnded=this.onPinchEnded.bind(this),this.el.addEventListener("pinchended",this.onPinchEnded),this.onPinchMoved=this.onPinchMoved.bind(this),this.el.addEventListener("pinchmoved",this.onPinchMoved)},transferEntityOwnership:function(){for(var f,m=this.el.sceneEl.querySelectorAll("[hand-tracking-grab-controls]"),g=0;g<m.length;++g)f=m[g].components["hand-tracking-grab-controls"],f!==this&&this.grabbedEl&&this.grabbedEl===f.grabbedEl&&f.releaseGrabbedEntity();return!1},onCollisionStarted:function(f){var m=f.detail.withEl;this.collidedEl||m.getAttribute("grabbable")&&(this.collidedEl=m,this.grabbingObject3D=f.detail.trackedObject3D,this.data.hoverEnabled&&this.el.setAttribute("hand-tracking-controls","modelColor",this.data.hoverColor))},onCollisionEnded:function(){this.collidedEl=void 0,!this.grabbedEl&&(this.grabbingObject3D=void 0,this.data.hoverEnabled&&this.el.setAttribute("hand-tracking-controls","modelColor",this.data.color))},onPinchStarted:function(f){this.collidedEl&&(this.pinchPosition=f.detail.position,this.wristRotation=f.detail.wristRotation,this.grabbedEl=this.collidedEl,this.transferEntityOwnership(),this.grab())},onPinchEnded:function(){this.releaseGrabbedEntity()},onPinchMoved:function(f){this.wristRotation=f.detail.wristRotation},releaseGrabbedEntity:function(){var f=this.grabbedEl;f&&(f.object3D.updateMatrixWorld=this.originalUpdateMatrixWorld,f.object3D.matrixAutoUpdate=!0,f.object3D.matrixWorldAutoUpdate=!0,f.object3D.matrixWorld.decompose(this.auxVector,this.auxQuaternion,this.auxVector2),f.object3D.position.copy(this.auxVector),f.object3D.quaternion.copy(this.auxQuaternion),this.el.emit("grabended",{grabbedEl:f}),this.grabbedEl=void 0)},grab:function(){var f=this.grabbedEl,m;m=f.object3D.getWorldPosition(this.grabbedObjectPosition),this.grabDeltaPosition.copy(m).sub(this.pinchPosition),this.grabInitialRotation.copy(this.auxQuaternion.copy(this.wristRotation).invert()),this.originalUpdateMatrixWorld=f.object3D.updateMatrixWorld,f.object3D.updateMatrixWorld=function(){},f.object3D.updateMatrixWorldChildren=function(g){for(var y=this.children,x=0,v=y.length;x<v;x++){var _=y[x];(_.matrixWorldAutoUpdate===!0||g===!0)&&_.updateMatrixWorld(!0)}},f.object3D.matrixAutoUpdate=!1,f.object3D.matrixWorldAutoUpdate=!1,this.el.emit("grabstarted",{grabbedEl:f})},tock:function(){var f=this.auxMatrix,m=this.auxQuaternion,g=this.auxQuaternion2,y,x=this.grabbedEl;x&&(y=x.object3D,y.getWorldQuaternion(g),y.matrixWorld.identity(),f.identity(),f.makeTranslation(this.pinchPosition),y.matrixWorld.multiply(f),f.identity(),f.makeRotationFromQuaternion(m.copy(this.wristRotation).multiply(this.grabInitialRotation)),y.matrixWorld.multiply(f),f.identity(),f.makeTranslation(this.grabDeltaPosition),y.matrixWorld.multiply(f),f.identity(),f.makeRotationFromQuaternion(g),y.matrixWorld.multiply(f),f.makeScale(x.object3D.scale.x,x.object3D.scale.y,x.object3D.scale.z),y.matrixWorld.multiply(f),y.updateMatrixWorldChildren())}})},"./src/components/hide-on-enter-ar.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent;l.exports.Component=h("hide-on-enter-ar",{init:function(){var p=this;this.el.sceneEl.addEventListener("enter-vr",function(){p.el.sceneEl.is("ar-mode")&&(p.el.object3D.visible=!1)}),this.el.sceneEl.addEventListener("exit-vr",function(){p.el.object3D.visible=!0})}})},"./src/components/hide-on-enter-vr.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent;l.exports.Component=h("hide-on-enter-vr",{init:function(){var p=this;this.el.sceneEl.addEventListener("enter-vr",function(){p.el.sceneEl.is("vr-mode")&&(p.el.object3D.visible=!1)}),this.el.sceneEl.addEventListener("exit-vr",function(){p.el.object3D.visible=!0})}})},"./src/components/hp-mixed-reality-controls.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent,p=c("./src/lib/three.js"),f=c("./src/utils/tracked-controls.js"),m=f.checkControllerPresentAndSetup,g=f.emitIfAxesChanged,y=f.onButtonEvent,x="hp-mixed-reality",v=c("./src/constants/index.js").AFRAME_CDN_ROOT,_=v+"controllers/hp/mixed-reality/",T={x:0,y:0,z:.06},w={_x:Math.PI/4,_y:0,_z:0,_order:"XYZ"},S={left:{axes:{touchpad:[2,3]},buttons:["trigger","grip","none","thumbstick","xbutton","ybutton"]},right:{axes:{touchpad:[2,3]},buttons:["trigger","grip","none","thumbstick","abutton","bbutton"]}};l.exports.Component=h("hp-mixed-reality-controls",{schema:{hand:{default:"none"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:S,init:function(){var R=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(B){y(B.detail.id,"down",R,R.data.hand)},this.onButtonUp=function(B){y(B.detail.id,"up",R,R.data.hand)},this.onButtonTouchEnd=function(B){y(B.detail.id,"touchend",R,R.data.hand)},this.onButtonTouchStart=function(B){y(B.detail.id,"touchstart",R,R.data.hand)},this.previousButtonValues={},this.bindMethods()},update:function(){var R=this.data;this.controllerIndex=R.hand==="right"?0:R.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},addEventListeners:function(){var R=this.el;R.addEventListener("buttonchanged",this.onButtonChanged),R.addEventListener("buttondown",this.onButtonDown),R.addEventListener("buttonup",this.onButtonUp),R.addEventListener("touchstart",this.onButtonTouchStart),R.addEventListener("touchend",this.onButtonTouchEnd),R.addEventListener("axismove",this.onAxisMoved),R.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var R=this.el;R.removeEventListener("buttonchanged",this.onButtonChanged),R.removeEventListener("buttondown",this.onButtonDown),R.removeEventListener("buttonup",this.onButtonUp),R.removeEventListener("touchstart",this.onButtonTouchStart),R.removeEventListener("touchend",this.onButtonTouchEnd),R.removeEventListener("axismove",this.onAxisMoved),R.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var R=this.data;m(this,x,{index:this.controllerIndex,hand:R.hand})},injectTrackedControls:function(){var R=this.el,B=this.data;R.setAttribute("tracked-controls",{idPrefix:x,hand:B.hand,controller:this.controllerIndex,orientationOffset:B.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",_+this.data.hand+".glb")},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(R){var B=this.mapping[this.data.hand].buttons[R.detail.id],I;B&&(B==="trigger"&&(I=R.detail.state.value,console.log("analog value of trigger press: "+I)),this.el.emit(B+"changed",R.detail.state))},onModelLoaded:function(R){var B=R.detail.model;this.data.model&&(B.position.copy(T),B.rotation.copy(w),this.el.emit("controllermodelready",{name:"hp-mixed-reality-controls",model:this.data.model,rayOrigin:new p.Vector3(0,0,0)}))},onAxisMoved:function(R){g(this,this.mapping.axes,R)}})},"./src/components/index.js":(l,u,c)=>{c("./src/components/animation.js"),c("./src/components/anchored.js"),c("./src/components/camera.js"),c("./src/components/cursor.js"),c("./src/components/geometry.js"),c("./src/components/generic-tracked-controller-controls.js"),c("./src/components/gltf-model.js"),c("./src/components/grabbable.js"),c("./src/components/hand-tracking-controls.js"),c("./src/components/hand-tracking-grab-controls.js"),c("./src/components/hand-controls.js"),c("./src/components/hide-on-enter-ar.js"),c("./src/components/hide-on-enter-vr.js"),c("./src/components/hp-mixed-reality-controls.js"),c("./src/components/layer.js"),c("./src/components/laser-controls.js"),c("./src/components/light.js"),c("./src/components/line.js"),c("./src/components/link.js"),c("./src/components/look-controls.js"),c("./src/components/magicleap-controls.js"),c("./src/components/material.js"),c("./src/components/obb-collider.js"),c("./src/components/obj-model.js"),c("./src/components/oculus-go-controls.js"),c("./src/components/oculus-touch-controls.js"),c("./src/components/pico-controls.js"),c("./src/components/position.js"),c("./src/components/raycaster.js"),c("./src/components/rotation.js"),c("./src/components/scale.js"),c("./src/components/shadow.js"),c("./src/components/sound.js"),c("./src/components/text.js"),c("./src/components/tracked-controls.js"),c("./src/components/tracked-controls-webvr.js"),c("./src/components/tracked-controls-webxr.js"),c("./src/components/visible.js"),c("./src/components/valve-index-controls.js"),c("./src/components/vive-controls.js"),c("./src/components/vive-focus-controls.js"),c("./src/components/wasd-controls.js"),c("./src/components/windows-motion-controls.js"),c("./src/components/scene/ar-hit-test.js"),c("./src/components/scene/background.js"),c("./src/components/scene/debug.js"),c("./src/components/scene/device-orientation-permission-ui.js"),c("./src/components/scene/embedded.js"),c("./src/components/scene/inspector.js"),c("./src/components/scene/fog.js"),c("./src/components/scene/keyboard-shortcuts.js"),c("./src/components/scene/pool.js"),c("./src/components/scene/real-world-meshing.js"),c("./src/components/scene/reflection.js"),c("./src/components/scene/screenshot.js"),c("./src/components/scene/stats.js"),c("./src/components/scene/xr-mode-ui.js")},"./src/components/laser-controls.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent,p=c("./src/utils/index.js");h("laser-controls",{schema:{hand:{default:"right"},model:{default:!0},defaultModelColor:{type:"color",default:"grey"}},init:function(){var f=this.config,m=this.data,g=this.el,y=this,x={hand:m.hand,model:m.model};g.setAttribute("hp-mixed-reality-controls",x),g.setAttribute("magicleap-controls",x),g.setAttribute("oculus-go-controls",x),g.setAttribute("oculus-touch-controls",x),g.setAttribute("pico-controls",x),g.setAttribute("valve-index-controls",x),g.setAttribute("vive-controls",x),g.setAttribute("vive-focus-controls",x),g.setAttribute("windows-motion-controls",x),g.setAttribute("generic-tracked-controller-controls",{hand:x.hand}),g.addEventListener("controllerconnected",v),g.addEventListener("controllerdisconnected",_),g.addEventListener("controllermodelready",function(T){v(T),y.modelReady=!0});function v(T){var w=f[T.detail.name];if(w){var S=p.extend({showLine:!0},w.raycaster||{});T.detail.rayOrigin&&(S.origin=T.detail.rayOrigin.origin,S.direction=T.detail.rayOrigin.direction,S.showLine=!0),T.detail.rayOrigin||!y.modelReady?g.setAttribute("raycaster",S):g.setAttribute("raycaster","showLine",!0),g.setAttribute("cursor",p.extend({fuse:!1},w.cursor))}}function _(T){var w=f[T.detail.name];w&&g.setAttribute("raycaster","showLine",!1)}},config:{"generic-tracked-controller-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"hp-mixed-reality-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:0,z:0}}},"magicleap-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"oculus-go-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:5e-4,z:0}}},"oculus-touch-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:0,z:0}}},"pico-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"valve-index-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"vive-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"vive-focus-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"windows-motion-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{showLine:!1}}}})},"./src/components/layer.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent,p=c("./src/utils/index.js"),f=p.debug("components:layer:warn");l.exports.Component=h("layer",{schema:{type:{default:"quad",oneOf:["quad","monocubemap","stereocubemap"]},src:{type:"map"},rotateCubemap:{default:!1},width:{default:0},height:{default:0}},init:function(){var g=this.el.sceneEl.renderer.getContext();this.quaternion=new THREE.Quaternion,this.position=new THREE.Vector3,this.bindMethods(),this.needsRedraw=!1,this.frameBuffer=g.createFramebuffer();var y=this.el.sceneEl.getAttribute("webxr"),x=y.requiredFeatures;x.indexOf("layers")===-1&&(x.push("layers"),this.el.sceneEl.setAttribute("webxr",y)),this.el.sceneEl.addEventListener("enter-vr",this.onEnterVR),this.el.sceneEl.addEventListener("exit-vr",this.onExitVR)},bindMethods:function(){this.onRequestedReferenceSpace=this.onRequestedReferenceSpace.bind(this),this.onEnterVR=this.onEnterVR.bind(this),this.onExitVR=this.onExitVR.bind(this)},update:function(g){this.data.src!==g.src&&this.updateSrc()},updateSrc:function(){var g=this.data.type;if(this.texture=void 0,g==="quad"){this.loadQuadImage();return}if(g==="monocubemap"||g==="stereocubemap"){this.loadCubeMapImages();return}},loadCubeMapImages:function(){var g,y=this.xrGLFactory,x=this.el.sceneEl.frame,v=this.data.src,_=this.data.type;this.visibilityChanged=!1,this.layer&&(_!=="monocubemap"&&_!=="stereocubemap"||(v.complete?this.pendingCubeMapUpdate=!1:this.pendingCubeMapUpdate=!0,this.loadingScreen?this.loadingScreen=!1:this.loadingScreen=!0,_==="monocubemap"?(g=y.getSubImage(this.layer,x),this.loadCubeMapImage(g.colorTexture,v,0)):(g=y.getSubImage(this.layer,x,"left"),this.loadCubeMapImage(g.colorTexture,v,0),g=y.getSubImage(this.layer,x,"right"),this.loadCubeMapImage(g.colorTexture,v,6))))},loadQuadImage:function(){var g=this.data.src,y=this;this.el.sceneEl.systems.material.loadTexture(g,{src:g},function(x){y.el.sceneEl.renderer.initTexture(x),y.texture=x,g.tagName==="VIDEO"&&setTimeout(function(){y.textureIsVideo=!0},1e3),y.layer&&(y.layer.height=y.data.height/2||y.texture.image.height/1e3,y.layer.width=y.data.width/2||y.texture.image.width/1e3,y.needsRedraw=!0),y.updateQuadPanel()})},preGenerateCubeMapTextures:function(g,y){this.data.type==="monocubemap"?this.generateCubeMapTextures(g,0,y):(this.generateCubeMapTextures(g,0,y),this.generateCubeMapTextures(g,6,y))},generateCubeMapTextures:function(g,y,x){for(var v=this.data,_=this.cubeFaceSize,T=Math.min(g.width,g.height),w=[],S,R,B=0;B<6;B++){var I=document.createElement("CANVAS");I.width=I.height=_;var D=I.getContext("2d");v.rotateCubemap&&(B===2||B===3)&&(D.save(),D.translate(_,_),D.rotate(Math.PI)),D.drawImage(g,(B+y)*T,0,T,T,0,0,_,_),D.restore(),x&&x(),w.push(I)}return v.rotateCubemap&&(S=w[0],R=w[1],w[0]=R,w[1]=S,S=w[4],R=w[5],w[4]=R,w[5]=S),x&&x(),w},loadCubeMapImage:function(g,y,x){var v=this.el.sceneEl.renderer.getContext(),_;v.pixelStorei(v.UNPACK_FLIP_Y_WEBGL,!1),v.bindTexture(v.TEXTURE_CUBE_MAP,g),!y.complete||this.loadingScreen?_=this.loadingScreenImages:_=this.generateCubeMapTextures(y,x);var T=0;_.forEach(function(w,S){v.texSubImage2D(v.TEXTURE_CUBE_MAP_POSITIVE_X+S,0,0,0,v.RGBA,v.UNSIGNED_BYTE,w),T=v.getError()}),T!==0&&console.log("renderingError, WebGL Error Code: "+T),v.bindTexture(v.TEXTURE_CUBE_MAP,null)},tick:function(){this.el.sceneEl.xrSession&&(!this.layer&&(this.el.sceneEl.is("vr-mode")||this.el.sceneEl.is("ar-mode"))&&this.initLayer(),this.updateTransform(),this.data.src.complete&&(this.pendingCubeMapUpdate||this.loadingScreen||this.visibilityChanged)&&this.loadCubeMapImages(),!(!this.needsRedraw&&!this.layer.needsRedraw&&!this.textureIsVideo)&&(this.data.type==="quad"&&this.draw(),this.needsRedraw=!1))},initLayer:function(){var g=this,y=this.data.type;if(this.el.sceneEl.xrSession.onvisibilitychange=function(x){g.visibilityChanged=x.session.visibilityState!=="hidden"},y==="quad"){this.initQuadLayer();return}if(y==="monocubemap"||y==="stereocubemap"){this.initCubeMapLayer();return}},initQuadLayer:function(){var g=this.el.sceneEl,y=g.renderer.getContext(),x=this.xrGLFactory=new XRWebGLBinding(g.xrSession,y);this.texture&&(this.layer=x.createQuadLayer({space:this.referenceSpace,viewPixelHeight:2048,viewPixelWidth:2048,height:this.data.height/2||this.texture.image.height/1e3,width:this.data.width/2||this.texture.image.width/1e3}),this.initLoadingScreenImages(),g.renderer.xr.addLayer(this.layer))},initCubeMapLayer:function(){var g=this.data.src,y=this.el.sceneEl,x=y.renderer.getContext(),v=x.getParameter(x.MAX_CUBE_MAP_TEXTURE_SIZE),_=this.cubeFaceSize=Math.min(v,Math.min(g.width,g.height)),T=this.xrGLFactory=new XRWebGLBinding(y.xrSession,x);this.layer=T.createCubeLayer({space:this.referenceSpace,viewPixelWidth:_,viewPixelHeight:_,layout:this.data.type==="monocubemap"?"mono":"stereo",isStatic:!1}),this.initLoadingScreenImages(),this.loadCubeMapImages(),y.renderer.xr.addLayer(this.layer)},initLoadingScreenImages:function(){for(var g=this.cubeFaceSize,y=this.loadingScreenImages=[],x=0;x<6;x++){var v=document.createElement("CANVAS");v.width=v.height=g;var _=v.getContext("2d");v.width=v.height=g,_.fillStyle="black",_.fillRect(0,0,g,g),x!==2&&x!==3&&(_.translate(g,0),_.scale(-1,1),_.fillStyle="white",_.font="30px Arial",_.fillText("Loading",g/2,g/2)),y.push(v)}},destroyLayer:function(){this.layer&&(this.el.sceneEl.renderer.xr.removeLayer(this.layer),this.layer.destroy(),this.layer=void 0)},toggleCompositorLayer:function(){this.enableCompositorLayer(!this.layerEnabled)},enableCompositorLayer:function(g){this.layerEnabled=g,this.quadPanelEl.object3D.visible=!this.layerEnabled},updateQuadPanel:function(){var g=this.quadPanelEl;this.quadPanelEl||(g=this.quadPanelEl=document.createElement("a-entity"),this.el.appendChild(g)),g.setAttribute("material",{shader:"flat",src:this.data.src,transparent:!0}),g.setAttribute("geometry",{primitive:"plane",height:this.data.height||this.texture.image.height/1e3,width:this.data.width||this.texture.image.height/1e3})},draw:function(){var g=this.el.sceneEl,y=this.el.sceneEl.renderer.getContext(),x=this.xrGLFactory.getSubImage(this.layer,g.frame),v=g.renderer.properties.get(this.texture).__webglTexture,_=y.getParameter(y.FRAMEBUFFER_BINDING);y.viewport(x.viewport.x,x.viewport.y,x.viewport.width,x.viewport.height),y.bindFramebuffer(y.FRAMEBUFFER,this.frameBuffer),y.framebufferTexture2D(y.FRAMEBUFFER,y.COLOR_ATTACHMENT0,y.TEXTURE_2D,x.colorTexture,0),m(y,v,x,this.data.src),y.bindFramebuffer(y.FRAMEBUFFER,_)},updateTransform:function(){var g=this.el,y=this.position,x=this.quaternion;g.object3D.updateMatrixWorld(),y.setFromMatrixPosition(g.object3D.matrixWorld),x.setFromRotationMatrix(g.object3D.matrixWorld),this.layerEnabled||y.set(0,0,1e8),this.layer.transform=new XRRigidTransform(y,x)},onEnterVR:function(){var g=this.el.sceneEl,y=g.xrSession;if(!g.hasWebXR||!XRWebGLBinding||!y){f("The layer component requires WebXR and the layers API enabled");return}y.requestReferenceSpace("local-floor").then(this.onRequestedReferenceSpace),this.layerEnabled=!0,this.quadPanelEl&&(this.quadPanelEl.object3D.visible=!1),this.data.src.play&&this.data.src.play()},onExitVR:function(){this.quadPanelEl&&(this.quadPanelEl.object3D.visible=!0),this.destroyLayer()},onRequestedReferenceSpace:function(g){this.referenceSpace=g}});function m(g,y,x,v){var _=g.createFramebuffer(),T=x.viewport.x,w=x.viewport.y,S=x.viewport.x+x.viewport.width,R=x.viewport.y+x.viewport.height;v.tagName==="VIDEO"&&(g.bindTexture(g.TEXTURE_2D,y),g.texSubImage2D(g.TEXTURE_2D,0,0,0,v.width,v.height,g.RGB,g.UNSIGNED_BYTE,v)),g.bindFramebuffer(g.READ_FRAMEBUFFER,_),g.framebufferTexture2D(g.READ_FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,y,0),g.readBuffer(g.COLOR_ATTACHMENT0),g.blitFramebuffer(0,0,v.width,v.height,T,w,S,R,g.COLOR_BUFFER_BIT,g.NEAREST),g.bindFramebuffer(g.READ_FRAMEBUFFER,null),g.deleteFramebuffer(_)}},"./src/components/light.js":(l,u,c)=>{var h=c("./src/utils/index.js"),p=h.diff,f=c("./src/utils/debug.js"),m=c("./src/core/component.js").registerComponent,g=c("./src/lib/three.js"),y=c("./src/utils/math.js"),x=g.MathUtils.degToRad,v=f("components:light:warn"),_=new g.CubeTextureLoader,T={};l.exports.Component=m("light",{schema:{angle:{default:60,if:{type:["spot"]}},color:{type:"color",if:{type:["ambient","directional","hemisphere","point","spot"]}},envMap:{default:"",if:{type:["probe"]}},groundColor:{type:"color",if:{type:["hemisphere"]}},decay:{default:1,if:{type:["point","spot"]}},distance:{default:0,min:0,if:{type:["point","spot"]}},intensity:{default:1,min:0,if:{type:["ambient","directional","hemisphere","point","spot","probe"]}},penumbra:{default:0,min:0,max:1,if:{type:["spot"]}},type:{default:"directional",oneOf:["ambient","directional","hemisphere","point","spot","probe"],schemaChange:!0},target:{type:"selector",if:{type:["spot","directional"]}},castShadow:{default:!1,if:{type:["point","spot","directional"]}},shadowBias:{default:0,if:{castShadow:!0}},shadowCameraFar:{default:500,if:{castShadow:!0}},shadowCameraFov:{default:90,if:{castShadow:!0}},shadowCameraNear:{default:.5,if:{castShadow:!0}},shadowCameraTop:{default:5,if:{castShadow:!0}},shadowCameraRight:{default:5,if:{castShadow:!0}},shadowCameraBottom:{default:-5,if:{castShadow:!0}},shadowCameraLeft:{default:-5,if:{castShadow:!0}},shadowCameraVisible:{default:!1,if:{castShadow:!0}},shadowCameraAutomatic:{default:"",if:{type:["directional"]}},shadowMapHeight:{default:512,if:{castShadow:!0}},shadowMapWidth:{default:512,if:{castShadow:!0}},shadowRadius:{default:1,if:{castShadow:!0}}},init:function(){var w=this.el;this.light=null,this.defaultTarget=null,this.system.registerLight(w)},update:function(w){var S=this.data,R=p(S,w),B=this.light,I=this;if(B&&!("type"in R)){var D=!1;Object.keys(R).forEach(function(L){var O=S[L];switch(L){case"color":{B.color.set(O);break}case"groundColor":{B.groundColor.set(O);break}case"angle":{B.angle=x(O);break}case"target":{O===null?(S.type==="spot"||S.type==="directional")&&(B.target=I.defaultTarget):O.hasLoaded?I.onSetTarget(O,B):O.addEventListener("loaded",I.onSetTarget.bind(I,O,B));break}case"envMap":I.updateProbeMap(S,B);break;case"castShadow":case"shadowBias":case"shadowCameraFar":case"shadowCameraFov":case"shadowCameraNear":case"shadowCameraTop":case"shadowCameraRight":case"shadowCameraBottom":case"shadowCameraLeft":case"shadowCameraVisible":case"shadowMapHeight":case"shadowMapWidth":case"shadowRadius":D||(I.updateShadow(),D=!0);break;case"shadowCameraAutomatic":S.shadowCameraAutomatic?I.shadowCameraAutomaticEls=Array.from(document.querySelectorAll(S.shadowCameraAutomatic)):I.shadowCameraAutomaticEls=[];break;default:B[L]=O}});return}this.setLight(this.data),this.updateShadow()},tick:function(){var w=new g.Box3,S=new g.Vector3,R=new g.Vector3,B=new g.Matrix4,I=new g.Sphere,D=new g.Vector3;return function(){if(this.data.type==="directional"&&this.light.shadow&&this.light.shadow.camera instanceof g.OrthographicCamera&&this.shadowCameraAutomaticEls.length){var L=this.light.shadow.camera;L.getWorldDirection(S),L.getWorldPosition(R),B.copy(L.matrixWorld),B.invert(),L.near=1,L.left=1e5,L.right=-1e5,L.top=-1e5,L.bottom=1e5,this.shadowCameraAutomaticEls.forEach(function(O){w.setFromObject(O.object3D),w.getBoundingSphere(I);var U=y.distanceOfPointFromPlane(R,S,I.center),Z=y.nearestPointInPlane(R,S,I.center,D),G=Z.applyMatrix4(B);L.near=Math.min(-U-I.radius-1,L.near),L.left=Math.min(-I.radius+G.x,L.left),L.right=Math.max(I.radius+G.x,L.right),L.top=Math.max(I.radius+G.y,L.top),L.bottom=Math.min(-I.radius+G.y,L.bottom)}),L.updateProjectionMatrix()}}}(),setLight:function(w){var S=this.el,R=this.getLight(w);R&&(this.light&&S.removeObject3D("light"),this.light=R,this.light.el=S,S.setObject3D("light",this.light),(w.type==="spot"||w.type==="directional"||w.type==="hemisphere")&&S.getObject3D("light").translateY(-1),w.type==="spot"&&(S.setObject3D("light-target",this.defaultTarget),S.getObject3D("light-target").position.set(0,0,-1)),w.shadowCameraAutomatic?this.shadowCameraAutomaticEls=Array.from(document.querySelectorAll(w.shadowCameraAutomatic)):this.shadowCameraAutomaticEls=[])},updateShadow:function(){var w=this.el,S=this.data,R=this.light;R.castShadow=S.castShadow;var B=w.getObject3D("cameraHelper");if(S.shadowCameraVisible&&!B?w.setObject3D("cameraHelper",new g.CameraHelper(R.shadow.camera)):!S.shadowCameraVisible&&B&&w.removeObject3D("cameraHelper"),!S.castShadow)return R;R.shadow.bias=S.shadowBias,R.shadow.radius=S.shadowRadius,R.shadow.mapSize.height=S.shadowMapHeight,R.shadow.mapSize.width=S.shadowMapWidth,R.shadow.camera.near=S.shadowCameraNear,R.shadow.camera.far=S.shadowCameraFar,R.shadow.camera instanceof g.OrthographicCamera?(R.shadow.camera.top=S.shadowCameraTop,R.shadow.camera.right=S.shadowCameraRight,R.shadow.camera.bottom=S.shadowCameraBottom,R.shadow.camera.left=S.shadowCameraLeft):R.shadow.camera.fov=S.shadowCameraFov,R.shadow.camera.updateProjectionMatrix(),B&&B.update()},getLight:function(w){var S=w.angle,R=new g.Color(w.color);R=R.getHex();var B=w.decay,I=w.distance,D=new g.Color(w.groundColor);D=D.getHex();var L=w.intensity,O=w.type,U=w.target,Z=null;switch(O.toLowerCase()){case"ambient":return new g.AmbientLight(R,L);case"directional":return Z=new g.DirectionalLight(R,L),this.defaultTarget=Z.target,U&&(U.hasLoaded?this.onSetTarget(U,Z):U.addEventListener("loaded",this.onSetTarget.bind(this,U,Z))),Z;case"hemisphere":return new g.HemisphereLight(R,D,L);case"point":return new g.PointLight(R,L,I,B);case"spot":return Z=new g.SpotLight(R,L,I,x(S),w.penumbra,B),this.defaultTarget=Z.target,U&&(U.hasLoaded?this.onSetTarget(U,Z):U.addEventListener("loaded",this.onSetTarget.bind(this,U,Z))),Z;case"probe":return Z=new g.LightProbe,this.updateProbeMap(w,Z),Z;default:v("%s is not a valid light type. Choose from ambient, directional, hemisphere, point, spot.",O)}},updateProbeMap:function(w,S){w.envMap||S.copy(new g.LightProbe),T[w.envMap]instanceof window.Promise&&T[w.envMap].then(function(R){S.copy(R)}),T[w.envMap]instanceof g.LightProbe&&S.copy(T[w.envMap]),T[w.envMap]=new window.Promise(function(R){h.srcLoader.validateCubemapSrc(w.envMap,function(B){_.load(B,function(I){var D=g.LightProbeGenerator.fromCubeTexture(I);T[w.envMap]=D,S.copy(D)})})})},onSetTarget:function(w,S){S.target=w.object3D},remove:function(){var w=this.el;w.removeObject3D("light"),w.getObject3D("cameraHelper")&&w.removeObject3D("cameraHelper")}})},"./src/components/line.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent;l.exports.Component=h("line",{schema:{start:{type:"vec3",default:{x:0,y:0,z:0}},end:{type:"vec3",default:{x:0,y:0,z:0}},color:{type:"color",default:"#74BEC1"},opacity:{type:"number",default:1},visible:{default:!0}},multiple:!0,init:function(){var f=this.data,m,g;g=this.material=new THREE.LineBasicMaterial({color:f.color,opacity:f.opacity,transparent:f.opacity<1,visible:f.visible}),m=this.geometry=new THREE.BufferGeometry,m.setAttribute("position",new THREE.BufferAttribute(new Float32Array(6),3)),this.line=new THREE.Line(m,g),this.el.setObject3D(this.attrName,this.line)},update:function(f){var m=this.data,g=this.geometry,y=!1,x=this.material,v=g.attributes.position.array;p(m.start,f.start)||(v[0]=m.start.x,v[1]=m.start.y,v[2]=m.start.z,y=!0),p(m.end,f.end)||(v[3]=m.end.x,v[4]=m.end.y,v[5]=m.end.z,y=!0),y&&(g.attributes.position.needsUpdate=!0,g.computeBoundingSphere()),x.color.setStyle(m.color),x.opacity=m.opacity,x.transparent=m.opacity<1,x.visible=m.visible},remove:function(){this.el.removeObject3D(this.attrName,this.line)}});function p(f,m){return!f||!m?!1:f.x===m.x&&f.y===m.y&&f.z===m.z}},"./src/components/link.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent,p=c("./src/core/shader.js").registerShader,f=c("./src/lib/three.js");l.exports.Component=h("link",{schema:{backgroundColor:{default:"red",type:"color"},borderColor:{default:"white",type:"color"},highlighted:{default:!1},highlightedColor:{default:"#24CAFF",type:"color"},href:{default:""},image:{type:"asset"},on:{default:"click"},peekMode:{default:!1},title:{default:""},titleColor:{default:"white",type:"color"},visualAspectEnabled:{default:!1}},init:function(){this.navigate=this.navigate.bind(this),this.previousQuaternion=void 0,this.quaternionClone=new f.Quaternion,this.hiddenEls=[]},update:function(m){var g=this.data,y=this.el,x,v;g.visualAspectEnabled&&(this.initVisualAspect(),x=g.highlighted?g.highlightedColor:g.backgroundColor,v=g.highlighted?g.highlightedColor:g.borderColor,y.setAttribute("material","backgroundColor",x),y.setAttribute("material","strokeColor",v),g.on!==m.on&&this.updateEventListener(),m.peekMode!==void 0&&g.peekMode!==m.peekMode&&this.updatePeekMode(),!(!g.image||m.image===g.image)&&y.setAttribute("material","pano",typeof g.image=="string"?g.image:g.image.src))},updatePeekMode:function(){var m=this.el,g=this.sphereEl;this.data.peekMode?(this.hideAll(),m.getObject3D("mesh").visible=!1,g.setAttribute("visible",!0)):(this.showAll(),m.getObject3D("mesh").visible=!0,g.setAttribute("visible",!1))},play:function(){this.updateEventListener()},pause:function(){this.removeEventListener()},updateEventListener:function(){var m=this.el;m.isPlaying&&(this.removeEventListener(),m.addEventListener(this.data.on,this.navigate))},removeEventListener:function(){var m=this.data.on;m&&this.el.removeEventListener(m,this.navigate)},initVisualAspect:function(){var m=this.el,g,y,x;!this.data.visualAspectEnabled||this.visualAspectInitialized||(x=this.textEl=this.textEl||document.createElement("a-entity"),y=this.sphereEl=this.sphereEl||document.createElement("a-entity"),g=this.semiSphereEl=this.semiSphereEl||document.createElement("a-entity"),m.setAttribute("geometry",{primitive:"circle",radius:1,segments:64}),m.setAttribute("material",{shader:"portal",pano:this.data.image,side:"double"}),x.setAttribute("text",{color:this.data.titleColor,align:"center",font:"kelsonsans",value:this.data.title||this.data.href,width:4}),x.setAttribute("position","0 1.5 0"),m.appendChild(x),g.setAttribute("geometry",{primitive:"sphere",radius:1,phiStart:0,segmentsWidth:64,segmentsHeight:64,phiLength:180,thetaStart:0,thetaLength:360}),g.setAttribute("material",{shader:"portal",borderEnabled:0,pano:this.data.image,side:"back"}),g.setAttribute("rotation","0 180 0"),g.setAttribute("position","0 0 0"),g.setAttribute("visible",!1),m.appendChild(g),y.setAttribute("geometry",{primitive:"sphere",radius:10,segmentsWidth:64,segmentsHeight:64}),y.setAttribute("material",{shader:"portal",borderEnabled:0,pano:this.data.image,side:"back"}),y.setAttribute("visible",!1),m.appendChild(y),this.visualAspectInitialized=!0)},navigate:function(){window.location=this.data.href},tick:function(){var m=new f.Vector3,g=new f.Vector3,y=new f.Quaternion,x=new f.Vector3;return function(){var v=this.el,_=v.object3D,T=v.sceneEl.camera,w,S,R=this.textEl;if(this.data.visualAspectEnabled)if(_.updateMatrixWorld(),T.parent.updateMatrixWorld(),T.updateMatrixWorld(),_.matrix.decompose(g,y,x),g.setFromMatrixPosition(_.matrixWorld),m.setFromMatrixPosition(T.matrixWorld),S=g.distanceTo(m),S>20)this.previousQuaternion||(this.quaternionClone.copy(y),this.previousQuaternion=this.quaternionClone),_.lookAt(m);else{if(w=this.calculateCameraPortalOrientation(),S<.5){if(this.semiSphereEl.getAttribute("visible")===!0)return;R.setAttribute("text","width",1.5),w<=0?(R.setAttribute("position","0 0 0.75"),R.setAttribute("rotation","0 180 0"),this.semiSphereEl.setAttribute("rotation","0 0 0")):(R.setAttribute("position","0 0 -0.75"),R.setAttribute("rotation","0 0 0"),this.semiSphereEl.setAttribute("rotation","0 180 0")),v.getObject3D("mesh").visible=!1,this.semiSphereEl.setAttribute("visible",!0),this.peekCameraPortalOrientation=w}else w<=0?R.setAttribute("rotation","0 180 0"):R.setAttribute("rotation","0 0 0"),R.setAttribute("text","width",5),R.setAttribute("position","0 1.5 0"),v.getObject3D("mesh").visible=!0,this.semiSphereEl.setAttribute("visible",!1),this.peekCameraPortalOrientation=void 0;this.previousQuaternion&&(_.quaternion.copy(this.previousQuaternion),this.previousQuaternion=void 0)}}}(),hideAll:function(){var m=this.el,g=this.hiddenEls,y=this;g.length>0||m.sceneEl.object3D.traverse(function(x){x&&x.el&&x.el.hasAttribute("link-controls")||!x.el||x===m.sceneEl.object3D||x.el===m||x.el===y.sphereEl||x.el===m.sceneEl.cameraEl||x.el.getAttribute("visible")===!1||x.el===y.textEl||x.el===y.semiSphereEl||(x.el.setAttribute("visible",!1),g.push(x.el))})},showAll:function(){this.hiddenEls.forEach(function(m){m.setAttribute("visible",!0)}),this.hiddenEls=[]},calculateCameraPortalOrientation:function(){var m=new f.Matrix4,g=new f.Vector3,y=new f.Vector3(0,0,1),x=new f.Vector3(0,0,0);return function(){var v=this.el,_=v.sceneEl.camera;return g.set(0,0,0),y.set(0,0,1),x.set(0,0,0),v.object3D.matrixWorld.extractRotation(m),y.applyMatrix4(m),v.object3D.updateMatrixWorld(),v.object3D.localToWorld(x),_.parent.parent.updateMatrixWorld(),_.parent.updateMatrixWorld(),_.updateMatrixWorld(),_.localToWorld(g),g.sub(x).normalize(),y.normalize(),Math.sign(y.dot(g))}}(),remove:function(){this.removeEventListener()}}),p("portal",{schema:{borderEnabled:{default:1,type:"int",is:"uniform"},backgroundColor:{default:"red",type:"color",is:"uniform"},pano:{type:"map",is:"uniform"},strokeColor:{default:"white",type:"color",is:"uniform"}},vertexShader:["vec3 portalPosition;","varying vec3 vWorldPosition;","varying float vDistanceToCenter;","varying float vDistance;","void main() {","vDistanceToCenter = clamp(length(position - vec3(0.0, 0.0, 0.0)), 0.0, 1.0);","portalPosition = (modelMatrix * vec4(0.0, 0.0, 0.0, 1.0)).xyz;","vDistance = length(portalPosition - cameraPosition);","vWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","}"].join(`
`),fragmentShader:["#define RECIPROCAL_PI2 0.15915494","uniform sampler2D pano;","uniform vec3 strokeColor;","uniform vec3 backgroundColor;","uniform float borderEnabled;","varying float vDistanceToCenter;","varying float vDistance;","varying vec3 vWorldPosition;","void main() {","vec3 direction = normalize(vWorldPosition - cameraPosition);","vec2 sampleUV;","float borderThickness = clamp(exp(-vDistance / 50.0), 0.6, 0.95);","sampleUV.y = clamp(direction.y * 0.5  + 0.5, 0.0, 1.0);","sampleUV.x = atan(direction.z, -direction.x) * -RECIPROCAL_PI2 + 0.5;","if (vDistanceToCenter > borderThickness && borderEnabled == 1.0) {","gl_FragColor = vec4(strokeColor, 1.0);","} else {","gl_FragColor = mix(texture2D(pano, sampleUV), vec4(backgroundColor, 1.0), clamp(pow((vDistance / 15.0), 2.0), 0.0, 1.0));","}","}"].join(`
`)})},"./src/components/look-controls.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent,p=c("./src/lib/three.js"),f=c("./src/utils/index.js"),m=Math.PI/2;l.exports.Component=h("look-controls",{dependencies:["position","rotation"],schema:{enabled:{default:!0},magicWindowTrackingEnabled:{default:!0},pointerLockEnabled:{default:!1},reverseMouseDrag:{default:!1},reverseTouchDrag:{default:!1},touchEnabled:{default:!0},mouseEnabled:{default:!0}},init:function(){this.deltaYaw=0,this.previousHMDPosition=new p.Vector3,this.hmdQuaternion=new p.Quaternion,this.magicWindowAbsoluteEuler=new p.Euler,this.magicWindowDeltaEuler=new p.Euler,this.position=new p.Vector3,this.magicWindowObject=new p.Object3D,this.rotation={},this.deltaRotation={},this.savedPose=null,this.pointerLocked=!1,this.setupMouseControls(),this.bindMethods(),this.previousMouseEvent={},this.setupMagicWindowControls(),this.savedPose={position:new p.Vector3,rotation:new p.Euler},(this.el.sceneEl.is("vr-mode")||this.el.sceneEl.is("ar-mode"))&&this.onEnterVR()},setupMagicWindowControls:function(){var g,y=this.data;(f.device.isMobile()||f.device.isMobileDeviceRequestingDesktopSite())&&(g=this.magicWindowControls=new p.DeviceOrientationControls(this.magicWindowObject),typeof DeviceOrientationEvent<"u"&&DeviceOrientationEvent.requestPermission&&(g.enabled=!1,this.el.sceneEl.components["device-orientation-permission-ui"].permissionGranted?g.enabled=y.magicWindowTrackingEnabled:this.el.sceneEl.addEventListener("deviceorientationpermissiongranted",function(){g.enabled=y.magicWindowTrackingEnabled})))},update:function(g){var y=this.data;y.enabled!==g.enabled&&this.updateGrabCursor(y.enabled),g&&!y.magicWindowTrackingEnabled&&g.magicWindowTrackingEnabled&&(this.magicWindowAbsoluteEuler.set(0,0,0),this.magicWindowDeltaEuler.set(0,0,0)),this.magicWindowControls&&(this.magicWindowControls.enabled=y.magicWindowTrackingEnabled),g&&!y.pointerLockEnabled!==g.pointerLockEnabled&&(this.removeEventListeners(),this.addEventListeners(),this.pointerLocked&&this.exitPointerLock())},tick:function(g){var y=this.data;y.enabled&&this.updateOrientation()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.pointerLocked&&this.exitPointerLock()},remove:function(){this.removeEventListeners(),this.pointerLocked&&this.exitPointerLock()},bindMethods:function(){this.onMouseDown=this.onMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onTouchStart=this.onTouchStart.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onEnterVR=this.onEnterVR.bind(this),this.onExitVR=this.onExitVR.bind(this),this.onPointerLockChange=this.onPointerLockChange.bind(this),this.onPointerLockError=this.onPointerLockError.bind(this)},setupMouseControls:function(){this.mouseDown=!1,this.pitchObject=new p.Object3D,this.yawObject=new p.Object3D,this.yawObject.position.y=10,this.yawObject.add(this.pitchObject)},addEventListeners:function(){var g=this.el.sceneEl,y=g.canvas;if(!y){g.addEventListener("render-target-loaded",this.addEventListeners.bind(this));return}y.addEventListener("mousedown",this.onMouseDown,!1),window.addEventListener("mousemove",this.onMouseMove,!1),window.addEventListener("mouseup",this.onMouseUp,!1),y.addEventListener("touchstart",this.onTouchStart,{passive:!0}),window.addEventListener("touchmove",this.onTouchMove,{passive:!0}),window.addEventListener("touchend",this.onTouchEnd,{passive:!0}),g.addEventListener("enter-vr",this.onEnterVR),g.addEventListener("exit-vr",this.onExitVR),this.data.pointerLockEnabled&&(document.addEventListener("pointerlockchange",this.onPointerLockChange,!1),document.addEventListener("mozpointerlockchange",this.onPointerLockChange,!1),document.addEventListener("pointerlockerror",this.onPointerLockError,!1))},removeEventListeners:function(){var g=this.el.sceneEl,y=g&&g.canvas;y&&(y.removeEventListener("mousedown",this.onMouseDown),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp),y.removeEventListener("touchstart",this.onTouchStart),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd),g.removeEventListener("enter-vr",this.onEnterVR),g.removeEventListener("exit-vr",this.onExitVR),document.removeEventListener("pointerlockchange",this.onPointerLockChange,!1),document.removeEventListener("mozpointerlockchange",this.onPointerLockChange,!1),document.removeEventListener("pointerlockerror",this.onPointerLockError,!1))},updateOrientation:function(){var g=this.el.object3D,y=this.pitchObject,x=this.yawObject,v=this.el.sceneEl;(v.is("vr-mode")||v.is("ar-mode"))&&v.checkHeadsetConnected()||(this.updateMagicWindowOrientation(),g.rotation.x=this.magicWindowDeltaEuler.x+y.rotation.x,g.rotation.y=this.magicWindowDeltaEuler.y+x.rotation.y,g.rotation.z=this.magicWindowDeltaEuler.z)},updateMagicWindowOrientation:function(){var g=this.magicWindowAbsoluteEuler,y=this.magicWindowDeltaEuler;this.magicWindowControls&&this.magicWindowControls.enabled&&(this.magicWindowControls.update(),g.setFromQuaternion(this.magicWindowObject.quaternion,"YXZ"),!this.previousMagicWindowYaw&&g.y!==0&&(this.previousMagicWindowYaw=g.y),this.previousMagicWindowYaw&&(y.x=g.x,y.y+=g.y-this.previousMagicWindowYaw,y.z=g.z,this.previousMagicWindowYaw=g.y))},onMouseMove:function(g){var y,x,v,_=this.pitchObject,T=this.previousMouseEvent,w=this.yawObject;!this.data.enabled||!this.mouseDown&&!this.pointerLocked||(this.pointerLocked?(x=g.movementX||g.mozMovementX||0,v=g.movementY||g.mozMovementY||0):(x=g.screenX-T.screenX,v=g.screenY-T.screenY),this.previousMouseEvent.screenX=g.screenX,this.previousMouseEvent.screenY=g.screenY,y=this.data.reverseMouseDrag?1:-1,w.rotation.y+=x*.002*y,_.rotation.x+=v*.002*y,_.rotation.x=Math.max(-m,Math.min(m,_.rotation.x)))},onMouseDown:function(g){var y=this.el.sceneEl;if(!(!this.data.enabled||!this.data.mouseEnabled||(y.is("vr-mode")||y.is("ar-mode"))&&y.checkHeadsetConnected())&&g.button===0){var x=y&&y.canvas;this.mouseDown=!0,this.previousMouseEvent.screenX=g.screenX,this.previousMouseEvent.screenY=g.screenY,this.showGrabbingCursor(),this.data.pointerLockEnabled&&!this.pointerLocked&&(x.requestPointerLock?x.requestPointerLock():x.mozRequestPointerLock&&x.mozRequestPointerLock())}},showGrabbingCursor:function(){this.el.sceneEl.canvas.style.cursor="grabbing"},hideGrabbingCursor:function(){this.el.sceneEl.canvas.style.cursor=""},onMouseUp:function(){this.mouseDown=!1,this.hideGrabbingCursor()},onTouchStart:function(g){g.touches.length!==1||!this.data.touchEnabled||this.el.sceneEl.is("vr-mode")||this.el.sceneEl.is("ar-mode")||(this.touchStart={x:g.touches[0].pageX,y:g.touches[0].pageY},this.touchStarted=!0)},onTouchMove:function(g){var y,x=this.el.sceneEl.canvas,v,_=this.yawObject;!this.touchStarted||!this.data.touchEnabled||(v=2*Math.PI*(g.touches[0].pageX-this.touchStart.x)/x.clientWidth,y=this.data.reverseTouchDrag?1:-1,_.rotation.y-=v*.5*y,this.touchStart={x:g.touches[0].pageX,y:g.touches[0].pageY})},onTouchEnd:function(){this.touchStarted=!1},onEnterVR:function(){var g=this.el.sceneEl;g.checkHeadsetConnected()&&(this.saveCameraPose(),this.el.object3D.position.set(0,0,0),this.el.object3D.rotation.set(0,0,0),g.hasWebXR&&(this.el.object3D.matrixAutoUpdate=!1,this.el.object3D.updateMatrix()))},onExitVR:function(){this.el.sceneEl.checkHeadsetConnected()&&(this.restoreCameraPose(),this.previousHMDPosition.set(0,0,0),this.el.object3D.matrixAutoUpdate=!0)},onPointerLockChange:function(){this.pointerLocked=!!(document.pointerLockElement||document.mozPointerLockElement)},onPointerLockError:function(){this.pointerLocked=!1},exitPointerLock:function(){document.exitPointerLock(),this.pointerLocked=!1},updateGrabCursor:function(g){var y=this.el.sceneEl;function x(){y.canvas.classList.add("a-grab-cursor")}function v(){y.canvas.classList.remove("a-grab-cursor")}if(!y.canvas){g?y.addEventListener("render-target-loaded",x):y.addEventListener("render-target-loaded",v);return}if(g){x();return}v()},saveCameraPose:function(){var g=this.el;this.savedPose.position.copy(g.object3D.position),this.savedPose.rotation.copy(g.object3D.rotation),this.hasSavedPose=!0},restoreCameraPose:function(){var g=this.el,y=this.savedPose;this.hasSavedPose&&(g.object3D.position.copy(y.position),g.object3D.rotation.copy(y.rotation),this.hasSavedPose=!1)}})},"./src/components/magicleap-controls.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent,p=c("./src/utils/tracked-controls.js"),f=p.checkControllerPresentAndSetup,m=p.emitIfAxesChanged,g=p.onButtonEvent,y="magicleap",x="-one",v=y+x,_=c("./src/constants/index.js").AFRAME_CDN_ROOT,T=_+"controllers/magicleap/magicleap-one-controller.glb",w={axes:{touchpad:[0,1]},buttons:["trigger","grip","touchpad","menu"]};l.exports.Component=h("magicleap-controls",{schema:{hand:{default:"none"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:w,init:function(){var S=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(R){g(R.detail.id,"down",S)},this.onButtonUp=function(R){g(R.detail.id,"up",S)},this.onButtonTouchEnd=function(R){g(R.detail.id,"touchend",S)},this.onButtonTouchStart=function(R){g(R.detail.id,"touchstart",S)},this.previousButtonValues={},this.bindMethods()},update:function(){var S=this.data;this.controllerIndex=S.hand==="right"?0:S.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},addEventListeners:function(){var S=this.el;S.addEventListener("buttonchanged",this.onButtonChanged),S.addEventListener("buttondown",this.onButtonDown),S.addEventListener("buttonup",this.onButtonUp),S.addEventListener("touchstart",this.onButtonTouchStart),S.addEventListener("touchend",this.onButtonTouchEnd),S.addEventListener("axismove",this.onAxisMoved),S.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var S=this.el;S.removeEventListener("buttonchanged",this.onButtonChanged),S.removeEventListener("buttondown",this.onButtonDown),S.removeEventListener("buttonup",this.onButtonUp),S.removeEventListener("touchstart",this.onButtonTouchStart),S.removeEventListener("touchend",this.onButtonTouchEnd),S.removeEventListener("axismove",this.onAxisMoved),S.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var S=this.data;f(this,v,{index:this.controllerIndex,hand:S.hand})},injectTrackedControls:function(){var S=this.el,R=this.data;S.setAttribute("tracked-controls",{idPrefix:v,hand:R.hand,controller:this.controllerIndex,orientationOffset:R.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",T)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(S){var R=this.mapping.buttons[S.detail.id],B;R&&(R==="trigger"&&(B=S.detail.state.value,console.log("analog value of trigger press: "+B)),this.el.emit(R+"changed",S.detail.state))},onModelLoaded:function(S){var R=S.detail.model;R.scale.set(.01,.01,.01)},onAxisMoved:function(S){m(this,this.mapping.axes,S)},updateModel:function(S,R){},setButtonColor:function(S,R){}})},"./src/components/material.js":(l,u,c)=>{var h=c("./src/utils/index.js"),p=c("./src/core/component.js"),f=c("./src/lib/three.js"),m=c("./src/core/shader.js"),g=h.debug("components:material:error"),y=p.registerComponent,x=m.shaders,v=m.shaderNames;l.exports.Component=y("material",{schema:{alphaTest:{default:0,min:0,max:1},depthTest:{default:!0},depthWrite:{default:!0},flatShading:{default:!1},npot:{default:!1},offset:{type:"vec2",default:{x:0,y:0}},opacity:{default:1,min:0,max:1},repeat:{type:"vec2",default:{x:1,y:1}},shader:{default:"standard",oneOf:v,schemaChange:!0},side:{default:"front",oneOf:["front","back","double"]},transparent:{default:!1},vertexColorsEnabled:{default:!1},visible:{default:!0},blending:{default:"normal",oneOf:["none","normal","additive","subtractive","multiply"]},dithering:{default:!0},anisotropy:{default:0,min:0}},init:function(){this.material=null},update:function(S){var R=this.data;(!this.shader||R.shader!==S.shader)&&this.updateShader(R.shader),this.shader.update(this.data),this.updateMaterial(S)},updateSchema:function(S){var R,B,I,D;B=S&&S.shader,R=this.oldData&&this.oldData.shader,D=B||R,I=x[D]&&x[D].schema,I||g("Unknown shader schema "+D),!(R&&B===R)&&(this.extendSchema(I),this.updateBehavior())},updateBehavior:function(){var S,R=this.el.sceneEl,B=this.schema,I=this,D;function L(O,U){var Z;for(Z in D)D[Z]=O;I.shader.update(D)}this.tick=void 0,D={};for(S in B)B[S].type==="time"&&(this.tick=L,D[S]=!0);R&&(this.tick?R.addBehavior(this):R.removeBehavior(this))},updateShader:function(S){var R=this.data,B=x[S]&&x[S].Shader,I;if(!B)throw new Error("Unknown shader "+S);I=this.shader=new B,I.el=this.el,I.init(R),this.setMaterial(I.material),this.updateSchema(R)},updateMaterial:function(S){var R=this.data,B=this.material,I;B.alphaTest=R.alphaTest,B.depthTest=R.depthTest!==!1,B.depthWrite=R.depthWrite!==!1,B.opacity=R.opacity,B.flatShading=R.flatShading,B.side=_(R.side),B.transparent=R.transparent!==!1||R.opacity<1,B.vertexColors=R.vertexColorsEnabled,B.visible=R.visible,B.blending=T(R.blending),B.dithering=R.dithering;for(I in S)break;I&&(S.alphaTest!==R.alphaTest||S.side!==R.side||S.vertexColorsEnabled!==R.vertexColorsEnabled)&&(B.needsUpdate=!0)},remove:function(){var S=new f.MeshBasicMaterial,R=this.material,B=this.el.getObject3D("mesh");B&&(B.material=S),w(R,this.system)},setMaterial:function(S){var R=this.el,B,I=this.system;this.material&&w(this.material,I),this.material=S,I.registerMaterial(S),B=R.getObject3D("mesh"),B?B.material=S:R.addEventListener("object3dset",function D(L){L.detail.type!=="mesh"||L.target!==R||(R.getObject3D("mesh").material=S,R.removeEventListener("object3dset",D))})}});function _(S){switch(S){case"back":return f.BackSide;case"double":return f.DoubleSide;default:return f.FrontSide}}function T(S){switch(S){case"none":return f.NoBlending;case"additive":return f.AdditiveBlending;case"subtractive":return f.SubtractiveBlending;case"multiply":return f.MultiplyBlending;default:return f.NormalBlending}}function w(S,R){S.dispose(),R.unregisterMaterial(S),Object.keys(S).filter(function(B){return S[B]&&S[B].isTexture}).forEach(function(B){S[B].dispose()})}},"./src/components/obb-collider.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent,p=c("./src/lib/three.js");h("obb-collider",{schema:{size:{default:0},trackedObject3D:{default:""},minimumColliderDimension:{default:.02},centerModel:{default:!1}},init:function(){this.previousScale=new p.Vector3().copy(this.el.object3D.scale),this.auxEuler=new p.Euler,this.boundingBox=new p.Box3,this.boundingBoxSize=new p.Vector3,this.updateCollider=this.updateCollider.bind(this),this.onModelLoaded=this.onModelLoaded.bind(this),this.updateBoundingBox=this.updateBoundingBox.bind(this),this.el.addEventListener("model-loaded",this.onModelLoaded),this.updateCollider(),this.system.addCollider(this.el)},remove:function(){this.system.removeCollider(this.el)},update:function(){this.data.trackedObject3D&&(this.trackedObject3DPath=this.data.trackedObject3D.split("."))},onModelLoaded:function(){this.data.centerModel&&this.centerModel(),this.updateCollider()},centerModel:function(){var f=this.el,m=f.components["gltf-model"]&&f.components["gltf-model"].model,g,y;m&&(this.el.removeObject3D("mesh"),g=new p.Box3().setFromObject(m),y=g.getCenter(new p.Vector3),m.position.x+=m.position.x-y.x,m.position.y+=m.position.y-y.y,m.position.z+=m.position.z-y.z,this.el.setObject3D("mesh",m))},updateCollider:function(){var f=this.el,m=this.boundingBoxSize,g=this.aabb=this.aabb||new p.OBB;if(this.obb=this.obb||new p.OBB,!f.hasLoaded){f.addEventListener("loaded",this.updateCollider);return}this.updateBoundingBox(),g.halfSize.copy(m).multiplyScalar(.5),this.el.sceneEl.systems["obb-collider"].data.showColliders&&this.showCollider()},showCollider:function(){this.updateColliderMesh(),this.renderColliderMesh.visible=!0},updateColliderMesh:function(){var f=this.renderColliderMesh,m=this.boundingBoxSize;if(!f){this.initColliderMesh();return}f.geometry.dispose(),f.geometry=new p.BoxGeometry(m.x,m.y,m.z)},hideCollider:function(){this.renderColliderMesh&&(this.renderColliderMesh.visible=!1)},initColliderMesh:function(){var f,m,g;f=this.boundingBoxSize,m=this.renderColliderGeometry=new p.BoxGeometry(f.x,f.y,f.z),g=this.renderColliderMesh=new p.Mesh(m,new p.MeshLambertMaterial({color:65280,side:p.DoubleSide})),g.matrixAutoUpdate=!1,g.matrixWorldAutoUpdate=!1,g.updateMatrixWorld=function(){},this.el.sceneEl.object3D.add(g)},updateBoundingBox:function(){var f=new p.Vector3,m=new p.Vector3,g=new p.Quaternion,y=new p.Quaternion,x=new p.Matrix4;return function(){var v=this.auxEuler,_=this.boundingBox,T=this.data.size,w=this.trackedObject3D||this.el.object3D,S=this.boundingBoxSize,R=this.data.minimumColliderDimension;if(T){this.boundingBoxSize.x=T,this.boundingBoxSize.y=T,this.boundingBoxSize.z=T;return}v.copy(w.rotation),w.rotation.set(0,0,0),w.parent.matrixWorld.decompose(f,g,m),x.compose(f,y,m),w.parent.matrixWorld.copy(x),_.setFromObject(w,!0),_.getSize(S),S.x=S.x<R?R:S.x,S.y=S.y<R?R:S.y,S.z=S.z<R?R:S.z,w.parent.matrixWorld.compose(f,g,m),this.el.object3D.rotation.copy(v)}}(),checkTrackedObject:function(){var f=this.trackedObject3DPath,m;if(f&&f.length&&!this.trackedObject3D){m=this.el;for(var g=0;g<f.length&&(m=m[f[g]],!!m);g++);m&&(this.trackedObject3D=m,this.updateCollider())}return this.trackedObject3D},tick:function(){var f=new p.Vector3,m=new p.Vector3,g=new p.Quaternion,y=new p.Matrix4;return function(){var x=this.obb,v=this.renderColliderMesh,_=this.checkTrackedObject()||this.el.object3D;_&&(_.updateMatrix(),_.updateMatrixWorld(!0),_.matrixWorld.decompose(f,g,m),(Math.abs(m.x-this.previousScale.x)>1e-4||Math.abs(m.y-this.previousScale.y)>1e-4||Math.abs(m.z-this.previousScale.z)>1e-4)&&this.updateCollider(),this.previousScale.copy(m),m.set(1,1,1),y.compose(f,g,m),v&&v.matrixWorld.copy(y),x.copy(this.aabb),x.applyMatrix4(y))}}()})},"./src/components/obj-model.js":(l,u,c)=>{var h=c("./src/utils/debug.js"),p=c("./src/core/component.js").registerComponent,f=c("./src/lib/three.js"),m=h("components:obj-model:warn");l.exports.Component=p("obj-model",{schema:{mtl:{type:"model"},obj:{type:"model"}},init:function(){var g=this;this.model=null,this.objLoader=new f.OBJLoader,this.mtlLoader=new f.MTLLoader(this.objLoader.manager),this.mtlLoader.crossOrigin="",this.el.addEventListener("componentinitialized",function(y){g.model&&y.detail.name==="material"&&g.applyMaterial()})},update:function(){var g=this.data;g.obj&&(this.resetMesh(),this.loadObj(g.obj,g.mtl))},remove:function(){this.resetMesh()},resetMesh:function(){this.model&&this.el.removeObject3D("mesh")},loadObj:function(g,y){var x=this,v=this.el,_=this.mtlLoader,T=this.objLoader,w=this.el.sceneEl.systems.renderer,S=y.substr(0,y.lastIndexOf("/")+1);if(y){v.hasAttribute("material")&&m("Material component properties are ignored when a .MTL is provided"),_.setResourcePath(S),_.load(y,function(R){R.preload(),T.setMaterials(R),T.load(g,function(B){x.model=B,x.model.traverse(function(I){if(I.isMesh){var D=I.material;D.map&&w.applyColorCorrection(D.map),D.emissiveMap&&w.applyColorCorrection(D.emissiveMap)}}),v.setObject3D("mesh",B),v.emit("model-loaded",{format:"obj",model:B})})});return}T.load(g,function(R){x.model=R,x.applyMaterial(),v.setObject3D("mesh",R),v.emit("model-loaded",{format:"obj",model:R})})},applyMaterial:function(){var g=this.el.components.material;g&&this.model.traverse(function(y){y instanceof f.Mesh&&(y.material=g.material)})}})},"./src/components/oculus-go-controls.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent,p=c("./src/utils/tracked-controls.js"),f=p.checkControllerPresentAndSetup,m=p.emitIfAxesChanged,g=p.onButtonEvent,y=c("./src/utils/index.js").device.isWebXRAvailable,x="oculus-go",v="Oculus Go",_=c("./src/constants/index.js").AFRAME_CDN_ROOT,T=_+"controllers/oculus/go/oculus-go-controller.gltf",w=y?x:v,S={axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]},R={axes:{touchpad:[0,1]},buttons:["trigger","none","touchpad"]},B=y?R:S;l.exports.Component=h("oculus-go-controls",{schema:{hand:{default:""},buttonColor:{type:"color",default:"#FFFFFF"},buttonTouchedColor:{type:"color",default:"#BBBBBB"},buttonHighlightColor:{type:"color",default:"#7A7A7A"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},mapping:B,bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},init:function(){var I=this;this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(D){g(D.detail.id,"down",I)},this.onButtonUp=function(D){g(D.detail.id,"up",I)},this.onButtonTouchStart=function(D){g(D.detail.id,"touchstart",I)},this.onButtonTouchEnd=function(D){g(D.detail.id,"touchend",I)},this.controllerPresent=!1,this.lastControllerCheck=0,this.bindMethods()},addEventListeners:function(){var I=this.el;I.addEventListener("buttonchanged",this.onButtonChanged),I.addEventListener("buttondown",this.onButtonDown),I.addEventListener("buttonup",this.onButtonUp),I.addEventListener("touchstart",this.onButtonTouchStart),I.addEventListener("touchend",this.onButtonTouchEnd),I.addEventListener("model-loaded",this.onModelLoaded),I.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var I=this.el;I.removeEventListener("buttonchanged",this.onButtonChanged),I.removeEventListener("buttondown",this.onButtonDown),I.removeEventListener("buttonup",this.onButtonUp),I.removeEventListener("touchstart",this.onButtonTouchStart),I.removeEventListener("touchend",this.onButtonTouchEnd),I.removeEventListener("model-loaded",this.onModelLoaded),I.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){f(this,w,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var I=this.el,D=this.data;I.setAttribute("tracked-controls",{armModel:D.armModel,hand:D.hand,idPrefix:w,orientationOffset:D.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",T)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(I){var D=I.detail.model,L;I.target!==this.el||!this.data.model||(L=this.buttonMeshes={},L.trigger=D.getObjectByName("oculus_go_button_trigger"),L.trackpad=D.getObjectByName("oculus_go_touchpad"),L.touchpad=D.getObjectByName("oculus_go_touchpad"))},onButtonChanged:function(I){var D=this.mapping.buttons[I.detail.id];D&&this.el.emit(D+"changed",I.detail.state)},onAxisMoved:function(I){m(this,this.mapping.axes,I)},updateModel:function(I,D){this.data.model&&this.updateButtonModel(I,D)},updateButtonModel:function(I,D){var L=this.buttonMeshes;if(!(!L||!L[I])){var O,U;switch(D){case"down":O=this.data.buttonHighlightColor;break;case"touchstart":O=this.data.buttonTouchedColor;break;default:O=this.data.buttonColor}U=L[I],U.material.color.set(O)}}})},"./src/components/oculus-touch-controls.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent,p=c("./src/lib/three.js"),f=c("./src/utils/tracked-controls.js"),m=f.checkControllerPresentAndSetup,g=f.emitIfAxesChanged,y=f.onButtonEvent,x=c("./src/utils/index.js").device.isWebXRAvailable,v="oculus-touch",_="Oculus Touch",T=x?v:_,w=c("./src/constants/index.js").AFRAME_CDN_ROOT,S=w+"controllers/oculus/oculus-touch-controller-",R=w+"controllers/meta/",B={left:{modelUrl:S+"left.gltf",rayOrigin:{origin:{x:.008,y:-.01,z:0},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new p.Vector3(-.005,.003,-.055),modelPivotRotation:new p.Euler(0,0,0)},right:{modelUrl:S+"right.gltf",rayOrigin:{origin:{x:-.008,y:-.01,z:0},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new p.Vector3(.005,.003,-.055),modelPivotRotation:new p.Euler(0,0,0)}},I={left:{modelUrl:S+"left.gltf",rayOrigin:{origin:{x:.002,y:-.005,z:-.03},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new p.Vector3(-.005,.036,-.037),modelPivotRotation:new p.Euler(Math.PI/4.5,0,0)},right:{modelUrl:S+"right.gltf",rayOrigin:{origin:{x:-.002,y:-.005,z:-.03},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new p.Vector3(.005,.036,-.037),modelPivotRotation:new p.Euler(Math.PI/4.5,0,0)}},D=x?I:B,L="oculus-touch",O={"oculus-touch":D,"oculus-touch-v2":{left:{modelUrl:S+"gen2-left.gltf",rayOrigin:{origin:{x:-.006,y:-.03,z:-.04},direction:{x:0,y:-.9,z:-1}},modelPivotOffset:new p.Vector3(0,-.007,-.021),modelPivotRotation:new p.Euler(-Math.PI/4,0,0)},right:{modelUrl:S+"gen2-right.gltf",rayOrigin:{origin:{x:.006,y:-.03,z:-.04},direction:{x:0,y:-.9,z:-1}},modelPivotOffset:new p.Vector3(0,-.007,-.021),modelPivotRotation:new p.Euler(-Math.PI/4,0,0)}},"oculus-touch-v3":{left:{modelUrl:S+"v3-left.glb",rayOrigin:{origin:{x:.0065,y:-.0186,z:-.05},direction:{x:.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new p.Vector3(0,0,0),modelPivotRotation:new p.Euler(0,0,0)},right:{modelUrl:S+"v3-right.glb",rayOrigin:{origin:{x:-.0065,y:-.0186,z:-.05},direction:{x:-.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new p.Vector3(0,0,0),modelPivotRotation:new p.Euler(0,0,0)}},"meta-quest-touch-pro":{left:{modelUrl:R+"quest-touch-pro-left.glb",rayOrigin:{origin:{x:.0065,y:-.0186,z:-.05},direction:{x:.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new p.Vector3(0,0,0),modelPivotRotation:new p.Euler(0,0,0)},right:{modelUrl:R+"quest-touch-pro-right.glb",rayOrigin:{origin:{x:-.0065,y:-.0186,z:-.05},direction:{x:-.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new p.Vector3(0,0,0),modelPivotRotation:new p.Euler(0,0,0)}},"meta-quest-touch-plus":{left:{modelUrl:R+"quest-touch-plus-left.glb",rayOrigin:{origin:{x:.0065,y:-.0186,z:-.05},direction:{x:.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new p.Vector3(0,0,0),modelPivotRotation:new p.Euler(0,0,0)},right:{modelUrl:R+"quest-touch-plus-right.glb",rayOrigin:{origin:{x:-.0065,y:-.0186,z:-.05},direction:{x:-.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new p.Vector3(0,0,0),modelPivotRotation:new p.Euler(0,0,0)}}},U={left:{axes:{thumbstick:[0,1]},buttons:["thumbstick","trigger","grip","xbutton","ybutton","surface"]},right:{axes:{thumbstick:[0,1]},buttons:["thumbstick","trigger","grip","abutton","bbutton","surface"]}},Z={left:{axes:{thumbstick:[2,3]},buttons:["trigger","grip","none","thumbstick","xbutton","ybutton","surface"]},right:{axes:{thumbstick:[2,3]},buttons:["trigger","grip","none","thumbstick","abutton","bbutton","surface"]}},G=x?Z:U;l.exports.Component=h("oculus-touch-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#999"},buttonTouchColor:{type:"color",default:"#8AB"},buttonHighlightColor:{type:"color",default:"#2DF"},model:{default:!0},controllerType:{default:"auto",oneOf:["auto","oculus-touch","oculus-touch-v2","oculus-touch-v3"]},orientationOffset:{type:"vec3",default:{x:43,y:0,z:0}}},after:["tracked-controls"],mapping:G,bindMethods:function(){this.onButtonChanged=this.onButtonChanged.bind(this),this.onThumbstickMoved=this.onThumbstickMoved.bind(this),this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},init:function(){var $=this;this.onButtonDown=function(Q){y(Q.detail.id,"down",$,$.data.hand)},this.onButtonUp=function(Q){y(Q.detail.id,"up",$,$.data.hand)},this.onButtonTouchStart=function(Q){y(Q.detail.id,"touchstart",$,$.data.hand)},this.onButtonTouchEnd=function(Q){y(Q.detail.id,"touchend",$,$.data.hand)},this.controllerPresent=!1,this.lastControllerCheck=0,this.previousButtonValues={},this.bindMethods(),this.triggerEuler=new p.Euler},addEventListeners:function(){var $=this.el;$.addEventListener("buttonchanged",this.onButtonChanged),$.addEventListener("buttondown",this.onButtonDown),$.addEventListener("buttonup",this.onButtonUp),$.addEventListener("touchstart",this.onButtonTouchStart),$.addEventListener("touchend",this.onButtonTouchEnd),$.addEventListener("axismove",this.onAxisMoved),$.addEventListener("model-loaded",this.onModelLoaded),$.addEventListener("thumbstickmoved",this.onThumbstickMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var $=this.el;$.removeEventListener("buttonchanged",this.onButtonChanged),$.removeEventListener("buttondown",this.onButtonDown),$.removeEventListener("buttonup",this.onButtonUp),$.removeEventListener("touchstart",this.onButtonTouchStart),$.removeEventListener("touchend",this.onButtonTouchEnd),$.removeEventListener("axismove",this.onAxisMoved),$.removeEventListener("model-loaded",this.onModelLoaded),$.removeEventListener("thumbstickmoved",this.onThumbstickMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){m(this,T,{hand:this.data.hand,iterateControllerProfiles:!0})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},loadModel:function($){var Q=this.data,H;if(Q.model){if(this.controllerObject3D){this.el.setObject3D("mesh",this.controllerObject3D);return}if(this.displayModel=O[Q.controllerType]||O[L],Q.controllerType==="auto"){var V=this.el.sceneEl.systems["tracked-controls-webvr"];if(V&&V.vrDisplay){var ne=V.vrDisplay.displayName;/^Oculus Quest$/.test(ne)&&(this.displayModel=O["oculus-touch-v2"])}else{H=L;for(var Y=Object.keys(O),ae=0;ae<$.profiles.length;ae++)if(Y.indexOf($.profiles[ae])!==-1){H=$.profiles[ae];break}this.displayModel=O[H]}}var xe=this.displayModel[Q.hand].modelUrl;this.isTouchV3orPROorPlus=this.displayModel===O["oculus-touch-v3"]||this.displayModel===O["meta-quest-touch-pro"]||this.displayModel===O["meta-quest-touch-plus"],this.el.setAttribute("gltf-model",xe)}},injectTrackedControls:function($){var Q=this.data,H=v,V=Q.hand==="right"?"Oculus Touch (Right)":"Oculus Touch (Left)",ne=x?H:V;this.el.setAttribute("tracked-controls",{id:ne,hand:Q.hand,orientationOffset:Q.orientationOffset,handTrackingEnabled:!1,iterateControllerProfiles:!0,space:"gripSpace"}),this.loadModel($)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function($){var Q=this.mapping[this.data.hand].buttons[$.detail.id];if(Q){if(this.isTouchV3orPROorPlus)this.onButtonChangedV3orPROorPlus($);else{var H=this.buttonMeshes,V;(Q==="trigger"||Q==="grip")&&(V=$.detail.state.value),H&&(Q==="trigger"&&H.trigger&&(H.trigger.rotation.x=this.originalXRotationTrigger-V*(Math.PI/26)),Q==="grip"&&H.grip&&(V*=this.data.hand==="left"?-1:1,H.grip.position.x=this.originalXPositionGrip+V*.004))}this.el.emit(Q+"changed",$.detail.state)}},onButtonChangedV3orPROorPlus:function($){var Q=this.mapping[this.data.hand].buttons[$.detail.id],H=this.buttonObjects,V;!H||!H[Q]||(V=$.detail.state.value,H[Q].quaternion.slerpQuaternions(this.buttonRanges[Q].min.quaternion,this.buttonRanges[Q].max.quaternion,V),H[Q].position.lerpVectors(this.buttonRanges[Q].min.position,this.buttonRanges[Q].max.position,V))},onModelLoaded:function($){if(!($.target!==this.el||!this.data.model)){if(this.isTouchV3orPROorPlus)this.onTouchV3orPROorPlusModelLoaded($);else{var Q=this.controllerObject3D=$.detail.model,H;H=this.buttonMeshes={},H.grip=Q.getObjectByName("buttonHand"),this.originalXPositionGrip=H.grip&&H.grip.position.x,H.trigger=Q.getObjectByName("buttonTrigger"),this.originalXRotationTrigger=H.trigger&&H.trigger.rotation.x,H.thumbstick=Q.getObjectByName("stick"),H.xbutton=Q.getObjectByName("buttonX"),H.abutton=Q.getObjectByName("buttonA"),H.ybutton=Q.getObjectByName("buttonY"),H.bbutton=Q.getObjectByName("buttonB")}for(var V in this.buttonMeshes)this.buttonMeshes[V]&&z(this.buttonMeshes[V]);this.applyOffset($.detail.model),this.el.emit("controllermodelready",{name:"oculus-touch-controls",model:this.data.model,rayOrigin:this.displayModel[this.data.hand].rayOrigin})}},applyOffset:function($){$.position.copy(this.displayModel[this.data.hand].modelPivotOffset),$.rotation.copy(this.displayModel[this.data.hand].modelPivotRotation)},onTouchV3orPROorPlusModelLoaded:function($){var Q=this.controllerObject3D=$.detail.model,H=this.buttonObjects={},V=this.buttonMeshes={},ne=this.buttonRanges={};V.grip=Q.getObjectByName("squeeze"),H.grip=Q.getObjectByName("xr_standard_squeeze_pressed_value"),ne.grip={min:Q.getObjectByName("xr_standard_squeeze_pressed_min"),max:Q.getObjectByName("xr_standard_squeeze_pressed_max")},H.grip.minX=H.grip.position.x,V.thumbstick=Q.getObjectByName("thumbstick"),H.thumbstick=Q.getObjectByName("xr_standard_thumbstick_pressed_value"),ne.thumbstick={min:Q.getObjectByName("xr_standard_thumbstick_pressed_min"),max:Q.getObjectByName("xr_standard_thumbstick_pressed_max")},H.thumbstickXAxis=Q.getObjectByName("xr_standard_thumbstick_xaxis_pressed_value"),ne.thumbstickXAxis={min:Q.getObjectByName("xr_standard_thumbstick_xaxis_pressed_min"),max:Q.getObjectByName("xr_standard_thumbstick_xaxis_pressed_max")},H.thumbstickYAxis=Q.getObjectByName("xr_standard_thumbstick_yaxis_pressed_value"),ne.thumbstickYAxis={min:Q.getObjectByName("xr_standard_thumbstick_yaxis_pressed_min"),max:Q.getObjectByName("xr_standard_thumbstick_yaxis_pressed_max")},V.trigger=Q.getObjectByName("trigger"),H.trigger=Q.getObjectByName("xr_standard_trigger_pressed_value"),ne.trigger={min:Q.getObjectByName("xr_standard_trigger_pressed_min"),max:Q.getObjectByName("xr_standard_trigger_pressed_max")},ne.trigger.diff={x:Math.abs(ne.trigger.max.rotation.x)-Math.abs(ne.trigger.min.rotation.x),y:Math.abs(ne.trigger.max.rotation.y)-Math.abs(ne.trigger.min.rotation.y),z:Math.abs(ne.trigger.max.rotation.z)-Math.abs(ne.trigger.min.rotation.z)};var Y=this.data.hand==="left"?"x":"a",ae=this.data.hand==="left"?"y":"b",xe=Y+"button",fe=ae+"button";V[xe]=Q.getObjectByName(Y+"_button"),H[xe]=Q.getObjectByName(Y+"_button_pressed_value"),ne[xe]={min:Q.getObjectByName(Y+"_button_pressed_min"),max:Q.getObjectByName(Y+"_button_pressed_max")},V[fe]=Q.getObjectByName(ae+"_button"),H[fe]=Q.getObjectByName(ae+"_button_pressed_value"),ne[fe]={min:Q.getObjectByName(ae+"_button_pressed_min"),max:Q.getObjectByName(ae+"_button_pressed_max")}},onAxisMoved:function($){g(this,this.mapping[this.data.hand].axes,$)},onThumbstickMoved:function($){if(!(!this.buttonMeshes||!this.buttonMeshes.thumbstick)){if(this.isTouchV3orPROorPlus){this.updateThumbstickTouchV3orPROorPlus($);return}for(var Q in $.detail)this.buttonObjects.thumbstick.rotation[this.axisMap[Q]]=this.buttonRanges.thumbstick.originalRotation[this.axisMap[Q]]-Math.PI/8*$.detail[Q]*(Q==="y"||this.data.hand==="right"?-1:1)}},axisMap:{y:"x",x:"z"},updateThumbstickTouchV3orPROorPlus:function($){var Q=($.detail.x+1)/2;this.buttonObjects.thumbstickXAxis.quaternion.slerpQuaternions(this.buttonRanges.thumbstickXAxis.min.quaternion,this.buttonRanges.thumbstickXAxis.max.quaternion,Q);var H=($.detail.y+1)/2;this.buttonObjects.thumbstickYAxis.quaternion.slerpQuaternions(this.buttonRanges.thumbstickYAxis.min.quaternion,this.buttonRanges.thumbstickYAxis.max.quaternion,H)},updateModel:function($,Q){this.data.model&&this.updateButtonModel($,Q)},updateButtonModel:function($,Q){var H=this.buttonMeshes,V,ne;H&&H[$]&&(ne=Q==="up"||Q==="touchend"?H[$].originalColor||this.data.buttonColor:Q==="touchstart"?this.data.buttonTouchColor:this.data.buttonHighlightColor,V=H[$],V.material.color.set(ne))}});function z($){$.traverse(function(Q){var H;Q.type==="Mesh"&&(H=Q.material.clone(),$.originalColor=Q.material.color,Q.material.dispose(),Q.material=H)})}},"./src/components/pico-controls.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent,p=c("./src/lib/three.js"),f=c("./src/utils/tracked-controls.js"),m=f.checkControllerPresentAndSetup,g=f.emitIfAxesChanged,y=f.onButtonEvent,x="pico-4",v=c("./src/constants/index.js").AFRAME_CDN_ROOT,_=v+"controllers/pico/pico4/",T={left:{axes:{touchpad:[2,3]},buttons:["trigger","squeeze","none","thumbstick","xbutton","ybutton"]},right:{axes:{touchpad:[2,3]},buttons:["trigger","squeeze","none","thumbstick","abutton","bbutton"]}};l.exports.Component=h("pico-controls",{schema:{hand:{default:"none"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:T,init:function(){var w=this;this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(S){y(S.detail.id,"down",w,w.data.hand)},this.onButtonUp=function(S){y(S.detail.id,"up",w,w.data.hand)},this.onButtonTouchEnd=function(S){y(S.detail.id,"touchend",w,w.data.hand)},this.onButtonTouchStart=function(S){y(S.detail.id,"touchstart",w,w.data.hand)},this.bindMethods()},update:function(){var w=this.data;this.controllerIndex=w.hand==="right"?0:w.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},addEventListeners:function(){var w=this.el;w.addEventListener("buttonchanged",this.onButtonChanged),w.addEventListener("buttondown",this.onButtonDown),w.addEventListener("buttonup",this.onButtonUp),w.addEventListener("touchstart",this.onButtonTouchStart),w.addEventListener("touchend",this.onButtonTouchEnd),w.addEventListener("axismove",this.onAxisMoved),w.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var w=this.el;w.removeEventListener("buttonchanged",this.onButtonChanged),w.removeEventListener("buttondown",this.onButtonDown),w.removeEventListener("buttonup",this.onButtonUp),w.removeEventListener("touchstart",this.onButtonTouchStart),w.removeEventListener("touchend",this.onButtonTouchEnd),w.removeEventListener("axismove",this.onAxisMoved),w.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var w=this.data;m(this,x,{index:this.controllerIndex,hand:w.hand})},injectTrackedControls:function(){var w=this.el,S=this.data;w.setAttribute("tracked-controls",{idPrefix:x,hand:S.hand,controller:this.controllerIndex,orientationOffset:S.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",_+this.data.hand+".glb")},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(w){var S=this.mapping[this.data.hand].buttons[w.detail.id],R;S&&(S==="trigger"&&(R=w.detail.state.value,console.log("analog value of trigger press: "+R)),this.el.emit(S+"changed",w.detail.state))},onModelLoaded:function(w){w.target!==this.el||!this.data.model||this.el.emit("controllermodelready",{name:"pico-controls",model:this.data.model,rayOrigin:new p.Vector3(0,0,0)})},onAxisMoved:function(w){g(this,this.mapping.axes,w)}})},"./src/components/position.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent;l.exports.Component=h("position",{schema:{type:"vec3"},update:function(){var p=this.el.object3D,f=this.data;p.position.set(f.x,f.y,f.z)},remove:function(){this.el.object3D.position.set(0,0,0)}})},"./src/components/raycaster.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent,p=c("./src/lib/three.js"),f=c("./src/utils/index.js"),m=f.debug("components:raycaster:warn"),g=/^[\w\s-.,[\]#]*$/,y={childList:!0,attributes:!0,subtree:!0},x={INTERSECT:"raycaster-intersected",INTERSECTION:"raycaster-intersection",INTERSECT_CLEAR:"raycaster-intersected-cleared",INTERSECTION_CLEAR:"raycaster-intersection-cleared",INTERSECTION_CLOSEST_ENTITY_CHANGED:"raycaster-closest-entity-changed"};l.exports.Component=h("raycaster",{schema:{autoRefresh:{default:!0},direction:{type:"vec3",default:{x:0,y:0,z:-1}},enabled:{default:!0},far:{default:1e3},interval:{default:0},near:{default:0},objects:{default:""},origin:{type:"vec3"},showLine:{default:!1},lineColor:{default:"white"},lineOpacity:{default:1},useWorldCoordinates:{default:!1}},multiple:!0,init:function(){this.clearedIntersectedEls=[],this.unitLineEndVec3=new p.Vector3,this.intersectedEls=[],this.intersections=[],this.newIntersectedEls=[],this.newIntersections=[],this.objects=[],this.prevCheckTime=void 0,this.prevIntersectedEls=[],this.rawIntersections=[],this.raycaster=new p.Raycaster,this.updateOriginDirection(),this.setDirty=this.setDirty.bind(this),this.updateLine=this.updateLine.bind(this),this.observer=new MutationObserver(this.setDirty),this.dirty=!0,this.lineEndVec3=new p.Vector3,this.otherLineEndVec3=new p.Vector3,this.lineData={end:this.lineEndVec3},this.getIntersection=this.getIntersection.bind(this),this.intersectedDetail={el:this.el,getIntersection:this.getIntersection},this.intersectedClearedDetail={el:this.el},this.intersectionClearedDetail={clearedEls:this.clearedIntersectedEls},this.intersectionDetail={}},update:function(_){var T=this.data,w=this.el,S=this.raycaster;S.far=T.far,S.near=T.near,T.showLine&&(T.far!==_.far||T.origin!==_.origin||T.direction!==_.direction||!_.showLine)&&(this.unitLineEndVec3.copy(T.direction).normalize(),this.drawLine()),!T.showLine&&_.showLine&&w.removeAttribute("line"),T.objects!==_.objects&&!g.test(T.objects)&&m('[raycaster] Selector "'+T.objects+'" may not update automatically with DOM changes.'),T.objects||m('[raycaster] For performance, please define raycaster.objects when using raycaster or cursor components to whitelist which entities to intersect with. e.g., raycaster="objects: [data-raycastable]".'),T.autoRefresh!==_.autoRefresh&&w.isPlaying&&(T.autoRefresh?this.addEventListeners():this.removeEventListeners()),_.enabled&&!T.enabled&&this.clearAllIntersections(),this.setDirty()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){this.data.showLine&&this.el.removeAttribute("line"),this.clearAllIntersections()},addEventListeners:function(){this.data.autoRefresh&&(this.observer.observe(this.el.sceneEl,y),this.el.sceneEl.addEventListener("object3dset",this.setDirty),this.el.sceneEl.addEventListener("object3dremove",this.setDirty))},removeEventListeners:function(){this.observer.disconnect(),this.el.sceneEl.removeEventListener("object3dset",this.setDirty),this.el.sceneEl.removeEventListener("object3dremove",this.setDirty)},setDirty:function(){this.dirty=!0},refreshObjects:function(){var _=this.data,T;T=_.objects?this.el.sceneEl.querySelectorAll(_.objects):this.el.sceneEl.querySelectorAll("*"),this.objects=this.flattenObject3DMaps(T),this.dirty=!1},tock:function(_){var T=this.data,w=this.prevCheckTime;T.enabled&&(w&&_-w<T.interval||(this.prevCheckTime=_,this.checkIntersections()))},checkIntersections:function(){var _=this.clearedIntersectedEls,T=this.el,w=this.data,S,R=this.intersectedEls,B,I=this.intersections,D=this.newIntersectedEls,L=this.newIntersections,O=this.prevIntersectedEls,U=this.rawIntersections;for(this.dirty&&this.refreshObjects(),v(this.prevIntersectedEls,this.intersectedEls),this.updateOriginDirection(),U.length=0,this.raycaster.intersectObjects(this.objects,!0,U),I.length=0,R.length=0,S=0;S<U.length;S++)B=U[S],!(w.showLine&&B.object===T.getObject3D("line"))&&B.object.el&&(I.push(B),R.push(B.object.el));for(L.length=0,D.length=0,S=0;S<I.length;S++)O.indexOf(I[S].object.el)===-1&&(L.push(I[S]),D.push(I[S].object.el));for(_.length=0,S=0;S<O.length;S++)R.indexOf(O[S])===-1&&(O[S].emit(x.INTERSECT_CLEAR,this.intersectedClearedDetail),_.push(O[S]));for(_.length&&T.emit(x.INTERSECTION_CLEAR,this.intersectionClearedDetail),S=0;S<D.length;S++)D[S].emit(x.INTERSECT,this.intersectedDetail);L.length&&(this.intersectionDetail.els=D,this.intersectionDetail.intersections=L,T.emit(x.INTERSECTION,this.intersectionDetail)),(O.length===0&&I.length>0||O.length>0&&I.length===0||O.length&&I.length&&O[0]!==I[0].object.el)&&(this.intersectionDetail.els=this.intersectedEls,this.intersectionDetail.intersections=I,T.emit(x.INTERSECTION_CLOSEST_ENTITY_CHANGED,this.intersectionDetail)),w.showLine&&setTimeout(this.updateLine)},updateLine:function(){var _=this.el,T=this.intersections,w;T.length&&(T[0].object.el===_&&T[1]?w=T[1].distance:w=T[0].distance),this.drawLine(w)},getIntersection:function(_){var T,w;for(T=0;T<this.intersections.length;T++)if(w=this.intersections[T],w.object.el===_)return w;return null},updateOriginDirection:function(){var _=new p.Vector3,T=new p.Vector3;return function(){var w=this.el,S=this.data;if(S.useWorldCoordinates){this.raycaster.set(S.origin,S.direction);return}w.object3D.updateMatrixWorld(),T.setFromMatrixPosition(w.object3D.matrixWorld),(S.origin.x!==0||S.origin.y!==0||S.origin.z!==0)&&(T=w.object3D.localToWorld(T.copy(S.origin))),_.copy(S.direction).transformDirection(w.object3D.matrixWorld).normalize(),this.raycaster.set(T,_)}}(),drawLine:function(_){var T=this.data,w=this.el,S;S=this.lineData.end===this.lineEndVec3?this.otherLineEndVec3:this.lineEndVec3,_===void 0&&(_=T.far===1/0?1e3:T.far),this.lineData.start=T.origin,this.lineData.end=S.copy(this.unitLineEndVec3).multiplyScalar(_).add(T.origin),this.lineData.color=T.lineColor,this.lineData.opacity=T.lineOpacity,w.setAttribute("line",this.lineData)},flattenObject3DMaps:function(_){var T,w,S=this.objects,R=this.el.sceneEl.object3D;function B(D){return D.parent?B(D.parent):D===R}for(S.length=0,w=0;w<_.length;w++){var I=_[w];if(I.isEntity&&I.object3D&&B(I.object3D))for(T in I.object3DMap)S.push(I.getObject3D(T))}return S},clearAllIntersections:function(){var _;for(_=0;_<this.intersectedEls.length;_++)this.intersectedEls[_].emit(x.INTERSECT_CLEAR,this.intersectedClearedDetail);v(this.clearedIntersectedEls,this.intersectedEls),this.intersectedEls.length=0,this.intersections.length=0,this.el.emit(x.INTERSECTION_CLEAR,this.intersectionClearedDetail)}});function v(_,T){var w;for(_.length=T.length,w=0;w<T.length;w++)_[w]=T[w]}},"./src/components/rotation.js":(l,u,c)=>{var h=c("./src/lib/three.js").MathUtils.degToRad,p=c("./src/core/component.js").registerComponent;l.exports.Component=p("rotation",{schema:{type:"vec3"},update:function(){var f=this.data,m=this.el.object3D;m.rotation.set(h(f.x),h(f.y),h(f.z),"YXZ")},remove:function(){this.el.object3D.rotation.set(0,0,0)}})},"./src/components/scale.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent;l.exports.Component=h("scale",{schema:{type:"vec3",default:{x:1,y:1,z:1}},update:function(){var p=this.data,f=this.el.object3D;f.scale.set(p.x,p.y,p.z)},remove:function(){this.el.object3D.scale.set(1,1,1)}})},"./src/components/scene/ar-hit-test.js":(l,u,c)=>{var h="data:image/webp;base64,UklGRkQHAABXRUJQVlA4WAoAAAAQAAAA/wEA/wEAQUxQSL0DAAARDzD/ERGCjrY9sYYFfgo6aa1kJ7K0w9Lo3AadLSVeFxevQwj5kuM8RfR/Atw/C0+ozB/oUBrloFZs6ElSW88j1KA4yExNWQaqRZquIDF0JYmlq0hAuUDTFu66tng3teW7pa3cQf1V1edvur54M/Slm6Wv3Gx9zw0MXlQLntcsBN6wkHjTQuYtC4W3LTw8mGRVG57TbAROtxHfZNhInGkjc5aNwtk2Hg6Mvki14k+NkZzCwQgCxalcAv3kddRTPI1DcUrXId1FLf1uHpzaQz4tquhZVLlKesbVpqKeTj0n0F5PpXDlFN9UqmhalL/ImuZFo6KmToWLoKlddMprqlS8cKovBvHo2kTiFV2LN4msaxKZl3QNiair8xYRdDWivIvXVXmbcMqJ51UebZuFXxZt6xd4laxtciqRtA3Cv0nU1t+kEUFbI8JvCa+tvkm3FDlO/W+OR99+kWEp/YYo+tYfTVnf/K8cE/F///3vv//993eeL+a+uvjawLcX3xjYvJotBFY3kVjTRGFtE+BU2AiMbiQyhpHMWEYeBozAH5qNBYRDB5KBCaTDBKKBAZTDBoKBDjwHAN5ABeCJBsAZcAAC0YHHxAYSMYBiYgGZWEA2MYFCbCCZGAAIANFEB+AnYgMQTDQAYSJ2AN5EBZAm4gDgTDgAeSIu4DGygTIRN1CMLOCZiACykQlg4jsAycgA8AO+BxCNdJyDkcbwRirDGXGnx8w+FDPrkM3MQ9JQZMYhiiwV/RDMtIM3U1/DmXHUo+IR2kSR2ToWkQ1NIn2qf2J8LCqJKiDUiSADHY3whirhdHgZ94HKaR97PhE+twEUJUFoAcgyTct8hfSxSkShASDKdMJ/ritKHwgyQ0sD4D/miCxU5SbhOOUDTnZpccCjYP/i0bZ/8bAgtVGEoGapWIQXyzKVKLwgNJFk2rtMIgoNRJlOZF7SNSSyUEeQmbxBFKEmtYjEe8S8zOZ1AkJVCmS88FJOtF40Ksg4oUaFiygk3C8qlTVNyl8UTevCUdAE2t14PfVqU1FPp57TopKeQZWromddTQp6QOfTOEQt/ZDuipZ11w/wOiqO8dRORcc6BQEkDQMClaHcn5wV9yLbxsNZNgpn2sicYSNxuo34Js1G4FQbnuNsOPa28PCWhcKbFjJvWEi8ZiHwqgXPcxbc5db33Cx95WboSzddX7yp+vyN0+eul7ZyN7Xlu64t3jVt4c5pc4JLV5EYupJE0xUknC4nOjVlmaYpyLit53HCQ0+ScnqceNcS5dzUkd0/CwMAVlA4IGADAAAQXwCdASoAAgACP8ne6Wy/tjCpqJ/IA/A5CWlu4XYBG/Pz8AfwD8APz//f3v8E1fuHZnxKYACtfuHZnxKYACrYTb5mOslhxu843ecbvON3nG7zjd3a0VCn7G1MABVxwH/Xd25gAK1+4dmfEpe2+PHhQaj75++riG6FuYACtfuHZnxKYACRrK3q9xO8Ss3uWKnMhs/rDF1hi6wxdYYusMXWGI5QRcCFDZog5OgqNlse1NDuz/UoFa/cOzPiUwAEsAOK4/nu5eZHK2tlXxJfNYlMABWv3Dsz4bvNJ5YA/LtxJ38SmAArX7h2Z8Sk5vdZUYv7mZPiUwAFa/cOzPh21s5OgZxf1mfEpemRyFr/rM+JS9noA/LtxJ38SmAAlUJIotzAASn6TjdhK+D3Dsz4dyvB7h2Z8O2tnJ0DOL+sz4lL2nKLT4lL/+iSLOocxq639w7M34MNZdm55uJ8v8ra2cpVZnxKTq2F3PN/cNksAfl24k7+JTAASqrD37h2Z7b1W+VtbOUqsz4lJ1bC7nm/uGyWAPy7cSd/EpgAJVVh79w7M9t6rfK2tnKVWZ8Sk6thdzzf3DZLAH5duJO/iUwAEqqw9+4dme29VvlbWzlKrM+JSdWwu55v7hslgD8u3EnfxKYACVVYe/cOzPbeq3ytrZylVme0kYJ8557FLerqFrzIbPrrf3DZLAH5duJO/iUvaVMS9BoaF4p7pSDFTP1XMyfElelrM0DOL+sz4eBJ13nV1OppBGPuKb4YzXQgq9uH19uS/0+JS9t9fr6ZUlQBelDG6GMgq97otb5QMPJwtKyBTbFp8Sl7b6/X0ykkawEOsgdiE6Fi0vb/Eve6xkwsmug0Z4nGNHQO8839bpTsjpz7SWIJxKagvd1QWMa6FYT1KEw3j4XDT6vJ9Xk+nyfT5Pq8n1eEmk5dinMM/9Fcfz4Z3Dsz3KD2dw7LxBRxKrqUUGQPH/7zxr1KIfNpLEJ0MZB2ITM/0Z2EFoh12NlXnEcpYcbvON3nG7zjd5xu84vfcNIAAP7+y8ceyzbVxkakPYY4lcr72fqOnDwipv+yxC71wAADBrjKnAAAAAAAAAAAAAAw7oNGHttqWONcoFN/2WIDc2pa6WVFtFYROlsaMaTXdcOjXHz93+YxAglKa4AAAAA=",p=c("./src/core/component.js").registerComponent,f=c("./src/lib/three.js"),m=21,g=function(){var _=new f.Quaternion,T=new f.Vector3;function w(S,R,B){R.position.copy(S.transform.position),R.quaternion.copy(S.transform.orientation),T.copy(B),_.copy(S.transform.orientation),T.applyQuaternion(_),R.position.sub(T)}return w}();g.tempFakePose={transform:{orientation:new f.Quaternion,position:new f.Vector3}};function y(_,T){this.renderer=_,this.xrHitTestSource=null,_.xr.addEventListener("sessionend",(function(){this.xrHitTestSource=null}).bind(this)),_.xr.addEventListener("sessionstart",(function(){this.sessionStart(T)}).bind(this)),this.renderer.xr.isPresenting&&this.sessionStart(T)}y.prototype.previousFrameAnchors=new Set,y.prototype.anchorToObject3D=new Map;function x(_){console.warn(_.message),console.warn('Cannot requestHitTestSource Are you missing: webxr="optionalFeatures: hit-test;" from <a-scene>?')}y.prototype.sessionStart=function(_){if(this.session=this.renderer.xr.getSession(),!("requestHitTestSource"in this.session)){x({message:"No requestHitTestSource on the session."});return}_.space?this.session.requestHitTestSource(_).then((function(T){this.xrHitTestSource=T}).bind(this)).catch(x):_.profile&&this.session.requestHitTestSourceForTransientInput(_).then((function(T){this.xrHitTestSource=T,this.transient=!0}).bind(this)).catch(x)},y.prototype.anchorFromLastHitTestResult=function(_,T){var w=this.lastHitTest;if(w){var S={object3D:_,offset:T};Array.from(this.anchorToObject3D.entries()).forEach((function(R){var B=R[1].object3D,I=R[0];B===_&&(this.anchorToObject3D.delete(I),I.delete())}).bind(this)),w.createAnchor&&w.createAnchor().then((function(R){this.anchorToObject3D.set(R,S)}).bind(this)).catch(function(R){console.warn(R.message),console.warn('Cannot create anchor, are you missing: webxr="optionalFeatures: anchors;" from <a-scene>?')})}},y.prototype.doHit=function(_){if(this.renderer.xr.isPresenting){var T=this.renderer.xr.getReferenceSpace(),w=_.getViewerPose(T),S,R;if(this.xrHitTestSource&&w)return this.transient?(S=_.getHitTestResultsForTransientInput(this.xrHitTestSource),S.length>0?(R=S[0].results,R.length>0?(this.lastHitTest=R[0],R[0].getPose(T)):!1):!1):(S=_.getHitTestResults(this.xrHitTestSource),S.length>0?(this.lastHitTest=S[0],S[0].getPose(T)):!1)}},y.updateAnchorPoses=function(_,T){var w=_.trackedAnchors||y.prototype.previousFrameAnchors;y.prototype.previousFrameAnchors.forEach(function(S){w.has(S)||y.prototype.anchorToObject3D.delete(S)}),w.forEach(function(S){var R,B,I,D;try{R=_.getPose(S.anchorSpace,T)}catch{}if(R){if(B=y.prototype.anchorToObject3D.get(S),!B)return;I=B.offset,D=B.object3D,g(R,D,I)}})};var v;l.exports.Component=p("ar-hit-test",{schema:{target:{type:"selector"},enabled:{default:!0},src:{default:h,type:"map"},type:{default:"footprint",oneOf:["footprint","map"]},footprintDepth:{default:.1},mapSize:{type:"vec2",default:{x:.5,y:.5}}},sceneOnly:!0,init:function(){this.hitTest=null,this.imageDataArray=new Uint8ClampedArray(1048576),this.imageData=new ImageData(this.imageDataArray,512,512),this.textureCache=new Map,this.orthoCam=new f.OrthographicCamera,this.orthoCam.layers.set(m),this.textureTarget=new f.WebGLRenderTarget(512,512,{}),this.basicMaterial=new f.MeshBasicMaterial({color:0,side:f.DoubleSide}),this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.context.imageSmoothingEnabled=!1,this.canvas.width=512,this.canvas.height=512,this.canvasTexture=new f.CanvasTexture(this.canvas,{alpha:!0}),this.canvasTexture.flipY=!1;var _=this.el.getAttribute("webxr"),T=_.optionalFeatures;(!T.includes("hit-test")||!T.includes("anchors"))&&(T.push("hit-test"),T.push("anchors"),this.el.setAttribute("webxr",_)),this.el.sceneEl.renderer.xr.addEventListener("sessionend",(function(){this.hitTest=null}).bind(this)),this.el.sceneEl.renderer.xr.addEventListener("sessionstart",(function(){if(this.el.is("ar-mode")){var w=this.el.sceneEl.renderer,S=this.session=w.xr.getSession();this.hasPosedOnce=!1,this.bboxMesh.visible=!1,v||(v=new Map),S.requestReferenceSpace("viewer").then((function(I){this.hitTest=new y(w,{space:I}),v.set(I,this.hitTest),this.el.emit("ar-hit-test-start")}).bind(this));var R="generic-touchscreen",B=new y(w,{profile:R});S.addEventListener("selectstart",(function(I){if(this.data.enabled===!0){var D=I.inputSource;this.bboxMesh.visible=!0,this.hasPosedOnce===!0&&(this.el.emit("ar-hit-test-select-start",{inputSource:D,position:this.bboxMesh.position,orientation:this.bboxMesh.quaternion}),D.profiles[0]===R?this.hitTest=B:(this.hitTest=v.get(D)||new y(w,{space:D.targetRaySpace}),v.set(D,this.hitTest)))}}).bind(this)),S.addEventListener("selectend",(function(I){if(!this.hitTest||this.data.enabled!==!0){this.hitTest=null;return}var D=I.inputSource,L;this.hasPosedOnce===!0&&(this.bboxMesh.visible=!1,this.data.target&&(L=this.data.target.object3D,L&&(g.tempFakePose.transform.position.copy(this.bboxMesh.position),g.tempFakePose.transform.orientation.copy(this.bboxMesh.quaternion),g(g.tempFakePose,L,this.bboxOffset),L.visible=!0,this.hitTest.anchorFromLastHitTestResult(L,this.bboxOffset))),this.el.emit("ar-hit-test-select",{inputSource:D,position:this.bboxMesh.position,orientation:this.bboxMesh.quaternion})),this.hitTest=null}).bind(this))}}).bind(this)),this.bboxOffset=new f.Vector3,this.update=this.update.bind(this),this.makeBBox()},update:function(){this.data.enabled===!1&&(this.hitTest=null,this.bboxMesh.visible=!1),this.data.target&&(this.data.target.object3D?(this.data.target.addEventListener("model-loaded",this.update),this.data.target.object3D.layers.enable(m),this.data.target.object3D.traverse(function(_){_.layers.enable(m)})):this.data.target.addEventListener("loaded",this.update,{once:!0})),this.bboxNeedsUpdate=!0},makeBBox:function(){var _=new f.PlaneGeometry(1,1),T=new f.MeshBasicMaterial({transparent:!0,color:16777215});_.rotateX(-Math.PI/2),_.rotateY(-Math.PI/2),this.bbox=new f.Box3,this.bboxMesh=new f.Mesh(_,T),this.el.setObject3D("ar-hit-test",this.bboxMesh),this.bboxMesh.visible=!1},updateFootprint:function(){var _,T=this.el.sceneEl.renderer,w,S,R=T.xr.enabled;this.bboxMesh.material.map=this.canvasTexture,this.bboxMesh.material.needsUpdate=!0,this.orthoCam.rotation.set(-Math.PI/2,0,-Math.PI/2),this.orthoCam.position.copy(this.bboxMesh.position),this.orthoCam.position.y-=this.bboxMesh.scale.y/2,this.orthoCam.near=.1,this.orthoCam.far=this.orthoCam.near+this.data.footprintDepth*this.bboxMesh.scale.y,this.orthoCam.position.y+=this.orthoCam.far,this.orthoCam.right=this.bboxMesh.scale.z/2,this.orthoCam.left=-this.bboxMesh.scale.z/2,this.orthoCam.top=this.bboxMesh.scale.x/2,this.orthoCam.bottom=-this.bboxMesh.scale.x/2,this.orthoCam.updateProjectionMatrix(),w=T.getRenderTarget(),T.setRenderTarget(this.textureTarget),T.xr.enabled=!1,S=this.el.object3D.background,this.el.object3D.overrideMaterial=this.basicMaterial,this.el.object3D.background=null,T.render(this.el.object3D,this.orthoCam),this.el.object3D.background=S,this.el.object3D.overrideMaterial=null,T.xr.enabled=R,T.setRenderTarget(w),T.readRenderTargetPixels(this.textureTarget,0,0,512,512,this.imageDataArray),this.context.putImageData(this.imageData,0,0),this.context.shadowColor="white",this.context.shadowBlur=10,this.context.drawImage(this.canvas,0,0),_=this.context.getImageData(0,0,512,512);for(var B=0;B<262144;B++)_.data[B*4+3]!==0&&_.data[B*4+3]!==255&&(_.data[B*4+3]=128);this.context.putImageData(_,0,0),this.canvasTexture.needsUpdate=!0},tick:function(){var _,T=this.el.sceneEl.frame,w=this.el.sceneEl.renderer;if(T&&y.updateAnchorPoses(T,w.xr.getReferenceSpace()),this.bboxNeedsUpdate){if(this.bboxNeedsUpdate=!1,!this.data.target||this.data.type==="map"){var S;this.textureCache.has(this.data.src)?S=this.textureCache.get(this.data.src):(S=new f.TextureLoader().load(this.data.src),this.textureCache.set(this.data.src,S)),this.bboxMesh.material.map=S,this.bboxMesh.material.needsUpdate=!0}this.data.target&&this.data.target.object3D?(this.bbox.setFromObject(this.data.target.object3D),this.bbox.getCenter(this.bboxMesh.position),this.bbox.getSize(this.bboxMesh.scale),this.data.type==="footprint"&&(this.bboxMesh.scale.x*=1.04,this.bboxMesh.scale.z*=1.04,this.updateFootprint()),this.bboxMesh.position.y-=this.bboxMesh.scale.y/2,this.bboxOffset.copy(this.bboxMesh.position),this.bboxOffset.sub(this.data.target.object3D.position)):this.bboxMesh.scale.set(this.data.mapSize.x,1,this.data.mapSize.y)}this.hitTest&&(_=this.hitTest.doHit(T),_&&(this.hasPosedOnce!==!0&&(this.hasPosedOnce=!0,this.el.emit("ar-hit-test-achieved")),this.bboxMesh.visible=!0,this.bboxMesh.position.copy(_.transform.position),this.bboxMesh.quaternion.copy(_.transform.orientation)))}})},"./src/components/scene/background.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent;l.exports.Component=h("background",{schema:{color:{type:"color",default:"black"},transparent:{default:!1}},sceneOnly:!0,update:function(){var p=this.data,f=this.el.object3D;p.transparent?f.background=null:f.background=new THREE.Color(p.color)},remove:function(){var p=this.el.object3D;p.background=null}})},"./src/components/scene/debug.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent;l.exports.Component=h("debug",{schema:{default:!0},sceneOnly:!0})},"./src/components/scene/device-orientation-permission-ui.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent,p=c("./src/constants/index.js"),f="a-modal",m="a-dialog",g="a-dialog-text",y="a-dialog-text-container",x="a-dialog-buttons-container",v="a-dialog-button",_="a-dialog-allow-button",T="a-dialog-deny-button",w="a-dialog-ok-button";l.exports.Component=h("device-orientation-permission-ui",{schema:{enabled:{default:!0},deviceMotionMessage:{default:"This immersive website requires access to your device motion sensors."},httpsMessage:{default:"Access this site over HTTPS to enter VR mode and grant access to the device sensors."},denyButtonText:{default:"Deny"},allowButtonText:{default:"Allow"},cancelButtonText:{default:"Cancel"}},sceneOnly:!0,init:function(){var I=this;if(this.data.enabled){if(window.isSecureContext||this.showHTTPAlert(),typeof DeviceOrientationEvent>"u"||!DeviceOrientationEvent.requestPermission){this.permissionGranted=!0;return}this.onDeviceMotionDialogAllowClicked=this.onDeviceMotionDialogAllowClicked.bind(this),this.onDeviceMotionDialogDenyClicked=this.onDeviceMotionDialogDenyClicked.bind(this),DeviceOrientationEvent.requestPermission().then(function(){I.el.emit("deviceorientationpermissiongranted"),I.permissionGranted=!0}).catch(function(){I.devicePermissionDialogEl=S(I.data.denyButtonText,I.data.allowButtonText,I.data.deviceMotionMessage,I.onDeviceMotionDialogAllowClicked,I.onDeviceMotionDialogDenyClicked),I.el.appendChild(I.devicePermissionDialogEl)})}},remove:function(){this.devicePermissionDialogEl&&this.el.removeChild(this.devicePermissionDialogEl)},onDeviceMotionDialogDenyClicked:function(){this.remove()},showHTTPAlert:function(){var I=this,D=R(I.data.cancelButtonText,I.data.httpsMessage,function(){I.el.removeChild(D)});this.el.appendChild(D)},onDeviceMotionDialogAllowClicked:function(){var I=this;this.el.emit("deviceorientationpermissionrequested"),DeviceOrientationEvent.requestPermission().then(function(D){D==="granted"?(I.el.emit("deviceorientationpermissiongranted"),I.permissionGranted=!0):I.el.emit("deviceorientationpermissionrejected"),I.remove()}).catch(console.error)}});function S(I,D,L,O,U){var Z,G,z;return Z=document.createElement("div"),Z.classList.add(x),G=document.createElement("button"),G.classList.add(v,T),G.setAttribute(p.AFRAME_INJECTED,""),G.innerHTML=I,Z.appendChild(G),z=document.createElement("button"),z.classList.add(v,_),z.setAttribute(p.AFRAME_INJECTED,""),z.innerHTML=D,Z.appendChild(z),z.addEventListener("click",function($){$.stopPropagation(),O()}),G.addEventListener("click",function($){$.stopPropagation(),U()}),B(L,Z)}function R(I,D,L){var O,U;return O=document.createElement("div"),O.classList.add(x),U=document.createElement("button"),U.classList.add(v,w),U.setAttribute(p.AFRAME_INJECTED,""),U.innerHTML=I,O.appendChild(U),U.addEventListener("click",function(Z){Z.stopPropagation(),L()}),B(D,O)}function B(I,D){var L,O,U,Z;return L=document.createElement("div"),L.classList.add(f),L.setAttribute(p.AFRAME_INJECTED,""),O=document.createElement("div"),O.className=m,O.setAttribute(p.AFRAME_INJECTED,""),L.appendChild(O),U=document.createElement("div"),U.classList.add(y),O.appendChild(U),Z=document.createElement("div"),Z.classList.add(g),Z.innerHTML=I,U.appendChild(Z),O.appendChild(D),L}},"./src/components/scene/embedded.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent;l.exports.Component=h("embedded",{dependencies:["xr-mode-ui"],schema:{default:!0},sceneOnly:!0,update:function(){var p=this.el,f=p.querySelector(".a-enter-vr");this.data===!0?(f&&f.classList.add("embedded"),p.removeFullScreenStyles()):(f&&f.classList.remove("embedded"),p.addFullScreenStyles())}})},"./src/components/scene/fog.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent,p=c("./src/lib/three.js"),f=c("./src/utils/debug.js");f("components:fog:warn"),l.exports.Component=h("fog",{schema:{color:{type:"color",default:"#000"},density:{default:25e-5},far:{default:1e3,min:0},near:{default:1,min:0},type:{default:"linear",oneOf:["linear","exponential"]}},sceneOnly:!0,update:function(){var g=this.data,y=this.el,x=this.el.object3D.fog;if(!x||g.type!==x.name){y.object3D.fog=m(g);return}Object.keys(this.schema).forEach(function(v){var _=g[v];v==="color"&&(_=new p.Color(_)),x[v]=_})},remove:function(){var g=this.el,y=this.el.object3D.fog;y&&(g.object3D.fog=null)}});function m(g){var y;return g.type==="exponential"?y=new p.FogExp2(g.color,g.density):y=new p.Fog(g.color,g.near,g.far),y.name=g.type,y}},"./src/components/scene/inspector.js":(l,u,c)=>{var h=c("./src/constants/index.js").AFRAME_INJECTED,p=c("./package.json"),f=c("./src/core/component.js").registerComponent,m=c("./src/utils/index.js");function g(T){var w=T.split(".");return w[2]="x",w.join(".")}var y="https://unpkg.com/aframe-inspector@"+g(p.version)+"/dist/aframe-inspector.min.js",x=y,v="Loading Inspector",_="Error loading Inspector";l.exports.Component=f("inspector",{schema:{url:{default:x}},sceneOnly:!0,init:function(){this.firstPlay=!0,this.onKeydown=this.onKeydown.bind(this),this.onMessage=this.onMessage.bind(this),this.initOverlay(),window.addEventListener("keydown",this.onKeydown),window.addEventListener("message",this.onMessage)},play:function(){var T;this.firstPlay&&(T=m.getUrlParameter("inspector"),T!=="false"&&T&&(this.openInspector(),this.firstPlay=!1))},initOverlay:function(){var T='<span class="dots"><span>.</span><span>.</span><span>.</span></span>';this.loadingMessageEl=document.createElement("div"),this.loadingMessageEl.classList.add("a-inspector-loader"),this.loadingMessageEl.innerHTML=v+T},remove:function(){this.removeEventListeners()},onKeydown:function(T){var w=T.keyCode===73&&(T.ctrlKey&&T.altKey||T.getModifierState("AltGraph"));w&&this.openInspector()},showLoader:function(){document.body.appendChild(this.loadingMessageEl)},hideLoader:function(){document.body.removeChild(this.loadingMessageEl)},onMessage:function(T){T.data==="INJECT_AFRAME_INSPECTOR"&&this.openInspector()},openInspector:function(T){var w=this,S;if(AFRAME.INSPECTOR||AFRAME.inspectorInjected){AFRAME.INSPECTOR.open(T);return}this.showLoader(),S=document.createElement("script"),S.src=this.data.url,S.setAttribute("data-name","aframe-inspector"),S.setAttribute(h,""),S.onload=function(){AFRAME.INSPECTOR.open(T),w.hideLoader(),w.removeEventListeners()},S.onerror=function(){w.loadingMessageEl.innerHTML=_},document.head.appendChild(S),AFRAME.inspectorInjected=!0},removeEventListeners:function(){window.removeEventListener("keydown",this.onKeydown),window.removeEventListener("message",this.onMessage)}})},"./src/components/scene/keyboard-shortcuts.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent,p=c("./src/utils/index.js").shouldCaptureKeyEvent;l.exports.Component=h("keyboard-shortcuts",{schema:{enterVR:{default:!0},exitVR:{default:!0}},sceneOnly:!0,init:function(){this.onKeyup=this.onKeyup.bind(this)},update:function(f){var m=this.data;this.enterVREnabled=m.enterVR},play:function(){window.addEventListener("keyup",this.onKeyup,!1)},pause:function(){window.removeEventListener("keyup",this.onKeyup)},onKeyup:function(f){var m=this.el;p(f)&&(this.enterVREnabled&&f.keyCode===70&&m.enterVR(),this.enterVREnabled&&f.keyCode===27&&m.exitVR())}})},"./src/components/scene/pool.js":(l,u,c)=>{var h=c("./src/utils/debug.js"),p=c("./src/core/component.js").registerComponent,f=h("components:pool:warn");l.exports.Component=p("pool",{schema:{container:{default:""},mixin:{default:""},size:{default:0},dynamic:{default:!1}},sceneOnly:!0,multiple:!0,initPool:function(){var m;for(this.availableEls=[],this.usedEls=[],this.data.mixin||f("No mixin provided for pool component."),this.data.container&&(this.container=document.querySelector(this.data.container),this.container||f("Container "+this.data.container+" not found.")),this.container=this.container||this.el,m=0;m<this.data.size;++m)this.createEntity()},update:function(m){var g=this.data;(m.mixin!==g.mixin||m.size!==g.size)&&this.initPool()},createEntity:function(){var m;m=document.createElement("a-entity"),m.play=this.wrapPlay(m.play),m.setAttribute("mixin",this.data.mixin),m.object3D.visible=!1,m.pause(),this.container.appendChild(m),this.availableEls.push(m);var g=this.usedEls;m.addEventListener("loaded",function(){g.indexOf(m)===-1&&(m.object3DParent=m.object3D.parent,m.object3D.parent.remove(m.object3D))})},wrapPlay:function(m){var g=this.usedEls;return function(){g.indexOf(this)!==-1&&m.call(this)}},requestEntity:function(){var m;if(this.availableEls.length===0){if(this.data.dynamic===!1){f("Requested entity from empty pool: "+this.attrName);return}else f("Requested entity from empty pool. This pool is dynamic and will resize automatically. You might want to increase its initial size: "+this.attrName);this.createEntity()}return m=this.availableEls.shift(),this.usedEls.push(m),m.object3DParent&&(m.object3DParent.add(m.object3D),this.updateRaycasters()),m.object3D.visible=!0,m},returnEntity:function(m){var g=this.usedEls.indexOf(m);if(g===-1){f("The returned entity was not previously pooled from "+this.attrName);return}return this.usedEls.splice(g,1),this.availableEls.push(m),m.object3DParent=m.object3D.parent,m.object3D.parent.remove(m.object3D),this.updateRaycasters(),m.object3D.visible=!1,m.pause(),m},updateRaycasters:function(){var m=document.querySelectorAll("[raycaster]");m.forEach(function(g){g.components.raycaster.setDirty()})}})},"./src/components/scene/real-world-meshing.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent,p=c("./src/lib/three.js");l.exports.Component=h("real-world-meshing",{schema:{filterLabels:{type:"array"},meshesEnabled:{default:!0},meshMixin:{default:!0},planesEnabled:{default:!0},planeMixin:{default:""}},sceneOnly:!0,init:function(){var f=this.el.getAttribute("webxr"),m=f.requiredFeatures;m.indexOf("mesh-detection")===-1&&(m.push("mesh-detection"),this.el.setAttribute("webxr",f)),m.indexOf("plane-detection")===-1&&(m.push("plane-detection"),this.el.setAttribute("webxr",f)),this.meshEntities=[],this.initWorldMeshEntity=this.initWorldMeshEntity.bind(this)},tick:function(){this.el.is("ar-mode")&&(this.detectMeshes(),this.updateMeshes())},detectMeshes:function(){var f=this.data,m,g,y=this.el;y.renderer.xr;var x,v=this.meshEntities,_=!1,T=[],w=this.data.filterLabels;x=y.frame,m=x.detectedMeshes,g=x.detectedPlanes;for(var S=0;S<v.length;S++)v[S].present=!1;if(f.meshesEnabled){for(var R of m.values())if(!(w.length&&w.indexOf(R.semanticLabel)===-1)){for(S=0;S<v.length;S++)if(R===v[S].mesh){_=!0,v[S].present=!0,v[S].lastChangedTime<R.lastChangedTime&&this.updateMeshGeometry(v[S].el,R),v[S].lastChangedTime=R.lastChangedTime;break}_||T.push(R),_=!1}}if(f.planesEnabled){for(R of g.values())if(!(w.length&&w.indexOf(R.semanticLabel)===-1)){for(S=0;S<v.length;S++)if(R===v[S].mesh){_=!0,v[S].present=!0,v[S].lastChangedTime<R.lastChangedTime&&this.updateMeshGeometry(v[S].el,R),v[S].lastChangedTime=R.lastChangedTime;break}_||T.push(R),_=!1}}this.deleteMeshes(),this.createNewMeshes(T)},updateMeshes:function(){var f=new p.Matrix4;return function(){for(var m,g=this.el,y,x=g.frame,v=this.meshEntities,_=g.renderer.xr.getReferenceSpace(),T,w=0;w<v.length;w++)T=v[w].mesh.meshSpace||v[w].mesh.planeSpace,m=x.getPose(T,_),y=v[w].el,y.hasLoaded&&(f.fromArray(m.transform.matrix),f.decompose(y.object3D.position,y.object3D.quaternion,y.object3D.scale))}}(),deleteMeshes:function(){for(var f=this.meshEntities,m=[],g=0;g<f.length;g++)f[g].present?m.push(f[g]):this.el.removeChild(f[g]);this.meshEntities=m},createNewMeshes:function(f){for(var m,g=0;g<f.length;g++)m=document.createElement("a-entity"),this.meshEntities.push({mesh:f[g],el:m}),m.addEventListener("loaded",this.initWorldMeshEntity),this.el.appendChild(m)},initMeshGeometry:function(f){var m,g,y;if(f instanceof XRPlane){g=new p.Shape,y=f.polygon;for(var x=0;x<y.length;++x)x===0?g.moveTo(y[x].x,y[x].z):g.lineTo(y[x].x,y[x].z);return m=new p.ShapeGeometry(g),m.rotateX(Math.PI/2),m}return m=new p.BufferGeometry,m.setAttribute("position",new p.BufferAttribute(f.vertices,3)),m.setIndex(new p.BufferAttribute(f.indices,1)),m},initWorldMeshEntity:function(f){for(var m=f.target,g,y,x,v=this.meshEntities,_=0;_<v.length;_++)if(v[_].el===m){x=v[_];break}g=this.initMeshGeometry(x.mesh),y=new p.Mesh(g,new p.MeshBasicMaterial({color:Math.random()*16777215,side:p.DoubleSide})),m.setObject3D("mesh",y),x.mesh instanceof XRPlane&&this.data.planeMixin?m.setAttribute("mixin",this.data.planeMixin):this.data.meshMixin&&m.setAttribute("mixin",this.data.meshMixin),m.setAttribute("data-world-mesh",x.mesh.semanticLabel)},updateMeshGeometry:function(f,m){var g=f.getObject3D("mesh");g.geometry.dispose(),g.geometry=this.initMeshGeometry(m)}})},"./src/components/scene/reflection.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent;function p(f,m,g,y){var x=Math.max(f.primaryLightIntensity.x,Math.max(f.primaryLightIntensity.y,f.primaryLightIntensity.z));m.sh.fromArray(f.sphericalHarmonicsCoefficients),m.intensity=1,g&&(g.color.setRGB(f.primaryLightIntensity.x/x,f.primaryLightIntensity.y/x,f.primaryLightIntensity.z/x),g.intensity=x,y.copy(f.primaryLightDirection))}l.exports.Component=h("reflection",{schema:{directionalLight:{type:"selector"}},sceneOnly:!0,init:function(){var f=this;this.cubeRenderTarget=new THREE.WebGLCubeRenderTarget(16),this.cubeCamera=new THREE.CubeCamera(.1,1e3,this.cubeRenderTarget),this.lightingEstimationTexture=new THREE.WebGLCubeRenderTarget(16).texture,this.needsVREnvironmentUpdate=!0;var m=this.el.getAttribute("webxr"),g=m.optionalFeatures;g.includes("light-estimation")||(g.push("light-estimation"),this.el.setAttribute("webxr",m)),this.el.addEventListener("enter-vr",function(){if(f.el.is("ar-mode")){var y=f.el.renderer,x=y.xr.getSession();x.requestLightProbe&&f.startLightProbe()}}),this.el.addEventListener("exit-vr",function(){f.xrLightProbe&&f.stopLightProbe()}),this.el.object3D.environment=this.cubeRenderTarget.texture},stopLightProbe:function(){this.xrLightProbe=null,this.probeLight&&(this.probeLight.components.light.light.intensity=0),this.needsVREnvironmentUpdate=!0,this.el.object3D.environment=this.cubeRenderTarget.texture},startLightProbe:function(){this.needsLightProbeUpdate=!0},setupLightProbe:function(){var f=this.el.renderer,m=f.xr.getSession(),g=this,y=f.getContext();if(!this.probeLight){var x=document.createElement("a-light");x.setAttribute("type","probe"),x.setAttribute("intensity",0),this.el.appendChild(x),this.probeLight=x}switch(m.preferredReflectionFormat){case"srgba8":y.getExtension("EXT_sRGB");break;case"rgba16f":y.getExtension("OES_texture_half_float");break}this.glBinding=new XRWebGLBinding(m,y),y.getExtension("EXT_sRGB"),y.getExtension("OES_texture_half_float"),m.requestLightProbe().then(function(v){g.xrLightProbe=v,v.addEventListener("reflectionchange",g.updateXRCubeMap.bind(g))}).catch(function(v){console.warn("Lighting estimation not supported: "+v.message),console.warn('Are you missing: webxr="optionalFeatures: light-estimation;" from <a-scene>?')})},updateXRCubeMap:function(){var f=this.el.renderer,m=this.glBinding.getReflectionCubeMap(this.xrLightProbe);if(m){var g=f.properties.get(this.lightingEstimationTexture);g.__webglTexture=m,this.lightingEstimationTexture.needsPMREMUpdate=!0,this.el.object3D.environment=this.lightingEstimationTexture}},tick:function(){var f=this.el.object3D,m=this.el.renderer,g=this.el.frame;if(g&&this.xrLightProbe){var y=g.getLightEstimate(this.xrLightProbe);y&&p(y,this.probeLight.components.light.light,this.data.directionalLight&&this.data.directionalLight.components.light.light,this.data.directionalLight&&this.data.directionalLight.object3D.position)}this.needsVREnvironmentUpdate&&(f.environment=null,this.needsVREnvironmentUpdate=!1,this.cubeCamera.position.set(0,1.6,0),this.cubeCamera.update(m,f),f.environment=this.cubeRenderTarget.texture),this.needsLightProbeUpdate&&g&&(this.setupLightProbe(),this.needsLightProbeUpdate=!1)},remove:function(){this.el.object3D.environment=null,this.probeLight&&this.el.removeChild(this.probeLight)}})},"./src/components/scene/screenshot.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent,p=c("./src/lib/three.js"),f=["attribute vec3 position;","attribute vec2 uv;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","varying vec2 vUv;","void main()  {","  vUv = vec2( 1.- uv.x, uv.y );","  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join(`
`),m=["precision mediump float;","uniform samplerCube map;","varying vec2 vUv;","#define M_PI 3.141592653589793238462643383279","void main() {","  vec2 uv = vUv;","  float longitude = uv.x * 2. * M_PI - M_PI + M_PI / 2.;","  float latitude = uv.y * M_PI;","  vec3 dir = vec3(","    - sin( longitude ) * sin( latitude ),","    cos( latitude ),","    - cos( longitude ) * sin( latitude )","  );","  normalize( dir );","  gl_FragColor = vec4( textureCube( map, dir ).rgb, 1.0 );","}"].join(`
`);l.exports.Component=h("screenshot",{schema:{width:{default:4096},height:{default:2048},camera:{type:"selector"}},sceneOnly:!0,setup:function(){var g=this.el;if(!this.canvas){var y=g.renderer.getContext();y&&(this.cubeMapSize=y.getParameter(y.MAX_CUBE_MAP_TEXTURE_SIZE),this.material=new p.RawShaderMaterial({uniforms:{map:{type:"t",value:null}},vertexShader:f,fragmentShader:m,side:p.DoubleSide}),this.quad=new p.Mesh(new p.PlaneGeometry(1,1),this.material),this.quad.visible=!1,this.camera=new p.OrthographicCamera(-.5,.5,.5,-.5,-1e4,1e4),this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),g.object3D.add(this.quad),this.onKeyDown=this.onKeyDown.bind(this))}},getRenderTarget:function(g,y){return new p.WebGLRenderTarget(g,y,{colorSpace:this.el.sceneEl.renderer.outputColorSpace,minFilter:p.LinearFilter,magFilter:p.LinearFilter,wrapS:p.ClampToEdgeWrapping,wrapT:p.ClampToEdgeWrapping,format:p.RGBAFormat,type:p.UnsignedByteType})},resize:function(g,y){this.quad.scale.set(g,y,1),this.camera.left=-1*g/2,this.camera.right=g/2,this.camera.top=y/2,this.camera.bottom=-1*y/2,this.camera.updateProjectionMatrix(),this.canvas.width=g,this.canvas.height=y},play:function(){window.addEventListener("keydown",this.onKeyDown)},onKeyDown:function(g){var y=g.keyCode===83&&g.ctrlKey&&g.altKey;if(!(!this.data||!y)){var x=g.shiftKey?"equirectangular":"perspective";this.capture(x)}},setCapture:function(g){var y=this.el,x,v,_,T;return g==="perspective"?(this.quad.visible=!1,v=this.data.camera&&this.data.camera.components.camera.camera||y.camera,x={width:this.data.width,height:this.data.height}):(v=this.camera,T=new p.WebGLCubeRenderTarget(Math.min(this.cubeMapSize,2048),{format:p.RGBFormat,generateMipmaps:!0,minFilter:p.LinearMipmapLinearFilter,colorSpace:p.SRGBColorSpace}),_=new p.CubeCamera(y.camera.near,y.camera.far,T),y.camera.getWorldPosition(_.position),y.camera.getWorldQuaternion(_.quaternion),_.update(y.renderer,y.object3D),this.quad.material.uniforms.map.value=_.renderTarget.texture,x={width:this.data.width,height:this.data.height},this.quad.visible=!0),{camera:v,size:x,projection:g}},capture:function(g){var y=this.el.renderer.xr.enabled,x=this.el.renderer,v;this.setup(),x.xr.enabled=!1,v=this.setCapture(g),this.renderCapture(v.camera,v.size,v.projection),this.saveCapture(),x.xr.enabled=y},getCanvas:function(g){var y=this.el.renderer.xr.enabled,x=this.el.renderer;this.setup();var v=this.setCapture(g);return x.xr.enabled=!1,this.renderCapture(v.camera,v.size,v.projection),x.xr.enabled=y,this.canvas},renderCapture:function(g,y,x){var v=this.el.renderer.autoClear,_=this.el,T,w,S,R=_.renderer;w=this.getRenderTarget(y.width,y.height),S=new Uint8Array(4*y.width*y.height),this.resize(y.width,y.height),R.autoClear=!0,R.clear(),R.setRenderTarget(w),R.render(_.object3D,g),R.autoClear=v,R.readRenderTargetPixels(w,0,0,y.width,y.height,S),R.setRenderTarget(null),x==="perspective"&&(S=this.flipPixelsVertically(S,y.width,y.height)),T=new ImageData(new Uint8ClampedArray(S),y.width,y.height),this.quad.visible=!1,this.ctx.putImageData(T,0,0)},flipPixelsVertically:function(g,y,x){for(var v=g.slice(0),_=0;_<y;++_)for(var T=0;T<x;++T)v[_*4+T*y*4]=g[_*4+(x-T)*y*4],v[_*4+1+T*y*4]=g[_*4+1+(x-T)*y*4],v[_*4+2+T*y*4]=g[_*4+2+(x-T)*y*4],v[_*4+3+T*y*4]=g[_*4+3+(x-T)*y*4];return v},saveCapture:function(){this.canvas.toBlob(function(g){var y="screenshot-"+document.title.toLowerCase()+"-"+Date.now()+".png",x=document.createElement("a"),v=URL.createObjectURL(g);x.href=v,x.setAttribute("download",y),x.innerHTML="downloading...",x.style.display="none",document.body.appendChild(x),setTimeout(function(){x.click(),document.body.removeChild(x)},1)},"image/png")}})},"./src/components/scene/stats.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent,p=c("./vendor/rStats.js"),f=c("./src/utils/index.js");c("./vendor/rStats.extras.js"),c("./src/lib/rStatsAframe.js");var m=window.aframeStats,g="a-hidden",y=window.threeStats;l.exports.Component=h("stats",{schema:{default:!0},sceneOnly:!0,init:function(){var v=this.el;f.getUrlParameter("stats")!=="false"&&(this.stats=x(v),this.statsEl=document.querySelector(".rs-base"),this.hideBound=this.hide.bind(this),this.showBound=this.show.bind(this),v.addEventListener("enter-vr",this.hideBound),v.addEventListener("exit-vr",this.showBound))},update:function(){if(this.stats)return this.data?this.show():this.hide()},remove:function(){this.el.removeEventListener("enter-vr",this.hideBound),this.el.removeEventListener("exit-vr",this.showBound),this.statsEl&&this.statsEl.parentNode.removeChild(this.statsEl)},tick:function(){var v=this.stats;v&&(v("rAF").tick(),v("FPS").frame(),v().update())},hide:function(){this.statsEl.classList.add(g)},show:function(){this.statsEl.classList.remove(g)}});function x(v){var _=new y(v.renderer),T=new m(v),w=v.isMobile?[]:[_,T];return new p({css:[],values:{fps:{caption:"fps",below:30}},groups:[{caption:"Framerate",values:["fps","raf"]}],plugins:w})}},"./src/components/scene/xr-mode-ui.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent,p=c("./src/constants/index.js"),f=c("./src/utils/index.js"),m="a-enter-vr",g="a-enter-ar",y="a-enter-vr-button",x="a-enter-ar-button",v="a-hidden",_="a-orientation-modal";l.exports.Component=h("xr-mode-ui",{dependencies:["canvas"],schema:{enabled:{default:!0},cardboardModeEnabled:{default:!1},enterVRButton:{default:""},enterVREnabled:{default:!0},enterARButton:{default:""},enterAREnabled:{default:!0},XRMode:{default:"vr",oneOf:["vr","ar","xr"]}},sceneOnly:!0,init:function(){var B=this,I=this.el;f.getUrlParameter("ui")!=="false"&&(this.insideLoader=!1,this.enterVREl=null,this.enterAREl=null,this.orientationModalEl=null,this.bindMethods(),I.addEventListener("enter-vr",this.updateEnterInterfaces),I.addEventListener("exit-vr",this.updateEnterInterfaces),I.addEventListener("update-vr-devices",this.updateEnterInterfaces),window.addEventListener("message",function(D){D.data.type==="loaderReady"&&(B.insideLoader=!0,B.remove())}),window.addEventListener("orientationchange",this.toggleOrientationModalIfNeeded))},bindMethods:function(){this.onEnterVRButtonClick=this.onEnterVRButtonClick.bind(this),this.onEnterARButtonClick=this.onEnterARButtonClick.bind(this),this.onModalClick=this.onModalClick.bind(this),this.toggleOrientationModalIfNeeded=this.toggleOrientationModalIfNeeded.bind(this),this.updateEnterInterfaces=this.updateEnterInterfaces.bind(this)},onModalClick:function(){this.el.exitVR()},onEnterVRButtonClick:function(){this.el.enterVR()},onEnterARButtonClick:function(){this.el.enterAR()},update:function(){var B=this.data,I=this.el;if(!B.enabled||this.insideLoader||f.getUrlParameter("ui")==="false")return this.remove();this.enterVREl||this.enterAREl||this.orientationModalEl||(!this.enterVREl&&B.enterVREnabled&&(B.XRMode==="xr"||B.XRMode==="vr")&&(B.enterVRButton?(this.enterVREl=document.querySelector(B.enterVRButton),this.enterVREl.addEventListener("click",this.onEnterVRButtonClick)):(this.enterVREl=T(this.onEnterVRButtonClick),I.appendChild(this.enterVREl))),!this.enterAREl&&B.enterAREnabled&&(B.XRMode==="xr"||B.XRMode==="ar")&&(B.enterARButton?(this.enterAREl=document.querySelector(B.enterARButton),this.enterAREl.addEventListener("click",this.onEnterARButtonClick)):(this.enterAREl=w(this.onEnterARButtonClick,B.XRMode==="xr"),I.appendChild(this.enterAREl))),this.orientationModalEl=S(this.onModalClick),I.appendChild(this.orientationModalEl),this.updateEnterInterfaces())},remove:function(){[this.enterVREl,this.enterAREl,this.orientationModalEl].forEach(function(B){B&&B.parentNode&&B.parentNode.removeChild(B)}),this.enterVREl=void 0,this.enterAREl=void 0,this.orientationModalEl=void 0},updateEnterInterfaces:function(){this.toggleEnterVRButtonIfNeeded(),this.toggleEnterARButtonIfNeeded(),this.toggleOrientationModalIfNeeded()},toggleEnterVRButtonIfNeeded:function(){var B=this.el;this.enterVREl&&(B.is("vr-mode")||(B.isMobile||f.device.isMobileDeviceRequestingDesktopSite())&&!this.data.cardboardModeEnabled&&!f.device.checkVRSupport()?this.enterVREl.classList.add(v):(f.device.checkVRSupport()||this.enterVREl.classList.add("fullscreen"),this.enterVREl.classList.remove(v),B.enterVR(!1,!0)))},toggleEnterARButtonIfNeeded:function(){var B=this.el;this.enterAREl&&(B.is("vr-mode")||!f.device.checkARSupport()?this.enterAREl.classList.add(v):(this.enterAREl.classList.remove(v),B.enterVR(!0,!0)))},toggleOrientationModalIfNeeded:function(){var B=this.el,I=this.orientationModalEl;!I||!B.isMobile||(!f.device.isLandscape()&&B.is("vr-mode")?I.classList.remove(v):I.classList.add(v))}});function T(B){var I,D;return D=document.createElement("div"),D.classList.add(m),D.setAttribute(p.AFRAME_INJECTED,""),I=document.createElement("button"),I.className=y,I.setAttribute("title","Enter VR mode with a headset or fullscreen without"),I.setAttribute(p.AFRAME_INJECTED,""),f.device.isMobile()&&R(I),D.appendChild(I),I.addEventListener("click",function(L){B(),L.stopPropagation()}),D}function w(B,I){var D,L;return L=document.createElement("div"),L.classList.add(g),I&&L.classList.add("xr"),L.setAttribute(p.AFRAME_INJECTED,""),D=document.createElement("button"),D.className=x,D.setAttribute("title","Enter AR mode with a headset or handheld device."),D.setAttribute(p.AFRAME_INJECTED,""),f.device.isMobile()&&R(D),L.appendChild(D),D.addEventListener("click",function(O){B(),O.stopPropagation()}),L}function S(B){var I=document.createElement("div");I.className=_,I.classList.add(v),I.setAttribute(p.AFRAME_INJECTED,"");var D=document.createElement("button");return D.setAttribute(p.AFRAME_INJECTED,""),D.innerHTML="Exit VR",D.addEventListener("click",B),I.appendChild(D),I}function R(B){B.addEventListener("touchstart",function(){B.classList.remove("resethover")},{passive:!0}),B.addEventListener("touchend",function(){B.classList.add("resethover")},{passive:!0})}},"./src/components/shadow.js":(l,u,c)=>{var h=c("./src/core/component.js"),p=c("./src/lib/three.js"),f=h.registerComponent;l.exports.Component=f("shadow",{schema:{cast:{default:!0},receive:{default:!0}},init:function(){this.onMeshChanged=this.update.bind(this),this.el.addEventListener("object3dset",this.onMeshChanged),this.system.setShadowMapEnabled(!0)},update:function(){var m=this.data;this.updateDescendants(m.cast,m.receive)},remove:function(){var m=this.el;m.removeEventListener("object3dset",this.onMeshChanged),this.updateDescendants(!1,!1)},updateDescendants:function(m,g){var y=this.el.sceneEl;this.el.object3D.traverse(function(x){if(x instanceof p.Mesh&&(x.castShadow=m,x.receiveShadow=g,y.hasLoaded&&x.material))for(var v=Array.isArray(x.material)?x.material:[x.material],_=0;_<v.length;_++)v[_].needsUpdate=!0})}})},"./src/components/sound.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent,p=c("./src/utils/debug.js"),f=c("./src/lib/three.js"),m=p("components:sound:warn");l.exports.Component=h("sound",{schema:{autoplay:{default:!1},distanceModel:{default:"inverse",oneOf:["linear","inverse","exponential"]},loop:{default:!1},loopStart:{default:0},loopEnd:{default:0},maxDistance:{default:1e4},on:{default:""},poolSize:{default:1},positional:{default:!0},refDistance:{default:1},rolloffFactor:{default:1},src:{type:"audio"},volume:{default:1}},multiple:!0,init:function(){var g=this;this.listener=null,this.audioLoader=new f.AudioLoader,this.pool=new f.Group,this.loaded=!1,this.mustPlay=!1,this.playSoundBound=function(){g.playSound()}},update:function(g){var y=this.data,x,v,_=y.src!==g.src;if(_){if(!y.src)return;this.setupSound()}for(x=0;x<this.pool.children.length;x++)v=this.pool.children[x],y.positional&&(v.setDistanceModel(y.distanceModel),v.setMaxDistance(y.maxDistance),v.setRefDistance(y.refDistance),v.setRolloffFactor(y.rolloffFactor)),v.setLoop(y.loop),v.setLoopStart(y.loopStart),y.loopStart!==0&&y.loopEnd===0?v.setLoopEnd(v.buffer.duration):v.setLoopEnd(y.loopEnd),v.setVolume(y.volume),v.isPaused=!1;if(y.on!==g.on&&this.updateEventListener(g.on),_){var T=this;this.loaded=!1,this.audioLoader.load(y.src,function(w){for(x=0;x<T.pool.children.length;x++)v=T.pool.children[x],v.setBuffer(w);T.loaded=!0,f.Cache.remove(y.src),(T.data.autoplay||T.mustPlay)&&T.playSound(T.processSound),T.el.emit("sound-loaded",T.evtDetail,!1)})}},pause:function(){this.stopSound(),this.removeEventListener()},play:function(){this.data.autoplay&&this.playSound(),this.updateEventListener()},remove:function(){var g,y;this.removeEventListener(),this.el.getObject3D(this.attrName)&&this.el.removeObject3D(this.attrName);try{for(g=0;g<this.pool.children.length;g++)y=this.pool.children[g],y.disconnect()}catch{m("Audio source not properly disconnected")}},updateEventListener:function(g){var y=this.el;g&&y.removeEventListener(g,this.playSoundBound),y.addEventListener(this.data.on,this.playSoundBound)},removeEventListener:function(){this.el.removeEventListener(this.data.on,this.playSoundBound)},setupSound:function(){var g=this.el,y,x=g.sceneEl,v=this,_;this.pool.children.length>0&&(this.stopSound(),g.removeObject3D("sound"));var T=this.listener=x.audioListener||new f.AudioListener;for(x.audioListener=T,x.camera&&x.camera.add(T),x.addEventListener("camera-set-active",function(w){w.detail.cameraEl.getObject3D("camera").add(T)}),this.pool=new f.Group,y=0;y<this.data.poolSize;y++)_=this.data.positional?new f.PositionalAudio(T):new f.Audio(T),this.pool.add(_);for(g.setObject3D(this.attrName,this.pool),y=0;y<this.pool.children.length;y++)_=this.pool.children[y],_.onEnded=function(){this.isPlaying=!1,v.el.emit("sound-ended",v.evtDetail,!1)}},pauseSound:function(){var g,y;for(this.isPlaying=!1,g=0;g<this.pool.children.length;g++)y=this.pool.children[g],!(!y.source||!y.source.buffer||!y.isPlaying||y.isPaused)&&(y.isPaused=!0,y.pause())},playSound:function(g){var y,x,v;if(!this.loaded){m("Sound not loaded yet. It will be played once it finished loading"),this.mustPlay=!0,this.processSound=g;return}for(y=!1,this.isPlaying=!0,x=0;x<this.pool.children.length;x++)if(v=this.pool.children[x],!v.isPlaying&&v.buffer&&!y){g&&g(v),v.play(),v.isPaused=!1,y=!0;continue}if(!y){m("All the sounds are playing. If you need to play more sounds simultaneously consider increasing the size of pool with the `poolSize` attribute.",this.el);return}this.mustPlay=!1,this.processSound=void 0},stopSound:function(){var g,y;for(this.isPlaying=!1,g=0;g<this.pool.children.length;g++){if(y=this.pool.children[g],!y.source||!y.source.buffer)return;y.stop()}}})},"./src/components/text.js":(l,u,c)=>{var h=c("./node_modules/three-bmfont-text/index.js"),p=c("./node_modules/load-bmfont/browser.js"),f=c("./src/core/component.js").registerComponent,m=c("./src/core/shader.js"),g=c("./src/lib/three.js"),y=c("./src/utils/index.js"),x=y.debug("components:text:error"),v=m.shaders,_=y.debug("components:text:warn"),T=1,w=16,S=c("./src/constants/index.js").AFRAME_CDN_ROOT,R=S+"fonts/",B={aileronsemibold:R+"Aileron-Semibold.fnt",dejavu:R+"DejaVu-sdf.fnt",exo2bold:R+"Exo2Bold.fnt",exo2semibold:R+"Exo2SemiBold.fnt",kelsonsans:R+"KelsonSans.fnt",monoid:R+"Monoid.fnt",mozillavr:R+"mozillavr.fnt",roboto:R+"Roboto-msdf.json",sourcecodepro:R+"SourceCodePro.fnt"},I=["roboto"],D="roboto";l.exports.FONTS=B;var L=new ne,O={},U={},Z=/^\w+:/;l.exports.Component=f("text",{multiple:!0,schema:{align:{type:"string",default:"left",oneOf:["left","right","center"]},alphaTest:{default:.5},anchor:{default:"center",oneOf:["left","right","center","align"]},baseline:{default:"center",oneOf:["top","center","bottom"]},color:{type:"color",default:"#FFF"},font:{type:"string",default:D},fontImage:{type:"string"},height:{type:"number"},letterSpacing:{type:"number",default:0},lineHeight:{type:"number"},negate:{type:"boolean",default:!0},opacity:{type:"number",default:1},shader:{default:"sdf",oneOf:v},side:{default:"front",oneOf:["front","back","double"]},tabSize:{default:4},transparent:{default:!0},value:{type:"string"},whiteSpace:{default:"normal",oneOf:["normal","pre","nowrap"]},width:{type:"number"},wrapCount:{type:"number",default:40},wrapPixels:{type:"number"},xOffset:{type:"number",default:0},yOffset:{type:"number",default:0},zOffset:{type:"number",default:.001}},init:function(){this.shaderData={},this.geometry=h(),this.createOrUpdateMaterial(),this.explicitGeoDimensionsChecked=!1},update:function(Y){var ae=this.data,xe=this.currentFont;if(U[ae.font]?this.texture=U[ae.font]:(this.texture=U[ae.font]=new g.Texture,this.texture.anisotropy=w),this.createOrUpdateMaterial(),Y.font!==ae.font){this.updateFont();return}xe&&(this.updateGeometry(this.geometry,xe),this.updateLayout())},remove:function(){this.geometry.dispose(),this.geometry=null,this.el.removeObject3D(this.attrName),this.material.dispose(),this.material=null,this.texture.dispose(),this.texture=null,this.shaderObject&&delete this.shaderObject},createOrUpdateMaterial:function(){var Y=this.data,ae,xe=this.material,fe,de=this.shaderData,Ie;if(Ie=Y.shader,I.indexOf(Y.font)!==-1||Y.font.indexOf("-msdf.")>=0?Ie="msdf":Y.font in B&&I.indexOf(Y.font)===-1&&(Ie="sdf"),ae=(this.shaderObject&&this.shaderObject.name)!==Ie,de.alphaTest=Y.alphaTest,de.color=Y.color,de.map=this.texture,de.opacity=Y.opacity,de.side=G(Y.side),de.transparent=Y.transparent,de.negate=Y.negate,!ae){this.shaderObject.update(de),xe.transparent=de.transparent,xe.side=de.side;return}fe=Q(this.el,Ie,de),this.material=fe.material,this.shaderObject=fe.shader,this.material.side=de.side,this.mesh&&(this.mesh.material=this.material)},updateFont:function(){var Y=this.data,ae=this.el,xe,fe=this.geometry,de=this;Y.font||_("No font specified. Using the default font."),this.mesh&&(this.mesh.visible=!1),xe=this.lookupFont(Y.font||D)||Y.font,L.get(xe,function(){return z(xe,Y.yOffset)}).then(function(Ie){var Ge;if(Ie.pages.length!==1)throw new Error("Currently only single-page bitmap fonts are supported.");O[xe]||(Ie.widthFactor=O[Ie]=V(Ie)),de.currentFont=Ie,Ge=de.getFontImageSrc(),L.get(Ge,function(){return $(Ge)}).then(function(Xe){var $e=de.texture;$e&&($e.image=Xe,$e.needsUpdate=!0,U[Y.font]=$e,de.texture=$e,de.initMesh(),de.currentFont=Ie,de.updateGeometry(fe,Ie),de.updateLayout(),de.mesh.visible=!0,ae.emit("textfontset",{font:Y.font,fontObj:Ie}))}).catch(function(Xe){x(Xe.message),x(Xe.stack)})}).catch(function(Ie){x(Ie.message),x(Ie.stack)})},initMesh:function(){this.mesh||(this.mesh=new g.Mesh(this.geometry,this.material),this.el.setObject3D(this.attrName,this.mesh))},getFontImageSrc:function(){if(this.data.fontImage)return this.data.fontImage;var Y=this.lookupFont(this.data.font||D)||this.data.font,ae=this.currentFont.pages[0];return ae.match(Z)&&ae.indexOf("http")!==0?Y.replace(/(\.fnt)|(\.json)/,".png"):g.LoaderUtils.extractUrlBase(Y)+ae},updateLayout:function(){var Y,ae,xe=this.el,fe=this.data,de=this.geometry,Ie,Ge,Xe,$e=this.mesh,lt,At,Gt,gt,xi;if(!(!$e||!de.layout)){if(Ie=xe.getAttribute("geometry"),Gt=fe.width||Ie&&Ie.width||T,lt=H(fe.wrapPixels,fe.wrapCount,this.currentFont.widthFactor),At=Gt/lt,Xe=de.layout,Ge=At*(Xe.height+Xe.descender),Ie&&Ie.primitive==="plane"&&(this.explicitGeoDimensionsChecked||(this.explicitGeoDimensionsChecked=!0,this.hasExplicitGeoWidth=!!Ie.width,this.hasExplicitGeoHeight=!!Ie.height),this.hasExplicitGeoWidth||xe.setAttribute("geometry","width",Gt),this.hasExplicitGeoHeight||xe.setAttribute("geometry","height",Ge)),Y=fe.anchor==="align"?fe.align:fe.anchor,Y==="left")gt=0;else if(Y==="right")gt=-1*Xe.width;else if(Y==="center")gt=-1*Xe.width/2;else throw new TypeError("Invalid text.anchor property value",Y);if(ae=fe.baseline,ae==="bottom")xi=0;else if(ae==="top")xi=-1*Xe.height+Xe.ascender;else if(ae==="center")xi=-1*Xe.height/2;else throw new TypeError("Invalid text.baseline property value",ae);$e.position.x=gt*At+fe.xOffset,$e.position.y=xi*At,$e.position.z=fe.zOffset,$e.scale.set(At,-1*At,At)}},lookupFont:function(Y){return B[Y]},updateGeometry:function(){var Y={},ae={},xe=/\\n/g,fe=/\\t/g;return function(de,Ie){var Ge=this.data;ae.font=Ie,ae.lineHeight=Ge.lineHeight&&isFinite(Ge.lineHeight)?Ge.lineHeight:Ie.common.lineHeight,ae.text=Ge.value.toString().replace(xe,`
`).replace(fe,"	"),ae.width=H(Ge.wrapPixels,Ge.wrapCount,Ie.widthFactor),de.update(y.extend(Y,Ge,ae))}}()});function G(Y){switch(Y){case"back":return g.FrontSide;case"double":return g.DoubleSide;default:return g.BackSide}}function z(Y,ae){return new Promise(function(xe,fe){p(Y,function(de,Ie){if(de){x("Error loading font",Y),fe(de);return}Y.indexOf("/Roboto-msdf.json")>=0&&(ae=30),ae&&Ie.chars.map(function(Ge){Ge.yoffset+=ae}),xe(Ie)})})}function $(Y){return new Promise(function(ae,xe){new g.ImageLoader().load(Y,function(fe){ae(fe)},void 0,function(){x("Error loading font image",Y),xe(null)})})}function Q(Y,ae,xe){var fe,de;return de=new v[ae].Shader,de.el=Y,de.init(xe),de.update(xe),fe=de.material,fe.transparent=xe.transparent,{material:fe,shader:de}}function H(Y,ae,xe){return Y||(.5+ae)*xe}function V(Y){var ae=0,xe=0,fe=0;return Y.chars.map(function(de){ae+=de.xadvance,de.id>=48&&de.id<=57&&(fe++,xe+=de.xadvance)}),fe?xe/fe:ae/Y.chars.length}function ne(){var Y=this.cache={};this.get=function(ae,xe){return ae in Y||(Y[ae]=xe()),Y[ae]}}},"./src/components/tracked-controls-webvr.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent,p=c("./src/utils/tracked-controls.js"),f=c("./src/constants/index.js").DEFAULT_CAMERA_HEIGHT,m=c("./src/lib/three.js"),g=c("./src/constants/index.js").DEFAULT_HANDEDNESS,y={x:.175,y:-.3,z:-.03},x={x:0,y:0,z:-.175},v={touches:[]},_={AXISMOVE:"axismove",BUTTONCHANGED:"buttonchanged",BUTTONDOWN:"buttondown",BUTTONUP:"buttonup",TOUCHSTART:"touchstart",TOUCHEND:"touchend"};l.exports.Component=h("tracked-controls-webvr",{schema:{autoHide:{default:!0},controller:{default:0},id:{type:"string",default:""},hand:{type:"string",default:""},idPrefix:{type:"string",default:""},orientationOffset:{type:"vec3"},armModel:{default:!1},headElement:{type:"selector"}},init:function(){this.axis=this.el.components["tracked-controls"].axis=[0,0,0],this.buttonStates=this.el.components["tracked-controls"].buttonStates={},this.changedAxes=[],this.targetControllerNumber=this.data.controller,this.axisMoveEventDetail={axis:this.axis,changed:this.changedAxes},this.deltaControllerPosition=new m.Vector3,this.controllerQuaternion=new m.Quaternion,this.controllerEuler=new m.Euler,this.updateGamepad(),this.buttonEventDetails={}},tick:function(T,w){var S=this.el.getObject3D("mesh");S&&S.update&&S.update(w/1e3),this.updateGamepad(),this.updatePose(),this.updateButtons()},defaultUserHeight:function(){return f},getHeadElement:function(){return this.data.headElement||this.el.sceneEl.camera.el},updateGamepad:function(){var T=this.data,w=p.findMatchingControllerWebVR(this.system.controllers,T.id,T.idPrefix,T.hand,T.controller);this.controller=w,this.el.components["tracked-controls"].controller=w,this.data.autoHide&&(this.el.object3D.visible=!!this.controller)},applyArmModel:function(T){var w=this.controller,S=this.controllerEuler,R=this.controllerQuaternion,B=this.deltaControllerPosition,I,D,L,O,U;D=this.getHeadElement(),L=D.object3D,U=this.defaultUserHeight(),O=w.pose,I=(w?w.hand:void 0)||g,T.copy(L.position),B.set(y.x*(I==="left"?-1:I==="right"?1:0),y.y,y.z),B.multiplyScalar(U),B.applyAxisAngle(L.up,L.rotation.y),T.add(B),B.set(x.x,x.y,x.z),B.multiplyScalar(U),O.orientation?R.fromArray(O.orientation):R.copy(L.quaternion),S.setFromQuaternion(R),S.set(S.x,S.y,0),B.applyEuler(S),T.add(B)},updatePose:function(){var T=this.controller,w=this.data,S=this.el.object3D,R,B=this.system.vrDisplay,I;T&&(R=T.pose,R.position?S.position.fromArray(R.position):w.armModel&&this.applyArmModel(S.position),R.orientation&&S.quaternion.fromArray(R.orientation),B&&R.position&&(I=this.el.sceneEl.renderer.xr.getStandingMatrix(),S.matrix.compose(S.position,S.quaternion,S.scale),S.matrix.multiplyMatrices(I,S.matrix),S.matrix.decompose(S.position,S.quaternion,S.scale)),S.rotateX(this.data.orientationOffset.x*m.MathUtils.DEG2RAD),S.rotateY(this.data.orientationOffset.y*m.MathUtils.DEG2RAD),S.rotateZ(this.data.orientationOffset.z*m.MathUtils.DEG2RAD))},updateButtons:function(){var T,w=this.controller,S;if(w){for(S=0;S<w.buttons.length;++S)this.buttonStates[S]||(this.buttonStates[S]={pressed:!1,touched:!1,value:0}),this.buttonEventDetails[S]||(this.buttonEventDetails[S]={id:S,state:this.buttonStates[S]}),T=w.buttons[S],this.handleButton(S,T);this.handleAxes()}},handleButton:function(T,w){var S;return S=this.handlePress(T,w)|this.handleTouch(T,w)|this.handleValue(T,w),S?(this.el.emit(_.BUTTONCHANGED,this.buttonEventDetails[T],!1),!0):!1},handleAxes:function(){var T=!1,w=this.controller.axes,S,R=this.axis,B=this.changedAxes;for(this.changedAxes.splice(0,this.changedAxes.length),S=0;S<w.length;++S)B.push(R[S]!==w[S]),B[S]&&(T=!0);if(!T)return!1;for(this.axis.splice(0,this.axis.length),S=0;S<w.length;S++)this.axis.push(w[S]);return this.el.emit(_.AXISMOVE,this.axisMoveEventDetail,!1),!0},handlePress:function(T,w){var S,R=this.buttonStates[T];return w.pressed===R.pressed?!1:(S=w.pressed?_.BUTTONDOWN:_.BUTTONUP,this.el.emit(S,this.buttonEventDetails[T],!1),R.pressed=w.pressed,!0)},handleTouch:function(T,w){var S,R=this.buttonStates[T];return w.touched===R.touched?!1:(S=w.touched?_.TOUCHSTART:_.TOUCHEND,this.el.emit(S,this.buttonEventDetails[T],!1,v),R.touched=w.touched,!0)},handleValue:function(T,w){var S=this.buttonStates[T];return w.value===S.value?!1:(S.value=w.value,!0)}})},"./src/components/tracked-controls-webxr.js":(l,u,c)=>{var h=c("./src/utils/tracked-controls.js"),p=c("./src/core/component.js").registerComponent,f={AXISMOVE:"axismove",BUTTONCHANGED:"buttonchanged",BUTTONDOWN:"buttondown",BUTTONUP:"buttonup",TOUCHSTART:"touchstart",TOUCHEND:"touchend"};l.exports.Component=p("tracked-controls-webxr",{schema:{id:{type:"string",default:""},hand:{type:"string",default:""},handTrackingEnabled:{default:!1},index:{type:"int",default:-1},iterateControllerProfiles:{default:!1},space:{type:"string",oneOf:["targetRaySpace","gripSpace"],default:"gripSpace"}},init:function(){this.updateController=this.updateController.bind(this),this.buttonEventDetails={},this.buttonStates=this.el.components["tracked-controls"].buttonStates={},this.axis=this.el.components["tracked-controls"].axis=[0,0,0],this.changedAxes=[],this.axisMoveEventDetail={axis:this.axis,changed:this.changedAxes}},update:function(){this.updateController()},play:function(){var m=this.el.sceneEl;this.updateController(),m.addEventListener("controllersupdated",this.updateController)},pause:function(){var m=this.el.sceneEl;m.removeEventListener("controllersupdated",this.updateController)},isControllerPresent:function(m){return!(!this.controller||this.controller.gamepad||m.inputSource.handedness!=="none"&&m.inputSource.handedness!==this.data.hand)},updateController:function(){this.controller=h.findMatchingControllerWebXR(this.system.controllers,this.data.id,this.data.hand,this.data.index,this.data.iterateControllerProfiles,this.data.handTrackingEnabled),this.el.components["tracked-controls"].controller=this.controller,this.data.autoHide&&(this.el.object3D.visible=!!this.controller)},tick:function(){var m=this.el.sceneEl,g=this.controller,y=m.frame;!g||!m.frame||!this.system.referenceSpace||g.hand||(this.pose=y.getPose(g[this.data.space],this.system.referenceSpace),this.updatePose(),this.updateButtons())},updatePose:function(){var m=this.el.object3D,g=this.pose;g&&(m.matrix.elements=g.transform.matrix,m.matrix.decompose(m.position,m.rotation,m.scale))},updateButtons:function(){var m,g,y=this.controller,x;if(!(!y||!y.gamepad)){for(x=y.gamepad,g=0;g<x.buttons.length;++g)this.buttonStates[g]||(this.buttonStates[g]={pressed:!1,touched:!1,value:0}),this.buttonEventDetails[g]||(this.buttonEventDetails[g]={id:g,state:this.buttonStates[g]}),m=x.buttons[g],this.handleButton(g,m);this.handleAxes()}},handleButton:function(m,g){var y;return y=this.handlePress(m,g)|this.handleTouch(m,g)|this.handleValue(m,g),y?(this.el.emit(f.BUTTONCHANGED,this.buttonEventDetails[m],!1),!0):!1},handleAxes:function(){var m=!1,g=this.controller.gamepad.axes,y,x=this.axis,v=this.changedAxes;for(this.changedAxes.splice(0,this.changedAxes.length),y=0;y<g.length;++y)v.push(x[y]!==g[y]),v[y]&&(m=!0);if(!m)return!1;for(this.axis.splice(0,this.axis.length),y=0;y<g.length;y++)this.axis.push(g[y]);return this.el.emit(f.AXISMOVE,this.axisMoveEventDetail,!1),!0},handlePress:function(m,g){var y,x=this.buttonStates[m];return g.pressed===x.pressed?!1:(y=g.pressed?f.BUTTONDOWN:f.BUTTONUP,this.el.emit(y,this.buttonEventDetails[m],!1),x.pressed=g.pressed,!0)},handleTouch:function(m,g){var y,x=this.buttonStates[m];return g.touched===x.touched?!1:(y=g.touched?f.TOUCHSTART:f.TOUCHEND,this.el.emit(y,this.buttonEventDetails[m],!1),x.touched=g.touched,!0)},handleValue:function(m,g){var y=this.buttonStates[m];return g.value===y.value?!1:(y.value=g.value,!0)}})},"./src/components/tracked-controls.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent;l.exports.Component=h("tracked-controls",{schema:{autoHide:{default:!0},controller:{default:-1},id:{type:"string",default:""},hand:{type:"string",default:""},idPrefix:{type:"string",default:""},handTrackingEnabled:{default:!1},orientationOffset:{type:"vec3"},armModel:{default:!1},headElement:{type:"selector"},iterateControllerProfiles:{default:!1},space:{type:"string",oneOf:["targetRaySpace","gripSpace"],default:"targetRaySpace"}},after:["tracked-controls-webvr","tracked-controls-webxr"],update:function(){var p=this.data,f=this.el;f.sceneEl.hasWebXR?f.setAttribute("tracked-controls-webxr",{id:p.id,hand:p.hand,index:p.controller,iterateControllerProfiles:p.iterateControllerProfiles,handTrackingEnabled:p.handTrackingEnabled,space:p.space}):f.setAttribute("tracked-controls-webvr",p)}})},"./src/components/valve-index-controls.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent,p=c("./src/lib/three.js"),f=c("./src/utils/tracked-controls.js"),m=f.checkControllerPresentAndSetup,g=f.emitIfAxesChanged,y=f.onButtonEvent,x=c("./src/constants/index.js").AFRAME_CDN_ROOT,v=x+"controllers/valve/index/valve-index-",_={left:v+"left.glb",right:v+"right.glb"},T="valve",w=c("./src/utils/index.js").device.isWebXRAvailable,S={left:{x:-.00023692678902063457,y:.04724540367838371,z:-.061959880395271096},right:{x:.002471558599671131,y:.055765208987076195,z:-.061068168708348844}},R={left:{x:0,y:-.05,z:.06},right:{x:0,y:-.05,z:.06}},B={left:{_x:.692295102620542,_y:-.0627618864318427,_z:-.06265893149611756,_order:"XYZ"},right:{_x:.6484021229942998,_y:-.032563619881892894,_z:-.1327973171917482,_order:"XYZ"}},I={left:{_x:Math.PI/3,_y:0,_z:0,_order:"XYZ"},right:{_x:Math.PI/3,_y:0,_z:0,_order:"XYZ"}},D=w?I:B,L=w?R:S;l.exports.Component=h("valve-index-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#FAFAFA"},buttonHighlightColor:{type:"color",default:"#22D1EE"},model:{default:!0},orientationOffset:{type:"vec3"}},after:["tracked-controls"],mapping:{axes:{trackpad:[0,1],thumbstick:[2,3]},buttons:["trigger","grip","trackpad","thumbstick","abutton"]},init:function(){var O=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(U){y(U.detail.id,"down",O)},this.onButtonUp=function(U){y(U.detail.id,"up",O)},this.onButtonTouchEnd=function(U){y(U.detail.id,"touchend",O)},this.onButtonTouchStart=function(U){y(U.detail.id,"touchstart",O)},this.previousButtonValues={},this.bindMethods()},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},addEventListeners:function(){var O=this.el;O.addEventListener("buttonchanged",this.onButtonChanged),O.addEventListener("buttondown",this.onButtonDown),O.addEventListener("buttonup",this.onButtonUp),O.addEventListener("touchend",this.onButtonTouchEnd),O.addEventListener("touchstart",this.onButtonTouchStart),O.addEventListener("model-loaded",this.onModelLoaded),O.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var O=this.el;O.removeEventListener("buttonchanged",this.onButtonChanged),O.removeEventListener("buttondown",this.onButtonDown),O.removeEventListener("buttonup",this.onButtonUp),O.removeEventListener("touchend",this.onButtonTouchEnd),O.removeEventListener("touchstart",this.onButtonTouchStart),O.removeEventListener("model-loaded",this.onModelLoaded),O.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var O=this.data,U=O.hand==="right"?0:O.hand==="left"?1:2;m(this,T,{index:U,iterateControllerProfiles:!0,hand:O.hand})},injectTrackedControls:function(){var O=this.el,U=this.data;O.setAttribute("tracked-controls",{idPrefix:T,controller:U.hand==="right"?1:U.hand==="left"?0:2,hand:U.hand,orientationOffset:U.orientationOffset}),this.loadModel()},loadModel:function(){var O=this.data;O.model&&this.el.setAttribute("gltf-model",""+_[O.hand])},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(O){var U=this.mapping.buttons[O.detail.id],Z=this.buttonMeshes,G;U&&(U==="trigger"&&(G=O.detail.state.value,Z&&Z.trigger&&(Z.trigger.rotation.x=this.triggerOriginalRotationX-G*(Math.PI/40))),this.el.emit(U+"changed",O.detail.state))},onModelLoaded:function(O){var U,Z=O.detail.model,G=this;O.target!==this.el||!this.data.model||(U=this.buttonMeshes={},U.grip={left:Z.getObjectByName("leftgrip"),right:Z.getObjectByName("rightgrip")},U.menu=Z.getObjectByName("menubutton"),U.system=Z.getObjectByName("systembutton"),U.trackpad=Z.getObjectByName("touchpad"),U.trigger=Z.getObjectByName("trigger"),this.triggerOriginalRotationX=U.trigger.rotation.x,Object.keys(U).forEach(function(z){G.setButtonColor(z,G.data.buttonColor)}),Z.position.copy(L[this.data.hand]),Z.rotation.copy(D[this.data.hand]),this.el.emit("controllermodelready",{name:"valve-index-controls",model:this.data.model,rayOrigin:new p.Vector3(0,0,0)}))},onAxisMoved:function(O){g(this,this.mapping.axes,O)},updateModel:function(O,U){var Z,G;this.data.model&&(G=U.indexOf("touch")!==-1,!G&&(Z=U==="up"?this.data.buttonColor:this.data.buttonHighlightColor,this.setButtonColor(O,Z)))},setButtonColor:function(O,U){}})},"./src/components/visible.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent;l.exports.Component=h("visible",{schema:{default:!0},update:function(){this.el.object3D.visible=this.data}})},"./src/components/vive-controls.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent,p=c("./src/utils/tracked-controls.js"),f=p.checkControllerPresentAndSetup,m=p.emitIfAxesChanged,g=p.onButtonEvent,y=c("./src/constants/index.js").AFRAME_CDN_ROOT,x=y+"controllers/vive/vr_controller_vive.obj",v=y+"controllers/vive/vr_controller_vive.mtl",_=c("./src/utils/index.js").device.isWebXRAvailable,T="htc-vive",w="OpenVR ",S=_?T:w,R={axes:{trackpad:[0,1]},buttons:["trackpad","trigger","grip","menu","system"]},B={axes:{touchpad:[0,1]},buttons:["trigger","grip","touchpad","none"]},I=_?B:R;l.exports.Component=h("vive-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#FAFAFA"},buttonHighlightColor:{type:"color",default:"#22D1EE"},model:{default:!0},orientationOffset:{type:"vec3"}},after:["tracked-controls"],mapping:I,init:function(){var D=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(L){g(L.detail.id,"down",D)},this.onButtonUp=function(L){g(L.detail.id,"up",D)},this.onButtonTouchEnd=function(L){g(L.detail.id,"touchend",D)},this.onButtonTouchStart=function(L){g(L.detail.id,"touchstart",D)},this.previousButtonValues={},this.bindMethods()},update:function(){var D=this.data;this.controllerIndex=D.hand==="right"?0:D.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},addEventListeners:function(){var D=this.el;D.addEventListener("buttonchanged",this.onButtonChanged),D.addEventListener("buttondown",this.onButtonDown),D.addEventListener("buttonup",this.onButtonUp),D.addEventListener("touchend",this.onButtonTouchEnd),D.addEventListener("touchstart",this.onButtonTouchStart),D.addEventListener("model-loaded",this.onModelLoaded),D.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var D=this.el;D.removeEventListener("buttonchanged",this.onButtonChanged),D.removeEventListener("buttondown",this.onButtonDown),D.removeEventListener("buttonup",this.onButtonUp),D.removeEventListener("touchend",this.onButtonTouchEnd),D.removeEventListener("touchstart",this.onButtonTouchStart),D.removeEventListener("model-loaded",this.onModelLoaded),D.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var D=this.data;f(this,S,{index:this.controllerIndex,hand:D.hand})},injectTrackedControls:function(){var D=this.el,L=this.data;D.setAttribute("tracked-controls",{idPrefix:S,hand:L.hand,controller:this.controllerIndex,orientationOffset:L.orientationOffset}),this.data.model&&this.el.setAttribute("obj-model",{obj:x,mtl:v})},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(D){var L=this.mapping.buttons[D.detail.id],O=this.buttonMeshes,U;L&&(L==="trigger"&&(U=D.detail.state.value,O&&O.trigger&&(O.trigger.rotation.x=-U*(Math.PI/12))),this.el.emit(L+"changed",D.detail.state))},onModelLoaded:function(D){var L,O=D.detail.model,U=this;D.target!==this.el||!this.data.model||(L=this.buttonMeshes={},L.grip={left:O.getObjectByName("leftgrip"),right:O.getObjectByName("rightgrip")},L.menu=O.getObjectByName("menubutton"),L.system=O.getObjectByName("systembutton"),L.trackpad=O.getObjectByName("touchpad"),L.touchpad=O.getObjectByName("touchpad"),L.trigger=O.getObjectByName("trigger"),Object.keys(L).forEach(function(Z){U.setButtonColor(Z,U.data.buttonColor)}),O.position.set(0,-.015,.04))},onAxisMoved:function(D){m(this,this.mapping.axes,D)},updateModel:function(D,L){var O,U;this.data.model&&(U=L.indexOf("touch")!==-1,!U&&(O=L==="up"?this.data.buttonColor:this.data.buttonHighlightColor,this.setButtonColor(D,O)))},setButtonColor:function(D,L){var O=this.buttonMeshes;if(O){if(D==="grip"){O.grip.left.material.color.set(L),O.grip.right.material.color.set(L);return}O[D].material.color.set(L)}}})},"./src/components/vive-focus-controls.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent,p=c("./src/utils/tracked-controls.js"),f=p.checkControllerPresentAndSetup,m=p.emitIfAxesChanged,g=p.onButtonEvent,y=c("./src/constants/index.js").AFRAME_CDN_ROOT,x=y+"controllers/vive/focus-controller/focus-controller.gltf",v=c("./src/utils/index.js").device.isWebXRAvailable,_="htc-vive-focus",T="HTC Vive Focus ",w=v?_:T,S={axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]},R={axes:{touchpad:[0,1]},buttons:["trigger","none","touchpad","none","menu"]},B=v?R:S;l.exports.Component=h("vive-focus-controls",{schema:{hand:{default:""},buttonTouchedColor:{type:"color",default:"#BBBBBB"},buttonHighlightColor:{type:"color",default:"#7A7A7A"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},after:["tracked-controls"],mapping:B,bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},init:function(){var I=this;this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(D){g(D.detail.id,"down",I)},this.onButtonUp=function(D){g(D.detail.id,"up",I)},this.onButtonTouchStart=function(D){g(D.detail.id,"touchstart",I)},this.onButtonTouchEnd=function(D){g(D.detail.id,"touchend",I)},this.controllerPresent=!1,this.lastControllerCheck=0,this.bindMethods()},addEventListeners:function(){var I=this.el;I.addEventListener("buttonchanged",this.onButtonChanged),I.addEventListener("buttondown",this.onButtonDown),I.addEventListener("buttonup",this.onButtonUp),I.addEventListener("touchstart",this.onButtonTouchStart),I.addEventListener("touchend",this.onButtonTouchEnd),I.addEventListener("model-loaded",this.onModelLoaded),I.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0,this.addControllersUpdateListener()},removeEventListeners:function(){var I=this.el;I.removeEventListener("buttonchanged",this.onButtonChanged),I.removeEventListener("buttondown",this.onButtonDown),I.removeEventListener("buttonup",this.onButtonUp),I.removeEventListener("touchstart",this.onButtonTouchStart),I.removeEventListener("touchend",this.onButtonTouchEnd),I.removeEventListener("model-loaded",this.onModelLoaded),I.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1,this.removeControllersUpdateListener()},checkIfControllerPresent:function(){f(this,w,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var I=this.el,D=this.data;I.setAttribute("tracked-controls",{armModel:D.armModel,idPrefix:w,orientationOffset:D.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",x)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(I){var D=I.detail.model,L;I.target!==this.el||!this.data.model||(L=this.buttonMeshes={},L.trigger=D.getObjectByName("BumperKey"),L.triggerPressed=D.getObjectByName("BumperKey_Press"),L.triggerPressed&&(L.triggerPressed.visible=!1),L.trackpad=D.getObjectByName("TouchPad"),L.trackpadPressed=D.getObjectByName("TouchPad_Press"),L.trackpadPressed&&(L.trackpadPressed.visible=!1))},onButtonChanged:function(I){var D=this.mapping.buttons[I.detail.id];D&&this.el.emit(D+"changed",I.detail.state)},onAxisMoved:function(I){m(this,this.mapping.axes,I)},updateModel:function(I,D){this.data.model&&this.updateButtonModel(I,D)},updateButtonModel:function(I,D){var L=this.buttonMeshes,O=I+"Pressed";if(!(!L||!L[I]||!L[O])){var U;switch(D){case"down":U=this.data.buttonHighlightColor;break;case"touchstart":U=this.data.buttonTouchedColor;break}U&&L[O].material.color.set(U),L[O].visible=!!U,L[I].visible=!U}}})},"./src/components/wasd-controls.js":(l,u,c)=>{var h=c("./src/constants/index.js").keyboardevent.KEYCODE_TO_CODE,p=c("./src/core/component.js").registerComponent,f=c("./src/lib/three.js"),m=c("./src/utils/index.js"),g=m.shouldCaptureKeyEvent,y=1e-5,x=.2,v=["KeyW","KeyA","KeyS","KeyD","ArrowUp","ArrowLeft","ArrowRight","ArrowDown"];l.exports.Component=p("wasd-controls",{schema:{acceleration:{default:65},adAxis:{default:"x",oneOf:["x","y","z"]},adEnabled:{default:!0},adInverted:{default:!1},enabled:{default:!0},fly:{default:!1},wsAxis:{default:"z",oneOf:["x","y","z"]},wsEnabled:{default:!0},wsInverted:{default:!1}},after:["look-controls"],init:function(){this.keys={},this.easing=1.1,this.velocity=new f.Vector3,this.onBlur=this.onBlur.bind(this),this.onContextMenu=this.onContextMenu.bind(this),this.onFocus=this.onFocus.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),this.onVisibilityChange=this.onVisibilityChange.bind(this),this.attachVisibilityEventListeners()},tick:function(T,w){var S=this.data,R=this.el,B=this.velocity;!B[S.adAxis]&&!B[S.wsAxis]&&_(this.keys)||(w=w/1e3,this.updateVelocity(w),!(!B[S.adAxis]&&!B[S.wsAxis])&&R.object3D.position.add(this.getMovementVector(w)))},update:function(T){T.adAxis!==this.data.adAxis&&(this.velocity[T.adAxis]=0),T.wsAxis!==this.data.wsAxis&&(this.velocity[T.wsAxis]=0)},remove:function(){this.removeKeyEventListeners(),this.removeVisibilityEventListeners()},play:function(){this.attachKeyEventListeners()},pause:function(){this.keys={},this.removeKeyEventListeners()},updateVelocity:function(T){var w,S,R,B=this.data,I=this.keys,D=this.velocity,L,O;if(S=B.adAxis,L=B.wsAxis,T>x){D[S]=0,D[L]=0;return}var U=Math.pow(1/this.easing,T*60);D[S]!==0&&(D[S]=D[S]*U),D[L]!==0&&(D[L]=D[L]*U),Math.abs(D[S])<y&&(D[S]=0),Math.abs(D[L])<y&&(D[L]=0),B.enabled&&(w=B.acceleration,B.adEnabled&&(R=B.adInverted?-1:1,(I.KeyA||I.ArrowLeft)&&(D[S]-=R*w*T),(I.KeyD||I.ArrowRight)&&(D[S]+=R*w*T)),B.wsEnabled&&(O=B.wsInverted?-1:1,(I.KeyW||I.ArrowUp)&&(D[L]-=O*w*T),(I.KeyS||I.ArrowDown)&&(D[L]+=O*w*T)))},getMovementVector:function(){var T=new f.Vector3(0,0,0),w=new f.Euler(0,0,0,"YXZ");return function(S){var R=this.el.getAttribute("rotation"),B=this.velocity,I;return T.copy(B),T.multiplyScalar(S),R&&(I=this.data.fly?R.x:0,w.set(f.MathUtils.degToRad(I),f.MathUtils.degToRad(R.y),0),T.applyEuler(w)),T}}(),attachVisibilityEventListeners:function(){window.oncontextmenu=this.onContextMenu,window.addEventListener("blur",this.onBlur),window.addEventListener("focus",this.onFocus),document.addEventListener("visibilitychange",this.onVisibilityChange)},removeVisibilityEventListeners:function(){window.removeEventListener("blur",this.onBlur),window.removeEventListener("focus",this.onFocus),document.removeEventListener("visibilitychange",this.onVisibilityChange)},attachKeyEventListeners:function(){window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp)},removeKeyEventListeners:function(){window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp)},onContextMenu:function(){for(var T=Object.keys(this.keys),w=0;w<T.length;w++)delete this.keys[T[w]]},onBlur:function(){this.pause()},onFocus:function(){this.play()},onVisibilityChange:function(){document.hidden?this.onBlur():this.onFocus()},onKeyDown:function(T){var w;g(T)&&(w=T.code||h[T.keyCode],v.indexOf(w)!==-1&&(this.keys[w]=!0))},onKeyUp:function(T){var w;w=T.code||h[T.keyCode],delete this.keys[w]}});function _(T){var w;for(w in T)return!1;return!0}},"./src/components/windows-motion-controls.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent,p=c("./src/utils/tracked-controls.js"),f=p.checkControllerPresentAndSetup,m=p.emitIfAxesChanged,g=p.onButtonEvent,y=c("./src/utils/index.js"),x=y.debug("components:windows-motion-controls:debug"),v=y.debug("components:windows-motion-controls:warn"),_=c("./src/constants/index.js").DEFAULT_HANDEDNESS,T=c("./src/constants/index.js").AFRAME_CDN_ROOT,w=T+"controllers/microsoft/",S={left:"left.glb",right:"right.glb",default:"universal.glb"},R=c("./src/utils/index.js").device.isWebXRAvailable,B="windows-mixed-reality",I="Spatial Controller (Spatial Interaction Source) ",D=/([0-9a-zA-Z]+-[0-9a-zA-Z]+)$/,L=R?B:I,O={axes:{thumbstick:[0,1],trackpad:[2,3]},buttons:["thumbstick","trigger","grip","menu","trackpad"],axisMeshNames:["THUMBSTICK_X","THUMBSTICK_Y","TOUCHPAD_TOUCH_X","TOUCHPAD_TOUCH_Y"],buttonMeshNames:{trigger:"SELECT",menu:"MENU",grip:"GRASP",thumbstick:"THUMBSTICK_PRESS",trackpad:"TOUCHPAD_PRESS"},pointingPoseMeshName:"POINTING_POSE"},U={axes:{touchpad:[0,1],thumbstick:[2,3]},buttons:["trigger","squeeze","touchpad","thumbstick","menu"],axisMeshNames:["TOUCHPAD_TOUCH_X","TOUCHPAD_TOUCH_X","THUMBSTICK_X","THUMBSTICK_Y"],buttonMeshNames:{trigger:"SELECT",menu:"MENU",squeeze:"GRASP",thumbstick:"THUMBSTICK_PRESS",touchpad:"TOUCHPAD_PRESS"},pointingPoseMeshName:"POINTING_POSE"},Z=R?U:O;l.exports.Component=h("windows-motion-controls",{schema:{hand:{default:_},pair:{default:0},model:{default:!0},hideDisconnected:{default:!0}},after:["tracked-controls"],mapping:Z,bindMethods:function(){this.onModelError=this.onModelError.bind(this),this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},init:function(){var G=this,z=this.el;this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function($){g($.detail.id,"down",G)},this.onButtonUp=function($){g($.detail.id,"up",G)},this.onButtonTouchStart=function($){g($.detail.id,"touchstart",G)},this.onButtonTouchEnd=function($){g($.detail.id,"touchend",G)},this.onControllerConnected=function(){G.setModelVisibility(!0)},this.onControllerDisconnected=function(){G.setModelVisibility(!1)},this.controllerPresent=!1,this.lastControllerCheck=0,this.previousButtonValues={},this.bindMethods(),this.loadedMeshInfo={buttonMeshes:null,axisMeshes:null},this.rayOrigin={origin:new THREE.Vector3,direction:new THREE.Vector3(0,0,-1),createdFromMesh:!1},z.addEventListener("controllerconnected",this.onControllerConnected),z.addEventListener("controllerdisconnected",this.onControllerDisconnected)},addEventListeners:function(){var G=this.el;G.addEventListener("buttonchanged",this.onButtonChanged),G.addEventListener("buttondown",this.onButtonDown),G.addEventListener("buttonup",this.onButtonUp),G.addEventListener("touchstart",this.onButtonTouchStart),G.addEventListener("touchend",this.onButtonTouchEnd),G.addEventListener("axismove",this.onAxisMoved),G.addEventListener("model-error",this.onModelError),G.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var G=this.el;G.removeEventListener("buttonchanged",this.onButtonChanged),G.removeEventListener("buttondown",this.onButtonDown),G.removeEventListener("buttonup",this.onButtonUp),G.removeEventListener("touchstart",this.onButtonTouchStart),G.removeEventListener("touchend",this.onButtonTouchEnd),G.removeEventListener("axismove",this.onAxisMoved),G.removeEventListener("model-error",this.onModelError),G.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){f(this,L,{hand:this.data.hand,index:this.data.pair,iterateControllerProfiles:!0})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},updateControllerModel:function(){if(!this.data.model||this.rayOrigin.createdFromMesh){this.modelReady();return}var G=this.createControllerModelUrl();this.loadModel(G)},createControllerModelUrl:function(G){var z=this.el.components["tracked-controls"],$=z?z.controller:null,Q="default",H=this.data.hand,V;if($&&!window.hasNativeWebXRImplementation&&(H=$.hand,!G)){var ne=$.id.match(D);Q=ne&&ne[0]||Q}return V=S[H]||S.default,w+Q+"/"+V},injectTrackedControls:function(){var G=this.data;this.el.setAttribute("tracked-controls",{idPrefix:L,controller:G.pair,hand:G.hand,armModel:!1}),this.updateControllerModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelError:function(G){var z=this.createControllerModelUrl(!0);G.detail.src!==z?(v("Failed to load controller model for device, attempting to load default."),this.loadModel(z)):v("Failed to load default controller model.")},loadModel:function(G){this.el.setAttribute("gltf-model","url("+G+")")},onModelLoaded:function(G){var z=this.controllerModel=G.detail.model,$=this.loadedMeshInfo,Q,H,V,ne;if(G.target!==this.el)return;if(x("Processing model"),$.buttonMeshes={},$.axisMeshes={},z){for(Q=0;Q<this.mapping.buttons.length;Q++){if(H=this.mapping.buttonMeshNames[this.mapping.buttons[Q]],!H){x("Skipping unknown button at index: "+Q+" with mapped name: "+this.mapping.buttons[Q]);continue}if(V=z.getObjectByName(H),!V){v("Missing button mesh with name: "+H);continue}ne={index:Q,value:Y(V,"VALUE"),pressed:Y(V,"PRESSED"),unpressed:Y(V,"UNPRESSED")},ne.value&&ne.pressed&&ne.unpressed?$.buttonMeshes[this.mapping.buttons[Q]]=ne:v("Missing button submesh under mesh with name: "+H+"(VALUE: "+!!ne.value+", PRESSED: "+!!ne.pressed+", UNPRESSED:"+!!ne.unpressed+")")}for(Q=0;Q<this.mapping.axisMeshNames.length;Q++){if(H=this.mapping.axisMeshNames[Q],!H){x("Skipping unknown axis at index: "+Q);continue}if(V=z.getObjectByName(H),!V){v("Missing axis mesh with name: "+H);continue}ne={index:Q,value:Y(V,"VALUE"),min:Y(V,"MIN"),max:Y(V,"MAX")},ne.value&&ne.min&&ne.max?$.axisMeshes[Q]=ne:v("Missing axis submesh under mesh with name: "+H+"(VALUE: "+!!ne.value+", MIN: "+!!ne.min+", MAX:"+!!ne.max+")")}this.calculateRayOriginFromMesh(z),this.setModelVisibility()}x("Model load complete.");function Y(ae,xe){for(var fe=0,de=ae.children.length;fe<de;fe++){var Ie=ae.children[fe];if(Ie&&Ie.name===xe)return Ie}}},calculateRayOriginFromMesh:function(){var G=new THREE.Quaternion;return function(z){var $;if(this.rayOrigin.origin.set(0,0,0),this.rayOrigin.direction.set(0,0,-1),this.rayOrigin.createdFromMesh=!0,$=z.getObjectByName(this.mapping.pointingPoseMeshName),$){var Q=z.parent;Q&&(z.parent=null,z.updateMatrixWorld(!0),z.parent=Q),$.getWorldPosition(this.rayOrigin.origin),$.getWorldQuaternion(G),this.rayOrigin.direction.applyQuaternion(G),Q&&z.updateMatrixWorld(!0)}else x("Mesh does not contain pointing origin data, defaulting to none.");this.modelReady()}}(),lerpAxisTransform:function(){var G=new THREE.Quaternion;return function(z,$){var Q=this.loadedMeshInfo.axisMeshes[z];if(Q){var H=Q.min,V=Q.max,ne=Q.value,Y=$*.5+.5;ne.setRotationFromQuaternion(G.copy(H.quaternion).slerp(V.quaternion,Y)),ne.position.lerpVectors(H.position,V.position,Y)}}}(),lerpButtonTransform:function(){var G=new THREE.Quaternion;return function(z,$){var Q=this.loadedMeshInfo.buttonMeshes[z];if(Q){var H=Q.unpressed,V=Q.pressed,ne=Q.value;ne.setRotationFromQuaternion(G.copy(H.quaternion).slerp(V.quaternion,$)),ne.position.lerpVectors(H.position,V.position,$)}}}(),modelReady:function(){this.el.emit("controllermodelready",{name:"windows-motion-controls",model:this.data.model,rayOrigin:this.rayOrigin})},onButtonChanged:function(G){var z=this.mapping.buttons[G.detail.id];z&&(this.loadedMeshInfo&&this.loadedMeshInfo.buttonMeshes&&this.lerpButtonTransform(z,G.detail.state.value),this.el.emit(z+"changed",G.detail.state))},onAxisMoved:function(G){var z=this.mapping.axisMeshNames.length;if(this.loadedMeshInfo&&this.loadedMeshInfo.axisMeshes)for(var $=0;$<z;$++)this.lerpAxisTransform($,G.detail.axis[$]||0);m(this,this.mapping.axes,G)},setModelVisibility:function(G){var z=this.el.getObject3D("mesh");this.controllerPresent&&(G=G!==void 0?G:this.modelVisible,this.modelVisible=G,z&&(z.visible=G))}})},"./src/constants/index.js":(l,u,c)=>{l.exports={AFRAME_CDN_ROOT:window.AFRAME_CDN_ROOT||"https://cdn.aframe.io/",AFRAME_INJECTED:"aframe-injected",DEFAULT_CAMERA_HEIGHT:1.6,DEFAULT_HANDEDNESS:"right",keyboardevent:c("./src/constants/keyboardevent.js")}},"./src/constants/keyboardevent.js":l=>{l.exports={KEYCODE_TO_CODE:{38:"ArrowUp",37:"ArrowLeft",40:"ArrowDown",39:"ArrowRight",87:"KeyW",65:"KeyA",83:"KeyS",68:"KeyD"}}},"./src/core/a-assets.js":(l,u,c)=>{var h=c("./src/core/a-node.js").ANode,p=c("./src/utils/debug.js"),f=c("./src/lib/three.js"),m=new f.FileLoader,g=p("core:a-assets:warn");class y extends h{constructor(){super(),this.isAssets=!0,this.fileLoader=m,this.timeout=null}doConnectedCallback(){var I=this,D,L=[],O,U,Z,G,z,$;if(super.doConnectedCallback(),!this.parentNode.isScene)throw new Error("<a-assets> must be a child of a <a-scene>.");for(G=this.querySelectorAll("img"),D=0;D<G.length;D++)Z=_(G[D]),L.push(new Promise(function(Q,H){if(f.Cache.add(G[D].getAttribute("src"),Z),Z.complete){Q();return}Z.onload=Q,Z.onerror=H}));for(U=this.querySelectorAll("audio, video"),D=0;D<U.length;D++)O=_(U[D]),!O.src&&!O.srcObject&&g("Audio/video asset has neither `src` nor `srcObject` attributes."),L.push(v(O));$=this.getChildren(),$.forEach(function(Q){!Q.isAssetItem||!Q.hasAttribute("src")||L.push(new Promise(function(H,V){if(Q.hasLoaded)return H();Q.addEventListener("loaded",H),Q.addEventListener("error",V)}))}),Promise.allSettled(L).then(function(){I.timeout!==null&&I.load()}),z=parseInt(this.getAttribute("timeout"),10)||3e3,this.timeout=setTimeout(function(){I.hasLoaded||(g("Asset loading timed out in",z,"ms"),I.timeout=null,I.emit("timeout"),I.load())},z)}disconnectedCallback(){super.disconnectedCallback(),this.timeout&&clearTimeout(this.timeout)}load(){super.load.call(this,null,function(){return!1})}}customElements.define("a-assets",y);class x extends h{constructor(){super(),this.data=null,this.isAssetItem=!0}connectedCallback(){var I=this,D=this.getAttribute("src");m.setResponseType(this.getAttribute("response-type")||S(D)),m.load(D,function(L){I.data=L,h.prototype.load.call(I)},function(L){I.emit("progress",{loadedBytes:L.loaded,totalBytes:L.total,xhr:L})},function(L){I.emit("error",{xhr:L})})}}customElements.define("a-asset-item",x);function v(B){if(!(!B.hasAttribute("autoplay")&&B.getAttribute("preload")!=="auto"))return new Promise(function(I,D){if(B.readyState===4)return I();if(B.error)return D();B.addEventListener("loadeddata",L,!1),B.addEventListener("progress",L,!1),B.addEventListener("error",D,!1);function L(){for(var O=0,U=0;U<B.buffered.length;U++)O+=B.buffered.end(U)-B.buffered.start(U);O>=B.duration&&(B.tagName==="VIDEO"&&f.Cache.add(B.getAttribute("src"),B),I())}})}function _(B){var I=T(B);return I.tagName&&I.tagName.toLowerCase()==="video"&&(I.setAttribute("playsinline",""),I.setAttribute("webkit-playsinline","")),I!==B&&(B.parentNode.appendChild(I),B.parentNode.removeChild(B)),I}function T(B){var I,D;return B.hasAttribute("crossorigin")||(D=B.getAttribute("src"),D!==null&&(D.indexOf("://")===-1||w(D)===window.location.host))?B:(g('Cross-origin element (e.g., <img>) was requested without `crossorigin` set. A-Frame will re-request the asset with `crossorigin` attribute set. Please set `crossorigin` on the element (e.g., <img crossorigin="anonymous">)',D),B.crossOrigin="anonymous",I=B.cloneNode(!0),I)}function w(B){var I=B.indexOf("://")>-1?B.split("/")[2]:B.split("/")[0];return I.substring(0,I.indexOf(":"))}function S(B){var I=R(B),D=I.lastIndexOf(".");if(D>=0){var L=I.slice(D,B.search(/\?|#|$/));if(L===".glb")return"arraybuffer"}return"text"}l.exports.inferResponseType=S;function R(B){var I=document.createElement("a");I.href=B;var D=I.search.replace(/^\?/,""),L=B.replace(D,"").replace("?","");return L.substring(L.lastIndexOf("/")+1)}l.exports.getFileNameFromURL=R},"./src/core/a-cubemap.js":(l,u,c)=>{var h=c("./src/utils/debug.js"),p=h("core:cubemap:warn");class f extends HTMLElement{constructor(g){return g=super(g),g}onReadyStateChange(){document.readyState==="complete"&&this.doConnectedCallback()}connectedCallback(){if(document.readyState!=="complete"){document.addEventListener("readystatechange",this.onReadyStateChange.bind(this));return}f.prototype.doConnectedCallback.call(this)}doConnectedCallback(){this.srcs=this.validate()}validate(){var g=this.querySelectorAll("[src]"),y,x=[];if(g.length===6){for(y=0;y<g.length;y++)g[y].tagName==="IMG"?x.push(g[y]):x.push(g[y].getAttribute("src"));return x}p("<a-cubemap> did not contain exactly six elements each with a `src` attribute.")}}customElements.define("a-cubemap",f)},"./src/core/a-entity.js":(l,u,c)=>{var h=c("./src/core/a-node.js").ANode,p=c("./src/core/component.js").components,f=c("./src/lib/three.js"),m=c("./src/utils/index.js"),g=m.debug("core:a-entity:debug"),y=m.debug("core:a-entity:warn"),x="__",v=["position","rotation","scale","visible"],_={once:!0};class T extends h{constructor(){super(),this.components={},this.initializingComponents={},this.componentsToUpdate={},this.isEntity=!0,this.isPlaying=!1,this.object3D=new f.Group,this.object3D.rotation.order="YXZ",this.object3D.el=this,this.object3DMap={},this.parentEl=null,this.rotationObj={},this.states=[]}attributeChangedCallback(L,O,U){var Z=this.components[L];if(super.attributeChangedCallback(),Z&&Z.justInitialized&&U===""){delete Z.justInitialized;return}!Z&&U===null||this.setEntityAttribute(L,O,U)}doConnectedCallback(){var L=this,O,U;if(super.doConnectedCallback(),U=this.sceneEl,this.addToParent(),!this.isScene){if(!U){this.load();return}if(O=U.querySelector("a-assets"),O&&!O.hasLoaded){O.addEventListener("loaded",function(){L.load()});return}this.load()}}disconnectedCallback(){var L;if(this.parentEl){for(L in this.components)this.removeComponent(L,!1);this.isScene||(this.removeFromParent(),super.disconnectedCallback(),this.object3D.el=null)}}getObject3D(L){return this.object3DMap[L]}setObject3D(L,O){var U,Z=this;if(!(O instanceof f.Object3D))throw new Error("`Entity.setObject3D` was called with an object that was not an instance of THREE.Object3D.");U=this.getObject3D(L),U&&this.object3D.remove(U),O.el=this,O.children.length&&O.traverse(function(G){G.el=Z}),this.object3D.add(O),this.object3DMap[L]=O,this.emit("object3dset",{object:O,type:L})}removeObject3D(L){var O=this.getObject3D(L);if(!O){y("Tried to remove `Object3D` of type:",L,"which was not defined.");return}this.object3D.remove(O),delete this.object3DMap[L],this.emit("object3dremove",{type:L})}getOrCreateObject3D(L,O){var U=this.getObject3D(L);return!U&&O&&(U=new O,this.setObject3D(L,U)),y("`getOrCreateObject3D` has been deprecated. Use `setObject3D()` and `object3dset` event instead."),U}add(L){if(!L.object3D)throw new Error("Trying to add an element that doesn't have an `object3D`");this.object3D.add(L.object3D),this.emit("child-attached",{el:L})}addToParent(){var L=this.parentEl=this.parentNode;!L||!L.add||this.attachedToParent||(L.add(this),this.attachedToParent=!0)}removeFromParent(){var L=this.parentEl;this.parentEl.remove(this),this.attachedToParent=!1,this.parentEl=null,L.emit("child-detached",{el:this})}load(){var L=this;this.hasLoaded||!this.parentEl||super.load.call(this,function(){L.parentEl&&(L.updateComponents(),(L.isScene||L.parentEl.isPlaying)&&L.play())})}remove(L){L?this.object3D.remove(L.object3D):this.parentNode.removeChild(this)}getChildEntities(){for(var L=this.children,O=[],U=0;U<L.length;U++){var Z=L[U];Z instanceof T&&O.push(Z)}return O}initComponent(L,O,U){var Z,G,z,$,Q;z=m.split(L,x),$=z[0],G=z.length>2?z.slice(1).join("__"):z[1],p[$]&&(Q=w(this,L)||O!==void 0,!(!Q&&!U)&&(L in this.components||(this.initComponentDependencies($),Z=new p[$].Component(this,O,G),this.isPlaying&&Z.play(),this.hasAttribute(L)||(Z.justInitialized=!0,window.HTMLElement.prototype.setAttribute.call(this,L,"")),g("Component initialized: %s",L))))}initComponentDependencies(L){var O=this,U=p[L],Z,G;if(U&&(Z=p[L].dependencies,!!Z))for(G=0;G<Z.length;G++)O.initComponent(Z[G],window.HTMLElement.prototype.getAttribute.call(O,Z[G])||void 0,!0)}removeComponent(L,O){var U;if(U=this.components[L],!!U){if(!U.initialized){this.addEventListener("componentinitialized",function Z(G){G.detail.name===L&&(this.removeComponent(L,O),this.removeEventListener("componentinitialized",Z))});return}U.pause(),U.remove(),O&&(U.destroy(),delete this.components[L],this.hasAttribute(L)&&window.HTMLElement.prototype.removeAttribute.call(this,L)),this.emit("componentremoved",U.evtDetail,!1)}}updateComponents(){var L,O,U,Z,G=this.componentsToUpdate;if(!(!this.hasLoaded&&!this.isLoading)){for(U=0;U<this.mixinEls.length;U++)for(Z in this.mixinEls[U].componentCache)B(Z)&&(G[Z]=!0);if(this.getExtraComponents){O=this.getExtraComponents();for(Z in O)B(Z)&&(G[Z]=!0)}for(U=0;U<this.attributes.length;++U)Z=this.attributes[U].name,v.indexOf(Z)===-1&&B(Z)&&(G[Z]=!0);for(U=0;U<v.length;U++)Z=v[U],this.hasAttribute(Z)&&this.updateComponent(Z,this.getDOMAttribute(Z));for(Z in G)L=R(this.getDOMAttribute(Z),O&&O[Z]),this.updateComponent(Z,L),delete G[Z]}}updateComponent(L,O,U){var Z=this.components[L];if(Z){if(O===null&&!w(this,L)){this.removeComponent(L,!0);return}Z.updateProperties(O,U);return}this.initComponent(L,O,!1)}removeAttribute(L,O){var U=this.components[L];if(U&&O===void 0&&this.removeComponent(L,!0),U&&O!==void 0){U.resetProperty(O);return}L==="mixin"&&this.mixinUpdate(""),window.HTMLElement.prototype.removeAttribute.call(this,L)}play(){var L,O,U;if(!(this.isPlaying||!this.hasLoaded&&!this.isLoading)){this.isPlaying=!0;for(U in this.components)this.components[U].play();for(L=this.getChildEntities(),O=0;O<L.length;O++)L[O].play();this.emit("play")}}pause(){var L,O,U;if(this.isPlaying){this.isPlaying=!1;for(U in this.components)this.components[U].pause();for(L=this.getChildEntities(),O=0;O<L.length;O++)L[O].pause();this.emit("pause")}}setEntityAttribute(L,O,U){if(p[L]||this.components[L]){this.updateComponent(L,U);return}if(L==="mixin"){if(U===this.computedMixinStr)return;this.mixinUpdate(U,O)}}mixinUpdate(L,O,U){var Z=T.componentsUpdated,G,z,$,Q,H=this;if(U||(O=O||this.getAttribute("mixin")),!this.hasLoaded){this.addEventListener("loaded-private",function(){H.mixinUpdate(L,O,!0)},_);return}for($=this.updateMixins(L,O),Z.length=0,Q=0;Q<this.mixinEls.length;Q++)for(G in this.mixinEls[Q].componentCache)Z.indexOf(G)===-1&&(this.components[G]?this.components[G].handleMixinUpdate():this.initComponent(G,null),Z.push(G));for(Q=0;Q<$.oldMixinIds.length;Q++)if(z=document.getElementById($.oldMixinIds[Q]),!!z)for(G in z.componentCache)Z.indexOf(G)===-1&&this.components[G]&&(this.getDOMAttribute(G)?this.components[G].handleMixinUpdate():this.removeComponent(G,!0))}setAttribute(L,O,U){var Z=T.singlePropUpdate,G,z,$,Q,H,V;if(Q=L.indexOf(x),$=Q>0?L.substring(0,Q):L,!p[$]){L==="mixin"&&this.mixinUpdate(O),super.setAttribute.call(this,L,O);return}if(!this.components[L]&&this.hasAttribute(L)&&this.updateComponent(L,window.HTMLElement.prototype.getAttribute.call(this,L)),typeof U<"u"&&typeof O=="string"&&O.length>0&&typeof m.styleParser.parse(O)=="string"){for(V in Z)delete Z[V];G=Z,G[O]=U,z=!1}else G=O,z=U===!0;this.updateComponent(L,G,z),H=this.sceneEl&&this.sceneEl.getAttribute("debug"),H&&this.components[L].flushToDOM()}flushToDOM(L){var O=this.components,U,Z=this.children,G,z;for(z in O)O[z].flushToDOM();if(L)for(G=0;G<Z.length;++G)U=Z[G],U.flushToDOM&&U.flushToDOM(L)}getAttribute(L){var O;return L==="position"?this.object3D.position:L==="rotation"?I(this):L==="scale"?this.object3D.scale:L==="visible"?this.object3D.visible:(O=this.components[L],O?O.data:window.HTMLElement.prototype.getAttribute.call(this,L))}getDOMAttribute(L){var O=this.components[L];return O?O.attrValue:window.HTMLElement.prototype.getAttribute.call(this,L)}addState(L){this.is(L)||(this.states.push(L),this.emit("stateadded",L))}removeState(L){var O=this.states.indexOf(L);O!==-1&&(this.states.splice(O,1),this.emit("stateremoved",L))}is(L){return this.states.indexOf(L)!==-1}inspect(){this.sceneEl.components.inspector.openInspector(this)}destroy(){var L;if(this.parentNode){y("Entity can only be destroyed if detached from scenegraph.");return}for(L in this.components)this.components[L].destroy()}}function w(D,L){return D.components[L]&&D.components[L].attrValue?!0:S(L,D.mixinEls)}function S(D,L){var O,U=!1;for(O=0;O<L.length&&(U=L[O].hasAttribute(D),!U);++O);return U}function R(D,L){return L?L.constructor===Object?m.extend(L,m.styleParser.parse(D||{})):D||L:D}function B(D){return D.indexOf(x)!==-1&&(D=m.split(D,x)[0]),!!p[D]}function I(D){var L=f.MathUtils.radToDeg,O=D.object3D.rotation,U=D.rotationObj;return U.x=L(O.x),U.y=L(O.y),U.z=L(O.z),U}T.componentsUpdated=[],T.singlePropUpdate={},customElements.define("a-entity",T),l.exports.AEntity=T},"./src/core/a-mixin.js":(l,u,c)=>{var h=c("./src/core/a-node.js").ANode,p=c("./src/core/component.js").components,f=c("./src/utils/index.js"),m=f.styleParser,g="__";class y extends h{constructor(){super(),this.componentCache={},this.rawAttributeCache={},this.isMixin=!0}doConnectedCallback(){super.doConnectedCallback(),this.sceneEl=this.closestScene(),this.id=this.getAttribute("id"),this.cacheAttributes(),this.updateEntities(),this.load()}attributeChangedCallback(v,_,T){super.attributeChangedCallback(),this.cacheAttribute(v,T),this.updateEntities()}setAttribute(v,_){window.HTMLElement.prototype.setAttribute.call(this,v,_),this.cacheAttribute(v,_)}cacheAttribute(v,_){var T,w;w=f.split(v,g)[0],T=p[w],_===void 0&&(_=window.HTMLElement.prototype.getAttribute.call(this,v)),this.rawAttributeCache[v]=_,T&&(this.componentCache[v]=this.parseComponentAttrValue(T,_))}parseComponentAttrValue(v,_){var T;return typeof _!="string"?_:(v.isSingleProperty?(T=v.schema.parse(_),typeof T=="string"&&(T=_)):T=m.parse(_),T)}getAttribute(v){return this.componentCache[v]||window.HTMLElement.prototype.getAttribute.call(this,v)}cacheAttributes(){var v=this.attributes,_,T;for(T=0;T<v.length;T++)_=v[T].name,this.cacheAttribute(_)}updateEntities(){var v,_,T;if(this.sceneEl)for(_=this.sceneEl.querySelectorAll("[mixin~="+this.id+"]"),T=0;T<_.length;T++)v=_[T],!(!v.hasLoaded||v.isMixin)&&v.mixinUpdate(this.id)}}customElements.define("a-mixin",y)},"./src/core/a-node.js":(l,u,c)=>{var h=c("./src/utils/index.js"),p=c("./src/core/readyState.js"),f=h.debug("core:a-node:warn"),m={"a-scene":!0,"a-assets":!0,"a-assets-items":!0,"a-cubemap":!0,"a-mixin":!0,"a-node":!0,"a-entity":!0};function g(x){return x.tagName.toLowerCase()in m||x.isNode}class y extends HTMLElement{constructor(){super(),this.computedMixinStr="",this.hasLoaded=!1,this.isNode=!0,this.mixinEls=[]}connectedCallback(){if(!p.canInitializeElements){document.addEventListener("aframeready",this.connectedCallback.bind(this));return}this.doConnectedCallback()}doConnectedCallback(){var v;this.sceneEl=this.closestScene(),this.sceneEl||f("You are attempting to attach <"+this.tagName+"> outside of an A-Frame scene. Append this element to `<a-scene>` instead."),this.hasLoaded=!1,this.emit("nodeready",void 0,!1),this.isMixin||(v=this.getAttribute("mixin"),v&&this.updateMixins(v))}attributeChangedCallback(v,_,T){T!==this.computedMixinStr&&v==="mixin"&&!this.isMixin&&this.updateMixins(T,_)}closestScene(){for(var v=this;v&&!v.isScene;)v=v.parentElement;return v}closest(v){for(var _=this.matches||this.mozMatchesSelector||this.msMatchesSelector||this.oMatchesSelector||this.webkitMatchesSelector,T=this;T&&!_.call(T,v);)T=T.parentElement;return T}disconnectedCallback(){this.hasLoaded=!1}load(v,_){var T,w,S=this;this.hasLoaded||(_=_||g,T=this.getChildren(),w=T.filter(_).map(function(R){return new Promise(function(B,I){if(R.hasLoaded)return B();R.addEventListener("loaded",B),R.addEventListener("error",I)})}),Promise.allSettled(w).then(function(R){R.forEach(function(B){B.status==="rejected"&&f("Rendering scene with errors on node: ",B.reason.target)}),S.isLoading=!0,S.setupMutationObserver(),v&&v(),S.isLoading=!1,S.hasLoaded=!0,S.emit("loaded-private",void 0,!1),S.emit("loaded",void 0,!1)}))}setupMutationObserver(){var v=this,_={attributes:!0,attributeOldValue:!0},T=new MutationObserver(function(w){var S;for(S=0;S<w.length;S++)if(w[S].type==="attributes"){var R=w[S].attributeName,B=window.HTMLElement.prototype.getAttribute.call(v,R),I=w[S].oldValue;v.attributeChangedCallback(R,I,B)}});T.observe(this,_)}getChildren(){return Array.prototype.slice.call(this.children,0)}updateMixins(v,_){var T=y.newMixinIdArray,w=y.oldMixinIdArray,S=y.mixinIds,R,B,I;for(T.length=0,w.length=0,B=v?h.split(v.trim(),/\s+/):T,I=_?h.split(_.trim(),/\s+/):w,S.newMixinIds=B,S.oldMixinIds=I,R=0;R<I.length;R++)B.indexOf(I[R])===-1&&this.unregisterMixin(I[R]);for(this.computedMixinStr="",this.mixinEls.length=0,R=0;R<B.length;R++)this.registerMixin(B[R]);return this.computedMixinStr&&(this.computedMixinStr=this.computedMixinStr.trim(),window.HTMLElement.prototype.setAttribute.call(this,"mixin",this.computedMixinStr)),B.length===0&&window.HTMLElement.prototype.removeAttribute.call(this,"mixin"),S}registerMixin(v){var _,T,w,S=document.getElementById(v);if(!S){f("No mixin was found with id `%s`",v);return}if(w=S.getAttribute("mixin"),w)for(_=h.split(w.trim(),/\s+/),T=0;T<_.length;T++)this.registerMixin(_[T]);this.computedMixinStr=this.computedMixinStr+" "+S.id,this.mixinEls.push(S)}setAttribute(v,_){v==="mixin"&&this.updateMixins(_),window.HTMLElement.prototype.setAttribute.call(this,v,_)}unregisterMixin(v){var _,T=this.mixinEls,w;for(_=0;_<T.length;++_)if(w=T[_],v===w.id){T.splice(_,1);break}}emit(v,_,T,w){var S=y.evtData;T===void 0&&(T=!0),S.bubbles=!!T,S.detail=_,w&&(S=h.extend({},w,S)),this.dispatchEvent(new CustomEvent(v,S))}}y.evtData={},y.newMixinIdArray=[],y.oldMixinIdArray=[],y.mixinIds={},customElements.define("a-node",y),l.exports.ANode=y,l.exports.knownTags=m},"./src/core/component.js":(l,u,c)=>{var h=c("./src/core/schema.js"),p=c("./src/core/scene/scenes.js"),f=c("./src/core/system.js"),m=c("./src/utils/index.js"),g=l.exports.components={},y=h.parseProperty,x=h.process,v=h.isSingleProperty,_=h.stringifyProperties,T=h.stringifyProperty,w=m.styleParser,S=m.debug("core:component:warn"),R=document.currentScript,B=new RegExp("[A-Z]+"),I={},D=Object.freeze({}),L=[],O={get:function(V,ne){return V.getComputedPropertyValue(ne)},set:function(V,ne,Y){return ne in V.schema?V.recomputeProperty(ne,Y):Y!==void 0&&V.handleUnknownProperty(ne,Y),!0}},U=l.exports.Component=function(V,ne,Y){var ae=this;if(this.sceneOnly&&!V.isScene)throw new Error("Component `"+this.name+"` can only be applied to <a-scene>");if(Y&&!this.multiple)throw new Error("Trying to initialize multiple components of type `"+this.name+"`. There can only be one component of this type per entity.");this.el=V,this.id=Y,this.attrName=this.name+(Y?"__"+Y:""),this.evtDetail={id:this.id,name:this.name},this.initialized=!1,this.el.components[this.attrName]=this,this.objectPool=I[this.name];var xe=this.events;this.events={},Z(this,xe),this.attrValue=void 0,this.isObjectBased?(this.data=this.objectPool.use(),m.objectPool.removeUnusedKeys(this.data,this.schema),this.oldData=this.objectPool.use(),m.objectPool.removeUnusedKeys(this.oldData,this.schema),this.attrValueProxy=new Proxy(this,O)):(this.data=void 0,this.oldData=void 0,this.attrValueProxy=void 0),this.deferUnknownPropertyWarnings=!!this.updateSchema,this.silenceUnknownPropertyWarnings=!1,this.throttledEmitComponentChanged=m.throttleLeadingAndTrailing(function(){V.emit("componentchanged",ae.evtDetail,!1)},200),this.updateProperties(ne,!0)};U.prototype={schema:{},init:function(){},events:{},update:function(V){},updateSchema:void 0,tick:void 0,tock:void 0,play:function(){},pause:function(){},remove:function(){},stringify:function(V){var ne=this.schema;return typeof V=="string"?V:this.isSingleProperty?T(V,ne):(V=_(V,ne),w.stringify(V))},flushToDOM:function(V){var ne=V?this.data:this.attrValue;ne!=null&&window.HTMLElement.prototype.setAttribute.call(this.el,this.attrName,this.stringify(ne))},updateProperties:function(V,ne){var Y=this.el;this.updateData(V,ne),!(!Y.hasLoaded&&!Y.isLoading)&&(this.initialized?this.callUpdateHandler():this.initComponent())},initComponent:function(){var V=this.el,ne;V.initializingComponents[this.name]||(V.initializingComponents[this.name]=!0,this.init(),this.initialized=!0,delete V.initializingComponents[this.name],ne=this.isObjectBased?D:void 0,this.dataChanged=!1,this.storeOldData(),this.update(ne),V.isPlaying&&this.play(),V.emit("componentinitialized",this.evtDetail,!1))},updateData:function(V,ne){if(this.isSingleProperty){this.recomputeProperty(void 0,V);return}ne?(m.objectPool.clearObject(this.attrValue),this.recomputeData(V),this.schemaChangeRequired=!!this.updateSchema):typeof V=="string"?w.parse(V,this.attrValueProxy):m.extend(this.attrValueProxy,V),this.updateSchemaIfNeeded(V)},updateSchemaIfNeeded:function(V){if(!this.schemaChangeRequired||!this.updateSchema){for(var ne=0;ne<L.length;ne++)S("Unknown property `"+L[ne]+"` for component `"+this.name+"`.");L.length=0;return}L.length=0,this.updateSchema(this.data),m.objectPool.removeUnusedKeys(this.data,this.schema),this.silenceUnknownPropertyWarnings=!0,this.recomputeData(V),this.silenceUnknownPropertyWarnings=!1,this.schemaChangeRequired=!1},callUpdateHandler:function(){if(!(!this.isPositionRotationScale&&!this.dataChanged)){this.dataChanged=!1;var V=this.oldData;this.oldDataInUse=!0,this.update(V),V!==this.oldData&&this.objectPool.recycle(V),this.oldDataInUse=!1,this.storeOldData(),this.throttledEmitComponentChanged()}},handleMixinUpdate:function(){this.recomputeData(),this.updateSchemaIfNeeded(),this.callUpdateHandler()},resetProperty:function(V){!this.isSingleProperty&&!(V in this.schema)||(V?this.attrValue[V]=void 0:(this.isObjectBased&&this.objectPool.recycle(this.attrValue),this.attrValue=void 0),this.recomputeProperty(V,void 0),this.updateSchemaIfNeeded(),this.callUpdateHandler())},extendSchema:function(V){var ne;ne=m.extend({},g[this.name].schema),m.extend(ne,V),this.schema=x(ne),this.el.emit("schemachanged",this.evtDetail)},getComputedPropertyValue:function(V){var ne=this.el.mixinEls,Y=this.attrValue&&V?this.attrValue[V]:this.attrValue;if(Y!==void 0)return Y;for(var ae=ne.length-1;ae>=0;ae--){var xe=ne[ae].getAttribute(this.attrName);if(!(xe===null||V&&!(V in xe)))return V?xe[V]:xe}var fe=V?this.schema[V].default:this.schema.default;return fe},recomputeProperty:function(V,ne){var Y=V?this.schema[V]:this.schema;if(ne!=null){this.attrValue===void 0&&this.isObjectBased&&(this.attrValue=this.objectPool.use());var ae=V?this.attrValue[V]:this.attrValue;ae=Y.isCacheable?y(ne,Y,ae):ne,typeof ae=="string"&&(ae=ne===""?void 0:ne),V?this.attrValue[V]=ae:this.attrValue=ae}this.oldDataInUse&&(this.oldData=this.objectPool.use(),m.objectPool.removeUnusedKeys(this.oldData,this.schema),this.storeOldData(),this.oldDataInUse=!1);var xe=V?this.oldData[V]:this.oldData,fe=V?this.data[V]:this.data,de=y(this.getComputedPropertyValue(V),Y,fe);return Y.type==="array"&&!V&&(de=m.clone(de)),Y.equals(de,xe)||(this.dataChanged=!0,Y.schemaChange&&(this.schemaChangeRequired=!0)),V?this.data[V]=de:this.data=de,de},handleUnknownProperty:function(V,ne){this.attrValue===void 0&&(this.attrValue=this.objectPool.use()),this.attrValue[V]=ne,this.silenceUnknownPropertyWarnings||(this.deferUnknownPropertyWarnings?L.push(V):this.silenceUnknownPropertyWarnings||S("Unknown property `"+V+"` for component `"+this.name+"`."))},storeOldData:function(){if(!this.isObjectBased){this.oldData=this.data;return}if(this.isSingleProperty){this.oldData=y(this.data,this.schema,this.oldData);return}var V;for(V in this.schema)this.data[V]!==void 0&&(this.data[V]&&typeof this.data[V]=="object"?this.oldData[V]=y(this.data[V],this.schema[V],this.oldData[V]):this.oldData[V]=this.data[V])},recomputeData:function(V){var ne;if(this.isSingleProperty){this.recomputeProperty(void 0,V);return}if(V&&typeof V=="object")for(ne in this.schema)this.attrValueProxy[ne]=V[ne];else for(ne in this.schema)this.attrValueProxy[ne]=void 0;typeof V=="string"&&w.parse(V,this.attrValueProxy);for(ne in this.attrValue)this.attrValue[ne]!==void 0&&L.indexOf(ne)!==-1&&(ne in this.schema||S("Unknown property `"+ne+"` for component `"+this.name+"`."))},eventsAttach:function(){var V;this.eventsDetach();for(V in this.events)this.el.addEventListener(V,this.events[V])},eventsDetach:function(){var V;for(V in this.events)this.el.removeEventListener(V,this.events[V])},destroy:function(){this.objectPool.recycle(this.attrValue),this.objectPool.recycle(this.data),this.objectPool.recycle(this.oldData),this.attrValue=this.data=this.oldData=this.attrValueProxy=void 0}};function Z(V,ne){var Y;for(Y in ne)V.events[Y]=ne[Y].bind(V)}if(window.debug)var G=l.exports.registrationOrderWarnings={};l.exports.registerComponent=function(V,ne){var Y,ae={},xe,fe;if(document.currentScript&&document.currentScript!==R&&p.forEach(function(Ie){Ie.hasLoaded||document.currentScript.compareDocumentPosition(Ie)!==Node.DOCUMENT_POSITION_FOLLOWING&&(S("The component `"+V+"` was registered in a <script> tag after the scene. Component <script> tags in an HTML file should be declared *before* the scene such that the component is available to entities during scene initialization."),window.debug&&(G[V]=!0))}),B.test(V)===!0&&S("The component name `"+V+"` contains uppercase characters, but HTML will ignore the capitalization of attribute names. Change the name to be lowercase: `"+V.toLowerCase()+"`"),V.indexOf("__")!==-1)throw new Error("The component name `"+V+"` is not allowed. The sequence __ (double underscore) is reserved to specify an id for multiple components of the same type");if(Object.keys(ne).forEach(function(Ie){ae[Ie]={value:ne[Ie],writable:!0}}),g[V])throw new Error("The component `"+V+"` has been already registered. Check that you are not loading two versions of the same component or two different components of the same name.");Y=function(Ie,Ge,Xe){U.call(this,Ie,Ge,Xe)},Y.prototype=Object.create(U.prototype,ae),Y.prototype.name=V,Y.prototype.isPositionRotationScale=V==="position"||V==="rotation"||V==="scale",Y.prototype.constructor=Y,Y.prototype.system=f&&f.systems[V],Y.prototype.play=Q(Y.prototype.play),Y.prototype.pause=$(Y.prototype.pause),xe=m.extend(x(Y.prototype.schema,Y.prototype.name)),Y.prototype.isSingleProperty=fe=v(Y.prototype.schema),Y.prototype.isObjectBased=!fe||fe&&(H(xe.default)||H(y(void 0,xe))),I[V]=m.objectPool.createPool(),g[V]={Component:Y,dependencies:Y.prototype.dependencies,before:Y.prototype.before,after:Y.prototype.after,isSingleProperty:Y.prototype.isSingleProperty,isObjectBased:Y.prototype.isObjectBased,multiple:Y.prototype.multiple,sceneOnly:Y.prototype.sceneOnly,name:V,schema:xe,stringify:Y.prototype.stringify};for(var de=0;de<p.length;de++)p[de].emit("componentregistered",{name:V},!1);return Y};function z(V){return V.tick||V.tock}function $(V){return function(){var ne=this.el.sceneEl;this.isPlaying&&(V.call(this),this.isPlaying=!1,this.eventsDetach(),z(this)&&ne.removeBehavior(this))}}function Q(V){return function(){var ne=this.el.sceneEl,Y=this.el.isPlaying&&!this.isPlaying;!this.initialized||!Y||(V.call(this),this.isPlaying=!0,this.eventsAttach(),z(this)&&ne.addBehavior(this))}}function H(V){return V&&V.constructor===Object&&!(V instanceof window.HTMLElement)}},"./src/core/geometry.js":(l,u,c)=>{var h=c("./src/core/schema.js"),p=h.process,f=l.exports.geometries={},m=l.exports.geometryNames=[],g=c("./src/lib/three.js"),y=l.exports.Geometry=function(){};y.prototype={schema:{},init:function(x){return this.geometry=new g.BufferGeometry,this.geometry},update:function(x){}},l.exports.registerGeometry=function(x,v){var _,T={};if(Object.keys(v).forEach(function(w){T[w]={value:v[w],writable:!0}}),f[x])throw new Error("The geometry `"+x+"` has been already registered");return _=function(){y.call(this)},_.prototype=Object.create(y.prototype,T),_.prototype.name=x,_.prototype.constructor=_,f[x]={Geometry:_,schema:p(_.prototype.schema)},m.push(x),_}},"./src/core/propertyTypes.js":(l,u,c)=>{var h=c("./src/utils/coordinates.js"),p=c("./node_modules/debug/src/browser.js"),f=p("core:propertyTypes:warn"),m=l.exports.propertyTypes={},g=/[,> .[\]:]/,y=/url\((.+)\)/;x("audio","",w),x("array",[],v,_,T),x("asset","",w),x("boolean",!1,I),x("color","#FFF"),x("int",0,D),x("number",0,L),x("map","",w),x("model","",w),x("selector",null,O,Z,B,!1),x("selectorAll",null,U,G,T,!1),x("src","",z),x("string",""),x("time",0,D),x("vec2",{x:0,y:0},$,h.stringify,h.equals),x("vec3",{x:0,y:0,z:0},$,h.stringify,h.equals),x("vec4",{x:0,y:0,z:0,w:1},$,h.stringify,h.equals);function x(V,ne,Y,ae,xe,fe){if(V in m)throw new Error("Property type "+V+" is already registered.");m[V]={default:ne,parse:Y||S,stringify:ae||R,equals:xe||B,isCacheable:fe!==!1}}l.exports.registerPropertyType=x;function v(V){if(Array.isArray(V))return V;if(!V||typeof V!="string")return[];return V.split(",").map(ne);function ne(Y){return Y.trim()}}function _(V){return V.join(", ")}function T(V,ne){if(!Array.isArray(V)||!Array.isArray(ne))return V===ne;if(V.length!==ne.length)return!1;for(var Y=0;Y<V.length;Y++)if(V[Y]!==ne[Y])return!1;return!0}function w(V){var ne,Y;if(typeof V!="string")return V;if(Y=V.match(y),Y)return Y[1];if(V.charAt(0)==="#"){if(ne=document.getElementById(V.substring(1)),ne)return ne.tagName==="CANVAS"||ne.tagName==="VIDEO"||ne.tagName==="IMG"?ne:ne.getAttribute("src");f('"'+V+'" asset not found.');return}return V}function S(V){return V}function R(V){return V===null?"null":V.toString()}function B(V,ne){return V===ne}function I(V){return V!=="false"&&V!==!1}function D(V){return parseInt(V,10)}function L(V){return parseFloat(V,10)}function O(V){return V?typeof V!="string"?V:V[0]==="#"&&!g.test(V)?document.getElementById(V.substring(1)):document.querySelector(V):null}function U(V){return V?typeof V!="string"?V:Array.prototype.slice.call(document.querySelectorAll(V),0):null}function Z(V){return V.getAttribute?"#"+V.getAttribute("id"):R(V)}function G(V){return V instanceof Array?V.map(function(ne){return"#"+ne.getAttribute("id")}).join(", "):R(V)}function z(V){return f("`src` property type is deprecated. Use `asset` instead."),w(V)}function $(V,ne,Y){return h.parse(V,ne,Y)}function Q(V,ne){return V==="audio"&&typeof ne!="string"||V==="array"&&!Array.isArray(ne)||V==="asset"&&typeof ne!="string"||V==="boolean"&&typeof ne!="boolean"||V==="color"&&typeof ne!="string"||V==="int"&&typeof ne!="number"||V==="number"&&typeof ne!="number"||V==="map"&&typeof ne!="string"||V==="model"&&typeof ne!="string"||V==="selector"&&typeof ne!="string"&&ne!==null||V==="selectorAll"&&typeof ne!="string"&&ne!==null||V==="src"&&typeof ne!="string"||V==="string"&&typeof ne!="string"||V==="time"&&typeof ne!="number"?!1:V==="vec2"?H(ne,2):V==="vec3"?H(ne,3):V==="vec4"?H(ne,4):!0}l.exports.isValidDefaultValue=Q;function H(V,ne){if(V===null)return!0;if(typeof V!="object"||Object.keys(V).length!==ne)return!1;var Y=V.x,ae=V.y,xe=V.z,fe=V.w;return!(typeof Y!="number"||typeof ae!="number"||ne>2&&typeof xe!="number"||ne>3&&typeof fe!="number")}l.exports.isValidDefaultCoordinate=H},"./src/core/readyState.js":l=>{l.exports.canInitializeElements=!1;function u(){if(document.readyState==="complete"){c();return}document.addEventListener("readystatechange",function h(){document.readyState==="complete"&&(document.removeEventListener("readystatechange",h),c())})}l.exports.waitForDocumentReadyState=u;function c(){l.exports.canInitializeElements||(l.exports.canInitializeElements=!0,setTimeout(function(){document.dispatchEvent(new CustomEvent("aframeready"))}))}l.exports.emitReady=c},"./src/core/scene/a-scene.js":(l,u,c)=>{var h=c("./src/core/scene/metaTags.js").inject,p=c("./src/core/scene/wakelock.js"),f=c("./src/core/scene/loadingScreen.js"),m=c("./src/core/scene/scenes.js"),g=c("./src/core/system.js").systems,y=c("./src/core/component.js").components,x=c("./src/lib/three.js"),v=c("./src/utils/index.js"),_=v.debug("core:a-scene:warn"),T=c("./src/core/a-entity.js").AEntity,w=c("./src/core/a-node.js").ANode,S=c("./src/core/scene/postMessage.js"),R=v.device.isIOS(),B=v.device.isMobile(),I=v.device.isWebXRAvailable;R&&c("./src/utils/ios-orientationchange-blank-bug.js");class D extends T{constructor(){var H;super(),H=this,H.clock=new x.Clock,H.isIOS=R,H.isMobile=B,H.hasWebXR=I,H.isAR=!1,H.isScene=!0,H.object3D=new x.Scene,H.object3D.onAfterRender=function(V,ne,Y){H.isPlaying&&H.tock(H.time,H.delta,Y)},H.resize=H.resize.bind(H),H.render=H.render.bind(H),H.systems={},H.systemNames=[],H.time=H.delta=0,H.usedOfferSession=!1,H.componentOrder=[],H.behaviors={},H.hasLoaded=!1,H.isPlaying=!1,H.originalHTML=H.innerHTML}addFullScreenStyles(){document.documentElement.classList.add("a-fullscreen")}removeFullScreenStyles(){document.documentElement.classList.remove("a-fullscreen")}doConnectedCallback(){var H=this,V=this.hasAttribute("embedded");this.setAttribute("inspector",""),this.setAttribute("keyboard-shortcuts",""),this.setAttribute("screenshot",""),this.setAttribute("xr-mode-ui",""),this.setAttribute("device-orientation-permission-ui",""),super.doConnectedCallback(),$(this),this.setupRenderer(),f.setup(this,U),this.resize(),V||this.addFullScreenStyles(),S(this),h(this),p(this),this.onVRPresentChangeBound=this.onVRPresentChange.bind(this),window.addEventListener("vrdisplaypresentchange",this.onVRPresentChangeBound),this.enterVRBound=function(){H.enterVR()},this.exitVRBound=function(){H.exitVR()},this.exitVRTrueBound=function(){H.exitVR(!0)},this.pointerRestrictedBound=function(){H.pointerRestricted()},this.pointerUnrestrictedBound=function(){H.pointerUnrestricted()},H.hasWebXR||(window.addEventListener("vrdisplaydeactivate",this.exitVRBound),window.addEventListener("vrdisplaydisconnect",this.exitVRTrueBound),window.addEventListener("vrdisplaypointerrestricted",this.pointerRestrictedBound),window.addEventListener("vrdisplaypointerunrestricted",this.pointerUnrestrictedBound)),window.addEventListener("sessionend",this.resize),this.addEventListener("cameraready",function(){H.attachedCallbackPostCamera()}),this.initSystems(),this.componentOrder=L(y,this.componentOrder),this.addEventListener("componentregistered",function(){H.componentOrder=L(y,H.componentOrder)}),this.hasWebXR&&navigator.xr&&navigator.xr.addEventListener&&navigator.xr.addEventListener("sessiongranted",function(){H.enterVR()})}attachedCallbackPostCamera(){var H,V=this;window.addEventListener("load",H),window.addEventListener("resize",function(){V.isIOS?setTimeout(V.resize,100):V.resize()}),this.play(),m.push(this)}initSystems(){var H;this.initSystem("camera");for(H in g)H!=="camera"&&this.initSystem(H)}initSystem(H){this.systems[H]||(this.systems[H]=new g[H](this),this.systemNames.push(H))}disconnectedCallback(){var H=m.indexOf(this);super.disconnectedCallback(),m.splice(H,1),window.removeEventListener("vrdisplaypresentchange",this.onVRPresentChangeBound),window.removeEventListener("vrdisplayactivate",this.enterVRBound),window.removeEventListener("vrdisplaydeactivate",this.exitVRBound),window.removeEventListener("vrdisplayconnect",this.enterVRBound),window.removeEventListener("vrdisplaydisconnect",this.exitVRTrueBound),window.removeEventListener("vrdisplaypointerrestricted",this.pointerRestrictedBound),window.removeEventListener("vrdisplaypointerunrestricted",this.pointerUnrestrictedBound),window.removeEventListener("sessionend",this.resize),this.renderer.dispose()}addBehavior(H){var V,ne=this.behaviors[H.name],Y;ne||(ne=this.behaviors[H.name]={tick:{inUse:!1,array:[],markedForRemoval:[]},tock:{inUse:!1,array:[],markedForRemoval:[]}});for(Y in ne)if(H[Y]){if(V=ne[Y],V.inUse){var ae=V.markedForRemoval.indexOf(H);ae!==-1&&V.markedForRemoval.splice(ae,1)}V.array.indexOf(H)===-1&&V.array.push(H)}}getPointerLockElement(){return document.pointerLockElement}checkHeadsetConnected(){return v.device.checkHeadsetConnected()}enterAR(){var H;if(!this.hasWebXR)throw H="Failed to enter AR mode, WebXR not supported.",new Error(H);if(!v.device.checkARSupport())throw H="Failed to enter AR, WebXR immersive-ar mode not supported in your browser or device.",new Error(H);return this.enterVR(!0)}enterVR(H,V){var ne=this,Y,ae=ne.renderer.xr,xe;if(V&&(!navigator.xr||!navigator.xr.offerSession))return Promise.resolve("OfferSession is not supported.");if(ne.usedOfferSession&&V)return Promise.resolve("OfferSession was already called.");if(this.is("vr-mode"))return Promise.resolve("Already in VR.");if(this.checkHeadsetConnected()||this.isMobile){var fe=ne.getAttribute("renderer");if(ae.enabled=!0,this.hasWebXR){this.xrSession&&this.xrSession.removeEventListener("end",this.exitVRBound);var de=this.sceneEl.systems.webxr.sessionReferenceSpaceType;ae.setReferenceSpaceType(de);var Ie=H?"immersive-ar":"immersive-vr";return xe=this.sceneEl.systems.webxr.sessionConfiguration,new Promise(function(lt,At){var Gt=V?navigator.xr.offerSession.bind(navigator.xr):navigator.xr.requestSession.bind(navigator.xr);ne.usedOfferSession|=V,Gt(Ie,xe).then(function(gt){V&&(ne.usedOfferSession=!1),ae.layersEnabled=xe.requiredFeatures.indexOf("layers")!==-1,ae.setSession(gt).then(function(){ae.setFoveation(fe.foveationLevel),ne.xrSession=gt,ne.systems.renderer.setWebXRFrameRate(gt),gt.addEventListener("end",ne.exitVRBound),Xe(lt)})},function(gt){var xi=Ie==="immersive-ar",Ze=xi?"AR":"VR";At(new Error("Failed to enter "+Ze+" mode (`requestSession`)",{cause:gt}))})})}else{if(Y=v.device.getVRDisplay(),ae.setDevice(Y),Y.isPresenting&&!window.hasNativeWebVRImplementation)return Xe(),Promise.resolve();var Ge={highRefreshRate:fe.highRefreshRate};return Y.requestPresent([{source:this.canvas,attributes:Ge}]).then(Xe,$e)}}return Xe(),Promise.resolve();function Xe(lt){var At;window.hasNativeWebVRImplementation&&!window.hasNativeWebXRImplementation&&(At=new CustomEvent("vrdisplaypresentchange",{detail:{display:v.device.getVRDisplay()}}),window.dispatchEvent(At)),H?ne.addState("ar-mode"):ne.addState("vr-mode"),ne.emit("enter-vr",{target:ne}),!ne.hasWebXR&&ne.isMobile&&screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape"),ne.addFullScreenStyles(),!ne.isMobile&&!ne.checkHeadsetConnected()&&G(ne.canvas),ne.resize(),lt&&lt()}function $e(lt){throw ne.removeState("vr-mode"),lt&&lt.message?new Error("Failed to enter VR mode (`requestPresent`): "+lt.message):new Error("Failed to enter VR mode (`requestPresent`).")}}exitVR(){var H=this,V,ne=this.renderer.xr;if(!this.is("vr-mode")&&!this.is("ar-mode"))return Promise.resolve("Not in immersive mode.");if(this.checkHeadsetConnected()||this.isMobile){if(ne.enabled=!1,V=v.device.getVRDisplay(),this.hasWebXR)this.xrSession.removeEventListener("end",this.exitVRBound),this.xrSession.end().then(function(){},function(){}),this.xrSession=void 0;else if(V.isPresenting)return V.exitPresent().then(Y,ae)}else z();return Y(),Promise.resolve();function Y(){H.removeState("vr-mode"),H.removeState("ar-mode"),H.isMobile&&screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),H.hasAttribute("embedded")&&H.removeFullScreenStyles(),H.resize(),H.isIOS&&v.forceCanvasResizeSafariMobile(H.canvas),H.renderer.setPixelRatio(window.devicePixelRatio),H.emit("exit-vr",{target:H})}function ae(xe){throw xe&&xe.message?new Error("Failed to exit VR mode (`exitPresent`): "+xe.message):new Error("Failed to exit VR mode (`exitPresent`).")}}pointerRestricted(){if(this.canvas){var H=this.getPointerLockElement();H&&H!==this.canvas&&document.exitPointerLock&&document.exitPointerLock(),this.canvas.requestPointerLock&&this.canvas.requestPointerLock()}}pointerUnrestricted(){var H=this.getPointerLockElement();H&&H===this.canvas&&document.exitPointerLock&&document.exitPointerLock()}onVRPresentChange(H){var V=H.display||H.detail.display;if(V&&V.isPresenting){this.enterVR();return}this.exitVR()}getAttribute(H){var V=this.systems[H];return V?V.data:T.prototype.getAttribute.call(this,H)}getDOMAttribute(H){var V=this.systems[H];return V?V.data:T.prototype.getDOMAttribute.call(this,H)}setAttribute(H,V,ne){if(g[H]){w.prototype.setAttribute.call(this,H,V);var Y=this.systems[H];Y&&Y.updateProperties(V);return}T.prototype.setAttribute.call(this,H,V,ne)}removeBehavior(H){var V,ne,Y=this.behaviors[H.name],ae;for(ne in Y)H[ne]&&(V=Y[ne],ae=V.array.indexOf(H),ae!==-1&&(V.inUse?V.markedForRemoval.indexOf(H)===-1&&V.markedForRemoval.push(H):(V.array[ae]=V.array[V.array.length-1],V.array.pop())))}resize(){var H=this.camera,V=this.canvas,ne,Y,ae,xe=this.renderer.xr.isPresenting;Y=this.renderer.xr.enabled&&xe,!(!H||!V||this.is("vr-mode")&&(this.isMobile||Y))&&(ne=this.getAttribute("embedded")&&!this.is("vr-mode"),ae=U(V,ne,this.maxCanvasSize,this.is("vr-mode")),H.aspect=ae.width/ae.height,H.updateProjectionMatrix(),this.renderer.setSize(ae.width,ae.height,!1),this.emit("rendererresize",null,!1))}setupRenderer(){var H=this,V,ne,Y,ae;ae={alpha:!0,antialias:!B,canvas:this.canvas,logarithmicDepthBuffer:!1,powerPreference:"high-performance"},this.maxCanvasSize={height:-1,width:-1},this.hasAttribute("renderer")&&(Y=this.getAttribute("renderer"),ne=v.styleParser.parse(Y),ne.precision&&(ae.precision=ne.precision+"p"),ne.antialias&&ne.antialias!=="auto"&&(ae.antialias=ne.antialias==="true"),ne.logarithmicDepthBuffer&&ne.logarithmicDepthBuffer!=="auto"&&(ae.logarithmicDepthBuffer=ne.logarithmicDepthBuffer==="true"),ne.alpha&&(ae.alpha=ne.alpha==="true"),ne.stencil&&(ae.stencil=ne.stencil==="true"),ne.multiviewStereo&&(ae.multiviewStereo=ne.multiviewStereo==="true"),this.maxCanvasSize={width:ne.maxCanvasWidth?parseInt(ne.maxCanvasWidth):this.maxCanvasSize.width,height:ne.maxCanvasHeight?parseInt(ne.maxCanvasHeight):this.maxCanvasSize.height}),V=this.renderer=new x.WebGLRenderer(ae),V.setPixelRatio(window.devicePixelRatio),this.camera&&V.xr.setPoseTarget(this.camera.el.object3D),this.addEventListener("camera-set-active",function(){V.xr.setPoseTarget(H.camera.el.object3D)})}play(){var H=this,V=this;if(this.renderStarted){T.prototype.play.call(this);return}this.addEventListener("loaded",function(){var ne=this.renderer,Y,ae=this.renderer.xr;T.prototype.play.call(this),!V.renderStarted&&(V.resize(),V.renderer&&(window.performance&&window.performance.mark("render-started"),f.remove(),Y=v.device.getVRDisplay(),Y&&Y.isPresenting&&(ae.setDevice(Y),ae.enabled=!0,V.enterVR()),ne.setAnimationLoop(this.render),V.renderStarted=!0,V.emit("renderstart")))}),setTimeout(function(){T.prototype.load.call(H)})}updateComponent(H){H in g||T.prototype.updateComponent.apply(this,arguments)}tick(H,V){var ne,Y=this.systems;for(this.callComponentBehaviors("tick",H,V),ne=0;ne<this.systemNames.length;ne++)Y[this.systemNames[ne]].tick&&Y[this.systemNames[ne]].tick(H,V)}tock(H,V,ne){var Y,ae=this.systems;for(this.callComponentBehaviors("tock",H,V),Y=0;Y<this.systemNames.length;Y++)ae[this.systemNames[Y]].tock&&ae[this.systemNames[Y]].tock(H,V,ne)}render(H,V){var ne=this.renderer;this.frame=V,this.delta=this.clock.getDelta()*1e3,this.time=this.clock.elapsedTime*1e3,this.isPlaying&&this.tick(this.time,this.delta);var Y=null;this.is("ar-mode")&&(Y=this.object3D.background,this.object3D.background=null),ne.render(this.object3D,this.camera),Y&&(this.object3D.background=Y)}callComponentBehaviors(H,V,ne){for(var Y,ae=0;ae<this.componentOrder.length;ae++){var xe=this.behaviors[this.componentOrder[ae]];if(xe){var fe=xe[H];for(fe.inUse=!0,Y=0;Y<fe.array.length;Y++)fe.array[Y].isPlaying&&fe.array[Y][H](V,ne);for(fe.inUse=!1,Y=0;Y<fe.markedForRemoval.length;Y++)this.removeBehavior(fe.markedForRemoval[Y]);fe.markedForRemoval.length=0}}}}function L(Q,H){var V={},ne,Y,ae=H||[];ae.length=0;for(Y in Q){var xe=Q[Y];if(xe!==void 0){var fe=xe.before?xe.before.slice(0):[],de=xe.after?xe.after.slice(0):[];V[Y]={before:fe,after:de,visited:!1,done:!1}}}for(Y in V)for(ne=0;ne<V[Y].before.length;ne++){var Ie=V[Y].before[ne];if(!(Ie in V)){_("Invalid ordering constraint, no component named `"+Ie+"` referenced by `"+Y+"`");continue}V[Ie].after.push(Y)}function Ge(Xe){if(!(!(Xe in V)||V[Xe].done)){if(V[Xe].visited){_("Cycle detected, ignoring one or more before/after constraints. The resulting order might be incorrect");return}V[Xe].visited=!0;for(var $e=0;$e<V[Xe].after.length;$e++){var lt=V[Xe].after[$e];lt in V||_("Invalid before/after constraint, no component named `"+lt+"` referenced in `"+Xe+"`"),Ge(lt)}V[Xe].done=!0,ae.push(Xe)}}for(Y in V)V[Y].done||Ge(Y);return ae}l.exports.determineComponentBehaviorOrder=L;function O(Q,H){var V,ne=window.devicePixelRatio;return!H||H.width===-1&&H.height===-1||Q.width*ne<H.width&&Q.height*ne<H.height||(V=Q.width/Q.height,Q.width*ne>H.width&&H.width!==-1&&(Q.width=Math.round(H.width/ne),Q.height=Math.round(H.width/V/ne)),Q.height*ne>H.height&&H.height!==-1&&(Q.height=Math.round(H.height/ne),Q.width=Math.round(H.height*V/ne))),Q}customElements.define("a-scene",D);function U(Q,H,V,ne){if(!Q.parentElement)return{height:0,width:0};if(H){var Y;return Y={height:Q.parentElement.offsetHeight,width:Q.parentElement.offsetWidth},O(Y,V)}return Z(V,ne)}function Z(Q,H){var V;return V={height:document.body.offsetHeight,width:document.body.offsetWidth},H?V:O(V,Q)}function G(Q){var H=Q.requestFullscreen||Q.webkitRequestFullscreen||Q.mozRequestFullScreen||Q.msRequestFullscreen;H.apply(Q,[{navigationUI:"hide"}])}function z(){var Q=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement;Q&&(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen())}function $(Q){var H;H=document.createElement("canvas"),H.classList.add("a-canvas"),H.dataset.aframeCanvas=!0,Q.appendChild(H),document.addEventListener("fullscreenchange",V),document.addEventListener("mozfullscreenchange",V),document.addEventListener("webkitfullscreenchange",V),document.addEventListener("MSFullscreenChange",V),H.addEventListener("touchmove",function(ne){ne.preventDefault()},{passive:!1}),Q.canvas=H,Q.emit("render-target-loaded",{target:H}),setTimeout(Q.resize.bind(Q),0);function V(){var ne=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement;ne||Q.exitVR(),document.activeElement.blur(),document.body.focus()}}l.exports.setupCanvas=$,l.exports.AScene=D},"./src/core/scene/loadingScreen.js":(l,u,c)=>{var h=c("./src/utils/index.js"),p=h.styleParser,f,m,g,y="loading-screen",x="a-loader-title";l.exports.setup=function(T,w){f=T,g=w;var S=f.hasAttribute(y)?p.parse(f.getAttribute(y)):void 0,R=S&&S.dotsColor||"white",B=S&&S.backgroundColor||"#24CAFF",I=S===void 0||S.enabled==="true"||S.enabled===void 0,D,L,O,U,Z,G,z,$,Q,H;I&&(D=new THREE.Scene,L=new THREE.SphereGeometry(.2,36,18,0,2*Math.PI,0,Math.PI),O=new THREE.MeshBasicMaterial({color:R}),U=new THREE.Mesh(L,O),Z=U.clone(),G=U.clone(),z=new THREE.PerspectiveCamera(80,window.innerWidth/window.innerHeight,5e-4,1e4),$=new THREE.Clock,Q=0,H=function(){f.renderer.render(D,z),Q=$.getElapsedTime()%4,U.visible=Q>=1,Z.visible=Q>=2,G.visible=Q>=3},D.background=new THREE.Color(B),D.add(z),U.position.set(-1,0,-15),Z.position.set(0,0,-15),G.position.set(1,0,-15),z.add(U),z.add(Z),z.add(G),_(),setTimeout(function(){f.hasLoaded||(v(z),m.style.display="block",window.addEventListener("resize",function(){v(z)}),f.renderer.setAnimationLoop(H))},200))},l.exports.remove=function(){window.removeEventListener("resize",v),m&&(m.style.display="none")};function v(T){var w=f.hasAttribute("embedded"),S=g(f.canvas,w,f.maxCanvasSize,f.is("vr-mode"));T.aspect=S.width/S.height,T.updateProjectionMatrix(),f.renderer.setSize(S.width,S.height,!1)}function _(){m=document.createElement("div"),m.className=x,m.innerHTML=document.title,m.style.display="none",f.appendChild(m)}},"./src/core/scene/metaTags.js":(l,u,c)=>{var h=c("./src/constants/index.js"),p=c("./src/utils/index.js").extend,f=l.exports.MOBILE_HEAD_TAGS=[g({name:"viewport",content:"width=device-width,initial-scale=1,maximum-scale=1,shrink-to-fit=no,user-scalable=no,minimal-ui,viewport-fit=cover"}),g({name:"mobile-web-app-capable",content:"yes"}),g({name:"theme-color",content:"black"})],m=[g({name:"apple-mobile-web-app-capable",content:"yes"}),g({name:"apple-mobile-web-app-status-bar-style",content:"black"}),y({rel:"apple-touch-icon",href:"https://aframe.io/images/aframe-logo-152.png"})];function g(v){return{tagName:"meta",attributes:v,exists:function(){return document.querySelector('meta[name="'+v.name+'"]')}}}function y(v){return{tagName:"link",attributes:v,exists:function(){return document.querySelector('link[rel="'+v.rel+'"]')}}}l.exports.inject=function(v){var _=document.head,T=_.querySelector("script"),w,S=[];return f.forEach(R),v.isIOS&&m.forEach(R),S;function R(B){!B||B.exists()||(w=x(B),w&&(T?T.parentNode.insertBefore(w,T):_.appendChild(w),S.push(w)))}};function x(v){if(!(!v||!v.tagName)){var _=document.createElement(v.tagName);return _.setAttribute(h.AFRAME_INJECTED,""),p(_,v.attributes)}}},"./src/core/scene/postMessage.js":(l,u,c)=>{var h=c("./src/utils/index.js").isIframed;l.exports=function(f){h()&&window.addEventListener("message",p.bind(f))};function p(f){var m=this;if(f.data)switch(f.data.type){case"vr":switch(f.data.data){case"enter":m.enterVR();break;case"exit":m.exitVR();break}}}},"./src/core/scene/scenes.js":l=>{l.exports=[]},"./src/core/scene/wakelock.js":(l,u,c)=>{var h=c("./vendor/wakelock/wakelock.js");l.exports=function(p){if(p.isMobile){var f=p.wakelock=new h;p.addEventListener("enter-vr",function(){f.request()}),p.addEventListener("exit-vr",function(){f.release()})}}},"./src/core/schema.js":(l,u,c)=>{var h=c("./src/utils/index.js"),p=c("./src/core/propertyTypes.js"),f=h.debug,m=p.isValidDefaultValue,g=p.propertyTypes,y=f("core:schema:warn");function x(w){return"type"in w?typeof w.type=="string":"default"in w}l.exports.isSingleProperty=x,l.exports.process=function(w,S){var R;if(x(w))return v(w,S);for(R in w)w[R]=v(w[R],S);return w};function v(w,S){var R=w.default,B,I,D=w.type;return w.type?w.type==="bool"?D="boolean":w.type==="float"&&(D="number"):R!==void 0&&(typeof R=="boolean"||typeof R=="number")?D=typeof R:Array.isArray(R)?D="array":D="string",I=g[D],I||y("Unknown property type for component `"+S+"`: "+D),B=!!w.parse,w.parse=w.parse||I.parse,w.stringify=w.stringify||I.stringify,w.equals=w.equals||I.equals,w.isCacheable=w.isCacheable===!0||I.isCacheable,w.type=D,"default"in w?!B&&!m(D,R)&&y("Default value `"+R+"` does not match type `"+D+"` in component `"+S+"`"):w.default=I.default,w}l.exports.processPropertyDefinition=v,l.exports.parseProperties=function(){var w=[];return function(S,R,B,I,D){var L,O,U,Z;w.length=0;for(O in B?S:R)B&&S[O]===void 0||w.push(O);if(S===null||typeof S!="object")return S;for(O in S)S[O]!==void 0&&!R[O]&&!D&&y("Unknown property `"+O+"` for component/system `"+I+"`.");for(L=0;L<w.length;L++){if(O=w[L],U=R[O],Z=S[O],!R[O])return;S[O]=_(Z,U)}return S}}();function _(w,S,R){return(w==null||w==="")&&(w=S.default,Array.isArray(w)&&(w=w.slice())),S.parse(w,S.default,R)}l.exports.parseProperty=_,l.exports.stringifyProperties=function(w,S){var R,B,I,D={},L;for(R in w)B=S[R],I=w[R],L=I,typeof L=="object"&&(L=T(I,B),B||y("Unknown component property: "+R)),D[R]=L;return D};function T(w,S){return typeof w!="object"?w:!S||w===null?JSON.stringify(w):S.stringify(w)}l.exports.stringifyProperty=T},"./src/core/shader.js":(l,u,c)=>{var h=c("./src/core/schema.js"),p=h.process,f=l.exports.shaders={},m=l.exports.shaderNames=[],g=c("./src/lib/three.js"),y=c("./src/utils/index.js"),x={array:"v3",color:"v3",int:"i",number:"f",map:"t",time:"f",vec2:"v2",vec3:"v3",vec4:"v4"},v=l.exports.Shader=function(){};v.prototype={schema:{},vertexShader:"void main() {gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);}",fragmentShader:"void main() {gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);}",init:function(_){return this.uniforms=this.initUniforms(),this.material=new(this.raw?g.RawShaderMaterial:g.ShaderMaterial)({uniforms:this.uniforms,glslVersion:this.raw||this.glsl3?g.GLSL3:null,vertexShader:this.vertexShader,fragmentShader:this.fragmentShader}),this.material},initUniforms:function(){var _,T=this.schema,w={},S;for(_ in T)T[_].is==="uniform"&&(S=x[T[_].type],w[_]={type:S,value:void 0});return w},update:function(_){var T,w,S=this.schema,R=this.uniforms;for(T in _)if(!(!S[T]||S[T].is!=="uniform")){if(S[T].type==="map"){if(!R[T]||R[T].value===_[T])continue;w="_texture_"+T,this.setMapOnTextureLoad(R,T,w),y.material.updateMapMaterialFromData(w,T,this,_);continue}R[T].value=this.parseValue(S[T].type,_[T]),R[T].needsUpdate=!0}},parseValue:function(_,T){var w;switch(_){case"vec2":return new g.Vector2(T.x,T.y);case"vec3":return new g.Vector3(T.x,T.y,T.z);case"vec4":return new g.Vector4(T.x,T.y,T.z,T.w);case"color":return w=new g.Color(T),new g.Vector3(w.r,w.g,w.b);default:return T}},setMapOnTextureLoad:function(_,T,w){var S=this;this.el.addEventListener("materialtextureloaded",function(){_[T].value=S.material[w],_[T].needsUpdate=!0})}},l.exports.registerShader=function(_,T){var w,S={};if(Object.keys(T).forEach(function(R){S[R]={value:T[R],writable:!0}}),f[_])throw new Error("The shader "+_+" has already been registered");return w=function(){v.call(this)},w.prototype=Object.create(v.prototype,S),w.prototype.name=_,w.prototype.constructor=w,f[_]={Shader:w,schema:p(w.prototype.schema)},m.push(_),w}},"./src/core/system.js":(l,u,c)=>{var h=c("./src/core/component.js"),p=c("./src/core/schema.js"),f=c("./src/utils/index.js"),m=c("./src/core/readyState.js"),g=p.parseProperties,y=p.parseProperty,x=p.process,v=p.isSingleProperty,_=f.styleParser,T=l.exports.systems={},w=l.exports.System=function(S){var R=h&&h.components[this.name];this.el=S,this.sceneEl=S,R&&(R.Component.prototype.system=this),this.buildData(),this.init(),this.update({})};w.prototype={schema:{},init:function(){},update:function(S){},updateProperties:function(S){var R=this.data;Object.keys(p).length&&(this.buildData(S),this.update(R))},buildData:function(S){var R=this.schema;Object.keys(R).length&&(S=S||window.HTMLElement.prototype.getAttribute.call(this.sceneEl,this.name),v(R)?this.data=y(S,R):this.data=g(_.parse(S)||{},R,!1,this.name))},tick:void 0,tock:void 0,play:function(){},pause:function(){}},l.exports.registerSystem=function(S,R){var B,I,D={},L=f.findAllScenes(document);if(Object.keys(R).forEach(function(O){D[O]={value:R[O],writable:!0}}),T[S])throw new Error("The system `"+S+"` has been already registered. Check that you are not loading two versions of the same system or two different systems of the same name.");if(I=function(O){w.call(this,O)},I.prototype=Object.create(w.prototype,D),I.prototype.name=S,I.prototype.constructor=I,I.prototype.schema=f.extend(x(I.prototype.schema)),T[S]=I,m.canInitializeElements)for(B=0;B<L.length;B++)L[B].initSystem(S)}},"./src/extras/components/index.js":(l,u,c)=>{c("./src/extras/components/pivot.js")},"./src/extras/components/pivot.js":(l,u,c)=>{var h=c("./src/core/component.js").registerComponent,p=c("./src/lib/three.js"),f=new p.Vector3,m=new p.Vector3;h("pivot",{dependencies:["position"],schema:{type:"vec3"},init:function(){var g=this.data,y=this.el,x=y.object3D.parent,v=y.object3D,_=new p.Group;f.copy(v.position),m.copy(v.rotation),x.remove(v),_.add(v),x.add(_),y.object3D=_,v.position.set(-1*g.x,-1*g.y,-1*g.z),_.position.set(g.x+f.x,g.y+f.y,g.z+f.z),_.rotation.copy(v.rotation),v.rotation.set(0,0,0)}})},"./src/extras/primitives/getMeshMixin.js":(l,u,c)=>{var h=c("./src/core/component.js").components,p=c("./src/core/shader.js").shaders,f=c("./src/utils/index.js"),m={};Object.keys(h.material.schema).forEach(g),Object.keys(p.standard.schema).forEach(g);function g(y){var x=y.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();y==="fog"&&(x="material-fog"),y==="visible"&&(x="material-visible"),m[x]="material."+y}l.exports=function(){return{defaultComponents:{material:{}},mappings:f.extend({},m)}}},"./src/extras/primitives/index.js":(l,u,c)=>{c("./src/extras/primitives/primitives/a-camera.js"),c("./src/extras/primitives/primitives/a-cursor.js"),c("./src/extras/primitives/primitives/a-curvedimage.js"),c("./src/extras/primitives/primitives/a-gltf-model.js"),c("./src/extras/primitives/primitives/a-image.js"),c("./src/extras/primitives/primitives/a-light.js"),c("./src/extras/primitives/primitives/a-link.js"),c("./src/extras/primitives/primitives/a-obj-model.js"),c("./src/extras/primitives/primitives/a-sky.js"),c("./src/extras/primitives/primitives/a-sound.js"),c("./src/extras/primitives/primitives/a-text.js"),c("./src/extras/primitives/primitives/a-video.js"),c("./src/extras/primitives/primitives/a-videosphere.js"),c("./src/extras/primitives/primitives/meshPrimitives.js")},"./src/extras/primitives/primitives.js":(l,u,c)=>{var h=c("./src/core/a-node.js").knownTags,p=c("./src/core/a-entity.js").AEntity,f=c("./src/core/component.js").components,m=c("./src/utils/index.js"),g=m.debug,y=m.entity.setComponentProperty,x=g("extras:primitives:debug"),v=g("extras:primitives:warn"),_=g("extras:primitives:error"),T=l.exports.primitives={};l.exports.registerPrimitive=function(B,I){if(B=B.toLowerCase(),h[B]){_("Trying to register primitive "+B+" that has been already previously registered");return}h[B]=!0,x("Registering <%s>",B),I.defaultAttributes&&v("The 'defaultAttributes' object is deprecated. Use 'defaultComponents' instead.");var D=I.mappings||{},L=class extends p{constructor(){super(),this.defaultComponentsFromPrimitive=I.defaultComponents||I.defaultAttributes||{},this.deprecated=I.deprecated||null,this.deprecatedMappings=I.deprecatedMappings||{},this.mappings=D,I.deprecated&&console.warn(I.deprecated),this.resolveMappingCollisions()}resolveMappingCollisions(){var O=this.mappings,U=this;Object.keys(O).forEach(function(Z){var G;Z!==Z.toLowerCase()&&v("Mapping keys should be specified in lower case. The mapping key "+Z+" may not be recognized"),f[Z]&&(G=O[Z].replace(".","-"),O[G]=O[Z],delete O[Z],console.warn("The primitive "+U.tagName.toLowerCase()+" has a mapping collision. The attribute "+Z+" has the same name as a registered component and has been renamed to "+G))})}getExtraComponents(){var O,U,Z,G,z,$=this;for(U=m.clone(this.defaultComponentsFromPrimitive),z=this.getAttribute("mixin"),z&&(z=m.split(z.trim(),/\s+/),z.forEach(function(Y){var ae=document.getElementById(Y);if(ae){var xe=ae.rawAttributeCache,fe=ae.componentCache;for(var de in xe){if(G=$.mappings[de],G){w(G,xe[de],U);return}de in fe&&(U[de]=Q(U[de],fe[de]))}}})),Z=0;Z<this.attributes.length;Z++)O=this.attributes[Z],G=this.mappings[O.name],G&&w(G,O.value,U);return U;function Q(Y,ae){return H(Y)?V(ae):H(ae)?V(Y):ne(Y)&&ne(ae)?m.extendDeep(Y,ae):V(ae)}function H(Y){return typeof Y>"u"}function V(Y){return ne(Y)?m.extendDeep({},Y):Y}function ne(Y){return Y!==null&&Y.constructor===Object}}attributeChangedCallback(O,U,Z){var G=this.mappings[O];if(O in this.deprecatedMappings&&console.warn(this.deprecatedMappings[O]),!O||!G){super.attributeChangedCallback(O,U,Z);return}y(this,G,Z)}};return customElements.define(B,L),L.mappings=D,T[B]=L,L};function w(B,I,D){var L=m.entity.getComponentPropertyPath(B);L.constructor===Array?(D[L[0]]=D[L[0]]||{},D[L[0]][L[1]]=I.trim()):D[L]=I.trim()}function S(B,I){var D=f[B].schema;Object.keys(D).map(function(L){var O=L.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();I[O]!==void 0&&(O=B+"-"+L),I[O]=B+"."+L})}function R(B,I,D){D=D||{},Object.keys(I).map(function(L){S(L,D)}),l.exports.registerPrimitive(B,m.extendDeep({},null,{defaultComponents:I,mappings:D}))}l.exports.definePrimitive=R},"./src/extras/primitives/primitives/a-camera.js":(l,u,c)=>{var h=c("./src/extras/primitives/primitives.js").registerPrimitive;h("a-camera",{defaultComponents:{camera:{},"look-controls":{},"wasd-controls":{},position:{x:0,y:1.6,z:0}},mappings:{active:"camera.active",far:"camera.far",fov:"camera.fov","look-controls-enabled":"look-controls.enabled",near:"camera.near","pointer-lock-enabled":"look-controls.pointerLockEnabled","wasd-controls-enabled":"wasd-controls.enabled","reverse-mouse-drag":"look-controls.reverseMouseDrag",zoom:"camera.zoom"}})},"./src/extras/primitives/primitives/a-cursor.js":(l,u,c)=>{var h=c("./src/extras/primitives/getMeshMixin.js"),p=c("./src/extras/primitives/primitives.js").registerPrimitive,f=c("./src/utils/index.js");p("a-cursor",f.extendDeep({},h(),{defaultComponents:{cursor:{},geometry:{primitive:"ring",radiusOuter:.016,radiusInner:.01,segmentsTheta:32},material:{color:"#000",shader:"flat",opacity:.8},position:{x:0,y:0,z:-1}},mappings:{far:"raycaster.far",fuse:"cursor.fuse","fuse-timeout":"cursor.fuseTimeout",interval:"raycaster.interval",objects:"raycaster.objects"}}))},"./src/extras/primitives/primitives/a-curvedimage.js":(l,u,c)=>{var h=c("./src/extras/primitives/getMeshMixin.js"),p=c("./src/extras/primitives/primitives.js").registerPrimitive,f=c("./src/utils/index.js");p("a-curvedimage",f.extendDeep({},h(),{defaultComponents:{geometry:{height:1,primitive:"cylinder",radius:2,segmentsRadial:48,thetaLength:270,openEnded:!0,thetaStart:0},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0,repeat:"-1 1"}},mappings:{height:"geometry.height","open-ended":"geometry.openEnded",radius:"geometry.radius",segments:"geometry.segmentsRadial",start:"geometry.thetaStart","theta-length":"geometry.thetaLength","theta-start":"geometry.thetaStart",width:"geometry.thetaLength"}}))},"./src/extras/primitives/primitives/a-gltf-model.js":(l,u,c)=>{var h=c("./src/extras/primitives/primitives.js").registerPrimitive;h("a-gltf-model",{mappings:{src:"gltf-model"}})},"./src/extras/primitives/primitives/a-image.js":(l,u,c)=>{var h=c("./src/extras/primitives/getMeshMixin.js"),p=c("./src/extras/primitives/primitives.js").registerPrimitive,f=c("./src/utils/index.js");p("a-image",f.extendDeep({},h(),{defaultComponents:{geometry:{primitive:"plane"},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0}},mappings:{height:"geometry.height",width:"geometry.width"}}))},"./src/extras/primitives/primitives/a-light.js":(l,u,c)=>{var h=c("./src/extras/primitives/primitives.js").registerPrimitive;h("a-light",{defaultComponents:{light:{}},mappings:{angle:"light.angle",color:"light.color","ground-color":"light.groundColor",decay:"light.decay",distance:"light.distance",intensity:"light.intensity",penumbra:"light.penumbra",type:"light.type",target:"light.target",envmap:"light.envMap","shadow-camera-automatic":"light.shadowCameraAutomatic"}})},"./src/extras/primitives/primitives/a-link.js":(l,u,c)=>{var h=c("./src/extras/primitives/primitives.js").registerPrimitive;h("a-link",{defaultComponents:{link:{visualAspectEnabled:!0}},mappings:{href:"link.href",image:"link.image",title:"link.title"}})},"./src/extras/primitives/primitives/a-obj-model.js":(l,u,c)=>{var h=c("./src/extras/primitives/getMeshMixin.js")(),p=c("./src/extras/primitives/primitives.js").registerPrimitive,f=c("./src/utils/index.js");p("a-obj-model",f.extendDeep({},h,{defaultComponents:{"obj-model":{}},mappings:{src:"obj-model.obj",mtl:"obj-model.mtl"}}))},"./src/extras/primitives/primitives/a-sky.js":(l,u,c)=>{var h=c("./src/extras/primitives/getMeshMixin.js"),p=c("./src/extras/primitives/primitives.js").registerPrimitive,f=c("./src/utils/index.js"),m=c("./src/extras/primitives/primitives/meshPrimitives.js");p("a-sky",f.extendDeep({},h(),{defaultComponents:{geometry:{primitive:"sphere",radius:500,segmentsWidth:64,segmentsHeight:32},material:{color:"#FFF",side:"back",shader:"flat",npot:!0},scale:"-1 1 1"},mappings:f.extendDeep({},m["a-sphere"].mappings)}))},"./src/extras/primitives/primitives/a-sound.js":(l,u,c)=>{var h=c("./src/extras/primitives/primitives.js").registerPrimitive;h("a-sound",{defaultComponents:{sound:{}},mappings:{src:"sound.src",on:"sound.on",autoplay:"sound.autoplay",loop:"sound.loop",volume:"sound.volume"}})},"./src/extras/primitives/primitives/a-text.js":(l,u,c)=>{var h=c("./src/extras/primitives/primitives.js").definePrimitive;h("a-text",{text:{anchor:"align",width:5}})},"./src/extras/primitives/primitives/a-video.js":(l,u,c)=>{var h=c("./src/extras/primitives/getMeshMixin.js"),p=c("./src/extras/primitives/primitives.js").registerPrimitive,f=c("./src/utils/index.js");p("a-video",f.extendDeep({},h(),{defaultComponents:{geometry:{primitive:"plane"},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0}},mappings:{height:"geometry.height",width:"geometry.width"}}))},"./src/extras/primitives/primitives/a-videosphere.js":(l,u,c)=>{var h=c("./src/extras/primitives/getMeshMixin.js"),p=c("./src/extras/primitives/primitives.js").registerPrimitive,f=c("./src/utils/index.js");p("a-videosphere",f.extendDeep({},h(),{defaultComponents:{geometry:{primitive:"sphere",radius:500,segmentsWidth:64,segmentsHeight:32},material:{color:"#FFF",shader:"flat",side:"back",npot:!0},scale:"-1 1 1"},mappings:{radius:"geometry.radius","segments-height":"geometry.segmentsHeight","segments-width":"geometry.segmentsWidth"}}))},"./src/extras/primitives/primitives/meshPrimitives.js":(l,u,c)=>{var h=c("./src/extras/primitives/getMeshMixin.js"),p=c("./src/core/geometry.js").geometries,f=c("./src/core/geometry.js").geometryNames,m=c("./src/extras/primitives/primitives.js").registerPrimitive,g=c("./src/utils/index.js"),y=l.exports={};f.forEach(function(v){var _=p[v],T=x(v),w={};Object.keys(_.schema).forEach(function(B){w[x(B)]="geometry."+B});var S="a-"+T,R=m(S,g.extendDeep({},h(),{defaultComponents:{geometry:{primitive:v}},mappings:w}));y[S]=R});function x(v){return v.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}},"./src/geometries/box.js":(l,u,c)=>{var h=c("./src/core/geometry.js").registerGeometry,p=c("./src/lib/three.js");h("box",{schema:{depth:{default:1,min:0},height:{default:1,min:0},width:{default:1,min:0},segmentsHeight:{default:1,min:1,max:20,type:"int"},segmentsWidth:{default:1,min:1,max:20,type:"int"},segmentsDepth:{default:1,min:1,max:20,type:"int"}},init:function(f){this.geometry=new p.BoxGeometry(f.width,f.height,f.depth,f.segmentsWidth,f.segmentsHeight,f.segmentsDepth)}})},"./src/geometries/circle.js":(l,u,c)=>{var h=c("./src/core/geometry.js").registerGeometry,p=c("./src/lib/three.js"),f=p.MathUtils.degToRad;h("circle",{schema:{radius:{default:1,min:0},segments:{default:32,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(m){this.geometry=new p.CircleGeometry(m.radius,m.segments,f(m.thetaStart),f(m.thetaLength))}})},"./src/geometries/cone.js":(l,u,c)=>{var h=c("./src/core/geometry.js").registerGeometry,p=c("./src/lib/three.js"),f=p.MathUtils.degToRad;h("cone",{schema:{height:{default:1,min:0},openEnded:{default:!1},radiusBottom:{default:1,min:0},radiusTop:{default:.01,min:0},segmentsHeight:{default:18,min:1,type:"int"},segmentsRadial:{default:36,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(m){this.geometry=new p.CylinderGeometry(m.radiusTop,m.radiusBottom,m.height,m.segmentsRadial,m.segmentsHeight,m.openEnded,f(m.thetaStart),f(m.thetaLength))}})},"./src/geometries/cylinder.js":(l,u,c)=>{var h=c("./src/core/geometry.js").registerGeometry,p=c("./src/lib/three.js"),f=p.MathUtils.degToRad;h("cylinder",{schema:{height:{default:1,min:0},openEnded:{default:!1},radius:{default:1,min:0},segmentsHeight:{default:18,min:1,type:"int"},segmentsRadial:{default:36,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(m){this.geometry=new p.CylinderGeometry(m.radius,m.radius,m.height,m.segmentsRadial,m.segmentsHeight,m.openEnded,f(m.thetaStart),f(m.thetaLength))}})},"./src/geometries/dodecahedron.js":(l,u,c)=>{var h=c("./src/core/geometry.js").registerGeometry,p=c("./src/lib/three.js");h("dodecahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(f){this.geometry=new p.DodecahedronGeometry(f.radius,f.detail)}})},"./src/geometries/icosahedron.js":(l,u,c)=>{var h=c("./src/core/geometry.js").registerGeometry,p=c("./src/lib/three.js");h("icosahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(f){this.geometry=new p.IcosahedronGeometry(f.radius,f.detail)}})},"./src/geometries/index.js":(l,u,c)=>{c("./src/geometries/box.js"),c("./src/geometries/circle.js"),c("./src/geometries/cone.js"),c("./src/geometries/cylinder.js"),c("./src/geometries/dodecahedron.js"),c("./src/geometries/icosahedron.js"),c("./src/geometries/octahedron.js"),c("./src/geometries/plane.js"),c("./src/geometries/ring.js"),c("./src/geometries/sphere.js"),c("./src/geometries/tetrahedron.js"),c("./src/geometries/torus.js"),c("./src/geometries/torusKnot.js"),c("./src/geometries/triangle.js")},"./src/geometries/octahedron.js":(l,u,c)=>{var h=c("./src/core/geometry.js").registerGeometry,p=c("./src/lib/three.js");h("octahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(f){this.geometry=new p.OctahedronGeometry(f.radius,f.detail)}})},"./src/geometries/plane.js":(l,u,c)=>{var h=c("./src/core/geometry.js").registerGeometry,p=c("./src/lib/three.js");h("plane",{schema:{height:{default:1,min:0},width:{default:1,min:0},segmentsHeight:{default:1,min:1,max:20,type:"int"},segmentsWidth:{default:1,min:1,max:20,type:"int"}},init:function(f){this.geometry=new p.PlaneGeometry(f.width,f.height,f.segmentsWidth,f.segmentsHeight)}})},"./src/geometries/ring.js":(l,u,c)=>{var h=c("./src/core/geometry.js").registerGeometry,p=c("./src/lib/three.js"),f=p.MathUtils.degToRad;h("ring",{schema:{radiusInner:{default:.8,min:0},radiusOuter:{default:1.2,min:0},segmentsPhi:{default:10,min:1,type:"int"},segmentsTheta:{default:32,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(m){this.geometry=new p.RingGeometry(m.radiusInner,m.radiusOuter,m.segmentsTheta,m.segmentsPhi,f(m.thetaStart),f(m.thetaLength))}})},"./src/geometries/sphere.js":(l,u,c)=>{var h=c("./src/core/geometry.js").registerGeometry,p=c("./src/lib/three.js"),f=p.MathUtils.degToRad;h("sphere",{schema:{radius:{default:1,min:0},phiLength:{default:360},phiStart:{default:0,min:0},thetaLength:{default:180,min:0},thetaStart:{default:0},segmentsHeight:{default:18,min:2,type:"int"},segmentsWidth:{default:36,min:3,type:"int"}},init:function(m){this.geometry=new p.SphereGeometry(m.radius,m.segmentsWidth,m.segmentsHeight,f(m.phiStart),f(m.phiLength),f(m.thetaStart),f(m.thetaLength))}})},"./src/geometries/tetrahedron.js":(l,u,c)=>{var h=c("./src/core/geometry.js").registerGeometry,p=c("./src/lib/three.js");h("tetrahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(f){this.geometry=new p.TetrahedronGeometry(f.radius,f.detail)}})},"./src/geometries/torus.js":(l,u,c)=>{var h=c("./src/core/geometry.js").registerGeometry,p=c("./src/lib/three.js"),f=p.MathUtils.degToRad;h("torus",{schema:{arc:{default:360},radius:{default:1,min:0},radiusTubular:{default:.2,min:0},segmentsRadial:{default:36,min:2,type:"int"},segmentsTubular:{default:32,min:3,type:"int"}},init:function(m){this.geometry=new p.TorusGeometry(m.radius,m.radiusTubular*2,m.segmentsRadial,m.segmentsTubular,f(m.arc))}})},"./src/geometries/torusKnot.js":(l,u,c)=>{var h=c("./src/core/geometry.js").registerGeometry,p=c("./src/lib/three.js");h("torusKnot",{schema:{p:{default:2,min:1},q:{default:3,min:1},radius:{default:1,min:0},radiusTubular:{default:.2,min:0},segmentsRadial:{default:8,min:3,type:"int"},segmentsTubular:{default:100,min:3,type:"int"}},init:function(f){this.geometry=new p.TorusKnotGeometry(f.radius,f.radiusTubular*2,f.segmentsTubular,f.segmentsRadial,f.p,f.q)}})},"./src/geometries/triangle.js":(l,u,c)=>{var h=c("./src/core/geometry.js").registerGeometry,p=c("./src/lib/three.js"),f=new p.Quaternion,m=new p.Vector3(0,0,1),g=new p.Vector2,y=new p.Vector2,x=new p.Vector2;h("triangle",{schema:{vertexA:{type:"vec3",default:{x:0,y:.5,z:0}},vertexB:{type:"vec3",default:{x:-.5,y:-.5,z:0}},vertexC:{type:"vec3",default:{x:.5,y:-.5,z:0}}},init:function(v){var _,T,w,S,R,B,I,D,L;w=new p.Triangle,w.a.set(v.vertexA.x,v.vertexA.y,v.vertexA.z),w.b.set(v.vertexB.x,v.vertexB.y,v.vertexB.z),w.c.set(v.vertexC.x,v.vertexC.y,v.vertexC.z),T=w.getNormal(new p.Vector3),f.setFromUnitVectors(T,m),S=w.a.clone().applyQuaternion(f),R=w.b.clone().applyQuaternion(f),B=w.c.clone().applyQuaternion(f),g.set(Math.min(S.x,R.x,B.x),Math.min(S.y,R.y,B.y)),y.set(Math.max(S.x,R.x,B.x),Math.max(S.y,R.y,B.y)),x.set(0,0).subVectors(y,g),S=new p.Vector2().subVectors(S,g).divide(x),R=new p.Vector2().subVectors(R,g).divide(x),B=new p.Vector2().subVectors(B,g).divide(x),_=this.geometry=new p.BufferGeometry,I=[w.a.x,w.a.y,w.a.z,w.b.x,w.b.y,w.b.z,w.c.x,w.c.y,w.c.z],D=[T.x,T.y,T.z,T.x,T.y,T.z,T.x,T.y,T.z],L=[S.x,S.y,R.x,R.y,B.x,B.y],_.setAttribute("position",new p.Float32BufferAttribute(I,3)),_.setAttribute("normal",new p.Float32BufferAttribute(D,3)),_.setAttribute("uv",new p.Float32BufferAttribute(L,2))}})},"./src/index.js":(l,u,c)=>{if(window.hasNativeWebVRImplementation=!!window.navigator.getVRDisplays||!!window.navigator.getVRDevices,window.hasNativeWebXRImplementation=navigator.xr!==void 0,!window.hasNativeWebXRImplementation&&!window.hasNativeWebVRImplementation){var h=c("./src/utils/isIOSOlderThan10.js"),p=h(window.navigator.userAgent)?1/window.devicePixelRatio:1,f=c("./node_modules/webvr-polyfill/build/webvr-polyfill.js"),m={BUFFER_SCALE:p,CARDBOARD_UI_DISABLED:!0,ROTATE_INSTRUCTIONS_DISABLED:!0,MOBILE_WAKE_LOCK:!!window.cordova};window.webvrpolyfill=new f(m)}var g=c("./src/utils/index.js"),y=g.debug,x=y("A-Frame:error"),v=y("A-Frame:warn");window.document.currentScript&&window.document.currentScript.parentNode!==window.document.head&&!window.debug&&v("Put the A-Frame <script> tag in the <head> of the HTML *before* the scene to ensure everything for A-Frame is properly registered before they are used from HTML."),!window.cordova&&window.location.protocol==="file:"&&x("This HTML file is currently being served via the file:// protocol. Assets, textures, and models WILL NOT WORK due to cross-origin policy! Please use a local or hosted server: https://aframe.io/docs/1.4.0/introduction/installation.html#use-a-local-server."),g.device.isBrowserEnvironment&&(c("./src/style/aframe.css"),c("./src/style/rStats.css"));var _=c("./src/core/scene/a-scene.js").AScene,T=c("./src/core/component.js").components,w=c("./src/core/component.js").registerComponent,S=c("./src/core/geometry.js").registerGeometry,R=c("./src/extras/primitives/primitives.js").registerPrimitive,B=c("./src/core/shader.js").registerShader,I=c("./src/core/system.js").registerSystem,D=c("./src/core/shader.js").shaders,L=c("./src/core/system.js").systems,O=window.THREE=c("./src/lib/three.js"),U=c("./src/core/readyState.js"),Z=c("./package.json");c("./src/components/index.js"),c("./src/geometries/index.js"),c("./src/shaders/index.js"),c("./src/systems/index.js");var G=c("./src/core/a-node.js").ANode,z=c("./src/core/a-entity.js").AEntity;c("./src/core/a-assets.js"),c("./src/core/a-cubemap.js"),c("./src/core/a-mixin.js"),c("./src/extras/components/index.js"),c("./src/extras/primitives/index.js"),console.log("A-Frame Version: 1.6.0 (Date 2024-05-23, Commit #e6c47761)"),console.log("THREE Version (https://github.com/supermedium/three.js):",O.REVISION),console.log("WebVR Polyfill Version:",Z.dependencies["webvr-polyfill"]),window.AFRAME_ASYNC||U.waitForDocumentReadyState(),l.exports=window.AFRAME={AComponent:c("./src/core/component.js").Component,AEntity:z,ANode:G,ANIME:c("./node_modules/super-animejs/lib/anime.es.js").default,AScene:_,components:T,coreComponents:Object.keys(T),geometries:c("./src/core/geometry.js").geometries,registerComponent:w,registerGeometry:S,registerPrimitive:R,registerShader:B,registerSystem:I,primitives:{getMeshMixin:c("./src/extras/primitives/getMeshMixin.js"),primitives:c("./src/extras/primitives/primitives.js").primitives},scenes:c("./src/core/scene/scenes.js"),schema:c("./src/core/schema.js"),shaders:D,systems:L,emitReady:U.emitReady,THREE:O,utils:g,version:Z.version}},"./src/lib/rStatsAframe.js":l=>{window.aframeStats=function(u){var c=null,h=u,p={te:{caption:"Entities"},lt:{caption:"Load Time"}},f=[{caption:"A-Frame",values:["te","lt"]}];function m(){c("te").set(g()),window.performance.getEntriesByName&&c("lt").set(window.performance.getEntriesByName("render-started")[0].startTime.toFixed(0))}function g(){var _=h.querySelectorAll("*");return Array.prototype.slice.call(_).filter(function(T){return T.isEntity}),_.length}function y(){}function x(){}function v(_){c=_}return{update:m,start:y,end:x,attach:v,values:p,groups:f,fractions:[]}},l.exports={aframeStats:window.aframeStats}},"./src/lib/three.js":(l,u,c)=>{var h=c("./src/lib/three.mjs").default;c.g.THREE=h,c("./vendor/DeviceOrientationControls.js"),h.Cache&&(h.Cache.enabled=!0),l.exports=h},"./src/shaders/flat.js":(l,u,c)=>{var h=c("./src/core/shader.js").registerShader,p=c("./src/lib/three.js"),f=c("./src/utils/index.js");l.exports.Shader=h("flat",{schema:{color:{type:"color"},fog:{default:!0},height:{default:256},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},src:{type:"map"},width:{default:512},wireframe:{default:!1},wireframeLinewidth:{default:2},toneMapped:{default:!0}},init:function(g){this.materialData={color:new p.Color},m(g,this.materialData),this.material=new p.MeshBasicMaterial(this.materialData)},update:function(g){this.updateMaterial(g),f.material.updateMap(this,g)},updateMaterial:function(g){var y;m(g,this.materialData);for(y in this.materialData)this.material[y]=this.materialData[y]}});function m(g,y){return y.color.set(g.color),y.fog=g.fog,y.wireframe=g.wireframe,y.toneMapped=g.toneMapped,y.wireframeLinewidth=g.wireframeLinewidth,y}},"./src/shaders/index.js":(l,u,c)=>{c("./src/shaders/flat.js"),c("./src/shaders/standard.js"),c("./src/shaders/phong.js"),c("./src/shaders/sdf.js"),c("./src/shaders/msdf.js"),c("./src/shaders/shadow.js")},"./src/shaders/msdf.js":(l,u,c)=>{var h=c("./src/core/shader.js").registerShader,p=c("./src/lib/three.js"),f=["#include <common>","#include <fog_pars_vertex>","#include <logdepthbuf_pars_vertex>","out vec2 vUV;","void main(void) {","  vUV = uv;","  #include <begin_vertex>","  #include <project_vertex>","  #include <logdepthbuf_vertex>","  #include <fog_vertex>","}"].join(`
`),m=["#include <common>","#include <fog_pars_fragment>","#include <logdepthbuf_pars_fragment>","uniform bool negate;","uniform float alphaTest;","uniform float opacity;","uniform sampler2D map;","uniform vec3 color;","in vec2 vUV;","float median(float r, float g, float b) {","  return max(min(r, g), min(max(r, g), b));","}","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","void main() {","  vec3 sampleColor = texture(map, vUV).rgb;","  if (negate) { sampleColor = 1.0 - sampleColor; }","  float sigDist = median(sampleColor.r, sampleColor.g, sampleColor.b) - 0.5;","  float alpha = clamp(sigDist / fwidth(sigDist) + 0.5, 0.0, 1.0);","  float dscale = 0.353505;","  vec2 duv = dscale * (dFdx(vUV) + dFdy(vUV));","  float isBigEnough = max(abs(duv.x), abs(duv.y));","  // Do modified alpha test.","  if (isBigEnough > BIG_ENOUGH) {","    float ratio = BIG_ENOUGH / isBigEnough;","    alpha = ratio * alpha + (1.0 - ratio) * (sigDist + 0.5);","  }","  // Do modified alpha test.","  if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  gl_FragColor = vec4(color.xyz, alpha * opacity);","  #include <logdepthbuf_fragment>","  #include <tonemapping_fragment>","  #include <colorspace_fragment>","  #include <fog_fragment>","}"].join(`
`);l.exports.Shader=h("msdf",{schema:{alphaTest:{type:"number",is:"uniform",default:.5},color:{type:"color",is:"uniform",default:"white"},map:{type:"map",is:"uniform"},negate:{type:"boolean",is:"uniform",default:!0},opacity:{type:"number",is:"uniform",default:1}},vertexShader:f,fragmentShader:m,init:function(){return this.uniforms=p.UniformsUtils.merge([p.UniformsLib.fog,this.initUniforms()]),this.material=new p.ShaderMaterial({uniforms:this.uniforms,vertexShader:this.vertexShader,fragmentShader:this.fragmentShader,fog:!0}),this.material}})},"./src/shaders/phong.js":(l,u,c)=>{var h=c("./src/core/shader.js").registerShader,p=c("./src/lib/three.js"),f=c("./src/utils/index.js");l.exports.Shader=h("phong",{schema:{color:{type:"color"},emissive:{type:"color",default:"black"},emissiveIntensity:{default:1},specular:{type:"color",default:"#111111"},transparent:{default:!1},fog:{default:!0},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},src:{type:"map"},envMap:{default:""},sphericalEnvMap:{type:"map"},shininess:{default:30},flatShading:{default:!1},wireframe:{default:!1},wireframeLinewidth:{default:2},combine:{oneOF:["multiply","mix","add"],default:"mix"},reflectivity:{default:.9},refractionRatio:{default:.98},refract:{default:!1},normalMap:{type:"map"},normalScale:{type:"vec2",default:{x:1,y:1}},normalTextureOffset:{type:"vec2"},normalTextureRepeat:{type:"vec2",default:{x:1,y:1}},ambientOcclusionMap:{type:"map"},ambientOcclusionMapIntensity:{default:1},displacementMap:{type:"map"},displacementScale:{default:1},displacementBias:{default:.5},displacementTextureOffset:{type:"vec2"},displacementTextureRepeat:{type:"vec2",default:{x:1,y:1}},bumpMap:{type:"map"},bumpMapScale:{default:1},bumpTextureOffset:{type:"vec2"},bumpTextureRepeat:{type:"vec2",default:{x:1,y:1}}},init:function(g){this.materialData={color:new p.Color,specular:new p.Color,emissive:new p.Color},m(g,this.materialData),this.material=new p.MeshPhongMaterial(this.materialData);var y=this.el.sceneEl;Object.defineProperty(this.material,"envMap",{get:function(){return this._envMap||y.object3D.environment},set:function(x){this._envMap=x}})},update:function(g){this.updateMaterial(g),f.material.updateMap(this,g),f.material.updateDistortionMap("normal",this,g),f.material.updateDistortionMap("displacement",this,g),f.material.updateDistortionMap("ambientOcclusion",this,g),f.material.updateDistortionMap("bump",this,g),f.material.updateEnvMap(this,g)},updateMaterial:function(g){var y;m(g,this.materialData);for(y in this.materialData)this.material[y]=this.materialData[y]}});function m(g,y){switch(y.color.set(g.color),y.specular.set(g.specular),y.emissive.set(g.emissive),y.emissiveIntensity=g.emissiveIntensity,y.fog=g.fog,y.transparent=g.transparent,y.wireframe=g.wireframe,y.wireframeLinewidth=g.wireframeLinewidth,y.shininess=g.shininess,y.flatShading=g.flatShading,y.wireframe=g.wireframe,y.wireframeLinewidth=g.wireframeLinewidth,y.reflectivity=g.reflectivity,y.refractionRatio=g.refractionRatio,g.combine){case"mix":y.combine=p.MixOperation;break;case"multiply":y.combine=p.MultiplyOperation;break;case"add":y.combine=p.AddOperation;break}return g.normalMap&&(y.normalScale=g.normalScale),g.ambientOcclusionMap&&(y.aoMapIntensity=g.ambientOcclusionMapIntensity),g.bumpMap&&(y.bumpScale=g.bumpMapScale),g.displacementMap&&(y.displacementScale=g.displacementScale,y.displacementBias=g.displacementBias),y}},"./src/shaders/sdf.js":(l,u,c)=>{var h=c("./src/core/shader.js").registerShader,p=c("./src/lib/three.js"),f=["#include <common>","#include <fog_pars_vertex>","#include <logdepthbuf_pars_vertex>","out vec2 vUV;","void main(void) {","  vUV = uv;","  #include <begin_vertex>","  #include <project_vertex>","  #include <logdepthbuf_vertex>","  #include <fog_vertex>","}"].join(`
`),m=["#include <common>","#include <fog_pars_fragment>","#include <logdepthbuf_pars_fragment>","uniform float alphaTest;","uniform float opacity;","uniform sampler2D map;","uniform vec3 color;","in vec2 vUV;","float contour(float width, float value) {","  return smoothstep(0.5 - value, 0.5 + value, width);","}","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","void main() {","  vec2 uv = vUV;","  vec4 texColor = texture(map, uv);","  float dist = texColor.a;","  float width = fwidth(dist);","  float alpha = contour(dist, width);","  float dscale = 0.353505;","  vec2 duv = dscale * (dFdx(uv) + dFdy(uv));","  float isBigEnough = max(abs(duv.x), abs(duv.y));","  if (isBigEnough > BIG_ENOUGH) {","    float ratio = BIG_ENOUGH / isBigEnough;","    alpha = ratio * alpha + (1.0 - ratio) * dist;","  }","  if (isBigEnough <= BIG_ENOUGH) {","    vec4 box = vec4 (uv - duv, uv + duv);","    alpha = (alpha + 0.5 * (","      contour(texture(map, box.xy).a, width)","      + contour(texture(map, box.zw).a, width)","      + contour(texture(map, box.xw).a, width)","      + contour(texture(map, box.zy).a, width)","    )) / 3.0;","  }","  if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  gl_FragColor = vec4(color, opacity * alpha);","  #include <logdepthbuf_fragment>","  #include <tonemapping_fragment>","  #include <colorspace_fragment>","  #include <fog_fragment>","}"].join(`
`);l.exports.Shader=h("sdf",{schema:{alphaTest:{type:"number",is:"uniform",default:.5},color:{type:"color",is:"uniform",default:"white"},map:{type:"map",is:"uniform"},opacity:{type:"number",is:"uniform",default:1}},vertexShader:f,fragmentShader:m,init:function(){return this.uniforms=p.UniformsUtils.merge([p.UniformsLib.fog,this.initUniforms()]),this.material=new p.ShaderMaterial({uniforms:this.uniforms,vertexShader:this.vertexShader,fragmentShader:this.fragmentShader,fog:!0}),this.material}})},"./src/shaders/shadow.js":(l,u,c)=>{var h=c("./src/core/shader.js").registerShader,p=c("./src/lib/three.js");l.exports.Shader=h("shadow",{schema:{opacity:{default:.5},transparent:{default:!0},alphaToCoverage:{default:!0}},init:function(f){this.material=new p.ShadowMaterial},update:function(f){this.material.opacity=f.opacity,this.material.alphaToCoverage=f.alphaToCoverage,this.material.transparent=f.transparent}})},"./src/shaders/standard.js":(l,u,c)=>{var h=c("./src/core/shader.js").registerShader,p=c("./src/lib/three.js"),f=c("./src/utils/index.js");l.exports.Shader=h("standard",{schema:{ambientOcclusionMap:{type:"map"},ambientOcclusionMapIntensity:{default:1},ambientOcclusionTextureOffset:{type:"vec2"},ambientOcclusionTextureRepeat:{type:"vec2",default:{x:1,y:1}},color:{type:"color"},displacementMap:{type:"map"},displacementScale:{default:1},displacementBias:{default:.5},displacementTextureOffset:{type:"vec2"},displacementTextureRepeat:{type:"vec2",default:{x:1,y:1}},emissive:{type:"color",default:"#000"},emissiveIntensity:{default:1},envMap:{default:""},fog:{default:!0},height:{default:256},metalness:{default:0,min:0,max:1},metalnessMap:{type:"map"},metalnessTextureOffset:{type:"vec2"},metalnessTextureRepeat:{type:"vec2",default:{x:1,y:1}},normalMap:{type:"map"},normalScale:{type:"vec2",default:{x:1,y:1}},normalTextureOffset:{type:"vec2"},normalTextureRepeat:{type:"vec2",default:{x:1,y:1}},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},roughness:{default:.5,min:0,max:1},roughnessMap:{type:"map"},roughnessTextureOffset:{type:"vec2"},roughnessTextureRepeat:{type:"vec2",default:{x:1,y:1}},sphericalEnvMap:{type:"map"},src:{type:"map"},width:{default:512},wireframe:{default:!1},wireframeLinewidth:{default:2}},init:function(g){this.materialData={color:new p.Color,emissive:new p.Color},m(g,this.materialData),this.material=new p.MeshStandardMaterial(this.materialData)},update:function(g){this.updateMaterial(g),f.material.updateMap(this,g),f.material.updateDistortionMap("normal",this,g),f.material.updateDistortionMap("displacement",this,g),f.material.updateDistortionMap("ambientOcclusion",this,g),f.material.updateDistortionMap("metalness",this,g),f.material.updateDistortionMap("roughness",this,g),f.material.updateEnvMap(this,g)},updateMaterial:function(g){var y,x=this.material;m(g,this.materialData);for(y in this.materialData)x[y]=this.materialData[y]}});function m(g,y){return y.color.set(g.color),y.emissive.set(g.emissive),y.emissiveIntensity=g.emissiveIntensity,y.fog=g.fog,y.metalness=g.metalness,y.roughness=g.roughness,y.wireframe=g.wireframe,y.wireframeLinewidth=g.wireframeLinewidth,g.normalMap&&(y.normalScale=g.normalScale),g.ambientOcclusionMap&&(y.aoMapIntensity=g.ambientOcclusionMapIntensity),g.displacementMap&&(y.displacementScale=g.displacementScale,y.displacementBias=g.displacementBias),y}},"./src/systems/camera.js":(l,u,c)=>{var h=c("./src/constants/index.js"),p=c("./src/core/system.js").registerSystem,f="data-aframe-default-camera";l.exports.System=p("camera",{init:function(){this.activeCameraEl=null,this.render=this.render.bind(this),this.unwrapRender=this.unwrapRender.bind(this),this.wrapRender=this.wrapRender.bind(this),this.initialCameraFound=!1,this.numUserCameras=0,this.numUserCamerasChecked=0,this.setupInitialCamera()},setupInitialCamera:function(){var g,y,x=this.sceneEl,v=this;if(x.camera&&!x.camera.el.getAttribute("camera").spectator){x.emit("cameraready",{cameraEl:x.camera.el});return}if(g=x.querySelectorAll("a-camera, :not(a-mixin)[camera]"),!g.length){this.createDefaultCamera();return}for(this.numUserCameras=g.length,y=0;y<g.length;y++)g[y].addEventListener("object3dset",function(_){_.detail.type==="camera"&&v.checkUserCamera(this)}),g[y].isNode?g[y].load():g[y].addEventListener("nodeready",function(){this.load()})},checkUserCamera:function(g){var y,x=this.el.sceneEl;if(this.numUserCamerasChecked++,!this.initialCameraFound){if(y=g.getAttribute("camera"),!y.active||y.spectator){this.numUserCamerasChecked===this.numUserCameras&&this.createDefaultCamera();return}this.initialCameraFound=!0,x.camera=g.getObject3D("camera"),x.emit("cameraready",{cameraEl:g})}},createDefaultCamera:function(){var g,y=this.sceneEl;g=document.createElement("a-entity"),g.setAttribute("camera",{active:!0}),g.setAttribute("position",{x:0,y:h.DEFAULT_CAMERA_HEIGHT,z:0}),g.setAttribute("wasd-controls",""),g.setAttribute("look-controls",""),g.setAttribute(h.AFRAME_INJECTED,""),g.addEventListener("object3dset",function(x){x.detail.type==="camera"&&(y.camera=x.detail.object,y.emit("cameraready",{cameraEl:g}))}),y.appendChild(g)},disableActiveCamera:function(){var g,y;g=this.sceneEl.querySelectorAll(":not(a-mixin)[camera]"),y=g[g.length-1],y.setAttribute("camera","active",!0)},setActiveCamera:function(g){var y,x,v,_,T=this.activeCameraEl,w=this.sceneEl;if(_=g.getObject3D("camera"),!(!_||g===this.activeCameraEl)){var S=w.querySelector("["+f+"]"),R=S&&S.querySelector(":not(a-mixin)[camera]");for(g!==R&&m(w),this.activeCameraEl=g,this.activeCameraEl.play(),w.camera=_,T&&T.setAttribute("camera","active",!1),x=w.querySelectorAll(":not(a-mixin)[camera]"),v=0;v<x.length;v++)y=x[v],!(!y.isEntity||g===y)&&(y.setAttribute("camera","active",!1),y.pause());w.emit("camera-set-active",{cameraEl:g})}},setSpectatorCamera:function(g){var y,x=this.spectatorCameraEl,v=this.sceneEl,_;y=g.getObject3D("camera"),!(!y||g===this.spectatorCameraEl)&&(x&&x.setAttribute("camera","spectator",!1),_=this.spectatorCameraEl=g,v.addEventListener("enter-vr",this.wrapRender),v.addEventListener("exit-vr",this.unwrapRender),_.setAttribute("camera","active",!1),_.play(),v.emit("camera-set-spectator",{cameraEl:g}))},disableSpectatorCamera:function(){this.spectatorCameraEl=void 0},wrapRender:function(){!this.spectatorCameraEl||this.originalRender||(this.originalRender=this.sceneEl.renderer.render,this.sceneEl.renderer.render=this.render)},unwrapRender:function(){this.originalRender&&(this.sceneEl.renderer.render=this.originalRender,this.originalRender=void 0)},render:function(g,y){var x,v=this.sceneEl,_;x=v.renderer.xr.enabled,this.originalRender.call(v.renderer,g,y),!(!this.spectatorCameraEl||v.isMobile||!x)&&(_=this.spectatorCameraEl.components.camera.camera,v.renderer.xr.enabled=!1,this.originalRender.call(v.renderer,g,_),v.renderer.xr.enabled=x)}});function m(g){var y,x=g.camera;x&&(y=g.querySelector("["+f+"]"),y&&g.removeChild(y))}},"./src/systems/geometry.js":(l,u,c)=>{var h=c("./src/core/geometry.js").geometries,p=c("./src/core/system.js").registerSystem;l.exports.System=p("geometry",{init:function(){this.cache={},this.cacheCount={}},clearCache:function(){this.cache={},this.cacheCount={}},getOrCreateGeometry:function(y){var x=this.cache,v,_;return y.skipCache?f(y):(_=this.hash(y),v=x[_],g(this.cacheCount,_),v||(v=f(y),x[_]=v,v))},unuseGeometry:function(y){var x=this.cache,v=this.cacheCount,_,T;y.skipCache||(T=this.hash(y),x[T]&&(m(v,T),!(v[T]>0)&&(_=x[T],_.dispose(),delete x[T],delete v[T])))},hash:function(y){return JSON.stringify(y)}});function f(y){var x=y.primitive,v=h[x]&&h[x].Geometry,_=new v;if(!v)throw new Error("Unknown geometry `"+x+"`");return _.init(y),_.geometry}function m(y,x){y[x]--}function g(y,x){y[x]=y[x]===void 0?1:y[x]+1}},"./src/systems/gltf-model.js":(l,u,c)=>{var h=c("./src/core/system.js").registerSystem,p=c("./src/lib/three.js");function f(m){return new Promise(function(g,y){var x=document.createElement("script");document.body.appendChild(x),x.onload=g,x.onerror=y,x.async=!0,x.src=m})}l.exports.System=h("gltf-model",{schema:{dracoDecoderPath:{default:"https://www.gstatic.com/draco/versioned/decoders/1.5.6/"},basisTranscoderPath:{default:""},meshoptDecoderPath:{default:""}},init:function(){this.update()},update:function(){var m=this.data.dracoDecoderPath,g=this.data.basisTranscoderPath,y=this.data.meshoptDecoderPath;!this.dracoLoader&&m&&(this.dracoLoader=new p.DRACOLoader,this.dracoLoader.setDecoderPath(m)),!this.ktx2Loader&&g&&(this.ktx2Loader=new p.KTX2Loader,this.ktx2Loader.setTranscoderPath(g).detectSupport(this.el.renderer)),!this.meshoptDecoder&&y&&(this.meshoptDecoder=f(y).then(function(){return window.MeshoptDecoder.ready}).then(function(){return window.MeshoptDecoder}))},getDRACOLoader:function(){return this.dracoLoader},getKTX2Loader:function(){return this.ktx2Loader},getMeshoptDecoder:function(){return this.meshoptDecoder}})},"./src/systems/index.js":(l,u,c)=>{c("./src/systems/camera.js"),c("./src/systems/geometry.js"),c("./src/systems/gltf-model.js"),c("./src/systems/light.js"),c("./src/systems/material.js"),c("./src/systems/obb-collider.js"),c("./src/systems/renderer.js"),c("./src/systems/shadow.js"),c("./src/systems/tracked-controls-webvr.js"),c("./src/systems/tracked-controls-webxr.js"),c("./src/systems/webxr.js")},"./src/systems/light.js":(l,u,c)=>{var h=c("./src/core/system.js").registerSystem,p=c("./src/constants/index.js"),f="data-aframe-default-light";l.exports.System=h("light",{schema:{defaultLightsEnabled:{default:!0}},init:function(){this.defaultLights=!1,this.userDefinedLights=!1,this.sceneEl.addEventListener("loaded",this.setupDefaultLights.bind(this))},registerLight:function(m){m.hasAttribute(f)||(this.removeDefaultLights(),this.userDefinedLights=!0)},removeDefaultLights:function(){var m,g=this.sceneEl;if(this.defaultLights){m=document.querySelectorAll("["+f+"]");for(var y=0;y<m.length;y++)g.removeChild(m[y]);this.defaultLights=!1}},setupDefaultLights:function(){var m=this.sceneEl,g,y;this.userDefinedLights||this.defaultLights||!this.data.defaultLightsEnabled||(g=document.createElement("a-entity"),g.setAttribute("light",{color:"#BBB",type:"ambient"}),g.setAttribute(f,""),g.setAttribute(p.AFRAME_INJECTED,""),m.appendChild(g),y=document.createElement("a-entity"),y.setAttribute("light",{color:"#FFF",intensity:.6,castShadow:!0}),y.setAttribute("position",{x:-.5,y:1,z:1}),y.setAttribute(f,""),y.setAttribute(p.AFRAME_INJECTED,""),m.appendChild(y),this.defaultLights=!0)}})},"./src/systems/material.js":(l,u,c)=>{var h=c("./src/core/system.js").registerSystem,p=c("./src/lib/three.js"),f=c("./src/utils/index.js"),m=c("./src/utils/material.js").setTextureProperties,g=c("./src/utils/material.js").createCompatibleTexture,y=f.debug,x=y("components:texture:error"),v=y("components:texture:warn"),_=new p.ImageLoader;l.exports.System=h("material",{init:function(){this.materials={},this.sourceCache={}},clearTextureSourceCache:function(){this.sourceCache={}},loadTexture:function(R,B,I){this.loadTextureSource(R,function(D){var L=g(D);m(L,B),I(L)})},loadTextureSource:function(R,B){var I=this,D=this.sourceCache,L=this.hash(R);if(D[L]){D[L].then(B);return}if(R.tagName==="CANVAS"){U(new p.Source(R));return}U(new Promise(O));function O(Z,G){f.srcLoader.validateSrc(R,z,$);function z(Q){I.loadImage(Q,Z)}function $(Q){I.loadVideo(Q,Z)}}function U(Z){D[L]=Promise.resolve(Z),D[L].then(B)}},loadCubeMapTexture:function(R,B){var I=this,D=0,L=new p.CubeTexture;L.colorSpace=p.SRGBColorSpace;function O(Z){I.loadTextureSource(R[Z],function(G){L.images[Z]=G,D++,D===6&&(L.needsUpdate=!0,B(L))})}if(R.length!==6){v("Cube map texture requires exactly 6 sources, got only %s sources",R.length);return}for(var U=0;U<R.length;U++)O(U)},loadImage:function(R,B){if(typeof R!="string"){B(new p.Source(R));return}B(T(R))},loadVideo:function(R,B){var I;typeof R!="string"&&(I=R,S(I)),I=I||w(R),B(new p.Source(I))},hash:function(R){return R.tagName&&(R.id||R.src)||R},registerMaterial:function(R){this.materials[R.uuid]=R},unregisterMaterial:function(R){delete this.materials[R.uuid]}});function T(R){return new Promise(B);function B(I,D){_.load(R,L,function(){},function(O){x("`$s` could not be fetched (Error code: %s; Response: %s)",O.status,O.statusText)});function L(O){I(new p.Source(O))}}}function w(R){var B=document.createElement("video");return B.setAttribute("playsinline",""),B.setAttribute("webkit-playsinline",""),B.autoplay=!0,B.loop=!0,B.crossOrigin="anonymous",B.addEventListener("error",function(){v("`%s` is not a valid video",R)},!0),B.src=R,B}function S(R){return R.autoplay=R.hasAttribute("autoplay")&&R.getAttribute("autoplay")!=="false",R.controls=R.hasAttribute("controls")&&R.getAttribute("controls")!=="false",R.getAttribute("loop")==="false"&&R.removeAttribute("loop"),R.getAttribute("preload")==="false"&&(R.preload="none"),R.crossOrigin=R.crossOrigin||"anonymous",R.setAttribute("playsinline",""),R.setAttribute("webkit-playsinline",""),R}},"./src/systems/obb-collider.js":(l,u,c)=>{var h=c("./src/core/system.js").registerSystem;h("obb-collider",{schema:{showColliders:{default:!1}},init:function(){this.collisions=[],this.colliderEls=[]},addCollider:function(p){this.colliderEls.push(p),this.data.showColliders?p.components["obb-collider"].showCollider():p.components["obb-collider"].hideCollider(),this.tick=this.detectCollisions},removeCollider:function(p){var f=this.colliderEls,m=f.indexOf(p);p.components["obb-collider"].hideCollider(),m>-1&&f.splice(m,1),f.length===0&&(this.tick=void 0)},registerCollision:function(p,f){var m=this.collisions,g=!1,y=p.obb,x=f.obb,v=p.renderColliderMesh,_=f.renderColliderMesh;v&&v.material.color.set(16711680),_&&_.material.color.set(16711680);for(var T=0;T<m.length;T++)if(m[T].componentA.obb===y&&m[T].componentB.obb===x||m[T].componentA.obb===x&&m[T].componentB.obb===y){g=!0,m[T].detected=!0;break}g||(m.push({componentA:p,componentB:f,detected:!0}),p.el.emit("obbcollisionstarted",{trackedObject3D:p.trackedObject3D,withEl:f.el}),f.el.emit("obbcollisionstarted",{trackedObject3D:f.trackedObject3D,withEl:p.el}))},resetCollisions:function(){for(var p=this.collisions,f=0;f<p.length;f++)p[f].detected=!1},clearCollisions:function(){for(var p=this.collisions,f=[],m,g,y,x,v=0;v<p.length;v++)p[v].detected?f.push(p[v]):(m=p[v].componentA,g=p[v].componentB,y=m.renderColliderMesh,x=g.renderColliderMesh,y&&y.material.color.set(65280),m.el.emit("obbcollisionended",{trackedObject3D:this.trackedObject3D,withEl:g.el}),x&&x.material.color.set(65280),g.el.emit("obbcollisionended",{trackedObject3D:this.trackedObject3D,withEl:m.el}));this.collisions=f},detectCollisions:function(){var p,f,m,g,y=this.colliderEls;if(!(y.length<2)){this.resetCollisions();for(var x=0;x<y.length;x++)if(m=y[x].components["obb-collider"],p=y[x].components["obb-collider"].obb,!(p.halfSize.x===0||p.halfSize.y===0||p.halfSize.z===0))for(var v=x+1;v<y.length;v++)g=y[v].components["obb-collider"],f=g.obb,!(f.halfSize.x===0||f.halfSize.y===0||f.halfSize.z===0)&&p.intersectsOBB(f)&&this.registerCollision(m,g);this.clearCollisions()}}})},"./src/systems/renderer.js":(l,u,c)=>{var h=c("./src/core/system.js").registerSystem,p=c("./src/utils/index.js"),f=c("./src/lib/three.js"),m=p.debug,g=m("components:renderer:warn");l.exports.System=h("renderer",{schema:{antialias:{default:"auto",oneOf:["true","false","auto"]},highRefreshRate:{default:p.device.isOculusBrowser()},logarithmicDepthBuffer:{default:"auto",oneOf:["true","false","auto"]},maxCanvasWidth:{default:-1},maxCanvasHeight:{default:-1},multiviewStereo:{default:!1},physicallyCorrectLights:{default:!1},exposure:{default:1,if:{toneMapping:["ACESFilmic","linear","reinhard","cineon"]}},toneMapping:{default:"no",oneOf:["no","ACESFilmic","linear","reinhard","cineon"]},precision:{default:"high",oneOf:["high","medium","low"]},anisotropy:{default:1},sortTransparentObjects:{default:!1},colorManagement:{default:!0},alpha:{default:!0},stencil:{default:!1},foveationLevel:{default:1}},init:function(){var _=this.data,T=this.el,w=this.data.toneMapping.charAt(0).toUpperCase()+this.data.toneMapping.slice(1),S=T.renderer;_.physicallyCorrectLights||(S.useLegacyLights=!_.physicallyCorrectLights),S.toneMapping=f[w+"ToneMapping"],f.Texture.DEFAULT_ANISOTROPY=_.anisotropy,f.ColorManagement.enabled=_.colorManagement,S.outputColorSpace=_.colorManagement?f.SRGBColorSpace:f.LinearSRGBColorSpace,T.hasAttribute("antialias")&&g('Component `antialias` is deprecated. Use `renderer="antialias: true"` instead.'),T.hasAttribute("logarithmicDepthBuffer")&&g('Component `logarithmicDepthBuffer` is deprecated. Use `renderer="logarithmicDepthBuffer: true"` instead.'),S.sortObjects=!0,S.setOpaqueSort(y)},update:function(){var _=this.data,T=this.el,w=T.renderer,S=this.data.toneMapping.charAt(0).toUpperCase()+this.data.toneMapping.slice(1);w.toneMapping=f[S+"ToneMapping"],w.toneMappingExposure=_.exposure,w.xr.setFoveation(_.foveationLevel),_.sortObjects&&g('`sortObjects` property is deprecated. Use `renderer="sortTransparentObjects: true"` instead.'),_.sortTransparentObjects?w.setTransparentSort(v):w.setTransparentSort(x)},applyColorCorrection:function(_){!this.data.colorManagement||!_||_.isTexture&&_.colorSpace!==f.SRGBColorSpace&&(_.colorSpace=f.SRGBColorSpace,_.needsUpdate=!0)},setWebXRFrameRate:function(_){var T=this.data,w=_.supportedFrameRates;if(w&&_.updateTargetFrameRate){var S;w.includes(90)?S=T.highRefreshRate?90:72:S=T.highRefreshRate?72:60,_.updateTargetFrameRate(S).catch(function(R){console.warn("failed to set target frame rate of "+S+". Error info: "+R)})}}});function y(_,T){return _.groupOrder!==T.groupOrder?_.groupOrder-T.groupOrder:_.renderOrder!==T.renderOrder?_.renderOrder-T.renderOrder:_.z-T.z}function x(_,T){return _.groupOrder!==T.groupOrder?_.groupOrder-T.groupOrder:_.renderOrder-T.renderOrder}function v(_,T){return _.groupOrder!==T.groupOrder?_.groupOrder-T.groupOrder:_.renderOrder!==T.renderOrder?_.renderOrder-T.renderOrder:T.z-_.z}l.exports.sortFrontToBack=y,l.exports.sortRenderOrderOnly=x,l.exports.sortBackToFront=v},"./src/systems/shadow.js":(l,u,c)=>{var h=c("./src/core/system.js").registerSystem,p=c("./src/lib/three.js"),f={basic:p.BasicShadowMap,pcf:p.PCFShadowMap,pcfsoft:p.PCFSoftShadowMap};l.exports.System=h("shadow",{schema:{enabled:{default:!0},autoUpdate:{default:!0},type:{default:"pcf",oneOf:["basic","pcf","pcfsoft"]}},init:function(){var g=this.sceneEl,y=this.data;this.shadowMapEnabled=!1,g.renderer.shadowMap.type=f[y.type],g.renderer.shadowMap.autoUpdate=y.autoUpdate},update:function(g){g.enabled!==this.data.enabled&&this.setShadowMapEnabled(this.shadowMapEnabled)},setShadowMapEnabled:function(g){var y=this.sceneEl,x=this.sceneEl.renderer;this.shadowMapEnabled=g;var v=this.data.enabled&&this.shadowMapEnabled;x&&v!==x.shadowMap.enabled&&(x.shadowMap.enabled=v,m(y))}});function m(g){g.hasLoaded&&g.object3D.traverse(function(y){if(y.material)for(var x=Array.isArray(y.material)?y.material:[y.material],v=0;v<x.length;v++)x[v].needsUpdate=!0})}},"./src/systems/tracked-controls-webvr.js":(l,u,c)=>{var h=c("./src/core/system.js").registerSystem,p=c("./src/utils/index.js"),f=p.device.isWebXRAvailable;l.exports.System=h("tracked-controls-webvr",{init:function(){var m=this;this.controllers=[],this.isChrome=navigator.userAgent.indexOf("Chrome")!==-1,this.updateControllerList(),this.throttledUpdateControllerList=p.throttle(this.updateControllerList,500,this),!f&&navigator.getVRDisplays&&this.sceneEl.addEventListener("enter-vr",function(){navigator.getVRDisplays().then(function(g){g.length&&(m.vrDisplay=g[0])})})},tick:function(){this.isChrome?this.updateControllerList():this.throttledUpdateControllerList()},updateControllerList:function(){var m=this.controllers,g,y,x,v;if(y=navigator.getGamepads&&navigator.getGamepads(),!!y){for(v=m.length,m.length=0,x=0;x<y.length;++x)g=y[x],g&&g.pose&&m.push(g);m.length!==v&&this.el.emit("controllersupdated",void 0,!1)}}})},"./src/systems/tracked-controls-webxr.js":(l,u,c)=>{var h=c("./src/core/system.js").registerSystem,p=c("./src/utils/index.js");l.exports.System=h("tracked-controls-webxr",{init:function(){this.controllers=[],this.oldControllers=[],this.oldControllersLength=0,this.throttledUpdateControllerList=p.throttle(this.updateControllerList,500,this),this.updateReferenceSpace=this.updateReferenceSpace.bind(this),this.el.addEventListener("enter-vr",this.updateReferenceSpace),this.el.addEventListener("exit-vr",this.updateReferenceSpace)},tick:function(){this.throttledUpdateControllerList()},updateReferenceSpace:function(){var f=this,m=this.el.xrSession;if(!m){this.referenceSpace=void 0,this.controllers=[],this.oldControllersLength>0&&(this.oldControllersLength=0,this.el.emit("controllersupdated",void 0,!1));return}var g=f.el.sceneEl.systems.webxr.sessionReferenceSpaceType;m.requestReferenceSpace(g).then(function(y){f.referenceSpace=y}).catch(function(y){throw f.el.sceneEl.systems.webxr.warnIfFeatureNotRequested(g,'tracked-controls-webxr uses reference space "'+g+'".'),y})},updateControllerList:function(){var f=this.el.xrSession,m=this.oldControllers,g;if(!f){if(this.oldControllersLength===0)return;this.oldControllersLength=0,this.controllers=[],this.el.emit("controllersupdated",void 0,!1);return}if(f.inputSources){if(this.controllers=f.inputSources,this.oldControllersLength===this.controllers.length){var y=!0;for(g=0;g<this.controllers.length;++g)if(!(this.controllers[g]===m[g]&&this.controllers[g].gamepad===m[g].gamepad)){y=!1;break}if(y)return}for(m.length=0,g=0;g<this.controllers.length;g++)m.push(this.controllers[g]);this.oldControllersLength=this.controllers.length,this.el.emit("controllersupdated",void 0,!1)}}})},"./src/systems/webxr.js":(l,u,c)=>{var h=c("./src/core/system.js").registerSystem,p=c("./src/utils/index.js"),f=p.debug("systems:webxr:warn");l.exports.System=h("webxr",{schema:{referenceSpaceType:{type:"string",default:"local-floor"},requiredFeatures:{type:"array",default:["local-floor"]},optionalFeatures:{type:"array",default:["bounded-floor"]},overlayElement:{type:"selector"}},update:function(){var m=this.data;this.sessionConfiguration={requiredFeatures:m.requiredFeatures,optionalFeatures:m.optionalFeatures},this.sessionReferenceSpaceType=m.referenceSpaceType,m.overlayElement&&(m.overlayElement.classList.remove("a-dom-overlay"),m.optionalFeatures.includes("dom-overlay")||(m.optionalFeatures.push("dom-overlay"),this.el.setAttribute("webxr",m)),this.warnIfFeatureNotRequested("dom-overlay"),this.sessionConfiguration.domOverlay={root:m.overlayElement},m.overlayElement.classList.add("a-dom-overlay"))},wasFeatureRequested:function(m){return!!(m==="viewer"||m==="local"||this.sessionConfiguration.requiredFeatures.includes(m)||this.sessionConfiguration.optionalFeatures.includes(m))},warnIfFeatureNotRequested:function(m,g){if(!this.wasFeatureRequested(m)){var y='Please add the feature "'+m+`" to a-scene's webxr system options in requiredFeatures/optionalFeatures.`;f((g?g+" ":"")+y)}}})},"./src/utils/coordinates.js":(l,u,c)=>{var h=c("./src/utils/debug.js"),p=h("utils:coordinates:warn"),f=["x","y","z","w"],m=/^\s*((-?\d*\.{0,1}\d+(e-?\d+)?)\s+){2,3}(-?\d*\.{0,1}\d+(e-?\d+)?)\s*$/;l.exports.regex=m;var g=/\s+/g;function y(w,S,R){var B,I,D,L,O=R&&typeof R=="object"?R:{},U,Z,G,z;if(w&&w instanceof Object)return U=w.x===void 0?S&&S.x:w.x,Z=w.y===void 0?S&&S.y:w.y,G=w.z===void 0?S&&S.z:w.z,z=w.w===void 0?S&&S.w:w.w,U!=null&&(O.x=T(U)),Z!=null&&(O.y=T(Z)),G!=null&&(O.z=T(G)),z!=null&&(O.w=T(z)),O;if(w==null)return typeof S=="object"?Object.assign(O,S):S;for(B=w.trim().split(g),L=0;L<f.length;L++)if(D=f[L],B[L])O[D]=parseFloat(B[L],10);else{if(I=S&&S[D],I===void 0)continue;O[D]=T(I)}return O}l.exports.parse=y;function x(w){var S;return typeof w!="object"?w:(S=w.x+" "+w.y,w.z!=null&&(S+=" "+w.z),w.w!=null&&(S+=" "+w.w),S)}l.exports.stringify=x;function v(w,S){return typeof w!="object"||typeof S!="object"?w===S:w.x===S.x&&w.y===S.y&&w.z===S.z&&w.w===S.w}l.exports.equals=v;function _(w){return m.test(w)}l.exports.isCoordinates=_,l.exports.isCoordinate=function(w){return p("`AFRAME.utils.isCoordinate` has been renamed to `AFRAME.utils.isCoordinates`"),_(w)};function T(w){return w!=null&&w.constructor===String?parseFloat(w,10):w}l.exports.toVector3=function(w){return new THREE.Vector3(w.x,w.y,w.z)}},"./src/utils/debug.js":(l,u,c)=>{var h=c("./node_modules/debug/src/browser.js"),p=c("./src/utils/device.js").isBrowserEnvironment,f={colors:{debug:"gray",error:"red",info:"gray",warn:"orange"}};h.formatArgs=m;function m(_){if(_[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+_[0]+(this.useColors?"%c ":" "),!!this.useColors){this.color=y(this.namespace);var T="color: "+this.color;_.splice(1,0,T,"color: inherit");var w=0,S=0;_[0].replace(/%[a-zA-Z%]/g,function(R){R!=="%%"&&(w++,R==="%c"&&(S=w))}),_.splice(S,0,T)}}function g(_){var T=_.split(":");return T[T.length-1]}function y(_){var T=g(_),w=f.colors&&f.colors[T];return w||null}function x(){try{return window.localStorage}catch{}}var v=x();v&&(parseInt(v.logs,10)||v.logs==="true")?h.enable("*"):h.enable("*:error,*:info,*:warn"),p&&(window.logs=h),l.exports=h},"./src/utils/device.js":(l,u,c)=>{var h=c("./node_modules/debug/src/browser.js")("device:error"),p,f=!1,m=!1,g=l.exports.isWebXRAvailable=navigator.xr!==void 0;if(window.addEventListener("vrdisplayactivate",function(G){var z;g||(z=document.createElement("canvas"),p=G.display,z.getContext("webgl",{}),p.requestPresent([{source:z}]).then(function(){},function(){}))}),g){var y=function(){var G=document.querySelector("a-scene");if(!G){window.addEventListener("DOMContentLoaded",y);return}G.hasLoaded?G.components["xr-mode-ui"].updateEnterInterfaces():G.addEventListener("loaded",y)},x=function(G){h("WebXR session support error: "+G.message)};navigator.xr.isSessionSupported?(navigator.xr.isSessionSupported("immersive-vr").then(function(G){f=G,y()}).catch(x),navigator.xr.isSessionSupported("immersive-ar").then(function(G){m=G,y()}).catch(function(){})):navigator.xr.supportsSession?(navigator.xr.supportsSession("immersive-vr").then(function(){f=!0,y()}).catch(x),navigator.xr.supportsSession("immersive-ar").then(function(){m=!0,y()}).catch(function(){})):h("WebXR has neither isSessionSupported or supportsSession?!")}else navigator.getVRDisplays&&navigator.getVRDisplays().then(function(G){var z=document.querySelector("a-scene");p=G.length&&G[0],z&&z.emit("displayconnected",{vrDisplay:p})});function v(){return p}l.exports.getVRDisplay=v;function _(){return f||m||!!v()}l.exports.checkHeadsetConnected=_;function T(){return m}l.exports.checkARSupport=T;function w(){return f}l.exports.checkVRSupport=w;var S=function(){var G=!1;return function(z){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(z)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(z.substr(0,4)))&&(G=!0),(I()||R()||Z())&&(G=!0),U()&&(G=!1)}(window.navigator.userAgent||window.navigator.vendor||window.opera),function(){return G}}();l.exports.isMobile=S;function R(G){var z=G||window.navigator.userAgent,$=/Nexus (7|9)|xoom|sch-i800|playbook|tablet|kindle/i.test(z);return $||B()}l.exports.isTablet=R;function B(G,z,$){var Q=G||window.navigator.userAgent,H=z||window.navigator.platform,V=$||window.navigator.maxTouchPoints||0;return(H==="iPad"||H==="MacIntel")&&V>0&&/Macintosh|Intel|iPad|ipad/i.test(Q)&&!window.MSStream}l.exports.isIpad=B;function I(){return/iPad|iPhone|iPod/.test(window.navigator.platform)}l.exports.isIOS=I;function D(){return!S()&&!U()&&window.orientation!==void 0}l.exports.isMobileDeviceRequestingDesktopSite=D;function L(){return/(OculusBrowser)/i.test(window.navigator.userAgent)}l.exports.isOculusBrowser=L;function O(){return/(Mobile VR)/i.test(window.navigator.userAgent)}l.exports.isFirefoxReality=O;function U(){return L()||O()}l.exports.isMobileVR=U;function Z(){return/R7 Build/.test(window.navigator.userAgent)}l.exports.isR7=Z,l.exports.isLandscape=function(){var G=window.orientation;return Z()&&(G+=90),G===90||G===-90},l.exports.isBrowserEnvironment=typeof process>"u"||process.browser===!0,l.exports.isNodeEnvironment=!l.exports.isBrowserEnvironment},"./src/utils/entity.js":(l,u,c)=>{var h=c("./src/utils/split.js").split;function p(f,m){m=m||".";var g=h(f,m);return g.length===1?g[0]:g}l.exports.getComponentPropertyPath=p,l.exports.getComponentProperty=function(f,m,g){var y;return g=g||".",m.indexOf(g)!==-1?(y=p(m,g),y.constructor===String?f.getAttribute(y):f.getAttribute(y[0])[y[1]]):f.getAttribute(m)},l.exports.setComponentProperty=function(f,m,g,y){var x;if(y=y||".",m.indexOf(y)!==-1){x=p(m,y),x.constructor===String?f.setAttribute(x,g):f.setAttribute(x[0],x[1],g);return}f.setAttribute(m,g)}},"./src/utils/forceCanvasResizeSafariMobile.js":l=>{l.exports=function(u){var c=u.style.width,h=u.style.height;u.style.width=parseInt(c,10)+1+"px",u.style.height=parseInt(h,10)+1+"px",setTimeout(function(){u.style.width=c,u.style.height=h},200)}},"./src/utils/index.js":(l,u,c)=>{var h=c("./src/utils/debug.js"),p=c("./node_modules/deep-assign/index.js"),f=c("./src/utils/device.js"),m=c("./src/utils/object-pool.js"),g=h("utils:warn");l.exports.bind=function(x){return x.bind.apply(x,Array.prototype.slice.call(arguments,1))},l.exports.coordinates=c("./src/utils/coordinates.js"),l.exports.debug=h,l.exports.device=f,l.exports.entity=c("./src/utils/entity.js"),l.exports.forceCanvasResizeSafariMobile=c("./src/utils/forceCanvasResizeSafariMobile.js"),l.exports.material=c("./src/utils/material.js"),l.exports.objectPool=m,l.exports.split=c("./src/utils/split.js").split,l.exports.styleParser=c("./src/utils/styleParser.js"),l.exports.trackedControls=c("./src/utils/tracked-controls.js"),l.exports.checkHeadsetConnected=function(){return g("`utils.checkHeadsetConnected` has moved to `utils.device.checkHeadsetConnected`"),f.checkHeadsetConnected(arguments)},l.exports.isGearVR=l.exports.device.isGearVR=function(){g("`utils.isGearVR` has been deprecated, use `utils.device.isMobileVR`")},l.exports.isIOS=function(){return g("`utils.isIOS` has moved to `utils.device.isIOS`"),f.isIOS(arguments)},l.exports.isOculusGo=l.exports.device.isOculusGo=function(){g("`utils.isOculusGo` has been deprecated, use `utils.device.isMobileVR`")},l.exports.isMobile=function(){return g("`utils.isMobile has moved to `utils.device.isMobile`"),f.isMobile(arguments)},l.exports.throttle=function(x,v,_){var T;return _&&(x=x.bind(_)),function(){var w=Date.now(),S=typeof T>"u"?v:w-T;(typeof T>"u"||S>=v)&&(T=w,x.apply(null,arguments))}},l.exports.throttleLeadingAndTrailing=function(x,v,_){var T,w;_&&(x=x.bind(_));var S,R=function(){T=Date.now(),x.apply(this,S),w=void 0};return function(){var B=Date.now(),I=typeof T>"u"?v:B-T;I>=v?(clearTimeout(w),w=void 0,T=B,x.apply(null,arguments)):(w=w||setTimeout(R,v-I),S=arguments)}},l.exports.throttleTick=function(x,v,_){var T;return _&&(x=x.bind(_)),function(w,S){var R=typeof T>"u"?S:w-T;(typeof T>"u"||R>=v)&&(T=w,x(w,R))}},l.exports.debounce=function(x,v,_){var T;return function(){var w=this,S=arguments,R=function(){T=null,_||x.apply(w,S)},B=_&&!T;clearTimeout(T),T=setTimeout(R,v),B&&x.apply(w,S)}},l.exports.extend=Object.assign,l.exports.extendDeep=p,l.exports.clone=function(x){return JSON.parse(JSON.stringify(x))};var y=function(){var x=m.createPool(function(){return[]});return function(v,_){var T,w,S,R,B,I;if(v===void 0||_===void 0||v===null||_===null||!(v&&_&&v.constructor===Object&&_.constructor===Object||v.constructor===Array&&_.constructor===Array))return v===_;w=x.use(),S=x.use(),w.length=0,S.length=0;for(T in v)w.push(T);for(T in _)S.push(T);if(w.length!==S.length)return x.recycle(w),x.recycle(S),!1;for(R=0;R<w.length;++R)if(B=v[w[R]],I=_[w[R]],typeof B=="object"||typeof I=="object"||Array.isArray(B)&&Array.isArray(I)){if(B===I)continue;if(!y(B,I))return x.recycle(w),x.recycle(S),!1}else if(B!==I)return x.recycle(w),x.recycle(S),!1;return x.recycle(w),x.recycle(S),!0}}();l.exports.deepEqual=y,l.exports.diff=function(){var x=[];return function(v,_,T){var w,S,R,B,I,D,L;B=T||{},x.length=0;for(I in v)x.push(I);if(!_)return B;for(R in _)x.indexOf(R)===-1&&x.push(R);for(D=0;D<x.length;D++)I=x[D],w=v[I],S=_[I],L=w&&S&&w.constructor===Object&&S.constructor===Object,(L&&!y(w,S)||!L&&w!==S)&&(B[I]=S);return B}}(),l.exports.shouldCaptureKeyEvent=function(x){return x.metaKey?!1:document.activeElement===document.body},l.exports.splitString=function(x,v){typeof v>"u"&&(v=" ");var _=new RegExp(v,"g");return x=(x||"").replace(_,v),x.split(v)},l.exports.getElData=function(x,v){v=v||{};var _={};Object.keys(v).forEach(T);function T(w){x.hasAttribute(w)&&(_[w]=x.getAttribute(w))}return _},l.exports.getUrlParameter=function(x){x=x.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var v=new RegExp("[\\?&]"+x+"=([^&#]*)"),_=v.exec(location.search);return _===null?"":decodeURIComponent(_[1].replace(/\+/g," "))},l.exports.isIframed=function(){return window.top!==window.self},l.exports.findAllScenes=function(x){for(var v=[],_=x.getElementsByTagName("*"),T=0,w=_.length;T<w;T++)_[T].isScene&&v.push(_[T]);return v},l.exports.srcLoader=c("./src/utils/src-loader.js")},"./src/utils/ios-orientationchange-blank-bug.js":()=>{window.addEventListener("orientationchange",function(){document.documentElement.style.height="initial",setTimeout(function(){document.documentElement.style.height="100%",setTimeout(function(){window.scrollTo(0,1)},500)},500)})},"./src/utils/isIOSOlderThan10.js":l=>{l.exports=function(u){return/(iphone|ipod|ipad).*os.(7_|8_|9_)/i.test(u)}},"./src/utils/material.js":(l,u,c)=>{var h=c("./src/lib/three.js"),p=c("./src/utils/src-loader.js"),f=c("./src/utils/debug.js"),m=f("utils:material:warn"),g=new Set(["emissiveMap","envMap","map","specularMap"]);function y(w,S){var R=S.offset||{x:0,y:0},B=S.repeat||{x:1,y:1},I=S.npot||!1,D=S.anisotropy||h.Texture.DEFAULT_ANISOTROPY,L=w.wrapS,O=w.wrapT,U=w.magFilter,Z=w.minFilter;I&&(L=h.ClampToEdgeWrapping,O=h.ClampToEdgeWrapping,U=h.LinearFilter,Z=h.LinearFilter),(B.x!==1||B.y!==1)&&(L=h.RepeatWrapping,O=h.RepeatWrapping),w.offset.set(R.x,R.y),w.repeat.set(B.x,B.y),(w.wrapS!==L||w.wrapT!==O||w.magFilter!==U||w.minFilter!==Z||w.anisotropy!==D)&&(w.wrapS=L,w.wrapT=O,w.magFilter=U,w.minFilter=Z,w.anisotropy=D,w.needsUpdate=!0)}l.exports.setTextureProperties=y,l.exports.updateMapMaterialFromData=function(w,S,R,B){var I=R.el,D=R.material,L=I.sceneEl.systems.renderer,O=B[S];if(R.materialSrcs||(R.materialSrcs={}),!O){delete R.materialSrcs[w],Z(null);return}if(O===R.materialSrcs[w]&&D[w]){y(D[w],B);return}R.materialSrcs[w]=O,O instanceof h.Texture?Z(O):I.sceneEl.systems.material.loadTextureSource(O,U);function U(G){if(R.materialSrcs[w]===O){var z=D[w];z&&(G===null||!_(z,G))&&(z=null),!z&&G&&(z=T(G)),z&&(z.source!==G&&(z.source=G,z.needsUpdate=!0),g.has(w)&&L.applyColorCorrection(z),y(z,B)),Z(z)}}function Z(G){D[w]!==G&&(D[w]&&D[w].dispose(),D[w]=G,D.needsUpdate=!0,v(I,G))}},l.exports.updateMap=function(w,S){return l.exports.updateMapMaterialFromData("map","src",w,S)},l.exports.updateDistortionMap=function(w,S,R){var B=w;w==="ambientOcclusion"&&(B="ao");var I={};return I.src=R[w+"Map"],I.offset=R[w+"TextureOffset"],I.repeat=R[w+"TextureRepeat"],I.wrap=R[w+"TextureWrap"],l.exports.updateMapMaterialFromData(B+"Map","src",S,I)};var x={};l.exports.updateEnvMap=function(w,S){var R=w.material,B=w.el,I="envMap",D=S.envMap,L=S.sphericalEnvMap,O=S.refract;if(L&&(D=L,m("`sphericalEnvMap` property is deprecated, using spherical map as equirectangular map instead. Use `envMap` property with a CubeMap or Equirectangular image instead.")),w.materialSrcs||(w.materialSrcs={}),!D){delete w.materialSrcs[I],R.envMap=null,R.needsUpdate=!0;return}if(w.materialSrcs[I]=D,x[D]){x[D].then(U);return}x[D]=new Promise(function(Z){p.validateEnvMapSrc(D,function(G){B.sceneEl.systems.material.loadCubeMapTexture(G,function(z){z.mapping=O?h.CubeRefractionMapping:h.CubeReflectionMapping,U(z),Z(z)})},function(G){B.sceneEl.systems.material.loadTexture(G,{src:G},function(z){z.mapping=O?h.EquirectangularRefractionMapping:h.EquirectangularReflectionMapping,U(z),Z(z)})})});function U(Z){w.materialSrcs[I]===D&&(R.envMap=Z,R.needsUpdate=!0,v(B,Z))}};function v(w,S){if(!S||(w.emit("materialtextureloaded",{src:S.image,texture:S}),!S.image||S.image.tagName!=="VIDEO"))return;S.image.addEventListener("loadeddata",R),S.image.addEventListener("ended",B);function R(){w.emit("materialvideoloadeddata",{src:S.image,texture:S})}function B(){w.emit("materialvideoended",{src:S.image,texture:S})}S.addEventListener("dispose",function(){S.image.removeEventListener("loadeddata",R),S.image.removeEventListener("ended",B)})}l.exports.handleTextureEvents=v;function _(w,S){return S.data instanceof HTMLCanvasElement?w.isCanvasTexture:S.data instanceof HTMLVideoElement?w.isVideoTexture&&w.source===S:w.isTexture&&!w.isCanvasTexture&&!w.isVideoTexture}l.exports.isCompatibleTexture=_;function T(w){var S;return w.data instanceof HTMLCanvasElement?S=new h.CanvasTexture:w.data instanceof HTMLVideoElement?S=new h.VideoTexture(w.data):S=new h.Texture,S.source=w,S.needsUpdate=!0,S}l.exports.createCompatibleTexture=T},"./src/utils/math.js":l=>{function u(h,p,f){var m=p.dot(h);return(m-p.dot(f))/p.length()}function c(h,p,f,m){var g=u(h,p,f);return m.copy(p),m.multiplyScalar(g),m.add(f),m}l.exports.distanceOfPointFromPlane=u,l.exports.nearestPointInPlane=c},"./src/utils/object-pool.js":l=>{var u=Object.freeze(Object.create(null));function c(){return{}}l.exports.createPool=function(f){var m=[],g=null;f=f||c;function y(){var T;return(g===null||g===m.length)&&v(m.length||5),T=m[g],m[g++]=u,h(T),T}function x(T){if(T instanceof Object){if(g===null||g===-1){m[m.length]=T;return}m[--g]=T}}function v(T){var w,S;if(T=T===void 0?m.length:T,T>0&&g==null&&(g=0),T>0)for(w=m.length,m.length+=Number(T),S=w;S<m.length;S++)m[S]=f();return m.length}function _(){return m.length}return{grow:v,pool:m,recycle:x,size:_,use:y}};function h(f){var m;if(!(!f||f.constructor!==Object))for(m in f)f[m]=void 0}l.exports.clearObject=h;function p(f,m){var g;if(!(!f||f.constructor!==Object))for(g in f)g in m||delete f[g]}l.exports.removeUnusedKeys=p},"./src/utils/split.js":l=>{l.exports.split=function(){var u={};return function(c,h){return h in u||(u[h]={}),c in u[h]||(u[h][c]=c.split(h)),u[h][c]}}()},"./src/utils/src-loader.js":(l,u,c)=>{var h=c("./src/utils/debug.js"),p=h("utils:src-loader:warn");function f(T,w,S){x(T,function(R){if(R){w(T);return}S(T)})}function m(T,w,S){var R,B="",I,D,L=[];if(typeof T=="string"){let U=function(Z){L.push(Z),L.length===6&&w(L)};for(I=0;I<5;I++)B+="(url\\((?:[^\\)]+)\\),\\s*)";if(B+="(url\\((?:[^\\)]+)\\)\\s*)",D=T.match(new RegExp(B)),D){for(I=1;I<7;I++)f(y(D[I]),U);return}if(!T.startsWith("#")){var O=y(T);f(O||T,S);return}}if(T.tagName?R=T:R=_(T),!!R){if(R.tagName==="A-CUBEMAP"&&R.srcs)return w(R.srcs);if(R.tagName==="IMG")return S(R);p('Selector "%s" does not point to <a-cubemap> or <img>',T)}}function g(T,w){return m(T,w,function(){p("Expected cubemap but got image")})}function y(T){var w=T.match(/url\((.+)\)/);if(w)return w[1]}function x(T,w){var S;if(T.tagName){w(T.tagName==="IMG");return}S=new XMLHttpRequest,S.open("HEAD",T),S.addEventListener("load",function(R){var B;S.status>=200&&S.status<300?(B=S.getResponseHeader("Content-Type"),B==null?v(T,w):B.startsWith("image")?w(!0):w(!1)):v(T,w),S.abort()}),S.send()}function v(T,w){var S=new Image;S.addEventListener("load",R);function R(){w(!0)}S.addEventListener("error",B);function B(){w(!1)}S.src=T}function _(T){try{var w=document.querySelector(T);return w||p('No element was found matching the selector: "%s"',T),w}catch{p('"%s" is not a valid selector',T);return}}l.exports={parseUrl:y,validateSrc:f,validateCubemapSrc:g,validateEnvMapSrc:m}},"./src/utils/styleParser.js":l=>{var u=/-([a-z])/g;l.exports.parse=function(g,y){var x;return typeof g!="string"||(x=p(g,y),x[""])?g:x},l.exports.stringify=function(g){return typeof g=="string"?g:f(g)};function c(g){return g.replace(u,m)}l.exports.toCamelCase=c;var h=function(){var g=[],y=/url\([^)]+$/;return function(x){var v="",_,T=0,w=";";for(g.length=0;T<x.length;){if(_=x.indexOf(w,T),_===-1&&(_=x.length),v+=x.substring(T,_),y.test(v)){v+=";",T=_+1;continue}g.push(v.trim()),v="",T=_+1}return g}}();function p(g,y){var x,v,_,T,w,S;for(y=y||{},x=h(g),v=0;v<x.length;v++)_=x[v],_&&(T=_.indexOf(":"),w=_.substr(0,T).trim(),S=_.substr(T+1).trim(),y[c(w)]=S);return y}function f(g){var y,x=0,v=0,_="";for(y in g)x++;for(y in g)_+=y+": "+g[y],v<x-1&&(_+="; "),v++;return _}function m(g){return g[1].toUpperCase()}},"./src/utils/tracked-controls.js":(l,u,c)=>{var h=c("./src/constants/index.js").DEFAULT_HANDEDNESS,p=["x","y","z","w"],f=2;l.exports.checkControllerPresentAndSetup=function(v,_,T){var w=v.el,S,R=w.sceneEl.hasWebXR,B=R?g:m,I;if(S=B(v,_,T),I=!!S,v.controllerPresent&&!v.controllerEventsActive&&!R&&v.addEventListeners(),I===v.controllerPresent)return I;v.controllerPresent=I,I?(v.addEventListeners(),v.injectTrackedControls(S),w.emit("controllerconnected",{name:v.name,component:v})):(v.removeEventListeners(),w.emit("controllerdisconnected",{name:v.name,component:v}))};function m(v,_,T){var w,S=v.el.sceneEl,R,B=T.index||0;return!_||(R=S&&S.systems["tracked-controls-webvr"],!R)||(w=R.controllers,!w.length)?!1:!!y(w,null,_,T.hand,B)}function g(v,_,T){var w,S=v.el.sceneEl,R=S&&S.systems["tracked-controls-webxr"];return!R||(w=R.controllers,!w||!w.length)?!1:x(w,_,T.hand,T.index,T.iterateControllerProfiles,T.handTracking)}l.exports.isControllerPresentWebVR=m,l.exports.isControllerPresentWebXR=g;function y(v,_,T,w,S){var R,B,I=0,D=S>=0?S:0;for(B=0;B<v.length;B++)if(R=v[B],!(T&&!R.id.startsWith(T))&&!(!T&&R.id!==_)&&!(w&&R.hand&&w!==R.hand)){if(w&&!R.hand)D=f*S+(w===h?0:1);else return R;if(I===D)return R;++I}}function x(v,_,T,w,S,R){var B,I,D,L=!1,O,U;for(B=0;B<v.length;B++){if(D=v[B],U=D.profiles,R)L=D.hand;else if(S)for(I=0;I<U.length&&(L=U[I].startsWith(_),!L);I++);else L=U.length>0&&U[0].startsWith(_);if(L){if(O=D.handedness==="right"||D.handedness==="left",O){if(D.handedness===T)return v[B]}else if(B===w)return v[B]}}}l.exports.findMatchingControllerWebVR=y,l.exports.findMatchingControllerWebXR=x,l.exports.emitIfAxesChanged=function(v,_,T){var w,S,R,B,I;for(S in _){for(w=_[S],R=!1,I=0;I<w.length;I++)T.detail.changed[w[I]]&&(R=!0);if(R){for(B={},I=0;I<w.length;I++)B[p[I]]=T.detail.axis[w[I]];v.el.emit(S+"moved",B)}}},l.exports.onButtonEvent=function(v,_,T,w){var S=w?T.mapping[w]:T.mapping,R=S.buttons[v];T.el.emit(R+_),T.updateModel&&T.updateModel(R,_)}},"./vendor/DeviceOrientationControls.js":()=>{THREE.DeviceOrientationControls=function(l){var u=this;this.object=l,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alphaOffset=0;var c=function(f){u.deviceOrientation=f},h=function(){u.screenOrientation=window.orientation||0},p=function(){var f=new THREE.Vector3(0,0,1),m=new THREE.Euler,g=new THREE.Quaternion,y=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));return function(x,v,_,T,w){m.set(_,v,-T,"YXZ"),x.setFromEuler(m),x.multiply(y),x.multiply(g.setFromAxisAngle(f,-w))}}();this.connect=function(){h(),window.addEventListener("orientationchange",h,!1),window.addEventListener("deviceorientation",c,!1),u.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",h,!1),window.removeEventListener("deviceorientation",c,!1),u.enabled=!1},this.update=function(){if(u.enabled!==!1){var f=u.deviceOrientation;if(f){var m=f.alpha?THREE.MathUtils.degToRad(f.alpha)+u.alphaOffset:0,g=f.beta?THREE.MathUtils.degToRad(f.beta):0,y=f.gamma?THREE.MathUtils.degToRad(f.gamma):0,x=u.screenOrientation?THREE.MathUtils.degToRad(u.screenOrientation):0;p(u.object.quaternion,m,g,y,x)}}},this.dispose=function(){u.disconnect()},this.connect()}},"./vendor/rStats.extras.js":l=>{window.glStats=function(){var u=null,c=0,h=0,p=0,f=0,m=0,g=0,y=0;function x(I,D){return function(){D.apply(this,arguments),I.apply(this,arguments)}}WebGLRenderingContext.prototype.drawArrays=x(WebGLRenderingContext.prototype.drawArrays,function(){c++,arguments[0]==this.POINTS?g+=arguments[2]:m+=arguments[2]}),WebGLRenderingContext.prototype.drawElements=x(WebGLRenderingContext.prototype.drawElements,function(){h++,f+=arguments[1]/3,m+=arguments[1]}),WebGLRenderingContext.prototype.useProgram=x(WebGLRenderingContext.prototype.useProgram,function(){p++}),WebGLRenderingContext.prototype.bindTexture=x(WebGLRenderingContext.prototype.bindTexture,function(){y++});var v={allcalls:{over:3e3,caption:"Calls (hook)"},drawelements:{caption:"drawElements (hook)"},drawarrays:{caption:"drawArrays (hook)"}},_=[{caption:"WebGL",values:["allcalls","drawelements","drawarrays","useprogram","bindtexture","glfaces","glvertices","glpoints"]}],T=[{base:"allcalls",steps:["drawelements","drawarrays"]}];function w(){u("allcalls").set(c+h),u("drawElements").set(h),u("drawArrays").set(c),u("bindTexture").set(y),u("useProgram").set(p),u("glfaces").set(f),u("glvertices").set(m),u("glpoints").set(g)}function S(){c=0,h=0,p=0,f=0,m=0,g=0,y=0}function R(){}function B(I){u=I}return{update:w,start:S,end:R,attach:B,values:v,groups:_,fractions:T}},window.threeStats=function(u){var c=null,h={"renderer.info.memory.geometries":{caption:"Geometries"},"renderer.info.memory.textures":{caption:"Textures"},"renderer.info.programs":{caption:"Programs"},"renderer.info.render.calls":{caption:"Calls"},"renderer.info.render.triangles":{caption:"Triangles",over:1e3},"renderer.info.render.points":{caption:"Points"}},p=[{caption:"Three.js - Memory",values:["renderer.info.memory.geometries","renderer.info.programs","renderer.info.memory.textures"]},{caption:"Three.js - Render",values:["renderer.info.render.calls","renderer.info.render.triangles","renderer.info.render.points"]}],f=[];function m(){c("renderer.info.memory.geometries").set(u.info.memory.geometries),c("renderer.info.programs").set(u.info.programs.length),c("renderer.info.memory.textures").set(u.info.memory.textures),c("renderer.info.render.calls").set(u.info.render.calls),c("renderer.info.render.triangles").set(u.info.render.triangles),c("renderer.info.render.points").set(u.info.render.points)}function g(){}function y(){}function x(v){c=v}return{update:m,start:g,end:y,attach:x,values:h,groups:p,fractions:f}},window.BrowserStats=function(){var u=null,c=0,h=0;window.performance&&!performance.memory&&(performance.memory={usedJSHeapSize:0,totalJSHeapSize:0}),performance.memory.totalJSHeapSize===0&&console.warn("totalJSHeapSize === 0... performance.memory is only available in Chrome .");var p={memory:{caption:"Used Memory",average:!0,avgMs:1e3,over:22},total:{caption:"Total Memory"}},f=[{caption:"Browser",values:["memory","total"]}],m=[{base:"total",steps:["memory"]}],g=Math.log(1024);function y(w){var S=100,R=Math.floor(Math.log(w)/g);return Math.round(w*S/Math.pow(1024,R))/S}function x(){c=y(performance.memory.usedJSHeapSize),h=y(performance.memory.totalJSHeapSize),u("memory").set(c),u("total").set(h)}function v(){c=0}function _(){}function T(w){u=w}return{update:x,start:v,end:_,attach:T,values:p,groups:f,fractions:m}},l.exports={glStats:window.glStats,threeStats:window.threeStats,BrowserStats:window.BrowserStats}},"./vendor/rStats.js":l=>{(function(){"performance"in window||(window.performance={});var u=window.performance;if(!("now"in u)){var c=Date.now();u.timing&&u.timing.navigationStart&&(c=u.timing.navigationStart),u.now=function(){return Date.now()-c}}u.mark||(u.mark=function(){}),u.measure||(u.measure=function(){})})(),window.rStats=function(u){function c(O,U){for(var Z=Object.keys(O),G=0,z=Z.length;G<z;G++)U(Z[G])}function h(O){var U=document.createElement("link");U.href=O,U.rel="stylesheet",U.type="text/css",document.getElementsByTagName("head")[0].appendChild(U)}var p=u||{},f=p.colours||["#850700","#c74900","#fcb300","#284280","#4c7c0c"],m="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700,300",g=(p.CSSPath?p.CSSPath:"")+"rStats.css",y=p.css||[m,g];y.forEach(function(O){h(O)}),p.values||(p.values={});var x,v,_=10,T=200,w={};function S(O,U,Z){var G=Z||{},z=document.createElement("canvas"),$=z.getContext("2d"),Q=0,H=0,V=G.color?G.color:"#666666",ne=document.createElement("canvas"),Y=ne.getContext("2d");ne.width=1,ne.height=2*_,Y.fillStyle="#444444",Y.fillRect(0,0,1,2*_),Y.fillStyle=V,Y.fillRect(0,_,1,_),Y.fillStyle="#ffffff",Y.globalAlpha=.5,Y.fillRect(0,_,1,1),Y.globalAlpha=1;var ae=document.createElement("canvas"),xe=ae.getContext("2d");ae.width=1,ae.height=2*_,xe.fillStyle="#444444",xe.fillRect(0,0,1,2*_),xe.fillStyle="#b70000",xe.fillRect(0,_,1,_),xe.globalAlpha=.5,xe.fillStyle="#ffffff",xe.fillRect(0,_,1,1),xe.globalAlpha=1;function fe(){z.width=T,z.height=_,z.style.width=z.width+"px",z.style.height=z.height+"px",z.className="rs-canvas",O.appendChild(z),$.fillStyle="#444444",$.fillRect(0,0,z.width,z.height)}function de(Ie,Ge){H+=(Ie-H)*.1,Q*=.99,H>Q&&(Q=H),$.drawImage(z,1,0,z.width-1,z.height,0,0,z.width-1,z.height),Ge?$.drawImage(ae,z.width-1,z.height-H*z.height/Q-_):$.drawImage(ne,z.width-1,z.height-H*z.height/Q-_)}return fe(),{draw:de}}function R(O,U){var Z=document.createElement("canvas"),G=Z.getContext("2d");function z(){Z.width=T,Z.height=_*U,Z.style.width=Z.width+"px",Z.style.height=Z.height+"px",Z.className="rs-canvas",O.appendChild(Z),G.fillStyle="#444444",G.fillRect(0,0,Z.width,Z.height)}function $(Q){G.drawImage(Z,1,0,Z.width-1,Z.height,0,0,Z.width-1,Z.height);var H=0;c(Q,function(V){var ne=Q[V]*Z.height;G.fillStyle=f[V],G.fillRect(Z.width-1,H,1,ne),H+=ne})}return z(),{draw:$}}function B(O,U){var Z=O,G,z=0,$=0,Q=0,H=0,V=performance.now(),ne=0,Y=document.createElement("div"),ae=document.createElement("span"),xe=document.createElement("div"),fe=document.createTextNode(""),de=p?p.values[Z.toLowerCase()]:null,Ie=new S(Y,Z,de),Ge=!1;ae.className="rs-counter-id",ae.textContent=de&&de.caption?de.caption:Z,xe.className="rs-counter-value",xe.appendChild(fe),Y.appendChild(ae),Y.appendChild(xe),U?U.div.appendChild(Y):v.appendChild(Y),G=performance.now();function Xe(Ze){if(de&&de.average){H+=Ze,ne++;var Ui=performance.now();Ui-V>=(de.avgMs||1e3)&&(Q=H/ne,H=0,V=Ui,ne=0)}}function $e(){G=performance.now(),p.userTimingAPI&&performance.mark(Z+"-start"),Ge=!0}function lt(){z=performance.now()-G,p.userTimingAPI&&(performance.mark(Z+"-end"),Ge&&performance.measure(Z,Z+"-start",Z+"-end")),Xe(z)}function At(){lt(),$e()}function Gt(){var Ze=de&&de.average?Q:z;fe.nodeValue=Math.round(Ze*100)/100;var Ui=de&&(de.below&&z<de.below||de.over&&z>de.over);Ie.draw(z,Ui),Y.className=Ui?"rs-counter-base alarm":"rs-counter-base"}function gt(){var Ze=performance.now(),Ui=Ze-G;$++,Ui>1e3&&(de&&de.interpolate===!1?z=$:z=$*1e3/Ui,$=0,G=Ze,Xe(z))}function xi(Ze){z=Ze,Xe(z)}return{set:xi,start:$e,tick:At,end:lt,frame:gt,value:function(){return z},draw:Gt}}function I(O){var U=O.toLowerCase();if(U===void 0&&(U="default"),w[U])return w[U];var Z=null;p&&p.groups&&c(p.groups,function(z){var $=p.groups[parseInt(z,10)];!Z&&$.values.indexOf(U.toLowerCase())!==-1&&(Z=$)});var G=new B(U,Z);return w[U]=G,G}function D(){if(p.plugins){p.values||(p.values={}),p.groups||(p.groups=[]),p.fractions||(p.fractions=[]);for(var O=0;O<p.plugins.length;O++)p.plugins[O].attach(I),c(p.plugins[O].values,function(U){p.values[U]=p.plugins[O].values[U]}),p.groups=p.groups.concat(p.plugins[O].groups),p.fractions=p.fractions.concat(p.plugins[O].fractions)}else p.plugins={};x=document.createElement("div"),x.className="rs-base",v=document.createElement("div"),v.className="rs-container",v.style.height="auto",x.appendChild(v),document.body.appendChild(x),p&&(p.groups&&c(p.groups,function(U){var Z=p.groups[parseInt(U,10)],G=document.createElement("div");G.className="rs-group",Z.div=G;var z=document.createElement("h1");z.textContent=Z.caption,z.addEventListener("click",(function($){this.classList.toggle("hidden"),$.preventDefault()}).bind(G)),v.appendChild(z),v.appendChild(G)}),p.fractions&&c(p.fractions,function(U){var Z=p.fractions[parseInt(U,10)],G=document.createElement("div");G.className="rs-fraction";var z=document.createElement("div");z.className="rs-legend";var $=0;c(p.fractions[U].steps,function(H){var V=document.createElement("p");V.textContent=p.fractions[U].steps[H],V.style.color=f[$],z.appendChild(V),$++}),G.appendChild(z),G.style.height=$*_+"px",Z.div=G;var Q=new R(G,$);Z.graph=Q,v.appendChild(G)}))}function L(){c(p.plugins,function(O){p.plugins[O].update()}),c(w,function(O){w[O].draw()}),p&&p.fractions&&c(p.fractions,function(O){var U=p.fractions[parseInt(O,10)],Z=[],G=w[U.base.toLowerCase()];G&&(G=G.value(),c(p.fractions[O].steps,function(z){var $=p.fractions[O].steps[parseInt(z,10)].toLowerCase(),Q=w[$];Q&&Z.push(Q.value()/G)})),U.graph.draw(Z)})}return D(),function(O){return O?I(O):{element:x,update:L}}},l.exports=window.rStats},"./vendor/wakelock/util.js":l=>{var u={};u.base64=function(c,h){return"data:"+c+";base64,"+h},u.isMobile=function(){var c=!1;return function(h){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(h)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(h.substr(0,4)))&&(c=!0)}(navigator.userAgent||navigator.vendor||window.opera),c},u.isIOS=function(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)},u.isIFrame=function(){try{return window.self!==window.top}catch{return!0}},u.appendQueryParameter=function(c,h,p){var f=c.indexOf("?")<0?"?":"&";return c+=f+h+"="+p,c},u.getQueryParameter=function(c){c=c.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var h=new RegExp("[\\?&]"+c+"=([^&#]*)"),p=h.exec(location.search);return p===null?"":decodeURIComponent(p[1].replace(/\+/g," "))},u.isLandscapeMode=function(){return window.orientation==90||window.orientation==-90},l.exports=u},"./vendor/wakelock/wakelock.js":(l,u,c)=>{var h=c("./vendor/wakelock/util.js");function p(){var g=document.createElement("video");g.addEventListener("ended",function(){g.play()}),this.request=function(){g.paused&&(g.src=h.base64("video/webm","GkXfowEAAAAAAAAfQoaBAUL3gQFC8oEEQvOBCEKChHdlYm1Ch4ECQoWBAhhTgGcBAAAAAAAH4xFNm3RALE27i1OrhBVJqWZTrIHfTbuMU6uEFlSua1OsggEwTbuMU6uEHFO7a1OsggfG7AEAAAAAAACkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmAQAAAAAAAEUq17GDD0JATYCNTGF2ZjU2LjQwLjEwMVdBjUxhdmY1Ni40MC4xMDFzpJAGSJTMbsLpDt/ySkipgX1fRImIQO1MAAAAAAAWVK5rAQAAAAAAADuuAQAAAAAAADLXgQFzxYEBnIEAIrWcg3VuZIaFVl9WUDmDgQEj44OEO5rKAOABAAAAAAAABrCBsLqBkB9DtnUBAAAAAAAAo+eBAKOmgQAAgKJJg0IAAV4BHsAHBIODCoAACmH2MAAAZxgz4dPSTFi5JACjloED6ACmAECSnABMQAADYAAAWi0quoCjloEH0ACmAECSnABNwAADYAAAWi0quoCjloELuACmAECSnABNgAADYAAAWi0quoCjloEPoACmAECSnABNYAADYAAAWi0quoCjloETiACmAECSnABNIAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTnghdwo5aBAAAApgBAkpwATOAAA2AAAFotKrqAo5aBA+gApgBAkpwATMAAA2AAAFotKrqAo5aBB9AApgBAkpwATIAAA2AAAFotKrqAo5aBC7gApgBAkpwATEAAA2AAAFotKrqAo5aBD6AApgDAkpwAQ2AAA2AAAFotKrqAo5aBE4gApgBAkpwATCAAA2AAAFotKrqAH0O2dQEAAAAAAACU54Iu4KOWgQAAAKYAQJKcAEvAAANgAABaLSq6gKOWgQPoAKYAQJKcAEtgAANgAABaLSq6gKOWgQfQAKYAQJKcAEsAAANgAABaLSq6gKOWgQu4AKYAQJKcAEqAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEogAANgAABaLSq6gKOWgROIAKYAQJKcAEnAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCRlCjloEAAACmAECSnABJgAADYAAAWi0quoCjloED6ACmAECSnABJIAADYAAAWi0quoCjloEH0ACmAMCSnABDYAADYAAAWi0quoCjloELuACmAECSnABI4AADYAAAWi0quoCjloEPoACmAECSnABIoAADYAAAWi0quoCjloETiACmAECSnABIYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngl3Ao5aBAAAApgBAkpwASCAAA2AAAFotKrqAo5aBA+gApgBAkpwASAAAA2AAAFotKrqAo5aBB9AApgBAkpwAR8AAA2AAAFotKrqAo5aBC7gApgBAkpwAR4AAA2AAAFotKrqAo5aBD6AApgBAkpwAR2AAA2AAAFotKrqAo5aBE4gApgBAkpwARyAAA2AAAFotKrqAH0O2dQEAAAAAAACU54J1MKOWgQAAAKYAwJKcAENgAANgAABaLSq6gKOWgQPoAKYAQJKcAEbgAANgAABaLSq6gKOWgQfQAKYAQJKcAEagAANgAABaLSq6gKOWgQu4AKYAQJKcAEaAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEZAAANgAABaLSq6gKOWgROIAKYAQJKcAEYAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCjKCjloEAAACmAECSnABF4AADYAAAWi0quoCjloED6ACmAECSnABFwAADYAAAWi0quoCjloEH0ACmAECSnABFoAADYAAAWi0quoCjloELuACmAECSnABFgAADYAAAWi0quoCjloEPoACmAMCSnABDYAADYAAAWi0quoCjloETiACmAECSnABFYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngqQQo5aBAAAApgBAkpwARUAAA2AAAFotKrqAo5aBA+gApgBAkpwARSAAA2AAAFotKrqAo5aBB9AApgBAkpwARQAAA2AAAFotKrqAo5aBC7gApgBAkpwARQAAA2AAAFotKrqAo5aBD6AApgBAkpwAROAAA2AAAFotKrqAo5aBE4gApgBAkpwARMAAA2AAAFotKrqAH0O2dQEAAAAAAACU54K7gKOWgQAAAKYAQJKcAESgAANgAABaLSq6gKOWgQPoAKYAQJKcAESAAANgAABaLSq6gKOWgQfQAKYAwJKcAENgAANgAABaLSq6gKOWgQu4AKYAQJKcAERgAANgAABaLSq6gKOWgQ+gAKYAQJKcAERAAANgAABaLSq6gKOWgROIAKYAQJKcAEQgAANgAABaLSq6gB9DtnUBAAAAAAAAlOeC0vCjloEAAACmAECSnABEIAADYAAAWi0quoCjloED6ACmAECSnABEAAADYAAAWi0quoCjloEH0ACmAECSnABD4AADYAAAWi0quoCjloELuACmAECSnABDwAADYAAAWi0quoCjloEPoACmAECSnABDoAADYAAAWi0quoCjloETiACmAECSnABDgAADYAAAWi0quoAcU7trAQAAAAAAABG7j7OBALeK94EB8YIBd/CBAw=="),g.play())},this.release=function(){g.pause(),g.src=""}}function f(){var g=null;this.request=function(){g||(g=setInterval(function(){window.location.href="/",setTimeout(window.stop,0)},15e3))},this.release=function(){g&&(clearInterval(g),g=null)}}function m(){var g=navigator.userAgent||navigator.vendor||window.opera;return g.match(/iPhone/i)||g.match(/iPod/i)?f:p}l.exports=m()},"./node_modules/css-loader/dist/cjs.js!./src/style/aframe.css":(l,u,c)=>{c.r(u),c.d(u,{default:()=>O});var h=c("./node_modules/css-loader/dist/runtime/sourceMaps.js"),p=c.n(h),f=c("./node_modules/css-loader/dist/runtime/api.js"),m=c.n(f),g=c("./node_modules/css-loader/dist/runtime/getUrl.js"),y=c.n(g),x=new URL(c("data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z%27 fill=%27%23fff%27/%3E%3C/svg%3E"),c.b),v=new URL(c("data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z%27 fill=%27%23fff%27/%3E%3C/svg%3E"),c.b),_=new URL(c("data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27 standalone=%27no%27%3F%3E%3Csvg width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27 version=%271.1%27 id=%27svg320%27 sodipodi:docname=%27fullscreen-aframe.svg%27 xml:space=%27preserve%27 inkscape:version=%271.2.1 %289c6d41e  2022-07-14%29%27 xmlns:inkscape=%27http://www.inkscape.org/namespaces/inkscape%27 xmlns:sodipodi=%27http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:svg=%27http://www.w3.org/2000/svg%27 xmlns:rdf=%27http://www.w3.org/1999/02/22-rdf-syntax-ns%23%27 xmlns:cc=%27http://creativecommons.org/ns%23%27 xmlns:dc=%27http://purl.org/dc/elements/1.1/%27%3E%3Cdefs id=%27defs324%27 /%3E%3Csodipodi:namedview id=%27namedview322%27 pagecolor=%27%23ffffff%27 bordercolor=%27%23000000%27 borderopacity=%270.25%27 inkscape:showpageshadow=%272%27 inkscape:pageopacity=%270.0%27 inkscape:pagecheckerboard=%270%27 inkscape:deskcolor=%27%23d1d1d1%27 showgrid=%27false%27 inkscape:zoom=%273.8064516%27 inkscape:cx=%2791.423729%27 inkscape:cy=%27-1.4449153%27 inkscape:window-width=%271440%27 inkscape:window-height=%27847%27 inkscape:window-x=%2732%27 inkscape:window-y=%2725%27 inkscape:window-maximized=%270%27 inkscape:current-layer=%27svg320%27 /%3E%3Ctitle id=%27title312%27%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96 0H12A12 12 0 0 0 0 12V50A12 12 0 0 0 12 62H96a12 12 0 0 0 12-12V12A12 12 0 0 0 96 0Zm8 50a8 8 0 0 1-8 8H12a8 8 0 0 1-8-8V12a8 8 0 0 1 8-8H96a8 8 0 0 1 8 8Z%27 fill=%27%23fff%27 id=%27path314%27 style=%27fill:%23ffffff%27 /%3E%3Cg id=%27g356%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g358%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g360%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g362%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g364%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g366%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g368%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g370%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g372%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g374%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g376%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g378%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g380%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g382%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g384%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cmetadata id=%27metadata561%27%3E%3Crdf:RDF%3E%3Ccc:Work rdf:about=%27%27%3E%3Cdc:title%3Eaframe-armode-noborder-reduced-tracking%3C/dc:title%3E%3C/cc:Work%3E%3C/rdf:RDF%3E%3C/metadata%3E%3Cpath d=%27m 98.168511 40.083649 c 0 -1.303681 -0.998788 -2.358041 -2.239389 -2.358041 -1.230088 0.0031 -2.240892 1.05436 -2.240892 2.358041 v 4.881296 l -9.041661 -9.041662 c -0.874129 -0.875631 -2.288954 -0.875631 -3.16308 0 -0.874129 0.874126 -0.874129 2.293459 0 3.167585 l 8.995101 8.992101 h -4.858767 c -1.323206 0.0031 -2.389583 1.004796 -2.389583 2.239386 0 1.237598 1.066377 2.237888 2.389583 2.237888 h 10.154599 c 1.323206 0 2.388082 -0.998789 2.392587 -2.237888 -0.0044 -0.03305 -0.009 -0.05858 -0.0134 -0.09161 0.0046 -0.04207 0.0134 -0.08712 0.0134 -0.13066 V 40.085172 h -1.52e-4%27 id=%27path596%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 23.091002 35.921781 -9.026643 9.041662 v -4.881296 c 0 -1.303681 -1.009302 -2.355037 -2.242393 -2.358041 -1.237598 0 -2.237888 1.05436 -2.237888 2.358041 l -0.0031 10.016421 c 0 0.04356 0.01211 0.08862 0.0015 0.130659 -0.0031 0.03153 -0.009 0.05709 -0.01211 0.09161 0.0031 1.239099 1.069379 2.237888 2.391085 2.237888 h 10.156101 c 1.320202 0 2.388079 -1.000291 2.388079 -2.237888 0 -1.234591 -1.067877 -2.236383 -2.388079 -2.239387 h -4.858767 l 8.995101 -8.9921 c 0.871126 -0.874127 0.871126 -2.293459 0 -3.167586 -0.875628 -0.877132 -2.291957 -0.877132 -3.169087 -1.52e-4%27 id=%27path598%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 84.649572 25.978033 9.041662 -9.041664 v 4.881298 c 0 1.299176 1.010806 2.350532 2.240891 2.355037 1.240601 0 2.23939 -1.055861 2.23939 -2.355037 V 11.798242 c 0 -0.04356 -0.009 -0.08862 -0.0134 -0.127671 0.0044 -0.03153 0.009 -0.06157 0.0134 -0.09313 -0.0044 -1.240598 -1.069379 -2.2393873 -2.391085 -2.2393873 h -10.1546 c -1.323205 0 -2.38958 0.9987893 -2.38958 2.2393873 0 1.233091 1.066375 2.237887 2.38958 2.240891 h 4.858768 l -8.995102 8.9921 c -0.874129 0.872625 -0.874129 2.288954 0 3.161578 0.874127 0.880137 2.288951 0.880137 3.16308 1.5e-4%27 id=%27path600%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 17.264988 13.822853 h 4.857265 c 1.320202 -0.0031 2.388079 -1.0078 2.388079 -2.240889 0 -1.240601 -1.067877 -2.2393893 -2.388079 -2.2393893 H 11.967654 c -1.321707 0 -2.388082 0.9987883 -2.391085 2.2393893 0.0031 0.03153 0.009 0.06157 0.01211 0.09313 -0.0031 0.03905 -0.0015 0.08262 -0.0015 0.127671 l 0.0031 10.020926 c 0 1.299176 1.00029 2.355038 2.237887 2.355038 1.233092 -0.0044 2.242393 -1.055862 2.242393 -2.355038 v -4.881295 l 9.026644 9.041661 c 0.877132 0.878635 2.293459 0.878635 3.169087 0 0.871125 -0.872624 0.871125 -2.288953 0 -3.161577 l -8.995282 -8.993616%27 id=%27path602%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3C/svg%3E"),c.b),T=new URL(c("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E"),c.b),w=new URL(c("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E"),c.b),S=m()(p()),R=y()(x),B=y()(v),I=y()(_),D=y()(T),L=y()(w);S.push([l.id,`/* .a-fullscreen means not embedded. */
html.a-fullscreen {
  bottom: 0;
  left: 0;
  position: fixed;
  right: 0;
  top: 0;
}

html.a-fullscreen body {
  height: 100%;
  margin: 0;
  overflow: hidden;
  padding: 0;
  width: 100%;
}

/* Class is removed when doing <a-scene embedded>. */
html.a-fullscreen .a-canvas {
  width: 100% !important;
  height: 100% !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  position: fixed !important;
}

html:not(.a-fullscreen) .a-enter-vr,
html:not(.a-fullscreen) .a-enter-ar {
  right: 5px;
  bottom: 5px;
}

html:not(.a-fullscreen) .a-enter-ar {
  right: 60px;
}

/* In chrome mobile the user agent stylesheet set it to white  */
:-webkit-full-screen {
  background-color: transparent;
}

.a-hidden {
  display: none !important;
}

.a-canvas {
  height: 100%;
  left: 0;
  position: absolute;
  top: 0;
  width: 100%;
}

.a-canvas.a-grab-cursor:hover {
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}

canvas.a-canvas.a-mouse-cursor-hover:hover {
  cursor: pointer;
}

.a-inspector-loader {
  background-color: #ed3160;
  position: fixed;
  left: 3px;
  top: 3px;
  padding: 6px 10px;
  color: #fff;
  text-decoration: none;
  font-size: 12px;
  font-family: Roboto,sans-serif;
  text-align: center;
  z-index: 99999;
  width: 204px;
}

/* Inspector loader animation */
@keyframes dots-1 { from { opacity: 0; } 25% { opacity: 1; } }
@keyframes dots-2 { from { opacity: 0; } 50% { opacity: 1; } }
@keyframes dots-3 { from { opacity: 0; } 75% { opacity: 1; } }
@-webkit-keyframes dots-1 { from { opacity: 0; } 25% { opacity: 1; } }
@-webkit-keyframes dots-2 { from { opacity: 0; } 50% { opacity: 1; } }
@-webkit-keyframes dots-3 { from { opacity: 0; } 75% { opacity: 1; } }

.a-inspector-loader .dots span {
  animation: dots-1 2s infinite steps(1);
  -webkit-animation: dots-1 2s infinite steps(1);
}

.a-inspector-loader .dots span:first-child + span {
  animation-name: dots-2;
  -webkit-animation-name: dots-2;
}

.a-inspector-loader .dots span:first-child + span + span {
  animation-name: dots-3;
  -webkit-animation-name: dots-3;
}

a-scene {
  display: block;
  position: relative;
  height: 100%;
  width: 100%;
}

a-assets,
a-scene video,
a-scene img,
a-scene audio {
  display: none;
}

.a-enter-vr-modal,
.a-orientation-modal {
  font-family: Consolas, Andale Mono, Courier New, monospace;
}

.a-enter-vr-modal a {
  border-bottom: 1px solid #fff;
  padding: 2px 0;
  text-decoration: none;
  transition: .1s color ease-in;
}

.a-enter-vr-modal a:hover {
  background-color: #fff;
  color: #111;
  padding: 2px 4px;
  position: relative;
  left: -4px;
}

.a-enter-vr,
.a-enter-ar {
  font-family: sans-serif, monospace;
  font-size: 13px;
  width: 100%;
  font-weight: 200;
  line-height: 16px;
  position: absolute;
  right: 20px;
  bottom: 20px;
}

.a-enter-ar.xr {
  right: 90px;
}

.a-enter-vr-button,
.a-enter-vr-modal,
.a-enter-vr-modal a {
  color: #fff;
  user-select: none;
  outline: none;
}

.a-enter-vr-button {
  background: rgba(0, 0, 0, 0.35) url(`+R+`) 50% 50% no-repeat;
}

.a-enter-ar-button {
  background: rgba(0, 0, 0, 0.20) url(`+B+`) 50% 50% no-repeat;
}

.a-enter-vr.fullscreen .a-enter-vr-button {
  background-image: url(`+I+`);
}

.a-enter-vr-button,
.a-enter-ar-button {
  background-size: 90% 90%;
  border: 0;
  bottom: 0;
  cursor: pointer;
  min-width: 58px;
  min-height: 34px;
  /* 1.74418604651 */
  /*
    In order to keep the aspect ratio when resizing
    padding-top percentages are relative to the containing block's width.
    http://stackoverflow.com/questions/12121090/responsively-change-div-size-keeping-aspect-ratio
  */
  padding-right: 0;
  padding-top: 0;
  position: absolute;
  right: 0;
  transition: background-color .05s ease;
  -webkit-transition: background-color .05s ease;
  z-index: 9999;
  border-radius: 8px;
  touch-action: manipulation; /* Prevent iOS double tap zoom on the button */
}

.a-enter-ar-button {
  background-size: 100% 90%;
  border-radius: 7px;
}

.a-enter-ar-button:active,
.a-enter-ar-button:hover,
.a-enter-vr-button:active,
.a-enter-vr-button:hover {
  background-color: #ef2d5e;
}

.a-enter-vr-button.resethover {
  background-color: rgba(0, 0, 0, 0.35);
}

.a-enter-vr-modal {
  background-color: #666;
  border-radius: 0;
  display: none;
  min-height: 32px;
  margin-right: 70px;
  padding: 9px;
  width: 280px;
  right: 2%;
  position: absolute;
}

.a-enter-vr-modal:after {
  border-bottom: 10px solid transparent;
  border-left: 10px solid #666;
  border-top: 10px solid transparent;
  display: inline-block;
  content: '';
  position: absolute;
  right: -5px;
  top: 5px;
  width: 0;
  height: 0;
}

.a-enter-vr-modal p,
.a-enter-vr-modal a {
  display: inline;
}

.a-enter-vr-modal p {
  margin: 0;
}

.a-enter-vr-modal p:after {
  content: ' ';
}

.a-orientation-modal {
  background: rgba(244, 244, 244, 1) url(`+D+`) center no-repeat;
  background-size: 50% 50%;
  bottom: 0;
  font-size: 14px;
  font-weight: 600;
  left: 0;
  line-height: 20px;
  right: 0;
  position: fixed;
  top: 0;
  z-index: 9999999;
}

.a-orientation-modal:after {
  color: #666;
  content: "Insert phone into Cardboard holder.";
  display: block;
  position: absolute;
  text-align: center;
  top: 70%;
  transform: translateY(-70%);
  width: 100%;
}

.a-orientation-modal button {
  background: url(`+L+`) no-repeat;
  border: none;
  height: 50px;
  text-indent: -9999px;
  width: 50px;
}

.a-loader-title {
  background-color: rgba(0, 0, 0, 0.6);
  font-family: sans-serif, monospace;
  text-align: center;
  font-size: 20px;
  height: 50px;
  font-weight: 300;
  line-height: 50px;
  position: absolute;
  right: 0px;
  left: 0px;
  top: 0px;
  color: white;
}

.a-modal {
  position: absolute;
  background: rgba(0, 0, 0, 0.60);
  background-size: 50% 50%;
  bottom: 0;
  font-size: 14px;
  font-weight: 600;
  left: 0;
  line-height: 20px;
  right: 0;
  position: fixed;
  top: 0;
  z-index: 9999999;
}

.a-dialog {
  position: relative;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  z-index: 199995;
  width: 300px;
  height: 200px;
  background-size: contain;
  background-color: white;
  font-family: sans-serif, monospace;
  font-size: 20px;
  border-radius: 3px;
  padding: 6px;
}

.a-dialog-text-container {
  width: 100%;
  height: 70%;
  align-self: flex-start;
  display: flex;
  justify-content: center;
  align-content: center;
  flex-direction: column;
}

.a-dialog-text {
  display: inline-block;
  font-weight: normal;
  font-size: 14pt;
  margin: 8px;
}

.a-dialog-buttons-container {
  display: inline-flex;
  align-self: flex-end;
  width: 100%;
  height: 30%;
}

.a-dialog-button {
  cursor: pointer;
  align-self: center;
  opacity: 0.9;
  height: 80%;
  width: 50%;
  font-size: 12pt;
  margin: 4px;
  border-radius: 2px;
  text-align:center;
  border: none;
  display: inline-block;
  -webkit-transition: all 0.25s ease-in-out;
  transition: all 0.25s ease-in-out;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.10), 0 1px 2px rgba(0, 0, 0, 0.20);
  user-select: none;
}

.a-dialog-permission-button:hover {
  box-shadow: 0 7px 14px rgba(0,0,0,0.20), 0 2px 2px rgba(0,0,0,0.20);
}

.a-dialog-allow-button {
  background-color: #00ceff;
}

.a-dialog-deny-button {
  background-color: #ff005b;
}

.a-dialog-ok-button {
  background-color: #00ceff;
  width: 100%;
}

.a-dom-overlay:not(.a-no-style) {
  overflow: hidden;
  position: absolute;
  pointer-events: none;
  box-sizing: border-box;
  bottom: 0;
  left: 0;
  right: 0;
  top: 0;
  padding: 1em;
}

.a-dom-overlay:not(.a-no-style)>* {
  pointer-events: auto;
}
`,"",{version:3,sources:["webpack://./src/style/aframe.css"],names:[],mappings:"AAAA,sCAAsC;AACtC;EACE,SAAS;EACT,OAAO;EACP,eAAe;EACf,QAAQ;EACR,MAAM;AACR;;AAEA;EACE,YAAY;EACZ,SAAS;EACT,gBAAgB;EAChB,UAAU;EACV,WAAW;AACb;;AAEA,oDAAoD;AACpD;EACE,sBAAsB;EACtB,uBAAuB;EACvB,iBAAiB;EACjB,kBAAkB;EAClB,mBAAmB;EACnB,oBAAoB;EACpB,0BAA0B;AAC5B;;AAEA;;EAEE,UAAU;EACV,WAAW;AACb;;AAEA;EACE,WAAW;AACb;;AAEA,gEAAgE;AAChE;EACE,6BAA6B;AAC/B;;AAEA;EACE,wBAAwB;AAC1B;;AAEA;EACE,YAAY;EACZ,OAAO;EACP,kBAAkB;EAClB,MAAM;EACN,WAAW;AACb;;AAEA;EACE,YAAY;EACZ,iBAAiB;EACjB,oBAAoB;AACtB;;AAEA;EACE,eAAe;AACjB;;AAEA;EACE,yBAAyB;EACzB,eAAe;EACf,SAAS;EACT,QAAQ;EACR,iBAAiB;EACjB,WAAW;EACX,qBAAqB;EACrB,eAAe;EACf,8BAA8B;EAC9B,kBAAkB;EAClB,cAAc;EACd,YAAY;AACd;;AAEA,+BAA+B;AAC/B,oBAAoB,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AAC7D,oBAAoB,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AAC7D,oBAAoB,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AAC7D,4BAA4B,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AACrE,4BAA4B,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AACrE,4BAA4B,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;;AAErE;EACE,sCAAsC;EACtC,8CAA8C;AAChD;;AAEA;EACE,sBAAsB;EACtB,8BAA8B;AAChC;;AAEA;EACE,sBAAsB;EACtB,8BAA8B;AAChC;;AAEA;EACE,cAAc;EACd,kBAAkB;EAClB,YAAY;EACZ,WAAW;AACb;;AAEA;;;;EAIE,aAAa;AACf;;AAEA;;EAEE,0DAA0D;AAC5D;;AAEA;EACE,6BAA6B;EAC7B,cAAc;EACd,qBAAqB;EACrB,6BAA6B;AAC/B;;AAEA;EACE,sBAAsB;EACtB,WAAW;EACX,gBAAgB;EAChB,kBAAkB;EAClB,UAAU;AACZ;;AAEA;;EAEE,kCAAkC;EAClC,eAAe;EACf,WAAW;EACX,gBAAgB;EAChB,iBAAiB;EACjB,kBAAkB;EAClB,WAAW;EACX,YAAY;AACd;;AAEA;EACE,WAAW;AACb;;AAEA;;;EAGE,WAAW;EACX,iBAAiB;EACjB,aAAa;AACf;;AAEA;EACE,yFAA4qB;AAC9qB;;AAEA;EACE,yFAAkzB;AACpzB;;AAEA;EACE,yDAA2qK;AAC7qK;;AAEA;;EAEE,wBAAwB;EACxB,SAAS;EACT,SAAS;EACT,eAAe;EACf,eAAe;EACf,gBAAgB;EAChB,kBAAkB;EAClB;;;;GAIC;EACD,gBAAgB;EAChB,cAAc;EACd,kBAAkB;EAClB,QAAQ;EACR,sCAAsC;EACtC,8CAA8C;EAC9C,aAAa;EACb,kBAAkB;EAClB,0BAA0B,EAAE,8CAA8C;AAC5E;;AAEA;EACE,yBAAyB;EACzB,kBAAkB;AACpB;;AAEA;;;;EAIE,yBAAyB;AAC3B;;AAEA;EACE,qCAAqC;AACvC;;AAEA;EACE,sBAAsB;EACtB,gBAAgB;EAChB,aAAa;EACb,gBAAgB;EAChB,kBAAkB;EAClB,YAAY;EACZ,YAAY;EACZ,SAAS;EACT,kBAAkB;AACpB;;AAEA;EACE,qCAAqC;EACrC,4BAA4B;EAC5B,kCAAkC;EAClC,qBAAqB;EACrB,WAAW;EACX,kBAAkB;EAClB,WAAW;EACX,QAAQ;EACR,QAAQ;EACR,SAAS;AACX;;AAEA;;EAEE,eAAe;AACjB;;AAEA;EACE,SAAS;AACX;;AAEA;EACE,YAAY;AACd;;AAEA;EACE,2FAAivF;EACjvF,wBAAwB;EACxB,SAAS;EACT,eAAe;EACf,gBAAgB;EAChB,OAAO;EACP,iBAAiB;EACjB,QAAQ;EACR,eAAe;EACf,MAAM;EACN,gBAAgB;AAClB;;AAEA;EACE,WAAW;EACX,8CAA8C;EAC9C,cAAc;EACd,kBAAkB;EAClB,kBAAkB;EAClB,QAAQ;EACR,2BAA2B;EAC3B,WAAW;AACb;;AAEA;EACE,6DAA25B;EAC35B,YAAY;EACZ,YAAY;EACZ,oBAAoB;EACpB,WAAW;AACb;;AAEA;EACE,oCAAoC;EACpC,kCAAkC;EAClC,kBAAkB;EAClB,eAAe;EACf,YAAY;EACZ,gBAAgB;EAChB,iBAAiB;EACjB,kBAAkB;EAClB,UAAU;EACV,SAAS;EACT,QAAQ;EACR,YAAY;AACd;;AAEA;EACE,kBAAkB;EAClB,+BAA+B;EAC/B,wBAAwB;EACxB,SAAS;EACT,eAAe;EACf,gBAAgB;EAChB,OAAO;EACP,iBAAiB;EACjB,QAAQ;EACR,eAAe;EACf,MAAM;EACN,gBAAgB;AAClB;;AAEA;EACE,kBAAkB;EAClB,SAAS;EACT,QAAQ;EACR,gCAAgC;EAChC,eAAe;EACf,YAAY;EACZ,aAAa;EACb,wBAAwB;EACxB,uBAAuB;EACvB,kCAAkC;EAClC,eAAe;EACf,kBAAkB;EAClB,YAAY;AACd;;AAEA;EACE,WAAW;EACX,WAAW;EACX,sBAAsB;EACtB,aAAa;EACb,uBAAuB;EACvB,qBAAqB;EACrB,sBAAsB;AACxB;;AAEA;EACE,qBAAqB;EACrB,mBAAmB;EACnB,eAAe;EACf,WAAW;AACb;;AAEA;EACE,oBAAoB;EACpB,oBAAoB;EACpB,WAAW;EACX,WAAW;AACb;;AAEA;EACE,eAAe;EACf,kBAAkB;EAClB,YAAY;EACZ,WAAW;EACX,UAAU;EACV,eAAe;EACf,WAAW;EACX,kBAAkB;EAClB,iBAAiB;EACjB,YAAY;EACZ,qBAAqB;EACrB,yCAAyC;EACzC,iCAAiC;EACjC,wEAAwE;EACxE,iBAAiB;AACnB;;AAEA;EACE,mEAAmE;AACrE;;AAEA;EACE,yBAAyB;AAC3B;;AAEA;EACE,yBAAyB;AAC3B;;AAEA;EACE,yBAAyB;EACzB,WAAW;AACb;;AAEA;EACE,gBAAgB;EAChB,kBAAkB;EAClB,oBAAoB;EACpB,sBAAsB;EACtB,SAAS;EACT,OAAO;EACP,QAAQ;EACR,MAAM;EACN,YAAY;AACd;;AAEA;EACE,oBAAoB;AACtB",sourcesContent:[`/* .a-fullscreen means not embedded. */
html.a-fullscreen {
  bottom: 0;
  left: 0;
  position: fixed;
  right: 0;
  top: 0;
}

html.a-fullscreen body {
  height: 100%;
  margin: 0;
  overflow: hidden;
  padding: 0;
  width: 100%;
}

/* Class is removed when doing <a-scene embedded>. */
html.a-fullscreen .a-canvas {
  width: 100% !important;
  height: 100% !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  position: fixed !important;
}

html:not(.a-fullscreen) .a-enter-vr,
html:not(.a-fullscreen) .a-enter-ar {
  right: 5px;
  bottom: 5px;
}

html:not(.a-fullscreen) .a-enter-ar {
  right: 60px;
}

/* In chrome mobile the user agent stylesheet set it to white  */
:-webkit-full-screen {
  background-color: transparent;
}

.a-hidden {
  display: none !important;
}

.a-canvas {
  height: 100%;
  left: 0;
  position: absolute;
  top: 0;
  width: 100%;
}

.a-canvas.a-grab-cursor:hover {
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}

canvas.a-canvas.a-mouse-cursor-hover:hover {
  cursor: pointer;
}

.a-inspector-loader {
  background-color: #ed3160;
  position: fixed;
  left: 3px;
  top: 3px;
  padding: 6px 10px;
  color: #fff;
  text-decoration: none;
  font-size: 12px;
  font-family: Roboto,sans-serif;
  text-align: center;
  z-index: 99999;
  width: 204px;
}

/* Inspector loader animation */
@keyframes dots-1 { from { opacity: 0; } 25% { opacity: 1; } }
@keyframes dots-2 { from { opacity: 0; } 50% { opacity: 1; } }
@keyframes dots-3 { from { opacity: 0; } 75% { opacity: 1; } }
@-webkit-keyframes dots-1 { from { opacity: 0; } 25% { opacity: 1; } }
@-webkit-keyframes dots-2 { from { opacity: 0; } 50% { opacity: 1; } }
@-webkit-keyframes dots-3 { from { opacity: 0; } 75% { opacity: 1; } }

.a-inspector-loader .dots span {
  animation: dots-1 2s infinite steps(1);
  -webkit-animation: dots-1 2s infinite steps(1);
}

.a-inspector-loader .dots span:first-child + span {
  animation-name: dots-2;
  -webkit-animation-name: dots-2;
}

.a-inspector-loader .dots span:first-child + span + span {
  animation-name: dots-3;
  -webkit-animation-name: dots-3;
}

a-scene {
  display: block;
  position: relative;
  height: 100%;
  width: 100%;
}

a-assets,
a-scene video,
a-scene img,
a-scene audio {
  display: none;
}

.a-enter-vr-modal,
.a-orientation-modal {
  font-family: Consolas, Andale Mono, Courier New, monospace;
}

.a-enter-vr-modal a {
  border-bottom: 1px solid #fff;
  padding: 2px 0;
  text-decoration: none;
  transition: .1s color ease-in;
}

.a-enter-vr-modal a:hover {
  background-color: #fff;
  color: #111;
  padding: 2px 4px;
  position: relative;
  left: -4px;
}

.a-enter-vr,
.a-enter-ar {
  font-family: sans-serif, monospace;
  font-size: 13px;
  width: 100%;
  font-weight: 200;
  line-height: 16px;
  position: absolute;
  right: 20px;
  bottom: 20px;
}

.a-enter-ar.xr {
  right: 90px;
}

.a-enter-vr-button,
.a-enter-vr-modal,
.a-enter-vr-modal a {
  color: #fff;
  user-select: none;
  outline: none;
}

.a-enter-vr-button {
  background: rgba(0, 0, 0, 0.35) url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='108' height='62' viewBox='0 0 108 62'%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d='M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z' fill='%23fff'/%3E%3Cpath d='M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z' fill='%23fff'/%3E%3C/svg%3E") 50% 50% no-repeat;
}

.a-enter-ar-button {
  background: rgba(0, 0, 0, 0.20) url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='108' height='62' viewBox='0 0 108 62'%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d='M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z' fill='%23fff'/%3E%3Cpath d='M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z' fill='%23fff'/%3E%3Cpath d='M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z' fill='%23fff'/%3E%3C/svg%3E") 50% 50% no-repeat;
}

.a-enter-vr.fullscreen .a-enter-vr-button {
  background-image: url("data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8' standalone='no'%3F%3E%3Csvg width='108' height='62' viewBox='0 0 108 62' version='1.1' id='svg320' sodipodi:docname='fullscreen-aframe.svg' xml:space='preserve' inkscape:version='1.2.1 (9c6d41e  2022-07-14)' xmlns:inkscape='http://www.inkscape.org/namespaces/inkscape' xmlns:sodipodi='http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd' xmlns='http://www.w3.org/2000/svg' xmlns:svg='http://www.w3.org/2000/svg' xmlns:rdf='http://www.w3.org/1999/02/22-rdf-syntax-ns%23' xmlns:cc='http://creativecommons.org/ns%23' xmlns:dc='http://purl.org/dc/elements/1.1/'%3E%3Cdefs id='defs324' /%3E%3Csodipodi:namedview id='namedview322' pagecolor='%23ffffff' bordercolor='%23000000' borderopacity='0.25' inkscape:showpageshadow='2' inkscape:pageopacity='0.0' inkscape:pagecheckerboard='0' inkscape:deskcolor='%23d1d1d1' showgrid='false' inkscape:zoom='3.8064516' inkscape:cx='91.423729' inkscape:cy='-1.4449153' inkscape:window-width='1440' inkscape:window-height='847' inkscape:window-x='32' inkscape:window-y='25' inkscape:window-maximized='0' inkscape:current-layer='svg320' /%3E%3Ctitle id='title312'%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d='M96 0H12A12 12 0 0 0 0 12V50A12 12 0 0 0 12 62H96a12 12 0 0 0 12-12V12A12 12 0 0 0 96 0Zm8 50a8 8 0 0 1-8 8H12a8 8 0 0 1-8-8V12a8 8 0 0 1 8-8H96a8 8 0 0 1 8 8Z' fill='%23fff' id='path314' style='fill:%23ffffff' /%3E%3Cg id='g356' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g358' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g360' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g362' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g364' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g366' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g368' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g370' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g372' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g374' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g376' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g378' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g380' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g382' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g384' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cmetadata id='metadata561'%3E%3Crdf:RDF%3E%3Ccc:Work rdf:about=''%3E%3Cdc:title%3Eaframe-armode-noborder-reduced-tracking%3C/dc:title%3E%3C/cc:Work%3E%3C/rdf:RDF%3E%3C/metadata%3E%3Cpath d='m 98.168511 40.083649 c 0 -1.303681 -0.998788 -2.358041 -2.239389 -2.358041 -1.230088 0.0031 -2.240892 1.05436 -2.240892 2.358041 v 4.881296 l -9.041661 -9.041662 c -0.874129 -0.875631 -2.288954 -0.875631 -3.16308 0 -0.874129 0.874126 -0.874129 2.293459 0 3.167585 l 8.995101 8.992101 h -4.858767 c -1.323206 0.0031 -2.389583 1.004796 -2.389583 2.239386 0 1.237598 1.066377 2.237888 2.389583 2.237888 h 10.154599 c 1.323206 0 2.388082 -0.998789 2.392587 -2.237888 -0.0044 -0.03305 -0.009 -0.05858 -0.0134 -0.09161 0.0046 -0.04207 0.0134 -0.08712 0.0134 -0.13066 V 40.085172 h -1.52e-4' id='path596' style='fill:%23ffffff%3Bstroke-width:1.50194' /%3E%3Cpath d='m 23.091002 35.921781 -9.026643 9.041662 v -4.881296 c 0 -1.303681 -1.009302 -2.355037 -2.242393 -2.358041 -1.237598 0 -2.237888 1.05436 -2.237888 2.358041 l -0.0031 10.016421 c 0 0.04356 0.01211 0.08862 0.0015 0.130659 -0.0031 0.03153 -0.009 0.05709 -0.01211 0.09161 0.0031 1.239099 1.069379 2.237888 2.391085 2.237888 h 10.156101 c 1.320202 0 2.388079 -1.000291 2.388079 -2.237888 0 -1.234591 -1.067877 -2.236383 -2.388079 -2.239387 h -4.858767 l 8.995101 -8.9921 c 0.871126 -0.874127 0.871126 -2.293459 0 -3.167586 -0.875628 -0.877132 -2.291957 -0.877132 -3.169087 -1.52e-4' id='path598' style='fill:%23ffffff%3Bstroke-width:1.50194' /%3E%3Cpath d='m 84.649572 25.978033 9.041662 -9.041664 v 4.881298 c 0 1.299176 1.010806 2.350532 2.240891 2.355037 1.240601 0 2.23939 -1.055861 2.23939 -2.355037 V 11.798242 c 0 -0.04356 -0.009 -0.08862 -0.0134 -0.127671 0.0044 -0.03153 0.009 -0.06157 0.0134 -0.09313 -0.0044 -1.240598 -1.069379 -2.2393873 -2.391085 -2.2393873 h -10.1546 c -1.323205 0 -2.38958 0.9987893 -2.38958 2.2393873 0 1.233091 1.066375 2.237887 2.38958 2.240891 h 4.858768 l -8.995102 8.9921 c -0.874129 0.872625 -0.874129 2.288954 0 3.161578 0.874127 0.880137 2.288951 0.880137 3.16308 1.5e-4' id='path600' style='fill:%23ffffff%3Bstroke-width:1.50194' /%3E%3Cpath d='m 17.264988 13.822853 h 4.857265 c 1.320202 -0.0031 2.388079 -1.0078 2.388079 -2.240889 0 -1.240601 -1.067877 -2.2393893 -2.388079 -2.2393893 H 11.967654 c -1.321707 0 -2.388082 0.9987883 -2.391085 2.2393893 0.0031 0.03153 0.009 0.06157 0.01211 0.09313 -0.0031 0.03905 -0.0015 0.08262 -0.0015 0.127671 l 0.0031 10.020926 c 0 1.299176 1.00029 2.355038 2.237887 2.355038 1.233092 -0.0044 2.242393 -1.055862 2.242393 -2.355038 v -4.881295 l 9.026644 9.041661 c 0.877132 0.878635 2.293459 0.878635 3.169087 0 0.871125 -0.872624 0.871125 -2.288953 0 -3.161577 l -8.995282 -8.993616' id='path602' style='fill:%23ffffff%3Bstroke-width:1.50194' /%3E%3C/svg%3E");
}

.a-enter-vr-button,
.a-enter-ar-button {
  background-size: 90% 90%;
  border: 0;
  bottom: 0;
  cursor: pointer;
  min-width: 58px;
  min-height: 34px;
  /* 1.74418604651 */
  /*
    In order to keep the aspect ratio when resizing
    padding-top percentages are relative to the containing block's width.
    http://stackoverflow.com/questions/12121090/responsively-change-div-size-keeping-aspect-ratio
  */
  padding-right: 0;
  padding-top: 0;
  position: absolute;
  right: 0;
  transition: background-color .05s ease;
  -webkit-transition: background-color .05s ease;
  z-index: 9999;
  border-radius: 8px;
  touch-action: manipulation; /* Prevent iOS double tap zoom on the button */
}

.a-enter-ar-button {
  background-size: 100% 90%;
  border-radius: 7px;
}

.a-enter-ar-button:active,
.a-enter-ar-button:hover,
.a-enter-vr-button:active,
.a-enter-vr-button:hover {
  background-color: #ef2d5e;
}

.a-enter-vr-button.resethover {
  background-color: rgba(0, 0, 0, 0.35);
}

.a-enter-vr-modal {
  background-color: #666;
  border-radius: 0;
  display: none;
  min-height: 32px;
  margin-right: 70px;
  padding: 9px;
  width: 280px;
  right: 2%;
  position: absolute;
}

.a-enter-vr-modal:after {
  border-bottom: 10px solid transparent;
  border-left: 10px solid #666;
  border-top: 10px solid transparent;
  display: inline-block;
  content: '';
  position: absolute;
  right: -5px;
  top: 5px;
  width: 0;
  height: 0;
}

.a-enter-vr-modal p,
.a-enter-vr-modal a {
  display: inline;
}

.a-enter-vr-modal p {
  margin: 0;
}

.a-enter-vr-modal p:after {
  content: ' ';
}

.a-orientation-modal {
  background: rgba(244, 244, 244, 1) url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E) center no-repeat;
  background-size: 50% 50%;
  bottom: 0;
  font-size: 14px;
  font-weight: 600;
  left: 0;
  line-height: 20px;
  right: 0;
  position: fixed;
  top: 0;
  z-index: 9999999;
}

.a-orientation-modal:after {
  color: #666;
  content: "Insert phone into Cardboard holder.";
  display: block;
  position: absolute;
  text-align: center;
  top: 70%;
  transform: translateY(-70%);
  width: 100%;
}

.a-orientation-modal button {
  background: url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E) no-repeat;
  border: none;
  height: 50px;
  text-indent: -9999px;
  width: 50px;
}

.a-loader-title {
  background-color: rgba(0, 0, 0, 0.6);
  font-family: sans-serif, monospace;
  text-align: center;
  font-size: 20px;
  height: 50px;
  font-weight: 300;
  line-height: 50px;
  position: absolute;
  right: 0px;
  left: 0px;
  top: 0px;
  color: white;
}

.a-modal {
  position: absolute;
  background: rgba(0, 0, 0, 0.60);
  background-size: 50% 50%;
  bottom: 0;
  font-size: 14px;
  font-weight: 600;
  left: 0;
  line-height: 20px;
  right: 0;
  position: fixed;
  top: 0;
  z-index: 9999999;
}

.a-dialog {
  position: relative;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  z-index: 199995;
  width: 300px;
  height: 200px;
  background-size: contain;
  background-color: white;
  font-family: sans-serif, monospace;
  font-size: 20px;
  border-radius: 3px;
  padding: 6px;
}

.a-dialog-text-container {
  width: 100%;
  height: 70%;
  align-self: flex-start;
  display: flex;
  justify-content: center;
  align-content: center;
  flex-direction: column;
}

.a-dialog-text {
  display: inline-block;
  font-weight: normal;
  font-size: 14pt;
  margin: 8px;
}

.a-dialog-buttons-container {
  display: inline-flex;
  align-self: flex-end;
  width: 100%;
  height: 30%;
}

.a-dialog-button {
  cursor: pointer;
  align-self: center;
  opacity: 0.9;
  height: 80%;
  width: 50%;
  font-size: 12pt;
  margin: 4px;
  border-radius: 2px;
  text-align:center;
  border: none;
  display: inline-block;
  -webkit-transition: all 0.25s ease-in-out;
  transition: all 0.25s ease-in-out;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.10), 0 1px 2px rgba(0, 0, 0, 0.20);
  user-select: none;
}

.a-dialog-permission-button:hover {
  box-shadow: 0 7px 14px rgba(0,0,0,0.20), 0 2px 2px rgba(0,0,0,0.20);
}

.a-dialog-allow-button {
  background-color: #00ceff;
}

.a-dialog-deny-button {
  background-color: #ff005b;
}

.a-dialog-ok-button {
  background-color: #00ceff;
  width: 100%;
}

.a-dom-overlay:not(.a-no-style) {
  overflow: hidden;
  position: absolute;
  pointer-events: none;
  box-sizing: border-box;
  bottom: 0;
  left: 0;
  right: 0;
  top: 0;
  padding: 1em;
}

.a-dom-overlay:not(.a-no-style)>* {
  pointer-events: auto;
}
`],sourceRoot:""}]);const O=S},"./node_modules/css-loader/dist/cjs.js!./src/style/rStats.css":(l,u,c)=>{c.r(u),c.d(u,{default:()=>y});var h=c("./node_modules/css-loader/dist/runtime/sourceMaps.js"),p=c.n(h),f=c("./node_modules/css-loader/dist/runtime/api.js"),m=c.n(f),g=m()(p());g.push([l.id,`.rs-base {
  background-color: #333;
  color: #fafafa;
  border-radius: 0;
  font: 10px monospace;
  left: 5px;
  line-height: 1em;
  opacity: 0.85;
  overflow: hidden;
  padding: 10px;
  position: fixed;
  top: 5px;
  width: 300px;
  z-index: 10000;
}

.rs-base div.hidden {
  display: none;
}

.rs-base h1 {
  color: #fff;
  cursor: pointer;
  font-size: 1.4em;
  font-weight: 300;
  margin: 0 0 5px;
  padding: 0;
}

.rs-group {
  display: -webkit-box;
  display: -webkit-flex;
  display: flex;
  -webkit-flex-direction: column-reverse;
  flex-direction: column-reverse;
  margin-bottom: 5px;
}

.rs-group:last-child {
  margin-bottom: 0;
}

.rs-counter-base {
  align-items: center;
  display: -webkit-box;
  display: -webkit-flex;
  display: flex;
  height: 10px;
  -webkit-justify-content: space-between;
  justify-content: space-between;
  margin: 2px 0;
}

.rs-counter-base.alarm {
  color: #b70000;
  text-shadow: 0 0 0 #b70000,
               0 0 1px #fff,
               0 0 1px #fff,
               0 0 2px #fff,
               0 0 2px #fff,
               0 0 3px #fff,
               0 0 3px #fff,
               0 0 4px #fff,
               0 0 4px #fff;
}

.rs-counter-id {
  font-weight: 300;
  -webkit-box-ordinal-group: 0;
  -webkit-order: 0;
  order: 0;
  width: 54px;
}

.rs-counter-value {
  font-weight: 300;
  -webkit-box-ordinal-group: 1;
  -webkit-order: 1;
  order: 1;
  text-align: right;
  width: 35px;
}

.rs-canvas {
  -webkit-box-ordinal-group: 2;
  -webkit-order: 2;
  order: 2;
}

@media (min-width: 480px) {
  .rs-base {
    left: 20px;
    top: 20px;
  }
}
`,"",{version:3,sources:["webpack://./src/style/rStats.css"],names:[],mappings:"AAAA;EACE,sBAAsB;EACtB,cAAc;EACd,gBAAgB;EAChB,oBAAoB;EACpB,SAAS;EACT,gBAAgB;EAChB,aAAa;EACb,gBAAgB;EAChB,aAAa;EACb,eAAe;EACf,QAAQ;EACR,YAAY;EACZ,cAAc;AAChB;;AAEA;EACE,aAAa;AACf;;AAEA;EACE,WAAW;EACX,eAAe;EACf,gBAAgB;EAChB,gBAAgB;EAChB,eAAe;EACf,UAAU;AACZ;;AAEA;EACE,oBAAoB;EACpB,qBAAqB;EACrB,aAAa;EACb,sCAAsC;EACtC,8BAA8B;EAC9B,kBAAkB;AACpB;;AAEA;EACE,gBAAgB;AAClB;;AAEA;EACE,mBAAmB;EACnB,oBAAoB;EACpB,qBAAqB;EACrB,aAAa;EACb,YAAY;EACZ,sCAAsC;EACtC,8BAA8B;EAC9B,aAAa;AACf;;AAEA;EACE,cAAc;EACd;;;;;;;;2BAQyB;AAC3B;;AAEA;EACE,gBAAgB;EAChB,4BAA4B;EAC5B,gBAAgB;EAChB,QAAQ;EACR,WAAW;AACb;;AAEA;EACE,gBAAgB;EAChB,4BAA4B;EAC5B,gBAAgB;EAChB,QAAQ;EACR,iBAAiB;EACjB,WAAW;AACb;;AAEA;EACE,4BAA4B;EAC5B,gBAAgB;EAChB,QAAQ;AACV;;AAEA;EACE;IACE,UAAU;IACV,SAAS;EACX;AACF",sourcesContent:[`.rs-base {
  background-color: #333;
  color: #fafafa;
  border-radius: 0;
  font: 10px monospace;
  left: 5px;
  line-height: 1em;
  opacity: 0.85;
  overflow: hidden;
  padding: 10px;
  position: fixed;
  top: 5px;
  width: 300px;
  z-index: 10000;
}

.rs-base div.hidden {
  display: none;
}

.rs-base h1 {
  color: #fff;
  cursor: pointer;
  font-size: 1.4em;
  font-weight: 300;
  margin: 0 0 5px;
  padding: 0;
}

.rs-group {
  display: -webkit-box;
  display: -webkit-flex;
  display: flex;
  -webkit-flex-direction: column-reverse;
  flex-direction: column-reverse;
  margin-bottom: 5px;
}

.rs-group:last-child {
  margin-bottom: 0;
}

.rs-counter-base {
  align-items: center;
  display: -webkit-box;
  display: -webkit-flex;
  display: flex;
  height: 10px;
  -webkit-justify-content: space-between;
  justify-content: space-between;
  margin: 2px 0;
}

.rs-counter-base.alarm {
  color: #b70000;
  text-shadow: 0 0 0 #b70000,
               0 0 1px #fff,
               0 0 1px #fff,
               0 0 2px #fff,
               0 0 2px #fff,
               0 0 3px #fff,
               0 0 3px #fff,
               0 0 4px #fff,
               0 0 4px #fff;
}

.rs-counter-id {
  font-weight: 300;
  -webkit-box-ordinal-group: 0;
  -webkit-order: 0;
  order: 0;
  width: 54px;
}

.rs-counter-value {
  font-weight: 300;
  -webkit-box-ordinal-group: 1;
  -webkit-order: 1;
  order: 1;
  text-align: right;
  width: 35px;
}

.rs-canvas {
  -webkit-box-ordinal-group: 2;
  -webkit-order: 2;
  order: 2;
}

@media (min-width: 480px) {
  .rs-base {
    left: 20px;
    top: 20px;
  }
}
`],sourceRoot:""}]);const y=g},"./src/style/aframe.css":(l,u,c)=>{c.r(u),c.d(u,{default:()=>I});var h=c("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),p=c.n(h),f=c("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),m=c.n(f),g=c("./node_modules/style-loader/dist/runtime/insertBySelector.js"),y=c.n(g),x=c("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),v=c.n(x),_=c("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),T=c.n(_),w=c("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),S=c.n(w),R=c("./node_modules/css-loader/dist/cjs.js!./src/style/aframe.css"),B={};B.styleTagTransform=S(),B.setAttributes=v(),B.insert=y().bind(null,"head"),B.domAPI=m(),B.insertStyleElement=T(),p()(R.default,B);const I=R.default&&R.default.locals?R.default.locals:void 0},"./src/style/rStats.css":(l,u,c)=>{c.r(u),c.d(u,{default:()=>I});var h=c("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),p=c.n(h),f=c("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),m=c.n(f),g=c("./node_modules/style-loader/dist/runtime/insertBySelector.js"),y=c.n(g),x=c("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),v=c.n(x),_=c("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),T=c.n(_),w=c("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),S=c.n(w),R=c("./node_modules/css-loader/dist/cjs.js!./src/style/rStats.css"),B={};B.styleTagTransform=S(),B.setAttributes=v(),B.insert=y().bind(null,"head"),B.domAPI=m(),B.insertStyleElement=T(),p()(R.default,B);const I=R.default&&R.default.locals?R.default.locals:void 0},"./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js":l=>{var u=[];function c(f){for(var m=-1,g=0;g<u.length;g++)if(u[g].identifier===f){m=g;break}return m}function h(f,m){for(var g={},y=[],x=0;x<f.length;x++){var v=f[x],_=m.base?v[0]+m.base:v[0],T=g[_]||0,w="".concat(_," ").concat(T);g[_]=T+1;var S=c(w),R={css:v[1],media:v[2],sourceMap:v[3],supports:v[4],layer:v[5]};if(S!==-1)u[S].references++,u[S].updater(R);else{var B=p(R,m);m.byIndex=x,u.splice(x,0,{identifier:w,updater:B,references:1})}y.push(w)}return y}function p(f,m){var g=m.domAPI(m);g.update(f);var y=function(x){if(x){if(x.css===f.css&&x.media===f.media&&x.sourceMap===f.sourceMap&&x.supports===f.supports&&x.layer===f.layer)return;g.update(f=x)}else g.remove()};return y}l.exports=function(f,m){m=m||{},f=f||[];var g=h(f,m);return function(y){y=y||[];for(var x=0;x<g.length;x++){var v=g[x],_=c(v);u[_].references--}for(var T=h(y,m),w=0;w<g.length;w++){var S=g[w],R=c(S);u[R].references===0&&(u[R].updater(),u.splice(R,1))}g=T}}},"./node_modules/style-loader/dist/runtime/insertBySelector.js":l=>{var u={};function c(p){if(typeof u[p]>"u"){var f=document.querySelector(p);if(window.HTMLIFrameElement&&f instanceof window.HTMLIFrameElement)try{f=f.contentDocument.head}catch{f=null}u[p]=f}return u[p]}function h(p,f){var m=c(p);if(!m)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");m.appendChild(f)}l.exports=h},"./node_modules/style-loader/dist/runtime/insertStyleElement.js":l=>{function u(c){var h=document.createElement("style");return c.setAttributes(h,c.attributes),c.insert(h,c.options),h}l.exports=u},"./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js":(l,u,c)=>{function h(p){var f=c.nc;f&&p.setAttribute("nonce",f)}l.exports=h},"./node_modules/style-loader/dist/runtime/styleDomAPI.js":l=>{function u(p,f,m){var g="";m.supports&&(g+="@supports (".concat(m.supports,") {")),m.media&&(g+="@media ".concat(m.media," {"));var y=typeof m.layer<"u";y&&(g+="@layer".concat(m.layer.length>0?" ".concat(m.layer):""," {")),g+=m.css,y&&(g+="}"),m.media&&(g+="}"),m.supports&&(g+="}");var x=m.sourceMap;x&&typeof btoa<"u"&&(g+=`
/*# sourceMappingURL=data:application/json;base64,`.concat(btoa(unescape(encodeURIComponent(JSON.stringify(x))))," */")),f.styleTagTransform(g,p,f.options)}function c(p){if(p.parentNode===null)return!1;p.parentNode.removeChild(p)}function h(p){if(typeof document>"u")return{update:function(){},remove:function(){}};var f=p.insertStyleElement(p);return{update:function(m){u(f,p,m)},remove:function(){c(f)}}}l.exports=h},"./node_modules/style-loader/dist/runtime/styleTagTransform.js":l=>{function u(c,h){if(h.styleSheet)h.styleSheet.cssText=c;else{for(;h.firstChild;)h.removeChild(h.firstChild);h.appendChild(document.createTextNode(c))}}l.exports=u},"data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27 standalone=%27no%27%3F%3E%3Csvg width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27 version=%271.1%27 id=%27svg320%27 sodipodi:docname=%27fullscreen-aframe.svg%27 xml:space=%27preserve%27 inkscape:version=%271.2.1 %289c6d41e  2022-07-14%29%27 xmlns:inkscape=%27http://www.inkscape.org/namespaces/inkscape%27 xmlns:sodipodi=%27http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:svg=%27http://www.w3.org/2000/svg%27 xmlns:rdf=%27http://www.w3.org/1999/02/22-rdf-syntax-ns%23%27 xmlns:cc=%27http://creativecommons.org/ns%23%27 xmlns:dc=%27http://purl.org/dc/elements/1.1/%27%3E%3Cdefs id=%27defs324%27 /%3E%3Csodipodi:namedview id=%27namedview322%27 pagecolor=%27%23ffffff%27 bordercolor=%27%23000000%27 borderopacity=%270.25%27 inkscape:showpageshadow=%272%27 inkscape:pageopacity=%270.0%27 inkscape:pagecheckerboard=%270%27 inkscape:deskcolor=%27%23d1d1d1%27 showgrid=%27false%27 inkscape:zoom=%273.8064516%27 inkscape:cx=%2791.423729%27 inkscape:cy=%27-1.4449153%27 inkscape:window-width=%271440%27 inkscape:window-height=%27847%27 inkscape:window-x=%2732%27 inkscape:window-y=%2725%27 inkscape:window-maximized=%270%27 inkscape:current-layer=%27svg320%27 /%3E%3Ctitle id=%27title312%27%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96 0H12A12 12 0 0 0 0 12V50A12 12 0 0 0 12 62H96a12 12 0 0 0 12-12V12A12 12 0 0 0 96 0Zm8 50a8 8 0 0 1-8 8H12a8 8 0 0 1-8-8V12a8 8 0 0 1 8-8H96a8 8 0 0 1 8 8Z%27 fill=%27%23fff%27 id=%27path314%27 style=%27fill:%23ffffff%27 /%3E%3Cg id=%27g356%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g358%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g360%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g362%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g364%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g366%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g368%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g370%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g372%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g374%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g376%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g378%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g380%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g382%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g384%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cmetadata id=%27metadata561%27%3E%3Crdf:RDF%3E%3Ccc:Work rdf:about=%27%27%3E%3Cdc:title%3Eaframe-armode-noborder-reduced-tracking%3C/dc:title%3E%3C/cc:Work%3E%3C/rdf:RDF%3E%3C/metadata%3E%3Cpath d=%27m 98.168511 40.083649 c 0 -1.303681 -0.998788 -2.358041 -2.239389 -2.358041 -1.230088 0.0031 -2.240892 1.05436 -2.240892 2.358041 v 4.881296 l -9.041661 -9.041662 c -0.874129 -0.875631 -2.288954 -0.875631 -3.16308 0 -0.874129 0.874126 -0.874129 2.293459 0 3.167585 l 8.995101 8.992101 h -4.858767 c -1.323206 0.0031 -2.389583 1.004796 -2.389583 2.239386 0 1.237598 1.066377 2.237888 2.389583 2.237888 h 10.154599 c 1.323206 0 2.388082 -0.998789 2.392587 -2.237888 -0.0044 -0.03305 -0.009 -0.05858 -0.0134 -0.09161 0.0046 -0.04207 0.0134 -0.08712 0.0134 -0.13066 V 40.085172 h -1.52e-4%27 id=%27path596%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 23.091002 35.921781 -9.026643 9.041662 v -4.881296 c 0 -1.303681 -1.009302 -2.355037 -2.242393 -2.358041 -1.237598 0 -2.237888 1.05436 -2.237888 2.358041 l -0.0031 10.016421 c 0 0.04356 0.01211 0.08862 0.0015 0.130659 -0.0031 0.03153 -0.009 0.05709 -0.01211 0.09161 0.0031 1.239099 1.069379 2.237888 2.391085 2.237888 h 10.156101 c 1.320202 0 2.388079 -1.000291 2.388079 -2.237888 0 -1.234591 -1.067877 -2.236383 -2.388079 -2.239387 h -4.858767 l 8.995101 -8.9921 c 0.871126 -0.874127 0.871126 -2.293459 0 -3.167586 -0.875628 -0.877132 -2.291957 -0.877132 -3.169087 -1.52e-4%27 id=%27path598%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 84.649572 25.978033 9.041662 -9.041664 v 4.881298 c 0 1.299176 1.010806 2.350532 2.240891 2.355037 1.240601 0 2.23939 -1.055861 2.23939 -2.355037 V 11.798242 c 0 -0.04356 -0.009 -0.08862 -0.0134 -0.127671 0.0044 -0.03153 0.009 -0.06157 0.0134 -0.09313 -0.0044 -1.240598 -1.069379 -2.2393873 -2.391085 -2.2393873 h -10.1546 c -1.323205 0 -2.38958 0.9987893 -2.38958 2.2393873 0 1.233091 1.066375 2.237887 2.38958 2.240891 h 4.858768 l -8.995102 8.9921 c -0.874129 0.872625 -0.874129 2.288954 0 3.161578 0.874127 0.880137 2.288951 0.880137 3.16308 1.5e-4%27 id=%27path600%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 17.264988 13.822853 h 4.857265 c 1.320202 -0.0031 2.388079 -1.0078 2.388079 -2.240889 0 -1.240601 -1.067877 -2.2393893 -2.388079 -2.2393893 H 11.967654 c -1.321707 0 -2.388082 0.9987883 -2.391085 2.2393893 0.0031 0.03153 0.009 0.06157 0.01211 0.09313 -0.0031 0.03905 -0.0015 0.08262 -0.0015 0.127671 l 0.0031 10.020926 c 0 1.299176 1.00029 2.355038 2.237887 2.355038 1.233092 -0.0044 2.242393 -1.055862 2.242393 -2.355038 v -4.881295 l 9.026644 9.041661 c 0.877132 0.878635 2.293459 0.878635 3.169087 0 0.871125 -0.872624 0.871125 -2.288953 0 -3.161577 l -8.995282 -8.993616%27 id=%27path602%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3C/svg%3E":l=>{l.exports="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27 standalone=%27no%27%3F%3E%3Csvg width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27 version=%271.1%27 id=%27svg320%27 sodipodi:docname=%27fullscreen-aframe.svg%27 xml:space=%27preserve%27 inkscape:version=%271.2.1 %289c6d41e  2022-07-14%29%27 xmlns:inkscape=%27http://www.inkscape.org/namespaces/inkscape%27 xmlns:sodipodi=%27http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:svg=%27http://www.w3.org/2000/svg%27 xmlns:rdf=%27http://www.w3.org/1999/02/22-rdf-syntax-ns%23%27 xmlns:cc=%27http://creativecommons.org/ns%23%27 xmlns:dc=%27http://purl.org/dc/elements/1.1/%27%3E%3Cdefs id=%27defs324%27 /%3E%3Csodipodi:namedview id=%27namedview322%27 pagecolor=%27%23ffffff%27 bordercolor=%27%23000000%27 borderopacity=%270.25%27 inkscape:showpageshadow=%272%27 inkscape:pageopacity=%270.0%27 inkscape:pagecheckerboard=%270%27 inkscape:deskcolor=%27%23d1d1d1%27 showgrid=%27false%27 inkscape:zoom=%273.8064516%27 inkscape:cx=%2791.423729%27 inkscape:cy=%27-1.4449153%27 inkscape:window-width=%271440%27 inkscape:window-height=%27847%27 inkscape:window-x=%2732%27 inkscape:window-y=%2725%27 inkscape:window-maximized=%270%27 inkscape:current-layer=%27svg320%27 /%3E%3Ctitle id=%27title312%27%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96 0H12A12 12 0 0 0 0 12V50A12 12 0 0 0 12 62H96a12 12 0 0 0 12-12V12A12 12 0 0 0 96 0Zm8 50a8 8 0 0 1-8 8H12a8 8 0 0 1-8-8V12a8 8 0 0 1 8-8H96a8 8 0 0 1 8 8Z%27 fill=%27%23fff%27 id=%27path314%27 style=%27fill:%23ffffff%27 /%3E%3Cg id=%27g356%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g358%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g360%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g362%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g364%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g366%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g368%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g370%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g372%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g374%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g376%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g378%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g380%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g382%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g384%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cmetadata id=%27metadata561%27%3E%3Crdf:RDF%3E%3Ccc:Work rdf:about=%27%27%3E%3Cdc:title%3Eaframe-armode-noborder-reduced-tracking%3C/dc:title%3E%3C/cc:Work%3E%3C/rdf:RDF%3E%3C/metadata%3E%3Cpath d=%27m 98.168511 40.083649 c 0 -1.303681 -0.998788 -2.358041 -2.239389 -2.358041 -1.230088 0.0031 -2.240892 1.05436 -2.240892 2.358041 v 4.881296 l -9.041661 -9.041662 c -0.874129 -0.875631 -2.288954 -0.875631 -3.16308 0 -0.874129 0.874126 -0.874129 2.293459 0 3.167585 l 8.995101 8.992101 h -4.858767 c -1.323206 0.0031 -2.389583 1.004796 -2.389583 2.239386 0 1.237598 1.066377 2.237888 2.389583 2.237888 h 10.154599 c 1.323206 0 2.388082 -0.998789 2.392587 -2.237888 -0.0044 -0.03305 -0.009 -0.05858 -0.0134 -0.09161 0.0046 -0.04207 0.0134 -0.08712 0.0134 -0.13066 V 40.085172 h -1.52e-4%27 id=%27path596%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 23.091002 35.921781 -9.026643 9.041662 v -4.881296 c 0 -1.303681 -1.009302 -2.355037 -2.242393 -2.358041 -1.237598 0 -2.237888 1.05436 -2.237888 2.358041 l -0.0031 10.016421 c 0 0.04356 0.01211 0.08862 0.0015 0.130659 -0.0031 0.03153 -0.009 0.05709 -0.01211 0.09161 0.0031 1.239099 1.069379 2.237888 2.391085 2.237888 h 10.156101 c 1.320202 0 2.388079 -1.000291 2.388079 -2.237888 0 -1.234591 -1.067877 -2.236383 -2.388079 -2.239387 h -4.858767 l 8.995101 -8.9921 c 0.871126 -0.874127 0.871126 -2.293459 0 -3.167586 -0.875628 -0.877132 -2.291957 -0.877132 -3.169087 -1.52e-4%27 id=%27path598%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 84.649572 25.978033 9.041662 -9.041664 v 4.881298 c 0 1.299176 1.010806 2.350532 2.240891 2.355037 1.240601 0 2.23939 -1.055861 2.23939 -2.355037 V 11.798242 c 0 -0.04356 -0.009 -0.08862 -0.0134 -0.127671 0.0044 -0.03153 0.009 -0.06157 0.0134 -0.09313 -0.0044 -1.240598 -1.069379 -2.2393873 -2.391085 -2.2393873 h -10.1546 c -1.323205 0 -2.38958 0.9987893 -2.38958 2.2393873 0 1.233091 1.066375 2.237887 2.38958 2.240891 h 4.858768 l -8.995102 8.9921 c -0.874129 0.872625 -0.874129 2.288954 0 3.161578 0.874127 0.880137 2.288951 0.880137 3.16308 1.5e-4%27 id=%27path600%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 17.264988 13.822853 h 4.857265 c 1.320202 -0.0031 2.388079 -1.0078 2.388079 -2.240889 0 -1.240601 -1.067877 -2.2393893 -2.388079 -2.2393893 H 11.967654 c -1.321707 0 -2.388082 0.9987883 -2.391085 2.2393893 0.0031 0.03153 0.009 0.06157 0.01211 0.09313 -0.0031 0.03905 -0.0015 0.08262 -0.0015 0.127671 l 0.0031 10.020926 c 0 1.299176 1.00029 2.355038 2.237887 2.355038 1.233092 -0.0044 2.242393 -1.055862 2.242393 -2.355038 v -4.881295 l 9.026644 9.041661 c 0.877132 0.878635 2.293459 0.878635 3.169087 0 0.871125 -0.872624 0.871125 -2.288953 0 -3.161577 l -8.995282 -8.993616%27 id=%27path602%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3C/svg%3E"},"data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z%27 fill=%27%23fff%27/%3E%3C/svg%3E":l=>{l.exports="data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z%27 fill=%27%23fff%27/%3E%3C/svg%3E"},"data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z%27 fill=%27%23fff%27/%3E%3C/svg%3E":l=>{l.exports="data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z%27 fill=%27%23fff%27/%3E%3C/svg%3E"},"data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E":l=>{l.exports="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E"},"data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E":l=>{l.exports="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E"},"./node_modules/three/build/three.module.js":(l,u,c)=>{c.r(u),c.d(u,{ACESFilmicToneMapping:()=>vt,AddEquation:()=>G,AddOperation:()=>yt,AdditiveAnimationBlendMode:()=>Or,AdditiveBlending:()=>L,AgXToneMapping:()=>ve,AlphaFormat:()=>Be,AlwaysCompare:()=>CE,AlwaysDepth:()=>Ze,AlwaysStencilFunc:()=>lv,AmbientLight:()=>vG,AnimationAction:()=>OG,AnimationClip:()=>jv,AnimationLoader:()=>m3e,AnimationMixer:()=>H3e,AnimationObjectGroup:()=>V3e,AnimationUtils:()=>h3e,ArcCurve:()=>OV,ArrayCamera:()=>AN,ArrowHelper:()=>dRe,AttachedBindMode:()=>Te,Audio:()=>NG,AudioAnalyser:()=>N3e,AudioContext:()=>JN,AudioListener:()=>R3e,AudioLoader:()=>S3e,AxesHelper:()=>pRe,BackSide:()=>R,BasicDepthPacking:()=>$c,BasicShadowMap:()=>v,BatchedMesh:()=>SV,Bone:()=>EN,BooleanKeyframeTrack:()=>Tf,Box2:()=>Z3e,Box3:()=>Ds,Box3Helper:()=>uRe,BoxGeometry:()=>mf,BoxHelper:()=>cRe,BufferAttribute:()=>ls,BufferGeometry:()=>fn,BufferGeometryLoader:()=>wG,ByteType:()=>Ls,Cache:()=>wh,Camera:()=>XE,CameraHelper:()=>lRe,CanvasTexture:()=>OMe,CapsuleGeometry:()=>Ew,CatmullRomCurve3:()=>PV,CineonToneMapping:()=>_i,CircleGeometry:()=>ww,ClampToEdgeWrapping:()=>je,Clock:()=>RG,Color:()=>lr,ColorKeyframeTrack:()=>WN,ColorManagement:()=>Zn,CompressedArrayTexture:()=>LMe,CompressedCubeTexture:()=>DMe,CompressedTexture:()=>vw,CompressedTextureLoader:()=>g3e,ConeGeometry:()=>Cw,ConstantAlphaFactor:()=>Gt,ConstantColorFactor:()=>lt,CubeCamera:()=>Mj,CubeReflectionMapping:()=>F,CubeRefractionMapping:()=>J,CubeTexture:()=>vv,CubeTextureLoader:()=>A3e,CubeUVReflectionMapping:()=>ce,CubicBezierCurve:()=>LN,CubicBezierCurve3:()=>FV,CubicInterpolant:()=>lG,CullFaceBack:()=>g,CullFaceFront:()=>y,CullFaceFrontBack:()=>x,CullFaceNone:()=>m,Curve:()=>Dc,CurvePath:()=>zV,CustomBlending:()=>Z,CustomToneMapping:()=>ye,CylinderGeometry:()=>R0,Cylindrical:()=>J3e,Data3DTexture:()=>Jr,DataArrayTexture:()=>i0,DataTexture:()=>jd,DataTextureLoader:()=>y3e,DataUtils:()=>l2e,DecrementStencilOp:()=>lB,DecrementWrapStencilOp:()=>uB,DefaultLoadingManager:()=>hG,DepthFormat:()=>Ke,DepthStencilFormat:()=>ot,DepthTexture:()=>dN,DetachedBindMode:()=>ke,DirectionalLight:()=>yG,DirectionalLightHelper:()=>oRe,DiscreteInterpolant:()=>cG,DisplayP3ColorSpace:()=>Zg,DodecahedronGeometry:()=>Sw,DoubleSide:()=>B,DstAlphaFactor:()=>de,DstColorFactor:()=>Ge,DynamicCopyUsage:()=>CB,DynamicDrawUsage:()=>vB,DynamicReadUsage:()=>_B,EdgesGeometry:()=>jV,EllipseCurve:()=>xw,EqualCompare:()=>bE,EqualDepth:()=>Ii,EqualStencilFunc:()=>fB,EquirectangularReflectionMapping:()=>ie,EquirectangularRefractionMapping:()=>Re,Euler:()=>Sl,EventDispatcher:()=>Io,ExtrudeGeometry:()=>Lw,FileLoader:()=>Sh,Float16BufferAttribute:()=>f2e,Float32BufferAttribute:()=>br,FloatType:()=>St,Fog:()=>iw,FogExp2:()=>tw,FramebufferTexture:()=>NMe,FrontSide:()=>S,Frustum:()=>xv,GLBufferAttribute:()=>X3e,GLSL1:()=>TB,GLSL3:()=>uv,GreaterCompare:()=>_E,GreaterDepth:()=>ir,GreaterEqualCompare:()=>wE,GreaterEqualDepth:()=>Ti,GreaterEqualStencilFunc:()=>yB,GreaterStencilFunc:()=>gB,GridHelper:()=>sRe,Group:()=>xf,HalfFloatType:()=>Xt,HemisphereLight:()=>dG,HemisphereLightHelper:()=>nRe,IcosahedronGeometry:()=>Dw,ImageBitmapLoader:()=>C3e,ImageLoader:()=>Vv,ImageUtils:()=>Dd,IncrementStencilOp:()=>oB,IncrementWrapStencilOp:()=>cB,InstancedBufferAttribute:()=>S0,InstancedBufferGeometry:()=>EG,InstancedInterleavedBuffer:()=>q3e,InstancedMesh:()=>EV,Int16BufferAttribute:()=>d2e,Int32BufferAttribute:()=>p2e,Int8BufferAttribute:()=>c2e,IntType:()=>me,InterleavedBuffer:()=>rw,InterleavedBufferAttribute:()=>_f,Interpolant:()=>Fv,InterpolateDiscrete:()=>Cr,InterpolateLinear:()=>Mr,InterpolateSmooth:()=>zr,InvertStencilOp:()=>hB,KeepStencilOp:()=>mh,KeyframeTrack:()=>Oc,LOD:()=>pV,LatheGeometry:()=>Nv,Layers:()=>PE,LessCompare:()=>xE,LessDepth:()=>Ui,LessEqualCompare:()=>cv,LessEqualDepth:()=>di,LessEqualStencilFunc:()=>mB,LessStencilFunc:()=>pB,Light:()=>Wd,LightProbe:()=>_G,Line:()=>Gd,Line3:()=>$3e,LineBasicMaterial:()=>Oo,LineCurve:()=>DN,LineCurve3:()=>UV,LineDashedMaterial:()=>sG,LineLoop:()=>BV,LineSegments:()=>nu,LinearDisplayP3ColorSpace:()=>af,LinearFilter:()=>ki,LinearInterpolant:()=>HN,LinearMipMapLinearFilter:()=>xs,LinearMipMapNearestFilter:()=>Ur,LinearMipmapLinearFilter:()=>sn,LinearMipmapNearestFilter:()=>An,LinearSRGBColorSpace:()=>Ic,LinearToneMapping:()=>Jt,LinearTransfer:()=>of,Loader:()=>nl,LoaderUtils:()=>KN,LoadingManager:()=>QN,LoopOnce:()=>pr,LoopPingPong:()=>Wi,LoopRepeat:()=>fr,LuminanceAlphaFormat:()=>Fe,LuminanceFormat:()=>Ne,MOUSE:()=>p,Material:()=>po,MaterialLoader:()=>jw,MathUtils:()=>HB,Matrix3:()=>Kr,Matrix4:()=>mr,MaxEquation:()=>H,Mesh:()=>ua,MeshBasicMaterial:()=>Fd,MeshDepthMaterial:()=>mN,MeshDistanceMaterial:()=>gN,MeshLambertMaterial:()=>rG,MeshMatcapMaterial:()=>nG,MeshNormalMaterial:()=>iG,MeshPhongMaterial:()=>eG,MeshPhysicalMaterial:()=>$V,MeshStandardMaterial:()=>jN,MeshToonMaterial:()=>tG,MinEquation:()=>Q,MirroredRepeatWrapping:()=>dt,MixOperation:()=>Ce,MultiplyBlending:()=>U,MultiplyOperation:()=>Qe,NearestFilter:()=>It,NearestMipMapLinearFilter:()=>Er,NearestMipMapNearestFilter:()=>Ut,NearestMipmapLinearFilter:()=>pi,NearestMipmapNearestFilter:()=>bt,NeutralToneMapping:()=>Le,NeverCompare:()=>vE,NeverDepth:()=>xi,NeverStencilFunc:()=>dB,NoBlending:()=>I,NoColorSpace:()=>Xa,NoToneMapping:()=>Ot,NormalAnimationBlendMode:()=>ps,NormalBlending:()=>D,NotEqualCompare:()=>EE,NotEqualDepth:()=>Gi,NotEqualStencilFunc:()=>AB,NumberKeyframeTrack:()=>Uv,Object3D:()=>Qn,ObjectLoader:()=>E3e,ObjectSpaceNormalMap:()=>tu,OctahedronGeometry:()=>Pv,OneFactor:()=>ne,OneMinusConstantAlphaFactor:()=>gt,OneMinusConstantColorFactor:()=>At,OneMinusDstAlphaFactor:()=>Ie,OneMinusDstColorFactor:()=>Xe,OneMinusSrcAlphaFactor:()=>fe,OneMinusSrcColorFactor:()=>ae,OrthographicCamera:()=>JE,P3Primaries:()=>cf,PCFShadowMap:()=>_,PCFSoftShadowMap:()=>T,PMREMGenerator:()=>uN,Path:()=>Bv,PerspectiveCamera:()=>xa,Plane:()=>zd,PlaneGeometry:()=>y0,PlaneHelper:()=>hRe,PointLight:()=>AG,PointLightHelper:()=>iRe,Points:()=>LV,PointsMaterial:()=>TN,PolarGridHelper:()=>aRe,PolyhedronGeometry:()=>Hd,PositionalAudio:()=>B3e,PropertyBinding:()=>Vn,PropertyMixer:()=>DG,QuadraticBezierCurve:()=>ON,QuadraticBezierCurve3:()=>PN,Quaternion:()=>Wn,QuaternionKeyframeTrack:()=>B0,QuaternionLinearInterpolant:()=>uG,RED_GREEN_RGTC2_Format:()=>Ni,RED_RGTC1_Format:()=>Ai,REVISION:()=>h,RGBADepthPacking:()=>eu,RGBAFormat:()=>ge,RGBAIntegerFormat:()=>ti,RGBA_ASTC_10x10_Format:()=>be,RGBA_ASTC_10x5_Format:()=>he,RGBA_ASTC_10x6_Format:()=>le,RGBA_ASTC_10x8_Format:()=>pe,RGBA_ASTC_12x10_Format:()=>Ee,RGBA_ASTC_12x12_Format:()=>st,RGBA_ASTC_4x4_Format:()=>Yr,RGBA_ASTC_5x4_Format:()=>W,RGBA_ASTC_5x5_Format:()=>ue,RGBA_ASTC_6x5_Format:()=>Ae,RGBA_ASTC_6x6_Format:()=>Se,RGBA_ASTC_8x5_Format:()=>We,RGBA_ASTC_8x6_Format:()=>Ye,RGBA_ASTC_8x8_Format:()=>ft,RGBA_BPTC_Format:()=>Ct,RGBA_ETC2_EAC_Format:()=>pn,RGBA_PVRTC_2BPPV1_Format:()=>Jn,RGBA_PVRTC_4BPPV1_Format:()=>Bn,RGBA_S3TC_DXT1_Format:()=>Fi,RGBA_S3TC_DXT3_Format:()=>Tr,RGBA_S3TC_DXT5_Format:()=>hr,RGBFormat:()=>se,RGB_BPTC_SIGNED_Format:()=>Ht,RGB_BPTC_UNSIGNED_Format:()=>ii,RGB_ETC1_Format:()=>Ri,RGB_ETC2_Format:()=>or,RGB_PVRTC_2BPPV1_Format:()=>bi,RGB_PVRTC_4BPPV1_Format:()=>Zi,RGB_S3TC_DXT1_Format:()=>Ei,RGFormat:()=>Kt,RGIntegerFormat:()=>Mt,RawShaderMaterial:()=>ZV,Ray:()=>va,Raycaster:()=>Y3e,Rec709Primaries:()=>lf,RectAreaLight:()=>xG,RedFormat:()=>wt,RedIntegerFormat:()=>qt,ReinhardToneMapping:()=>zt,RenderTarget:()=>t0,RepeatWrapping:()=>Ue,ReplaceStencilOp:()=>aB,ReverseSubtractEquation:()=>$,RingGeometry:()=>Ow,SIGNED_RED_GREEN_RGTC2_Format:()=>xr,SIGNED_RED_RGTC1_Format:()=>Wt,SRGBColorSpace:()=>kn,SRGBTransfer:()=>hs,Scene:()=>oV,ShaderChunk:()=>ln,ShaderLib:()=>Lc,ShaderMaterial:()=>Nc,ShadowMaterial:()=>JV,Shape:()=>wf,ShapeGeometry:()=>Pw,ShapePath:()=>fRe,ShapeUtils:()=>su,ShortType:()=>rs,Skeleton:()=>cw,SkeletonHelper:()=>tRe,SkinnedMesh:()=>vV,Source:()=>_s,Sphere:()=>ya,SphereGeometry:()=>kv,Spherical:()=>K3e,SphericalHarmonics3:()=>bG,SplineCurve:()=>kN,SpotLight:()=>mG,SpotLightHelper:()=>eRe,Sprite:()=>hV,SpriteMaterial:()=>vN,SrcAlphaFactor:()=>xe,SrcAlphaSaturateFactor:()=>$e,SrcColorFactor:()=>Y,StaticCopyUsage:()=>wB,StaticDrawUsage:()=>uf,StaticReadUsage:()=>bB,StereoCamera:()=>T3e,StreamCopyUsage:()=>SB,StreamDrawUsage:()=>xB,StreamReadUsage:()=>EB,StringKeyframeTrack:()=>Mf,SubtractEquation:()=>z,SubtractiveBlending:()=>O,TOUCH:()=>f,TangentSpaceNormalMap:()=>co,TetrahedronGeometry:()=>kw,Texture:()=>fs,TextureLoader:()=>v3e,TorusGeometry:()=>Fw,TorusKnotGeometry:()=>Uw,Triangle:()=>Tl,TriangleFanDrawMode:()=>Rc,TriangleStripDrawMode:()=>$o,TrianglesDrawMode:()=>_l,TubeGeometry:()=>zw,UVMapping:()=>Pe,Uint16BufferAttribute:()=>$B,Uint32BufferAttribute:()=>eN,Uint8BufferAttribute:()=>u2e,Uint8ClampedBufferAttribute:()=>h2e,Uniform:()=>eL,UniformsGroup:()=>Q3e,UniformsLib:()=>Qi,UniformsUtils:()=>Cj,UnsignedByteType:()=>yn,UnsignedInt248Type:()=>Li,UnsignedInt5999Type:()=>Pi,UnsignedIntType:()=>ct,UnsignedShort4444Type:()=>Bi,UnsignedShort5551Type:()=>ar,UnsignedShortType:()=>bs,VSMShadowMap:()=>w,Vector2:()=>si,Vector3:()=>He,Vector4:()=>jn,VectorKeyframeTrack:()=>zv,VideoTexture:()=>BMe,WebGL3DRenderTarget:()=>Ln,WebGLArrayRenderTarget:()=>dr,WebGLCoordinateSystem:()=>Vl,WebGLCubeRenderTarget:()=>Rj,WebGLMultipleRenderTargets:()=>mRe,WebGLRenderTarget:()=>el,WebGLRenderer:()=>_Me,WebGLUtils:()=>iV,WebGPUCoordinateSystem:()=>hf,WireframeGeometry:()=>XV,WrapAroundEnding:()=>Gr,ZeroCurvatureEnding:()=>Hr,ZeroFactor:()=>V,ZeroSlopeEnding:()=>_n,ZeroStencilOp:()=>sB,createCanvasElement:()=>ME});/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const h="164",p={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},f={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},m=0,g=1,y=2,x=3,v=0,_=1,T=2,w=3,S=0,R=1,B=2,I=0,D=1,L=2,O=3,U=4,Z=5,G=100,z=101,$=102,Q=103,H=104,V=200,ne=201,Y=202,ae=203,xe=204,fe=205,de=206,Ie=207,Ge=208,Xe=209,$e=210,lt=211,At=212,Gt=213,gt=214,xi=0,Ze=1,Ui=2,di=3,Ii=4,Ti=5,ir=6,Gi=7,Qe=0,Ce=1,yt=2,Ot=0,Jt=1,zt=2,_i=3,vt=4,ye=5,ve=6,Le=7,Te="attached",ke="detached",Pe=300,F=301,J=302,ie=303,Re=304,ce=306,Ue=1e3,je=1001,dt=1002,It=1003,bt=1004,Ut=1004,pi=1005,Er=1005,ki=1006,An=1007,Ur=1007,sn=1008,xs=1008,yn=1009,Ls=1010,rs=1011,bs=1012,me=1013,ct=1014,St=1015,Xt=1016,Bi=1017,ar=1018,Li=1020,Pi=35902,Be=1021,se=1022,ge=1023,Ne=1024,Fe=1025,Ke=1026,ot=1027,wt=1028,qt=1029,Kt=1030,Mt=1031,ti=1033,Ei=33776,Fi=33777,Tr=33778,hr=33779,Zi=35840,bi=35841,Bn=35842,Jn=35843,Ri=36196,or=37492,pn=37496,Yr=37808,W=37809,ue=37810,Ae=37811,Se=37812,We=37813,Ye=37814,ft=37815,he=37816,le=37817,pe=37818,be=37819,Ee=37820,st=37821,Ct=36492,Ht=36494,ii=36495,Ai=36283,Wt=36284,Ni=36285,xr=36286,pr=2200,fr=2201,Wi=2202,Cr=2300,Mr=2301,zr=2302,Hr=2400,_n=2401,Gr=2402,ps=2500,Or=2501,_l=0,$o=1,Rc=2,$c=3200,eu=3201,co=0,tu=1,Xa="",kn="srgb",Ic="srgb-linear",Zg="display-p3",af="display-p3-linear",of="linear",hs="srgb",lf="rec709",cf="p3",sB=0,mh=7680,aB=7681,oB=7682,lB=7683,cB=34055,uB=34056,hB=5386,dB=512,pB=513,fB=514,mB=515,gB=516,AB=517,yB=518,lv=519,vE=512,xE=513,bE=514,cv=515,_E=516,EE=517,wE=518,CE=519,uf=35044,vB=35048,xB=35040,bB=35045,_B=35049,EB=35041,wB=35046,CB=35050,SB=35042,TB="100",uv="300 es",Vl=2e3,hf=2001;class Io{addEventListener(a,d){this._listeners===void 0&&(this._listeners={});const A=this._listeners;A[a]===void 0&&(A[a]=[]),A[a].indexOf(d)===-1&&A[a].push(d)}hasEventListener(a,d){if(this._listeners===void 0)return!1;const A=this._listeners;return A[a]!==void 0&&A[a].indexOf(d)!==-1}removeEventListener(a,d){if(this._listeners===void 0)return;const A=this._listeners[a];if(A!==void 0){const b=A.indexOf(d);b!==-1&&A.splice(b,1)}}dispatchEvent(a){if(this._listeners===void 0)return;const d=this._listeners[a.type];if(d!==void 0){a.target=this;const A=d.slice(0);for(let b=0,E=A.length;b<E;b++)A[b].call(this,a);a.target=null}}}const La=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let SE=1234567;const gh=Math.PI/180,Bd=180/Math.PI;function Bo(){const C=Math.random()*4294967295|0,a=Math.random()*4294967295|0,d=Math.random()*4294967295|0,A=Math.random()*4294967295|0;return(La[C&255]+La[C>>8&255]+La[C>>16&255]+La[C>>24&255]+"-"+La[a&255]+La[a>>8&255]+"-"+La[a>>16&15|64]+La[a>>24&255]+"-"+La[d&63|128]+La[d>>8&255]+"-"+La[d>>16&255]+La[d>>24&255]+La[A&255]+La[A>>8&255]+La[A>>16&255]+La[A>>24&255]).toLowerCase()}function Ms(C,a,d){return Math.max(a,Math.min(d,C))}function hv(C,a){return(C%a+a)%a}function MB(C,a,d,A,b){return A+(C-a)*(b-A)/(d-a)}function RB(C,a,d){return C!==a?(d-C)/(a-C):0}function df(C,a,d){return(1-d)*C+d*a}function IB(C,a,d,A){return df(C,a,1-Math.exp(-d*A))}function BB(C,a=1){return a-Math.abs(hv(C,a*2)-a)}function NB(C,a,d){return C<=a?0:C>=d?1:(C=(C-a)/(d-a),C*C*(3-2*C))}function LB(C,a,d){return C<=a?0:C>=d?1:(C=(C-a)/(d-a),C*C*C*(C*(C*6-15)+10))}function DB(C,a){return C+Math.floor(Math.random()*(a-C+1))}function OB(C,a){return C+Math.random()*(a-C)}function PB(C){return C*(.5-Math.random())}function kB(C){C!==void 0&&(SE=C);let a=SE+=1831565813;return a=Math.imul(a^a>>>15,a|1),a^=a+Math.imul(a^a>>>7,a|61),((a^a>>>14)>>>0)/4294967296}function FB(C){return C*gh}function UB(C){return C*Bd}function zB(C){return(C&C-1)===0&&C!==0}function jB(C){return Math.pow(2,Math.ceil(Math.log(C)/Math.LN2))}function VB(C){return Math.pow(2,Math.floor(Math.log(C)/Math.LN2))}function GB(C,a,d,A,b){const E=Math.cos,M=Math.sin,N=E(d/2),P=M(d/2),k=E((a+A)/2),j=M((a+A)/2),X=E((a-A)/2),q=M((a-A)/2),K=E((A-a)/2),te=M((A-a)/2);switch(b){case"XYX":C.set(N*j,P*X,P*q,N*k);break;case"YZY":C.set(P*q,N*j,P*X,N*k);break;case"ZXZ":C.set(P*X,P*q,N*j,N*k);break;case"XZX":C.set(N*j,P*te,P*K,N*k);break;case"YXY":C.set(P*K,N*j,P*te,N*k);break;case"ZYZ":C.set(P*te,P*K,N*j,N*k);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+b)}}function Ya(C,a){switch(a.constructor){case Float32Array:return C;case Uint32Array:return C/4294967295;case Uint16Array:return C/65535;case Uint8Array:return C/255;case Int32Array:return Math.max(C/2147483647,-1);case Int16Array:return Math.max(C/32767,-1);case Int8Array:return Math.max(C/127,-1);default:throw new Error("Invalid component type.")}}function Zr(C,a){switch(a.constructor){case Float32Array:return C;case Uint32Array:return Math.round(C*4294967295);case Uint16Array:return Math.round(C*65535);case Uint8Array:return Math.round(C*255);case Int32Array:return Math.round(C*2147483647);case Int16Array:return Math.round(C*32767);case Int8Array:return Math.round(C*127);default:throw new Error("Invalid component type.")}}const HB={DEG2RAD:gh,RAD2DEG:Bd,generateUUID:Bo,clamp:Ms,euclideanModulo:hv,mapLinear:MB,inverseLerp:RB,lerp:df,damp:IB,pingpong:BB,smoothstep:NB,smootherstep:LB,randInt:DB,randFloat:OB,randFloatSpread:PB,seededRandom:kB,degToRad:FB,radToDeg:UB,isPowerOfTwo:zB,ceilPowerOfTwo:jB,floorPowerOfTwo:VB,setQuaternionFromProperEuler:GB,normalize:Zr,denormalize:Ya};class si{constructor(a=0,d=0){si.prototype.isVector2=!0,this.x=a,this.y=d}get width(){return this.x}set width(a){this.x=a}get height(){return this.y}set height(a){this.y=a}set(a,d){return this.x=a,this.y=d,this}setScalar(a){return this.x=a,this.y=a,this}setX(a){return this.x=a,this}setY(a){return this.y=a,this}setComponent(a,d){switch(a){case 0:this.x=d;break;case 1:this.y=d;break;default:throw new Error("index is out of range: "+a)}return this}getComponent(a){switch(a){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+a)}}clone(){return new this.constructor(this.x,this.y)}copy(a){return this.x=a.x,this.y=a.y,this}add(a){return this.x+=a.x,this.y+=a.y,this}addScalar(a){return this.x+=a,this.y+=a,this}addVectors(a,d){return this.x=a.x+d.x,this.y=a.y+d.y,this}addScaledVector(a,d){return this.x+=a.x*d,this.y+=a.y*d,this}sub(a){return this.x-=a.x,this.y-=a.y,this}subScalar(a){return this.x-=a,this.y-=a,this}subVectors(a,d){return this.x=a.x-d.x,this.y=a.y-d.y,this}multiply(a){return this.x*=a.x,this.y*=a.y,this}multiplyScalar(a){return this.x*=a,this.y*=a,this}divide(a){return this.x/=a.x,this.y/=a.y,this}divideScalar(a){return this.multiplyScalar(1/a)}applyMatrix3(a){const d=this.x,A=this.y,b=a.elements;return this.x=b[0]*d+b[3]*A+b[6],this.y=b[1]*d+b[4]*A+b[7],this}min(a){return this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y),this}max(a){return this.x=Math.max(this.x,a.x),this.y=Math.max(this.y,a.y),this}clamp(a,d){return this.x=Math.max(a.x,Math.min(d.x,this.x)),this.y=Math.max(a.y,Math.min(d.y,this.y)),this}clampScalar(a,d){return this.x=Math.max(a,Math.min(d,this.x)),this.y=Math.max(a,Math.min(d,this.y)),this}clampLength(a,d){const A=this.length();return this.divideScalar(A||1).multiplyScalar(Math.max(a,Math.min(d,A)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(a){return this.x*a.x+this.y*a.y}cross(a){return this.x*a.y-this.y*a.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(a){const d=Math.sqrt(this.lengthSq()*a.lengthSq());if(d===0)return Math.PI/2;const A=this.dot(a)/d;return Math.acos(Ms(A,-1,1))}distanceTo(a){return Math.sqrt(this.distanceToSquared(a))}distanceToSquared(a){const d=this.x-a.x,A=this.y-a.y;return d*d+A*A}manhattanDistanceTo(a){return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)}setLength(a){return this.normalize().multiplyScalar(a)}lerp(a,d){return this.x+=(a.x-this.x)*d,this.y+=(a.y-this.y)*d,this}lerpVectors(a,d,A){return this.x=a.x+(d.x-a.x)*A,this.y=a.y+(d.y-a.y)*A,this}equals(a){return a.x===this.x&&a.y===this.y}fromArray(a,d=0){return this.x=a[d],this.y=a[d+1],this}toArray(a=[],d=0){return a[d]=this.x,a[d+1]=this.y,a}fromBufferAttribute(a,d){return this.x=a.getX(d),this.y=a.getY(d),this}rotateAround(a,d){const A=Math.cos(d),b=Math.sin(d),E=this.x-a.x,M=this.y-a.y;return this.x=E*A-M*b+a.x,this.y=E*b+M*A+a.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Kr{constructor(a,d,A,b,E,M,N,P,k){Kr.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],a!==void 0&&this.set(a,d,A,b,E,M,N,P,k)}set(a,d,A,b,E,M,N,P,k){const j=this.elements;return j[0]=a,j[1]=b,j[2]=N,j[3]=d,j[4]=E,j[5]=P,j[6]=A,j[7]=M,j[8]=k,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(a){const d=this.elements,A=a.elements;return d[0]=A[0],d[1]=A[1],d[2]=A[2],d[3]=A[3],d[4]=A[4],d[5]=A[5],d[6]=A[6],d[7]=A[7],d[8]=A[8],this}extractBasis(a,d,A){return a.setFromMatrix3Column(this,0),d.setFromMatrix3Column(this,1),A.setFromMatrix3Column(this,2),this}setFromMatrix4(a){const d=a.elements;return this.set(d[0],d[4],d[8],d[1],d[5],d[9],d[2],d[6],d[10]),this}multiply(a){return this.multiplyMatrices(this,a)}premultiply(a){return this.multiplyMatrices(a,this)}multiplyMatrices(a,d){const A=a.elements,b=d.elements,E=this.elements,M=A[0],N=A[3],P=A[6],k=A[1],j=A[4],X=A[7],q=A[2],K=A[5],te=A[8],oe=b[0],re=b[3],ee=b[6],Me=b[1],we=b[4],_e=b[7],nt=b[2],qe=b[5],Je=b[8];return E[0]=M*oe+N*Me+P*nt,E[3]=M*re+N*we+P*qe,E[6]=M*ee+N*_e+P*Je,E[1]=k*oe+j*Me+X*nt,E[4]=k*re+j*we+X*qe,E[7]=k*ee+j*_e+X*Je,E[2]=q*oe+K*Me+te*nt,E[5]=q*re+K*we+te*qe,E[8]=q*ee+K*_e+te*Je,this}multiplyScalar(a){const d=this.elements;return d[0]*=a,d[3]*=a,d[6]*=a,d[1]*=a,d[4]*=a,d[7]*=a,d[2]*=a,d[5]*=a,d[8]*=a,this}determinant(){const a=this.elements,d=a[0],A=a[1],b=a[2],E=a[3],M=a[4],N=a[5],P=a[6],k=a[7],j=a[8];return d*M*j-d*N*k-A*E*j+A*N*P+b*E*k-b*M*P}invert(){const a=this.elements,d=a[0],A=a[1],b=a[2],E=a[3],M=a[4],N=a[5],P=a[6],k=a[7],j=a[8],X=j*M-N*k,q=N*P-j*E,K=k*E-M*P,te=d*X+A*q+b*K;if(te===0)return this.set(0,0,0,0,0,0,0,0,0);const oe=1/te;return a[0]=X*oe,a[1]=(b*k-j*A)*oe,a[2]=(N*A-b*M)*oe,a[3]=q*oe,a[4]=(j*d-b*P)*oe,a[5]=(b*E-N*d)*oe,a[6]=K*oe,a[7]=(A*P-k*d)*oe,a[8]=(M*d-A*E)*oe,this}transpose(){let a;const d=this.elements;return a=d[1],d[1]=d[3],d[3]=a,a=d[2],d[2]=d[6],d[6]=a,a=d[5],d[5]=d[7],d[7]=a,this}getNormalMatrix(a){return this.setFromMatrix4(a).invert().transpose()}transposeIntoArray(a){const d=this.elements;return a[0]=d[0],a[1]=d[3],a[2]=d[6],a[3]=d[1],a[4]=d[4],a[5]=d[7],a[6]=d[2],a[7]=d[5],a[8]=d[8],this}setUvTransform(a,d,A,b,E,M,N){const P=Math.cos(E),k=Math.sin(E);return this.set(A*P,A*k,-A*(P*M+k*N)+M+a,-b*k,b*P,-b*(-k*M+P*N)+N+d,0,0,1),this}scale(a,d){return this.premultiply(dv.makeScale(a,d)),this}rotate(a){return this.premultiply(dv.makeRotation(-a)),this}translate(a,d){return this.premultiply(dv.makeTranslation(a,d)),this}makeTranslation(a,d){return a.isVector2?this.set(1,0,a.x,0,1,a.y,0,0,1):this.set(1,0,a,0,1,d,0,0,1),this}makeRotation(a){const d=Math.cos(a),A=Math.sin(a);return this.set(d,-A,0,A,d,0,0,0,1),this}makeScale(a,d){return this.set(a,0,0,0,d,0,0,0,1),this}equals(a){const d=this.elements,A=a.elements;for(let b=0;b<9;b++)if(d[b]!==A[b])return!1;return!0}fromArray(a,d=0){for(let A=0;A<9;A++)this.elements[A]=a[A+d];return this}toArray(a=[],d=0){const A=this.elements;return a[d]=A[0],a[d+1]=A[1],a[d+2]=A[2],a[d+3]=A[3],a[d+4]=A[4],a[d+5]=A[5],a[d+6]=A[6],a[d+7]=A[7],a[d+8]=A[8],a}clone(){return new this.constructor().fromArray(this.elements)}}const dv=new Kr;function TE(C){for(let a=C.length-1;a>=0;--a)if(C[a]>=65535)return!0;return!1}const WB={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Nd(C,a){return new WB[C](a)}function pf(C){return document.createElementNS("http://www.w3.org/1999/xhtml",C)}function ME(){const C=pf("canvas");return C.style.display="block",C}const RE={};function IE(C){C in RE||(RE[C]=!0,console.warn(C))}const BE=new Kr().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),NE=new Kr().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),$g={[Ic]:{transfer:of,primaries:lf,toReference:C=>C,fromReference:C=>C},[kn]:{transfer:hs,primaries:lf,toReference:C=>C.convertSRGBToLinear(),fromReference:C=>C.convertLinearToSRGB()},[af]:{transfer:of,primaries:cf,toReference:C=>C.applyMatrix3(NE),fromReference:C=>C.applyMatrix3(BE)},[Zg]:{transfer:hs,primaries:cf,toReference:C=>C.convertSRGBToLinear().applyMatrix3(NE),fromReference:C=>C.applyMatrix3(BE).convertLinearToSRGB()}},QB=new Set([Ic,af]),Zn={enabled:!0,_workingColorSpace:Ic,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(C){if(!QB.has(C))throw new Error(`Unsupported working color space, "${C}".`);this._workingColorSpace=C},convert:function(C,a,d){if(this.enabled===!1||a===d||!a||!d)return C;const A=$g[a].toReference,b=$g[d].fromReference;return b(A(C))},fromWorkingColorSpace:function(C,a){return this.convert(C,this._workingColorSpace,a)},toWorkingColorSpace:function(C,a){return this.convert(C,a,this._workingColorSpace)},getPrimaries:function(C){return $g[C].primaries},getTransfer:function(C){return C===Xa?of:$g[C].transfer}};function Ld(C){return C<.04045?C*.0773993808:Math.pow(C*.9478672986+.0521327014,2.4)}function pv(C){return C<.0031308?C*12.92:1.055*Math.pow(C,.41666)-.055}let Ah;class Dd{static getDataURL(a){if(/^data:/i.test(a.src)||typeof HTMLCanvasElement>"u")return a.src;let d;if(a instanceof HTMLCanvasElement)d=a;else{Ah===void 0&&(Ah=pf("canvas")),Ah.width=a.width,Ah.height=a.height;const A=Ah.getContext("2d");a instanceof ImageData?A.putImageData(a,0,0):A.drawImage(a,0,0,a.width,a.height),d=Ah}return d.width>2048||d.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",a),d.toDataURL("image/jpeg",.6)):d.toDataURL("image/png")}static sRGBToLinear(a){if(typeof HTMLImageElement<"u"&&a instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&a instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&a instanceof ImageBitmap){const d=pf("canvas");d.width=a.width,d.height=a.height;const A=d.getContext("2d");A.drawImage(a,0,0,a.width,a.height);const b=A.getImageData(0,0,a.width,a.height),E=b.data;for(let M=0;M<E.length;M++)E[M]=Ld(E[M]/255)*255;return A.putImageData(b,0,0),d}else if(a.data){const d=a.data.slice(0);for(let A=0;A<d.length;A++)d instanceof Uint8Array||d instanceof Uint8ClampedArray?d[A]=Math.floor(Ld(d[A]/255)*255):d[A]=Ld(d[A]);return{data:d,width:a.width,height:a.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),a}}let LE=0;class _s{constructor(a=null){this.isSource=!0,Object.defineProperty(this,"id",{value:LE++}),this.uuid=Bo(),this.data=a,this.dataReady=!0,this.version=0}set needsUpdate(a){a===!0&&this.version++}toJSON(a){const d=a===void 0||typeof a=="string";if(!d&&a.images[this.uuid]!==void 0)return a.images[this.uuid];const A={uuid:this.uuid,url:""},b=this.data;if(b!==null){let E;if(Array.isArray(b)){E=[];for(let M=0,N=b.length;M<N;M++)b[M].isDataTexture?E.push(e0(b[M].image)):E.push(e0(b[M]))}else E=e0(b);A.url=E}return d||(a.images[this.uuid]=A),A}}function e0(C){return typeof HTMLImageElement<"u"&&C instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&C instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&C instanceof ImageBitmap?Dd.getDataURL(C):C.data?{data:Array.from(C.data),width:C.width,height:C.height,type:C.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let DE=0;class fs extends Io{constructor(a=fs.DEFAULT_IMAGE,d=fs.DEFAULT_MAPPING,A=je,b=je,E=ki,M=sn,N=ge,P=yn,k=fs.DEFAULT_ANISOTROPY,j=Xa){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:DE++}),this.uuid=Bo(),this.name="",this.source=new _s(a),this.mipmaps=[],this.mapping=d,this.channel=0,this.wrapS=A,this.wrapT=b,this.magFilter=E,this.minFilter=M,this.anisotropy=k,this.format=N,this.internalFormat=null,this.type=P,this.offset=new si(0,0),this.repeat=new si(1,1),this.center=new si(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Kr,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=j,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(a=null){this.source.data=a}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(a){return this.name=a.name,this.source=a.source,this.mipmaps=a.mipmaps.slice(0),this.mapping=a.mapping,this.channel=a.channel,this.wrapS=a.wrapS,this.wrapT=a.wrapT,this.magFilter=a.magFilter,this.minFilter=a.minFilter,this.anisotropy=a.anisotropy,this.format=a.format,this.internalFormat=a.internalFormat,this.type=a.type,this.offset.copy(a.offset),this.repeat.copy(a.repeat),this.center.copy(a.center),this.rotation=a.rotation,this.matrixAutoUpdate=a.matrixAutoUpdate,this.matrix.copy(a.matrix),this.generateMipmaps=a.generateMipmaps,this.premultiplyAlpha=a.premultiplyAlpha,this.flipY=a.flipY,this.unpackAlignment=a.unpackAlignment,this.colorSpace=a.colorSpace,this.userData=JSON.parse(JSON.stringify(a.userData)),this.needsUpdate=!0,this}toJSON(a){const d=a===void 0||typeof a=="string";if(!d&&a.textures[this.uuid]!==void 0)return a.textures[this.uuid];const A={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(a).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(A.userData=this.userData),d||(a.textures[this.uuid]=A),A}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(a){if(this.mapping!==Pe)return a;if(a.applyMatrix3(this.matrix),a.x<0||a.x>1)switch(this.wrapS){case Ue:a.x=a.x-Math.floor(a.x);break;case je:a.x=a.x<0?0:1;break;case dt:Math.abs(Math.floor(a.x)%2)===1?a.x=Math.ceil(a.x)-a.x:a.x=a.x-Math.floor(a.x);break}if(a.y<0||a.y>1)switch(this.wrapT){case Ue:a.y=a.y-Math.floor(a.y);break;case je:a.y=a.y<0?0:1;break;case dt:Math.abs(Math.floor(a.y)%2)===1?a.y=Math.ceil(a.y)-a.y:a.y=a.y-Math.floor(a.y);break}return this.flipY&&(a.y=1-a.y),a}set needsUpdate(a){a===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(a){a===!0&&this.pmremVersion++}}fs.DEFAULT_IMAGE=null,fs.DEFAULT_MAPPING=Pe,fs.DEFAULT_ANISOTROPY=1;class jn{constructor(a=0,d=0,A=0,b=1){jn.prototype.isVector4=!0,this.x=a,this.y=d,this.z=A,this.w=b}get width(){return this.z}set width(a){this.z=a}get height(){return this.w}set height(a){this.w=a}set(a,d,A,b){return this.x=a,this.y=d,this.z=A,this.w=b,this}setScalar(a){return this.x=a,this.y=a,this.z=a,this.w=a,this}setX(a){return this.x=a,this}setY(a){return this.y=a,this}setZ(a){return this.z=a,this}setW(a){return this.w=a,this}setComponent(a,d){switch(a){case 0:this.x=d;break;case 1:this.y=d;break;case 2:this.z=d;break;case 3:this.w=d;break;default:throw new Error("index is out of range: "+a)}return this}getComponent(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+a)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(a){return this.x=a.x,this.y=a.y,this.z=a.z,this.w=a.w!==void 0?a.w:1,this}add(a){return this.x+=a.x,this.y+=a.y,this.z+=a.z,this.w+=a.w,this}addScalar(a){return this.x+=a,this.y+=a,this.z+=a,this.w+=a,this}addVectors(a,d){return this.x=a.x+d.x,this.y=a.y+d.y,this.z=a.z+d.z,this.w=a.w+d.w,this}addScaledVector(a,d){return this.x+=a.x*d,this.y+=a.y*d,this.z+=a.z*d,this.w+=a.w*d,this}sub(a){return this.x-=a.x,this.y-=a.y,this.z-=a.z,this.w-=a.w,this}subScalar(a){return this.x-=a,this.y-=a,this.z-=a,this.w-=a,this}subVectors(a,d){return this.x=a.x-d.x,this.y=a.y-d.y,this.z=a.z-d.z,this.w=a.w-d.w,this}multiply(a){return this.x*=a.x,this.y*=a.y,this.z*=a.z,this.w*=a.w,this}multiplyScalar(a){return this.x*=a,this.y*=a,this.z*=a,this.w*=a,this}applyMatrix4(a){const d=this.x,A=this.y,b=this.z,E=this.w,M=a.elements;return this.x=M[0]*d+M[4]*A+M[8]*b+M[12]*E,this.y=M[1]*d+M[5]*A+M[9]*b+M[13]*E,this.z=M[2]*d+M[6]*A+M[10]*b+M[14]*E,this.w=M[3]*d+M[7]*A+M[11]*b+M[15]*E,this}divideScalar(a){return this.multiplyScalar(1/a)}setAxisAngleFromQuaternion(a){this.w=2*Math.acos(a.w);const d=Math.sqrt(1-a.w*a.w);return d<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=a.x/d,this.y=a.y/d,this.z=a.z/d),this}setAxisAngleFromRotationMatrix(a){let d,A,b,E;const M=a.elements,N=M[0],P=M[4],k=M[8],j=M[1],X=M[5],q=M[9],K=M[2],te=M[6],oe=M[10];if(Math.abs(P-j)<.01&&Math.abs(k-K)<.01&&Math.abs(q-te)<.01){if(Math.abs(P+j)<.1&&Math.abs(k+K)<.1&&Math.abs(q+te)<.1&&Math.abs(N+X+oe-3)<.1)return this.set(1,0,0,0),this;d=Math.PI;const ee=(N+1)/2,Me=(X+1)/2,we=(oe+1)/2,_e=(P+j)/4,nt=(k+K)/4,qe=(q+te)/4;return ee>Me&&ee>we?ee<.01?(A=0,b=.707106781,E=.707106781):(A=Math.sqrt(ee),b=_e/A,E=nt/A):Me>we?Me<.01?(A=.707106781,b=0,E=.707106781):(b=Math.sqrt(Me),A=_e/b,E=qe/b):we<.01?(A=.707106781,b=.707106781,E=0):(E=Math.sqrt(we),A=nt/E,b=qe/E),this.set(A,b,E,d),this}let re=Math.sqrt((te-q)*(te-q)+(k-K)*(k-K)+(j-P)*(j-P));return Math.abs(re)<.001&&(re=1),this.x=(te-q)/re,this.y=(k-K)/re,this.z=(j-P)/re,this.w=Math.acos((N+X+oe-1)/2),this}min(a){return this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y),this.z=Math.min(this.z,a.z),this.w=Math.min(this.w,a.w),this}max(a){return this.x=Math.max(this.x,a.x),this.y=Math.max(this.y,a.y),this.z=Math.max(this.z,a.z),this.w=Math.max(this.w,a.w),this}clamp(a,d){return this.x=Math.max(a.x,Math.min(d.x,this.x)),this.y=Math.max(a.y,Math.min(d.y,this.y)),this.z=Math.max(a.z,Math.min(d.z,this.z)),this.w=Math.max(a.w,Math.min(d.w,this.w)),this}clampScalar(a,d){return this.x=Math.max(a,Math.min(d,this.x)),this.y=Math.max(a,Math.min(d,this.y)),this.z=Math.max(a,Math.min(d,this.z)),this.w=Math.max(a,Math.min(d,this.w)),this}clampLength(a,d){const A=this.length();return this.divideScalar(A||1).multiplyScalar(Math.max(a,Math.min(d,A)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(a){return this.normalize().multiplyScalar(a)}lerp(a,d){return this.x+=(a.x-this.x)*d,this.y+=(a.y-this.y)*d,this.z+=(a.z-this.z)*d,this.w+=(a.w-this.w)*d,this}lerpVectors(a,d,A){return this.x=a.x+(d.x-a.x)*A,this.y=a.y+(d.y-a.y)*A,this.z=a.z+(d.z-a.z)*A,this.w=a.w+(d.w-a.w)*A,this}equals(a){return a.x===this.x&&a.y===this.y&&a.z===this.z&&a.w===this.w}fromArray(a,d=0){return this.x=a[d],this.y=a[d+1],this.z=a[d+2],this.w=a[d+3],this}toArray(a=[],d=0){return a[d]=this.x,a[d+1]=this.y,a[d+2]=this.z,a[d+3]=this.w,a}fromBufferAttribute(a,d){return this.x=a.getX(d),this.y=a.getY(d),this.z=a.getZ(d),this.w=a.getW(d),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class t0 extends Io{constructor(a=1,d=1,A={}){super(),this.isRenderTarget=!0,this.width=a,this.height=d,this.depth=1,this.scissor=new jn(0,0,a,d),this.scissorTest=!1,this.viewport=new jn(0,0,a,d);const b={width:a,height:d,depth:1};A=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:ki,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},A);const E=new fs(b,A.mapping,A.wrapS,A.wrapT,A.magFilter,A.minFilter,A.format,A.type,A.anisotropy,A.colorSpace);E.flipY=!1,E.generateMipmaps=A.generateMipmaps,E.internalFormat=A.internalFormat,this.textures=[];const M=A.count;for(let N=0;N<M;N++)this.textures[N]=E.clone(),this.textures[N].isRenderTargetTexture=!0;this.depthBuffer=A.depthBuffer,this.stencilBuffer=A.stencilBuffer,this.resolveDepthBuffer=A.resolveDepthBuffer,this.resolveStencilBuffer=A.resolveStencilBuffer,this.depthTexture=A.depthTexture,this.samples=A.samples}get texture(){return this.textures[0]}set texture(a){this.textures[0]=a}setSize(a,d,A=1){if(this.width!==a||this.height!==d||this.depth!==A){this.width=a,this.height=d,this.depth=A;for(let b=0,E=this.textures.length;b<E;b++)this.textures[b].image.width=a,this.textures[b].image.height=d,this.textures[b].image.depth=A;this.dispose()}this.viewport.set(0,0,a,d),this.scissor.set(0,0,a,d)}clone(){return new this.constructor().copy(this)}copy(a){this.width=a.width,this.height=a.height,this.depth=a.depth,this.scissor.copy(a.scissor),this.scissorTest=a.scissorTest,this.viewport.copy(a.viewport),this.textures.length=0;for(let A=0,b=a.textures.length;A<b;A++)this.textures[A]=a.textures[A].clone(),this.textures[A].isRenderTargetTexture=!0;const d=Object.assign({},a.texture.image);return this.texture.source=new _s(d),this.depthBuffer=a.depthBuffer,this.stencilBuffer=a.stencilBuffer,this.resolveDepthBuffer=a.resolveDepthBuffer,this.resolveStencilBuffer=a.resolveStencilBuffer,a.depthTexture!==null&&(this.depthTexture=a.depthTexture.clone()),this.samples=a.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class el extends t0{constructor(a=1,d=1,A={}){super(a,d,A),this.isWebGLRenderTarget=!0}}class i0 extends fs{constructor(a=null,d=1,A=1,b=1){super(null),this.isDataArrayTexture=!0,this.image={data:a,width:d,height:A,depth:b},this.magFilter=It,this.minFilter=It,this.wrapR=je,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class dr extends el{constructor(a=1,d=1,A=1,b={}){super(a,d,b),this.isWebGLArrayRenderTarget=!0,this.depth=A,this.texture=new i0(null,a,d,A),this.texture.isRenderTargetTexture=!0}}class Jr extends fs{constructor(a=null,d=1,A=1,b=1){super(null),this.isData3DTexture=!0,this.image={data:a,width:d,height:A,depth:b},this.magFilter=It,this.minFilter=It,this.wrapR=je,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Ln extends el{constructor(a=1,d=1,A=1,b={}){super(a,d,b),this.isWebGL3DRenderTarget=!0,this.depth=A,this.texture=new Jr(null,a,d,A),this.texture.isRenderTargetTexture=!0}}class Wn{constructor(a=0,d=0,A=0,b=1){this.isQuaternion=!0,this._x=a,this._y=d,this._z=A,this._w=b}static slerpFlat(a,d,A,b,E,M,N){let P=A[b+0],k=A[b+1],j=A[b+2],X=A[b+3];const q=E[M+0],K=E[M+1],te=E[M+2],oe=E[M+3];if(N===0){a[d+0]=P,a[d+1]=k,a[d+2]=j,a[d+3]=X;return}if(N===1){a[d+0]=q,a[d+1]=K,a[d+2]=te,a[d+3]=oe;return}if(X!==oe||P!==q||k!==K||j!==te){let re=1-N;const ee=P*q+k*K+j*te+X*oe,Me=ee>=0?1:-1,we=1-ee*ee;if(we>Number.EPSILON){const nt=Math.sqrt(we),qe=Math.atan2(nt,ee*Me);re=Math.sin(re*qe)/nt,N=Math.sin(N*qe)/nt}const _e=N*Me;if(P=P*re+q*_e,k=k*re+K*_e,j=j*re+te*_e,X=X*re+oe*_e,re===1-N){const nt=1/Math.sqrt(P*P+k*k+j*j+X*X);P*=nt,k*=nt,j*=nt,X*=nt}}a[d]=P,a[d+1]=k,a[d+2]=j,a[d+3]=X}static multiplyQuaternionsFlat(a,d,A,b,E,M){const N=A[b],P=A[b+1],k=A[b+2],j=A[b+3],X=E[M],q=E[M+1],K=E[M+2],te=E[M+3];return a[d]=N*te+j*X+P*K-k*q,a[d+1]=P*te+j*q+k*X-N*K,a[d+2]=k*te+j*K+N*q-P*X,a[d+3]=j*te-N*X-P*q-k*K,a}get x(){return this._x}set x(a){this._x=a,this._onChangeCallback()}get y(){return this._y}set y(a){this._y=a,this._onChangeCallback()}get z(){return this._z}set z(a){this._z=a,this._onChangeCallback()}get w(){return this._w}set w(a){this._w=a,this._onChangeCallback()}set(a,d,A,b){return this._x=a,this._y=d,this._z=A,this._w=b,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(a){return this._x=a.x,this._y=a.y,this._z=a.z,this._w=a.w,this._onChangeCallback(),this}setFromEuler(a,d=!0){const A=a._x,b=a._y,E=a._z,M=a._order,N=Math.cos,P=Math.sin,k=N(A/2),j=N(b/2),X=N(E/2),q=P(A/2),K=P(b/2),te=P(E/2);switch(M){case"XYZ":this._x=q*j*X+k*K*te,this._y=k*K*X-q*j*te,this._z=k*j*te+q*K*X,this._w=k*j*X-q*K*te;break;case"YXZ":this._x=q*j*X+k*K*te,this._y=k*K*X-q*j*te,this._z=k*j*te-q*K*X,this._w=k*j*X+q*K*te;break;case"ZXY":this._x=q*j*X-k*K*te,this._y=k*K*X+q*j*te,this._z=k*j*te+q*K*X,this._w=k*j*X-q*K*te;break;case"ZYX":this._x=q*j*X-k*K*te,this._y=k*K*X+q*j*te,this._z=k*j*te-q*K*X,this._w=k*j*X+q*K*te;break;case"YZX":this._x=q*j*X+k*K*te,this._y=k*K*X+q*j*te,this._z=k*j*te-q*K*X,this._w=k*j*X-q*K*te;break;case"XZY":this._x=q*j*X-k*K*te,this._y=k*K*X-q*j*te,this._z=k*j*te+q*K*X,this._w=k*j*X+q*K*te;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+M)}return d===!0&&this._onChangeCallback(),this}setFromAxisAngle(a,d){const A=d/2,b=Math.sin(A);return this._x=a.x*b,this._y=a.y*b,this._z=a.z*b,this._w=Math.cos(A),this._onChangeCallback(),this}setFromRotationMatrix(a){const d=a.elements,A=d[0],b=d[4],E=d[8],M=d[1],N=d[5],P=d[9],k=d[2],j=d[6],X=d[10],q=A+N+X;if(q>0){const K=.5/Math.sqrt(q+1);this._w=.25/K,this._x=(j-P)*K,this._y=(E-k)*K,this._z=(M-b)*K}else if(A>N&&A>X){const K=2*Math.sqrt(1+A-N-X);this._w=(j-P)/K,this._x=.25*K,this._y=(b+M)/K,this._z=(E+k)/K}else if(N>X){const K=2*Math.sqrt(1+N-A-X);this._w=(E-k)/K,this._x=(b+M)/K,this._y=.25*K,this._z=(P+j)/K}else{const K=2*Math.sqrt(1+X-A-N);this._w=(M-b)/K,this._x=(E+k)/K,this._y=(P+j)/K,this._z=.25*K}return this._onChangeCallback(),this}setFromUnitVectors(a,d){let A=a.dot(d)+1;return A<Number.EPSILON?(A=0,Math.abs(a.x)>Math.abs(a.z)?(this._x=-a.y,this._y=a.x,this._z=0,this._w=A):(this._x=0,this._y=-a.z,this._z=a.y,this._w=A)):(this._x=a.y*d.z-a.z*d.y,this._y=a.z*d.x-a.x*d.z,this._z=a.x*d.y-a.y*d.x,this._w=A),this.normalize()}angleTo(a){return 2*Math.acos(Math.abs(Ms(this.dot(a),-1,1)))}rotateTowards(a,d){const A=this.angleTo(a);if(A===0)return this;const b=Math.min(1,d/A);return this.slerp(a,b),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(a){return this._x*a._x+this._y*a._y+this._z*a._z+this._w*a._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let a=this.length();return a===0?(this._x=0,this._y=0,this._z=0,this._w=1):(a=1/a,this._x=this._x*a,this._y=this._y*a,this._z=this._z*a,this._w=this._w*a),this._onChangeCallback(),this}multiply(a){return this.multiplyQuaternions(this,a)}premultiply(a){return this.multiplyQuaternions(a,this)}multiplyQuaternions(a,d){const A=a._x,b=a._y,E=a._z,M=a._w,N=d._x,P=d._y,k=d._z,j=d._w;return this._x=A*j+M*N+b*k-E*P,this._y=b*j+M*P+E*N-A*k,this._z=E*j+M*k+A*P-b*N,this._w=M*j-A*N-b*P-E*k,this._onChangeCallback(),this}slerp(a,d){if(d===0)return this;if(d===1)return this.copy(a);const A=this._x,b=this._y,E=this._z,M=this._w;let N=M*a._w+A*a._x+b*a._y+E*a._z;if(N<0?(this._w=-a._w,this._x=-a._x,this._y=-a._y,this._z=-a._z,N=-N):this.copy(a),N>=1)return this._w=M,this._x=A,this._y=b,this._z=E,this;const P=1-N*N;if(P<=Number.EPSILON){const K=1-d;return this._w=K*M+d*this._w,this._x=K*A+d*this._x,this._y=K*b+d*this._y,this._z=K*E+d*this._z,this.normalize(),this}const k=Math.sqrt(P),j=Math.atan2(k,N),X=Math.sin((1-d)*j)/k,q=Math.sin(d*j)/k;return this._w=M*X+this._w*q,this._x=A*X+this._x*q,this._y=b*X+this._y*q,this._z=E*X+this._z*q,this._onChangeCallback(),this}slerpQuaternions(a,d,A){return this.copy(a).slerp(d,A)}random(){const a=2*Math.PI*Math.random(),d=2*Math.PI*Math.random(),A=Math.random(),b=Math.sqrt(1-A),E=Math.sqrt(A);return this.set(b*Math.sin(a),b*Math.cos(a),E*Math.sin(d),E*Math.cos(d))}equals(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._w===this._w}fromArray(a,d=0){return this._x=a[d],this._y=a[d+1],this._z=a[d+2],this._w=a[d+3],this._onChangeCallback(),this}toArray(a=[],d=0){return a[d]=this._x,a[d+1]=this._y,a[d+2]=this._z,a[d+3]=this._w,a}fromBufferAttribute(a,d){return this._x=a.getX(d),this._y=a.getY(d),this._z=a.getZ(d),this._w=a.getW(d),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(a){return this._onChangeCallback=a,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class He{constructor(a=0,d=0,A=0){He.prototype.isVector3=!0,this.x=a,this.y=d,this.z=A}set(a,d,A){return A===void 0&&(A=this.z),this.x=a,this.y=d,this.z=A,this}setScalar(a){return this.x=a,this.y=a,this.z=a,this}setX(a){return this.x=a,this}setY(a){return this.y=a,this}setZ(a){return this.z=a,this}setComponent(a,d){switch(a){case 0:this.x=d;break;case 1:this.y=d;break;case 2:this.z=d;break;default:throw new Error("index is out of range: "+a)}return this}getComponent(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+a)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(a){return this.x=a.x,this.y=a.y,this.z=a.z,this}add(a){return this.x+=a.x,this.y+=a.y,this.z+=a.z,this}addScalar(a){return this.x+=a,this.y+=a,this.z+=a,this}addVectors(a,d){return this.x=a.x+d.x,this.y=a.y+d.y,this.z=a.z+d.z,this}addScaledVector(a,d){return this.x+=a.x*d,this.y+=a.y*d,this.z+=a.z*d,this}sub(a){return this.x-=a.x,this.y-=a.y,this.z-=a.z,this}subScalar(a){return this.x-=a,this.y-=a,this.z-=a,this}subVectors(a,d){return this.x=a.x-d.x,this.y=a.y-d.y,this.z=a.z-d.z,this}multiply(a){return this.x*=a.x,this.y*=a.y,this.z*=a.z,this}multiplyScalar(a){return this.x*=a,this.y*=a,this.z*=a,this}multiplyVectors(a,d){return this.x=a.x*d.x,this.y=a.y*d.y,this.z=a.z*d.z,this}applyEuler(a){return this.applyQuaternion(js.setFromEuler(a))}applyAxisAngle(a,d){return this.applyQuaternion(js.setFromAxisAngle(a,d))}applyMatrix3(a){const d=this.x,A=this.y,b=this.z,E=a.elements;return this.x=E[0]*d+E[3]*A+E[6]*b,this.y=E[1]*d+E[4]*A+E[7]*b,this.z=E[2]*d+E[5]*A+E[8]*b,this}applyNormalMatrix(a){return this.applyMatrix3(a).normalize()}applyMatrix4(a){const d=this.x,A=this.y,b=this.z,E=a.elements,M=1/(E[3]*d+E[7]*A+E[11]*b+E[15]);return this.x=(E[0]*d+E[4]*A+E[8]*b+E[12])*M,this.y=(E[1]*d+E[5]*A+E[9]*b+E[13])*M,this.z=(E[2]*d+E[6]*A+E[10]*b+E[14])*M,this}applyQuaternion(a){const d=this.x,A=this.y,b=this.z,E=a.x,M=a.y,N=a.z,P=a.w,k=2*(M*b-N*A),j=2*(N*d-E*b),X=2*(E*A-M*d);return this.x=d+P*k+M*X-N*j,this.y=A+P*j+N*k-E*X,this.z=b+P*X+E*j-M*k,this}project(a){return this.applyMatrix4(a.matrixWorldInverse).applyMatrix4(a.projectionMatrix)}unproject(a){return this.applyMatrix4(a.projectionMatrixInverse).applyMatrix4(a.matrixWorld)}transformDirection(a){const d=this.x,A=this.y,b=this.z,E=a.elements;return this.x=E[0]*d+E[4]*A+E[8]*b,this.y=E[1]*d+E[5]*A+E[9]*b,this.z=E[2]*d+E[6]*A+E[10]*b,this.normalize()}divide(a){return this.x/=a.x,this.y/=a.y,this.z/=a.z,this}divideScalar(a){return this.multiplyScalar(1/a)}min(a){return this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y),this.z=Math.min(this.z,a.z),this}max(a){return this.x=Math.max(this.x,a.x),this.y=Math.max(this.y,a.y),this.z=Math.max(this.z,a.z),this}clamp(a,d){return this.x=Math.max(a.x,Math.min(d.x,this.x)),this.y=Math.max(a.y,Math.min(d.y,this.y)),this.z=Math.max(a.z,Math.min(d.z,this.z)),this}clampScalar(a,d){return this.x=Math.max(a,Math.min(d,this.x)),this.y=Math.max(a,Math.min(d,this.y)),this.z=Math.max(a,Math.min(d,this.z)),this}clampLength(a,d){const A=this.length();return this.divideScalar(A||1).multiplyScalar(Math.max(a,Math.min(d,A)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(a){return this.x*a.x+this.y*a.y+this.z*a.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(a){return this.normalize().multiplyScalar(a)}lerp(a,d){return this.x+=(a.x-this.x)*d,this.y+=(a.y-this.y)*d,this.z+=(a.z-this.z)*d,this}lerpVectors(a,d,A){return this.x=a.x+(d.x-a.x)*A,this.y=a.y+(d.y-a.y)*A,this.z=a.z+(d.z-a.z)*A,this}cross(a){return this.crossVectors(this,a)}crossVectors(a,d){const A=a.x,b=a.y,E=a.z,M=d.x,N=d.y,P=d.z;return this.x=b*P-E*N,this.y=E*M-A*P,this.z=A*N-b*M,this}projectOnVector(a){const d=a.lengthSq();if(d===0)return this.set(0,0,0);const A=a.dot(this)/d;return this.copy(a).multiplyScalar(A)}projectOnPlane(a){return El.copy(this).projectOnVector(a),this.sub(El)}reflect(a){return this.sub(El.copy(a).multiplyScalar(2*this.dot(a)))}angleTo(a){const d=Math.sqrt(this.lengthSq()*a.lengthSq());if(d===0)return Math.PI/2;const A=this.dot(a)/d;return Math.acos(Ms(A,-1,1))}distanceTo(a){return Math.sqrt(this.distanceToSquared(a))}distanceToSquared(a){const d=this.x-a.x,A=this.y-a.y,b=this.z-a.z;return d*d+A*A+b*b}manhattanDistanceTo(a){return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)+Math.abs(this.z-a.z)}setFromSpherical(a){return this.setFromSphericalCoords(a.radius,a.phi,a.theta)}setFromSphericalCoords(a,d,A){const b=Math.sin(d)*a;return this.x=b*Math.sin(A),this.y=Math.cos(d)*a,this.z=b*Math.cos(A),this}setFromCylindrical(a){return this.setFromCylindricalCoords(a.radius,a.theta,a.y)}setFromCylindricalCoords(a,d,A){return this.x=a*Math.sin(d),this.y=A,this.z=a*Math.cos(d),this}setFromMatrixPosition(a){const d=a.elements;return this.x=d[12],this.y=d[13],this.z=d[14],this}setFromMatrixScale(a){const d=this.setFromMatrixColumn(a,0).length(),A=this.setFromMatrixColumn(a,1).length(),b=this.setFromMatrixColumn(a,2).length();return this.x=d,this.y=A,this.z=b,this}setFromMatrixColumn(a,d){return this.fromArray(a.elements,d*4)}setFromMatrix3Column(a,d){return this.fromArray(a.elements,d*3)}setFromEuler(a){return this.x=a._x,this.y=a._y,this.z=a._z,this}setFromColor(a){return this.x=a.r,this.y=a.g,this.z=a.b,this}equals(a){return a.x===this.x&&a.y===this.y&&a.z===this.z}fromArray(a,d=0){return this.x=a[d],this.y=a[d+1],this.z=a[d+2],this}toArray(a=[],d=0){return a[d]=this.x,a[d+1]=this.y,a[d+2]=this.z,a}fromBufferAttribute(a,d){return this.x=a.getX(d),this.y=a.getY(d),this.z=a.getZ(d),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const a=Math.random()*Math.PI*2,d=Math.random()*2-1,A=Math.sqrt(1-d*d);return this.x=A*Math.cos(a),this.y=d,this.z=A*Math.sin(a),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const El=new He,js=new Wn;class Ds{constructor(a=new He(1/0,1/0,1/0),d=new He(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=a,this.max=d}set(a,d){return this.min.copy(a),this.max.copy(d),this}setFromArray(a){this.makeEmpty();for(let d=0,A=a.length;d<A;d+=3)this.expandByPoint(uo.fromArray(a,d));return this}setFromBufferAttribute(a){this.makeEmpty();for(let d=0,A=a.count;d<A;d++)this.expandByPoint(uo.fromBufferAttribute(a,d));return this}setFromPoints(a){this.makeEmpty();for(let d=0,A=a.length;d<A;d++)this.expandByPoint(a[d]);return this}setFromCenterAndSize(a,d){const A=uo.copy(d).multiplyScalar(.5);return this.min.copy(a).sub(A),this.max.copy(a).add(A),this}setFromObject(a,d=!1){return this.makeEmpty(),this.expandByObject(a,d)}clone(){return new this.constructor().copy(this)}copy(a){return this.min.copy(a.min),this.max.copy(a.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(a){return this.isEmpty()?a.set(0,0,0):a.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(a){return this.isEmpty()?a.set(0,0,0):a.subVectors(this.max,this.min)}expandByPoint(a){return this.min.min(a),this.max.max(a),this}expandByVector(a){return this.min.sub(a),this.max.add(a),this}expandByScalar(a){return this.min.addScalar(-a),this.max.addScalar(a),this}expandByObject(a,d=!1){a.updateWorldMatrix(!1,!1);const A=a.geometry;if(A!==void 0){const E=A.getAttribute("position");if(d===!0&&E!==void 0&&a.isInstancedMesh!==!0)for(let M=0,N=E.count;M<N;M++)a.isMesh===!0?a.getVertexPosition(M,uo):uo.fromBufferAttribute(E,M),uo.applyMatrix4(a.matrixWorld),this.expandByPoint(uo);else a.boundingBox!==void 0?(a.boundingBox===null&&a.computeBoundingBox(),iu.copy(a.boundingBox)):(A.boundingBox===null&&A.computeBoundingBox(),iu.copy(A.boundingBox)),iu.applyMatrix4(a.matrixWorld),this.union(iu)}const b=a.children;for(let E=0,M=b.length;E<M;E++)this.expandByObject(b[E],d);return this}containsPoint(a){return!(a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y||a.z<this.min.z||a.z>this.max.z)}containsBox(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y&&this.min.z<=a.min.z&&a.max.z<=this.max.z}getParameter(a,d){return d.set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y),(a.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(a){return!(a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y||a.max.z<this.min.z||a.min.z>this.max.z)}intersectsSphere(a){return this.clampPoint(a.center,uo),uo.distanceToSquared(a.center)<=a.radius*a.radius}intersectsPlane(a){let d,A;return a.normal.x>0?(d=a.normal.x*this.min.x,A=a.normal.x*this.max.x):(d=a.normal.x*this.max.x,A=a.normal.x*this.min.x),a.normal.y>0?(d+=a.normal.y*this.min.y,A+=a.normal.y*this.max.y):(d+=a.normal.y*this.max.y,A+=a.normal.y*this.min.y),a.normal.z>0?(d+=a.normal.z*this.min.z,A+=a.normal.z*this.max.z):(d+=a.normal.z*this.max.z,A+=a.normal.z*this.min.z),d<=-a.constant&&A>=-a.constant}intersectsTriangle(a){if(this.isEmpty())return!1;this.getCenter(Fn),os.subVectors(this.max,Fn),tl.subVectors(a.a,Fn),Da.subVectors(a.b,Fn),an.subVectors(a.c,Fn),Ka.subVectors(Da,tl),wl.subVectors(an,Da),Oa.subVectors(tl,an);let d=[0,-Ka.z,Ka.y,0,-wl.z,wl.y,0,-Oa.z,Oa.y,Ka.z,0,-Ka.x,wl.z,0,-wl.x,Oa.z,0,-Oa.x,-Ka.y,Ka.x,0,-wl.y,wl.x,0,-Oa.y,Oa.x,0];return!No(d,tl,Da,an,os)||(d=[1,0,0,0,1,0,0,0,1],!No(d,tl,Da,an,os))?!1:(on.crossVectors(Ka,wl),d=[on.x,on.y,on.z],No(d,tl,Da,an,os))}clampPoint(a,d){return d.copy(a).clamp(this.min,this.max)}distanceToPoint(a){return this.clampPoint(a,uo).distanceTo(a)}getBoundingSphere(a){return this.isEmpty()?a.makeEmpty():(this.getCenter(a.center),a.radius=this.getSize(uo).length()*.5),a}intersect(a){return this.min.max(a.min),this.max.min(a.max),this.isEmpty()&&this.makeEmpty(),this}union(a){return this.min.min(a.min),this.max.max(a.max),this}applyMatrix4(a){return this.isEmpty()?this:(Cn[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(a),Cn[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(a),Cn[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(a),Cn[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(a),Cn[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(a),Cn[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(a),Cn[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(a),Cn[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(a),this.setFromPoints(Cn),this)}translate(a){return this.min.add(a),this.max.add(a),this}equals(a){return a.min.equals(this.min)&&a.max.equals(this.max)}}const Cn=[new He,new He,new He,new He,new He,new He,new He,new He],uo=new He,iu=new Ds,tl=new He,Da=new He,an=new He,Ka=new He,wl=new He,Oa=new He,Fn=new He,os=new He,on=new He,Un=new He;function No(C,a,d,A,b){for(let E=0,M=C.length-3;E<=M;E+=3){Un.fromArray(C,E);const N=b.x*Math.abs(Un.x)+b.y*Math.abs(Un.y)+b.z*Math.abs(Un.z),P=a.dot(Un),k=d.dot(Un),j=A.dot(Un);if(Math.max(-Math.max(P,k,j),Math.min(P,k,j))>N)return!1}return!0}const Od=new Ds,yh=new He,r0=new He;class ya{constructor(a=new He,d=-1){this.isSphere=!0,this.center=a,this.radius=d}set(a,d){return this.center.copy(a),this.radius=d,this}setFromPoints(a,d){const A=this.center;d!==void 0?A.copy(d):Od.setFromPoints(a).getCenter(A);let b=0;for(let E=0,M=a.length;E<M;E++)b=Math.max(b,A.distanceToSquared(a[E]));return this.radius=Math.sqrt(b),this}copy(a){return this.center.copy(a.center),this.radius=a.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(a){return a.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(a){return a.distanceTo(this.center)-this.radius}intersectsSphere(a){const d=this.radius+a.radius;return a.center.distanceToSquared(this.center)<=d*d}intersectsBox(a){return a.intersectsSphere(this)}intersectsPlane(a){return Math.abs(a.distanceToPoint(this.center))<=this.radius}clampPoint(a,d){const A=this.center.distanceToSquared(a);return d.copy(a),A>this.radius*this.radius&&(d.sub(this.center).normalize(),d.multiplyScalar(this.radius).add(this.center)),d}getBoundingBox(a){return this.isEmpty()?(a.makeEmpty(),a):(a.set(this.center,this.center),a.expandByScalar(this.radius),a)}applyMatrix4(a){return this.center.applyMatrix4(a),this.radius=this.radius*a.getMaxScaleOnAxis(),this}translate(a){return this.center.add(a),this}expandByPoint(a){if(this.isEmpty())return this.center.copy(a),this.radius=0,this;yh.subVectors(a,this.center);const d=yh.lengthSq();if(d>this.radius*this.radius){const A=Math.sqrt(d),b=(A-this.radius)*.5;this.center.addScaledVector(yh,b/A),this.radius+=b}return this}union(a){return a.isEmpty()?this:this.isEmpty()?(this.copy(a),this):(this.center.equals(a.center)===!0?this.radius=Math.max(this.radius,a.radius):(r0.subVectors(a.center,this.center).setLength(a.radius),this.expandByPoint(yh.copy(a.center).add(r0)),this.expandByPoint(yh.copy(a.center).sub(r0))),this)}equals(a){return a.center.equals(this.center)&&a.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Gl=new He,n0=new He,s0=new He,ru=new He,fv=new He,a0=new He,mv=new He;class va{constructor(a=new He,d=new He(0,0,-1)){this.origin=a,this.direction=d}set(a,d){return this.origin.copy(a),this.direction.copy(d),this}copy(a){return this.origin.copy(a.origin),this.direction.copy(a.direction),this}at(a,d){return d.copy(this.origin).addScaledVector(this.direction,a)}lookAt(a){return this.direction.copy(a).sub(this.origin).normalize(),this}recast(a){return this.origin.copy(this.at(a,Gl)),this}closestPointToPoint(a,d){d.subVectors(a,this.origin);const A=d.dot(this.direction);return A<0?d.copy(this.origin):d.copy(this.origin).addScaledVector(this.direction,A)}distanceToPoint(a){return Math.sqrt(this.distanceSqToPoint(a))}distanceSqToPoint(a){const d=Gl.subVectors(a,this.origin).dot(this.direction);return d<0?this.origin.distanceToSquared(a):(Gl.copy(this.origin).addScaledVector(this.direction,d),Gl.distanceToSquared(a))}distanceSqToSegment(a,d,A,b){n0.copy(a).add(d).multiplyScalar(.5),s0.copy(d).sub(a).normalize(),ru.copy(this.origin).sub(n0);const E=a.distanceTo(d)*.5,M=-this.direction.dot(s0),N=ru.dot(this.direction),P=-ru.dot(s0),k=ru.lengthSq(),j=Math.abs(1-M*M);let X,q,K,te;if(j>0)if(X=M*P-N,q=M*N-P,te=E*j,X>=0)if(q>=-te)if(q<=te){const oe=1/j;X*=oe,q*=oe,K=X*(X+M*q+2*N)+q*(M*X+q+2*P)+k}else q=E,X=Math.max(0,-(M*q+N)),K=-X*X+q*(q+2*P)+k;else q=-E,X=Math.max(0,-(M*q+N)),K=-X*X+q*(q+2*P)+k;else q<=-te?(X=Math.max(0,-(-M*E+N)),q=X>0?-E:Math.min(Math.max(-E,-P),E),K=-X*X+q*(q+2*P)+k):q<=te?(X=0,q=Math.min(Math.max(-E,-P),E),K=q*(q+2*P)+k):(X=Math.max(0,-(M*E+N)),q=X>0?E:Math.min(Math.max(-E,-P),E),K=-X*X+q*(q+2*P)+k);else q=M>0?-E:E,X=Math.max(0,-(M*q+N)),K=-X*X+q*(q+2*P)+k;return A&&A.copy(this.origin).addScaledVector(this.direction,X),b&&b.copy(n0).addScaledVector(s0,q),K}intersectSphere(a,d){Gl.subVectors(a.center,this.origin);const A=Gl.dot(this.direction),b=Gl.dot(Gl)-A*A,E=a.radius*a.radius;if(b>E)return null;const M=Math.sqrt(E-b),N=A-M,P=A+M;return P<0?null:N<0?this.at(P,d):this.at(N,d)}intersectsSphere(a){return this.distanceSqToPoint(a.center)<=a.radius*a.radius}distanceToPlane(a){const d=a.normal.dot(this.direction);if(d===0)return a.distanceToPoint(this.origin)===0?0:null;const A=-(this.origin.dot(a.normal)+a.constant)/d;return A>=0?A:null}intersectPlane(a,d){const A=this.distanceToPlane(a);return A===null?null:this.at(A,d)}intersectsPlane(a){const d=a.distanceToPoint(this.origin);return d===0||a.normal.dot(this.direction)*d<0}intersectBox(a,d){let A,b,E,M,N,P;const k=1/this.direction.x,j=1/this.direction.y,X=1/this.direction.z,q=this.origin;return k>=0?(A=(a.min.x-q.x)*k,b=(a.max.x-q.x)*k):(A=(a.max.x-q.x)*k,b=(a.min.x-q.x)*k),j>=0?(E=(a.min.y-q.y)*j,M=(a.max.y-q.y)*j):(E=(a.max.y-q.y)*j,M=(a.min.y-q.y)*j),A>M||E>b||((E>A||isNaN(A))&&(A=E),(M<b||isNaN(b))&&(b=M),X>=0?(N=(a.min.z-q.z)*X,P=(a.max.z-q.z)*X):(N=(a.max.z-q.z)*X,P=(a.min.z-q.z)*X),A>P||N>b)||((N>A||A!==A)&&(A=N),(P<b||b!==b)&&(b=P),b<0)?null:this.at(A>=0?A:b,d)}intersectsBox(a){return this.intersectBox(a,Gl)!==null}intersectTriangle(a,d,A,b,E){fv.subVectors(d,a),a0.subVectors(A,a),mv.crossVectors(fv,a0);let M=this.direction.dot(mv),N;if(M>0){if(b)return null;N=1}else if(M<0)N=-1,M=-M;else return null;ru.subVectors(this.origin,a);const P=N*this.direction.dot(a0.crossVectors(ru,a0));if(P<0)return null;const k=N*this.direction.dot(fv.cross(ru));if(k<0||P+k>M)return null;const j=-N*ru.dot(mv);return j<0?null:this.at(j/M,E)}applyMatrix4(a){return this.origin.applyMatrix4(a),this.direction.transformDirection(a),this}equals(a){return a.origin.equals(this.origin)&&a.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class mr{constructor(a,d,A,b,E,M,N,P,k,j,X,q,K,te,oe,re){mr.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],a!==void 0&&this.set(a,d,A,b,E,M,N,P,k,j,X,q,K,te,oe,re)}set(a,d,A,b,E,M,N,P,k,j,X,q,K,te,oe,re){const ee=this.elements;return ee[0]=a,ee[4]=d,ee[8]=A,ee[12]=b,ee[1]=E,ee[5]=M,ee[9]=N,ee[13]=P,ee[2]=k,ee[6]=j,ee[10]=X,ee[14]=q,ee[3]=K,ee[7]=te,ee[11]=oe,ee[15]=re,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new mr().fromArray(this.elements)}copy(a){const d=this.elements,A=a.elements;return d[0]=A[0],d[1]=A[1],d[2]=A[2],d[3]=A[3],d[4]=A[4],d[5]=A[5],d[6]=A[6],d[7]=A[7],d[8]=A[8],d[9]=A[9],d[10]=A[10],d[11]=A[11],d[12]=A[12],d[13]=A[13],d[14]=A[14],d[15]=A[15],this}copyPosition(a){const d=this.elements,A=a.elements;return d[12]=A[12],d[13]=A[13],d[14]=A[14],this}setFromMatrix3(a){const d=a.elements;return this.set(d[0],d[3],d[6],0,d[1],d[4],d[7],0,d[2],d[5],d[8],0,0,0,0,1),this}extractBasis(a,d,A){return a.setFromMatrixColumn(this,0),d.setFromMatrixColumn(this,1),A.setFromMatrixColumn(this,2),this}makeBasis(a,d,A){return this.set(a.x,d.x,A.x,0,a.y,d.y,A.y,0,a.z,d.z,A.z,0,0,0,0,1),this}extractRotation(a){const d=this.elements,A=a.elements,b=1/vh.setFromMatrixColumn(a,0).length(),E=1/vh.setFromMatrixColumn(a,1).length(),M=1/vh.setFromMatrixColumn(a,2).length();return d[0]=A[0]*b,d[1]=A[1]*b,d[2]=A[2]*b,d[3]=0,d[4]=A[4]*E,d[5]=A[5]*E,d[6]=A[6]*E,d[7]=0,d[8]=A[8]*M,d[9]=A[9]*M,d[10]=A[10]*M,d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,this}makeRotationFromEuler(a){const d=this.elements,A=a.x,b=a.y,E=a.z,M=Math.cos(A),N=Math.sin(A),P=Math.cos(b),k=Math.sin(b),j=Math.cos(E),X=Math.sin(E);if(a.order==="XYZ"){const q=M*j,K=M*X,te=N*j,oe=N*X;d[0]=P*j,d[4]=-P*X,d[8]=k,d[1]=K+te*k,d[5]=q-oe*k,d[9]=-N*P,d[2]=oe-q*k,d[6]=te+K*k,d[10]=M*P}else if(a.order==="YXZ"){const q=P*j,K=P*X,te=k*j,oe=k*X;d[0]=q+oe*N,d[4]=te*N-K,d[8]=M*k,d[1]=M*X,d[5]=M*j,d[9]=-N,d[2]=K*N-te,d[6]=oe+q*N,d[10]=M*P}else if(a.order==="ZXY"){const q=P*j,K=P*X,te=k*j,oe=k*X;d[0]=q-oe*N,d[4]=-M*X,d[8]=te+K*N,d[1]=K+te*N,d[5]=M*j,d[9]=oe-q*N,d[2]=-M*k,d[6]=N,d[10]=M*P}else if(a.order==="ZYX"){const q=M*j,K=M*X,te=N*j,oe=N*X;d[0]=P*j,d[4]=te*k-K,d[8]=q*k+oe,d[1]=P*X,d[5]=oe*k+q,d[9]=K*k-te,d[2]=-k,d[6]=N*P,d[10]=M*P}else if(a.order==="YZX"){const q=M*P,K=M*k,te=N*P,oe=N*k;d[0]=P*j,d[4]=oe-q*X,d[8]=te*X+K,d[1]=X,d[5]=M*j,d[9]=-N*j,d[2]=-k*j,d[6]=K*X+te,d[10]=q-oe*X}else if(a.order==="XZY"){const q=M*P,K=M*k,te=N*P,oe=N*k;d[0]=P*j,d[4]=-X,d[8]=k*j,d[1]=q*X+oe,d[5]=M*j,d[9]=K*X-te,d[2]=te*X-K,d[6]=N*j,d[10]=oe*X+q}return d[3]=0,d[7]=0,d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,this}makeRotationFromQuaternion(a){return this.compose(e2e,a,t2e)}lookAt(a,d,A){const b=this.elements;return Cl.subVectors(a,d),Cl.lengthSq()===0&&(Cl.z=1),Cl.normalize(),Pd.crossVectors(A,Cl),Pd.lengthSq()===0&&(Math.abs(A.z)===1?Cl.x+=1e-4:Cl.z+=1e-4,Cl.normalize(),Pd.crossVectors(A,Cl)),Pd.normalize(),OE.crossVectors(Cl,Pd),b[0]=Pd.x,b[4]=OE.x,b[8]=Cl.x,b[1]=Pd.y,b[5]=OE.y,b[9]=Cl.y,b[2]=Pd.z,b[6]=OE.z,b[10]=Cl.z,this}multiply(a){return this.multiplyMatrices(this,a)}premultiply(a){return this.multiplyMatrices(a,this)}multiplyMatrices(a,d){const A=a.elements,b=d.elements,E=this.elements,M=A[0],N=A[4],P=A[8],k=A[12],j=A[1],X=A[5],q=A[9],K=A[13],te=A[2],oe=A[6],re=A[10],ee=A[14],Me=A[3],we=A[7],_e=A[11],nt=A[15],qe=b[0],Je=b[4],it=b[8],ze=b[12],Oe=b[1],rt=b[5],mt=b[9],pt=b[13],Tt=b[2],Pt=b[6],hi=b[10],Di=b[14],kt=b[3],yi=b[7],Oi=b[11],jr=b[15];return E[0]=M*qe+N*Oe+P*Tt+k*kt,E[4]=M*Je+N*rt+P*Pt+k*yi,E[8]=M*it+N*mt+P*hi+k*Oi,E[12]=M*ze+N*pt+P*Di+k*jr,E[1]=j*qe+X*Oe+q*Tt+K*kt,E[5]=j*Je+X*rt+q*Pt+K*yi,E[9]=j*it+X*mt+q*hi+K*Oi,E[13]=j*ze+X*pt+q*Di+K*jr,E[2]=te*qe+oe*Oe+re*Tt+ee*kt,E[6]=te*Je+oe*rt+re*Pt+ee*yi,E[10]=te*it+oe*mt+re*hi+ee*Oi,E[14]=te*ze+oe*pt+re*Di+ee*jr,E[3]=Me*qe+we*Oe+_e*Tt+nt*kt,E[7]=Me*Je+we*rt+_e*Pt+nt*yi,E[11]=Me*it+we*mt+_e*hi+nt*Oi,E[15]=Me*ze+we*pt+_e*Di+nt*jr,this}multiplyScalar(a){const d=this.elements;return d[0]*=a,d[4]*=a,d[8]*=a,d[12]*=a,d[1]*=a,d[5]*=a,d[9]*=a,d[13]*=a,d[2]*=a,d[6]*=a,d[10]*=a,d[14]*=a,d[3]*=a,d[7]*=a,d[11]*=a,d[15]*=a,this}determinant(){const a=this.elements,d=a[0],A=a[4],b=a[8],E=a[12],M=a[1],N=a[5],P=a[9],k=a[13],j=a[2],X=a[6],q=a[10],K=a[14],te=a[3],oe=a[7],re=a[11],ee=a[15];return te*(+E*P*X-b*k*X-E*N*q+A*k*q+b*N*K-A*P*K)+oe*(+d*P*K-d*k*q+E*M*q-b*M*K+b*k*j-E*P*j)+re*(+d*k*X-d*N*K-E*M*X+A*M*K+E*N*j-A*k*j)+ee*(-b*N*j-d*P*X+d*N*q+b*M*X-A*M*q+A*P*j)}transpose(){const a=this.elements;let d;return d=a[1],a[1]=a[4],a[4]=d,d=a[2],a[2]=a[8],a[8]=d,d=a[6],a[6]=a[9],a[9]=d,d=a[3],a[3]=a[12],a[12]=d,d=a[7],a[7]=a[13],a[13]=d,d=a[11],a[11]=a[14],a[14]=d,this}setPosition(a,d,A){const b=this.elements;return a.isVector3?(b[12]=a.x,b[13]=a.y,b[14]=a.z):(b[12]=a,b[13]=d,b[14]=A),this}invert(){const a=this.elements,d=a[0],A=a[1],b=a[2],E=a[3],M=a[4],N=a[5],P=a[6],k=a[7],j=a[8],X=a[9],q=a[10],K=a[11],te=a[12],oe=a[13],re=a[14],ee=a[15],Me=X*re*k-oe*q*k+oe*P*K-N*re*K-X*P*ee+N*q*ee,we=te*q*k-j*re*k-te*P*K+M*re*K+j*P*ee-M*q*ee,_e=j*oe*k-te*X*k+te*N*K-M*oe*K-j*N*ee+M*X*ee,nt=te*X*P-j*oe*P-te*N*q+M*oe*q+j*N*re-M*X*re,qe=d*Me+A*we+b*_e+E*nt;if(qe===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const Je=1/qe;return a[0]=Me*Je,a[1]=(oe*q*E-X*re*E-oe*b*K+A*re*K+X*b*ee-A*q*ee)*Je,a[2]=(N*re*E-oe*P*E+oe*b*k-A*re*k-N*b*ee+A*P*ee)*Je,a[3]=(X*P*E-N*q*E-X*b*k+A*q*k+N*b*K-A*P*K)*Je,a[4]=we*Je,a[5]=(j*re*E-te*q*E+te*b*K-d*re*K-j*b*ee+d*q*ee)*Je,a[6]=(te*P*E-M*re*E-te*b*k+d*re*k+M*b*ee-d*P*ee)*Je,a[7]=(M*q*E-j*P*E+j*b*k-d*q*k-M*b*K+d*P*K)*Je,a[8]=_e*Je,a[9]=(te*X*E-j*oe*E-te*A*K+d*oe*K+j*A*ee-d*X*ee)*Je,a[10]=(M*oe*E-te*N*E+te*A*k-d*oe*k-M*A*ee+d*N*ee)*Je,a[11]=(j*N*E-M*X*E-j*A*k+d*X*k+M*A*K-d*N*K)*Je,a[12]=nt*Je,a[13]=(j*oe*b-te*X*b+te*A*q-d*oe*q-j*A*re+d*X*re)*Je,a[14]=(te*N*b-M*oe*b-te*A*P+d*oe*P+M*A*re-d*N*re)*Je,a[15]=(M*X*b-j*N*b+j*A*P-d*X*P-M*A*q+d*N*q)*Je,this}scale(a){const d=this.elements,A=a.x,b=a.y,E=a.z;return d[0]*=A,d[4]*=b,d[8]*=E,d[1]*=A,d[5]*=b,d[9]*=E,d[2]*=A,d[6]*=b,d[10]*=E,d[3]*=A,d[7]*=b,d[11]*=E,this}getMaxScaleOnAxis(){const a=this.elements,d=a[0]*a[0]+a[1]*a[1]+a[2]*a[2],A=a[4]*a[4]+a[5]*a[5]+a[6]*a[6],b=a[8]*a[8]+a[9]*a[9]+a[10]*a[10];return Math.sqrt(Math.max(d,A,b))}makeTranslation(a,d,A){return a.isVector3?this.set(1,0,0,a.x,0,1,0,a.y,0,0,1,a.z,0,0,0,1):this.set(1,0,0,a,0,1,0,d,0,0,1,A,0,0,0,1),this}makeRotationX(a){const d=Math.cos(a),A=Math.sin(a);return this.set(1,0,0,0,0,d,-A,0,0,A,d,0,0,0,0,1),this}makeRotationY(a){const d=Math.cos(a),A=Math.sin(a);return this.set(d,0,A,0,0,1,0,0,-A,0,d,0,0,0,0,1),this}makeRotationZ(a){const d=Math.cos(a),A=Math.sin(a);return this.set(d,-A,0,0,A,d,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(a,d){const A=Math.cos(d),b=Math.sin(d),E=1-A,M=a.x,N=a.y,P=a.z,k=E*M,j=E*N;return this.set(k*M+A,k*N-b*P,k*P+b*N,0,k*N+b*P,j*N+A,j*P-b*M,0,k*P-b*N,j*P+b*M,E*P*P+A,0,0,0,0,1),this}makeScale(a,d,A){return this.set(a,0,0,0,0,d,0,0,0,0,A,0,0,0,0,1),this}makeShear(a,d,A,b,E,M){return this.set(1,A,E,0,a,1,M,0,d,b,1,0,0,0,0,1),this}compose(a,d,A){const b=this.elements,E=d._x,M=d._y,N=d._z,P=d._w,k=E+E,j=M+M,X=N+N,q=E*k,K=E*j,te=E*X,oe=M*j,re=M*X,ee=N*X,Me=P*k,we=P*j,_e=P*X,nt=A.x,qe=A.y,Je=A.z;return b[0]=(1-(oe+ee))*nt,b[1]=(K+_e)*nt,b[2]=(te-we)*nt,b[3]=0,b[4]=(K-_e)*qe,b[5]=(1-(q+ee))*qe,b[6]=(re+Me)*qe,b[7]=0,b[8]=(te+we)*Je,b[9]=(re-Me)*Je,b[10]=(1-(q+oe))*Je,b[11]=0,b[12]=a.x,b[13]=a.y,b[14]=a.z,b[15]=1,this}decompose(a,d,A){const b=this.elements;let E=vh.set(b[0],b[1],b[2]).length();const M=vh.set(b[4],b[5],b[6]).length(),N=vh.set(b[8],b[9],b[10]).length();this.determinant()<0&&(E=-E),a.x=b[12],a.y=b[13],a.z=b[14],il.copy(this);const P=1/E,k=1/M,j=1/N;return il.elements[0]*=P,il.elements[1]*=P,il.elements[2]*=P,il.elements[4]*=k,il.elements[5]*=k,il.elements[6]*=k,il.elements[8]*=j,il.elements[9]*=j,il.elements[10]*=j,d.setFromRotationMatrix(il),A.x=E,A.y=M,A.z=N,this}makePerspective(a,d,A,b,E,M,N=Vl){const P=this.elements,k=2*E/(d-a),j=2*E/(A-b),X=(d+a)/(d-a),q=(A+b)/(A-b);let K,te;if(N===Vl)K=-(M+E)/(M-E),te=-2*M*E/(M-E);else if(N===hf)K=-M/(M-E),te=-M*E/(M-E);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+N);return P[0]=k,P[4]=0,P[8]=X,P[12]=0,P[1]=0,P[5]=j,P[9]=q,P[13]=0,P[2]=0,P[6]=0,P[10]=K,P[14]=te,P[3]=0,P[7]=0,P[11]=-1,P[15]=0,this}makeOrthographic(a,d,A,b,E,M,N=Vl){const P=this.elements,k=1/(d-a),j=1/(A-b),X=1/(M-E),q=(d+a)*k,K=(A+b)*j;let te,oe;if(N===Vl)te=(M+E)*X,oe=-2*X;else if(N===hf)te=E*X,oe=-1*X;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+N);return P[0]=2*k,P[4]=0,P[8]=0,P[12]=-q,P[1]=0,P[5]=2*j,P[9]=0,P[13]=-K,P[2]=0,P[6]=0,P[10]=oe,P[14]=-te,P[3]=0,P[7]=0,P[11]=0,P[15]=1,this}equals(a){const d=this.elements,A=a.elements;for(let b=0;b<16;b++)if(d[b]!==A[b])return!1;return!0}fromArray(a,d=0){for(let A=0;A<16;A++)this.elements[A]=a[A+d];return this}toArray(a=[],d=0){const A=this.elements;return a[d]=A[0],a[d+1]=A[1],a[d+2]=A[2],a[d+3]=A[3],a[d+4]=A[4],a[d+5]=A[5],a[d+6]=A[6],a[d+7]=A[7],a[d+8]=A[8],a[d+9]=A[9],a[d+10]=A[10],a[d+11]=A[11],a[d+12]=A[12],a[d+13]=A[13],a[d+14]=A[14],a[d+15]=A[15],a}}const vh=new He,il=new mr,e2e=new He(0,0,0),t2e=new He(1,1,1),Pd=new He,OE=new He,Cl=new He,uj=new mr,hj=new Wn;class Sl{constructor(a=0,d=0,A=0,b=Sl.DEFAULT_ORDER){this.isEuler=!0,this._x=a,this._y=d,this._z=A,this._order=b}get x(){return this._x}set x(a){this._x=a,this._onChangeCallback()}get y(){return this._y}set y(a){this._y=a,this._onChangeCallback()}get z(){return this._z}set z(a){this._z=a,this._onChangeCallback()}get order(){return this._order}set order(a){this._order=a,this._onChangeCallback()}set(a,d,A,b=this._order){return this._x=a,this._y=d,this._z=A,this._order=b,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(a){return this._x=a._x,this._y=a._y,this._z=a._z,this._order=a._order,this._onChangeCallback(),this}setFromRotationMatrix(a,d=this._order,A=!0){const b=a.elements,E=b[0],M=b[4],N=b[8],P=b[1],k=b[5],j=b[9],X=b[2],q=b[6],K=b[10];switch(d){case"XYZ":this._y=Math.asin(Ms(N,-1,1)),Math.abs(N)<.9999999?(this._x=Math.atan2(-j,K),this._z=Math.atan2(-M,E)):(this._x=Math.atan2(q,k),this._z=0);break;case"YXZ":this._x=Math.asin(-Ms(j,-1,1)),Math.abs(j)<.9999999?(this._y=Math.atan2(N,K),this._z=Math.atan2(P,k)):(this._y=Math.atan2(-X,E),this._z=0);break;case"ZXY":this._x=Math.asin(Ms(q,-1,1)),Math.abs(q)<.9999999?(this._y=Math.atan2(-X,K),this._z=Math.atan2(-M,k)):(this._y=0,this._z=Math.atan2(P,E));break;case"ZYX":this._y=Math.asin(-Ms(X,-1,1)),Math.abs(X)<.9999999?(this._x=Math.atan2(q,K),this._z=Math.atan2(P,E)):(this._x=0,this._z=Math.atan2(-M,k));break;case"YZX":this._z=Math.asin(Ms(P,-1,1)),Math.abs(P)<.9999999?(this._x=Math.atan2(-j,k),this._y=Math.atan2(-X,E)):(this._x=0,this._y=Math.atan2(N,K));break;case"XZY":this._z=Math.asin(-Ms(M,-1,1)),Math.abs(M)<.9999999?(this._x=Math.atan2(q,k),this._y=Math.atan2(N,E)):(this._x=Math.atan2(-j,K),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+d)}return this._order=d,A===!0&&this._onChangeCallback(),this}setFromQuaternion(a,d,A){return uj.makeRotationFromQuaternion(a),this.setFromRotationMatrix(uj,d,A)}setFromVector3(a,d=this._order){return this.set(a.x,a.y,a.z,d)}reorder(a){return hj.setFromEuler(this),this.setFromQuaternion(hj,a)}equals(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._order===this._order}fromArray(a){return this._x=a[0],this._y=a[1],this._z=a[2],a[3]!==void 0&&(this._order=a[3]),this._onChangeCallback(),this}toArray(a=[],d=0){return a[d]=this._x,a[d+1]=this._y,a[d+2]=this._z,a[d+3]=this._order,a}_onChange(a){return this._onChangeCallback=a,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Sl.DEFAULT_ORDER="XYZ";class PE{constructor(){this.mask=1}set(a){this.mask=(1<<a|0)>>>0}enable(a){this.mask|=1<<a|0}enableAll(){this.mask=-1}toggle(a){this.mask^=1<<a|0}disable(a){this.mask&=~(1<<a|0)}disableAll(){this.mask=0}test(a){return(this.mask&a.mask)!==0}isEnabled(a){return(this.mask&(1<<a|0))!==0}}let i2e=0;const dj=new He,o0=new Wn,xh=new mr,kE=new He,gv=new He,r2e=new He,n2e=new Wn,pj=new He(1,0,0),fj=new He(0,1,0),mj=new He(0,0,1),gj={type:"added"},s2e={type:"removed"},l0={type:"childadded",child:null},qB={type:"childremoved",child:null};class Qn extends Io{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:i2e++}),this.uuid=Bo(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Qn.DEFAULT_UP.clone();const a=new He,d=new Sl,A=new Wn,b=new He(1,1,1);function E(){A.setFromEuler(d,!1)}function M(){d.setFromQuaternion(A,void 0,!1)}d._onChange(E),A._onChange(M),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:a},rotation:{configurable:!0,enumerable:!0,value:d},quaternion:{configurable:!0,enumerable:!0,value:A},scale:{configurable:!0,enumerable:!0,value:b},modelViewMatrix:{value:new mr},normalMatrix:{value:new Kr}}),this.matrix=new mr,this.matrixWorld=new mr,this.matrixAutoUpdate=Qn.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Qn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new PE,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(a){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(a),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(a){return this.quaternion.premultiply(a),this}setRotationFromAxisAngle(a,d){this.quaternion.setFromAxisAngle(a,d)}setRotationFromEuler(a){this.quaternion.setFromEuler(a,!0)}setRotationFromMatrix(a){this.quaternion.setFromRotationMatrix(a)}setRotationFromQuaternion(a){this.quaternion.copy(a)}rotateOnAxis(a,d){return o0.setFromAxisAngle(a,d),this.quaternion.multiply(o0),this}rotateOnWorldAxis(a,d){return o0.setFromAxisAngle(a,d),this.quaternion.premultiply(o0),this}rotateX(a){return this.rotateOnAxis(pj,a)}rotateY(a){return this.rotateOnAxis(fj,a)}rotateZ(a){return this.rotateOnAxis(mj,a)}translateOnAxis(a,d){return dj.copy(a).applyQuaternion(this.quaternion),this.position.add(dj.multiplyScalar(d)),this}translateX(a){return this.translateOnAxis(pj,a)}translateY(a){return this.translateOnAxis(fj,a)}translateZ(a){return this.translateOnAxis(mj,a)}localToWorld(a){return this.updateWorldMatrix(!0,!1),a.applyMatrix4(this.matrixWorld)}worldToLocal(a){return this.updateWorldMatrix(!0,!1),a.applyMatrix4(xh.copy(this.matrixWorld).invert())}lookAt(a,d,A){a.isVector3?kE.copy(a):kE.set(a,d,A);const b=this.parent;this.updateWorldMatrix(!0,!1),gv.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?xh.lookAt(gv,kE,this.up):xh.lookAt(kE,gv,this.up),this.quaternion.setFromRotationMatrix(xh),b&&(xh.extractRotation(b.matrixWorld),o0.setFromRotationMatrix(xh),this.quaternion.premultiply(o0.invert()))}add(a){if(arguments.length>1){for(let d=0;d<arguments.length;d++)this.add(arguments[d]);return this}return a===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",a),this):(a&&a.isObject3D?(a.removeFromParent(),a.parent=this,this.children.push(a),a.dispatchEvent(gj),l0.child=a,this.dispatchEvent(l0),l0.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",a),this)}remove(a){if(arguments.length>1){for(let A=0;A<arguments.length;A++)this.remove(arguments[A]);return this}const d=this.children.indexOf(a);return d!==-1&&(a.parent=null,this.children.splice(d,1),a.dispatchEvent(s2e),qB.child=a,this.dispatchEvent(qB),qB.child=null),this}removeFromParent(){const a=this.parent;return a!==null&&a.remove(this),this}clear(){return this.remove(...this.children)}attach(a){return this.updateWorldMatrix(!0,!1),xh.copy(this.matrixWorld).invert(),a.parent!==null&&(a.parent.updateWorldMatrix(!0,!1),xh.multiply(a.parent.matrixWorld)),a.applyMatrix4(xh),a.removeFromParent(),a.parent=this,this.children.push(a),a.updateWorldMatrix(!1,!0),a.dispatchEvent(gj),l0.child=a,this.dispatchEvent(l0),l0.child=null,this}getObjectById(a){return this.getObjectByProperty("id",a)}getObjectByName(a){return this.getObjectByProperty("name",a)}getObjectByProperty(a,d){if(this[a]===d)return this;for(let A=0,b=this.children.length;A<b;A++){const E=this.children[A].getObjectByProperty(a,d);if(E!==void 0)return E}}getObjectsByProperty(a,d,A=[]){this[a]===d&&A.push(this);const b=this.children;for(let E=0,M=b.length;E<M;E++)b[E].getObjectsByProperty(a,d,A);return A}getWorldPosition(a){return this.updateWorldMatrix(!0,!1),a.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(a){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(gv,a,r2e),a}getWorldScale(a){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(gv,n2e,a),a}getWorldDirection(a){this.updateWorldMatrix(!0,!1);const d=this.matrixWorld.elements;return a.set(d[8],d[9],d[10]).normalize()}raycast(){}traverse(a){a(this);const d=this.children;for(let A=0,b=d.length;A<b;A++)d[A].traverse(a)}traverseVisible(a){if(this.visible===!1)return;a(this);const d=this.children;for(let A=0,b=d.length;A<b;A++)d[A].traverseVisible(a)}traverseAncestors(a){const d=this.parent;d!==null&&(a(d),d.traverseAncestors(a))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(a){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||a)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,a=!0);const d=this.children;for(let A=0,b=d.length;A<b;A++){const E=d[A];(E.matrixWorldAutoUpdate===!0||a===!0)&&E.updateMatrixWorld(a)}}updateWorldMatrix(a,d){const A=this.parent;if(a===!0&&A!==null&&A.matrixWorldAutoUpdate===!0&&A.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),d===!0){const b=this.children;for(let E=0,M=b.length;E<M;E++){const N=b[E];N.matrixWorldAutoUpdate===!0&&N.updateWorldMatrix(!1,!0)}}}toJSON(a){const d=a===void 0||typeof a=="string",A={};d&&(a={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},A.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const b={};b.uuid=this.uuid,b.type=this.type,this.name!==""&&(b.name=this.name),this.castShadow===!0&&(b.castShadow=!0),this.receiveShadow===!0&&(b.receiveShadow=!0),this.visible===!1&&(b.visible=!1),this.frustumCulled===!1&&(b.frustumCulled=!1),this.renderOrder!==0&&(b.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(b.userData=this.userData),b.layers=this.layers.mask,b.matrix=this.matrix.toArray(),b.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(b.matrixAutoUpdate=!1),this.isInstancedMesh&&(b.type="InstancedMesh",b.count=this.count,b.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(b.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(b.type="BatchedMesh",b.perObjectFrustumCulled=this.perObjectFrustumCulled,b.sortObjects=this.sortObjects,b.drawRanges=this._drawRanges,b.reservedRanges=this._reservedRanges,b.visibility=this._visibility,b.active=this._active,b.bounds=this._bounds.map(N=>({boxInitialized:N.boxInitialized,boxMin:N.box.min.toArray(),boxMax:N.box.max.toArray(),sphereInitialized:N.sphereInitialized,sphereRadius:N.sphere.radius,sphereCenter:N.sphere.center.toArray()})),b.maxGeometryCount=this._maxGeometryCount,b.maxVertexCount=this._maxVertexCount,b.maxIndexCount=this._maxIndexCount,b.geometryInitialized=this._geometryInitialized,b.geometryCount=this._geometryCount,b.matricesTexture=this._matricesTexture.toJSON(a),this.boundingSphere!==null&&(b.boundingSphere={center:b.boundingSphere.center.toArray(),radius:b.boundingSphere.radius}),this.boundingBox!==null&&(b.boundingBox={min:b.boundingBox.min.toArray(),max:b.boundingBox.max.toArray()}));function E(N,P){return N[P.uuid]===void 0&&(N[P.uuid]=P.toJSON(a)),P.uuid}if(this.isScene)this.background&&(this.background.isColor?b.background=this.background.toJSON():this.background.isTexture&&(b.background=this.background.toJSON(a).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(b.environment=this.environment.toJSON(a).uuid);else if(this.isMesh||this.isLine||this.isPoints){b.geometry=E(a.geometries,this.geometry);const N=this.geometry.parameters;if(N!==void 0&&N.shapes!==void 0){const P=N.shapes;if(Array.isArray(P))for(let k=0,j=P.length;k<j;k++){const X=P[k];E(a.shapes,X)}else E(a.shapes,P)}}if(this.isSkinnedMesh&&(b.bindMode=this.bindMode,b.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(E(a.skeletons,this.skeleton),b.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const N=[];for(let P=0,k=this.material.length;P<k;P++)N.push(E(a.materials,this.material[P]));b.material=N}else b.material=E(a.materials,this.material);if(this.children.length>0){b.children=[];for(let N=0;N<this.children.length;N++)b.children.push(this.children[N].toJSON(a).object)}if(this.animations.length>0){b.animations=[];for(let N=0;N<this.animations.length;N++){const P=this.animations[N];b.animations.push(E(a.animations,P))}}if(d){const N=M(a.geometries),P=M(a.materials),k=M(a.textures),j=M(a.images),X=M(a.shapes),q=M(a.skeletons),K=M(a.animations),te=M(a.nodes);N.length>0&&(A.geometries=N),P.length>0&&(A.materials=P),k.length>0&&(A.textures=k),j.length>0&&(A.images=j),X.length>0&&(A.shapes=X),q.length>0&&(A.skeletons=q),K.length>0&&(A.animations=K),te.length>0&&(A.nodes=te)}return A.object=b,A;function M(N){const P=[];for(const k in N){const j=N[k];delete j.metadata,P.push(j)}return P}}clone(a){return new this.constructor().copy(this,a)}copy(a,d=!0){if(this.name=a.name,this.up.copy(a.up),this.position.copy(a.position),this.rotation.order=a.rotation.order,this.quaternion.copy(a.quaternion),this.scale.copy(a.scale),this.matrix.copy(a.matrix),this.matrixWorld.copy(a.matrixWorld),this.matrixAutoUpdate=a.matrixAutoUpdate,this.matrixWorldAutoUpdate=a.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=a.matrixWorldNeedsUpdate,this.layers.mask=a.layers.mask,this.visible=a.visible,this.castShadow=a.castShadow,this.receiveShadow=a.receiveShadow,this.frustumCulled=a.frustumCulled,this.renderOrder=a.renderOrder,this.animations=a.animations.slice(),this.userData=JSON.parse(JSON.stringify(a.userData)),d===!0)for(let A=0;A<a.children.length;A++){const b=a.children[A];this.add(b.clone())}return this}}Qn.DEFAULT_UP=new He(0,1,0),Qn.DEFAULT_MATRIX_AUTO_UPDATE=!0,Qn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Bc=new He,bh=new He,XB=new He,_h=new He,c0=new He,u0=new He,Aj=new He,YB=new He,KB=new He,JB=new He;class Tl{constructor(a=new He,d=new He,A=new He){this.a=a,this.b=d,this.c=A}static getNormal(a,d,A,b){b.subVectors(A,d),Bc.subVectors(a,d),b.cross(Bc);const E=b.lengthSq();return E>0?b.multiplyScalar(1/Math.sqrt(E)):b.set(0,0,0)}static getBarycoord(a,d,A,b,E){Bc.subVectors(b,d),bh.subVectors(A,d),XB.subVectors(a,d);const M=Bc.dot(Bc),N=Bc.dot(bh),P=Bc.dot(XB),k=bh.dot(bh),j=bh.dot(XB),X=M*k-N*N;if(X===0)return E.set(0,0,0),null;const q=1/X,K=(k*P-N*j)*q,te=(M*j-N*P)*q;return E.set(1-K-te,te,K)}static containsPoint(a,d,A,b){return this.getBarycoord(a,d,A,b,_h)===null?!1:_h.x>=0&&_h.y>=0&&_h.x+_h.y<=1}static getInterpolation(a,d,A,b,E,M,N,P){return this.getBarycoord(a,d,A,b,_h)===null?(P.x=0,P.y=0,"z"in P&&(P.z=0),"w"in P&&(P.w=0),null):(P.setScalar(0),P.addScaledVector(E,_h.x),P.addScaledVector(M,_h.y),P.addScaledVector(N,_h.z),P)}static isFrontFacing(a,d,A,b){return Bc.subVectors(A,d),bh.subVectors(a,d),Bc.cross(bh).dot(b)<0}set(a,d,A){return this.a.copy(a),this.b.copy(d),this.c.copy(A),this}setFromPointsAndIndices(a,d,A,b){return this.a.copy(a[d]),this.b.copy(a[A]),this.c.copy(a[b]),this}setFromAttributeAndIndices(a,d,A,b){return this.a.fromBufferAttribute(a,d),this.b.fromBufferAttribute(a,A),this.c.fromBufferAttribute(a,b),this}clone(){return new this.constructor().copy(this)}copy(a){return this.a.copy(a.a),this.b.copy(a.b),this.c.copy(a.c),this}getArea(){return Bc.subVectors(this.c,this.b),bh.subVectors(this.a,this.b),Bc.cross(bh).length()*.5}getMidpoint(a){return a.addVectors(this.a,this.b).add(this.c).multiplyScalar(.3333333333333333)}getNormal(a){return Tl.getNormal(this.a,this.b,this.c,a)}getPlane(a){return a.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(a,d){return Tl.getBarycoord(a,this.a,this.b,this.c,d)}getInterpolation(a,d,A,b,E){return Tl.getInterpolation(a,this.a,this.b,this.c,d,A,b,E)}containsPoint(a){return Tl.containsPoint(a,this.a,this.b,this.c)}isFrontFacing(a){return Tl.isFrontFacing(this.a,this.b,this.c,a)}intersectsBox(a){return a.intersectsTriangle(this)}closestPointToPoint(a,d){const A=this.a,b=this.b,E=this.c;let M,N;c0.subVectors(b,A),u0.subVectors(E,A),YB.subVectors(a,A);const P=c0.dot(YB),k=u0.dot(YB);if(P<=0&&k<=0)return d.copy(A);KB.subVectors(a,b);const j=c0.dot(KB),X=u0.dot(KB);if(j>=0&&X<=j)return d.copy(b);const q=P*X-j*k;if(q<=0&&P>=0&&j<=0)return M=P/(P-j),d.copy(A).addScaledVector(c0,M);JB.subVectors(a,E);const K=c0.dot(JB),te=u0.dot(JB);if(te>=0&&K<=te)return d.copy(E);const oe=K*k-P*te;if(oe<=0&&k>=0&&te<=0)return N=k/(k-te),d.copy(A).addScaledVector(u0,N);const re=j*te-K*X;if(re<=0&&X-j>=0&&K-te>=0)return Aj.subVectors(E,b),N=(X-j)/(X-j+(K-te)),d.copy(b).addScaledVector(Aj,N);const ee=1/(re+oe+q);return M=oe*ee,N=q*ee,d.copy(A).addScaledVector(c0,M).addScaledVector(u0,N)}equals(a){return a.a.equals(this.a)&&a.b.equals(this.b)&&a.c.equals(this.c)}}const yj={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},kd={h:0,s:0,l:0},FE={h:0,s:0,l:0};function ZB(C,a,d){return d<0&&(d+=1),d>1&&(d-=1),d<.16666666666666666?C+(a-C)*6*d:d<.5?a:d<.6666666666666666?C+(a-C)*6*(.6666666666666666-d):C}class lr{constructor(a,d,A){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(a,d,A)}set(a,d,A){if(d===void 0&&A===void 0){const b=a;b&&b.isColor?this.copy(b):typeof b=="number"?this.setHex(b):typeof b=="string"&&this.setStyle(b)}else this.setRGB(a,d,A);return this}setScalar(a){return this.r=a,this.g=a,this.b=a,this}setHex(a,d=kn){return a=Math.floor(a),this.r=(a>>16&255)/255,this.g=(a>>8&255)/255,this.b=(a&255)/255,Zn.toWorkingColorSpace(this,d),this}setRGB(a,d,A,b=Zn.workingColorSpace){return this.r=a,this.g=d,this.b=A,Zn.toWorkingColorSpace(this,b),this}setHSL(a,d,A,b=Zn.workingColorSpace){if(a=hv(a,1),d=Ms(d,0,1),A=Ms(A,0,1),d===0)this.r=this.g=this.b=A;else{const E=A<=.5?A*(1+d):A+d-A*d,M=2*A-E;this.r=ZB(M,E,a+.3333333333333333),this.g=ZB(M,E,a),this.b=ZB(M,E,a-.3333333333333333)}return Zn.toWorkingColorSpace(this,b),this}setStyle(a,d=kn){function A(E){E!==void 0&&parseFloat(E)<1&&console.warn("THREE.Color: Alpha component of "+a+" will be ignored.")}let b;if(b=/^(\w+)\(([^\)]*)\)/.exec(a)){let E;const M=b[1],N=b[2];switch(M){case"rgb":case"rgba":if(E=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(N))return A(E[4]),this.setRGB(Math.min(255,parseInt(E[1],10))/255,Math.min(255,parseInt(E[2],10))/255,Math.min(255,parseInt(E[3],10))/255,d);if(E=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(N))return A(E[4]),this.setRGB(Math.min(100,parseInt(E[1],10))/100,Math.min(100,parseInt(E[2],10))/100,Math.min(100,parseInt(E[3],10))/100,d);break;case"hsl":case"hsla":if(E=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(N))return A(E[4]),this.setHSL(parseFloat(E[1])/360,parseFloat(E[2])/100,parseFloat(E[3])/100,d);break;default:console.warn("THREE.Color: Unknown color model "+a)}}else if(b=/^\#([A-Fa-f\d]+)$/.exec(a)){const E=b[1],M=E.length;if(M===3)return this.setRGB(parseInt(E.charAt(0),16)/15,parseInt(E.charAt(1),16)/15,parseInt(E.charAt(2),16)/15,d);if(M===6)return this.setHex(parseInt(E,16),d);console.warn("THREE.Color: Invalid hex color "+a)}else if(a&&a.length>0)return this.setColorName(a,d);return this}setColorName(a,d=kn){const A=yj[a.toLowerCase()];return A!==void 0?this.setHex(A,d):console.warn("THREE.Color: Unknown color "+a),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(a){return this.r=a.r,this.g=a.g,this.b=a.b,this}copySRGBToLinear(a){return this.r=Ld(a.r),this.g=Ld(a.g),this.b=Ld(a.b),this}copyLinearToSRGB(a){return this.r=pv(a.r),this.g=pv(a.g),this.b=pv(a.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(a=kn){return Zn.fromWorkingColorSpace(ho.copy(this),a),Math.round(Ms(ho.r*255,0,255))*65536+Math.round(Ms(ho.g*255,0,255))*256+Math.round(Ms(ho.b*255,0,255))}getHexString(a=kn){return("000000"+this.getHex(a).toString(16)).slice(-6)}getHSL(a,d=Zn.workingColorSpace){Zn.fromWorkingColorSpace(ho.copy(this),d);const A=ho.r,b=ho.g,E=ho.b,M=Math.max(A,b,E),N=Math.min(A,b,E);let P,k;const j=(N+M)/2;if(N===M)P=0,k=0;else{const X=M-N;switch(k=j<=.5?X/(M+N):X/(2-M-N),M){case A:P=(b-E)/X+(b<E?6:0);break;case b:P=(E-A)/X+2;break;case E:P=(A-b)/X+4;break}P/=6}return a.h=P,a.s=k,a.l=j,a}getRGB(a,d=Zn.workingColorSpace){return Zn.fromWorkingColorSpace(ho.copy(this),d),a.r=ho.r,a.g=ho.g,a.b=ho.b,a}getStyle(a=kn){Zn.fromWorkingColorSpace(ho.copy(this),a);const d=ho.r,A=ho.g,b=ho.b;return a!==kn?`color(${a} ${d.toFixed(3)} ${A.toFixed(3)} ${b.toFixed(3)})`:`rgb(${Math.round(d*255)},${Math.round(A*255)},${Math.round(b*255)})`}offsetHSL(a,d,A){return this.getHSL(kd),this.setHSL(kd.h+a,kd.s+d,kd.l+A)}add(a){return this.r+=a.r,this.g+=a.g,this.b+=a.b,this}addColors(a,d){return this.r=a.r+d.r,this.g=a.g+d.g,this.b=a.b+d.b,this}addScalar(a){return this.r+=a,this.g+=a,this.b+=a,this}sub(a){return this.r=Math.max(0,this.r-a.r),this.g=Math.max(0,this.g-a.g),this.b=Math.max(0,this.b-a.b),this}multiply(a){return this.r*=a.r,this.g*=a.g,this.b*=a.b,this}multiplyScalar(a){return this.r*=a,this.g*=a,this.b*=a,this}lerp(a,d){return this.r+=(a.r-this.r)*d,this.g+=(a.g-this.g)*d,this.b+=(a.b-this.b)*d,this}lerpColors(a,d,A){return this.r=a.r+(d.r-a.r)*A,this.g=a.g+(d.g-a.g)*A,this.b=a.b+(d.b-a.b)*A,this}lerpHSL(a,d){this.getHSL(kd),a.getHSL(FE);const A=df(kd.h,FE.h,d),b=df(kd.s,FE.s,d),E=df(kd.l,FE.l,d);return this.setHSL(A,b,E),this}setFromVector3(a){return this.r=a.x,this.g=a.y,this.b=a.z,this}applyMatrix3(a){const d=this.r,A=this.g,b=this.b,E=a.elements;return this.r=E[0]*d+E[3]*A+E[6]*b,this.g=E[1]*d+E[4]*A+E[7]*b,this.b=E[2]*d+E[5]*A+E[8]*b,this}equals(a){return a.r===this.r&&a.g===this.g&&a.b===this.b}fromArray(a,d=0){return this.r=a[d],this.g=a[d+1],this.b=a[d+2],this}toArray(a=[],d=0){return a[d]=this.r,a[d+1]=this.g,a[d+2]=this.b,a}fromBufferAttribute(a,d){return this.r=a.getX(d),this.g=a.getY(d),this.b=a.getZ(d),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const ho=new lr;lr.NAMES=yj;let a2e=0;class po extends Io{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:a2e++}),this.uuid=Bo(),this.name="",this.type="Material",this.blending=D,this.side=S,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=xe,this.blendDst=fe,this.blendEquation=G,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new lr(0,0,0),this.blendAlpha=0,this.depthFunc=di,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=lv,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=mh,this.stencilZFail=mh,this.stencilZPass=mh,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(a){this._alphaTest>0!=a>0&&this.version++,this._alphaTest=a}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(a){if(a!==void 0)for(const d in a){const A=a[d];if(A===void 0){console.warn(`THREE.Material: parameter '${d}' has value of undefined.`);continue}const b=this[d];if(b===void 0){console.warn(`THREE.Material: '${d}' is not a property of THREE.${this.type}.`);continue}b&&b.isColor?b.set(A):b&&b.isVector3&&A&&A.isVector3?b.copy(A):this[d]=A}}toJSON(a){const d=a===void 0||typeof a=="string";d&&(a={textures:{},images:{}});const A={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};A.uuid=this.uuid,A.type=this.type,this.name!==""&&(A.name=this.name),this.color&&this.color.isColor&&(A.color=this.color.getHex()),this.roughness!==void 0&&(A.roughness=this.roughness),this.metalness!==void 0&&(A.metalness=this.metalness),this.sheen!==void 0&&(A.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(A.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(A.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(A.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(A.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(A.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(A.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(A.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(A.shininess=this.shininess),this.clearcoat!==void 0&&(A.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(A.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(A.clearcoatMap=this.clearcoatMap.toJSON(a).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(A.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(a).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(A.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(a).uuid,A.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(A.dispersion=this.dispersion),this.iridescence!==void 0&&(A.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(A.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(A.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(A.iridescenceMap=this.iridescenceMap.toJSON(a).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(A.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(a).uuid),this.anisotropy!==void 0&&(A.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(A.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(A.anisotropyMap=this.anisotropyMap.toJSON(a).uuid),this.map&&this.map.isTexture&&(A.map=this.map.toJSON(a).uuid),this.matcap&&this.matcap.isTexture&&(A.matcap=this.matcap.toJSON(a).uuid),this.alphaMap&&this.alphaMap.isTexture&&(A.alphaMap=this.alphaMap.toJSON(a).uuid),this.lightMap&&this.lightMap.isTexture&&(A.lightMap=this.lightMap.toJSON(a).uuid,A.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(A.aoMap=this.aoMap.toJSON(a).uuid,A.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(A.bumpMap=this.bumpMap.toJSON(a).uuid,A.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(A.normalMap=this.normalMap.toJSON(a).uuid,A.normalMapType=this.normalMapType,A.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(A.displacementMap=this.displacementMap.toJSON(a).uuid,A.displacementScale=this.displacementScale,A.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(A.roughnessMap=this.roughnessMap.toJSON(a).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(A.metalnessMap=this.metalnessMap.toJSON(a).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(A.emissiveMap=this.emissiveMap.toJSON(a).uuid),this.specularMap&&this.specularMap.isTexture&&(A.specularMap=this.specularMap.toJSON(a).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(A.specularIntensityMap=this.specularIntensityMap.toJSON(a).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(A.specularColorMap=this.specularColorMap.toJSON(a).uuid),this.envMap&&this.envMap.isTexture&&(A.envMap=this.envMap.toJSON(a).uuid,this.combine!==void 0&&(A.combine=this.combine)),this.envMapRotation!==void 0&&(A.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(A.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(A.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(A.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(A.gradientMap=this.gradientMap.toJSON(a).uuid),this.transmission!==void 0&&(A.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(A.transmissionMap=this.transmissionMap.toJSON(a).uuid),this.thickness!==void 0&&(A.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(A.thicknessMap=this.thicknessMap.toJSON(a).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(A.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(A.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(A.size=this.size),this.shadowSide!==null&&(A.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(A.sizeAttenuation=this.sizeAttenuation),this.blending!==D&&(A.blending=this.blending),this.side!==S&&(A.side=this.side),this.vertexColors===!0&&(A.vertexColors=!0),this.opacity<1&&(A.opacity=this.opacity),this.transparent===!0&&(A.transparent=!0),this.blendSrc!==xe&&(A.blendSrc=this.blendSrc),this.blendDst!==fe&&(A.blendDst=this.blendDst),this.blendEquation!==G&&(A.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(A.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(A.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(A.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(A.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(A.blendAlpha=this.blendAlpha),this.depthFunc!==di&&(A.depthFunc=this.depthFunc),this.depthTest===!1&&(A.depthTest=this.depthTest),this.depthWrite===!1&&(A.depthWrite=this.depthWrite),this.colorWrite===!1&&(A.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(A.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==lv&&(A.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(A.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(A.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==mh&&(A.stencilFail=this.stencilFail),this.stencilZFail!==mh&&(A.stencilZFail=this.stencilZFail),this.stencilZPass!==mh&&(A.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(A.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(A.rotation=this.rotation),this.polygonOffset===!0&&(A.polygonOffset=!0),this.polygonOffsetFactor!==0&&(A.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(A.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(A.linewidth=this.linewidth),this.dashSize!==void 0&&(A.dashSize=this.dashSize),this.gapSize!==void 0&&(A.gapSize=this.gapSize),this.scale!==void 0&&(A.scale=this.scale),this.dithering===!0&&(A.dithering=!0),this.alphaTest>0&&(A.alphaTest=this.alphaTest),this.alphaHash===!0&&(A.alphaHash=!0),this.alphaToCoverage===!0&&(A.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(A.premultipliedAlpha=!0),this.forceSinglePass===!0&&(A.forceSinglePass=!0),this.wireframe===!0&&(A.wireframe=!0),this.wireframeLinewidth>1&&(A.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(A.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(A.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(A.flatShading=!0),this.visible===!1&&(A.visible=!1),this.toneMapped===!1&&(A.toneMapped=!1),this.fog===!1&&(A.fog=!1),Object.keys(this.userData).length>0&&(A.userData=this.userData);function b(E){const M=[];for(const N in E){const P=E[N];delete P.metadata,M.push(P)}return M}if(d){const E=b(a.textures),M=b(a.images);E.length>0&&(A.textures=E),M.length>0&&(A.images=M)}return A}clone(){return new this.constructor().copy(this)}copy(a){this.name=a.name,this.blending=a.blending,this.side=a.side,this.vertexColors=a.vertexColors,this.opacity=a.opacity,this.transparent=a.transparent,this.blendSrc=a.blendSrc,this.blendDst=a.blendDst,this.blendEquation=a.blendEquation,this.blendSrcAlpha=a.blendSrcAlpha,this.blendDstAlpha=a.blendDstAlpha,this.blendEquationAlpha=a.blendEquationAlpha,this.blendColor.copy(a.blendColor),this.blendAlpha=a.blendAlpha,this.depthFunc=a.depthFunc,this.depthTest=a.depthTest,this.depthWrite=a.depthWrite,this.stencilWriteMask=a.stencilWriteMask,this.stencilFunc=a.stencilFunc,this.stencilRef=a.stencilRef,this.stencilFuncMask=a.stencilFuncMask,this.stencilFail=a.stencilFail,this.stencilZFail=a.stencilZFail,this.stencilZPass=a.stencilZPass,this.stencilWrite=a.stencilWrite;const d=a.clippingPlanes;let A=null;if(d!==null){const b=d.length;A=new Array(b);for(let E=0;E!==b;++E)A[E]=d[E].clone()}return this.clippingPlanes=A,this.clipIntersection=a.clipIntersection,this.clipShadows=a.clipShadows,this.shadowSide=a.shadowSide,this.colorWrite=a.colorWrite,this.precision=a.precision,this.polygonOffset=a.polygonOffset,this.polygonOffsetFactor=a.polygonOffsetFactor,this.polygonOffsetUnits=a.polygonOffsetUnits,this.dithering=a.dithering,this.alphaTest=a.alphaTest,this.alphaHash=a.alphaHash,this.alphaToCoverage=a.alphaToCoverage,this.premultipliedAlpha=a.premultipliedAlpha,this.forceSinglePass=a.forceSinglePass,this.visible=a.visible,this.toneMapped=a.toneMapped,this.userData=JSON.parse(JSON.stringify(a.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(a){a===!0&&this.version++}}class Fd extends po{constructor(a){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new lr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Sl,this.combine=Qe,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.color.copy(a.color),this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.specularMap=a.specularMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.envMapRotation.copy(a.envMapRotation),this.combine=a.combine,this.reflectivity=a.reflectivity,this.refractionRatio=a.refractionRatio,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.fog=a.fog,this}}const Eh=o2e();function o2e(){const C=new ArrayBuffer(4),a=new Float32Array(C),d=new Uint32Array(C),A=new Uint32Array(512),b=new Uint32Array(512);for(let P=0;P<256;++P){const k=P-127;k<-27?(A[P]=0,A[P|256]=32768,b[P]=24,b[P|256]=24):k<-14?(A[P]=1024>>-k-14,A[P|256]=1024>>-k-14|32768,b[P]=-k-1,b[P|256]=-k-1):k<=15?(A[P]=k+15<<10,A[P|256]=k+15<<10|32768,b[P]=13,b[P|256]=13):k<128?(A[P]=31744,A[P|256]=64512,b[P]=24,b[P|256]=24):(A[P]=31744,A[P|256]=64512,b[P]=13,b[P|256]=13)}const E=new Uint32Array(2048),M=new Uint32Array(64),N=new Uint32Array(64);for(let P=1;P<1024;++P){let k=P<<13,j=0;for(;!(k&8388608);)k<<=1,j-=8388608;k&=-8388609,j+=947912704,E[P]=k|j}for(let P=1024;P<2048;++P)E[P]=939524096+(P-1024<<13);for(let P=1;P<31;++P)M[P]=P<<23;M[31]=1199570944,M[32]=2147483648;for(let P=33;P<63;++P)M[P]=2147483648+(P-32<<23);M[63]=3347054592;for(let P=1;P<64;++P)P!==32&&(N[P]=1024);return{floatView:a,uint32View:d,baseTable:A,shiftTable:b,mantissaTable:E,exponentTable:M,offsetTable:N}}function rl(C){Math.abs(C)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),C=Ms(C,-65504,65504),Eh.floatView[0]=C;const a=Eh.uint32View[0],d=a>>23&511;return Eh.baseTable[d]+((a&8388607)>>Eh.shiftTable[d])}function Av(C){const a=C>>10;return Eh.uint32View[0]=Eh.mantissaTable[Eh.offsetTable[a]+(C&1023)]+Eh.exponentTable[a],Eh.floatView[0]}const l2e={toHalfFloat:rl,fromHalfFloat:Av},ca=new He,UE=new si;class ls{constructor(a,d,A=!1){if(Array.isArray(a))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=a,this.itemSize=d,this.count=a!==void 0?a.length/d:0,this.normalized=A,this.usage=uf,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=St,this.version=0}onUploadCallback(){}set needsUpdate(a){a===!0&&this.version++}get updateRange(){return IE("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(a){return this.usage=a,this}addUpdateRange(a,d){this.updateRanges.push({start:a,count:d})}clearUpdateRanges(){this.updateRanges.length=0}copy(a){return this.name=a.name,this.array=new a.array.constructor(a.array),this.itemSize=a.itemSize,this.count=a.count,this.normalized=a.normalized,this.usage=a.usage,this.gpuType=a.gpuType,this}copyAt(a,d,A){a*=this.itemSize,A*=d.itemSize;for(let b=0,E=this.itemSize;b<E;b++)this.array[a+b]=d.array[A+b];return this}copyArray(a){return this.array.set(a),this}applyMatrix3(a){if(this.itemSize===2)for(let d=0,A=this.count;d<A;d++)UE.fromBufferAttribute(this,d),UE.applyMatrix3(a),this.setXY(d,UE.x,UE.y);else if(this.itemSize===3)for(let d=0,A=this.count;d<A;d++)ca.fromBufferAttribute(this,d),ca.applyMatrix3(a),this.setXYZ(d,ca.x,ca.y,ca.z);return this}applyMatrix4(a){for(let d=0,A=this.count;d<A;d++)ca.fromBufferAttribute(this,d),ca.applyMatrix4(a),this.setXYZ(d,ca.x,ca.y,ca.z);return this}applyNormalMatrix(a){for(let d=0,A=this.count;d<A;d++)ca.fromBufferAttribute(this,d),ca.applyNormalMatrix(a),this.setXYZ(d,ca.x,ca.y,ca.z);return this}transformDirection(a){for(let d=0,A=this.count;d<A;d++)ca.fromBufferAttribute(this,d),ca.transformDirection(a),this.setXYZ(d,ca.x,ca.y,ca.z);return this}set(a,d=0){return this.array.set(a,d),this}getComponent(a,d){let A=this.array[a*this.itemSize+d];return this.normalized&&(A=Ya(A,this.array)),A}setComponent(a,d,A){return this.normalized&&(A=Zr(A,this.array)),this.array[a*this.itemSize+d]=A,this}getX(a){let d=this.array[a*this.itemSize];return this.normalized&&(d=Ya(d,this.array)),d}setX(a,d){return this.normalized&&(d=Zr(d,this.array)),this.array[a*this.itemSize]=d,this}getY(a){let d=this.array[a*this.itemSize+1];return this.normalized&&(d=Ya(d,this.array)),d}setY(a,d){return this.normalized&&(d=Zr(d,this.array)),this.array[a*this.itemSize+1]=d,this}getZ(a){let d=this.array[a*this.itemSize+2];return this.normalized&&(d=Ya(d,this.array)),d}setZ(a,d){return this.normalized&&(d=Zr(d,this.array)),this.array[a*this.itemSize+2]=d,this}getW(a){let d=this.array[a*this.itemSize+3];return this.normalized&&(d=Ya(d,this.array)),d}setW(a,d){return this.normalized&&(d=Zr(d,this.array)),this.array[a*this.itemSize+3]=d,this}setXY(a,d,A){return a*=this.itemSize,this.normalized&&(d=Zr(d,this.array),A=Zr(A,this.array)),this.array[a+0]=d,this.array[a+1]=A,this}setXYZ(a,d,A,b){return a*=this.itemSize,this.normalized&&(d=Zr(d,this.array),A=Zr(A,this.array),b=Zr(b,this.array)),this.array[a+0]=d,this.array[a+1]=A,this.array[a+2]=b,this}setXYZW(a,d,A,b,E){return a*=this.itemSize,this.normalized&&(d=Zr(d,this.array),A=Zr(A,this.array),b=Zr(b,this.array),E=Zr(E,this.array)),this.array[a+0]=d,this.array[a+1]=A,this.array[a+2]=b,this.array[a+3]=E,this}onUpload(a){return this.onUploadCallback=a,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const a={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(a.name=this.name),this.usage!==uf&&(a.usage=this.usage),a}}class c2e extends ls{constructor(a,d,A){super(new Int8Array(a),d,A)}}class u2e extends ls{constructor(a,d,A){super(new Uint8Array(a),d,A)}}class h2e extends ls{constructor(a,d,A){super(new Uint8ClampedArray(a),d,A)}}class d2e extends ls{constructor(a,d,A){super(new Int16Array(a),d,A)}}class $B extends ls{constructor(a,d,A){super(new Uint16Array(a),d,A)}}class p2e extends ls{constructor(a,d,A){super(new Int32Array(a),d,A)}}class eN extends ls{constructor(a,d,A){super(new Uint32Array(a),d,A)}}class f2e extends ls{constructor(a,d,A){super(new Uint16Array(a),d,A),this.isFloat16BufferAttribute=!0}getX(a){let d=Av(this.array[a*this.itemSize]);return this.normalized&&(d=Ya(d,this.array)),d}setX(a,d){return this.normalized&&(d=Zr(d,this.array)),this.array[a*this.itemSize]=rl(d),this}getY(a){let d=Av(this.array[a*this.itemSize+1]);return this.normalized&&(d=Ya(d,this.array)),d}setY(a,d){return this.normalized&&(d=Zr(d,this.array)),this.array[a*this.itemSize+1]=rl(d),this}getZ(a){let d=Av(this.array[a*this.itemSize+2]);return this.normalized&&(d=Ya(d,this.array)),d}setZ(a,d){return this.normalized&&(d=Zr(d,this.array)),this.array[a*this.itemSize+2]=rl(d),this}getW(a){let d=Av(this.array[a*this.itemSize+3]);return this.normalized&&(d=Ya(d,this.array)),d}setW(a,d){return this.normalized&&(d=Zr(d,this.array)),this.array[a*this.itemSize+3]=rl(d),this}setXY(a,d,A){return a*=this.itemSize,this.normalized&&(d=Zr(d,this.array),A=Zr(A,this.array)),this.array[a+0]=rl(d),this.array[a+1]=rl(A),this}setXYZ(a,d,A,b){return a*=this.itemSize,this.normalized&&(d=Zr(d,this.array),A=Zr(A,this.array),b=Zr(b,this.array)),this.array[a+0]=rl(d),this.array[a+1]=rl(A),this.array[a+2]=rl(b),this}setXYZW(a,d,A,b,E){return a*=this.itemSize,this.normalized&&(d=Zr(d,this.array),A=Zr(A,this.array),b=Zr(b,this.array),E=Zr(E,this.array)),this.array[a+0]=rl(d),this.array[a+1]=rl(A),this.array[a+2]=rl(b),this.array[a+3]=rl(E),this}}class br extends ls{constructor(a,d,A){super(new Float32Array(a),d,A)}}let m2e=0;const Hl=new mr,tN=new Qn,h0=new He,Ml=new Ds,yv=new Ds,Pa=new He;class fn extends Io{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:m2e++}),this.uuid=Bo(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(a){return Array.isArray(a)?this.index=new(TE(a)?eN:$B)(a,1):this.index=a,this}getAttribute(a){return this.attributes[a]}setAttribute(a,d){return this.attributes[a]=d,this}deleteAttribute(a){return delete this.attributes[a],this}hasAttribute(a){return this.attributes[a]!==void 0}addGroup(a,d,A=0){this.groups.push({start:a,count:d,materialIndex:A})}clearGroups(){this.groups=[]}setDrawRange(a,d){this.drawRange.start=a,this.drawRange.count=d}applyMatrix4(a){const d=this.attributes.position;d!==void 0&&(d.applyMatrix4(a),d.needsUpdate=!0);const A=this.attributes.normal;if(A!==void 0){const E=new Kr().getNormalMatrix(a);A.applyNormalMatrix(E),A.needsUpdate=!0}const b=this.attributes.tangent;return b!==void 0&&(b.transformDirection(a),b.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(a){return Hl.makeRotationFromQuaternion(a),this.applyMatrix4(Hl),this}rotateX(a){return Hl.makeRotationX(a),this.applyMatrix4(Hl),this}rotateY(a){return Hl.makeRotationY(a),this.applyMatrix4(Hl),this}rotateZ(a){return Hl.makeRotationZ(a),this.applyMatrix4(Hl),this}translate(a,d,A){return Hl.makeTranslation(a,d,A),this.applyMatrix4(Hl),this}scale(a,d,A){return Hl.makeScale(a,d,A),this.applyMatrix4(Hl),this}lookAt(a){return tN.lookAt(a),tN.updateMatrix(),this.applyMatrix4(tN.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(h0).negate(),this.translate(h0.x,h0.y,h0.z),this}setFromPoints(a){const d=[];for(let A=0,b=a.length;A<b;A++){const E=a[A];d.push(E.x,E.y,E.z||0)}return this.setAttribute("position",new br(d,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Ds);const a=this.attributes.position,d=this.morphAttributes.position;if(a&&a.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new He(-1/0,-1/0,-1/0),new He(1/0,1/0,1/0));return}if(a!==void 0){if(this.boundingBox.setFromBufferAttribute(a),d)for(let A=0,b=d.length;A<b;A++){const E=d[A];Ml.setFromBufferAttribute(E),this.morphTargetsRelative?(Pa.addVectors(this.boundingBox.min,Ml.min),this.boundingBox.expandByPoint(Pa),Pa.addVectors(this.boundingBox.max,Ml.max),this.boundingBox.expandByPoint(Pa)):(this.boundingBox.expandByPoint(Ml.min),this.boundingBox.expandByPoint(Ml.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new ya);const a=this.attributes.position,d=this.morphAttributes.position;if(a&&a.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new He,1/0);return}if(a){const A=this.boundingSphere.center;if(Ml.setFromBufferAttribute(a),d)for(let E=0,M=d.length;E<M;E++){const N=d[E];yv.setFromBufferAttribute(N),this.morphTargetsRelative?(Pa.addVectors(Ml.min,yv.min),Ml.expandByPoint(Pa),Pa.addVectors(Ml.max,yv.max),Ml.expandByPoint(Pa)):(Ml.expandByPoint(yv.min),Ml.expandByPoint(yv.max))}Ml.getCenter(A);let b=0;for(let E=0,M=a.count;E<M;E++)Pa.fromBufferAttribute(a,E),b=Math.max(b,A.distanceToSquared(Pa));if(d)for(let E=0,M=d.length;E<M;E++){const N=d[E],P=this.morphTargetsRelative;for(let k=0,j=N.count;k<j;k++)Pa.fromBufferAttribute(N,k),P&&(h0.fromBufferAttribute(a,k),Pa.add(h0)),b=Math.max(b,A.distanceToSquared(Pa))}this.boundingSphere.radius=Math.sqrt(b),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const a=this.index,d=this.attributes;if(a===null||d.position===void 0||d.normal===void 0||d.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const A=d.position,b=d.normal,E=d.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new ls(new Float32Array(4*A.count),4));const M=this.getAttribute("tangent"),N=[],P=[];for(let it=0;it<A.count;it++)N[it]=new He,P[it]=new He;const k=new He,j=new He,X=new He,q=new si,K=new si,te=new si,oe=new He,re=new He;function ee(it,ze,Oe){k.fromBufferAttribute(A,it),j.fromBufferAttribute(A,ze),X.fromBufferAttribute(A,Oe),q.fromBufferAttribute(E,it),K.fromBufferAttribute(E,ze),te.fromBufferAttribute(E,Oe),j.sub(k),X.sub(k),K.sub(q),te.sub(q);const rt=1/(K.x*te.y-te.x*K.y);isFinite(rt)&&(oe.copy(j).multiplyScalar(te.y).addScaledVector(X,-K.y).multiplyScalar(rt),re.copy(X).multiplyScalar(K.x).addScaledVector(j,-te.x).multiplyScalar(rt),N[it].add(oe),N[ze].add(oe),N[Oe].add(oe),P[it].add(re),P[ze].add(re),P[Oe].add(re))}let Me=this.groups;Me.length===0&&(Me=[{start:0,count:a.count}]);for(let it=0,ze=Me.length;it<ze;++it){const Oe=Me[it],rt=Oe.start,mt=Oe.count;for(let pt=rt,Tt=rt+mt;pt<Tt;pt+=3)ee(a.getX(pt+0),a.getX(pt+1),a.getX(pt+2))}const we=new He,_e=new He,nt=new He,qe=new He;function Je(it){nt.fromBufferAttribute(b,it),qe.copy(nt);const ze=N[it];we.copy(ze),we.sub(nt.multiplyScalar(nt.dot(ze))).normalize(),_e.crossVectors(qe,ze);const Oe=_e.dot(P[it])<0?-1:1;M.setXYZW(it,we.x,we.y,we.z,Oe)}for(let it=0,ze=Me.length;it<ze;++it){const Oe=Me[it],rt=Oe.start,mt=Oe.count;for(let pt=rt,Tt=rt+mt;pt<Tt;pt+=3)Je(a.getX(pt+0)),Je(a.getX(pt+1)),Je(a.getX(pt+2))}}computeVertexNormals(){const a=this.index,d=this.getAttribute("position");if(d!==void 0){let A=this.getAttribute("normal");if(A===void 0)A=new ls(new Float32Array(d.count*3),3),this.setAttribute("normal",A);else for(let q=0,K=A.count;q<K;q++)A.setXYZ(q,0,0,0);const b=new He,E=new He,M=new He,N=new He,P=new He,k=new He,j=new He,X=new He;if(a)for(let q=0,K=a.count;q<K;q+=3){const te=a.getX(q+0),oe=a.getX(q+1),re=a.getX(q+2);b.fromBufferAttribute(d,te),E.fromBufferAttribute(d,oe),M.fromBufferAttribute(d,re),j.subVectors(M,E),X.subVectors(b,E),j.cross(X),N.fromBufferAttribute(A,te),P.fromBufferAttribute(A,oe),k.fromBufferAttribute(A,re),N.add(j),P.add(j),k.add(j),A.setXYZ(te,N.x,N.y,N.z),A.setXYZ(oe,P.x,P.y,P.z),A.setXYZ(re,k.x,k.y,k.z)}else for(let q=0,K=d.count;q<K;q+=3)b.fromBufferAttribute(d,q+0),E.fromBufferAttribute(d,q+1),M.fromBufferAttribute(d,q+2),j.subVectors(M,E),X.subVectors(b,E),j.cross(X),A.setXYZ(q+0,j.x,j.y,j.z),A.setXYZ(q+1,j.x,j.y,j.z),A.setXYZ(q+2,j.x,j.y,j.z);this.normalizeNormals(),A.needsUpdate=!0}}normalizeNormals(){const a=this.attributes.normal;for(let d=0,A=a.count;d<A;d++)Pa.fromBufferAttribute(a,d),Pa.normalize(),a.setXYZ(d,Pa.x,Pa.y,Pa.z)}toNonIndexed(){function a(N,P){const k=N.array,j=N.itemSize,X=N.normalized,q=new k.constructor(P.length*j);let K=0,te=0;for(let oe=0,re=P.length;oe<re;oe++){N.isInterleavedBufferAttribute?K=P[oe]*N.data.stride+N.offset:K=P[oe]*j;for(let ee=0;ee<j;ee++)q[te++]=k[K++]}return new ls(q,j,X)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const d=new fn,A=this.index.array,b=this.attributes;for(const N in b){const P=b[N],k=a(P,A);d.setAttribute(N,k)}const E=this.morphAttributes;for(const N in E){const P=[],k=E[N];for(let j=0,X=k.length;j<X;j++){const q=k[j],K=a(q,A);P.push(K)}d.morphAttributes[N]=P}d.morphTargetsRelative=this.morphTargetsRelative;const M=this.groups;for(let N=0,P=M.length;N<P;N++){const k=M[N];d.addGroup(k.start,k.count,k.materialIndex)}return d}toJSON(){const a={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(a.uuid=this.uuid,a.type=this.type,this.name!==""&&(a.name=this.name),Object.keys(this.userData).length>0&&(a.userData=this.userData),this.parameters!==void 0){const P=this.parameters;for(const k in P)P[k]!==void 0&&(a[k]=P[k]);return a}a.data={attributes:{}};const d=this.index;d!==null&&(a.data.index={type:d.array.constructor.name,array:Array.prototype.slice.call(d.array)});const A=this.attributes;for(const P in A){const k=A[P];a.data.attributes[P]=k.toJSON(a.data)}const b={};let E=!1;for(const P in this.morphAttributes){const k=this.morphAttributes[P],j=[];for(let X=0,q=k.length;X<q;X++){const K=k[X];j.push(K.toJSON(a.data))}j.length>0&&(b[P]=j,E=!0)}E&&(a.data.morphAttributes=b,a.data.morphTargetsRelative=this.morphTargetsRelative);const M=this.groups;M.length>0&&(a.data.groups=JSON.parse(JSON.stringify(M)));const N=this.boundingSphere;return N!==null&&(a.data.boundingSphere={center:N.center.toArray(),radius:N.radius}),a}clone(){return new this.constructor().copy(this)}copy(a){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const d={};this.name=a.name;const A=a.index;A!==null&&this.setIndex(A.clone(d));const b=a.attributes;for(const k in b){const j=b[k];this.setAttribute(k,j.clone(d))}const E=a.morphAttributes;for(const k in E){const j=[],X=E[k];for(let q=0,K=X.length;q<K;q++)j.push(X[q].clone(d));this.morphAttributes[k]=j}this.morphTargetsRelative=a.morphTargetsRelative;const M=a.groups;for(let k=0,j=M.length;k<j;k++){const X=M[k];this.addGroup(X.start,X.count,X.materialIndex)}const N=a.boundingBox;N!==null&&(this.boundingBox=N.clone());const P=a.boundingSphere;return P!==null&&(this.boundingSphere=P.clone()),this.drawRange.start=a.drawRange.start,this.drawRange.count=a.drawRange.count,this.userData=a.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const vj=new mr,ff=new va,zE=new ya,xj=new He,d0=new He,p0=new He,f0=new He,iN=new He,jE=new He,VE=new si,GE=new si,HE=new si,bj=new He,_j=new He,Ej=new He,WE=new He,QE=new He;class ua extends Qn{constructor(a=new fn,d=new Fd){super(),this.isMesh=!0,this.type="Mesh",this.geometry=a,this.material=d,this.updateMorphTargets()}copy(a,d){return super.copy(a,d),a.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=a.morphTargetInfluences.slice()),a.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},a.morphTargetDictionary)),this.material=Array.isArray(a.material)?a.material.slice():a.material,this.geometry=a.geometry,this}updateMorphTargets(){const a=this.geometry.morphAttributes,d=Object.keys(a);if(d.length>0){const A=a[d[0]];if(A!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let b=0,E=A.length;b<E;b++){const M=A[b].name||String(b);this.morphTargetInfluences.push(0),this.morphTargetDictionary[M]=b}}}}getVertexPosition(a,d){const A=this.geometry,b=A.attributes.position,E=A.morphAttributes.position,M=A.morphTargetsRelative;d.fromBufferAttribute(b,a);const N=this.morphTargetInfluences;if(E&&N){jE.set(0,0,0);for(let P=0,k=E.length;P<k;P++){const j=N[P],X=E[P];j!==0&&(iN.fromBufferAttribute(X,a),M?jE.addScaledVector(iN,j):jE.addScaledVector(iN.sub(d),j))}d.add(jE)}return d}raycast(a,d){const A=this.geometry,b=this.material,E=this.matrixWorld;b!==void 0&&(A.boundingSphere===null&&A.computeBoundingSphere(),zE.copy(A.boundingSphere),zE.applyMatrix4(E),ff.copy(a.ray).recast(a.near),!(zE.containsPoint(ff.origin)===!1&&(ff.intersectSphere(zE,xj)===null||ff.origin.distanceToSquared(xj)>(a.far-a.near)**2))&&(vj.copy(E).invert(),ff.copy(a.ray).applyMatrix4(vj),!(A.boundingBox!==null&&ff.intersectsBox(A.boundingBox)===!1)&&this._computeIntersections(a,d,ff)))}_computeIntersections(a,d,A){let b;const E=this.geometry,M=this.material,N=E.index,P=E.attributes.position,k=E.attributes.uv,j=E.attributes.uv1,X=E.attributes.normal,q=E.groups,K=E.drawRange;if(N!==null)if(Array.isArray(M))for(let te=0,oe=q.length;te<oe;te++){const re=q[te],ee=M[re.materialIndex],Me=Math.max(re.start,K.start),we=Math.min(N.count,Math.min(re.start+re.count,K.start+K.count));for(let _e=Me,nt=we;_e<nt;_e+=3){const qe=N.getX(_e),Je=N.getX(_e+1),it=N.getX(_e+2);b=qE(this,ee,a,A,k,j,X,qe,Je,it),b&&(b.faceIndex=Math.floor(_e/3),b.face.materialIndex=re.materialIndex,d.push(b))}}else{const te=Math.max(0,K.start),oe=Math.min(N.count,K.start+K.count);for(let re=te,ee=oe;re<ee;re+=3){const Me=N.getX(re),we=N.getX(re+1),_e=N.getX(re+2);b=qE(this,M,a,A,k,j,X,Me,we,_e),b&&(b.faceIndex=Math.floor(re/3),d.push(b))}}else if(P!==void 0)if(Array.isArray(M))for(let te=0,oe=q.length;te<oe;te++){const re=q[te],ee=M[re.materialIndex],Me=Math.max(re.start,K.start),we=Math.min(P.count,Math.min(re.start+re.count,K.start+K.count));for(let _e=Me,nt=we;_e<nt;_e+=3){const qe=_e,Je=_e+1,it=_e+2;b=qE(this,ee,a,A,k,j,X,qe,Je,it),b&&(b.faceIndex=Math.floor(_e/3),b.face.materialIndex=re.materialIndex,d.push(b))}}else{const te=Math.max(0,K.start),oe=Math.min(P.count,K.start+K.count);for(let re=te,ee=oe;re<ee;re+=3){const Me=re,we=re+1,_e=re+2;b=qE(this,M,a,A,k,j,X,Me,we,_e),b&&(b.faceIndex=Math.floor(re/3),d.push(b))}}}}function g2e(C,a,d,A,b,E,M,N){let P;if(a.side===R?P=A.intersectTriangle(M,E,b,!0,N):P=A.intersectTriangle(b,E,M,a.side===S,N),P===null)return null;QE.copy(N),QE.applyMatrix4(C.matrixWorld);const k=d.ray.origin.distanceTo(QE);return k<d.near||k>d.far?null:{distance:k,point:QE.clone(),object:C}}function qE(C,a,d,A,b,E,M,N,P,k){C.getVertexPosition(N,d0),C.getVertexPosition(P,p0),C.getVertexPosition(k,f0);const j=g2e(C,a,d,A,d0,p0,f0,WE);if(j){b&&(VE.fromBufferAttribute(b,N),GE.fromBufferAttribute(b,P),HE.fromBufferAttribute(b,k),j.uv=Tl.getInterpolation(WE,d0,p0,f0,VE,GE,HE,new si)),E&&(VE.fromBufferAttribute(E,N),GE.fromBufferAttribute(E,P),HE.fromBufferAttribute(E,k),j.uv1=Tl.getInterpolation(WE,d0,p0,f0,VE,GE,HE,new si)),M&&(bj.fromBufferAttribute(M,N),_j.fromBufferAttribute(M,P),Ej.fromBufferAttribute(M,k),j.normal=Tl.getInterpolation(WE,d0,p0,f0,bj,_j,Ej,new He),j.normal.dot(A.direction)>0&&j.normal.multiplyScalar(-1));const X={a:N,b:P,c:k,normal:new He,materialIndex:0};Tl.getNormal(d0,p0,f0,X.normal),j.face=X}return j}class mf extends fn{constructor(a=1,d=1,A=1,b=1,E=1,M=1){super(),this.type="BoxGeometry",this.parameters={width:a,height:d,depth:A,widthSegments:b,heightSegments:E,depthSegments:M};const N=this;b=Math.floor(b),E=Math.floor(E),M=Math.floor(M);const P=[],k=[],j=[],X=[];let q=0,K=0;te("z","y","x",-1,-1,A,d,a,M,E,0),te("z","y","x",1,-1,A,d,-a,M,E,1),te("x","z","y",1,1,a,A,d,b,M,2),te("x","z","y",1,-1,a,A,-d,b,M,3),te("x","y","z",1,-1,a,d,A,b,E,4),te("x","y","z",-1,-1,a,d,-A,b,E,5),this.setIndex(P),this.setAttribute("position",new br(k,3)),this.setAttribute("normal",new br(j,3)),this.setAttribute("uv",new br(X,2));function te(oe,re,ee,Me,we,_e,nt,qe,Je,it,ze){const Oe=_e/Je,rt=nt/it,mt=_e/2,pt=nt/2,Tt=qe/2,Pt=Je+1,hi=it+1;let Di=0,kt=0;const yi=new He;for(let Oi=0;Oi<hi;Oi++){const jr=Oi*rt-pt;for(let En=0;En<Pt;En++){const ns=En*Oe-mt;yi[oe]=ns*Me,yi[re]=jr*we,yi[ee]=Tt,k.push(yi.x,yi.y,yi.z),yi[oe]=0,yi[re]=0,yi[ee]=qe>0?1:-1,j.push(yi.x,yi.y,yi.z),X.push(En/Je),X.push(1-Oi/it),Di+=1}}for(let Oi=0;Oi<it;Oi++)for(let jr=0;jr<Je;jr++){const En=q+jr+Pt*Oi,ns=q+jr+Pt*(Oi+1),ms=q+(jr+1)+Pt*(Oi+1),Gn=q+(jr+1)+Pt*Oi;P.push(En,ns,Gn),P.push(ns,ms,Gn),kt+=6}N.addGroup(K,kt,ze),K+=kt,q+=Di}}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}static fromJSON(a){return new mf(a.width,a.height,a.depth,a.widthSegments,a.heightSegments,a.depthSegments)}}function m0(C){const a={};for(const d in C){a[d]={};for(const A in C[d]){const b=C[d][A];b&&(b.isColor||b.isMatrix3||b.isMatrix4||b.isVector2||b.isVector3||b.isVector4||b.isTexture||b.isQuaternion)?b.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),a[d][A]=null):a[d][A]=b.clone():Array.isArray(b)?a[d][A]=b.slice():a[d][A]=b}}return a}function Lo(C){const a={};for(let d=0;d<C.length;d++){const A=m0(C[d]);for(const b in A)a[b]=A[b]}return a}function A2e(C){const a=[];for(let d=0;d<C.length;d++)a.push(C[d].clone());return a}function wj(C){const a=C.getRenderTarget();return a===null?C.outputColorSpace:a.isXRRenderTarget===!0?a.texture.colorSpace:Zn.workingColorSpace}const Cj={clone:m0,merge:Lo};var y2e=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,v2e=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Nc extends po{constructor(a){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=y2e,this.fragmentShader=v2e,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,a!==void 0&&this.setValues(a)}copy(a){return super.copy(a),this.fragmentShader=a.fragmentShader,this.vertexShader=a.vertexShader,this.uniforms=m0(a.uniforms),this.uniformsGroups=A2e(a.uniformsGroups),this.defines=Object.assign({},a.defines),this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.fog=a.fog,this.lights=a.lights,this.clipping=a.clipping,this.extensions=Object.assign({},a.extensions),this.glslVersion=a.glslVersion,this}toJSON(a){const d=super.toJSON(a);d.glslVersion=this.glslVersion,d.uniforms={};for(const b in this.uniforms){const E=this.uniforms[b].value;E&&E.isTexture?d.uniforms[b]={type:"t",value:E.toJSON(a).uuid}:E&&E.isColor?d.uniforms[b]={type:"c",value:E.getHex()}:E&&E.isVector2?d.uniforms[b]={type:"v2",value:E.toArray()}:E&&E.isVector3?d.uniforms[b]={type:"v3",value:E.toArray()}:E&&E.isVector4?d.uniforms[b]={type:"v4",value:E.toArray()}:E&&E.isMatrix3?d.uniforms[b]={type:"m3",value:E.toArray()}:E&&E.isMatrix4?d.uniforms[b]={type:"m4",value:E.toArray()}:d.uniforms[b]={value:E}}Object.keys(this.defines).length>0&&(d.defines=this.defines),d.vertexShader=this.vertexShader,d.fragmentShader=this.fragmentShader,d.lights=this.lights,d.clipping=this.clipping;const A={};for(const b in this.extensions)this.extensions[b]===!0&&(A[b]=!0);return Object.keys(A).length>0&&(d.extensions=A),d}}class XE extends Qn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new mr,this.projectionMatrix=new mr,this.projectionMatrixInverse=new mr,this.coordinateSystem=Vl}copy(a,d){return super.copy(a,d),this.matrixWorldInverse.copy(a.matrixWorldInverse),this.projectionMatrix.copy(a.projectionMatrix),this.projectionMatrixInverse.copy(a.projectionMatrixInverse),this.coordinateSystem=a.coordinateSystem,this}getWorldDirection(a){return super.getWorldDirection(a).negate()}updateMatrixWorld(a){super.updateMatrixWorld(a),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(a,d){super.updateWorldMatrix(a,d),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const Ud=new He,Sj=new si,Tj=new si;class xa extends XE{constructor(a=50,d=1,A=.1,b=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=a,this.zoom=1,this.near=A,this.far=b,this.focus=10,this.aspect=d,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(a,d){return super.copy(a,d),this.fov=a.fov,this.zoom=a.zoom,this.near=a.near,this.far=a.far,this.focus=a.focus,this.aspect=a.aspect,this.view=a.view===null?null:Object.assign({},a.view),this.filmGauge=a.filmGauge,this.filmOffset=a.filmOffset,this}setFocalLength(a){const d=.5*this.getFilmHeight()/a;this.fov=Bd*2*Math.atan(d),this.updateProjectionMatrix()}getFocalLength(){const a=Math.tan(gh*.5*this.fov);return .5*this.getFilmHeight()/a}getEffectiveFOV(){return Bd*2*Math.atan(Math.tan(gh*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(a,d,A){Ud.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),d.set(Ud.x,Ud.y).multiplyScalar(-a/Ud.z),Ud.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),A.set(Ud.x,Ud.y).multiplyScalar(-a/Ud.z)}getViewSize(a,d){return this.getViewBounds(a,Sj,Tj),d.subVectors(Tj,Sj)}setViewOffset(a,d,A,b,E,M){this.aspect=a/d,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=a,this.view.fullHeight=d,this.view.offsetX=A,this.view.offsetY=b,this.view.width=E,this.view.height=M,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const a=this.near;let d=a*Math.tan(gh*.5*this.fov)/this.zoom,A=2*d,b=this.aspect*A,E=-.5*b;const M=this.view;if(this.view!==null&&this.view.enabled){const P=M.fullWidth,k=M.fullHeight;E+=M.offsetX*b/P,d-=M.offsetY*A/k,b*=M.width/P,A*=M.height/k}const N=this.filmOffset;N!==0&&(E+=a*N/this.getFilmWidth()),this.projectionMatrix.makePerspective(E,E+b,d,d-A,a,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(a){const d=super.toJSON(a);return d.object.fov=this.fov,d.object.zoom=this.zoom,d.object.near=this.near,d.object.far=this.far,d.object.focus=this.focus,d.object.aspect=this.aspect,this.view!==null&&(d.object.view=Object.assign({},this.view)),d.object.filmGauge=this.filmGauge,d.object.filmOffset=this.filmOffset,d}}const g0=-90,A0=1;class Mj extends Qn{constructor(a,d,A){super(),this.type="CubeCamera",this.renderTarget=A,this.coordinateSystem=null,this.activeMipmapLevel=0;const b=new xa(g0,A0,a,d);b.layers=this.layers,this.add(b);const E=new xa(g0,A0,a,d);E.layers=this.layers,this.add(E);const M=new xa(g0,A0,a,d);M.layers=this.layers,this.add(M);const N=new xa(g0,A0,a,d);N.layers=this.layers,this.add(N);const P=new xa(g0,A0,a,d);P.layers=this.layers,this.add(P);const k=new xa(g0,A0,a,d);k.layers=this.layers,this.add(k)}updateCoordinateSystem(){const a=this.coordinateSystem,d=this.children.concat(),[A,b,E,M,N,P]=d;for(const k of d)this.remove(k);if(a===Vl)A.up.set(0,1,0),A.lookAt(1,0,0),b.up.set(0,1,0),b.lookAt(-1,0,0),E.up.set(0,0,-1),E.lookAt(0,1,0),M.up.set(0,0,1),M.lookAt(0,-1,0),N.up.set(0,1,0),N.lookAt(0,0,1),P.up.set(0,1,0),P.lookAt(0,0,-1);else if(a===hf)A.up.set(0,-1,0),A.lookAt(-1,0,0),b.up.set(0,-1,0),b.lookAt(1,0,0),E.up.set(0,0,1),E.lookAt(0,1,0),M.up.set(0,0,-1),M.lookAt(0,-1,0),N.up.set(0,-1,0),N.lookAt(0,0,1),P.up.set(0,-1,0),P.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+a);for(const k of d)this.add(k),k.updateMatrixWorld()}update(a,d){this.parent===null&&this.updateMatrixWorld();const{renderTarget:A,activeMipmapLevel:b}=this;this.coordinateSystem!==a.coordinateSystem&&(this.coordinateSystem=a.coordinateSystem,this.updateCoordinateSystem());const[E,M,N,P,k,j]=this.children,X=a.getRenderTarget(),q=a.getActiveCubeFace(),K=a.getActiveMipmapLevel(),te=a.xr.enabled;a.xr.enabled=!1;const oe=A.texture.generateMipmaps;A.texture.generateMipmaps=!1,a.setRenderTarget(A,0,b),a.render(d,E),a.setRenderTarget(A,1,b),a.render(d,M),a.setRenderTarget(A,2,b),a.render(d,N),a.setRenderTarget(A,3,b),a.render(d,P),a.setRenderTarget(A,4,b),a.render(d,k),A.texture.generateMipmaps=oe,a.setRenderTarget(A,5,b),a.render(d,j),a.setRenderTarget(X,q,K),a.xr.enabled=te,A.texture.needsPMREMUpdate=!0}}class vv extends fs{constructor(a,d,A,b,E,M,N,P,k,j){a=a!==void 0?a:[],d=d!==void 0?d:F,super(a,d,A,b,E,M,N,P,k,j),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(a){this.image=a}}class Rj extends el{constructor(a=1,d={}){super(a,a,d),this.isWebGLCubeRenderTarget=!0;const A={width:a,height:a,depth:1},b=[A,A,A,A,A,A];this.texture=new vv(b,d.mapping,d.wrapS,d.wrapT,d.magFilter,d.minFilter,d.format,d.type,d.anisotropy,d.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=d.generateMipmaps!==void 0?d.generateMipmaps:!1,this.texture.minFilter=d.minFilter!==void 0?d.minFilter:ki}fromEquirectangularTexture(a,d){this.texture.type=d.type,this.texture.colorSpace=d.colorSpace,this.texture.generateMipmaps=d.generateMipmaps,this.texture.minFilter=d.minFilter,this.texture.magFilter=d.magFilter;const A={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},b=new mf(5,5,5),E=new Nc({name:"CubemapFromEquirect",uniforms:m0(A.uniforms),vertexShader:A.vertexShader,fragmentShader:A.fragmentShader,side:R,blending:I});E.uniforms.tEquirect.value=d;const M=new ua(b,E),N=d.minFilter;return d.minFilter===sn&&(d.minFilter=ki),new Mj(1,10,this).update(a,M),d.minFilter=N,M.geometry.dispose(),M.material.dispose(),this}clear(a,d,A,b){const E=a.getRenderTarget();for(let M=0;M<6;M++)a.setRenderTarget(this,M),a.clear(d,A,b);a.setRenderTarget(E)}}const rN=new He,x2e=new He,b2e=new Kr;class zd{constructor(a=new He(1,0,0),d=0){this.isPlane=!0,this.normal=a,this.constant=d}set(a,d){return this.normal.copy(a),this.constant=d,this}setComponents(a,d,A,b){return this.normal.set(a,d,A),this.constant=b,this}setFromNormalAndCoplanarPoint(a,d){return this.normal.copy(a),this.constant=-d.dot(this.normal),this}setFromCoplanarPoints(a,d,A){const b=rN.subVectors(A,d).cross(x2e.subVectors(a,d)).normalize();return this.setFromNormalAndCoplanarPoint(b,a),this}copy(a){return this.normal.copy(a.normal),this.constant=a.constant,this}normalize(){const a=1/this.normal.length();return this.normal.multiplyScalar(a),this.constant*=a,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(a){return this.normal.dot(a)+this.constant}distanceToSphere(a){return this.distanceToPoint(a.center)-a.radius}projectPoint(a,d){return d.copy(a).addScaledVector(this.normal,-this.distanceToPoint(a))}intersectLine(a,d){const A=a.delta(rN),b=this.normal.dot(A);if(b===0)return this.distanceToPoint(a.start)===0?d.copy(a.start):null;const E=-(a.start.dot(this.normal)+this.constant)/b;return E<0||E>1?null:d.copy(a.start).addScaledVector(A,E)}intersectsLine(a){const d=this.distanceToPoint(a.start),A=this.distanceToPoint(a.end);return d<0&&A>0||A<0&&d>0}intersectsBox(a){return a.intersectsPlane(this)}intersectsSphere(a){return a.intersectsPlane(this)}coplanarPoint(a){return a.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(a,d){const A=d||b2e.getNormalMatrix(a),b=this.coplanarPoint(rN).applyMatrix4(a),E=this.normal.applyMatrix3(A).normalize();return this.constant=-b.dot(E),this}translate(a){return this.constant-=a.dot(this.normal),this}equals(a){return a.normal.equals(this.normal)&&a.constant===this.constant}clone(){return new this.constructor().copy(this)}}const gf=new ya,YE=new He;class xv{constructor(a=new zd,d=new zd,A=new zd,b=new zd,E=new zd,M=new zd){this.planes=[a,d,A,b,E,M]}set(a,d,A,b,E,M){const N=this.planes;return N[0].copy(a),N[1].copy(d),N[2].copy(A),N[3].copy(b),N[4].copy(E),N[5].copy(M),this}copy(a){const d=this.planes;for(let A=0;A<6;A++)d[A].copy(a.planes[A]);return this}setFromProjectionMatrix(a,d=Vl){const A=this.planes,b=a.elements,E=b[0],M=b[1],N=b[2],P=b[3],k=b[4],j=b[5],X=b[6],q=b[7],K=b[8],te=b[9],oe=b[10],re=b[11],ee=b[12],Me=b[13],we=b[14],_e=b[15];if(A[0].setComponents(P-E,q-k,re-K,_e-ee).normalize(),A[1].setComponents(P+E,q+k,re+K,_e+ee).normalize(),A[2].setComponents(P+M,q+j,re+te,_e+Me).normalize(),A[3].setComponents(P-M,q-j,re-te,_e-Me).normalize(),A[4].setComponents(P-N,q-X,re-oe,_e-we).normalize(),d===Vl)A[5].setComponents(P+N,q+X,re+oe,_e+we).normalize();else if(d===hf)A[5].setComponents(N,X,oe,we).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+d);return this}intersectsObject(a){if(a.boundingSphere!==void 0)a.boundingSphere===null&&a.computeBoundingSphere(),gf.copy(a.boundingSphere).applyMatrix4(a.matrixWorld);else{const d=a.geometry;d.boundingSphere===null&&d.computeBoundingSphere(),gf.copy(d.boundingSphere).applyMatrix4(a.matrixWorld)}return this.intersectsSphere(gf)}intersectsSprite(a){return gf.center.set(0,0,0),gf.radius=.7071067811865476,gf.applyMatrix4(a.matrixWorld),this.intersectsSphere(gf)}intersectsSphere(a){const d=this.planes,A=a.center,b=-a.radius;for(let E=0;E<6;E++)if(d[E].distanceToPoint(A)<b)return!1;return!0}intersectsBox(a){const d=this.planes;for(let A=0;A<6;A++){const b=d[A];if(YE.x=b.normal.x>0?a.max.x:a.min.x,YE.y=b.normal.y>0?a.max.y:a.min.y,YE.z=b.normal.z>0?a.max.z:a.min.z,b.distanceToPoint(YE)<0)return!1}return!0}containsPoint(a){const d=this.planes;for(let A=0;A<6;A++)if(d[A].distanceToPoint(a)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function nN(){let C=null,a=!1,d=null,A=null;function b(E,M){d(E,M),A=C.requestAnimationFrame(b)}return{start:function(){a!==!0&&d!==null&&(A=C.requestAnimationFrame(b),a=!0)},stop:function(){C.cancelAnimationFrame(A),a=!1},setAnimationLoop:function(E){d=E},setContext:function(E){C=E}}}function _2e(C){const a=new WeakMap;function d(N,P){const k=N.array,j=N.usage,X=k.byteLength,q=C.createBuffer();C.bindBuffer(P,q),C.bufferData(P,k,j),N.onUploadCallback();let K;if(k instanceof Float32Array)K=C.FLOAT;else if(k instanceof Uint16Array)N.isFloat16BufferAttribute?K=C.HALF_FLOAT:K=C.UNSIGNED_SHORT;else if(k instanceof Int16Array)K=C.SHORT;else if(k instanceof Uint32Array)K=C.UNSIGNED_INT;else if(k instanceof Int32Array)K=C.INT;else if(k instanceof Int8Array)K=C.BYTE;else if(k instanceof Uint8Array)K=C.UNSIGNED_BYTE;else if(k instanceof Uint8ClampedArray)K=C.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+k);return{buffer:q,type:K,bytesPerElement:k.BYTES_PER_ELEMENT,version:N.version,size:X}}function A(N,P,k){const j=P.array,X=P._updateRange,q=P.updateRanges;if(C.bindBuffer(k,N),X.count===-1&&q.length===0&&C.bufferSubData(k,0,j),q.length!==0){for(let K=0,te=q.length;K<te;K++){const oe=q[K];C.bufferSubData(k,oe.start*j.BYTES_PER_ELEMENT,j,oe.start,oe.count)}P.clearUpdateRanges()}X.count!==-1&&(C.bufferSubData(k,X.offset*j.BYTES_PER_ELEMENT,j,X.offset,X.count),X.count=-1),P.onUploadCallback()}function b(N){return N.isInterleavedBufferAttribute&&(N=N.data),a.get(N)}function E(N){N.isInterleavedBufferAttribute&&(N=N.data);const P=a.get(N);P&&(C.deleteBuffer(P.buffer),a.delete(N))}function M(N,P){if(N.isGLBufferAttribute){const j=a.get(N);(!j||j.version<N.version)&&a.set(N,{buffer:N.buffer,type:N.type,bytesPerElement:N.elementSize,version:N.version});return}N.isInterleavedBufferAttribute&&(N=N.data);const k=a.get(N);if(k===void 0)a.set(N,d(N,P));else if(k.version<N.version){if(k.size!==N.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");A(k.buffer,N,P),k.version=N.version}}return{get:b,remove:E,update:M}}class y0 extends fn{constructor(a=1,d=1,A=1,b=1){super(),this.type="PlaneGeometry",this.parameters={width:a,height:d,widthSegments:A,heightSegments:b};const E=a/2,M=d/2,N=Math.floor(A),P=Math.floor(b),k=N+1,j=P+1,X=a/N,q=d/P,K=[],te=[],oe=[],re=[];for(let ee=0;ee<j;ee++){const Me=ee*q-M;for(let we=0;we<k;we++){const _e=we*X-E;te.push(_e,-Me,0),oe.push(0,0,1),re.push(we/N),re.push(1-ee/P)}}for(let ee=0;ee<P;ee++)for(let Me=0;Me<N;Me++){const we=Me+k*ee,_e=Me+k*(ee+1),nt=Me+1+k*(ee+1),qe=Me+1+k*ee;K.push(we,_e,qe),K.push(_e,nt,qe)}this.setIndex(K),this.setAttribute("position",new br(te,3)),this.setAttribute("normal",new br(oe,3)),this.setAttribute("uv",new br(re,2))}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}static fromJSON(a){return new y0(a.width,a.height,a.widthSegments,a.heightSegments)}}var E2e=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,w2e=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,C2e=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,S2e=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,T2e=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,M2e=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,R2e=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,I2e=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,B2e=`#ifdef USE_BATCHING
	attribute float batchId;
	uniform highp sampler2D batchingTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,N2e=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( batchId );
#endif`,L2e=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,D2e=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,O2e=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,P2e=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,k2e=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,F2e=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,U2e=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,z2e=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,j2e=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,V2e=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,G2e=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,H2e=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,W2e=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,Q2e=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,q2e=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,X2e=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Y2e=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,K2e=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,J2e=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Z2e=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,$2e="gl_FragColor = linearToOutputTexel( gl_FragColor );",eCe=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,tCe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,iCe=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,rCe=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,nCe=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,sCe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,aCe=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,oCe=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,lCe=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,cCe=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,uCe=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,hCe=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,dCe=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,pCe=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,fCe=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,mCe=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,gCe=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,ACe=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,yCe=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,vCe=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,xCe=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,bCe=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,_Ce=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,ECe=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,wCe=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,CCe=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,SCe=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,TCe=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,MCe=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,RCe=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,ICe=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,BCe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,NCe=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,LCe=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,DCe=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,OCe=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[MORPHTARGETS_COUNT];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,PCe=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,kCe=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,FCe=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
	#endif
	#ifdef MORPHTARGETS_TEXTURE
		#ifndef USE_INSTANCING_MORPH
			uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		#endif
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,UCe=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,zCe=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,jCe=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,VCe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,GCe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,HCe=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,WCe=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,QCe=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,qCe=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,XCe=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,YCe=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,KCe=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,JCe=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,ZCe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,$Ce=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,eSe=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,tSe=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,iSe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,rSe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,nSe=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return shadow;
	}
#endif`,sSe=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,aSe=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,oSe=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,lSe=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,cSe=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,uSe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,hSe=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,dSe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,pSe=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,fSe=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,mSe=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,gSe=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,ASe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
		
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
		
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		
		#else
		
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,ySe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,vSe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,xSe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,bSe=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const ln={alphahash_fragment:E2e,alphahash_pars_fragment:w2e,alphamap_fragment:C2e,alphamap_pars_fragment:S2e,alphatest_fragment:T2e,alphatest_pars_fragment:M2e,aomap_fragment:R2e,aomap_pars_fragment:I2e,batching_pars_vertex:B2e,batching_vertex:N2e,begin_vertex:L2e,beginnormal_vertex:D2e,bsdfs:O2e,iridescence_fragment:P2e,bumpmap_pars_fragment:k2e,clipping_planes_fragment:F2e,clipping_planes_pars_fragment:U2e,clipping_planes_pars_vertex:z2e,clipping_planes_vertex:j2e,color_fragment:V2e,color_pars_fragment:G2e,color_pars_vertex:H2e,color_vertex:W2e,common:Q2e,cube_uv_reflection_fragment:q2e,defaultnormal_vertex:X2e,displacementmap_pars_vertex:Y2e,displacementmap_vertex:K2e,emissivemap_fragment:J2e,emissivemap_pars_fragment:Z2e,colorspace_fragment:$2e,colorspace_pars_fragment:eCe,envmap_fragment:tCe,envmap_common_pars_fragment:iCe,envmap_pars_fragment:rCe,envmap_pars_vertex:nCe,envmap_physical_pars_fragment:mCe,envmap_vertex:sCe,fog_vertex:aCe,fog_pars_vertex:oCe,fog_fragment:lCe,fog_pars_fragment:cCe,gradientmap_pars_fragment:uCe,lightmap_pars_fragment:hCe,lights_lambert_fragment:dCe,lights_lambert_pars_fragment:pCe,lights_pars_begin:fCe,lights_toon_fragment:gCe,lights_toon_pars_fragment:ACe,lights_phong_fragment:yCe,lights_phong_pars_fragment:vCe,lights_physical_fragment:xCe,lights_physical_pars_fragment:bCe,lights_fragment_begin:_Ce,lights_fragment_maps:ECe,lights_fragment_end:wCe,logdepthbuf_fragment:CCe,logdepthbuf_pars_fragment:SCe,logdepthbuf_pars_vertex:TCe,logdepthbuf_vertex:MCe,map_fragment:RCe,map_pars_fragment:ICe,map_particle_fragment:BCe,map_particle_pars_fragment:NCe,metalnessmap_fragment:LCe,metalnessmap_pars_fragment:DCe,morphinstance_vertex:OCe,morphcolor_vertex:PCe,morphnormal_vertex:kCe,morphtarget_pars_vertex:FCe,morphtarget_vertex:UCe,normal_fragment_begin:zCe,normal_fragment_maps:jCe,normal_pars_fragment:VCe,normal_pars_vertex:GCe,normal_vertex:HCe,normalmap_pars_fragment:WCe,clearcoat_normal_fragment_begin:QCe,clearcoat_normal_fragment_maps:qCe,clearcoat_pars_fragment:XCe,iridescence_pars_fragment:YCe,opaque_fragment:KCe,packing:JCe,premultiplied_alpha_fragment:ZCe,project_vertex:$Ce,dithering_fragment:eSe,dithering_pars_fragment:tSe,roughnessmap_fragment:iSe,roughnessmap_pars_fragment:rSe,shadowmap_pars_fragment:nSe,shadowmap_pars_vertex:sSe,shadowmap_vertex:aSe,shadowmask_pars_fragment:oSe,skinbase_vertex:lSe,skinning_pars_vertex:cSe,skinning_vertex:uSe,skinnormal_vertex:hSe,specularmap_fragment:dSe,specularmap_pars_fragment:pSe,tonemapping_fragment:fSe,tonemapping_pars_fragment:mSe,transmission_fragment:gSe,transmission_pars_fragment:ASe,uv_pars_fragment:ySe,uv_pars_vertex:vSe,uv_vertex:xSe,worldpos_vertex:bSe,background_vert:`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,background_frag:`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,backgroundCube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,backgroundCube_frag:`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,cube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,cube_frag:`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,depth_vert:`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,depth_frag:`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,distanceRGBA_vert:`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,distanceRGBA_frag:`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,equirect_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,equirect_frag:`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,linedashed_vert:`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,linedashed_frag:`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,meshbasic_vert:`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,meshbasic_frag:`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshlambert_vert:`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshlambert_frag:`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshmatcap_vert:`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,meshmatcap_frag:`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshnormal_vert:`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,meshnormal_frag:`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,meshphong_vert:`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphong_frag:`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphysical_vert:`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,meshphysical_frag:`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshtoon_vert:`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshtoon_frag:`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,points_vert:`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,points_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,shadow_vert:`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,shadow_frag:`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,sprite_vert:`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,sprite_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`},Qi={common:{diffuse:{value:new lr(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Kr},alphaMap:{value:null},alphaMapTransform:{value:new Kr},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Kr}},envmap:{envMap:{value:null},envMapRotation:{value:new Kr},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Kr}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Kr}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Kr},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Kr},normalScale:{value:new si(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Kr},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Kr}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Kr}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Kr}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new lr(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new lr(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Kr},alphaTest:{value:0},uvTransform:{value:new Kr}},sprite:{diffuse:{value:new lr(16777215)},opacity:{value:1},center:{value:new si(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Kr},alphaMap:{value:null},alphaMapTransform:{value:new Kr},alphaTest:{value:0}}},Lc={basic:{uniforms:Lo([Qi.common,Qi.specularmap,Qi.envmap,Qi.aomap,Qi.lightmap,Qi.fog]),vertexShader:ln.meshbasic_vert,fragmentShader:ln.meshbasic_frag},lambert:{uniforms:Lo([Qi.common,Qi.specularmap,Qi.envmap,Qi.aomap,Qi.lightmap,Qi.emissivemap,Qi.bumpmap,Qi.normalmap,Qi.displacementmap,Qi.fog,Qi.lights,{emissive:{value:new lr(0)}}]),vertexShader:ln.meshlambert_vert,fragmentShader:ln.meshlambert_frag},phong:{uniforms:Lo([Qi.common,Qi.specularmap,Qi.envmap,Qi.aomap,Qi.lightmap,Qi.emissivemap,Qi.bumpmap,Qi.normalmap,Qi.displacementmap,Qi.fog,Qi.lights,{emissive:{value:new lr(0)},specular:{value:new lr(1118481)},shininess:{value:30}}]),vertexShader:ln.meshphong_vert,fragmentShader:ln.meshphong_frag},standard:{uniforms:Lo([Qi.common,Qi.envmap,Qi.aomap,Qi.lightmap,Qi.emissivemap,Qi.bumpmap,Qi.normalmap,Qi.displacementmap,Qi.roughnessmap,Qi.metalnessmap,Qi.fog,Qi.lights,{emissive:{value:new lr(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ln.meshphysical_vert,fragmentShader:ln.meshphysical_frag},toon:{uniforms:Lo([Qi.common,Qi.aomap,Qi.lightmap,Qi.emissivemap,Qi.bumpmap,Qi.normalmap,Qi.displacementmap,Qi.gradientmap,Qi.fog,Qi.lights,{emissive:{value:new lr(0)}}]),vertexShader:ln.meshtoon_vert,fragmentShader:ln.meshtoon_frag},matcap:{uniforms:Lo([Qi.common,Qi.bumpmap,Qi.normalmap,Qi.displacementmap,Qi.fog,{matcap:{value:null}}]),vertexShader:ln.meshmatcap_vert,fragmentShader:ln.meshmatcap_frag},points:{uniforms:Lo([Qi.points,Qi.fog]),vertexShader:ln.points_vert,fragmentShader:ln.points_frag},dashed:{uniforms:Lo([Qi.common,Qi.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ln.linedashed_vert,fragmentShader:ln.linedashed_frag},depth:{uniforms:Lo([Qi.common,Qi.displacementmap]),vertexShader:ln.depth_vert,fragmentShader:ln.depth_frag},normal:{uniforms:Lo([Qi.common,Qi.bumpmap,Qi.normalmap,Qi.displacementmap,{opacity:{value:1}}]),vertexShader:ln.meshnormal_vert,fragmentShader:ln.meshnormal_frag},sprite:{uniforms:Lo([Qi.sprite,Qi.fog]),vertexShader:ln.sprite_vert,fragmentShader:ln.sprite_frag},background:{uniforms:{uvTransform:{value:new Kr},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:ln.background_vert,fragmentShader:ln.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Kr}},vertexShader:ln.backgroundCube_vert,fragmentShader:ln.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ln.cube_vert,fragmentShader:ln.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ln.equirect_vert,fragmentShader:ln.equirect_frag},distanceRGBA:{uniforms:Lo([Qi.common,Qi.displacementmap,{referencePosition:{value:new He},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ln.distanceRGBA_vert,fragmentShader:ln.distanceRGBA_frag},shadow:{uniforms:Lo([Qi.lights,Qi.fog,{color:{value:new lr(0)},opacity:{value:1}}]),vertexShader:ln.shadow_vert,fragmentShader:ln.shadow_frag}};Lc.physical={uniforms:Lo([Lc.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Kr},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Kr},clearcoatNormalScale:{value:new si(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Kr},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Kr},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Kr},sheen:{value:0},sheenColor:{value:new lr(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Kr},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Kr},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Kr},transmissionSamplerSize:{value:new si},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Kr},attenuationDistance:{value:0},attenuationColor:{value:new lr(0)},specularColor:{value:new lr(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Kr},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Kr},anisotropyVector:{value:new si},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Kr}}]),vertexShader:ln.meshphysical_vert,fragmentShader:ln.meshphysical_frag};const KE={r:0,b:0,g:0},Af=new Sl,_Se=new mr;function ESe(C,a,d,A,b,E,M){const N=new lr(0);let P=E===!0?0:1,k,j,X=null,q=0,K=null;function te(Me){let we=Me.isScene===!0?Me.background:null;return we&&we.isTexture&&(we=(Me.backgroundBlurriness>0?d:a).get(we)),we}function oe(Me){let we=!1;const _e=te(Me);_e===null?ee(N,P):_e&&_e.isColor&&(ee(_e,1),we=!0);const nt=C.xr.getEnvironmentBlendMode();nt==="additive"?A.buffers.color.setClear(0,0,0,1,M):nt==="alpha-blend"&&A.buffers.color.setClear(0,0,0,0,M),(C.autoClear||we)&&C.clear(C.autoClearColor,C.autoClearDepth,C.autoClearStencil)}function re(Me,we){const _e=te(we);_e&&(_e.isCubeTexture||_e.mapping===ce)?(j===void 0&&(j=new ua(new mf(1e4,1e4,1e4),new Nc({name:"BackgroundCubeMaterial",uniforms:m0(Lc.backgroundCube.uniforms),vertexShader:Lc.backgroundCube.vertexShader,fragmentShader:Lc.backgroundCube.fragmentShader,side:R,depthTest:!1,depthWrite:!1,fog:!1})),j.geometry.deleteAttribute("normal"),j.geometry.deleteAttribute("uv"),j.onBeforeRender=function(nt,qe,Je){this.matrixWorld.copyPosition(Je.matrixWorld)},Object.defineProperty(j.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),b.update(j)),Af.copy(we.backgroundRotation),Af.x*=-1,Af.y*=-1,Af.z*=-1,_e.isCubeTexture&&_e.isRenderTargetTexture===!1&&(Af.y*=-1,Af.z*=-1),j.material.uniforms.envMap.value=_e,j.material.uniforms.flipEnvMap.value=_e.isCubeTexture&&_e.isRenderTargetTexture===!1?-1:1,j.material.uniforms.backgroundBlurriness.value=we.backgroundBlurriness,j.material.uniforms.backgroundIntensity.value=we.backgroundIntensity,j.material.uniforms.backgroundRotation.value.setFromMatrix4(_Se.makeRotationFromEuler(Af)),j.material.toneMapped=Zn.getTransfer(_e.colorSpace)!==hs,(X!==_e||q!==_e.version||K!==C.toneMapping)&&(j.material.needsUpdate=!0,X=_e,q=_e.version,K=C.toneMapping),j.layers.enableAll(),Me.unshift(j,j.geometry,j.material,0,0,null)):_e&&_e.isTexture&&(k===void 0&&(k=new ua(new y0(2,2),new Nc({name:"BackgroundMaterial",uniforms:m0(Lc.background.uniforms),vertexShader:Lc.background.vertexShader,fragmentShader:Lc.background.fragmentShader,side:S,depthTest:!1,depthWrite:!1,fog:!1})),k.geometry.deleteAttribute("normal"),Object.defineProperty(k.material,"map",{get:function(){return this.uniforms.t2D.value}}),b.update(k)),k.material.uniforms.t2D.value=_e,k.material.uniforms.backgroundIntensity.value=we.backgroundIntensity,k.material.toneMapped=Zn.getTransfer(_e.colorSpace)!==hs,_e.matrixAutoUpdate===!0&&_e.updateMatrix(),k.material.uniforms.uvTransform.value.copy(_e.matrix),(X!==_e||q!==_e.version||K!==C.toneMapping)&&(k.material.needsUpdate=!0,X=_e,q=_e.version,K=C.toneMapping),k.layers.enableAll(),Me.unshift(k,k.geometry,k.material,0,0,null))}function ee(Me,we){Me.getRGB(KE,wj(C)),A.buffers.color.setClear(KE.r,KE.g,KE.b,we,M)}return{getClearColor:function(){return N},setClearColor:function(Me,we=1){N.set(Me),P=we,ee(N,P)},getClearAlpha:function(){return P},setClearAlpha:function(Me){P=Me,ee(N,P)},render:oe,addToRenderList:re}}function wSe(C,a){const d=C.getParameter(C.MAX_VERTEX_ATTRIBS),A={},b=q(null);let E=b,M=!1;function N(Oe,rt,mt,pt,Tt){let Pt=!1;const hi=X(pt,mt,rt);E!==hi&&(E=hi,k(E.object)),Pt=K(Oe,pt,mt,Tt),Pt&&te(Oe,pt,mt,Tt),Tt!==null&&a.update(Tt,C.ELEMENT_ARRAY_BUFFER),(Pt||M)&&(M=!1,_e(Oe,rt,mt,pt),Tt!==null&&C.bindBuffer(C.ELEMENT_ARRAY_BUFFER,a.get(Tt).buffer))}function P(){return C.createVertexArray()}function k(Oe){return C.bindVertexArray(Oe)}function j(Oe){return C.deleteVertexArray(Oe)}function X(Oe,rt,mt){const pt=mt.wireframe===!0;let Tt=A[Oe.id];Tt===void 0&&(Tt={},A[Oe.id]=Tt);let Pt=Tt[rt.id];Pt===void 0&&(Pt={},Tt[rt.id]=Pt);let hi=Pt[pt];return hi===void 0&&(hi=q(P()),Pt[pt]=hi),hi}function q(Oe){const rt=[],mt=[],pt=[];for(let Tt=0;Tt<d;Tt++)rt[Tt]=0,mt[Tt]=0,pt[Tt]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:rt,enabledAttributes:mt,attributeDivisors:pt,object:Oe,attributes:{},index:null}}function K(Oe,rt,mt,pt){const Tt=E.attributes,Pt=rt.attributes;let hi=0;const Di=mt.getAttributes();for(const kt in Di)if(Di[kt].location>=0){const yi=Tt[kt];let Oi=Pt[kt];if(Oi===void 0&&(kt==="instanceMatrix"&&Oe.instanceMatrix&&(Oi=Oe.instanceMatrix),kt==="instanceColor"&&Oe.instanceColor&&(Oi=Oe.instanceColor)),yi===void 0||yi.attribute!==Oi||Oi&&yi.data!==Oi.data)return!0;hi++}return E.attributesNum!==hi||E.index!==pt}function te(Oe,rt,mt,pt){const Tt={},Pt=rt.attributes;let hi=0;const Di=mt.getAttributes();for(const kt in Di)if(Di[kt].location>=0){let yi=Pt[kt];yi===void 0&&(kt==="instanceMatrix"&&Oe.instanceMatrix&&(yi=Oe.instanceMatrix),kt==="instanceColor"&&Oe.instanceColor&&(yi=Oe.instanceColor));const Oi={};Oi.attribute=yi,yi&&yi.data&&(Oi.data=yi.data),Tt[kt]=Oi,hi++}E.attributes=Tt,E.attributesNum=hi,E.index=pt}function oe(){const Oe=E.newAttributes;for(let rt=0,mt=Oe.length;rt<mt;rt++)Oe[rt]=0}function re(Oe){ee(Oe,0)}function ee(Oe,rt){const mt=E.newAttributes,pt=E.enabledAttributes,Tt=E.attributeDivisors;mt[Oe]=1,pt[Oe]===0&&(C.enableVertexAttribArray(Oe),pt[Oe]=1),Tt[Oe]!==rt&&(C.vertexAttribDivisor(Oe,rt),Tt[Oe]=rt)}function Me(){const Oe=E.newAttributes,rt=E.enabledAttributes;for(let mt=0,pt=rt.length;mt<pt;mt++)rt[mt]!==Oe[mt]&&(C.disableVertexAttribArray(mt),rt[mt]=0)}function we(Oe,rt,mt,pt,Tt,Pt,hi){hi===!0?C.vertexAttribIPointer(Oe,rt,mt,Tt,Pt):C.vertexAttribPointer(Oe,rt,mt,pt,Tt,Pt)}function _e(Oe,rt,mt,pt){oe();const Tt=pt.attributes,Pt=mt.getAttributes(),hi=rt.defaultAttributeValues;for(const Di in Pt){const kt=Pt[Di];if(kt.location>=0){let yi=Tt[Di];if(yi===void 0&&(Di==="instanceMatrix"&&Oe.instanceMatrix&&(yi=Oe.instanceMatrix),Di==="instanceColor"&&Oe.instanceColor&&(yi=Oe.instanceColor)),yi!==void 0){const Oi=yi.normalized,jr=yi.itemSize,En=a.get(yi);if(En===void 0)continue;const ns=En.buffer,ms=En.type,Gn=En.bytesPerElement,Dn=ms===C.INT||ms===C.UNSIGNED_INT||yi.gpuType===me;if(yi.isInterleavedBufferAttribute){const Sr=yi.data,ci=Sr.stride,wi=yi.offset;if(Sr.isInstancedInterleavedBuffer){for(let qi=0;qi<kt.locationSize;qi++)ee(kt.location+qi,Sr.meshPerAttribute);Oe.isInstancedMesh!==!0&&pt._maxInstanceCount===void 0&&(pt._maxInstanceCount=Sr.meshPerAttribute*Sr.count)}else for(let qi=0;qi<kt.locationSize;qi++)re(kt.location+qi);C.bindBuffer(C.ARRAY_BUFFER,ns);for(let qi=0;qi<kt.locationSize;qi++)we(kt.location+qi,jr/kt.locationSize,ms,Oi,ci*Gn,(wi+jr/kt.locationSize*qi)*Gn,Dn)}else{if(yi.isInstancedBufferAttribute){for(let Sr=0;Sr<kt.locationSize;Sr++)ee(kt.location+Sr,yi.meshPerAttribute);Oe.isInstancedMesh!==!0&&pt._maxInstanceCount===void 0&&(pt._maxInstanceCount=yi.meshPerAttribute*yi.count)}else for(let Sr=0;Sr<kt.locationSize;Sr++)re(kt.location+Sr);C.bindBuffer(C.ARRAY_BUFFER,ns);for(let Sr=0;Sr<kt.locationSize;Sr++)we(kt.location+Sr,jr/kt.locationSize,ms,Oi,jr*Gn,jr/kt.locationSize*Sr*Gn,Dn)}}else if(hi!==void 0){const Oi=hi[Di];if(Oi!==void 0)switch(Oi.length){case 2:C.vertexAttrib2fv(kt.location,Oi);break;case 3:C.vertexAttrib3fv(kt.location,Oi);break;case 4:C.vertexAttrib4fv(kt.location,Oi);break;default:C.vertexAttrib1fv(kt.location,Oi)}}}}Me()}function nt(){it();for(const Oe in A){const rt=A[Oe];for(const mt in rt){const pt=rt[mt];for(const Tt in pt)j(pt[Tt].object),delete pt[Tt];delete rt[mt]}delete A[Oe]}}function qe(Oe){if(A[Oe.id]===void 0)return;const rt=A[Oe.id];for(const mt in rt){const pt=rt[mt];for(const Tt in pt)j(pt[Tt].object),delete pt[Tt];delete rt[mt]}delete A[Oe.id]}function Je(Oe){for(const rt in A){const mt=A[rt];if(mt[Oe.id]===void 0)continue;const pt=mt[Oe.id];for(const Tt in pt)j(pt[Tt].object),delete pt[Tt];delete mt[Oe.id]}}function it(){ze(),M=!0,E!==b&&(E=b,k(E.object))}function ze(){b.geometry=null,b.program=null,b.wireframe=!1}return{setup:N,reset:it,resetDefaultState:ze,dispose:nt,releaseStatesOfGeometry:qe,releaseStatesOfProgram:Je,initAttributes:oe,enableAttribute:re,disableUnusedAttributes:Me}}function CSe(C,a,d){let A;function b(k){A=k}function E(k,j){C.drawArrays(A,k,j),d.update(j,A,1)}function M(k,j,X){X!==0&&(C.drawArraysInstanced(A,k,j,X),d.update(j,A,X))}function N(k,j,X){if(X===0)return;const q=a.get("WEBGL_multi_draw");if(q===null)for(let K=0;K<X;K++)this.render(k[K],j[K]);else{q.multiDrawArraysWEBGL(A,k,0,j,0,X);let K=0;for(let te=0;te<X;te++)K+=j[te];d.update(K,A,1)}}function P(k,j,X,q){if(X===0)return;const K=a.get("WEBGL_multi_draw");if(K===null)for(let te=0;te<k.length;te++)M(k[te],j[te],q[te]);else{K.multiDrawArraysInstancedWEBGL(A,k,0,j,0,q,0,X);let te=0;for(let oe=0;oe<X;oe++)te+=j[oe];for(let oe=0;oe<q.length;oe++)d.update(te,A,q[oe])}}this.setMode=b,this.render=E,this.renderInstances=M,this.renderMultiDraw=N,this.renderMultiDrawInstances=P}function SSe(C,a,d,A){let b;function E(){if(b!==void 0)return b;if(a.has("EXT_texture_filter_anisotropic")===!0){const qe=a.get("EXT_texture_filter_anisotropic");b=C.getParameter(qe.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else b=0;return b}function M(qe){return!(qe!==ge&&A.convert(qe)!==C.getParameter(C.IMPLEMENTATION_COLOR_READ_FORMAT))}function N(qe){const Je=qe===Xt&&(a.has("EXT_color_buffer_half_float")||a.has("EXT_color_buffer_float"));return!(qe!==yn&&A.convert(qe)!==C.getParameter(C.IMPLEMENTATION_COLOR_READ_TYPE)&&qe!==St&&!Je)}function P(qe){if(qe==="highp"){if(C.getShaderPrecisionFormat(C.VERTEX_SHADER,C.HIGH_FLOAT).precision>0&&C.getShaderPrecisionFormat(C.FRAGMENT_SHADER,C.HIGH_FLOAT).precision>0)return"highp";qe="mediump"}return qe==="mediump"&&C.getShaderPrecisionFormat(C.VERTEX_SHADER,C.MEDIUM_FLOAT).precision>0&&C.getShaderPrecisionFormat(C.FRAGMENT_SHADER,C.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let k=d.precision!==void 0?d.precision:"highp";const j=P(k);j!==k&&(console.warn("THREE.WebGLRenderer:",k,"not supported, using",j,"instead."),k=j);const X=d.logarithmicDepthBuffer===!0,q=C.getParameter(C.MAX_TEXTURE_IMAGE_UNITS),K=C.getParameter(C.MAX_VERTEX_TEXTURE_IMAGE_UNITS),te=C.getParameter(C.MAX_TEXTURE_SIZE),oe=C.getParameter(C.MAX_CUBE_MAP_TEXTURE_SIZE),re=C.getParameter(C.MAX_VERTEX_ATTRIBS),ee=C.getParameter(C.MAX_VERTEX_UNIFORM_VECTORS),Me=C.getParameter(C.MAX_VARYING_VECTORS),we=C.getParameter(C.MAX_FRAGMENT_UNIFORM_VECTORS),_e=K>0,nt=C.getParameter(C.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:E,getMaxPrecision:P,textureFormatReadable:M,textureTypeReadable:N,precision:k,logarithmicDepthBuffer:X,maxTextures:q,maxVertexTextures:K,maxTextureSize:te,maxCubemapSize:oe,maxAttributes:re,maxVertexUniforms:ee,maxVaryings:Me,maxFragmentUniforms:we,vertexTextures:_e,maxSamples:nt}}function TSe(C){const a=this;let d=null,A=0,b=!1,E=!1;const M=new zd,N=new Kr,P={value:null,needsUpdate:!1};this.uniform=P,this.numPlanes=0,this.numIntersection=0,this.init=function(X,q){const K=X.length!==0||q||A!==0||b;return b=q,A=X.length,K},this.beginShadows=function(){E=!0,j(null)},this.endShadows=function(){E=!1},this.setGlobalState=function(X,q){d=j(X,q,0)},this.setState=function(X,q,K){const te=X.clippingPlanes,oe=X.clipIntersection,re=X.clipShadows,ee=C.get(X);if(!b||te===null||te.length===0||E&&!re)E?j(null):k();else{const Me=E?0:A,we=Me*4;let _e=ee.clippingState||null;P.value=_e,_e=j(te,q,we,K);for(let nt=0;nt!==we;++nt)_e[nt]=d[nt];ee.clippingState=_e,this.numIntersection=oe?this.numPlanes:0,this.numPlanes+=Me}};function k(){P.value!==d&&(P.value=d,P.needsUpdate=A>0),a.numPlanes=A,a.numIntersection=0}function j(X,q,K,te){const oe=X!==null?X.length:0;let re=null;if(oe!==0){if(re=P.value,te!==!0||re===null){const ee=K+oe*4,Me=q.matrixWorldInverse;N.getNormalMatrix(Me),(re===null||re.length<ee)&&(re=new Float32Array(ee));for(let we=0,_e=K;we!==oe;++we,_e+=4)M.copy(X[we]).applyMatrix4(Me,N),M.normal.toArray(re,_e),re[_e+3]=M.constant}P.value=re,P.needsUpdate=!0}return a.numPlanes=oe,a.numIntersection=0,re}}function MSe(C){let a=new WeakMap;function d(M,N){return N===ie?M.mapping=F:N===Re&&(M.mapping=J),M}function A(M){if(M&&M.isTexture){const N=M.mapping;if(N===ie||N===Re)if(a.has(M)){const P=a.get(M).texture;return d(P,M.mapping)}else{const P=M.image;if(P&&P.height>0){const k=new Rj(P.height);return k.fromEquirectangularTexture(C,M),a.set(M,k),M.addEventListener("dispose",b),d(k.texture,M.mapping)}else return null}}return M}function b(M){const N=M.target;N.removeEventListener("dispose",b);const P=a.get(N);P!==void 0&&(a.delete(N),P.dispose())}function E(){a=new WeakMap}return{get:A,dispose:E}}class JE extends XE{constructor(a=-1,d=1,A=1,b=-1,E=.1,M=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=a,this.right=d,this.top=A,this.bottom=b,this.near=E,this.far=M,this.updateProjectionMatrix()}copy(a,d){return super.copy(a,d),this.left=a.left,this.right=a.right,this.top=a.top,this.bottom=a.bottom,this.near=a.near,this.far=a.far,this.zoom=a.zoom,this.view=a.view===null?null:Object.assign({},a.view),this}setViewOffset(a,d,A,b,E,M){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=a,this.view.fullHeight=d,this.view.offsetX=A,this.view.offsetY=b,this.view.width=E,this.view.height=M,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const a=(this.right-this.left)/(2*this.zoom),d=(this.top-this.bottom)/(2*this.zoom),A=(this.right+this.left)/2,b=(this.top+this.bottom)/2;let E=A-a,M=A+a,N=b+d,P=b-d;if(this.view!==null&&this.view.enabled){const k=(this.right-this.left)/this.view.fullWidth/this.zoom,j=(this.top-this.bottom)/this.view.fullHeight/this.zoom;E+=k*this.view.offsetX,M=E+k*this.view.width,N-=j*this.view.offsetY,P=N-j*this.view.height}this.projectionMatrix.makeOrthographic(E,M,N,P,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(a){const d=super.toJSON(a);return d.object.zoom=this.zoom,d.object.left=this.left,d.object.right=this.right,d.object.top=this.top,d.object.bottom=this.bottom,d.object.near=this.near,d.object.far=this.far,this.view!==null&&(d.object.view=Object.assign({},this.view)),d}}const v0=4,Ij=[.125,.215,.35,.446,.526,.582],yf=20,sN=new JE,Bj=new lr;let aN=null,oN=0,lN=0,cN=!1;const vf=(1+Math.sqrt(5))/2,x0=1/vf,Nj=[new He(-vf,x0,0),new He(vf,x0,0),new He(-x0,0,vf),new He(x0,0,vf),new He(0,vf,-x0),new He(0,vf,x0),new He(-1,1,-1),new He(1,1,-1),new He(-1,1,1),new He(1,1,1)];class uN{constructor(a){this._renderer=a,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(a,d=0,A=.1,b=100){aN=this._renderer.getRenderTarget(),oN=this._renderer.getActiveCubeFace(),lN=this._renderer.getActiveMipmapLevel(),cN=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);const E=this._allocateTargets();return E.depthBuffer=!0,this._sceneToCubeUV(a,A,b,E),d>0&&this._blur(E,0,0,d),this._applyPMREM(E),this._cleanup(E),E}fromEquirectangular(a,d=null){return this._fromTexture(a,d)}fromCubemap(a,d=null){return this._fromTexture(a,d)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=Oj(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=Dj(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(a){this._lodMax=Math.floor(Math.log2(a)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let a=0;a<this._lodPlanes.length;a++)this._lodPlanes[a].dispose()}_cleanup(a){this._renderer.setRenderTarget(aN,oN,lN),this._renderer.xr.enabled=cN,a.scissorTest=!1,ZE(a,0,0,a.width,a.height)}_fromTexture(a,d){a.mapping===F||a.mapping===J?this._setSize(a.image.length===0?16:a.image[0].width||a.image[0].image.width):this._setSize(a.image.width/4),aN=this._renderer.getRenderTarget(),oN=this._renderer.getActiveCubeFace(),lN=this._renderer.getActiveMipmapLevel(),cN=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const A=d||this._allocateTargets();return this._textureToCubeUV(a,A),this._applyPMREM(A),this._cleanup(A),A}_allocateTargets(){const a=3*Math.max(this._cubeSize,112),d=4*this._cubeSize,A={magFilter:ki,minFilter:ki,generateMipmaps:!1,type:Xt,format:ge,colorSpace:Ic,depthBuffer:!1},b=Lj(a,d,A);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==a||this._pingPongRenderTarget.height!==d){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=Lj(a,d,A);const{_lodMax:E}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=RSe(E)),this._blurMaterial=ISe(E,a,d)}return b}_compileMaterial(a){const d=new ua(this._lodPlanes[0],a);this._renderer.compile(d,sN)}_sceneToCubeUV(a,d,A,b){const E=new xa(90,1,d,A),M=[1,-1,1,1,1,1],N=[1,1,1,-1,-1,-1],P=this._renderer,k=P.autoClear,j=P.toneMapping;P.getClearColor(Bj),P.toneMapping=Ot,P.autoClear=!1;const X=new Fd({name:"PMREM.Background",side:R,depthWrite:!1,depthTest:!1}),q=new ua(new mf,X);let K=!1;const te=a.background;te?te.isColor&&(X.color.copy(te),a.background=null,K=!0):(X.color.copy(Bj),K=!0);for(let oe=0;oe<6;oe++){const re=oe%3;re===0?(E.up.set(0,M[oe],0),E.lookAt(N[oe],0,0)):re===1?(E.up.set(0,0,M[oe]),E.lookAt(0,N[oe],0)):(E.up.set(0,M[oe],0),E.lookAt(0,0,N[oe]));const ee=this._cubeSize;ZE(b,re*ee,oe>2?ee:0,ee,ee),P.setRenderTarget(b),K&&P.render(q,E),P.render(a,E)}q.geometry.dispose(),q.material.dispose(),P.toneMapping=j,P.autoClear=k,a.background=te}_textureToCubeUV(a,d){const A=this._renderer,b=a.mapping===F||a.mapping===J;b?(this._cubemapMaterial===null&&(this._cubemapMaterial=Oj()),this._cubemapMaterial.uniforms.flipEnvMap.value=a.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=Dj());const E=b?this._cubemapMaterial:this._equirectMaterial,M=new ua(this._lodPlanes[0],E),N=E.uniforms;N.envMap.value=a;const P=this._cubeSize;ZE(d,0,0,3*P,2*P),A.setRenderTarget(d),A.render(M,sN)}_applyPMREM(a){const d=this._renderer,A=d.autoClear;d.autoClear=!1;const b=this._lodPlanes.length;for(let E=1;E<b;E++){const M=Math.sqrt(this._sigmas[E]*this._sigmas[E]-this._sigmas[E-1]*this._sigmas[E-1]),N=Nj[(b-E-1)%Nj.length];this._blur(a,E-1,E,M,N)}d.autoClear=A}_blur(a,d,A,b,E){const M=this._pingPongRenderTarget;this._halfBlur(a,M,d,A,b,"latitudinal",E),this._halfBlur(M,a,A,A,b,"longitudinal",E)}_halfBlur(a,d,A,b,E,M,N){const P=this._renderer,k=this._blurMaterial;M!=="latitudinal"&&M!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const j=3,X=new ua(this._lodPlanes[b],k),q=k.uniforms,K=this._sizeLods[A]-1,te=isFinite(E)?Math.PI/(2*K):2*Math.PI/(2*yf-1),oe=E/te,re=isFinite(E)?1+Math.floor(j*oe):yf;re>yf&&console.warn(`sigmaRadians, ${E}, is too large and will clip, as it requested ${re} samples when the maximum is set to ${yf}`);const ee=[];let Me=0;for(let Je=0;Je<yf;++Je){const it=Je/oe,ze=Math.exp(-it*it/2);ee.push(ze),Je===0?Me+=ze:Je<re&&(Me+=2*ze)}for(let Je=0;Je<ee.length;Je++)ee[Je]=ee[Je]/Me;q.envMap.value=a.texture,q.samples.value=re,q.weights.value=ee,q.latitudinal.value=M==="latitudinal",N&&(q.poleAxis.value=N);const{_lodMax:we}=this;q.dTheta.value=te,q.mipInt.value=we-A;const _e=this._sizeLods[b],nt=3*_e*(b>we-v0?b-we+v0:0),qe=4*(this._cubeSize-_e);ZE(d,nt,qe,3*_e,2*_e),P.setRenderTarget(d),P.render(X,sN)}}function RSe(C){const a=[],d=[],A=[];let b=C;const E=C-v0+1+Ij.length;for(let M=0;M<E;M++){const N=Math.pow(2,b);d.push(N);let P=1/N;M>C-v0?P=Ij[M-C+v0-1]:M===0&&(P=0),A.push(P);const k=1/(N-2),j=-k,X=1+k,q=[j,j,X,j,X,X,j,j,X,X,j,X],K=6,te=6,oe=3,re=2,ee=1,Me=new Float32Array(oe*te*K),we=new Float32Array(re*te*K),_e=new Float32Array(ee*te*K);for(let qe=0;qe<K;qe++){const Je=qe%3*2/3-1,it=qe>2?0:-1,ze=[Je,it,0,Je+2/3,it,0,Je+2/3,it+1,0,Je,it,0,Je+2/3,it+1,0,Je,it+1,0];Me.set(ze,oe*te*qe),we.set(q,re*te*qe);const Oe=[qe,qe,qe,qe,qe,qe];_e.set(Oe,ee*te*qe)}const nt=new fn;nt.setAttribute("position",new ls(Me,oe)),nt.setAttribute("uv",new ls(we,re)),nt.setAttribute("faceIndex",new ls(_e,ee)),a.push(nt),b>v0&&b--}return{lodPlanes:a,sizeLods:d,sigmas:A}}function Lj(C,a,d){const A=new el(C,a,d);return A.texture.mapping=ce,A.texture.name="PMREM.cubeUv",A.scissorTest=!0,A}function ZE(C,a,d,A,b){C.viewport.set(a,d,A,b),C.scissor.set(a,d,A,b)}function ISe(C,a,d){const A=new Float32Array(yf),b=new He(0,1,0);return new Nc({name:"SphericalGaussianBlur",defines:{n:yf,CUBEUV_TEXEL_WIDTH:1/a,CUBEUV_TEXEL_HEIGHT:1/d,CUBEUV_MAX_MIP:`${C}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:A},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:b}},vertexShader:hN(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:I,depthTest:!1,depthWrite:!1})}function Dj(){return new Nc({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:hN(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:I,depthTest:!1,depthWrite:!1})}function Oj(){return new Nc({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:hN(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:I,depthTest:!1,depthWrite:!1})}function hN(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function BSe(C){let a=new WeakMap,d=null;function A(N){if(N&&N.isTexture){const P=N.mapping,k=P===ie||P===Re,j=P===F||P===J;if(k||j){let X=a.get(N);const q=X!==void 0?X.texture.pmremVersion:0;if(N.isRenderTargetTexture&&N.pmremVersion!==q)return d===null&&(d=new uN(C)),X=k?d.fromEquirectangular(N,X):d.fromCubemap(N,X),X.texture.pmremVersion=N.pmremVersion,a.set(N,X),X.texture;if(X!==void 0)return X.texture;{const K=N.image;return k&&K&&K.height>0||j&&K&&b(K)?(d===null&&(d=new uN(C)),X=k?d.fromEquirectangular(N):d.fromCubemap(N),X.texture.pmremVersion=N.pmremVersion,a.set(N,X),N.addEventListener("dispose",E),X.texture):null}}}return N}function b(N){let P=0;const k=6;for(let j=0;j<k;j++)N[j]!==void 0&&P++;return P===k}function E(N){const P=N.target;P.removeEventListener("dispose",E);const k=a.get(P);k!==void 0&&(a.delete(P),k.dispose())}function M(){a=new WeakMap,d!==null&&(d.dispose(),d=null)}return{get:A,dispose:M}}function NSe(C){const a={};function d(A){if(a[A]!==void 0)return a[A];let b;switch(A){case"WEBGL_depth_texture":b=C.getExtension("WEBGL_depth_texture")||C.getExtension("MOZ_WEBGL_depth_texture")||C.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":b=C.getExtension("EXT_texture_filter_anisotropic")||C.getExtension("MOZ_EXT_texture_filter_anisotropic")||C.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":b=C.getExtension("WEBGL_compressed_texture_s3tc")||C.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||C.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":b=C.getExtension("WEBGL_compressed_texture_pvrtc")||C.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:b=C.getExtension(A)}return a[A]=b,b}return{has:function(A){return d(A)!==null},init:function(){d("EXT_color_buffer_float"),d("WEBGL_clip_cull_distance"),d("OES_texture_float_linear"),d("EXT_color_buffer_half_float"),d("WEBGL_multisampled_render_to_texture"),d("WEBGL_render_shared_exponent")},get:function(A){const b=d(A);return b===null&&console.warn("THREE.WebGLRenderer: "+A+" extension not supported."),b}}}function LSe(C,a,d,A){const b={},E=new WeakMap;function M(X){const q=X.target;q.index!==null&&a.remove(q.index);for(const te in q.attributes)a.remove(q.attributes[te]);for(const te in q.morphAttributes){const oe=q.morphAttributes[te];for(let re=0,ee=oe.length;re<ee;re++)a.remove(oe[re])}q.removeEventListener("dispose",M),delete b[q.id];const K=E.get(q);K&&(a.remove(K),E.delete(q)),A.releaseStatesOfGeometry(q),q.isInstancedBufferGeometry===!0&&delete q._maxInstanceCount,d.memory.geometries--}function N(X,q){return b[q.id]===!0||(q.addEventListener("dispose",M),b[q.id]=!0,d.memory.geometries++),q}function P(X){const q=X.attributes;for(const te in q)a.update(q[te],C.ARRAY_BUFFER);const K=X.morphAttributes;for(const te in K){const oe=K[te];for(let re=0,ee=oe.length;re<ee;re++)a.update(oe[re],C.ARRAY_BUFFER)}}function k(X){const q=[],K=X.index,te=X.attributes.position;let oe=0;if(K!==null){const Me=K.array;oe=K.version;for(let we=0,_e=Me.length;we<_e;we+=3){const nt=Me[we+0],qe=Me[we+1],Je=Me[we+2];q.push(nt,qe,qe,Je,Je,nt)}}else if(te!==void 0){const Me=te.array;oe=te.version;for(let we=0,_e=Me.length/3-1;we<_e;we+=3){const nt=we+0,qe=we+1,Je=we+2;q.push(nt,qe,qe,Je,Je,nt)}}else return;const re=new(TE(q)?eN:$B)(q,1);re.version=oe;const ee=E.get(X);ee&&a.remove(ee),E.set(X,re)}function j(X){const q=E.get(X);if(q){const K=X.index;K!==null&&q.version<K.version&&k(X)}else k(X);return E.get(X)}return{get:N,update:P,getWireframeAttribute:j}}function DSe(C,a,d){let A;function b(q){A=q}let E,M;function N(q){E=q.type,M=q.bytesPerElement}function P(q,K){C.drawElements(A,K,E,q*M),d.update(K,A,1)}function k(q,K,te){te!==0&&(C.drawElementsInstanced(A,K,E,q*M,te),d.update(K,A,te))}function j(q,K,te){if(te===0)return;const oe=a.get("WEBGL_multi_draw");if(oe===null)for(let re=0;re<te;re++)this.render(q[re]/M,K[re]);else{oe.multiDrawElementsWEBGL(A,K,0,E,q,0,te);let re=0;for(let ee=0;ee<te;ee++)re+=K[ee];d.update(re,A,1)}}function X(q,K,te,oe){if(te===0)return;const re=a.get("WEBGL_multi_draw");if(re===null)for(let ee=0;ee<q.length;ee++)k(q[ee]/M,K[ee],oe[ee]);else{re.multiDrawElementsInstancedWEBGL(A,K,0,E,q,0,oe,0,te);let ee=0;for(let Me=0;Me<te;Me++)ee+=K[Me];for(let Me=0;Me<oe.length;Me++)d.update(ee,A,oe[Me])}}this.setMode=b,this.setIndex=N,this.render=P,this.renderInstances=k,this.renderMultiDraw=j,this.renderMultiDrawInstances=X}function OSe(C){const a={geometries:0,textures:0},d={frame:0,calls:0,triangles:0,points:0,lines:0};function A(E,M,N){switch(d.calls++,M){case C.TRIANGLES:d.triangles+=N*(E/3);break;case C.LINES:d.lines+=N*(E/2);break;case C.LINE_STRIP:d.lines+=N*(E-1);break;case C.LINE_LOOP:d.lines+=N*E;break;case C.POINTS:d.points+=N*E;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",M);break}}function b(){d.calls=0,d.triangles=0,d.points=0,d.lines=0}return{memory:a,render:d,programs:null,autoReset:!0,reset:b,update:A}}function PSe(C,a,d){const A=new WeakMap,b=new jn;function E(M,N,P){const k=M.morphTargetInfluences,j=N.morphAttributes.position||N.morphAttributes.normal||N.morphAttributes.color,X=j!==void 0?j.length:0;let q=A.get(N);if(q===void 0||q.count!==X){let K=function(){it.dispose(),A.delete(N),N.removeEventListener("dispose",K)};q!==void 0&&q.texture.dispose();const te=N.morphAttributes.position!==void 0,oe=N.morphAttributes.normal!==void 0,re=N.morphAttributes.color!==void 0,ee=N.morphAttributes.position||[],Me=N.morphAttributes.normal||[],we=N.morphAttributes.color||[];let _e=0;te===!0&&(_e=1),oe===!0&&(_e=2),re===!0&&(_e=3);let nt=N.attributes.position.count*_e,qe=1;nt>a.maxTextureSize&&(qe=Math.ceil(nt/a.maxTextureSize),nt=a.maxTextureSize);const Je=new Float32Array(nt*qe*4*X),it=new i0(Je,nt,qe,X);it.type=St,it.needsUpdate=!0;const ze=_e*4;for(let Oe=0;Oe<X;Oe++){const rt=ee[Oe],mt=Me[Oe],pt=we[Oe],Tt=nt*qe*4*Oe;for(let Pt=0;Pt<rt.count;Pt++){const hi=Pt*ze;te===!0&&(b.fromBufferAttribute(rt,Pt),Je[Tt+hi+0]=b.x,Je[Tt+hi+1]=b.y,Je[Tt+hi+2]=b.z,Je[Tt+hi+3]=0),oe===!0&&(b.fromBufferAttribute(mt,Pt),Je[Tt+hi+4]=b.x,Je[Tt+hi+5]=b.y,Je[Tt+hi+6]=b.z,Je[Tt+hi+7]=0),re===!0&&(b.fromBufferAttribute(pt,Pt),Je[Tt+hi+8]=b.x,Je[Tt+hi+9]=b.y,Je[Tt+hi+10]=b.z,Je[Tt+hi+11]=pt.itemSize===4?b.w:1)}}q={count:X,texture:it,size:new si(nt,qe)},A.set(N,q),N.addEventListener("dispose",K)}if(M.isInstancedMesh===!0&&M.morphTexture!==null)P.getUniforms().setValue(C,"morphTexture",M.morphTexture,d);else{let K=0;for(let oe=0;oe<k.length;oe++)K+=k[oe];const te=N.morphTargetsRelative?1:1-K;P.getUniforms().setValue(C,"morphTargetBaseInfluence",te),P.getUniforms().setValue(C,"morphTargetInfluences",k)}P.getUniforms().setValue(C,"morphTargetsTexture",q.texture,d),P.getUniforms().setValue(C,"morphTargetsTextureSize",q.size)}return{update:E}}class kSe{constructor(a,d,A){if(this.renderer=a,this.DEFAULT_NUMVIEWS=2,this.maxNumViews=0,this.gl=A,this.extensions=d,this.available=this.extensions.has("OCULUS_multiview"),this.available){const E=this.extensions.get("OCULUS_multiview");this.maxNumViews=this.gl.getParameter(E.MAX_VIEWS_OVR),this.mat4=[],this.mat3=[],this.cameraArray=[];for(var b=0;b<this.maxNumViews;b++)this.mat4[b]=new mr,this.mat3[b]=new Kr}}getCameraArray(a){return a.isArrayCamera?a.cameras:(this.cameraArray[0]=a,this.cameraArray)}updateCameraProjectionMatricesUniform(a,d){for(var A=this.getCameraArray(a),b=0;b<A.length;b++)this.mat4[b].copy(A[b].projectionMatrix);d.setValue(this.gl,"projectionMatrices",this.mat4)}updateCameraViewMatricesUniform(a,d){for(var A=this.getCameraArray(a),b=0;b<A.length;b++)this.mat4[b].copy(A[b].matrixWorldInverse);d.setValue(this.gl,"viewMatrices",this.mat4)}updateObjectMatricesUniforms(a,d,A){for(var b=this.getCameraArray(d),E=0;E<b.length;E++)this.mat4[E].multiplyMatrices(b[E].matrixWorldInverse,a.matrixWorld),this.mat3[E].getNormalMatrix(this.mat4[E]);A.setValue(this.gl,"modelViewMatrices",this.mat4),A.setValue(this.gl,"normalMatrices",this.mat3)}}function FSe(C,a,d,A){let b=new WeakMap;function E(P){const k=A.render.frame,j=P.geometry,X=a.get(P,j);if(b.get(X)!==k&&(a.update(X),b.set(X,k)),P.isInstancedMesh&&(P.hasEventListener("dispose",N)===!1&&P.addEventListener("dispose",N),b.get(P)!==k&&(d.update(P.instanceMatrix,C.ARRAY_BUFFER),P.instanceColor!==null&&d.update(P.instanceColor,C.ARRAY_BUFFER),b.set(P,k))),P.isSkinnedMesh){const q=P.skeleton;b.get(q)!==k&&(q.update(),b.set(q,k))}return X}function M(){b=new WeakMap}function N(P){const k=P.target;k.removeEventListener("dispose",N),d.remove(k.instanceMatrix),k.instanceColor!==null&&d.remove(k.instanceColor)}return{update:E,dispose:M}}class dN extends fs{constructor(a,d,A,b,E,M,N,P,k,j){if(j=j!==void 0?j:Ke,j!==Ke&&j!==ot)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");A===void 0&&j===Ke&&(A=ct),A===void 0&&j===ot&&(A=Li),super(null,b,E,M,N,P,j,A,k),this.isDepthTexture=!0,this.image={width:a,height:d},this.magFilter=N!==void 0?N:It,this.minFilter=P!==void 0?P:It,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(a){return super.copy(a),this.compareFunction=a.compareFunction,this}toJSON(a){const d=super.toJSON(a);return this.compareFunction!==null&&(d.compareFunction=this.compareFunction),d}}const Pj=new fs,kj=new dN(1,1);kj.compareFunction=cv;const Fj=new i0,Uj=new Jr,zj=new vv,jj=[],Vj=[],Gj=new Float32Array(16),Hj=new Float32Array(9),Wj=new Float32Array(4);function b0(C,a,d){const A=C[0];if(A<=0||A>0)return C;const b=a*d;let E=jj[b];if(E===void 0&&(E=new Float32Array(b),jj[b]=E),a!==0){A.toArray(E,0);for(let M=1,N=0;M!==a;++M)N+=d,C[M].toArray(E,N)}return E}function ba(C,a){if(C.length!==a.length)return!1;for(let d=0,A=C.length;d<A;d++)if(C[d]!==a[d])return!1;return!0}function _a(C,a){for(let d=0,A=a.length;d<A;d++)C[d]=a[d]}function $E(C,a){let d=Vj[a];d===void 0&&(d=new Int32Array(a),Vj[a]=d);for(let A=0;A!==a;++A)d[A]=C.allocateTextureUnit();return d}function USe(C,a){const d=this.cache;d[0]!==a&&(C.uniform1f(this.addr,a),d[0]=a)}function zSe(C,a){const d=this.cache;if(a.x!==void 0)(d[0]!==a.x||d[1]!==a.y)&&(C.uniform2f(this.addr,a.x,a.y),d[0]=a.x,d[1]=a.y);else{if(ba(d,a))return;C.uniform2fv(this.addr,a),_a(d,a)}}function jSe(C,a){const d=this.cache;if(a.x!==void 0)(d[0]!==a.x||d[1]!==a.y||d[2]!==a.z)&&(C.uniform3f(this.addr,a.x,a.y,a.z),d[0]=a.x,d[1]=a.y,d[2]=a.z);else if(a.r!==void 0)(d[0]!==a.r||d[1]!==a.g||d[2]!==a.b)&&(C.uniform3f(this.addr,a.r,a.g,a.b),d[0]=a.r,d[1]=a.g,d[2]=a.b);else{if(ba(d,a))return;C.uniform3fv(this.addr,a),_a(d,a)}}function VSe(C,a){const d=this.cache;if(a.x!==void 0)(d[0]!==a.x||d[1]!==a.y||d[2]!==a.z||d[3]!==a.w)&&(C.uniform4f(this.addr,a.x,a.y,a.z,a.w),d[0]=a.x,d[1]=a.y,d[2]=a.z,d[3]=a.w);else{if(ba(d,a))return;C.uniform4fv(this.addr,a),_a(d,a)}}function GSe(C,a){const d=this.cache,A=a.elements;if(A===void 0){if(ba(d,a))return;C.uniformMatrix2fv(this.addr,!1,a),_a(d,a)}else{if(ba(d,A))return;Wj.set(A),C.uniformMatrix2fv(this.addr,!1,Wj),_a(d,A)}}function HSe(C,a){const d=this.cache,A=a.elements;if(A===void 0){if(ba(d,a))return;C.uniformMatrix3fv(this.addr,!1,a),_a(d,a)}else{if(ba(d,A))return;Hj.set(A),C.uniformMatrix3fv(this.addr,!1,Hj),_a(d,A)}}function WSe(C,a){const d=this.cache,A=a.elements;if(A===void 0){if(ba(d,a))return;C.uniformMatrix4fv(this.addr,!1,a),_a(d,a)}else{if(ba(d,A))return;Gj.set(A),C.uniformMatrix4fv(this.addr,!1,Gj),_a(d,A)}}function QSe(C,a){const d=this.cache;d[0]!==a&&(C.uniform1i(this.addr,a),d[0]=a)}function qSe(C,a){const d=this.cache;if(a.x!==void 0)(d[0]!==a.x||d[1]!==a.y)&&(C.uniform2i(this.addr,a.x,a.y),d[0]=a.x,d[1]=a.y);else{if(ba(d,a))return;C.uniform2iv(this.addr,a),_a(d,a)}}function XSe(C,a){const d=this.cache;if(a.x!==void 0)(d[0]!==a.x||d[1]!==a.y||d[2]!==a.z)&&(C.uniform3i(this.addr,a.x,a.y,a.z),d[0]=a.x,d[1]=a.y,d[2]=a.z);else{if(ba(d,a))return;C.uniform3iv(this.addr,a),_a(d,a)}}function YSe(C,a){const d=this.cache;if(a.x!==void 0)(d[0]!==a.x||d[1]!==a.y||d[2]!==a.z||d[3]!==a.w)&&(C.uniform4i(this.addr,a.x,a.y,a.z,a.w),d[0]=a.x,d[1]=a.y,d[2]=a.z,d[3]=a.w);else{if(ba(d,a))return;C.uniform4iv(this.addr,a),_a(d,a)}}function KSe(C,a){const d=this.cache;d[0]!==a&&(C.uniform1ui(this.addr,a),d[0]=a)}function JSe(C,a){const d=this.cache;if(a.x!==void 0)(d[0]!==a.x||d[1]!==a.y)&&(C.uniform2ui(this.addr,a.x,a.y),d[0]=a.x,d[1]=a.y);else{if(ba(d,a))return;C.uniform2uiv(this.addr,a),_a(d,a)}}function ZSe(C,a){const d=this.cache;if(a.x!==void 0)(d[0]!==a.x||d[1]!==a.y||d[2]!==a.z)&&(C.uniform3ui(this.addr,a.x,a.y,a.z),d[0]=a.x,d[1]=a.y,d[2]=a.z);else{if(ba(d,a))return;C.uniform3uiv(this.addr,a),_a(d,a)}}function $Se(C,a){const d=this.cache;if(a.x!==void 0)(d[0]!==a.x||d[1]!==a.y||d[2]!==a.z||d[3]!==a.w)&&(C.uniform4ui(this.addr,a.x,a.y,a.z,a.w),d[0]=a.x,d[1]=a.y,d[2]=a.z,d[3]=a.w);else{if(ba(d,a))return;C.uniform4uiv(this.addr,a),_a(d,a)}}function eTe(C,a,d){const A=this.cache,b=d.allocateTextureUnit();A[0]!==b&&(C.uniform1i(this.addr,b),A[0]=b);const E=this.type===C.SAMPLER_2D_SHADOW?kj:Pj;d.setTexture2D(a||E,b)}function tTe(C,a,d){const A=this.cache,b=d.allocateTextureUnit();A[0]!==b&&(C.uniform1i(this.addr,b),A[0]=b),d.setTexture3D(a||Uj,b)}function iTe(C,a,d){const A=this.cache,b=d.allocateTextureUnit();A[0]!==b&&(C.uniform1i(this.addr,b),A[0]=b),d.setTextureCube(a||zj,b)}function rTe(C,a,d){const A=this.cache,b=d.allocateTextureUnit();A[0]!==b&&(C.uniform1i(this.addr,b),A[0]=b),d.setTexture2DArray(a||Fj,b)}function nTe(C){switch(C){case 5126:return USe;case 35664:return zSe;case 35665:return jSe;case 35666:return VSe;case 35674:return GSe;case 35675:return HSe;case 35676:return WSe;case 5124:case 35670:return QSe;case 35667:case 35671:return qSe;case 35668:case 35672:return XSe;case 35669:case 35673:return YSe;case 5125:return KSe;case 36294:return JSe;case 36295:return ZSe;case 36296:return $Se;case 35678:case 36198:case 36298:case 36306:case 35682:return eTe;case 35679:case 36299:case 36307:return tTe;case 35680:case 36300:case 36308:case 36293:return iTe;case 36289:case 36303:case 36311:case 36292:return rTe}}function sTe(C,a){C.uniform1fv(this.addr,a)}function aTe(C,a){const d=b0(a,this.size,2);C.uniform2fv(this.addr,d)}function oTe(C,a){const d=b0(a,this.size,3);C.uniform3fv(this.addr,d)}function lTe(C,a){const d=b0(a,this.size,4);C.uniform4fv(this.addr,d)}function cTe(C,a){const d=b0(a,this.size,4);C.uniformMatrix2fv(this.addr,!1,d)}function uTe(C,a){const d=b0(a,this.size,9);C.uniformMatrix3fv(this.addr,!1,d)}function hTe(C,a){const d=b0(a,this.size,16);C.uniformMatrix4fv(this.addr,!1,d)}function dTe(C,a){C.uniform1iv(this.addr,a)}function pTe(C,a){C.uniform2iv(this.addr,a)}function fTe(C,a){C.uniform3iv(this.addr,a)}function mTe(C,a){C.uniform4iv(this.addr,a)}function gTe(C,a){C.uniform1uiv(this.addr,a)}function ATe(C,a){C.uniform2uiv(this.addr,a)}function yTe(C,a){C.uniform3uiv(this.addr,a)}function vTe(C,a){C.uniform4uiv(this.addr,a)}function xTe(C,a,d){const A=this.cache,b=a.length,E=$E(d,b);ba(A,E)||(C.uniform1iv(this.addr,E),_a(A,E));for(let M=0;M!==b;++M)d.setTexture2D(a[M]||Pj,E[M])}function bTe(C,a,d){const A=this.cache,b=a.length,E=$E(d,b);ba(A,E)||(C.uniform1iv(this.addr,E),_a(A,E));for(let M=0;M!==b;++M)d.setTexture3D(a[M]||Uj,E[M])}function _Te(C,a,d){const A=this.cache,b=a.length,E=$E(d,b);ba(A,E)||(C.uniform1iv(this.addr,E),_a(A,E));for(let M=0;M!==b;++M)d.setTextureCube(a[M]||zj,E[M])}function ETe(C,a,d){const A=this.cache,b=a.length,E=$E(d,b);ba(A,E)||(C.uniform1iv(this.addr,E),_a(A,E));for(let M=0;M!==b;++M)d.setTexture2DArray(a[M]||Fj,E[M])}function wTe(C){switch(C){case 5126:return sTe;case 35664:return aTe;case 35665:return oTe;case 35666:return lTe;case 35674:return cTe;case 35675:return uTe;case 35676:return hTe;case 5124:case 35670:return dTe;case 35667:case 35671:return pTe;case 35668:case 35672:return fTe;case 35669:case 35673:return mTe;case 5125:return gTe;case 36294:return ATe;case 36295:return yTe;case 36296:return vTe;case 35678:case 36198:case 36298:case 36306:case 35682:return xTe;case 35679:case 36299:case 36307:return bTe;case 35680:case 36300:case 36308:case 36293:return _Te;case 36289:case 36303:case 36311:case 36292:return ETe}}class CTe{constructor(a,d,A){this.id=a,this.addr=A,this.cache=[],this.type=d.type,this.setValue=nTe(d.type)}}class STe{constructor(a,d,A){this.id=a,this.addr=A,this.cache=[],this.type=d.type,this.size=d.size,this.setValue=wTe(d.type)}}class TTe{constructor(a){this.id=a,this.seq=[],this.map={}}setValue(a,d,A){const b=this.seq;for(let E=0,M=b.length;E!==M;++E){const N=b[E];N.setValue(a,d[N.id],A)}}}const pN=/(\w+)(\])?(\[|\.)?/g;function Qj(C,a){C.seq.push(a),C.map[a.id]=a}function MTe(C,a,d){const A=C.name,b=A.length;for(pN.lastIndex=0;;){const E=pN.exec(A),M=pN.lastIndex;let N=E[1];const P=E[2]==="]",k=E[3];if(P&&(N=N|0),k===void 0||k==="["&&M+2===b){Qj(d,k===void 0?new CTe(N,C,a):new STe(N,C,a));break}else{let j=d.map[N];j===void 0&&(j=new TTe(N),Qj(d,j)),d=j}}}class ew{constructor(a,d){this.seq=[],this.map={};const A=a.getProgramParameter(d,a.ACTIVE_UNIFORMS);for(let b=0;b<A;++b){const E=a.getActiveUniform(d,b),M=a.getUniformLocation(d,E.name);MTe(E,M,this)}}setValue(a,d,A,b){const E=this.map[d];E!==void 0&&E.setValue(a,A,b)}setOptional(a,d,A){const b=d[A];b!==void 0&&this.setValue(a,A,b)}static upload(a,d,A,b){for(let E=0,M=d.length;E!==M;++E){const N=d[E],P=A[N.id];P.needsUpdate!==!1&&N.setValue(a,P.value,b)}}static seqWithValue(a,d){const A=[];for(let b=0,E=a.length;b!==E;++b){const M=a[b];M.id in d&&A.push(M)}return A}}function qj(C,a,d){const A=C.createShader(a);return C.shaderSource(A,d),C.compileShader(A),A}const RTe=37297;let ITe=0;function BTe(C,a){const d=C.split(`
`),A=[],b=Math.max(a-6,0),E=Math.min(a+6,d.length);for(let M=b;M<E;M++){const N=M+1;A.push(`${N===a?">":" "} ${N}: ${d[M]}`)}return A.join(`
`)}function NTe(C){const a=Zn.getPrimaries(Zn.workingColorSpace),d=Zn.getPrimaries(C);let A;switch(a===d?A="":a===cf&&d===lf?A="LinearDisplayP3ToLinearSRGB":a===lf&&d===cf&&(A="LinearSRGBToLinearDisplayP3"),C){case Ic:case af:return[A,"LinearTransferOETF"];case kn:case Zg:return[A,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",C),[A,"LinearTransferOETF"]}}function Xj(C,a,d){const A=C.getShaderParameter(a,C.COMPILE_STATUS),b=C.getShaderInfoLog(a).trim();if(A&&b==="")return"";const E=/ERROR: 0:(\d+)/.exec(b);if(E){const M=parseInt(E[1]);return d.toUpperCase()+`

`+b+`

`+BTe(C.getShaderSource(a),M)}else return b}function LTe(C,a){const d=NTe(a);return`vec4 ${C}( vec4 value ) { return ${d[0]}( ${d[1]}( value ) ); }`}function DTe(C,a){let d;switch(a){case Jt:d="Linear";break;case zt:d="Reinhard";break;case _i:d="OptimizedCineon";break;case vt:d="ACESFilmic";break;case ve:d="AgX";break;case Le:d="Neutral";break;case ye:d="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",a),d="Linear"}return"vec3 "+C+"( vec3 color ) { return "+d+"ToneMapping( color ); }"}function OTe(C){return[C.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",C.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(bv).join(`
`)}function PTe(C){const a=[];for(const d in C){const A=C[d];A!==!1&&a.push("#define "+d+" "+A)}return a.join(`
`)}function kTe(C,a){const d={},A=C.getProgramParameter(a,C.ACTIVE_ATTRIBUTES);for(let b=0;b<A;b++){const E=C.getActiveAttrib(a,b),M=E.name;let N=1;E.type===C.FLOAT_MAT2&&(N=2),E.type===C.FLOAT_MAT3&&(N=3),E.type===C.FLOAT_MAT4&&(N=4),d[M]={type:E.type,location:C.getAttribLocation(a,M),locationSize:N}}return d}function bv(C){return C!==""}function Yj(C,a){const d=a.numSpotLightShadows+a.numSpotLightMaps-a.numSpotLightShadowsWithMaps;return C.replace(/NUM_DIR_LIGHTS/g,a.numDirLights).replace(/NUM_SPOT_LIGHTS/g,a.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,a.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,d).replace(/NUM_RECT_AREA_LIGHTS/g,a.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,a.numPointLights).replace(/NUM_HEMI_LIGHTS/g,a.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,a.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,a.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,a.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,a.numPointLightShadows)}function Kj(C,a){return C.replace(/NUM_CLIPPING_PLANES/g,a.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,a.numClippingPlanes-a.numClipIntersection)}const FTe=/^[ \t]*#include +<([\w\d./]+)>/gm;function fN(C){return C.replace(FTe,zTe)}const UTe=new Map;function zTe(C,a){let d=ln[a];if(d===void 0){const A=UTe.get(a);if(A!==void 0)d=ln[A],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',a,A);else throw new Error("Can not resolve #include <"+a+">")}return fN(d)}const jTe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Jj(C){return C.replace(jTe,VTe)}function VTe(C,a,d,A){let b="";for(let E=parseInt(a);E<parseInt(d);E++)b+=A.replace(/\[\s*i\s*\]/g,"[ "+E+" ]").replace(/UNROLLED_LOOP_INDEX/g,E);return b}function Zj(C){let a=`precision ${C.precision} float;
	precision ${C.precision} int;
	precision ${C.precision} sampler2D;
	precision ${C.precision} samplerCube;
	precision ${C.precision} sampler3D;
	precision ${C.precision} sampler2DArray;
	precision ${C.precision} sampler2DShadow;
	precision ${C.precision} samplerCubeShadow;
	precision ${C.precision} sampler2DArrayShadow;
	precision ${C.precision} isampler2D;
	precision ${C.precision} isampler3D;
	precision ${C.precision} isamplerCube;
	precision ${C.precision} isampler2DArray;
	precision ${C.precision} usampler2D;
	precision ${C.precision} usampler3D;
	precision ${C.precision} usamplerCube;
	precision ${C.precision} usampler2DArray;
	`;return C.precision==="highp"?a+=`
#define HIGH_PRECISION`:C.precision==="mediump"?a+=`
#define MEDIUM_PRECISION`:C.precision==="lowp"&&(a+=`
#define LOW_PRECISION`),a}function GTe(C){let a="SHADOWMAP_TYPE_BASIC";return C.shadowMapType===_?a="SHADOWMAP_TYPE_PCF":C.shadowMapType===T?a="SHADOWMAP_TYPE_PCF_SOFT":C.shadowMapType===w&&(a="SHADOWMAP_TYPE_VSM"),a}function HTe(C){let a="ENVMAP_TYPE_CUBE";if(C.envMap)switch(C.envMapMode){case F:case J:a="ENVMAP_TYPE_CUBE";break;case ce:a="ENVMAP_TYPE_CUBE_UV";break}return a}function WTe(C){let a="ENVMAP_MODE_REFLECTION";if(C.envMap)switch(C.envMapMode){case J:a="ENVMAP_MODE_REFRACTION";break}return a}function QTe(C){let a="ENVMAP_BLENDING_NONE";if(C.envMap)switch(C.combine){case Qe:a="ENVMAP_BLENDING_MULTIPLY";break;case Ce:a="ENVMAP_BLENDING_MIX";break;case yt:a="ENVMAP_BLENDING_ADD";break}return a}function qTe(C){const a=C.envMapCubeUVHeight;if(a===null)return null;const d=Math.log2(a)-2,A=1/a;return{texelWidth:1/(3*Math.max(Math.pow(2,d),112)),texelHeight:A,maxMip:d}}function XTe(C,a,d,A){const b=C.getContext(),E=d.defines;let M=d.vertexShader,N=d.fragmentShader;const P=GTe(d),k=HTe(d),j=WTe(d),X=QTe(d),q=qTe(d),K=OTe(d),te=PTe(E),oe=b.createProgram();let re,ee,Me=d.glslVersion?"#version "+d.glslVersion+`
`:"";const we=d.numMultiviewViews;d.isRawShaderMaterial?(re=["#define SHADER_TYPE "+d.shaderType,"#define SHADER_NAME "+d.shaderName,te].filter(bv).join(`
`),re.length>0&&(re+=`
`),ee=["#define SHADER_TYPE "+d.shaderType,"#define SHADER_NAME "+d.shaderName,te].filter(bv).join(`
`),ee.length>0&&(ee+=`
`)):(re=[Zj(d),"#define SHADER_TYPE "+d.shaderType,"#define SHADER_NAME "+d.shaderName,te,d.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",d.batching?"#define USE_BATCHING":"",d.instancing?"#define USE_INSTANCING":"",d.instancingColor?"#define USE_INSTANCING_COLOR":"",d.instancingMorph?"#define USE_INSTANCING_MORPH":"",d.useFog&&d.fog?"#define USE_FOG":"",d.useFog&&d.fogExp2?"#define FOG_EXP2":"",d.map?"#define USE_MAP":"",d.envMap?"#define USE_ENVMAP":"",d.envMap?"#define "+j:"",d.lightMap?"#define USE_LIGHTMAP":"",d.aoMap?"#define USE_AOMAP":"",d.bumpMap?"#define USE_BUMPMAP":"",d.normalMap?"#define USE_NORMALMAP":"",d.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",d.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",d.displacementMap?"#define USE_DISPLACEMENTMAP":"",d.emissiveMap?"#define USE_EMISSIVEMAP":"",d.anisotropy?"#define USE_ANISOTROPY":"",d.anisotropyMap?"#define USE_ANISOTROPYMAP":"",d.clearcoatMap?"#define USE_CLEARCOATMAP":"",d.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",d.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",d.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",d.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",d.specularMap?"#define USE_SPECULARMAP":"",d.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",d.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",d.roughnessMap?"#define USE_ROUGHNESSMAP":"",d.metalnessMap?"#define USE_METALNESSMAP":"",d.alphaMap?"#define USE_ALPHAMAP":"",d.alphaHash?"#define USE_ALPHAHASH":"",d.transmission?"#define USE_TRANSMISSION":"",d.transmissionMap?"#define USE_TRANSMISSIONMAP":"",d.thicknessMap?"#define USE_THICKNESSMAP":"",d.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",d.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",d.mapUv?"#define MAP_UV "+d.mapUv:"",d.alphaMapUv?"#define ALPHAMAP_UV "+d.alphaMapUv:"",d.lightMapUv?"#define LIGHTMAP_UV "+d.lightMapUv:"",d.aoMapUv?"#define AOMAP_UV "+d.aoMapUv:"",d.emissiveMapUv?"#define EMISSIVEMAP_UV "+d.emissiveMapUv:"",d.bumpMapUv?"#define BUMPMAP_UV "+d.bumpMapUv:"",d.normalMapUv?"#define NORMALMAP_UV "+d.normalMapUv:"",d.displacementMapUv?"#define DISPLACEMENTMAP_UV "+d.displacementMapUv:"",d.metalnessMapUv?"#define METALNESSMAP_UV "+d.metalnessMapUv:"",d.roughnessMapUv?"#define ROUGHNESSMAP_UV "+d.roughnessMapUv:"",d.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+d.anisotropyMapUv:"",d.clearcoatMapUv?"#define CLEARCOATMAP_UV "+d.clearcoatMapUv:"",d.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+d.clearcoatNormalMapUv:"",d.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+d.clearcoatRoughnessMapUv:"",d.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+d.iridescenceMapUv:"",d.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+d.iridescenceThicknessMapUv:"",d.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+d.sheenColorMapUv:"",d.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+d.sheenRoughnessMapUv:"",d.specularMapUv?"#define SPECULARMAP_UV "+d.specularMapUv:"",d.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+d.specularColorMapUv:"",d.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+d.specularIntensityMapUv:"",d.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+d.transmissionMapUv:"",d.thicknessMapUv?"#define THICKNESSMAP_UV "+d.thicknessMapUv:"",d.vertexTangents&&d.flatShading===!1?"#define USE_TANGENT":"",d.vertexColors?"#define USE_COLOR":"",d.vertexAlphas?"#define USE_COLOR_ALPHA":"",d.vertexUv1s?"#define USE_UV1":"",d.vertexUv2s?"#define USE_UV2":"",d.vertexUv3s?"#define USE_UV3":"",d.pointsUvs?"#define USE_POINTS_UV":"",d.flatShading?"#define FLAT_SHADED":"",d.skinning?"#define USE_SKINNING":"",d.morphTargets?"#define USE_MORPHTARGETS":"",d.morphNormals&&d.flatShading===!1?"#define USE_MORPHNORMALS":"",d.morphColors?"#define USE_MORPHCOLORS":"",d.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE":"",d.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+d.morphTextureStride:"",d.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+d.morphTargetsCount:"",d.doubleSided?"#define DOUBLE_SIDED":"",d.flipSided?"#define FLIP_SIDED":"",d.shadowMapEnabled?"#define USE_SHADOWMAP":"",d.shadowMapEnabled?"#define "+P:"",d.sizeAttenuation?"#define USE_SIZEATTENUATION":"",d.numLightProbes>0?"#define USE_LIGHT_PROBES":"",d.useLegacyLights?"#define LEGACY_LIGHTS":"",d.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(bv).join(`
`),ee=[Zj(d),"#define SHADER_TYPE "+d.shaderType,"#define SHADER_NAME "+d.shaderName,te,d.useFog&&d.fog?"#define USE_FOG":"",d.useFog&&d.fogExp2?"#define FOG_EXP2":"",d.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",d.map?"#define USE_MAP":"",d.matcap?"#define USE_MATCAP":"",d.envMap?"#define USE_ENVMAP":"",d.envMap?"#define "+k:"",d.envMap?"#define "+j:"",d.envMap?"#define "+X:"",q?"#define CUBEUV_TEXEL_WIDTH "+q.texelWidth:"",q?"#define CUBEUV_TEXEL_HEIGHT "+q.texelHeight:"",q?"#define CUBEUV_MAX_MIP "+q.maxMip+".0":"",d.lightMap?"#define USE_LIGHTMAP":"",d.aoMap?"#define USE_AOMAP":"",d.bumpMap?"#define USE_BUMPMAP":"",d.normalMap?"#define USE_NORMALMAP":"",d.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",d.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",d.emissiveMap?"#define USE_EMISSIVEMAP":"",d.anisotropy?"#define USE_ANISOTROPY":"",d.anisotropyMap?"#define USE_ANISOTROPYMAP":"",d.clearcoat?"#define USE_CLEARCOAT":"",d.clearcoatMap?"#define USE_CLEARCOATMAP":"",d.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",d.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",d.dispersion?"#define USE_DISPERSION":"",d.iridescence?"#define USE_IRIDESCENCE":"",d.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",d.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",d.specularMap?"#define USE_SPECULARMAP":"",d.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",d.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",d.roughnessMap?"#define USE_ROUGHNESSMAP":"",d.metalnessMap?"#define USE_METALNESSMAP":"",d.alphaMap?"#define USE_ALPHAMAP":"",d.alphaTest?"#define USE_ALPHATEST":"",d.alphaHash?"#define USE_ALPHAHASH":"",d.sheen?"#define USE_SHEEN":"",d.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",d.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",d.transmission?"#define USE_TRANSMISSION":"",d.transmissionMap?"#define USE_TRANSMISSIONMAP":"",d.thicknessMap?"#define USE_THICKNESSMAP":"",d.vertexTangents&&d.flatShading===!1?"#define USE_TANGENT":"",d.vertexColors||d.instancingColor?"#define USE_COLOR":"",d.vertexAlphas?"#define USE_COLOR_ALPHA":"",d.vertexUv1s?"#define USE_UV1":"",d.vertexUv2s?"#define USE_UV2":"",d.vertexUv3s?"#define USE_UV3":"",d.pointsUvs?"#define USE_POINTS_UV":"",d.gradientMap?"#define USE_GRADIENTMAP":"",d.flatShading?"#define FLAT_SHADED":"",d.doubleSided?"#define DOUBLE_SIDED":"",d.flipSided?"#define FLIP_SIDED":"",d.shadowMapEnabled?"#define USE_SHADOWMAP":"",d.shadowMapEnabled?"#define "+P:"",d.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",d.numLightProbes>0?"#define USE_LIGHT_PROBES":"",d.useLegacyLights?"#define LEGACY_LIGHTS":"",d.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",d.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",d.toneMapping!==Ot?"#define TONE_MAPPING":"",d.toneMapping!==Ot?ln.tonemapping_pars_fragment:"",d.toneMapping!==Ot?DTe("toneMapping",d.toneMapping):"",d.dithering?"#define DITHERING":"",d.opaque?"#define OPAQUE":"",ln.colorspace_pars_fragment,LTe("linearToOutputTexel",d.outputColorSpace),d.useDepthPacking?"#define DEPTH_PACKING "+d.depthPacking:"",`
`].filter(bv).join(`
`)),M=fN(M),M=Yj(M,d),M=Kj(M,d),N=fN(N),N=Yj(N,d),N=Kj(N,d),M=Jj(M),N=Jj(N),d.isRawShaderMaterial!==!0&&(Me=`#version 300 es
`,re=[K,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+re,ee=["#define varying in",d.glslVersion===uv?"":"layout(location = 0) out highp vec4 pc_fragColor;",d.glslVersion===uv?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+ee,we>0&&(re=["#extension GL_OVR_multiview : require","layout(num_views = "+we+") in;","#define VIEW_ID gl_ViewID_OVR"].join(`
`)+`
`+re,re=re.replace(["uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;"].join(`
`),["uniform mat4 modelViewMatrices["+we+"];","uniform mat4 projectionMatrices["+we+"];","uniform mat4 viewMatrices["+we+"];","uniform mat3 normalMatrices["+we+"];","#define modelViewMatrix modelViewMatrices[VIEW_ID]","#define projectionMatrix projectionMatrices[VIEW_ID]","#define viewMatrix viewMatrices[VIEW_ID]","#define normalMatrix normalMatrices[VIEW_ID]"].join(`
`)),ee=["#extension GL_OVR_multiview : require","#define VIEW_ID gl_ViewID_OVR"].join(`
`)+`
`+ee,ee=ee.replace("uniform mat4 viewMatrix;",["uniform mat4 viewMatrices["+we+"];","#define viewMatrix viewMatrices[VIEW_ID]"].join(`
`))));const _e=Me+re+M,nt=Me+ee+N,qe=qj(b,b.VERTEX_SHADER,_e),Je=qj(b,b.FRAGMENT_SHADER,nt);b.attachShader(oe,qe),b.attachShader(oe,Je),d.index0AttributeName!==void 0?b.bindAttribLocation(oe,0,d.index0AttributeName):d.morphTargets===!0&&b.bindAttribLocation(oe,0,"position"),b.linkProgram(oe);function it(mt){if(C.debug.checkShaderErrors){const pt=b.getProgramInfoLog(oe).trim(),Tt=b.getShaderInfoLog(qe).trim(),Pt=b.getShaderInfoLog(Je).trim();let hi=!0,Di=!0;if(b.getProgramParameter(oe,b.LINK_STATUS)===!1)if(hi=!1,typeof C.debug.onShaderError=="function")C.debug.onShaderError(b,oe,qe,Je);else{const kt=Xj(b,qe,"vertex"),yi=Xj(b,Je,"fragment");console.error("THREE.WebGLProgram: Shader Error "+b.getError()+" - VALIDATE_STATUS "+b.getProgramParameter(oe,b.VALIDATE_STATUS)+`

Material Name: `+mt.name+`
Material Type: `+mt.type+`

Program Info Log: `+pt+`
`+kt+`
`+yi)}else pt!==""?console.warn("THREE.WebGLProgram: Program Info Log:",pt):(Tt===""||Pt==="")&&(Di=!1);Di&&(mt.diagnostics={runnable:hi,programLog:pt,vertexShader:{log:Tt,prefix:re},fragmentShader:{log:Pt,prefix:ee}})}b.deleteShader(qe),b.deleteShader(Je),ze=new ew(b,oe),Oe=kTe(b,oe)}let ze;this.getUniforms=function(){return ze===void 0&&it(this),ze};let Oe;this.getAttributes=function(){return Oe===void 0&&it(this),Oe};let rt=d.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return rt===!1&&(rt=b.getProgramParameter(oe,RTe)),rt},this.destroy=function(){A.releaseStatesOfProgram(this),b.deleteProgram(oe),this.program=void 0},this.type=d.shaderType,this.name=d.shaderName,this.id=ITe++,this.cacheKey=a,this.usedTimes=1,this.program=oe,this.vertexShader=qe,this.fragmentShader=Je,this.numMultiviewViews=we,this}let YTe=0;class KTe{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(a){const d=a.vertexShader,A=a.fragmentShader,b=this._getShaderStage(d),E=this._getShaderStage(A),M=this._getShaderCacheForMaterial(a);return M.has(b)===!1&&(M.add(b),b.usedTimes++),M.has(E)===!1&&(M.add(E),E.usedTimes++),this}remove(a){const d=this.materialCache.get(a);for(const A of d)A.usedTimes--,A.usedTimes===0&&this.shaderCache.delete(A.code);return this.materialCache.delete(a),this}getVertexShaderID(a){return this._getShaderStage(a.vertexShader).id}getFragmentShaderID(a){return this._getShaderStage(a.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(a){const d=this.materialCache;let A=d.get(a);return A===void 0&&(A=new Set,d.set(a,A)),A}_getShaderStage(a){const d=this.shaderCache;let A=d.get(a);return A===void 0&&(A=new JTe(a),d.set(a,A)),A}}class JTe{constructor(a){this.id=YTe++,this.code=a,this.usedTimes=0}}function ZTe(C,a,d,A,b,E,M){const N=new PE,P=new KTe,k=new Set,j=[],X=b.logarithmicDepthBuffer,q=b.vertexTextures;let K=b.precision;const te={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function oe(ze){return k.add(ze),ze===0?"uv":`uv${ze}`}function re(ze,Oe,rt,mt,pt){const Tt=mt.fog,Pt=pt.geometry,hi=ze.isMeshStandardMaterial?mt.environment:null,Di=(ze.isMeshStandardMaterial?d:a).get(ze.envMap||hi),kt=Di&&Di.mapping===ce?Di.image.height:null,yi=te[ze.type];ze.precision!==null&&(K=b.getMaxPrecision(ze.precision),K!==ze.precision&&console.warn("THREE.WebGLProgram.getParameters:",ze.precision,"not supported, using",K,"instead."));const Oi=Pt.morphAttributes.position||Pt.morphAttributes.normal||Pt.morphAttributes.color,jr=Oi!==void 0?Oi.length:0;let En=0;Pt.morphAttributes.position!==void 0&&(En=1),Pt.morphAttributes.normal!==void 0&&(En=2),Pt.morphAttributes.color!==void 0&&(En=3);let ns,ms,Gn,Dn;if(yi){const Wl=Lc[yi];ns=Wl.vertexShader,ms=Wl.fragmentShader}else ns=ze.vertexShader,ms=ze.fragmentShader,P.update(ze),Gn=P.getVertexShaderID(ze),Dn=P.getFragmentShaderID(ze);const Sr=C.getRenderTarget(),ci=Sr&&Sr.isWebGLMultiviewRenderTarget?Sr.numViews:0,wi=pt.isInstancedMesh===!0,qi=pt.isBatchedMesh===!0,tt=!!ze.map,fi=!!ze.matcap,$t=!!Di,$i=!!ze.aoMap,oi=!!ze.lightMap,tr=!!ze.bumpMap,er=!!ze.normalMap,vr=!!ze.displacementMap,vn=!!ze.emissiveMap,qr=!!ze.metalnessMap,ha=!!ze.roughnessMap,Xs=ze.anisotropy>0,qn=ze.clearcoat>0,et=ze.dispersion>0,De=ze.iridescence>0,Ft=ze.sheen>0,ui=ze.transmission>0,mi=Xs&&!!ze.anisotropyMap,ai=qn&&!!ze.clearcoatMap,Ir=qn&&!!ze.clearcoatNormalMap,zi=qn&&!!ze.clearcoatRoughnessMap,ur=De&&!!ze.iridescenceMap,Xn=De&&!!ze.iridescenceThicknessMap,cr=Ft&&!!ze.sheenColorMap,wr=Ft&&!!ze.sheenRoughnessMap,wn=!!ze.specularMap,Vr=!!ze.specularColorMap,ut=!!ze.specularIntensityMap,vi=ui&&!!ze.transmissionMap,Mi=ui&&!!ze.thicknessMap,Rr=!!ze.gradientMap,nr=!!ze.alphaMap,cn=ze.alphaTest>0,sr=!!ze.alphaHash,Ji=!!ze.extensions;let xn=Ot;ze.toneMapped&&(Sr===null||Sr.isXRRenderTarget===!0)&&(xn=C.toneMapping);const Br={shaderID:yi,shaderType:ze.type,shaderName:ze.name,vertexShader:ns,fragmentShader:ms,defines:ze.defines,customVertexShaderID:Gn,customFragmentShaderID:Dn,isRawShaderMaterial:ze.isRawShaderMaterial===!0,glslVersion:ze.glslVersion,precision:K,batching:qi,instancing:wi,instancingColor:wi&&pt.instanceColor!==null,instancingMorph:wi&&pt.morphTexture!==null,supportsVertexTextures:q,numMultiviewViews:ci,outputColorSpace:Sr===null?C.outputColorSpace:Sr.isXRRenderTarget===!0?Sr.texture.colorSpace:Ic,alphaToCoverage:!!ze.alphaToCoverage,map:tt,matcap:fi,envMap:$t,envMapMode:$t&&Di.mapping,envMapCubeUVHeight:kt,aoMap:$i,lightMap:oi,bumpMap:tr,normalMap:er,displacementMap:q&&vr,emissiveMap:vn,normalMapObjectSpace:er&&ze.normalMapType===tu,normalMapTangentSpace:er&&ze.normalMapType===co,metalnessMap:qr,roughnessMap:ha,anisotropy:Xs,anisotropyMap:mi,clearcoat:qn,clearcoatMap:ai,clearcoatNormalMap:Ir,clearcoatRoughnessMap:zi,dispersion:et,iridescence:De,iridescenceMap:ur,iridescenceThicknessMap:Xn,sheen:Ft,sheenColorMap:cr,sheenRoughnessMap:wr,specularMap:wn,specularColorMap:Vr,specularIntensityMap:ut,transmission:ui,transmissionMap:vi,thicknessMap:Mi,gradientMap:Rr,opaque:ze.transparent===!1&&ze.blending===D&&ze.alphaToCoverage===!1,alphaMap:nr,alphaTest:cn,alphaHash:sr,combine:ze.combine,mapUv:tt&&oe(ze.map.channel),aoMapUv:$i&&oe(ze.aoMap.channel),lightMapUv:oi&&oe(ze.lightMap.channel),bumpMapUv:tr&&oe(ze.bumpMap.channel),normalMapUv:er&&oe(ze.normalMap.channel),displacementMapUv:vr&&oe(ze.displacementMap.channel),emissiveMapUv:vn&&oe(ze.emissiveMap.channel),metalnessMapUv:qr&&oe(ze.metalnessMap.channel),roughnessMapUv:ha&&oe(ze.roughnessMap.channel),anisotropyMapUv:mi&&oe(ze.anisotropyMap.channel),clearcoatMapUv:ai&&oe(ze.clearcoatMap.channel),clearcoatNormalMapUv:Ir&&oe(ze.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:zi&&oe(ze.clearcoatRoughnessMap.channel),iridescenceMapUv:ur&&oe(ze.iridescenceMap.channel),iridescenceThicknessMapUv:Xn&&oe(ze.iridescenceThicknessMap.channel),sheenColorMapUv:cr&&oe(ze.sheenColorMap.channel),sheenRoughnessMapUv:wr&&oe(ze.sheenRoughnessMap.channel),specularMapUv:wn&&oe(ze.specularMap.channel),specularColorMapUv:Vr&&oe(ze.specularColorMap.channel),specularIntensityMapUv:ut&&oe(ze.specularIntensityMap.channel),transmissionMapUv:vi&&oe(ze.transmissionMap.channel),thicknessMapUv:Mi&&oe(ze.thicknessMap.channel),alphaMapUv:nr&&oe(ze.alphaMap.channel),vertexTangents:!!Pt.attributes.tangent&&(er||Xs),vertexColors:ze.vertexColors,vertexAlphas:ze.vertexColors===!0&&!!Pt.attributes.color&&Pt.attributes.color.itemSize===4,pointsUvs:pt.isPoints===!0&&!!Pt.attributes.uv&&(tt||nr),fog:!!Tt,useFog:ze.fog===!0,fogExp2:!!Tt&&Tt.isFogExp2,flatShading:ze.flatShading===!0,sizeAttenuation:ze.sizeAttenuation===!0,logarithmicDepthBuffer:X,skinning:pt.isSkinnedMesh===!0,morphTargets:Pt.morphAttributes.position!==void 0,morphNormals:Pt.morphAttributes.normal!==void 0,morphColors:Pt.morphAttributes.color!==void 0,morphTargetsCount:jr,morphTextureStride:En,numDirLights:Oe.directional.length,numPointLights:Oe.point.length,numSpotLights:Oe.spot.length,numSpotLightMaps:Oe.spotLightMap.length,numRectAreaLights:Oe.rectArea.length,numHemiLights:Oe.hemi.length,numDirLightShadows:Oe.directionalShadowMap.length,numPointLightShadows:Oe.pointShadowMap.length,numSpotLightShadows:Oe.spotShadowMap.length,numSpotLightShadowsWithMaps:Oe.numSpotLightShadowsWithMaps,numLightProbes:Oe.numLightProbes,numClippingPlanes:M.numPlanes,numClipIntersection:M.numIntersection,dithering:ze.dithering,shadowMapEnabled:C.shadowMap.enabled&&rt.length>0,shadowMapType:C.shadowMap.type,toneMapping:xn,useLegacyLights:C._useLegacyLights,decodeVideoTexture:tt&&ze.map.isVideoTexture===!0&&Zn.getTransfer(ze.map.colorSpace)===hs,premultipliedAlpha:ze.premultipliedAlpha,doubleSided:ze.side===B,flipSided:ze.side===R,useDepthPacking:ze.depthPacking>=0,depthPacking:ze.depthPacking||0,index0AttributeName:ze.index0AttributeName,extensionClipCullDistance:Ji&&ze.extensions.clipCullDistance===!0&&A.has("WEBGL_clip_cull_distance"),extensionMultiDraw:Ji&&ze.extensions.multiDraw===!0&&A.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:A.has("KHR_parallel_shader_compile"),customProgramCacheKey:ze.customProgramCacheKey()};return Br.vertexUv1s=k.has(1),Br.vertexUv2s=k.has(2),Br.vertexUv3s=k.has(3),k.clear(),Br}function ee(ze){const Oe=[];if(ze.shaderID?Oe.push(ze.shaderID):(Oe.push(ze.customVertexShaderID),Oe.push(ze.customFragmentShaderID)),ze.defines!==void 0)for(const rt in ze.defines)Oe.push(rt),Oe.push(ze.defines[rt]);return ze.isRawShaderMaterial===!1&&(Me(Oe,ze),we(Oe,ze),Oe.push(C.outputColorSpace)),Oe.push(ze.customProgramCacheKey),Oe.join()}function Me(ze,Oe){ze.push(Oe.precision),ze.push(Oe.outputColorSpace),ze.push(Oe.envMapMode),ze.push(Oe.envMapCubeUVHeight),ze.push(Oe.mapUv),ze.push(Oe.alphaMapUv),ze.push(Oe.lightMapUv),ze.push(Oe.aoMapUv),ze.push(Oe.bumpMapUv),ze.push(Oe.normalMapUv),ze.push(Oe.displacementMapUv),ze.push(Oe.emissiveMapUv),ze.push(Oe.metalnessMapUv),ze.push(Oe.roughnessMapUv),ze.push(Oe.anisotropyMapUv),ze.push(Oe.clearcoatMapUv),ze.push(Oe.clearcoatNormalMapUv),ze.push(Oe.clearcoatRoughnessMapUv),ze.push(Oe.iridescenceMapUv),ze.push(Oe.iridescenceThicknessMapUv),ze.push(Oe.sheenColorMapUv),ze.push(Oe.sheenRoughnessMapUv),ze.push(Oe.specularMapUv),ze.push(Oe.specularColorMapUv),ze.push(Oe.specularIntensityMapUv),ze.push(Oe.transmissionMapUv),ze.push(Oe.thicknessMapUv),ze.push(Oe.combine),ze.push(Oe.fogExp2),ze.push(Oe.sizeAttenuation),ze.push(Oe.morphTargetsCount),ze.push(Oe.morphAttributeCount),ze.push(Oe.numDirLights),ze.push(Oe.numPointLights),ze.push(Oe.numSpotLights),ze.push(Oe.numSpotLightMaps),ze.push(Oe.numHemiLights),ze.push(Oe.numRectAreaLights),ze.push(Oe.numDirLightShadows),ze.push(Oe.numPointLightShadows),ze.push(Oe.numSpotLightShadows),ze.push(Oe.numSpotLightShadowsWithMaps),ze.push(Oe.numLightProbes),ze.push(Oe.shadowMapType),ze.push(Oe.toneMapping),ze.push(Oe.numClippingPlanes),ze.push(Oe.numClipIntersection),ze.push(Oe.depthPacking)}function we(ze,Oe){N.disableAll(),Oe.supportsVertexTextures&&N.enable(0),Oe.instancing&&N.enable(1),Oe.instancingColor&&N.enable(2),Oe.instancingMorph&&N.enable(3),Oe.matcap&&N.enable(4),Oe.envMap&&N.enable(5),Oe.normalMapObjectSpace&&N.enable(6),Oe.normalMapTangentSpace&&N.enable(7),Oe.clearcoat&&N.enable(8),Oe.iridescence&&N.enable(9),Oe.alphaTest&&N.enable(10),Oe.vertexColors&&N.enable(11),Oe.vertexAlphas&&N.enable(12),Oe.vertexUv1s&&N.enable(13),Oe.vertexUv2s&&N.enable(14),Oe.vertexUv3s&&N.enable(15),Oe.vertexTangents&&N.enable(16),Oe.anisotropy&&N.enable(17),Oe.alphaHash&&N.enable(18),Oe.batching&&N.enable(19),Oe.dispersion&&N.enable(20),ze.push(N.mask),N.disableAll(),Oe.fog&&N.enable(0),Oe.useFog&&N.enable(1),Oe.flatShading&&N.enable(2),Oe.logarithmicDepthBuffer&&N.enable(3),Oe.skinning&&N.enable(4),Oe.morphTargets&&N.enable(5),Oe.morphNormals&&N.enable(6),Oe.morphColors&&N.enable(7),Oe.premultipliedAlpha&&N.enable(8),Oe.shadowMapEnabled&&N.enable(9),Oe.useLegacyLights&&N.enable(10),Oe.doubleSided&&N.enable(11),Oe.flipSided&&N.enable(12),Oe.useDepthPacking&&N.enable(13),Oe.dithering&&N.enable(14),Oe.transmission&&N.enable(15),Oe.sheen&&N.enable(16),Oe.opaque&&N.enable(17),Oe.pointsUvs&&N.enable(18),Oe.decodeVideoTexture&&N.enable(19),Oe.alphaToCoverage&&N.enable(20),Oe.numMultiviewViews&&N.enable(21),ze.push(N.mask)}function _e(ze){const Oe=te[ze.type];let rt;if(Oe){const mt=Lc[Oe];rt=Cj.clone(mt.uniforms)}else rt=ze.uniforms;return rt}function nt(ze,Oe){let rt;for(let mt=0,pt=j.length;mt<pt;mt++){const Tt=j[mt];if(Tt.cacheKey===Oe){rt=Tt,++rt.usedTimes;break}}return rt===void 0&&(rt=new XTe(C,Oe,ze,E),j.push(rt)),rt}function qe(ze){if(--ze.usedTimes===0){const Oe=j.indexOf(ze);j[Oe]=j[j.length-1],j.pop(),ze.destroy()}}function Je(ze){P.remove(ze)}function it(){P.dispose()}return{getParameters:re,getProgramCacheKey:ee,getUniforms:_e,acquireProgram:nt,releaseProgram:qe,releaseShaderCache:Je,programs:j,dispose:it}}function $Te(){let C=new WeakMap;function a(E){let M=C.get(E);return M===void 0&&(M={},C.set(E,M)),M}function d(E){C.delete(E)}function A(E,M,N){C.get(E)[M]=N}function b(){C=new WeakMap}return{get:a,remove:d,update:A,dispose:b}}function eMe(C,a){return C.groupOrder!==a.groupOrder?C.groupOrder-a.groupOrder:C.renderOrder!==a.renderOrder?C.renderOrder-a.renderOrder:C.material.id!==a.material.id?C.material.id-a.material.id:C.z!==a.z?C.z-a.z:C.id-a.id}function $j(C,a){return C.groupOrder!==a.groupOrder?C.groupOrder-a.groupOrder:C.renderOrder!==a.renderOrder?C.renderOrder-a.renderOrder:C.z!==a.z?a.z-C.z:C.id-a.id}function eV(){const C=[];let a=0;const d=[],A=[],b=[];function E(){a=0,d.length=0,A.length=0,b.length=0}function M(X,q,K,te,oe,re){let ee=C[a];return ee===void 0?(ee={id:X.id,object:X,geometry:q,material:K,groupOrder:te,renderOrder:X.renderOrder,z:oe,group:re},C[a]=ee):(ee.id=X.id,ee.object=X,ee.geometry=q,ee.material=K,ee.groupOrder=te,ee.renderOrder=X.renderOrder,ee.z=oe,ee.group=re),a++,ee}function N(X,q,K,te,oe,re){const ee=M(X,q,K,te,oe,re);K.transmission>0?A.push(ee):K.transparent===!0?b.push(ee):d.push(ee)}function P(X,q,K,te,oe,re){const ee=M(X,q,K,te,oe,re);K.transmission>0?A.unshift(ee):K.transparent===!0?b.unshift(ee):d.unshift(ee)}function k(X,q){d.length>1&&d.sort(X||eMe),A.length>1&&A.sort(q||$j),b.length>1&&b.sort(q||$j)}function j(){for(let X=a,q=C.length;X<q;X++){const K=C[X];if(K.id===null)break;K.id=null,K.object=null,K.geometry=null,K.material=null,K.group=null}}return{opaque:d,transmissive:A,transparent:b,init:E,push:N,unshift:P,finish:j,sort:k}}function tMe(){let C=new WeakMap;function a(A,b){const E=C.get(A);let M;return E===void 0?(M=new eV,C.set(A,[M])):b>=E.length?(M=new eV,E.push(M)):M=E[b],M}function d(){C=new WeakMap}return{get:a,dispose:d}}function iMe(){const C={};return{get:function(a){if(C[a.id]!==void 0)return C[a.id];let d;switch(a.type){case"DirectionalLight":d={direction:new He,color:new lr};break;case"SpotLight":d={position:new He,direction:new He,color:new lr,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":d={position:new He,color:new lr,distance:0,decay:0};break;case"HemisphereLight":d={direction:new He,skyColor:new lr,groundColor:new lr};break;case"RectAreaLight":d={color:new lr,position:new He,halfWidth:new He,halfHeight:new He};break}return C[a.id]=d,d}}}function rMe(){const C={};return{get:function(a){if(C[a.id]!==void 0)return C[a.id];let d;switch(a.type){case"DirectionalLight":d={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new si};break;case"SpotLight":d={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new si};break;case"PointLight":d={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new si,shadowCameraNear:1,shadowCameraFar:1e3};break}return C[a.id]=d,d}}}let nMe=0;function sMe(C,a){return(a.castShadow?2:0)-(C.castShadow?2:0)+(a.map?1:0)-(C.map?1:0)}function aMe(C){const a=new iMe,d=rMe(),A={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let k=0;k<9;k++)A.probe.push(new He);const b=new He,E=new mr,M=new mr;function N(k,j){let X=0,q=0,K=0;for(let rt=0;rt<9;rt++)A.probe[rt].set(0,0,0);let te=0,oe=0,re=0,ee=0,Me=0,we=0,_e=0,nt=0,qe=0,Je=0,it=0;k.sort(sMe);const ze=j===!0?Math.PI:1;for(let rt=0,mt=k.length;rt<mt;rt++){const pt=k[rt],Tt=pt.color,Pt=pt.intensity,hi=pt.distance,Di=pt.shadow&&pt.shadow.map?pt.shadow.map.texture:null;if(pt.isAmbientLight)X+=Tt.r*Pt*ze,q+=Tt.g*Pt*ze,K+=Tt.b*Pt*ze;else if(pt.isLightProbe){for(let kt=0;kt<9;kt++)A.probe[kt].addScaledVector(pt.sh.coefficients[kt],Pt);it++}else if(pt.isDirectionalLight){const kt=a.get(pt);if(kt.color.copy(pt.color).multiplyScalar(pt.intensity*ze),pt.castShadow){const yi=pt.shadow,Oi=d.get(pt);Oi.shadowBias=yi.bias,Oi.shadowNormalBias=yi.normalBias,Oi.shadowRadius=yi.radius,Oi.shadowMapSize=yi.mapSize,A.directionalShadow[te]=Oi,A.directionalShadowMap[te]=Di,A.directionalShadowMatrix[te]=pt.shadow.matrix,we++}A.directional[te]=kt,te++}else if(pt.isSpotLight){const kt=a.get(pt);kt.position.setFromMatrixPosition(pt.matrixWorld),kt.color.copy(Tt).multiplyScalar(Pt*ze),kt.distance=hi,kt.coneCos=Math.cos(pt.angle),kt.penumbraCos=Math.cos(pt.angle*(1-pt.penumbra)),kt.decay=pt.decay,A.spot[re]=kt;const yi=pt.shadow;if(pt.map&&(A.spotLightMap[qe]=pt.map,qe++,yi.updateMatrices(pt),pt.castShadow&&Je++),A.spotLightMatrix[re]=yi.matrix,pt.castShadow){const Oi=d.get(pt);Oi.shadowBias=yi.bias,Oi.shadowNormalBias=yi.normalBias,Oi.shadowRadius=yi.radius,Oi.shadowMapSize=yi.mapSize,A.spotShadow[re]=Oi,A.spotShadowMap[re]=Di,nt++}re++}else if(pt.isRectAreaLight){const kt=a.get(pt);kt.color.copy(Tt).multiplyScalar(Pt),kt.halfWidth.set(pt.width*.5,0,0),kt.halfHeight.set(0,pt.height*.5,0),A.rectArea[ee]=kt,ee++}else if(pt.isPointLight){const kt=a.get(pt);if(kt.color.copy(pt.color).multiplyScalar(pt.intensity*ze),kt.distance=pt.distance,kt.decay=pt.decay,pt.castShadow){const yi=pt.shadow,Oi=d.get(pt);Oi.shadowBias=yi.bias,Oi.shadowNormalBias=yi.normalBias,Oi.shadowRadius=yi.radius,Oi.shadowMapSize=yi.mapSize,Oi.shadowCameraNear=yi.camera.near,Oi.shadowCameraFar=yi.camera.far,A.pointShadow[oe]=Oi,A.pointShadowMap[oe]=Di,A.pointShadowMatrix[oe]=pt.shadow.matrix,_e++}A.point[oe]=kt,oe++}else if(pt.isHemisphereLight){const kt=a.get(pt);kt.skyColor.copy(pt.color).multiplyScalar(Pt*ze),kt.groundColor.copy(pt.groundColor).multiplyScalar(Pt*ze),A.hemi[Me]=kt,Me++}}ee>0&&(C.has("OES_texture_float_linear")===!0?(A.rectAreaLTC1=Qi.LTC_FLOAT_1,A.rectAreaLTC2=Qi.LTC_FLOAT_2):(A.rectAreaLTC1=Qi.LTC_HALF_1,A.rectAreaLTC2=Qi.LTC_HALF_2)),A.ambient[0]=X,A.ambient[1]=q,A.ambient[2]=K;const Oe=A.hash;(Oe.directionalLength!==te||Oe.pointLength!==oe||Oe.spotLength!==re||Oe.rectAreaLength!==ee||Oe.hemiLength!==Me||Oe.numDirectionalShadows!==we||Oe.numPointShadows!==_e||Oe.numSpotShadows!==nt||Oe.numSpotMaps!==qe||Oe.numLightProbes!==it)&&(A.directional.length=te,A.spot.length=re,A.rectArea.length=ee,A.point.length=oe,A.hemi.length=Me,A.directionalShadow.length=we,A.directionalShadowMap.length=we,A.pointShadow.length=_e,A.pointShadowMap.length=_e,A.spotShadow.length=nt,A.spotShadowMap.length=nt,A.directionalShadowMatrix.length=we,A.pointShadowMatrix.length=_e,A.spotLightMatrix.length=nt+qe-Je,A.spotLightMap.length=qe,A.numSpotLightShadowsWithMaps=Je,A.numLightProbes=it,Oe.directionalLength=te,Oe.pointLength=oe,Oe.spotLength=re,Oe.rectAreaLength=ee,Oe.hemiLength=Me,Oe.numDirectionalShadows=we,Oe.numPointShadows=_e,Oe.numSpotShadows=nt,Oe.numSpotMaps=qe,Oe.numLightProbes=it,A.version=nMe++)}function P(k,j){let X=0,q=0,K=0,te=0,oe=0;const re=j.matrixWorldInverse;for(let ee=0,Me=k.length;ee<Me;ee++){const we=k[ee];if(we.isDirectionalLight){const _e=A.directional[X];_e.direction.setFromMatrixPosition(we.matrixWorld),b.setFromMatrixPosition(we.target.matrixWorld),_e.direction.sub(b),_e.direction.transformDirection(re),X++}else if(we.isSpotLight){const _e=A.spot[K];_e.position.setFromMatrixPosition(we.matrixWorld),_e.position.applyMatrix4(re),_e.direction.setFromMatrixPosition(we.matrixWorld),b.setFromMatrixPosition(we.target.matrixWorld),_e.direction.sub(b),_e.direction.transformDirection(re),K++}else if(we.isRectAreaLight){const _e=A.rectArea[te];_e.position.setFromMatrixPosition(we.matrixWorld),_e.position.applyMatrix4(re),M.identity(),E.copy(we.matrixWorld),E.premultiply(re),M.extractRotation(E),_e.halfWidth.set(we.width*.5,0,0),_e.halfHeight.set(0,we.height*.5,0),_e.halfWidth.applyMatrix4(M),_e.halfHeight.applyMatrix4(M),te++}else if(we.isPointLight){const _e=A.point[q];_e.position.setFromMatrixPosition(we.matrixWorld),_e.position.applyMatrix4(re),q++}else if(we.isHemisphereLight){const _e=A.hemi[oe];_e.direction.setFromMatrixPosition(we.matrixWorld),_e.direction.transformDirection(re),oe++}}}return{setup:N,setupView:P,state:A}}function tV(C){const a=new aMe(C),d=[],A=[];function b(j){k.camera=j,d.length=0,A.length=0}function E(j){d.push(j)}function M(j){A.push(j)}function N(j){a.setup(d,j)}function P(j){a.setupView(d,j)}const k={lightsArray:d,shadowsArray:A,camera:null,lights:a,transmissionRenderTarget:{}};return{init:b,state:k,setupLights:N,setupLightsView:P,pushLight:E,pushShadow:M}}function oMe(C){let a=new WeakMap;function d(b,E=0){const M=a.get(b);let N;return M===void 0?(N=new tV(C),a.set(b,[N])):E>=M.length?(N=new tV(C),M.push(N)):N=M[E],N}function A(){a=new WeakMap}return{get:d,dispose:A}}class mN extends po{constructor(a){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=$c,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(a)}copy(a){return super.copy(a),this.depthPacking=a.depthPacking,this.map=a.map,this.alphaMap=a.alphaMap,this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this}}class gN extends po{constructor(a){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(a)}copy(a){return super.copy(a),this.map=a.map,this.alphaMap=a.alphaMap,this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this}}const lMe=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,cMe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function uMe(C,a,d){let A=new xv;const b=new si,E=new si,M=new jn,N=new mN({depthPacking:eu}),P=new gN,k={},j=d.maxTextureSize,X={[S]:R,[R]:S,[B]:B},q=new Nc({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new si},radius:{value:4}},vertexShader:lMe,fragmentShader:cMe}),K=q.clone();K.defines.HORIZONTAL_PASS=1;const te=new fn;te.setAttribute("position",new ls(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const oe=new ua(te,q),re=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=_;let ee=this.type;this.render=function(qe,Je,it){if(re.enabled===!1||re.autoUpdate===!1&&re.needsUpdate===!1||qe.length===0)return;const ze=C.getRenderTarget(),Oe=C.getActiveCubeFace(),rt=C.getActiveMipmapLevel(),mt=C.state;mt.setBlending(I),mt.buffers.color.setClear(1,1,1,1),mt.buffers.depth.setTest(!0),mt.setScissorTest(!1);const pt=ee!==w&&this.type===w,Tt=ee===w&&this.type!==w;for(let Pt=0,hi=qe.length;Pt<hi;Pt++){const Di=qe[Pt],kt=Di.shadow;if(kt===void 0){console.warn("THREE.WebGLShadowMap:",Di,"has no shadow.");continue}if(kt.autoUpdate===!1&&kt.needsUpdate===!1)continue;b.copy(kt.mapSize);const yi=kt.getFrameExtents();if(b.multiply(yi),E.copy(kt.mapSize),(b.x>j||b.y>j)&&(b.x>j&&(E.x=Math.floor(j/yi.x),b.x=E.x*yi.x,kt.mapSize.x=E.x),b.y>j&&(E.y=Math.floor(j/yi.y),b.y=E.y*yi.y,kt.mapSize.y=E.y)),kt.map===null||pt===!0||Tt===!0){const jr=this.type!==w?{minFilter:It,magFilter:It}:{};kt.map!==null&&kt.map.dispose(),kt.map=new el(b.x,b.y,jr),kt.map.texture.name=Di.name+".shadowMap",kt.camera.updateProjectionMatrix()}C.setRenderTarget(kt.map),C.clear();const Oi=kt.getViewportCount();for(let jr=0;jr<Oi;jr++){const En=kt.getViewport(jr);M.set(E.x*En.x,E.y*En.y,E.x*En.z,E.y*En.w),mt.viewport(M),kt.updateMatrices(Di,jr),A=kt.getFrustum(),_e(Je,it,kt.camera,Di,this.type)}kt.isPointLightShadow!==!0&&this.type===w&&Me(kt,it),kt.needsUpdate=!1}ee=this.type,re.needsUpdate=!1,C.setRenderTarget(ze,Oe,rt)};function Me(qe,Je){const it=a.update(oe);q.defines.VSM_SAMPLES!==qe.blurSamples&&(q.defines.VSM_SAMPLES=qe.blurSamples,K.defines.VSM_SAMPLES=qe.blurSamples,q.needsUpdate=!0,K.needsUpdate=!0),qe.mapPass===null&&(qe.mapPass=new el(b.x,b.y)),q.uniforms.shadow_pass.value=qe.map.texture,q.uniforms.resolution.value=qe.mapSize,q.uniforms.radius.value=qe.radius,C.setRenderTarget(qe.mapPass),C.clear(),C.renderBufferDirect(Je,null,it,q,oe,null),K.uniforms.shadow_pass.value=qe.mapPass.texture,K.uniforms.resolution.value=qe.mapSize,K.uniforms.radius.value=qe.radius,C.setRenderTarget(qe.map),C.clear(),C.renderBufferDirect(Je,null,it,K,oe,null)}function we(qe,Je,it,ze){let Oe=null;const rt=it.isPointLight===!0?qe.customDistanceMaterial:qe.customDepthMaterial;if(rt!==void 0)Oe=rt;else if(Oe=it.isPointLight===!0?P:N,C.localClippingEnabled&&Je.clipShadows===!0&&Array.isArray(Je.clippingPlanes)&&Je.clippingPlanes.length!==0||Je.displacementMap&&Je.displacementScale!==0||Je.alphaMap&&Je.alphaTest>0||Je.map&&Je.alphaTest>0){const mt=Oe.uuid,pt=Je.uuid;let Tt=k[mt];Tt===void 0&&(Tt={},k[mt]=Tt);let Pt=Tt[pt];Pt===void 0&&(Pt=Oe.clone(),Tt[pt]=Pt,Je.addEventListener("dispose",nt)),Oe=Pt}if(Oe.visible=Je.visible,Oe.wireframe=Je.wireframe,ze===w?Oe.side=Je.shadowSide!==null?Je.shadowSide:Je.side:Oe.side=Je.shadowSide!==null?Je.shadowSide:X[Je.side],Oe.alphaMap=Je.alphaMap,Oe.alphaTest=Je.alphaTest,Oe.map=Je.map,Oe.clipShadows=Je.clipShadows,Oe.clippingPlanes=Je.clippingPlanes,Oe.clipIntersection=Je.clipIntersection,Oe.displacementMap=Je.displacementMap,Oe.displacementScale=Je.displacementScale,Oe.displacementBias=Je.displacementBias,Oe.wireframeLinewidth=Je.wireframeLinewidth,Oe.linewidth=Je.linewidth,it.isPointLight===!0&&Oe.isMeshDistanceMaterial===!0){const mt=C.properties.get(Oe);mt.light=it}return Oe}function _e(qe,Je,it,ze,Oe){if(qe.visible===!1)return;if(qe.layers.test(Je.layers)&&(qe.isMesh||qe.isLine||qe.isPoints)&&(qe.castShadow||qe.receiveShadow&&Oe===w)&&(!qe.frustumCulled||A.intersectsObject(qe))){qe.modelViewMatrix.multiplyMatrices(it.matrixWorldInverse,qe.matrixWorld);const mt=a.update(qe),pt=qe.material;if(Array.isArray(pt)){const Tt=mt.groups;for(let Pt=0,hi=Tt.length;Pt<hi;Pt++){const Di=Tt[Pt],kt=pt[Di.materialIndex];if(kt&&kt.visible){const yi=we(qe,kt,ze,Oe);qe.onBeforeShadow(C,qe,Je,it,mt,yi,Di),C.renderBufferDirect(it,null,mt,yi,qe,Di),qe.onAfterShadow(C,qe,Je,it,mt,yi,Di)}}}else if(pt.visible){const Tt=we(qe,pt,ze,Oe);qe.onBeforeShadow(C,qe,Je,it,mt,Tt,null),C.renderBufferDirect(it,null,mt,Tt,qe,null),qe.onAfterShadow(C,qe,Je,it,mt,Tt,null)}}const rt=qe.children;for(let mt=0,pt=rt.length;mt<pt;mt++)_e(rt[mt],Je,it,ze,Oe)}function nt(qe){qe.target.removeEventListener("dispose",nt);for(const Je in k){const it=k[Je],ze=qe.target.uuid;ze in it&&(it[ze].dispose(),delete it[ze])}}}function hMe(C){function a(){let ut=!1;const vi=new jn;let Mi=null;const Rr=new jn(0,0,0,0);return{setMask:function(nr){Mi!==nr&&!ut&&(C.colorMask(nr,nr,nr,nr),Mi=nr)},setLocked:function(nr){ut=nr},setClear:function(nr,cn,sr,Ji,xn){xn===!0&&(nr*=Ji,cn*=Ji,sr*=Ji),vi.set(nr,cn,sr,Ji),Rr.equals(vi)===!1&&(C.clearColor(nr,cn,sr,Ji),Rr.copy(vi))},reset:function(){ut=!1,Mi=null,Rr.set(-1,0,0,0)}}}function d(){let ut=!1,vi=null,Mi=null,Rr=null;return{setTest:function(nr){nr?Dn(C.DEPTH_TEST):Sr(C.DEPTH_TEST)},setMask:function(nr){vi!==nr&&!ut&&(C.depthMask(nr),vi=nr)},setFunc:function(nr){if(Mi!==nr){switch(nr){case xi:C.depthFunc(C.NEVER);break;case Ze:C.depthFunc(C.ALWAYS);break;case Ui:C.depthFunc(C.LESS);break;case di:C.depthFunc(C.LEQUAL);break;case Ii:C.depthFunc(C.EQUAL);break;case Ti:C.depthFunc(C.GEQUAL);break;case ir:C.depthFunc(C.GREATER);break;case Gi:C.depthFunc(C.NOTEQUAL);break;default:C.depthFunc(C.LEQUAL)}Mi=nr}},setLocked:function(nr){ut=nr},setClear:function(nr){Rr!==nr&&(C.clearDepth(nr),Rr=nr)},reset:function(){ut=!1,vi=null,Mi=null,Rr=null}}}function A(){let ut=!1,vi=null,Mi=null,Rr=null,nr=null,cn=null,sr=null,Ji=null,xn=null;return{setTest:function(Br){ut||(Br?Dn(C.STENCIL_TEST):Sr(C.STENCIL_TEST))},setMask:function(Br){vi!==Br&&!ut&&(C.stencilMask(Br),vi=Br)},setFunc:function(Br,Wl,au){(Mi!==Br||Rr!==Wl||nr!==au)&&(C.stencilFunc(Br,Wl,au),Mi=Br,Rr=Wl,nr=au)},setOp:function(Br,Wl,au){(cn!==Br||sr!==Wl||Ji!==au)&&(C.stencilOp(Br,Wl,au),cn=Br,sr=Wl,Ji=au)},setLocked:function(Br){ut=Br},setClear:function(Br){xn!==Br&&(C.clearStencil(Br),xn=Br)},reset:function(){ut=!1,vi=null,Mi=null,Rr=null,nr=null,cn=null,sr=null,Ji=null,xn=null}}}const b=new a,E=new d,M=new A,N=new WeakMap,P=new WeakMap;let k={},j={},X=new WeakMap,q=[],K=null,te=!1,oe=null,re=null,ee=null,Me=null,we=null,_e=null,nt=null,qe=new lr(0,0,0),Je=0,it=!1,ze=null,Oe=null,rt=null,mt=null,pt=null;const Tt=C.getParameter(C.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Pt=!1,hi=0;const Di=C.getParameter(C.VERSION);Di.indexOf("WebGL")!==-1?(hi=parseFloat(/^WebGL (\d)/.exec(Di)[1]),Pt=hi>=1):Di.indexOf("OpenGL ES")!==-1&&(hi=parseFloat(/^OpenGL ES (\d)/.exec(Di)[1]),Pt=hi>=2);let kt=null,yi={};const Oi=C.getParameter(C.SCISSOR_BOX),jr=C.getParameter(C.VIEWPORT),En=new jn().fromArray(Oi),ns=new jn().fromArray(jr);function ms(ut,vi,Mi,Rr){const nr=new Uint8Array(4),cn=C.createTexture();C.bindTexture(ut,cn),C.texParameteri(ut,C.TEXTURE_MIN_FILTER,C.NEAREST),C.texParameteri(ut,C.TEXTURE_MAG_FILTER,C.NEAREST);for(let sr=0;sr<Mi;sr++)ut===C.TEXTURE_3D||ut===C.TEXTURE_2D_ARRAY?C.texImage3D(vi,0,C.RGBA,1,1,Rr,0,C.RGBA,C.UNSIGNED_BYTE,nr):C.texImage2D(vi+sr,0,C.RGBA,1,1,0,C.RGBA,C.UNSIGNED_BYTE,nr);return cn}const Gn={};Gn[C.TEXTURE_2D]=ms(C.TEXTURE_2D,C.TEXTURE_2D,1),Gn[C.TEXTURE_CUBE_MAP]=ms(C.TEXTURE_CUBE_MAP,C.TEXTURE_CUBE_MAP_POSITIVE_X,6),Gn[C.TEXTURE_2D_ARRAY]=ms(C.TEXTURE_2D_ARRAY,C.TEXTURE_2D_ARRAY,1,1),Gn[C.TEXTURE_3D]=ms(C.TEXTURE_3D,C.TEXTURE_3D,1,1),b.setClear(0,0,0,1),E.setClear(1),M.setClear(0),Dn(C.DEPTH_TEST),E.setFunc(di),oi(!1),tr(g),Dn(C.CULL_FACE),$t(I);function Dn(ut){k[ut]!==!0&&(C.enable(ut),k[ut]=!0)}function Sr(ut){k[ut]!==!1&&(C.disable(ut),k[ut]=!1)}function ci(ut,vi){return j[ut]!==vi?(C.bindFramebuffer(ut,vi),j[ut]=vi,ut===C.DRAW_FRAMEBUFFER&&(j[C.FRAMEBUFFER]=vi),ut===C.FRAMEBUFFER&&(j[C.DRAW_FRAMEBUFFER]=vi),!0):!1}function wi(ut,vi){let Mi=q,Rr=!1;if(ut){Mi=X.get(vi),Mi===void 0&&(Mi=[],X.set(vi,Mi));const nr=ut.textures;if(Mi.length!==nr.length||Mi[0]!==C.COLOR_ATTACHMENT0){for(let cn=0,sr=nr.length;cn<sr;cn++)Mi[cn]=C.COLOR_ATTACHMENT0+cn;Mi.length=nr.length,Rr=!0}}else Mi[0]!==C.BACK&&(Mi[0]=C.BACK,Rr=!0);Rr&&C.drawBuffers(Mi)}function qi(ut){return K!==ut?(C.useProgram(ut),K=ut,!0):!1}const tt={[G]:C.FUNC_ADD,[z]:C.FUNC_SUBTRACT,[$]:C.FUNC_REVERSE_SUBTRACT};tt[Q]=C.MIN,tt[H]=C.MAX;const fi={[V]:C.ZERO,[ne]:C.ONE,[Y]:C.SRC_COLOR,[xe]:C.SRC_ALPHA,[$e]:C.SRC_ALPHA_SATURATE,[Ge]:C.DST_COLOR,[de]:C.DST_ALPHA,[ae]:C.ONE_MINUS_SRC_COLOR,[fe]:C.ONE_MINUS_SRC_ALPHA,[Xe]:C.ONE_MINUS_DST_COLOR,[Ie]:C.ONE_MINUS_DST_ALPHA,[lt]:C.CONSTANT_COLOR,[At]:C.ONE_MINUS_CONSTANT_COLOR,[Gt]:C.CONSTANT_ALPHA,[gt]:C.ONE_MINUS_CONSTANT_ALPHA};function $t(ut,vi,Mi,Rr,nr,cn,sr,Ji,xn,Br){if(ut===I){te===!0&&(Sr(C.BLEND),te=!1);return}if(te===!1&&(Dn(C.BLEND),te=!0),ut!==Z){if(ut!==oe||Br!==it){if((re!==G||we!==G)&&(C.blendEquation(C.FUNC_ADD),re=G,we=G),Br)switch(ut){case D:C.blendFuncSeparate(C.ONE,C.ONE_MINUS_SRC_ALPHA,C.ONE,C.ONE_MINUS_SRC_ALPHA);break;case L:C.blendFunc(C.ONE,C.ONE);break;case O:C.blendFuncSeparate(C.ZERO,C.ONE_MINUS_SRC_COLOR,C.ZERO,C.ONE);break;case U:C.blendFuncSeparate(C.ZERO,C.SRC_COLOR,C.ZERO,C.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",ut);break}else switch(ut){case D:C.blendFuncSeparate(C.SRC_ALPHA,C.ONE_MINUS_SRC_ALPHA,C.ONE,C.ONE_MINUS_SRC_ALPHA);break;case L:C.blendFunc(C.SRC_ALPHA,C.ONE);break;case O:C.blendFuncSeparate(C.ZERO,C.ONE_MINUS_SRC_COLOR,C.ZERO,C.ONE);break;case U:C.blendFunc(C.ZERO,C.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",ut);break}ee=null,Me=null,_e=null,nt=null,qe.set(0,0,0),Je=0,oe=ut,it=Br}return}nr=nr||vi,cn=cn||Mi,sr=sr||Rr,(vi!==re||nr!==we)&&(C.blendEquationSeparate(tt[vi],tt[nr]),re=vi,we=nr),(Mi!==ee||Rr!==Me||cn!==_e||sr!==nt)&&(C.blendFuncSeparate(fi[Mi],fi[Rr],fi[cn],fi[sr]),ee=Mi,Me=Rr,_e=cn,nt=sr),(Ji.equals(qe)===!1||xn!==Je)&&(C.blendColor(Ji.r,Ji.g,Ji.b,xn),qe.copy(Ji),Je=xn),oe=ut,it=!1}function $i(ut,vi){ut.side===B?Sr(C.CULL_FACE):Dn(C.CULL_FACE);let Mi=ut.side===R;vi&&(Mi=!Mi),oi(Mi),ut.blending===D&&ut.transparent===!1?$t(I):$t(ut.blending,ut.blendEquation,ut.blendSrc,ut.blendDst,ut.blendEquationAlpha,ut.blendSrcAlpha,ut.blendDstAlpha,ut.blendColor,ut.blendAlpha,ut.premultipliedAlpha),E.setFunc(ut.depthFunc),E.setTest(ut.depthTest),E.setMask(ut.depthWrite),b.setMask(ut.colorWrite);const Rr=ut.stencilWrite;M.setTest(Rr),Rr&&(M.setMask(ut.stencilWriteMask),M.setFunc(ut.stencilFunc,ut.stencilRef,ut.stencilFuncMask),M.setOp(ut.stencilFail,ut.stencilZFail,ut.stencilZPass)),vr(ut.polygonOffset,ut.polygonOffsetFactor,ut.polygonOffsetUnits),ut.alphaToCoverage===!0?Dn(C.SAMPLE_ALPHA_TO_COVERAGE):Sr(C.SAMPLE_ALPHA_TO_COVERAGE)}function oi(ut){ze!==ut&&(ut?C.frontFace(C.CW):C.frontFace(C.CCW),ze=ut)}function tr(ut){ut!==m?(Dn(C.CULL_FACE),ut!==Oe&&(ut===g?C.cullFace(C.BACK):ut===y?C.cullFace(C.FRONT):C.cullFace(C.FRONT_AND_BACK))):Sr(C.CULL_FACE),Oe=ut}function er(ut){ut!==rt&&(Pt&&C.lineWidth(ut),rt=ut)}function vr(ut,vi,Mi){ut?(Dn(C.POLYGON_OFFSET_FILL),(mt!==vi||pt!==Mi)&&(C.polygonOffset(vi,Mi),mt=vi,pt=Mi)):Sr(C.POLYGON_OFFSET_FILL)}function vn(ut){ut?Dn(C.SCISSOR_TEST):Sr(C.SCISSOR_TEST)}function qr(ut){ut===void 0&&(ut=C.TEXTURE0+Tt-1),kt!==ut&&(C.activeTexture(ut),kt=ut)}function ha(ut,vi,Mi){Mi===void 0&&(kt===null?Mi=C.TEXTURE0+Tt-1:Mi=kt);let Rr=yi[Mi];Rr===void 0&&(Rr={type:void 0,texture:void 0},yi[Mi]=Rr),(Rr.type!==ut||Rr.texture!==vi)&&(kt!==Mi&&(C.activeTexture(Mi),kt=Mi),C.bindTexture(ut,vi||Gn[ut]),Rr.type=ut,Rr.texture=vi)}function Xs(){const ut=yi[kt];ut!==void 0&&ut.type!==void 0&&(C.bindTexture(ut.type,null),ut.type=void 0,ut.texture=void 0)}function qn(){try{C.compressedTexImage2D.apply(C,arguments)}catch(ut){console.error("THREE.WebGLState:",ut)}}function et(){try{C.compressedTexImage3D.apply(C,arguments)}catch(ut){console.error("THREE.WebGLState:",ut)}}function De(){try{C.texSubImage2D.apply(C,arguments)}catch(ut){console.error("THREE.WebGLState:",ut)}}function Ft(){try{C.texSubImage3D.apply(C,arguments)}catch(ut){console.error("THREE.WebGLState:",ut)}}function ui(){try{C.compressedTexSubImage2D.apply(C,arguments)}catch(ut){console.error("THREE.WebGLState:",ut)}}function mi(){try{C.compressedTexSubImage3D.apply(C,arguments)}catch(ut){console.error("THREE.WebGLState:",ut)}}function ai(){try{C.texStorage2D.apply(C,arguments)}catch(ut){console.error("THREE.WebGLState:",ut)}}function Ir(){try{C.texStorage3D.apply(C,arguments)}catch(ut){console.error("THREE.WebGLState:",ut)}}function zi(){try{C.texImage2D.apply(C,arguments)}catch(ut){console.error("THREE.WebGLState:",ut)}}function ur(){try{C.texImage3D.apply(C,arguments)}catch(ut){console.error("THREE.WebGLState:",ut)}}function Xn(ut){En.equals(ut)===!1&&(C.scissor(ut.x,ut.y,ut.z,ut.w),En.copy(ut))}function cr(ut){ns.equals(ut)===!1&&(C.viewport(ut.x,ut.y,ut.z,ut.w),ns.copy(ut))}function wr(ut,vi){let Mi=P.get(vi);Mi===void 0&&(Mi=new WeakMap,P.set(vi,Mi));let Rr=Mi.get(ut);Rr===void 0&&(Rr=C.getUniformBlockIndex(vi,ut.name),Mi.set(ut,Rr))}function wn(ut,vi){const Mi=P.get(vi).get(ut);N.get(vi)!==Mi&&(C.uniformBlockBinding(vi,Mi,ut.__bindingPointIndex),N.set(vi,Mi))}function Vr(){C.disable(C.BLEND),C.disable(C.CULL_FACE),C.disable(C.DEPTH_TEST),C.disable(C.POLYGON_OFFSET_FILL),C.disable(C.SCISSOR_TEST),C.disable(C.STENCIL_TEST),C.disable(C.SAMPLE_ALPHA_TO_COVERAGE),C.blendEquation(C.FUNC_ADD),C.blendFunc(C.ONE,C.ZERO),C.blendFuncSeparate(C.ONE,C.ZERO,C.ONE,C.ZERO),C.blendColor(0,0,0,0),C.colorMask(!0,!0,!0,!0),C.clearColor(0,0,0,0),C.depthMask(!0),C.depthFunc(C.LESS),C.clearDepth(1),C.stencilMask(4294967295),C.stencilFunc(C.ALWAYS,0,4294967295),C.stencilOp(C.KEEP,C.KEEP,C.KEEP),C.clearStencil(0),C.cullFace(C.BACK),C.frontFace(C.CCW),C.polygonOffset(0,0),C.activeTexture(C.TEXTURE0),C.bindFramebuffer(C.FRAMEBUFFER,null),C.bindFramebuffer(C.DRAW_FRAMEBUFFER,null),C.bindFramebuffer(C.READ_FRAMEBUFFER,null),C.useProgram(null),C.lineWidth(1),C.scissor(0,0,C.canvas.width,C.canvas.height),C.viewport(0,0,C.canvas.width,C.canvas.height),k={},kt=null,yi={},j={},X=new WeakMap,q=[],K=null,te=!1,oe=null,re=null,ee=null,Me=null,we=null,_e=null,nt=null,qe=new lr(0,0,0),Je=0,it=!1,ze=null,Oe=null,rt=null,mt=null,pt=null,En.set(0,0,C.canvas.width,C.canvas.height),ns.set(0,0,C.canvas.width,C.canvas.height),b.reset(),E.reset(),M.reset()}return{buffers:{color:b,depth:E,stencil:M},enable:Dn,disable:Sr,bindFramebuffer:ci,drawBuffers:wi,useProgram:qi,setBlending:$t,setMaterial:$i,setFlipSided:oi,setCullFace:tr,setLineWidth:er,setPolygonOffset:vr,setScissorTest:vn,activeTexture:qr,bindTexture:ha,unbindTexture:Xs,compressedTexImage2D:qn,compressedTexImage3D:et,texImage2D:zi,texImage3D:ur,updateUBOMapping:wr,uniformBlockBinding:wn,texStorage2D:ai,texStorage3D:Ir,texSubImage2D:De,texSubImage3D:Ft,compressedTexSubImage2D:ui,compressedTexSubImage3D:mi,scissor:Xn,viewport:cr,reset:Vr}}function dMe(C,a,d,A,b,E,M){const N=a.has("WEBGL_multisampled_render_to_texture")?a.get("WEBGL_multisampled_render_to_texture"):null,P=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),k=a.has("OCULUS_multiview")?a.get("OCULUS_multiview"):null,j=new si,X=new WeakMap;let q;const K=new WeakMap;let te=[],oe=!1,re=!1;try{re=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function ee(et,De){return re?new OffscreenCanvas(et,De):pf("canvas")}function Me(et,De,Ft){let ui=1;const mi=qn(et);if((mi.width>Ft||mi.height>Ft)&&(ui=Ft/Math.max(mi.width,mi.height)),ui<1)if(typeof HTMLImageElement<"u"&&et instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&et instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&et instanceof ImageBitmap||typeof VideoFrame<"u"&&et instanceof VideoFrame){const ai=Math.floor(ui*mi.width),Ir=Math.floor(ui*mi.height);q===void 0&&(q=ee(ai,Ir));const zi=De?ee(ai,Ir):q;return zi.width=ai,zi.height=Ir,zi.getContext("2d").drawImage(et,0,0,ai,Ir),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+mi.width+"x"+mi.height+") to ("+ai+"x"+Ir+")."),zi}else return"data"in et&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+mi.width+"x"+mi.height+")."),et;return et}function we(et){return et.generateMipmaps&&et.minFilter!==It&&et.minFilter!==ki}function _e(et){C.generateMipmap(et)}function nt(et,De,Ft,ui,mi=!1){if(et!==null){if(C[et]!==void 0)return C[et];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+et+"'")}let ai=De;if(De===C.RED&&(Ft===C.FLOAT&&(ai=C.R32F),Ft===C.HALF_FLOAT&&(ai=C.R16F),Ft===C.UNSIGNED_BYTE&&(ai=C.R8)),De===C.RED_INTEGER&&(Ft===C.UNSIGNED_BYTE&&(ai=C.R8UI),Ft===C.UNSIGNED_SHORT&&(ai=C.R16UI),Ft===C.UNSIGNED_INT&&(ai=C.R32UI),Ft===C.BYTE&&(ai=C.R8I),Ft===C.SHORT&&(ai=C.R16I),Ft===C.INT&&(ai=C.R32I)),De===C.RG&&(Ft===C.FLOAT&&(ai=C.RG32F),Ft===C.HALF_FLOAT&&(ai=C.RG16F),Ft===C.UNSIGNED_BYTE&&(ai=C.RG8)),De===C.RG_INTEGER&&(Ft===C.UNSIGNED_BYTE&&(ai=C.RG8UI),Ft===C.UNSIGNED_SHORT&&(ai=C.RG16UI),Ft===C.UNSIGNED_INT&&(ai=C.RG32UI),Ft===C.BYTE&&(ai=C.RG8I),Ft===C.SHORT&&(ai=C.RG16I),Ft===C.INT&&(ai=C.RG32I)),De===C.RGB&&Ft===C.UNSIGNED_INT_5_9_9_9_REV&&(ai=C.RGB9_E5),De===C.RGBA){const Ir=mi?of:Zn.getTransfer(ui);Ft===C.FLOAT&&(ai=C.RGBA32F),Ft===C.HALF_FLOAT&&(ai=C.RGBA16F),Ft===C.UNSIGNED_BYTE&&(ai=Ir===hs?C.SRGB8_ALPHA8:C.RGBA8),Ft===C.UNSIGNED_SHORT_4_4_4_4&&(ai=C.RGBA4),Ft===C.UNSIGNED_SHORT_5_5_5_1&&(ai=C.RGB5_A1)}return(ai===C.R16F||ai===C.R32F||ai===C.RG16F||ai===C.RG32F||ai===C.RGBA16F||ai===C.RGBA32F)&&a.get("EXT_color_buffer_float"),ai}function qe(et,De){return we(et)===!0||et.isFramebufferTexture&&et.minFilter!==It&&et.minFilter!==ki?Math.log2(Math.max(De.width,De.height))+1:et.mipmaps!==void 0&&et.mipmaps.length>0?et.mipmaps.length:et.isCompressedTexture&&Array.isArray(et.image)?De.mipmaps.length:1}function Je(et){const De=et.target;De.removeEventListener("dispose",Je),ze(De),De.isVideoTexture&&X.delete(De)}function it(et){const De=et.target;De.removeEventListener("dispose",it),rt(De)}function ze(et){const De=A.get(et);if(De.__webglInit===void 0)return;const Ft=et.source,ui=K.get(Ft);if(ui){const mi=ui[De.__cacheKey];mi.usedTimes--,mi.usedTimes===0&&Oe(et),Object.keys(ui).length===0&&K.delete(Ft)}A.remove(et)}function Oe(et){const De=A.get(et);C.deleteTexture(De.__webglTexture);const Ft=et.source,ui=K.get(Ft);delete ui[De.__cacheKey],M.memory.textures--}function rt(et){const De=A.get(et);if(et.depthTexture&&et.depthTexture.dispose(),et.isWebGLCubeRenderTarget)for(let ui=0;ui<6;ui++){if(Array.isArray(De.__webglFramebuffer[ui]))for(let mi=0;mi<De.__webglFramebuffer[ui].length;mi++)C.deleteFramebuffer(De.__webglFramebuffer[ui][mi]);else C.deleteFramebuffer(De.__webglFramebuffer[ui]);De.__webglDepthbuffer&&C.deleteRenderbuffer(De.__webglDepthbuffer[ui])}else{if(Array.isArray(De.__webglFramebuffer))for(let ui=0;ui<De.__webglFramebuffer.length;ui++)C.deleteFramebuffer(De.__webglFramebuffer[ui]);else C.deleteFramebuffer(De.__webglFramebuffer);if(De.__webglDepthbuffer&&C.deleteRenderbuffer(De.__webglDepthbuffer),De.__webglMultisampledFramebuffer&&C.deleteFramebuffer(De.__webglMultisampledFramebuffer),De.__webglColorRenderbuffer)for(let ui=0;ui<De.__webglColorRenderbuffer.length;ui++)De.__webglColorRenderbuffer[ui]&&C.deleteRenderbuffer(De.__webglColorRenderbuffer[ui]);De.__webglDepthRenderbuffer&&C.deleteRenderbuffer(De.__webglDepthRenderbuffer)}const Ft=et.textures;for(let ui=0,mi=Ft.length;ui<mi;ui++){const ai=A.get(Ft[ui]);ai.__webglTexture&&(C.deleteTexture(ai.__webglTexture),M.memory.textures--),A.remove(Ft[ui])}A.remove(et)}let mt=0;function pt(){mt=0}function Tt(){const et=mt;return et>=b.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+et+" texture units while this GPU supports only "+b.maxTextures),mt+=1,et}function Pt(et){const De=[];return De.push(et.wrapS),De.push(et.wrapT),De.push(et.wrapR||0),De.push(et.magFilter),De.push(et.minFilter),De.push(et.anisotropy),De.push(et.internalFormat),De.push(et.format),De.push(et.type),De.push(et.generateMipmaps),De.push(et.premultiplyAlpha),De.push(et.flipY),De.push(et.unpackAlignment),De.push(et.colorSpace),De.join()}function hi(et,De){const Ft=A.get(et);if(et.isVideoTexture&&ha(et),et.isRenderTargetTexture===!1&&et.version>0&&Ft.__version!==et.version){const ui=et.image;if(ui===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(ui.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else if(Sr(Ft,et,De))return}d.bindTexture(C.TEXTURE_2D,Ft.__webglTexture,C.TEXTURE0+De)}function Di(et,De){const Ft=A.get(et);if(et.version>0&&Ft.__version!==et.version){Sr(Ft,et,De);return}d.bindTexture(C.TEXTURE_2D_ARRAY,Ft.__webglTexture,C.TEXTURE0+De)}function kt(et,De){const Ft=A.get(et);if(et.version>0&&Ft.__version!==et.version){Sr(Ft,et,De);return}d.bindTexture(C.TEXTURE_3D,Ft.__webglTexture,C.TEXTURE0+De)}function yi(et,De){const Ft=A.get(et);if(et.version>0&&Ft.__version!==et.version){ci(Ft,et,De);return}d.bindTexture(C.TEXTURE_CUBE_MAP,Ft.__webglTexture,C.TEXTURE0+De)}const Oi={[Ue]:C.REPEAT,[je]:C.CLAMP_TO_EDGE,[dt]:C.MIRRORED_REPEAT},jr={[It]:C.NEAREST,[bt]:C.NEAREST_MIPMAP_NEAREST,[pi]:C.NEAREST_MIPMAP_LINEAR,[ki]:C.LINEAR,[An]:C.LINEAR_MIPMAP_NEAREST,[sn]:C.LINEAR_MIPMAP_LINEAR},En={[vE]:C.NEVER,[CE]:C.ALWAYS,[xE]:C.LESS,[cv]:C.LEQUAL,[bE]:C.EQUAL,[wE]:C.GEQUAL,[_E]:C.GREATER,[EE]:C.NOTEQUAL};function ns(et,De){if(De.type===St&&a.has("OES_texture_float_linear")===!1&&(De.magFilter===ki||De.magFilter===An||De.magFilter===pi||De.magFilter===sn||De.minFilter===ki||De.minFilter===An||De.minFilter===pi||De.minFilter===sn)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),C.texParameteri(et,C.TEXTURE_WRAP_S,Oi[De.wrapS]),C.texParameteri(et,C.TEXTURE_WRAP_T,Oi[De.wrapT]),(et===C.TEXTURE_3D||et===C.TEXTURE_2D_ARRAY)&&C.texParameteri(et,C.TEXTURE_WRAP_R,Oi[De.wrapR]),C.texParameteri(et,C.TEXTURE_MAG_FILTER,jr[De.magFilter]),C.texParameteri(et,C.TEXTURE_MIN_FILTER,jr[De.minFilter]),De.compareFunction&&(C.texParameteri(et,C.TEXTURE_COMPARE_MODE,C.COMPARE_REF_TO_TEXTURE),C.texParameteri(et,C.TEXTURE_COMPARE_FUNC,En[De.compareFunction])),a.has("EXT_texture_filter_anisotropic")===!0){if(De.magFilter===It||De.minFilter!==pi&&De.minFilter!==sn||De.type===St&&a.has("OES_texture_float_linear")===!1)return;if(De.anisotropy>1||A.get(De).__currentAnisotropy){const Ft=a.get("EXT_texture_filter_anisotropic");C.texParameterf(et,Ft.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(De.anisotropy,b.getMaxAnisotropy())),A.get(De).__currentAnisotropy=De.anisotropy}}}function ms(et,De){let Ft=!1;et.__webglInit===void 0&&(et.__webglInit=!0,De.addEventListener("dispose",Je));const ui=De.source;let mi=K.get(ui);mi===void 0&&(mi={},K.set(ui,mi));const ai=Pt(De);if(ai!==et.__cacheKey){mi[ai]===void 0&&(mi[ai]={texture:C.createTexture(),usedTimes:0},M.memory.textures++,Ft=!0),mi[ai].usedTimes++;const Ir=mi[et.__cacheKey];Ir!==void 0&&(mi[et.__cacheKey].usedTimes--,Ir.usedTimes===0&&Oe(De)),et.__cacheKey=ai,et.__webglTexture=mi[ai].texture}return Ft}function Gn(et){oe=et}function Dn(){const et=oe;oe=!1;for(const De of te)Sr(De.textureProperties,De.texture,De.slot),De.texture.isPendingDeferredUpload=!1;te=[],oe=et}function Sr(et,De,Ft){if(oe)return De.isPendingDeferredUpload||(De.isPendingDeferredUpload=!0,te.push({textureProperties:et,texture:De,slot:Ft})),!1;let ui=C.TEXTURE_2D;(De.isDataArrayTexture||De.isCompressedArrayTexture)&&(ui=C.TEXTURE_2D_ARRAY),De.isData3DTexture&&(ui=C.TEXTURE_3D);const mi=ms(et,De),ai=De.source;d.bindTexture(ui,et.__webglTexture,C.TEXTURE0+Ft);const Ir=A.get(ai);if(ai.version!==Ir.__version||mi===!0){d.activeTexture(C.TEXTURE0+Ft);const zi=Zn.getPrimaries(Zn.workingColorSpace),ur=De.colorSpace===Xa?null:Zn.getPrimaries(De.colorSpace),Xn=De.colorSpace===Xa||zi===ur?C.NONE:C.BROWSER_DEFAULT_WEBGL;C.pixelStorei(C.UNPACK_FLIP_Y_WEBGL,De.flipY),C.pixelStorei(C.UNPACK_PREMULTIPLY_ALPHA_WEBGL,De.premultiplyAlpha),C.pixelStorei(C.UNPACK_ALIGNMENT,De.unpackAlignment),C.pixelStorei(C.UNPACK_COLORSPACE_CONVERSION_WEBGL,Xn);let cr=Me(De.image,!1,b.maxTextureSize);cr=Xs(De,cr);const wr=E.convert(De.format,De.colorSpace),wn=E.convert(De.type);let Vr=nt(De.internalFormat,wr,wn,De.colorSpace,De.isVideoTexture);ns(ui,De);let ut;const vi=De.mipmaps,Mi=De.isVideoTexture!==!0,Rr=Ir.__version===void 0||mi===!0,nr=ai.dataReady,cn=qe(De,cr);if(De.isDepthTexture)Vr=C.DEPTH_COMPONENT16,De.type===St?Vr=C.DEPTH_COMPONENT32F:De.type===ct?Vr=C.DEPTH_COMPONENT24:De.type===Li&&(Vr=C.DEPTH24_STENCIL8),Rr&&(Mi?d.texStorage2D(C.TEXTURE_2D,1,Vr,cr.width,cr.height):d.texImage2D(C.TEXTURE_2D,0,Vr,cr.width,cr.height,0,wr,wn,null));else if(De.isDataTexture)if(vi.length>0){Mi&&Rr&&d.texStorage2D(C.TEXTURE_2D,cn,Vr,vi[0].width,vi[0].height);for(let sr=0,Ji=vi.length;sr<Ji;sr++)ut=vi[sr],Mi?nr&&d.texSubImage2D(C.TEXTURE_2D,sr,0,0,ut.width,ut.height,wr,wn,ut.data):d.texImage2D(C.TEXTURE_2D,sr,Vr,ut.width,ut.height,0,wr,wn,ut.data);De.generateMipmaps=!1}else Mi?(Rr&&d.texStorage2D(C.TEXTURE_2D,cn,Vr,cr.width,cr.height),nr&&d.texSubImage2D(C.TEXTURE_2D,0,0,0,cr.width,cr.height,wr,wn,cr.data)):d.texImage2D(C.TEXTURE_2D,0,Vr,cr.width,cr.height,0,wr,wn,cr.data);else if(De.isCompressedTexture)if(De.isCompressedArrayTexture){Mi&&Rr&&d.texStorage3D(C.TEXTURE_2D_ARRAY,cn,Vr,vi[0].width,vi[0].height,cr.depth);for(let sr=0,Ji=vi.length;sr<Ji;sr++)ut=vi[sr],De.format!==ge?wr!==null?Mi?nr&&d.compressedTexSubImage3D(C.TEXTURE_2D_ARRAY,sr,0,0,0,ut.width,ut.height,cr.depth,wr,ut.data,0,0):d.compressedTexImage3D(C.TEXTURE_2D_ARRAY,sr,Vr,ut.width,ut.height,cr.depth,0,ut.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Mi?nr&&d.texSubImage3D(C.TEXTURE_2D_ARRAY,sr,0,0,0,ut.width,ut.height,cr.depth,wr,wn,ut.data):d.texImage3D(C.TEXTURE_2D_ARRAY,sr,Vr,ut.width,ut.height,cr.depth,0,wr,wn,ut.data)}else{Mi&&Rr&&d.texStorage2D(C.TEXTURE_2D,cn,Vr,vi[0].width,vi[0].height);for(let sr=0,Ji=vi.length;sr<Ji;sr++)ut=vi[sr],De.format!==ge?wr!==null?Mi?nr&&d.compressedTexSubImage2D(C.TEXTURE_2D,sr,0,0,ut.width,ut.height,wr,ut.data):d.compressedTexImage2D(C.TEXTURE_2D,sr,Vr,ut.width,ut.height,0,ut.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Mi?nr&&d.texSubImage2D(C.TEXTURE_2D,sr,0,0,ut.width,ut.height,wr,wn,ut.data):d.texImage2D(C.TEXTURE_2D,sr,Vr,ut.width,ut.height,0,wr,wn,ut.data)}else if(De.isDataArrayTexture)Mi?(Rr&&d.texStorage3D(C.TEXTURE_2D_ARRAY,cn,Vr,cr.width,cr.height,cr.depth),nr&&d.texSubImage3D(C.TEXTURE_2D_ARRAY,0,0,0,0,cr.width,cr.height,cr.depth,wr,wn,cr.data)):d.texImage3D(C.TEXTURE_2D_ARRAY,0,Vr,cr.width,cr.height,cr.depth,0,wr,wn,cr.data);else if(De.isData3DTexture)Mi?(Rr&&d.texStorage3D(C.TEXTURE_3D,cn,Vr,cr.width,cr.height,cr.depth),nr&&d.texSubImage3D(C.TEXTURE_3D,0,0,0,0,cr.width,cr.height,cr.depth,wr,wn,cr.data)):d.texImage3D(C.TEXTURE_3D,0,Vr,cr.width,cr.height,cr.depth,0,wr,wn,cr.data);else if(De.isFramebufferTexture){if(Rr)if(Mi)d.texStorage2D(C.TEXTURE_2D,cn,Vr,cr.width,cr.height);else{let sr=cr.width,Ji=cr.height;for(let xn=0;xn<cn;xn++)d.texImage2D(C.TEXTURE_2D,xn,Vr,sr,Ji,0,wr,wn,null),sr>>=1,Ji>>=1}}else if(vi.length>0){if(Mi&&Rr){const sr=qn(vi[0]);d.texStorage2D(C.TEXTURE_2D,cn,Vr,sr.width,sr.height)}for(let sr=0,Ji=vi.length;sr<Ji;sr++)ut=vi[sr],Mi?nr&&d.texSubImage2D(C.TEXTURE_2D,sr,0,0,wr,wn,ut):d.texImage2D(C.TEXTURE_2D,sr,Vr,wr,wn,ut);De.generateMipmaps=!1}else if(Mi){if(Rr){const sr=qn(cr);d.texStorage2D(C.TEXTURE_2D,cn,Vr,sr.width,sr.height)}nr&&d.texSubImage2D(C.TEXTURE_2D,0,0,0,wr,wn,cr)}else d.texImage2D(C.TEXTURE_2D,0,Vr,wr,wn,cr);we(De)&&_e(ui),Ir.__version=ai.version,De.onUpdate&&De.onUpdate(De)}return et.__version=De.version,!0}function ci(et,De,Ft){if(De.image.length!==6)return;const ui=ms(et,De),mi=De.source;d.bindTexture(C.TEXTURE_CUBE_MAP,et.__webglTexture,C.TEXTURE0+Ft);const ai=A.get(mi);if(mi.version!==ai.__version||ui===!0){d.activeTexture(C.TEXTURE0+Ft);const Ir=Zn.getPrimaries(Zn.workingColorSpace),zi=De.colorSpace===Xa?null:Zn.getPrimaries(De.colorSpace),ur=De.colorSpace===Xa||Ir===zi?C.NONE:C.BROWSER_DEFAULT_WEBGL;C.pixelStorei(C.UNPACK_FLIP_Y_WEBGL,De.flipY),C.pixelStorei(C.UNPACK_PREMULTIPLY_ALPHA_WEBGL,De.premultiplyAlpha),C.pixelStorei(C.UNPACK_ALIGNMENT,De.unpackAlignment),C.pixelStorei(C.UNPACK_COLORSPACE_CONVERSION_WEBGL,ur);const Xn=De.isCompressedTexture||De.image[0].isCompressedTexture,cr=De.image[0]&&De.image[0].isDataTexture,wr=[];for(let Ji=0;Ji<6;Ji++)!Xn&&!cr?wr[Ji]=Me(De.image[Ji],!0,b.maxCubemapSize):wr[Ji]=cr?De.image[Ji].image:De.image[Ji],wr[Ji]=Xs(De,wr[Ji]);const wn=wr[0],Vr=E.convert(De.format,De.colorSpace),ut=E.convert(De.type),vi=nt(De.internalFormat,Vr,ut,De.colorSpace),Mi=De.isVideoTexture!==!0,Rr=ai.__version===void 0||ui===!0,nr=mi.dataReady;let cn=qe(De,wn);ns(C.TEXTURE_CUBE_MAP,De);let sr;if(Xn){Mi&&Rr&&d.texStorage2D(C.TEXTURE_CUBE_MAP,cn,vi,wn.width,wn.height);for(let Ji=0;Ji<6;Ji++){sr=wr[Ji].mipmaps;for(let xn=0;xn<sr.length;xn++){const Br=sr[xn];De.format!==ge?Vr!==null?Mi?nr&&d.compressedTexSubImage2D(C.TEXTURE_CUBE_MAP_POSITIVE_X+Ji,xn,0,0,Br.width,Br.height,Vr,Br.data):d.compressedTexImage2D(C.TEXTURE_CUBE_MAP_POSITIVE_X+Ji,xn,vi,Br.width,Br.height,0,Br.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Mi?nr&&d.texSubImage2D(C.TEXTURE_CUBE_MAP_POSITIVE_X+Ji,xn,0,0,Br.width,Br.height,Vr,ut,Br.data):d.texImage2D(C.TEXTURE_CUBE_MAP_POSITIVE_X+Ji,xn,vi,Br.width,Br.height,0,Vr,ut,Br.data)}}}else{if(sr=De.mipmaps,Mi&&Rr){sr.length>0&&cn++;const Ji=qn(wr[0]);d.texStorage2D(C.TEXTURE_CUBE_MAP,cn,vi,Ji.width,Ji.height)}for(let Ji=0;Ji<6;Ji++)if(cr){Mi?nr&&d.texSubImage2D(C.TEXTURE_CUBE_MAP_POSITIVE_X+Ji,0,0,0,wr[Ji].width,wr[Ji].height,Vr,ut,wr[Ji].data):d.texImage2D(C.TEXTURE_CUBE_MAP_POSITIVE_X+Ji,0,vi,wr[Ji].width,wr[Ji].height,0,Vr,ut,wr[Ji].data);for(let xn=0;xn<sr.length;xn++){const Br=sr[xn].image[Ji].image;Mi?nr&&d.texSubImage2D(C.TEXTURE_CUBE_MAP_POSITIVE_X+Ji,xn+1,0,0,Br.width,Br.height,Vr,ut,Br.data):d.texImage2D(C.TEXTURE_CUBE_MAP_POSITIVE_X+Ji,xn+1,vi,Br.width,Br.height,0,Vr,ut,Br.data)}}else{Mi?nr&&d.texSubImage2D(C.TEXTURE_CUBE_MAP_POSITIVE_X+Ji,0,0,0,Vr,ut,wr[Ji]):d.texImage2D(C.TEXTURE_CUBE_MAP_POSITIVE_X+Ji,0,vi,Vr,ut,wr[Ji]);for(let xn=0;xn<sr.length;xn++){const Br=sr[xn];Mi?nr&&d.texSubImage2D(C.TEXTURE_CUBE_MAP_POSITIVE_X+Ji,xn+1,0,0,Vr,ut,Br.image[Ji]):d.texImage2D(C.TEXTURE_CUBE_MAP_POSITIVE_X+Ji,xn+1,vi,Vr,ut,Br.image[Ji])}}}we(De)&&_e(C.TEXTURE_CUBE_MAP),ai.__version=mi.version,De.onUpdate&&De.onUpdate(De)}et.__version=De.version}function wi(et,De,Ft,ui,mi,ai){const Ir=E.convert(Ft.format,Ft.colorSpace),zi=E.convert(Ft.type),ur=nt(Ft.internalFormat,Ir,zi,Ft.colorSpace);if(!A.get(De).__hasExternalTextures){const cr=Math.max(1,De.width>>ai),wr=Math.max(1,De.height>>ai);De.isWebGLMultiviewRenderTarget===!0?d.texStorage3D(C.TEXTURE_2D_ARRAY,0,ur,De.width,De.height,De.numViews):mi===C.TEXTURE_3D||mi===C.TEXTURE_2D_ARRAY?d.texImage3D(mi,ai,ur,cr,wr,De.depth,0,Ir,zi,null):d.texImage2D(mi,ai,ur,cr,wr,0,Ir,zi,null)}d.bindFramebuffer(C.FRAMEBUFFER,et);const Xn=qr(De);De.isWebGLMultiviewRenderTarget===!0?Xn?k.framebufferTextureMultisampleMultiviewOVR(C.FRAMEBUFFER,C.COLOR_ATTACHMENT0,A.get(Ft).__webglTexture,0,vn(De),0,De.numViews):k.framebufferTextureMultiviewOVR(C.FRAMEBUFFER,C.COLOR_ATTACHMENT0,A.get(Ft).__webglTexture,0,0,De.numViews):(mi===C.TEXTURE_2D||mi>=C.TEXTURE_CUBE_MAP_POSITIVE_X&&mi<=C.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&(Xn?N.framebufferTexture2DMultisampleEXT(C.FRAMEBUFFER,ui,mi,A.get(Ft).__webglTexture,0,vn(De)):C.framebufferTexture2D(C.FRAMEBUFFER,ui,mi,A.get(Ft).__webglTexture,ai)),d.bindFramebuffer(C.FRAMEBUFFER,null)}function qi(et,De,Ft){if(C.bindRenderbuffer(C.RENDERBUFFER,et),De.isWebGLMultiviewRenderTarget===!0){const ui=qr(De),mi=De.numViews,ai=De.depthTexture;let Ir=C.DEPTH_COMPONENT24,zi=C.DEPTH_ATTACHMENT;ai&&ai.isDepthTexture&&(ai.type===St?Ir=C.DEPTH_COMPONENT32F:ai.type===Li&&(Ir=C.DEPTH24_STENCIL8,zi=C.DEPTH_STENCIL_ATTACHMENT));let ur=A.get(De.depthTexture).__webglTexture;ur===void 0&&(ur=C.createTexture(),C.bindTexture(C.TEXTURE_2D_ARRAY,ur),C.texStorage3D(C.TEXTURE_2D_ARRAY,1,Ir,De.width,De.height,mi)),ui?k.framebufferTextureMultisampleMultiviewOVR(C.FRAMEBUFFER,zi,ur,0,vn(De),0,mi):k.framebufferTextureMultiviewOVR(C.FRAMEBUFFER,zi,ur,0,0,mi)}else if(De.depthBuffer&&!De.stencilBuffer){let ui=C.DEPTH_COMPONENT24;if(Ft||qr(De)){const mi=De.depthTexture;mi&&mi.isDepthTexture&&(mi.type===St?ui=C.DEPTH_COMPONENT32F:mi.type===ct&&(ui=C.DEPTH_COMPONENT24));const ai=vn(De);qr(De)?N.renderbufferStorageMultisampleEXT(C.RENDERBUFFER,ai,ui,De.width,De.height):C.renderbufferStorageMultisample(C.RENDERBUFFER,ai,ui,De.width,De.height)}else C.renderbufferStorage(C.RENDERBUFFER,ui,De.width,De.height);C.framebufferRenderbuffer(C.FRAMEBUFFER,C.DEPTH_ATTACHMENT,C.RENDERBUFFER,et)}else if(De.depthBuffer&&De.stencilBuffer){const ui=vn(De);Ft&&qr(De)===!1?C.renderbufferStorageMultisample(C.RENDERBUFFER,ui,C.DEPTH24_STENCIL8,De.width,De.height):qr(De)?N.renderbufferStorageMultisampleEXT(C.RENDERBUFFER,ui,C.DEPTH24_STENCIL8,De.width,De.height):C.renderbufferStorage(C.RENDERBUFFER,C.DEPTH_STENCIL,De.width,De.height),C.framebufferRenderbuffer(C.FRAMEBUFFER,C.DEPTH_STENCIL_ATTACHMENT,C.RENDERBUFFER,et)}else{const ui=De.textures;for(let mi=0;mi<ui.length;mi++){const ai=ui[mi],Ir=E.convert(ai.format,ai.colorSpace),zi=E.convert(ai.type),ur=nt(ai.internalFormat,Ir,zi,ai.colorSpace),Xn=vn(De);Ft&&qr(De)===!1?C.renderbufferStorageMultisample(C.RENDERBUFFER,Xn,ur,De.width,De.height):qr(De)?N.renderbufferStorageMultisampleEXT(C.RENDERBUFFER,Xn,ur,De.width,De.height):C.renderbufferStorage(C.RENDERBUFFER,ur,De.width,De.height)}}C.bindRenderbuffer(C.RENDERBUFFER,null)}function tt(et,De){if(De&&De.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(d.bindFramebuffer(C.FRAMEBUFFER,et),!(De.depthTexture&&De.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!A.get(De.depthTexture).__webglTexture||De.depthTexture.image.width!==De.width||De.depthTexture.image.height!==De.height)&&(De.depthTexture.image.width=De.width,De.depthTexture.image.height=De.height,De.depthTexture.needsUpdate=!0),hi(De.depthTexture,0),De.depthTexture.image.depth!=1?Di(De.depthTexture,0):hi(De.depthTexture,0);const Ft=A.get(De.depthTexture).__webglTexture,ui=vn(De);if(De.isWebGLMultiviewRenderTarget===!0){const mi=qr(De),ai=De.numViews;if(De.depthTexture.format===Ke)mi?k.framebufferTextureMultisampleMultiviewOVR(C.FRAMEBUFFER,C.DEPTH_ATTACHMENT,Ft,0,ui,0,ai):k.framebufferTextureMultiviewOVR(C.FRAMEBUFFER,C.DEPTH_ATTACHMENT,Ft,0,0,ai);else if(De.depthTexture.format===ot)mi?k.framebufferTextureMultisampleMultiviewOVR(C.FRAMEBUFFER,C.DEPTH_STENCIL_ATTACHMENT,Ft,0,ui,0,ai):k.framebufferTextureMultiviewOVR(C.FRAMEBUFFER,C.DEPTH_STENCIL_ATTACHMENT,Ft,0,0,ai);else throw new Error("Unknown depthTexture format")}else if(De.depthTexture.format===Ke)qr(De)?N.framebufferTexture2DMultisampleEXT(C.FRAMEBUFFER,C.DEPTH_ATTACHMENT,C.TEXTURE_2D,Ft,0,ui):C.framebufferTexture2D(C.FRAMEBUFFER,C.DEPTH_ATTACHMENT,C.TEXTURE_2D,Ft,0);else if(De.depthTexture.format===ot)qr(De)?N.framebufferTexture2DMultisampleEXT(C.FRAMEBUFFER,C.DEPTH_STENCIL_ATTACHMENT,C.TEXTURE_2D,Ft,0,ui):C.framebufferTexture2D(C.FRAMEBUFFER,C.DEPTH_STENCIL_ATTACHMENT,C.TEXTURE_2D,Ft,0);else throw new Error("Unknown depthTexture format")}function fi(et){const De=A.get(et),Ft=et.isWebGLCubeRenderTarget===!0;if(et.depthTexture&&!De.__autoAllocateDepthBuffer){if(Ft)throw new Error("target.depthTexture not supported in Cube render targets");tt(De.__webglFramebuffer,et)}else if(Ft){De.__webglDepthbuffer=[];for(let ui=0;ui<6;ui++)d.bindFramebuffer(C.FRAMEBUFFER,De.__webglFramebuffer[ui]),De.__webglDepthbuffer[ui]=C.createRenderbuffer(),qi(De.__webglDepthbuffer[ui],et,!1)}else d.bindFramebuffer(C.FRAMEBUFFER,De.__webglFramebuffer),De.__webglDepthbuffer=C.createRenderbuffer(),qi(De.__webglDepthbuffer,et,!1);d.bindFramebuffer(C.FRAMEBUFFER,null)}function $t(et,De,Ft){const ui=A.get(et);De!==void 0&&wi(ui.__webglFramebuffer,et,et.texture,C.COLOR_ATTACHMENT0,C.TEXTURE_2D,0),Ft!==void 0&&fi(et)}function $i(et){const De=et.texture,Ft=A.get(et),ui=A.get(De);et.addEventListener("dispose",it);const mi=et.textures,ai=et.isWebGLCubeRenderTarget===!0,Ir=mi.length>1;if(Ir||(ui.__webglTexture===void 0&&(ui.__webglTexture=C.createTexture()),ui.__version=De.version,M.memory.textures++),ai){Ft.__webglFramebuffer=[];for(let zi=0;zi<6;zi++)if(De.mipmaps&&De.mipmaps.length>0){Ft.__webglFramebuffer[zi]=[];for(let ur=0;ur<De.mipmaps.length;ur++)Ft.__webglFramebuffer[zi][ur]=C.createFramebuffer()}else Ft.__webglFramebuffer[zi]=C.createFramebuffer()}else{if(De.mipmaps&&De.mipmaps.length>0){Ft.__webglFramebuffer=[];for(let zi=0;zi<De.mipmaps.length;zi++)Ft.__webglFramebuffer[zi]=C.createFramebuffer()}else Ft.__webglFramebuffer=C.createFramebuffer();if(Ir)for(let zi=0,ur=mi.length;zi<ur;zi++){const Xn=A.get(mi[zi]);Xn.__webglTexture===void 0&&(Xn.__webglTexture=C.createTexture(),M.memory.textures++)}if(et.samples>0&&qr(et)===!1){Ft.__webglMultisampledFramebuffer=C.createFramebuffer(),Ft.__webglColorRenderbuffer=[],d.bindFramebuffer(C.FRAMEBUFFER,Ft.__webglMultisampledFramebuffer);for(let zi=0;zi<mi.length;zi++){const ur=mi[zi];Ft.__webglColorRenderbuffer[zi]=C.createRenderbuffer(),C.bindRenderbuffer(C.RENDERBUFFER,Ft.__webglColorRenderbuffer[zi]);const Xn=E.convert(ur.format,ur.colorSpace),cr=E.convert(ur.type),wr=nt(ur.internalFormat,Xn,cr,ur.colorSpace,et.isXRRenderTarget===!0),wn=vn(et);C.renderbufferStorageMultisample(C.RENDERBUFFER,wn,wr,et.width,et.height),C.framebufferRenderbuffer(C.FRAMEBUFFER,C.COLOR_ATTACHMENT0+zi,C.RENDERBUFFER,Ft.__webglColorRenderbuffer[zi])}C.bindRenderbuffer(C.RENDERBUFFER,null),et.depthBuffer&&(Ft.__webglDepthRenderbuffer=C.createRenderbuffer(),qi(Ft.__webglDepthRenderbuffer,et,!0)),d.bindFramebuffer(C.FRAMEBUFFER,null)}}if(ai){d.bindTexture(C.TEXTURE_CUBE_MAP,ui.__webglTexture),ns(C.TEXTURE_CUBE_MAP,De);for(let zi=0;zi<6;zi++)if(De.mipmaps&&De.mipmaps.length>0)for(let ur=0;ur<De.mipmaps.length;ur++)wi(Ft.__webglFramebuffer[zi][ur],et,De,C.COLOR_ATTACHMENT0,C.TEXTURE_CUBE_MAP_POSITIVE_X+zi,ur);else wi(Ft.__webglFramebuffer[zi],et,De,C.COLOR_ATTACHMENT0,C.TEXTURE_CUBE_MAP_POSITIVE_X+zi,0);we(De)&&_e(C.TEXTURE_CUBE_MAP),d.unbindTexture()}else if(Ir){for(let zi=0,ur=mi.length;zi<ur;zi++){const Xn=mi[zi],cr=A.get(Xn);d.bindTexture(C.TEXTURE_2D,cr.__webglTexture),ns(C.TEXTURE_2D,Xn),wi(Ft.__webglFramebuffer,et,Xn,C.COLOR_ATTACHMENT0+zi,C.TEXTURE_2D,0),we(Xn)&&_e(C.TEXTURE_2D)}d.unbindTexture()}else{let zi=C.TEXTURE_2D;if((et.isWebGL3DRenderTarget||et.isWebGLArrayRenderTarget)&&(zi=et.isWebGL3DRenderTarget?C.TEXTURE_3D:C.TEXTURE_2D_ARRAY),et.isWebGLMultiviewRenderTarget===!0&&(zi=C.TEXTURE_2D_ARRAY),d.bindTexture(zi,ui.__webglTexture),ns(zi,De),De.mipmaps&&De.mipmaps.length>0)for(let ur=0;ur<De.mipmaps.length;ur++)wi(Ft.__webglFramebuffer[ur],et,De,C.COLOR_ATTACHMENT0,zi,ur);else wi(Ft.__webglFramebuffer,et,De,C.COLOR_ATTACHMENT0,zi,0);we(De)&&_e(zi),d.unbindTexture()}(et.depthBuffer||et.isWebGLMultiviewRenderTarget===!0)&&this.setupDepthRenderbuffer(et)}function oi(et){const De=et.textures;for(let Ft=0,ui=De.length;Ft<ui;Ft++){const mi=De[Ft];if(we(mi)){const ai=et.isWebGLCubeRenderTarget?C.TEXTURE_CUBE_MAP:C.TEXTURE_2D,Ir=A.get(mi).__webglTexture;d.bindTexture(ai,Ir),_e(ai),d.unbindTexture()}}}const tr=[],er=[];function vr(et){if(et.samples>0){if(qr(et)===!1){const De=et.textures,Ft=et.width,ui=et.height;let mi=C.COLOR_BUFFER_BIT;const ai=et.stencilBuffer?C.DEPTH_STENCIL_ATTACHMENT:C.DEPTH_ATTACHMENT,Ir=A.get(et),zi=De.length>1;if(zi)for(let ur=0;ur<De.length;ur++)d.bindFramebuffer(C.FRAMEBUFFER,Ir.__webglMultisampledFramebuffer),C.framebufferRenderbuffer(C.FRAMEBUFFER,C.COLOR_ATTACHMENT0+ur,C.RENDERBUFFER,null),d.bindFramebuffer(C.FRAMEBUFFER,Ir.__webglFramebuffer),C.framebufferTexture2D(C.DRAW_FRAMEBUFFER,C.COLOR_ATTACHMENT0+ur,C.TEXTURE_2D,null,0);d.bindFramebuffer(C.READ_FRAMEBUFFER,Ir.__webglMultisampledFramebuffer),d.bindFramebuffer(C.DRAW_FRAMEBUFFER,Ir.__webglFramebuffer);for(let ur=0;ur<De.length;ur++){if(et.resolveDepthBuffer&&(et.depthBuffer&&(mi|=C.DEPTH_BUFFER_BIT),et.stencilBuffer&&et.resolveStencilBuffer&&(mi|=C.STENCIL_BUFFER_BIT)),zi){C.framebufferRenderbuffer(C.READ_FRAMEBUFFER,C.COLOR_ATTACHMENT0,C.RENDERBUFFER,Ir.__webglColorRenderbuffer[ur]);const Xn=A.get(De[ur]).__webglTexture;C.framebufferTexture2D(C.DRAW_FRAMEBUFFER,C.COLOR_ATTACHMENT0,C.TEXTURE_2D,Xn,0)}C.blitFramebuffer(0,0,Ft,ui,0,0,Ft,ui,mi,C.NEAREST),P===!0&&(tr.length=0,er.length=0,tr.push(C.COLOR_ATTACHMENT0+ur),et.depthBuffer&&et.resolveDepthBuffer===!1&&(tr.push(ai),er.push(ai),C.invalidateFramebuffer(C.DRAW_FRAMEBUFFER,er)),C.invalidateFramebuffer(C.READ_FRAMEBUFFER,tr))}if(d.bindFramebuffer(C.READ_FRAMEBUFFER,null),d.bindFramebuffer(C.DRAW_FRAMEBUFFER,null),zi)for(let ur=0;ur<De.length;ur++){d.bindFramebuffer(C.FRAMEBUFFER,Ir.__webglMultisampledFramebuffer),C.framebufferRenderbuffer(C.FRAMEBUFFER,C.COLOR_ATTACHMENT0+ur,C.RENDERBUFFER,Ir.__webglColorRenderbuffer[ur]);const Xn=A.get(De[ur]).__webglTexture;d.bindFramebuffer(C.FRAMEBUFFER,Ir.__webglFramebuffer),C.framebufferTexture2D(C.DRAW_FRAMEBUFFER,C.COLOR_ATTACHMENT0+ur,C.TEXTURE_2D,Xn,0)}d.bindFramebuffer(C.DRAW_FRAMEBUFFER,Ir.__webglMultisampledFramebuffer)}else if(et.depthBuffer&&et.resolveDepthBuffer===!1&&P){const De=et.stencilBuffer?C.DEPTH_STENCIL_ATTACHMENT:C.DEPTH_ATTACHMENT;C.invalidateFramebuffer(C.DRAW_FRAMEBUFFER,[De])}}}function vn(et){return Math.min(b.maxSamples,et.samples)}function qr(et){const De=A.get(et);return et.samples>0&&a.has("WEBGL_multisampled_render_to_texture")===!0&&De.__useRenderToTexture!==!1}function ha(et){const De=M.render.frame;X.get(et)!==De&&(X.set(et,De),et.update())}function Xs(et,De){const Ft=et.colorSpace,ui=et.format,mi=et.type;return et.isCompressedTexture===!0||et.isVideoTexture===!0||Ft!==Ic&&Ft!==Xa&&(Zn.getTransfer(Ft)===hs?(ui!==ge||mi!==yn)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Ft)),De}function qn(et){return typeof HTMLImageElement<"u"&&et instanceof HTMLImageElement?(j.width=et.naturalWidth||et.width,j.height=et.naturalHeight||et.height):typeof VideoFrame<"u"&&et instanceof VideoFrame?(j.width=et.displayWidth,j.height=et.displayHeight):(j.width=et.width,j.height=et.height),j}this.allocateTextureUnit=Tt,this.resetTextureUnits=pt,this.setTexture2D=hi,this.setTexture2DArray=Di,this.setTexture3D=kt,this.setTextureCube=yi,this.rebindTextures=$t,this.uploadTexture=Sr,this.setupRenderTarget=$i,this.updateRenderTargetMipmap=oi,this.updateMultisampleRenderTarget=vr,this.setupDepthTexture=tt,this.setupDepthRenderbuffer=fi,this.setupFrameBufferTexture=wi,this.useMultisampledRTT=qr,this.runDeferredUploads=Dn,this.setDeferTextureUploads=Gn}function iV(C,a){function d(A,b=Xa){let E;const M=Zn.getTransfer(b);if(A===yn)return C.UNSIGNED_BYTE;if(A===Bi)return C.UNSIGNED_SHORT_4_4_4_4;if(A===ar)return C.UNSIGNED_SHORT_5_5_5_1;if(A===Pi)return C.UNSIGNED_INT_5_9_9_9_REV;if(A===Ls)return C.BYTE;if(A===rs)return C.SHORT;if(A===bs)return C.UNSIGNED_SHORT;if(A===me)return C.INT;if(A===ct)return C.UNSIGNED_INT;if(A===St)return C.FLOAT;if(A===Xt)return C.HALF_FLOAT;if(A===Be)return C.ALPHA;if(A===se)return C.RGB;if(A===ge)return C.RGBA;if(A===Ne)return C.LUMINANCE;if(A===Fe)return C.LUMINANCE_ALPHA;if(A===Ke)return C.DEPTH_COMPONENT;if(A===ot)return C.DEPTH_STENCIL;if(A===wt)return C.RED;if(A===qt)return C.RED_INTEGER;if(A===Kt)return C.RG;if(A===Mt)return C.RG_INTEGER;if(A===ti)return C.RGBA_INTEGER;if(A===Ei||A===Fi||A===Tr||A===hr)if(M===hs)if(E=a.get("WEBGL_compressed_texture_s3tc_srgb"),E!==null){if(A===Ei)return E.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(A===Fi)return E.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(A===Tr)return E.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(A===hr)return E.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(E=a.get("WEBGL_compressed_texture_s3tc"),E!==null){if(A===Ei)return E.COMPRESSED_RGB_S3TC_DXT1_EXT;if(A===Fi)return E.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(A===Tr)return E.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(A===hr)return E.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(A===Zi||A===bi||A===Bn||A===Jn)if(E=a.get("WEBGL_compressed_texture_pvrtc"),E!==null){if(A===Zi)return E.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(A===bi)return E.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(A===Bn)return E.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(A===Jn)return E.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(A===Ri||A===or||A===pn)if(E=a.get("WEBGL_compressed_texture_etc"),E!==null){if(A===Ri||A===or)return M===hs?E.COMPRESSED_SRGB8_ETC2:E.COMPRESSED_RGB8_ETC2;if(A===pn)return M===hs?E.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:E.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(A===Yr||A===W||A===ue||A===Ae||A===Se||A===We||A===Ye||A===ft||A===he||A===le||A===pe||A===be||A===Ee||A===st)if(E=a.get("WEBGL_compressed_texture_astc"),E!==null){if(A===Yr)return M===hs?E.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:E.COMPRESSED_RGBA_ASTC_4x4_KHR;if(A===W)return M===hs?E.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:E.COMPRESSED_RGBA_ASTC_5x4_KHR;if(A===ue)return M===hs?E.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:E.COMPRESSED_RGBA_ASTC_5x5_KHR;if(A===Ae)return M===hs?E.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:E.COMPRESSED_RGBA_ASTC_6x5_KHR;if(A===Se)return M===hs?E.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:E.COMPRESSED_RGBA_ASTC_6x6_KHR;if(A===We)return M===hs?E.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:E.COMPRESSED_RGBA_ASTC_8x5_KHR;if(A===Ye)return M===hs?E.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:E.COMPRESSED_RGBA_ASTC_8x6_KHR;if(A===ft)return M===hs?E.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:E.COMPRESSED_RGBA_ASTC_8x8_KHR;if(A===he)return M===hs?E.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:E.COMPRESSED_RGBA_ASTC_10x5_KHR;if(A===le)return M===hs?E.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:E.COMPRESSED_RGBA_ASTC_10x6_KHR;if(A===pe)return M===hs?E.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:E.COMPRESSED_RGBA_ASTC_10x8_KHR;if(A===be)return M===hs?E.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:E.COMPRESSED_RGBA_ASTC_10x10_KHR;if(A===Ee)return M===hs?E.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:E.COMPRESSED_RGBA_ASTC_12x10_KHR;if(A===st)return M===hs?E.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:E.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(A===Ct||A===Ht||A===ii)if(E=a.get("EXT_texture_compression_bptc"),E!==null){if(A===Ct)return M===hs?E.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:E.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(A===Ht)return E.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(A===ii)return E.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(A===Ai||A===Wt||A===Ni||A===xr)if(E=a.get("EXT_texture_compression_rgtc"),E!==null){if(A===Ct)return E.COMPRESSED_RED_RGTC1_EXT;if(A===Wt)return E.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(A===Ni)return E.COMPRESSED_RED_GREEN_RGTC2_EXT;if(A===xr)return E.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return A===Li?C.UNSIGNED_INT_24_8:C[A]!==void 0?C[A]:null}return{convert:d}}class xf extends Qn{constructor(){super(),this.isGroup=!0,this.type="Group"}}class AN extends xa{constructor(a=[]){super(),this.isArrayCamera=!0,this.cameras=a}}var rV=new He,nV=new He;function pMe(C,a,d){rV.setFromMatrixPosition(a.matrixWorld),nV.setFromMatrixPosition(d.matrixWorld);var A=rV.distanceTo(nV),b=a.projectionMatrix.elements,E=d.projectionMatrix.elements,M=b[14]/(b[10]-1),N=b[14]/(b[10]+1),P=(b[9]+1)/b[5],k=(b[9]-1)/b[5],j=(b[8]-1)/b[0],X=(E[8]+1)/E[0],q=M*j,K=M*X,te=A/(-j+X),oe=te*-j;a.matrixWorld.decompose(C.position,C.quaternion,C.scale),C.translateX(oe),C.translateZ(te),C.matrixWorld.compose(C.position,C.quaternion,C.scale),C.matrixWorldInverse.copy(C.matrixWorld).invert();var re=M+te,ee=N+te,Me=q-oe,we=K+(A-oe),_e=P*N/ee*re,nt=k*N/ee*re;C.projectionMatrix.makePerspective(Me,we,_e,nt,re,ee)}function sV(C){var a,d,A=this,b=null,E=null,M=null,N=[],P=new mr,k=new mr,j=1,X="local-floor";typeof window<"u"&&"VRFrameData"in window&&(E=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",_e,!1));var q=new mr,K=new Wn,te=new He,oe=new xa;oe.viewport=new jn,oe.layers.enable(1);var re=new xa;re.viewport=new jn,re.layers.enable(2);var ee=new AN([oe,re]);ee.layers.enable(1),ee.layers.enable(2);var Me=new si,we;function _e(){var rt=A.isPresenting=b!==null&&b.isPresenting===!0;if(rt){var mt=b.getEyeParameters("left");a=2*mt.renderWidth*j,d=mt.renderHeight*j,we=C.getPixelRatio(),C.getSize(Me),C.setDrawingBufferSize(a,d,1),oe.viewport.set(0,0,a/2,d),re.viewport.set(a/2,0,a/2,d),Oe.start(),A.dispatchEvent({type:"sessionstart"})}else A.enabled&&C.setDrawingBufferSize(Me.width,Me.height,we),Oe.stop(),A.dispatchEvent({type:"sessionend"})}var nt=[],qe=[];function Je(rt){for(var mt=navigator.getGamepads&&navigator.getGamepads(),pt=0,Tt=mt.length;pt<Tt;pt++){var Pt=mt[pt];if(Pt&&(Pt.id==="Daydream Controller"||Pt.id==="Gear VR Controller"||Pt.id==="Oculus Go Controller"||Pt.id==="OpenVR Gamepad"||Pt.id.startsWith("Oculus Touch")||Pt.id.startsWith("HTC Vive Focus")||Pt.id.startsWith("Spatial Controller"))){var hi=Pt.hand;if(rt===0&&(hi===""||hi==="right")||rt===1&&hi==="left")return Pt}}}function it(){for(var rt=0;rt<N.length;rt++){var mt=N[rt],pt=Je(rt);if(pt!==void 0&&pt.pose!==void 0){if(pt.pose===null)return;var Tt=pt.pose;Tt.hasPosition===!1&&mt.position.set(.2,-.6,-.05),Tt.position!==null&&mt.position.fromArray(Tt.position),Tt.orientation!==null&&mt.quaternion.fromArray(Tt.orientation),mt.matrix.compose(mt.position,mt.quaternion,mt.scale),mt.matrix.premultiply(P),mt.matrix.decompose(mt.position,mt.quaternion,mt.scale),mt.matrixWorldNeedsUpdate=!0,mt.visible=!0;var Pt=pt.id==="Daydream Controller"?0:1;nt[rt]===void 0&&(nt[rt]=!1),nt[rt]!==pt.buttons[Pt].pressed&&(nt[rt]=pt.buttons[Pt].pressed,nt[rt]===!0?mt.dispatchEvent({type:"selectstart"}):(mt.dispatchEvent({type:"selectend"}),mt.dispatchEvent({type:"select"}))),Pt=2,qe[rt]===void 0&&(qe[rt]=!1),pt.buttons[Pt]!==void 0&&qe[rt]!==pt.buttons[Pt].pressed&&(qe[rt]=pt.buttons[Pt].pressed,qe[rt]===!0?mt.dispatchEvent({type:"squeezestart"}):(mt.dispatchEvent({type:"squeezeend"}),mt.dispatchEvent({type:"squeeze"})))}else mt.visible=!1}}function ze(rt,mt){mt!==null&&mt.length===4&&rt.set(mt[0]*a,mt[1]*d,mt[2]*a,mt[3]*d)}this.enabled=!1,this.getController=function(rt){var mt=N[rt];return mt===void 0&&(mt=new xf,mt.matrixAutoUpdate=!1,mt.visible=!1,N[rt]=mt),mt},this.getDevice=function(){return b},this.setDevice=function(rt){rt!==void 0&&(b=rt),Oe.setContext(rt)},this.setFramebufferScaleFactor=function(rt){j=rt},this.setReferenceSpaceType=function(rt){X=rt},this.setPoseTarget=function(rt){rt!==void 0&&(M=rt)},this.cameraAutoUpdate=!0,this.updateCamera=function(rt){var mt=X==="local-floor"?1.6:0;if(b.depthNear=rt.near,b.depthFar=rt.far,b.getFrameData(E),X==="local-floor"){var pt=b.stageParameters;pt?P.fromArray(pt.sittingToStandingTransform):P.makeTranslation(0,mt,0)}var Tt=E.pose,Pt=M!==null?M:rt;Pt.matrix.copy(P),Pt.matrix.decompose(Pt.position,Pt.quaternion,Pt.scale),Tt.orientation!==null&&(K.fromArray(Tt.orientation),Pt.quaternion.multiply(K)),Tt.position!==null&&(K.setFromRotationMatrix(P),te.fromArray(Tt.position),te.applyQuaternion(K),Pt.position.add(te)),Pt.updateMatrixWorld();for(var hi=Pt.children,Di=0,kt=hi.length;Di<kt;Di++)hi[Di].updateMatrixWorld(!0);oe.near=rt.near,re.near=rt.near,oe.far=rt.far,re.far=rt.far,oe.matrixWorldInverse.fromArray(E.leftViewMatrix),re.matrixWorldInverse.fromArray(E.rightViewMatrix),k.copy(P).invert(),X==="local-floor"&&(oe.matrixWorldInverse.multiply(k),re.matrixWorldInverse.multiply(k));var yi=Pt.parent;yi!==null&&(q.copy(yi.matrixWorld).invert(),oe.matrixWorldInverse.multiply(q),re.matrixWorldInverse.multiply(q)),oe.matrixWorld.copy(oe.matrixWorldInverse).invert(),re.matrixWorld.copy(re.matrixWorldInverse).invert(),oe.projectionMatrix.fromArray(E.leftProjectionMatrix),re.projectionMatrix.fromArray(E.rightProjectionMatrix),pMe(ee,oe,re);var Oi=b.getLayers();if(Oi.length){var jr=Oi[0];ze(oe.viewport,jr.leftBounds),ze(re.viewport,jr.rightBounds)}return it(),ee},this.getCamera=function(){return ee},this.getFoveation=function(){return 1},this.setFoveation=function(rt){rt!==1&&console.warn("THREE.WebVRManager: setFoveation() not used in WebVR.")},this.getEnvironmentBlendMode=function(){if(A.isPresenting)return"opaque"},this.getStandingMatrix=function(){return P},this.isPresenting=!1;var Oe=new nN;this.setAnimationLoop=function(rt){Oe.setAnimationLoop(rt),this.isPresenting&&Oe.start()},this.submitFrame=function(){this.isPresenting&&b.submitFrame()},this.dispose=function(){typeof window<"u"&&window.removeEventListener("vrdisplaypresentchange",_e)},this.setFrameOfReferenceType=function(){console.warn("THREE.WebVRManager: setFrameOfReferenceType() has been deprecated.")}}Object.assign(sV.prototype,{addEventListener:Io.prototype.addEventListener,hasEventListener:Io.prototype.hasEventListener,removeEventListener:Io.prototype.removeEventListener,dispatchEvent:Io.prototype.dispatchEvent});class aV extends el{constructor(a,d,A,b={}){super(a,d,b),this.depthBuffer=!1,this.stencilBuffer=!1,this.numViews=A}copy(a){return super.copy(a),this.numViews=a.numViews,this}}aV.prototype.isWebGLMultiviewRenderTarget=!0;const fMe={type:"move"};class yN{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new xf,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new xf,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new He,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new He),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new xf,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new He,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new He),this._grip}dispatchEvent(a){return this._targetRay!==null&&this._targetRay.dispatchEvent(a),this._grip!==null&&this._grip.dispatchEvent(a),this._hand!==null&&this._hand.dispatchEvent(a),this}connect(a){if(a&&a.hand){const d=this._hand;if(d)for(const A of a.hand.values())this._getHandJoint(d,A)}return this.dispatchEvent({type:"connected",data:a}),this}disconnect(a){return this.dispatchEvent({type:"disconnected",data:a}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(a,d,A){let b=null,E=null,M=null;const N=this._targetRay,P=this._grip,k=this._hand;if(a&&d.session.visibilityState!=="visible-blurred"){if(k&&a.hand){M=!0;for(const oe of a.hand.values()){const re=d.getJointPose(oe,A),ee=this._getHandJoint(k,oe);re!==null&&(ee.matrix.fromArray(re.transform.matrix),ee.matrix.decompose(ee.position,ee.rotation,ee.scale),ee.matrixWorldNeedsUpdate=!0,ee.jointRadius=re.radius),ee.visible=re!==null}const j=k.joints["index-finger-tip"],X=k.joints["thumb-tip"],q=j.position.distanceTo(X.position),K=.02,te=.005;k.inputState.pinching&&q>K+te?(k.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:a.handedness,target:this})):!k.inputState.pinching&&q<=K-te&&(k.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:a.handedness,target:this}))}else P!==null&&a.gripSpace&&(E=d.getPose(a.gripSpace,A),E!==null&&(P.matrix.fromArray(E.transform.matrix),P.matrix.decompose(P.position,P.rotation,P.scale),P.matrixWorldNeedsUpdate=!0,E.linearVelocity?(P.hasLinearVelocity=!0,P.linearVelocity.copy(E.linearVelocity)):P.hasLinearVelocity=!1,E.angularVelocity?(P.hasAngularVelocity=!0,P.angularVelocity.copy(E.angularVelocity)):P.hasAngularVelocity=!1));N!==null&&(b=d.getPose(a.targetRaySpace,A),b===null&&E!==null&&(b=E),b!==null&&(N.matrix.fromArray(b.transform.matrix),N.matrix.decompose(N.position,N.rotation,N.scale),N.matrixWorldNeedsUpdate=!0,b.linearVelocity?(N.hasLinearVelocity=!0,N.linearVelocity.copy(b.linearVelocity)):N.hasLinearVelocity=!1,b.angularVelocity?(N.hasAngularVelocity=!0,N.angularVelocity.copy(b.angularVelocity)):N.hasAngularVelocity=!1,this.dispatchEvent(fMe)))}return N!==null&&(N.visible=b!==null),P!==null&&(P.visible=E!==null),k!==null&&(k.visible=M!==null),this}_getHandJoint(a,d){if(a.joints[d.jointName]===void 0){const A=new xf;A.matrixAutoUpdate=!1,A.visible=!1,a.joints[d.jointName]=A,a.add(A)}return a.joints[d.jointName]}}const mMe=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,gMe=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class AMe{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(a,d,A){if(this.texture===null){const b=new fs,E=a.properties.get(b);E.__webglTexture=d.texture,(d.depthNear!=A.depthNear||d.depthFar!=A.depthFar)&&(this.depthNear=d.depthNear,this.depthFar=d.depthFar),this.texture=b}}render(a,d){if(this.texture!==null){if(this.mesh===null){const A=d.cameras[0].viewport,b=new Nc({vertexShader:mMe,fragmentShader:gMe,uniforms:{depthColor:{value:this.texture},depthWidth:{value:A.z},depthHeight:{value:A.w}}});this.mesh=new ua(new y0(20,20),b)}a.render(this.mesh,d)}}reset(){this.texture=null,this.mesh=null}}class yMe extends Io{constructor(a,d,A,b){super();const E=this;let M=null,N=1;var P=null;let k=null,j="local-floor",X=1,q=null,K=null;var te=[];let oe=null,re=null,ee=null,Me=null;const we=new AMe,_e=d.getContextAttributes();let nt=null,qe=null;const Je=[],it=[],ze=new si;let Oe=null;const rt=new xa;rt.layers.enable(1),rt.viewport=new jn;const mt=new xa;mt.layers.enable(2),mt.viewport=new jn;const pt=[rt,mt],Tt=new AN;Tt.layers.enable(1),Tt.layers.enable(2);let Pt=null,hi=null;this.cameraAutoUpdate=!0,this.layersEnabled=!1,this.enabled=!1,this.isPresenting=!1,this.isMultiview=!1,this.getCameraPose=function(){return K},this.getController=function(ci){let wi=Je[ci];return wi===void 0&&(wi=new yN,Je[ci]=wi),wi.getTargetRaySpace()},this.getControllerGrip=function(ci){let wi=Je[ci];return wi===void 0&&(wi=new yN,Je[ci]=wi),wi.getGripSpace()},this.getHand=function(ci){let wi=Je[ci];return wi===void 0&&(wi=new yN,Je[ci]=wi),wi.getHandSpace()};function Di(ci){const wi=it.indexOf(ci.inputSource);if(wi===-1)return;const qi=Je[wi];qi!==void 0&&(qi.update(ci.inputSource,ci.frame,q||k),qi.dispatchEvent({type:ci.type,data:ci.inputSource}))}function kt(){M.removeEventListener("select",Di),M.removeEventListener("selectstart",Di),M.removeEventListener("selectend",Di),M.removeEventListener("squeeze",Di),M.removeEventListener("squeezestart",Di),M.removeEventListener("squeezeend",Di),M.removeEventListener("end",kt),M.removeEventListener("inputsourceschange",yi);for(let ci=0;ci<Je.length;ci++){const wi=it[ci];wi!==null&&(it[ci]=null,Je[ci].disconnect(wi))}Pt=null,hi=null,we.reset(),a.setRenderTarget(nt),ee=null,re=null,oe=null,M=null,qe=null,Sr.stop(),E.isPresenting=!1,a.setPixelRatio(Oe),a.setSize(ze.width,ze.height,!1),E.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(ci){N=ci,E.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ci){j=ci,E.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return q||k},this.setReferenceSpace=function(ci){q=ci},this.getBaseLayer=function(){return re!==null?re:ee},this.getBinding=function(){return oe},this.getFrame=function(){return Me},this.getSession=function(){return M},this.setSession=async function(ci){if(M=ci,M!==null){if(nt=a.getRenderTarget(),M.addEventListener("select",Di),M.addEventListener("selectstart",Di),M.addEventListener("selectend",Di),M.addEventListener("squeeze",Di),M.addEventListener("squeezestart",Di),M.addEventListener("squeezeend",Di),M.addEventListener("end",kt),M.addEventListener("inputsourceschange",yi),_e.xrCompatible!==!0&&await d.makeXRCompatible(),Oe=a.getPixelRatio(),a.getSize(ze),M.renderState.layers===void 0){const wi={antialias:_e.antialias,alpha:!0,depth:_e.depth,stencil:_e.stencil,framebufferScaleFactor:N};ee=new XRWebGLLayer(M,d,wi),M.updateRenderState({baseLayer:ee}),a.setPixelRatio(1),a.setSize(ee.framebufferWidth,ee.framebufferHeight,!1),qe=new el(ee.framebufferWidth,ee.framebufferHeight,{format:ge,type:yn,colorSpace:a.outputColorSpace,stencilBuffer:_e.stencil})}else{let wi=null,qi=null,tt=null;_e.depth&&(tt=_e.stencil?d.DEPTH24_STENCIL8:d.DEPTH_COMPONENT24,wi=_e.stencil?ot:Ke,qi=_e.stencil?Li:ct),E.isMultiview=b&&A.has("OCULUS_multiview");const fi={colorFormat:d.RGBA8,depthFormat:tt,scaleFactor:N};E.isMultiview&&(fi.textureType="texture-array"),oe=new XRWebGLBinding(M,d),re=oe.createProjectionLayer(fi),M.updateRenderState({layers:[re]}),a.setPixelRatio(1),a.setSize(re.textureWidth,re.textureHeight,!1);const $t={format:ge,type:yn,depthTexture:new dN(re.textureWidth,re.textureHeight,qi,void 0,void 0,void 0,void 0,void 0,void 0,wi),stencilBuffer:_e.stencil,colorSpace:a.outputColorSpace,samples:_e.antialias?4:0,resolveDepthBuffer:re.ignoreDepthValues===!1};if(E.isMultiview){const $i=A.get("OCULUS_multiview");this.maxNumViews=d.getParameter($i.MAX_VIEWS_OVR),qe=new aV(re.textureWidth,re.textureHeight,2,$t)}else qe=new el(re.textureWidth,re.textureHeight,$t)}qe.isXRRenderTarget=!0,this.setFoveation(X),q=null,k=await M.requestReferenceSpace(j),Sr.setContext(M),Sr.start(),E.isPresenting=!0,E.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(M!==null)return M.environmentBlendMode},this.addLayer=function(ci){!window.XRWebGLBinding||!this.layersEnabled||!M||(te.push(ci),this.updateLayers())},this.removeLayer=function(ci){te.splice(te.indexOf(ci),1),!(!window.XRWebGLBinding||!this.layersEnabled||!M)&&this.updateLayers()},this.updateLayers=function(){var ci=te.map(function(wi){return wi});ci.unshift(M.renderState.layers[0]),M.updateRenderState({layers:ci})};function yi(ci){for(let wi=0;wi<ci.removed.length;wi++){const qi=ci.removed[wi],tt=it.indexOf(qi);tt>=0&&(it[tt]=null,Je[tt].disconnect(qi))}for(let wi=0;wi<ci.added.length;wi++){const qi=ci.added[wi];let tt=it.indexOf(qi);if(tt===-1){for(let $t=0;$t<Je.length;$t++)if($t>=it.length){it.push(qi),tt=$t;break}else if(it[$t]===null){it[$t]=qi,tt=$t;break}if(tt===-1)break}const fi=Je[tt];fi&&fi.connect(qi)}}const Oi=new He,jr=new He;function En(ci,wi,qi){Oi.setFromMatrixPosition(wi.matrixWorld),jr.setFromMatrixPosition(qi.matrixWorld);const tt=Oi.distanceTo(jr),fi=wi.projectionMatrix.elements,$t=qi.projectionMatrix.elements,$i=fi[14]/(fi[10]-1),oi=fi[14]/(fi[10]+1),tr=(fi[9]+1)/fi[5],er=(fi[9]-1)/fi[5],vr=(fi[8]-1)/fi[0],vn=($t[8]+1)/$t[0],qr=$i*vr,ha=$i*vn,Xs=tt/(-vr+vn),qn=Xs*-vr;wi.matrixWorld.decompose(ci.position,ci.quaternion,ci.scale),ci.translateX(qn),ci.translateZ(Xs),ci.matrixWorld.compose(ci.position,ci.quaternion,ci.scale),ci.matrixWorldInverse.copy(ci.matrixWorld).invert();const et=$i+Xs,De=oi+Xs,Ft=qr-qn,ui=ha+(tt-qn),mi=tr*oi/De*et,ai=er*oi/De*et;ci.projectionMatrix.makePerspective(Ft,ui,mi,ai,et,De),ci.projectionMatrixInverse.copy(ci.projectionMatrix).invert()}function ns(ci,wi){wi===null?ci.matrixWorld.copy(ci.matrix):ci.matrixWorld.multiplyMatrices(wi.matrixWorld,ci.matrix),ci.matrixWorldInverse.copy(ci.matrixWorld).invert()}this.setPoseTarget=function(ci){ci!==void 0&&(P=ci)},this.updateCamera=function(ci){if(M===null)return;we.texture!==null&&(ci.near=we.depthNear,ci.far=we.depthFar),Tt.near=mt.near=rt.near=ci.near,Tt.far=mt.far=rt.far=ci.far,(Pt!==Tt.near||hi!==Tt.far)&&(M.updateRenderState({depthNear:Tt.near,depthFar:Tt.far}),Pt=Tt.near,hi=Tt.far,rt.near=Pt,rt.far=hi,mt.near=Pt,mt.far=hi,rt.updateProjectionMatrix(),mt.updateProjectionMatrix(),ci.updateProjectionMatrix());const wi=Tt.cameras;var qi=P||ci;const tt=qi.parent;ns(Tt,tt);for(let fi=0;fi<wi.length;fi++)ns(wi[fi],tt);wi.length===2?En(Tt,rt,mt):Tt.projectionMatrix.copy(rt.projectionMatrix),ms(ci,Tt,qi)};function ms(ci,wi,qi){wi.matrixWorld.decompose(wi.position,wi.quaternion,wi.scale),qi.parent===null?qi.matrix.copy(wi.matrixWorld):(qi.matrix.copy(qi.parent.matrixWorld),qi.matrix.invert(),qi.matrix.multiply(wi.matrixWorld)),qi.matrix.decompose(qi.position,qi.quaternion,qi.scale),qi.updateMatrixWorld(!0),ci.projectionMatrix.copy(wi.projectionMatrix),ci.projectionMatrixInverse.copy(wi.projectionMatrixInverse),ci.isPerspectiveCamera&&(ci.fov=Bd*2*Math.atan(1/ci.projectionMatrix.elements[5]),ci.zoom=1)}this.getCamera=function(){return Tt},this.getFoveation=function(){if(!(re===null&&ee===null))return X},this.setFoveation=function(ci){X=ci,re!==null&&(re.fixedFoveation=ci),ee!==null&&ee.fixedFoveation!==void 0&&(ee.fixedFoveation=ci)},this.hasDepthSensing=function(){return we.texture!==null};let Gn=null;function Dn(ci,wi){if(K=wi.getViewerPose(q||k),Me=wi,K!==null){const qi=K.views;ee!==null&&(a.setRenderTargetFramebuffer(qe,ee.framebuffer),a.setRenderTarget(qe));let tt=!1;qi.length!==Tt.cameras.length&&(Tt.cameras.length=0,tt=!0);for(let $t=0;$t<qi.length;$t++){const $i=qi[$t];let oi=null;if(ee!==null)oi=ee.getViewport($i);else{const er=oe.getViewSubImage(re,$i);oi=er.viewport,$t===0&&(a.setRenderTargetTextures(qe,er.colorTexture,re.ignoreDepthValues?void 0:er.depthStencilTexture),a.setRenderTarget(qe))}let tr=pt[$t];tr===void 0&&(tr=new xa,tr.layers.enable($t),tr.viewport=new jn,pt[$t]=tr),tr.matrix.fromArray($i.transform.matrix),tr.matrix.decompose(tr.position,tr.quaternion,tr.scale),tr.projectionMatrix.fromArray($i.projectionMatrix),tr.projectionMatrixInverse.copy(tr.projectionMatrix).invert(),tr.viewport.set(oi.x,oi.y,oi.width,oi.height),$t===0&&(Tt.matrix.copy(tr.matrix),Tt.matrix.decompose(Tt.position,Tt.quaternion,Tt.scale)),tt===!0&&Tt.cameras.push(tr)}const fi=M.enabledFeatures;if(fi&&fi.includes("depth-sensing")){const $t=oe.getDepthInformation(qi[0]);$t&&$t.isValid&&$t.texture&&we.init(a,$t,M.renderState)}}for(let qi=0;qi<Je.length;qi++){const tt=it[qi],fi=Je[qi];tt!==null&&fi!==void 0&&fi.update(tt,wi,q||k)}we.render(a,Tt),Gn&&Gn(ci,wi),wi.detectedPlanes&&E.dispatchEvent({type:"planesdetected",data:wi}),Me=null}const Sr=new nN;Sr.setAnimationLoop(Dn),this.setAnimationLoop=function(ci){Gn=ci},this.dispose=function(){}}}const bf=new Sl,vMe=new mr;function xMe(C,a){function d(re,ee){re.matrixAutoUpdate===!0&&re.updateMatrix(),ee.value.copy(re.matrix)}function A(re,ee){ee.color.getRGB(re.fogColor.value,wj(C)),ee.isFog?(re.fogNear.value=ee.near,re.fogFar.value=ee.far):ee.isFogExp2&&(re.fogDensity.value=ee.density)}function b(re,ee,Me,we,_e){ee.isMeshBasicMaterial||ee.isMeshLambertMaterial?E(re,ee):ee.isMeshToonMaterial?(E(re,ee),X(re,ee)):ee.isMeshPhongMaterial?(E(re,ee),j(re,ee)):ee.isMeshStandardMaterial?(E(re,ee),q(re,ee),ee.isMeshPhysicalMaterial&&K(re,ee,_e)):ee.isMeshMatcapMaterial?(E(re,ee),te(re,ee)):ee.isMeshDepthMaterial?E(re,ee):ee.isMeshDistanceMaterial?(E(re,ee),oe(re,ee)):ee.isMeshNormalMaterial?E(re,ee):ee.isLineBasicMaterial?(M(re,ee),ee.isLineDashedMaterial&&N(re,ee)):ee.isPointsMaterial?P(re,ee,Me,we):ee.isSpriteMaterial?k(re,ee):ee.isShadowMaterial?(re.color.value.copy(ee.color),re.opacity.value=ee.opacity):ee.isShaderMaterial&&(ee.uniformsNeedUpdate=!1)}function E(re,ee){re.opacity.value=ee.opacity,ee.color&&re.diffuse.value.copy(ee.color),ee.emissive&&re.emissive.value.copy(ee.emissive).multiplyScalar(ee.emissiveIntensity),ee.map&&(re.map.value=ee.map,d(ee.map,re.mapTransform)),ee.alphaMap&&(re.alphaMap.value=ee.alphaMap,d(ee.alphaMap,re.alphaMapTransform)),ee.bumpMap&&(re.bumpMap.value=ee.bumpMap,d(ee.bumpMap,re.bumpMapTransform),re.bumpScale.value=ee.bumpScale,ee.side===R&&(re.bumpScale.value*=-1)),ee.normalMap&&(re.normalMap.value=ee.normalMap,d(ee.normalMap,re.normalMapTransform),re.normalScale.value.copy(ee.normalScale),ee.side===R&&re.normalScale.value.negate()),ee.displacementMap&&(re.displacementMap.value=ee.displacementMap,d(ee.displacementMap,re.displacementMapTransform),re.displacementScale.value=ee.displacementScale,re.displacementBias.value=ee.displacementBias),ee.emissiveMap&&(re.emissiveMap.value=ee.emissiveMap,d(ee.emissiveMap,re.emissiveMapTransform)),ee.specularMap&&(re.specularMap.value=ee.specularMap,d(ee.specularMap,re.specularMapTransform)),ee.alphaTest>0&&(re.alphaTest.value=ee.alphaTest);const Me=a.get(ee),we=Me.envMap,_e=Me.envMapRotation;if(we&&(re.envMap.value=we,bf.copy(_e),bf.x*=-1,bf.y*=-1,bf.z*=-1,we.isCubeTexture&&we.isRenderTargetTexture===!1&&(bf.y*=-1,bf.z*=-1),re.envMapRotation.value.setFromMatrix4(vMe.makeRotationFromEuler(bf)),re.flipEnvMap.value=we.isCubeTexture&&we.isRenderTargetTexture===!1?-1:1,re.reflectivity.value=ee.reflectivity,re.ior.value=ee.ior,re.refractionRatio.value=ee.refractionRatio),ee.lightMap){re.lightMap.value=ee.lightMap;const nt=C._useLegacyLights===!0?Math.PI:1;re.lightMapIntensity.value=ee.lightMapIntensity*nt,d(ee.lightMap,re.lightMapTransform)}ee.aoMap&&(re.aoMap.value=ee.aoMap,re.aoMapIntensity.value=ee.aoMapIntensity,d(ee.aoMap,re.aoMapTransform))}function M(re,ee){re.diffuse.value.copy(ee.color),re.opacity.value=ee.opacity,ee.map&&(re.map.value=ee.map,d(ee.map,re.mapTransform))}function N(re,ee){re.dashSize.value=ee.dashSize,re.totalSize.value=ee.dashSize+ee.gapSize,re.scale.value=ee.scale}function P(re,ee,Me,we){re.diffuse.value.copy(ee.color),re.opacity.value=ee.opacity,re.size.value=ee.size*Me,re.scale.value=we*.5,ee.map&&(re.map.value=ee.map,d(ee.map,re.uvTransform)),ee.alphaMap&&(re.alphaMap.value=ee.alphaMap,d(ee.alphaMap,re.alphaMapTransform)),ee.alphaTest>0&&(re.alphaTest.value=ee.alphaTest)}function k(re,ee){re.diffuse.value.copy(ee.color),re.opacity.value=ee.opacity,re.rotation.value=ee.rotation,ee.map&&(re.map.value=ee.map,d(ee.map,re.mapTransform)),ee.alphaMap&&(re.alphaMap.value=ee.alphaMap,d(ee.alphaMap,re.alphaMapTransform)),ee.alphaTest>0&&(re.alphaTest.value=ee.alphaTest)}function j(re,ee){re.specular.value.copy(ee.specular),re.shininess.value=Math.max(ee.shininess,1e-4)}function X(re,ee){ee.gradientMap&&(re.gradientMap.value=ee.gradientMap)}function q(re,ee){re.metalness.value=ee.metalness,ee.metalnessMap&&(re.metalnessMap.value=ee.metalnessMap,d(ee.metalnessMap,re.metalnessMapTransform)),re.roughness.value=ee.roughness,ee.roughnessMap&&(re.roughnessMap.value=ee.roughnessMap,d(ee.roughnessMap,re.roughnessMapTransform)),ee.envMap&&(re.envMapIntensity.value=ee.envMapIntensity)}function K(re,ee,Me){re.ior.value=ee.ior,ee.sheen>0&&(re.sheenColor.value.copy(ee.sheenColor).multiplyScalar(ee.sheen),re.sheenRoughness.value=ee.sheenRoughness,ee.sheenColorMap&&(re.sheenColorMap.value=ee.sheenColorMap,d(ee.sheenColorMap,re.sheenColorMapTransform)),ee.sheenRoughnessMap&&(re.sheenRoughnessMap.value=ee.sheenRoughnessMap,d(ee.sheenRoughnessMap,re.sheenRoughnessMapTransform))),ee.clearcoat>0&&(re.clearcoat.value=ee.clearcoat,re.clearcoatRoughness.value=ee.clearcoatRoughness,ee.clearcoatMap&&(re.clearcoatMap.value=ee.clearcoatMap,d(ee.clearcoatMap,re.clearcoatMapTransform)),ee.clearcoatRoughnessMap&&(re.clearcoatRoughnessMap.value=ee.clearcoatRoughnessMap,d(ee.clearcoatRoughnessMap,re.clearcoatRoughnessMapTransform)),ee.clearcoatNormalMap&&(re.clearcoatNormalMap.value=ee.clearcoatNormalMap,d(ee.clearcoatNormalMap,re.clearcoatNormalMapTransform),re.clearcoatNormalScale.value.copy(ee.clearcoatNormalScale),ee.side===R&&re.clearcoatNormalScale.value.negate())),ee.dispersion>0&&(re.dispersion.value=ee.dispersion),ee.iridescence>0&&(re.iridescence.value=ee.iridescence,re.iridescenceIOR.value=ee.iridescenceIOR,re.iridescenceThicknessMinimum.value=ee.iridescenceThicknessRange[0],re.iridescenceThicknessMaximum.value=ee.iridescenceThicknessRange[1],ee.iridescenceMap&&(re.iridescenceMap.value=ee.iridescenceMap,d(ee.iridescenceMap,re.iridescenceMapTransform)),ee.iridescenceThicknessMap&&(re.iridescenceThicknessMap.value=ee.iridescenceThicknessMap,d(ee.iridescenceThicknessMap,re.iridescenceThicknessMapTransform))),ee.transmission>0&&(re.transmission.value=ee.transmission,re.transmissionSamplerMap.value=Me.texture,re.transmissionSamplerSize.value.set(Me.width,Me.height),ee.transmissionMap&&(re.transmissionMap.value=ee.transmissionMap,d(ee.transmissionMap,re.transmissionMapTransform)),re.thickness.value=ee.thickness,ee.thicknessMap&&(re.thicknessMap.value=ee.thicknessMap,d(ee.thicknessMap,re.thicknessMapTransform)),re.attenuationDistance.value=ee.attenuationDistance,re.attenuationColor.value.copy(ee.attenuationColor)),ee.anisotropy>0&&(re.anisotropyVector.value.set(ee.anisotropy*Math.cos(ee.anisotropyRotation),ee.anisotropy*Math.sin(ee.anisotropyRotation)),ee.anisotropyMap&&(re.anisotropyMap.value=ee.anisotropyMap,d(ee.anisotropyMap,re.anisotropyMapTransform))),re.specularIntensity.value=ee.specularIntensity,re.specularColor.value.copy(ee.specularColor),ee.specularColorMap&&(re.specularColorMap.value=ee.specularColorMap,d(ee.specularColorMap,re.specularColorMapTransform)),ee.specularIntensityMap&&(re.specularIntensityMap.value=ee.specularIntensityMap,d(ee.specularIntensityMap,re.specularIntensityMapTransform))}function te(re,ee){ee.matcap&&(re.matcap.value=ee.matcap)}function oe(re,ee){const Me=a.get(ee).light;re.referencePosition.value.setFromMatrixPosition(Me.matrixWorld),re.nearDistance.value=Me.shadow.camera.near,re.farDistance.value=Me.shadow.camera.far}return{refreshFogUniforms:A,refreshMaterialUniforms:b}}function bMe(C,a,d,A){let b={},E={},M=[];const N=C.getParameter(C.MAX_UNIFORM_BUFFER_BINDINGS);function P(Me,we){const _e=we.program;A.uniformBlockBinding(Me,_e)}function k(Me,we){let _e=b[Me.id];_e===void 0&&(te(Me),_e=j(Me),b[Me.id]=_e,Me.addEventListener("dispose",re));const nt=we.program;A.updateUBOMapping(Me,nt);const qe=a.render.frame;E[Me.id]!==qe&&(q(Me),E[Me.id]=qe)}function j(Me){const we=X();Me.__bindingPointIndex=we;const _e=C.createBuffer(),nt=Me.__size,qe=Me.usage;return C.bindBuffer(C.UNIFORM_BUFFER,_e),C.bufferData(C.UNIFORM_BUFFER,nt,qe),C.bindBuffer(C.UNIFORM_BUFFER,null),C.bindBufferBase(C.UNIFORM_BUFFER,we,_e),_e}function X(){for(let Me=0;Me<N;Me++)if(M.indexOf(Me)===-1)return M.push(Me),Me;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function q(Me){const we=b[Me.id],_e=Me.uniforms,nt=Me.__cache;C.bindBuffer(C.UNIFORM_BUFFER,we);for(let qe=0,Je=_e.length;qe<Je;qe++){const it=Array.isArray(_e[qe])?_e[qe]:[_e[qe]];for(let ze=0,Oe=it.length;ze<Oe;ze++){const rt=it[ze];if(K(rt,qe,ze,nt)===!0){const mt=rt.__offset,pt=Array.isArray(rt.value)?rt.value:[rt.value];let Tt=0;for(let Pt=0;Pt<pt.length;Pt++){const hi=pt[Pt],Di=oe(hi);typeof hi=="number"||typeof hi=="boolean"?(rt.__data[0]=hi,C.bufferSubData(C.UNIFORM_BUFFER,mt+Tt,rt.__data)):hi.isMatrix3?(rt.__data[0]=hi.elements[0],rt.__data[1]=hi.elements[1],rt.__data[2]=hi.elements[2],rt.__data[3]=0,rt.__data[4]=hi.elements[3],rt.__data[5]=hi.elements[4],rt.__data[6]=hi.elements[5],rt.__data[7]=0,rt.__data[8]=hi.elements[6],rt.__data[9]=hi.elements[7],rt.__data[10]=hi.elements[8],rt.__data[11]=0):(hi.toArray(rt.__data,Tt),Tt+=Di.storage/Float32Array.BYTES_PER_ELEMENT)}C.bufferSubData(C.UNIFORM_BUFFER,mt,rt.__data)}}}C.bindBuffer(C.UNIFORM_BUFFER,null)}function K(Me,we,_e,nt){const qe=Me.value,Je=we+"_"+_e;if(nt[Je]===void 0)return typeof qe=="number"||typeof qe=="boolean"?nt[Je]=qe:nt[Je]=qe.clone(),!0;{const it=nt[Je];if(typeof qe=="number"||typeof qe=="boolean"){if(it!==qe)return nt[Je]=qe,!0}else if(it.equals(qe)===!1)return it.copy(qe),!0}return!1}function te(Me){const we=Me.uniforms;let _e=0;const nt=16;for(let Je=0,it=we.length;Je<it;Je++){const ze=Array.isArray(we[Je])?we[Je]:[we[Je]];for(let Oe=0,rt=ze.length;Oe<rt;Oe++){const mt=ze[Oe],pt=Array.isArray(mt.value)?mt.value:[mt.value];for(let Tt=0,Pt=pt.length;Tt<Pt;Tt++){const hi=pt[Tt],Di=oe(hi),kt=_e%nt;kt!==0&&nt-kt<Di.boundary&&(_e+=nt-kt),mt.__data=new Float32Array(Di.storage/Float32Array.BYTES_PER_ELEMENT),mt.__offset=_e,_e+=Di.storage}}}const qe=_e%nt;return qe>0&&(_e+=nt-qe),Me.__size=_e,Me.__cache={},this}function oe(Me){const we={boundary:0,storage:0};return typeof Me=="number"||typeof Me=="boolean"?(we.boundary=4,we.storage=4):Me.isVector2?(we.boundary=8,we.storage=8):Me.isVector3||Me.isColor?(we.boundary=16,we.storage=12):Me.isVector4?(we.boundary=16,we.storage=16):Me.isMatrix3?(we.boundary=48,we.storage=48):Me.isMatrix4?(we.boundary=64,we.storage=64):Me.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",Me),we}function re(Me){const we=Me.target;we.removeEventListener("dispose",re);const _e=M.indexOf(we.__bindingPointIndex);M.splice(_e,1),C.deleteBuffer(b[we.id]),delete b[we.id],delete E[we.id]}function ee(){for(const Me in b)C.deleteBuffer(b[Me]);M=[],b={},E={}}return{bind:P,update:k,dispose:ee}}class _Me{constructor(a={}){const{canvas:d=ME(),context:A=null,depth:b=!0,stencil:E=!1,alpha:M=!1,antialias:N=!1,premultipliedAlpha:P=!0,preserveDrawingBuffer:k=!1,powerPreference:j="default",failIfMajorPerformanceCaveat:X=!1,multiviewStereo:q=!1}=a;this.isWebGLRenderer=!0;let K;if(A!==null){if(typeof WebGLRenderingContext<"u"&&A instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");K=A.getContextAttributes().alpha}else K=M;const te=new Uint32Array(4),oe=new Int32Array(4);let re=null,ee=null;const Me=[],we=[];this.domElement=d,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=kn,this._useLegacyLights=!1,this.toneMapping=Ot,this.toneMappingExposure=1;const _e=this;let nt=!1,qe=0,Je=0,it=null,ze=-1,Oe=null;const rt=new jn,mt=new jn;let pt=null;const Tt=new lr(0);let Pt=0,hi=d.width,Di=d.height,kt=1,yi=null,Oi=null;const jr=new jn(0,0,hi,Di),En=new jn(0,0,hi,Di);let ns=!1;const ms=new xv;let Gn=!1,Dn=!1;const Sr=new mr,ci=new He,wi={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function qi(){return it===null?kt:1}let tt=A;function fi(Ve,Et){return d.getContext(Ve,Et)}try{const Ve={alpha:!0,depth:b,stencil:E,antialias:N,premultipliedAlpha:P,preserveDrawingBuffer:k,powerPreference:j,failIfMajorPerformanceCaveat:X};if("setAttribute"in d&&d.setAttribute("data-engine",`three.js r${h}`),d.addEventListener("webglcontextlost",Mi,!1),d.addEventListener("webglcontextrestored",Rr,!1),d.addEventListener("webglcontextcreationerror",nr,!1),tt===null){const Et="webgl2";if(tt=fi(Et,Ve),tt===null)throw fi(Et)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(Ve){throw console.error("THREE.WebGLRenderer: "+Ve.message),Ve}let $t,$i,oi,tr,er,vr,vn,qr,ha,Xs,qn,et,De,Ft,ui,mi,ai,Ir,zi,ur,Xn,cr,wr,wn,Vr;function ut(){$t=new NSe(tt),$t.init(),wr=new iV(tt,$t),$i=new SSe(tt,$t,a,wr),oi=new hMe(tt),tr=new OSe(tt),er=new $Te,vr=new dMe(tt,$t,oi,er,$i,wr,tr),vn=new MSe(_e),qr=new BSe(_e),ha=new _2e(tt),wn=new wSe(tt,ha),Xs=new LSe(tt,ha,tr,wn),qn=new FSe(tt,Xs,ha,tr),ur=new PSe(tt,$i,vr),mi=new TSe(er),et=new ZTe(_e,vn,qr,$t,$i,wn,mi),De=new xMe(_e,er),Ft=new tMe,ui=new oMe($t),zi=new ESe(_e,vn,qr,oi,qn,K,P),Ir=new kSe(_e,$t,tt),ai=new uMe(_e,qn,$i),Vr=new bMe(tt,tr,$i,oi),Xn=new CSe(tt,$t,tr),cr=new DSe(tt,$t,tr),tr.programs=et.programs,_e.capabilities=$i,_e.extensions=$t,_e.properties=er,_e.renderLists=Ft,_e.shadowMap=ai,_e.state=oi,_e.info=tr}ut();const vi=typeof navigator<"u"&&"xr"in navigator?new yMe(_e,tt,$t,q):new sV(_e);this.xr=vi,this.getContext=function(){return tt},this.getContextAttributes=function(){return tt.getContextAttributes()},this.forceContextLoss=function(){const Ve=$t.get("WEBGL_lose_context");Ve&&Ve.loseContext()},this.forceContextRestore=function(){const Ve=$t.get("WEBGL_lose_context");Ve&&Ve.restoreContext()},this.getPixelRatio=function(){return kt},this.setPixelRatio=function(Ve){Ve!==void 0&&(kt=Ve,this.setSize(hi,Di,!1))},this.getSize=function(Ve){return Ve.set(hi,Di)},this.setSize=function(Ve,Et,jt=!0){if(vi.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}hi=Ve,Di=Et,d.width=Math.floor(Ve*kt),d.height=Math.floor(Et*kt),jt===!0&&(d.style.width=Ve+"px",d.style.height=Et+"px"),this.setViewport(0,0,Ve,Et)},this.getDrawingBufferSize=function(Ve){return Ve.set(hi*kt,Di*kt).floor()},this.setDrawingBufferSize=function(Ve,Et,jt){hi=Ve,Di=Et,kt=jt,d.width=Math.floor(Ve*jt),d.height=Math.floor(Et*jt),this.setViewport(0,0,Ve,Et)},this.getCurrentViewport=function(Ve){return Ve.copy(rt)},this.getViewport=function(Ve){return Ve.copy(jr)},this.setViewport=function(Ve,Et,jt,Dt){Ve.isVector4?jr.set(Ve.x,Ve.y,Ve.z,Ve.w):jr.set(Ve,Et,jt,Dt),oi.viewport(rt.copy(jr).multiplyScalar(kt).round())},this.getScissor=function(Ve){return Ve.copy(En)},this.setScissor=function(Ve,Et,jt,Dt){Ve.isVector4?En.set(Ve.x,Ve.y,Ve.z,Ve.w):En.set(Ve,Et,jt,Dt),oi.scissor(mt.copy(En).multiplyScalar(kt).round())},this.getScissorTest=function(){return ns},this.setScissorTest=function(Ve){oi.setScissorTest(ns=Ve)},this.setOpaqueSort=function(Ve){yi=Ve},this.setTransparentSort=function(Ve){Oi=Ve},this.getClearColor=function(Ve){return Ve.copy(zi.getClearColor())},this.setClearColor=function(){zi.setClearColor.apply(zi,arguments)},this.getClearAlpha=function(){return zi.getClearAlpha()},this.setClearAlpha=function(){zi.setClearAlpha.apply(zi,arguments)},this.clear=function(Ve=!0,Et=!0,jt=!0){let Dt=0;if(Ve){let Nt=!1;if(it!==null){const Hi=it.texture.format;Nt=Hi===ti||Hi===Mt||Hi===qt}if(Nt){const Hi=it.texture.type,Lr=Hi===yn||Hi===ct||Hi===bs||Hi===Li||Hi===Bi||Hi===ar,Nr=zi.getClearColor(),Wr=zi.getClearAlpha(),un=Nr.r,On=Nr.g,Nn=Nr.b;Lr?(te[0]=un,te[1]=On,te[2]=Nn,te[3]=Wr,tt.clearBufferuiv(tt.COLOR,0,te)):(oe[0]=un,oe[1]=On,oe[2]=Nn,oe[3]=Wr,tt.clearBufferiv(tt.COLOR,0,oe))}else Dt|=tt.COLOR_BUFFER_BIT}Et&&(Dt|=tt.DEPTH_BUFFER_BIT),jt&&(Dt|=tt.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),tt.clear(Dt)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){d.removeEventListener("webglcontextlost",Mi,!1),d.removeEventListener("webglcontextrestored",Rr,!1),d.removeEventListener("webglcontextcreationerror",nr,!1),Ft.dispose(),ui.dispose(),er.dispose(),vn.dispose(),qr.dispose(),qn.dispose(),wn.dispose(),Vr.dispose(),et.dispose(),vi.dispose(),vi.removeEventListener("sessionstart",au),vi.removeEventListener("sessionend",qG),Df.stop()};function Mi(Ve){Ve.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),nt=!0}function Rr(){console.log("THREE.WebGLRenderer: Context Restored."),nt=!1;const Ve=tr.autoReset,Et=ai.enabled,jt=ai.autoUpdate,Dt=ai.needsUpdate,Nt=ai.type;ut(),tr.autoReset=Ve,ai.enabled=Et,ai.autoUpdate=jt,ai.needsUpdate=Dt,ai.type=Nt}function nr(Ve){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",Ve.statusMessage)}function cn(Ve){const Et=Ve.target;Et.removeEventListener("dispose",cn),sr(Et)}function sr(Ve){Ji(Ve),er.remove(Ve)}function Ji(Ve){const Et=er.get(Ve).programs;Et!==void 0&&(Et.forEach(function(jt){et.releaseProgram(jt)}),Ve.isShaderMaterial&&et.releaseShaderCache(Ve))}this.renderBufferDirect=function(Ve,Et,jt,Dt,Nt,Hi){Et===null&&(Et=wi);const Lr=Nt.isMesh&&Nt.matrixWorld.determinant()<0,Nr=gRe(Ve,Et,jt,Dt,Nt);oi.setMaterial(Dt,Lr);let Wr=jt.index,un=1;if(Dt.wireframe===!0){if(Wr=Xs.getWireframeAttribute(jt),Wr===void 0)return;un=2}const On=jt.drawRange,Nn=jt.attributes.position;let Ea=On.start*un,sl=(On.start+On.count)*un;Hi!==null&&(Ea=Math.max(Ea,Hi.start*un),sl=Math.min(sl,(Hi.start+Hi.count)*un)),Wr!==null?(Ea=Math.max(Ea,0),sl=Math.min(sl,Wr.count)):Nn!=null&&(Ea=Math.max(Ea,0),sl=Math.min(sl,Nn.count));const Ql=sl-Ea;if(Ql<0||Ql===1/0)return;wn.setup(Nt,Dt,Nr,jt,Wr);let al,Es=Xn;if(Wr!==null&&(al=ha.get(Wr),Es=cr,Es.setIndex(al)),Nt.isMesh)Dt.wireframe===!0?(oi.setLineWidth(Dt.wireframeLinewidth*qi()),Es.setMode(tt.LINES)):Es.setMode(tt.TRIANGLES);else if(Nt.isLine){let Th=Dt.linewidth;Th===void 0&&(Th=1),oi.setLineWidth(Th*qi()),Nt.isLineSegments?Es.setMode(tt.LINES):Nt.isLineLoop?Es.setMode(tt.LINE_LOOP):Es.setMode(tt.LINE_STRIP)}else Nt.isPoints?Es.setMode(tt.POINTS):Nt.isSprite&&Es.setMode(tt.TRIANGLES);if(Nt.isBatchedMesh)Nt._multiDrawInstances!==null?Es.renderMultiDrawInstances(Nt._multiDrawStarts,Nt._multiDrawCounts,Nt._multiDrawCount,Nt._multiDrawInstances):Es.renderMultiDraw(Nt._multiDrawStarts,Nt._multiDrawCounts,Nt._multiDrawCount);else if(Nt.isInstancedMesh)Es.renderInstances(Ea,Ql,Nt.count);else if(jt.isInstancedBufferGeometry){const Th=jt._maxInstanceCount!==void 0?jt._maxInstanceCount:1/0,Sn=Math.min(jt.instanceCount,Th);Es.renderInstances(Ea,Ql,Sn)}else Es.render(Ea,Ql)};function xn(Ve,Et,jt){Ve.transparent===!0&&Ve.side===B&&Ve.forceSinglePass===!1?(Ve.side=R,Ve.needsUpdate=!0,Kw(Ve,Et,jt),Ve.side=S,Ve.needsUpdate=!0,Kw(Ve,Et,jt),Ve.side=B):Kw(Ve,Et,jt)}this.compile=function(Ve,Et,jt=null){jt===null&&(jt=Ve),ee=ui.get(jt),ee.init(Et),we.push(ee),jt.traverseVisible(function(Nt){Nt.isLight&&Nt.layers.test(Et.layers)&&(ee.pushLight(Nt),Nt.castShadow&&ee.pushShadow(Nt))}),Ve!==jt&&Ve.traverseVisible(function(Nt){Nt.isLight&&Nt.layers.test(Et.layers)&&(ee.pushLight(Nt),Nt.castShadow&&ee.pushShadow(Nt))}),ee.setupLights(_e._useLegacyLights);const Dt=new Set;return Ve.traverse(function(Nt){const Hi=Nt.material;if(Hi)if(Array.isArray(Hi))for(let Lr=0;Lr<Hi.length;Lr++){const Nr=Hi[Lr];xn(Nr,jt,Nt),Dt.add(Nr)}else xn(Hi,jt,Nt),Dt.add(Hi)}),we.pop(),ee=null,Dt},this.compileAsync=function(Ve,Et,jt=null){const Dt=this.compile(Ve,Et,jt);return new Promise(Nt=>{function Hi(){if(Dt.forEach(function(Lr){er.get(Lr).currentProgram.isReady()&&Dt.delete(Lr)}),Dt.size===0){Nt(Ve);return}setTimeout(Hi,10)}$t.get("KHR_parallel_shader_compile")!==null?Hi():setTimeout(Hi,10)})};let Br=null;function Wl(Ve){Br&&Br(Ve)}function au(){Df.stop()}function qG(){Df.start()}const Df=new nN;Df.setAnimationLoop(Wl),typeof self<"u"&&Df.setContext(self),this.setAnimationLoop=function(Ve){Br=Ve,vi.setAnimationLoop(Ve),Ve===null?Df.stop():Df.start()},vi.addEventListener("sessionstart",au),vi.addEventListener("sessionend",qG),this.render=function(Ve,Et){if(Et!==void 0&&Et.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(nt===!0)return;Ve.matrixWorldAutoUpdate===!0&&Ve.updateMatrixWorld(),Et.parent===null&&Et.matrixWorldAutoUpdate===!0&&Et.updateMatrixWorld(),vi.enabled===!0&&vi.isPresenting===!0&&(vi.cameraAutoUpdate===!0&&vi.updateCamera(Et),Et=vi.getCamera()),Ve.isScene===!0&&Ve.onBeforeRender(_e,Ve,Et,it),ee=ui.get(Ve,we.length),ee.init(Et),we.push(ee),Sr.multiplyMatrices(Et.projectionMatrix,Et.matrixWorldInverse),ms.setFromProjectionMatrix(Sr),Dn=this.localClippingEnabled,Gn=mi.init(this.clippingPlanes,Dn),re=Ft.get(Ve,Me.length),re.init(),Me.push(re),XG(Ve,Et,0,_e.sortObjects),re.finish(),_e.sortObjects===!0&&re.sort(yi,Oi);const jt=vi.enabled===!1||vi.isPresenting===!1||vi.hasDepthSensing()===!1;jt&&zi.addToRenderList(re,Ve),this.info.render.frame++,Gn===!0&&mi.beginShadows();const Dt=ee.state.shadowsArray;ai.render(Dt,Ve,Et),Gn===!0&&mi.endShadows(),this.info.autoReset===!0&&this.info.reset();const Nt=re.opaque,Hi=re.transmissive;if(ee.setupLights(_e._useLegacyLights),Et.isArrayCamera){const Lr=Et.cameras;if(Hi.length>0)for(let Nr=0,Wr=Lr.length;Nr<Wr;Nr++){const un=Lr[Nr];YG(Nt,Hi,Ve,un)}if(jt&&zi.render(Ve),vi.enabled&&vi.isMultiview)vr.setDeferTextureUploads(!0),nL(re,Ve,Et,Et.cameras[0].viewport);else for(let Nr=0,Wr=Lr.length;Nr<Wr;Nr++){const un=Lr[Nr];nL(re,Ve,un,un.viewport)}}else Hi.length>0&&YG(Nt,Hi,Ve,Et),jt&&zi.render(Ve),nL(re,Ve,Et);it!==null&&(vr.updateMultisampleRenderTarget(it),vr.updateRenderTargetMipmap(it)),Ve.isScene===!0&&Ve.onAfterRender(_e,Ve,Et),vr.runDeferredUploads(),vi.enabled&&vi.submitFrame&&vi.submitFrame(),wn.resetDefaultState(),ze=-1,Oe=null,we.pop(),we.length>0?(ee=we[we.length-1],Gn===!0&&mi.setGlobalState(_e.clippingPlanes,ee.state.camera)):ee=null,Me.pop(),Me.length>0?re=Me[Me.length-1]:re=null};function XG(Ve,Et,jt,Dt){if(Ve.visible===!1)return;if(Ve.layers.test(Et.layers)){if(Ve.isGroup)jt=Ve.renderOrder;else if(Ve.isLOD)Ve.autoUpdate===!0&&Ve.update(Et);else if(Ve.isLight)ee.pushLight(Ve),Ve.castShadow&&ee.pushShadow(Ve);else if(Ve.isSprite){if(!Ve.frustumCulled||ms.intersectsSprite(Ve)){Dt&&ci.setFromMatrixPosition(Ve.matrixWorld).applyMatrix4(Sr);const Hi=qn.update(Ve),Lr=Ve.material;Lr.visible&&re.push(Ve,Hi,Lr,jt,ci.z,null)}}else if((Ve.isMesh||Ve.isLine||Ve.isPoints)&&(!Ve.frustumCulled||ms.intersectsObject(Ve))){const Hi=qn.update(Ve),Lr=Ve.material;if(Dt&&(Ve.boundingSphere!==void 0?(Ve.boundingSphere===null&&Ve.computeBoundingSphere(),ci.copy(Ve.boundingSphere.center)):(Hi.boundingSphere===null&&Hi.computeBoundingSphere(),ci.copy(Hi.boundingSphere.center)),ci.applyMatrix4(Ve.matrixWorld).applyMatrix4(Sr)),Array.isArray(Lr)){const Nr=Hi.groups;for(let Wr=0,un=Nr.length;Wr<un;Wr++){const On=Nr[Wr],Nn=Lr[On.materialIndex];Nn&&Nn.visible&&re.push(Ve,Hi,Nn,jt,ci.z,On)}}else Lr.visible&&re.push(Ve,Hi,Lr,jt,ci.z,null)}}const Nt=Ve.children;for(let Hi=0,Lr=Nt.length;Hi<Lr;Hi++)XG(Nt[Hi],Et,jt,Dt)}function nL(Ve,Et,jt,Dt){const Nt=Ve.opaque,Hi=Ve.transmissive,Lr=Ve.transparent;ee.setupLightsView(jt),Gn===!0&&mi.setGlobalState(_e.clippingPlanes,jt),Dt&&oi.viewport(rt.copy(Dt)),Nt.length>0&&Yw(Nt,Et,jt),Hi.length>0&&Yw(Hi,Et,jt),Lr.length>0&&Yw(Lr,Et,jt),oi.buffers.depth.setTest(!0),oi.buffers.depth.setMask(!0),oi.buffers.color.setMask(!0),oi.setPolygonOffset(!1)}function YG(Ve,Et,jt,Dt){if((jt.isScene===!0?jt.overrideMaterial:null)!==null)return;ee.state.transmissionRenderTarget[Dt.id]===void 0&&(ee.state.transmissionRenderTarget[Dt.id]=new el(1,1,{generateMipmaps:!0,type:$t.has("EXT_color_buffer_half_float")||$t.has("EXT_color_buffer_float")?Xt:yn,minFilter:sn,samples:4,stencilBuffer:E,resolveDepthBuffer:!1,resolveStencilBuffer:!1}));const Nt=ee.state.transmissionRenderTarget[Dt.id],Hi=Dt.viewport||rt;Nt.setSize(Hi.z,Hi.w);const Lr=_e.getRenderTarget();_e.setRenderTarget(Nt),_e.getClearColor(Tt),Pt=_e.getClearAlpha(),Pt<1&&_e.setClearColor(16777215,.5),_e.clear();const Nr=_e.toneMapping;_e.toneMapping=Ot;const Wr=Dt.viewport;if(Dt.viewport!==void 0&&(Dt.viewport=void 0),ee.setupLightsView(Dt),Gn===!0&&mi.setGlobalState(_e.clippingPlanes,Dt),Yw(Ve,jt,Dt),vr.updateMultisampleRenderTarget(Nt),vr.updateRenderTargetMipmap(Nt),$t.has("WEBGL_multisampled_render_to_texture")===!1){let un=!1;for(let On=0,Nn=Et.length;On<Nn;On++){const Ea=Et[On],sl=Ea.object,Ql=Ea.geometry,al=Ea.material,Es=Ea.group;if(al.side===B&&sl.layers.test(Dt.layers)){const Th=al.side;al.side=R,al.needsUpdate=!0,KG(sl,jt,Dt,Ql,al,Es),al.side=Th,al.needsUpdate=!0,un=!0}}un===!0&&(vr.updateMultisampleRenderTarget(Nt),vr.updateRenderTargetMipmap(Nt))}_e.setRenderTarget(Lr),_e.setClearColor(Tt,Pt),Wr!==void 0&&(Dt.viewport=Wr),_e.toneMapping=Nr}function Yw(Ve,Et,jt){const Dt=Et.isScene===!0?Et.overrideMaterial:null;for(let Nt=0,Hi=Ve.length;Nt<Hi;Nt++){const Lr=Ve[Nt],Nr=Lr.object,Wr=Lr.geometry,un=Dt===null?Lr.material:Dt,On=Lr.group;Nr.layers.test(jt.layers)&&KG(Nr,Et,jt,Wr,un,On)}}function KG(Ve,Et,jt,Dt,Nt,Hi){Ve.onBeforeRender(_e,Et,jt,Dt,Nt,Hi),Ve.modelViewMatrix.multiplyMatrices(jt.matrixWorldInverse,Ve.matrixWorld),Ve.normalMatrix.getNormalMatrix(Ve.modelViewMatrix),Nt.onBeforeRender(_e,Et,jt,Dt,Ve,Hi),Nt.transparent===!0&&Nt.side===B&&Nt.forceSinglePass===!1?(Nt.side=R,Nt.needsUpdate=!0,_e.renderBufferDirect(jt,Et,Dt,Nt,Ve,Hi),Nt.side=S,Nt.needsUpdate=!0,_e.renderBufferDirect(jt,Et,Dt,Nt,Ve,Hi),Nt.side=B):_e.renderBufferDirect(jt,Et,Dt,Nt,Ve,Hi),Ve.onAfterRender(_e,Et,jt,Dt,Nt,Hi)}function Kw(Ve,Et,jt){Et.isScene!==!0&&(Et=wi);const Dt=er.get(Ve),Nt=ee.state.lights,Hi=ee.state.shadowsArray,Lr=Nt.state.version,Nr=et.getParameters(Ve,Nt.state,Hi,Et,jt),Wr=et.getProgramCacheKey(Nr);let un=Dt.programs;Dt.environment=Ve.isMeshStandardMaterial?Et.environment:null,Dt.fog=Et.fog,Dt.envMap=(Ve.isMeshStandardMaterial?qr:vn).get(Ve.envMap||Dt.environment),Dt.envMapRotation=Dt.environment!==null&&Ve.envMap===null?Et.environmentRotation:Ve.envMapRotation,un===void 0&&(Ve.addEventListener("dispose",cn),un=new Map,Dt.programs=un);let On=un.get(Wr);if(On!==void 0){if(Dt.currentProgram===On&&Dt.lightsStateVersion===Lr)return ZG(Ve,Nr),On}else Nr.uniforms=et.getUniforms(Ve),Ve.onBuild(jt,Nr,_e),Ve.onBeforeCompile(Nr,_e),On=et.acquireProgram(Nr,Wr),un.set(Wr,On),Dt.uniforms=Nr.uniforms;const Nn=Dt.uniforms;return(!Ve.isShaderMaterial&&!Ve.isRawShaderMaterial||Ve.clipping===!0)&&(Nn.clippingPlanes=mi.uniform),ZG(Ve,Nr),Dt.needsLights=yRe(Ve),Dt.lightsStateVersion=Lr,Dt.needsLights&&(Nn.ambientLightColor.value=Nt.state.ambient,Nn.lightProbe.value=Nt.state.probe,Nn.directionalLights.value=Nt.state.directional,Nn.directionalLightShadows.value=Nt.state.directionalShadow,Nn.spotLights.value=Nt.state.spot,Nn.spotLightShadows.value=Nt.state.spotShadow,Nn.rectAreaLights.value=Nt.state.rectArea,Nn.ltc_1.value=Nt.state.rectAreaLTC1,Nn.ltc_2.value=Nt.state.rectAreaLTC2,Nn.pointLights.value=Nt.state.point,Nn.pointLightShadows.value=Nt.state.pointShadow,Nn.hemisphereLights.value=Nt.state.hemi,Nn.directionalShadowMap.value=Nt.state.directionalShadowMap,Nn.directionalShadowMatrix.value=Nt.state.directionalShadowMatrix,Nn.spotShadowMap.value=Nt.state.spotShadowMap,Nn.spotLightMatrix.value=Nt.state.spotLightMatrix,Nn.spotLightMap.value=Nt.state.spotLightMap,Nn.pointShadowMap.value=Nt.state.pointShadowMap,Nn.pointShadowMatrix.value=Nt.state.pointShadowMatrix),Dt.currentProgram=On,Dt.uniformsList=null,On}function JG(Ve){if(Ve.uniformsList===null){const Et=Ve.currentProgram.getUniforms();Ve.uniformsList=ew.seqWithValue(Et.seq,Ve.uniforms)}return Ve.uniformsList}function ZG(Ve,Et){const jt=er.get(Ve);jt.outputColorSpace=Et.outputColorSpace,jt.batching=Et.batching,jt.instancing=Et.instancing,jt.instancingColor=Et.instancingColor,jt.instancingMorph=Et.instancingMorph,jt.skinning=Et.skinning,jt.morphTargets=Et.morphTargets,jt.morphNormals=Et.morphNormals,jt.morphColors=Et.morphColors,jt.morphTargetsCount=Et.morphTargetsCount,jt.numClippingPlanes=Et.numClippingPlanes,jt.numIntersection=Et.numClipIntersection,jt.vertexAlphas=Et.vertexAlphas,jt.vertexTangents=Et.vertexTangents,jt.toneMapping=Et.toneMapping,jt.numMultiviewViews=Et.numMultiviewViews}function gRe(Ve,Et,jt,Dt,Nt){Et.isScene!==!0&&(Et=wi),vr.resetTextureUnits();const Hi=Et.fog,Lr=Dt.isMeshStandardMaterial?Et.environment:null,Nr=it===null?_e.outputColorSpace:it.isXRRenderTarget===!0?it.texture.colorSpace:Ic,Wr=(Dt.isMeshStandardMaterial?qr:vn).get(Dt.envMap||Lr),un=Dt.vertexColors===!0&&!!jt.attributes.color&&jt.attributes.color.itemSize===4,On=!!jt.attributes.tangent&&(!!Dt.normalMap||Dt.anisotropy>0),Nn=!!jt.morphAttributes.position,Ea=!!jt.morphAttributes.normal,sl=!!jt.morphAttributes.color;let Ql=Ot;Dt.toneMapped&&(it===null||it.isXRRenderTarget===!0)&&(Ql=_e.toneMapping);const al=it&&it.isWebGLMultiviewRenderTarget?it.numViews:0,Es=jt.morphAttributes.position||jt.morphAttributes.normal||jt.morphAttributes.color,Th=Es!==void 0?Es.length:0,Sn=er.get(Dt),vRe=ee.state.lights;if(Gn===!0&&(Dn===!0||Ve!==Oe)){const ql=Ve===Oe&&Dt.id===ze;mi.setState(Dt,Ve,ql)}let sL=!1;Dt.version===Sn.__version?(Sn.needsLights&&Sn.lightsStateVersion!==vRe.state.version||Sn.outputColorSpace!==Nr||Nt.isBatchedMesh&&Sn.batching===!1||!Nt.isBatchedMesh&&Sn.batching===!0||Nt.isInstancedMesh&&Sn.instancing===!1||!Nt.isInstancedMesh&&Sn.instancing===!0||Nt.isSkinnedMesh&&Sn.skinning===!1||!Nt.isSkinnedMesh&&Sn.skinning===!0||Nt.isInstancedMesh&&Sn.instancingColor===!0&&Nt.instanceColor===null||Nt.isInstancedMesh&&Sn.instancingColor===!1&&Nt.instanceColor!==null||Nt.isInstancedMesh&&Sn.instancingMorph===!0&&Nt.morphTexture===null||Nt.isInstancedMesh&&Sn.instancingMorph===!1&&Nt.morphTexture!==null||Sn.envMap!==Wr||Dt.fog===!0&&Sn.fog!==Hi||Sn.numClippingPlanes!==void 0&&(Sn.numClippingPlanes!==mi.numPlanes||Sn.numIntersection!==mi.numIntersection)||Sn.vertexAlphas!==un||Sn.vertexTangents!==On||Sn.morphTargets!==Nn||Sn.morphNormals!==Ea||Sn.morphColors!==sl||Sn.toneMapping!==Ql||Sn.morphTargetsCount!==Th||Sn.numMultiviewViews!==al)&&(sL=!0):(sL=!0,Sn.__version=Dt.version);let Mh=Sn.currentProgram;sL===!0&&(Mh=Kw(Dt,Et,Nt));let $G=!1,Hv=!1,aL=!1;const wa=Mh.getUniforms(),qd=Sn.uniforms;if(oi.useProgram(Mh.program)&&($G=!0,Hv=!0,aL=!0),Dt.id!==ze&&(ze=Dt.id,Hv=!0),$G||Oe!==Ve){Mh.numMultiviewViews>0?(Ir.updateCameraProjectionMatricesUniform(Ve,wa),Ir.updateCameraViewMatricesUniform(Ve,wa)):(wa.setValue(tt,"projectionMatrix",Ve.projectionMatrix),wa.setValue(tt,"viewMatrix",Ve.matrixWorldInverse));const ql=wa.map.cameraPosition;ql!==void 0&&ql.setValue(tt,ci.setFromMatrixPosition(Ve.matrixWorld)),$i.logarithmicDepthBuffer&&wa.setValue(tt,"logDepthBufFC",2/(Math.log(Ve.far+1)/Math.LN2)),(Dt.isMeshPhongMaterial||Dt.isMeshToonMaterial||Dt.isMeshLambertMaterial||Dt.isMeshBasicMaterial||Dt.isMeshStandardMaterial||Dt.isShaderMaterial)&&wa.setValue(tt,"isOrthographic",Ve.isOrthographicCamera===!0),Oe!==Ve&&(Oe=Ve,Hv=!0,aL=!0)}if(Nt.isSkinnedMesh){wa.setOptional(tt,Nt,"bindMatrix"),wa.setOptional(tt,Nt,"bindMatrixInverse");const ql=Nt.skeleton;ql&&(ql.boneTexture===null&&ql.computeBoneTexture(),wa.setValue(tt,"boneTexture",ql.boneTexture,vr))}Nt.isBatchedMesh&&(wa.setOptional(tt,Nt,"batchingTexture"),wa.setValue(tt,"batchingTexture",Nt._matricesTexture,vr));const oL=jt.morphAttributes;if((oL.position!==void 0||oL.normal!==void 0||oL.color!==void 0)&&ur.update(Nt,jt,Mh),(Hv||Sn.receiveShadow!==Nt.receiveShadow)&&(Sn.receiveShadow=Nt.receiveShadow,wa.setValue(tt,"receiveShadow",Nt.receiveShadow)),Dt.isMeshGouraudMaterial&&Dt.envMap!==null&&(qd.envMap.value=Wr,qd.flipEnvMap.value=Wr.isCubeTexture&&Wr.isRenderTargetTexture===!1?-1:1),Dt.isMeshStandardMaterial&&Dt.envMap===null&&Et.environment!==null&&(qd.envMapIntensity.value=Et.environmentIntensity),Hv&&(wa.setValue(tt,"toneMappingExposure",_e.toneMappingExposure),Sn.needsLights&&ARe(qd,aL),Hi&&Dt.fog===!0&&De.refreshFogUniforms(qd,Hi),De.refreshMaterialUniforms(qd,Dt,kt,Di,ee.state.transmissionRenderTarget[Ve.id]),ew.upload(tt,JG(Sn),qd,vr)),Dt.isShaderMaterial&&Dt.uniformsNeedUpdate===!0&&(ew.upload(tt,JG(Sn),qd,vr),Dt.uniformsNeedUpdate=!1),Dt.isSpriteMaterial&&wa.setValue(tt,"center",Nt.center),Mh.numMultiviewViews>0?Ir.updateObjectMatricesUniforms(Nt,Ve,wa):(wa.setValue(tt,"modelViewMatrix",Nt.modelViewMatrix),wa.setValue(tt,"normalMatrix",Nt.normalMatrix)),wa.setValue(tt,"modelMatrix",Nt.matrixWorld),Dt.isShaderMaterial||Dt.isRawShaderMaterial){const ql=Dt.uniformsGroups;for(let lL=0,xRe=ql.length;lL<xRe;lL++){const eH=ql[lL];Vr.update(eH,Mh),Vr.bind(eH,Mh)}}return Mh}function ARe(Ve,Et){Ve.ambientLightColor.needsUpdate=Et,Ve.lightProbe.needsUpdate=Et,Ve.directionalLights.needsUpdate=Et,Ve.directionalLightShadows.needsUpdate=Et,Ve.pointLights.needsUpdate=Et,Ve.pointLightShadows.needsUpdate=Et,Ve.spotLights.needsUpdate=Et,Ve.spotLightShadows.needsUpdate=Et,Ve.rectAreaLights.needsUpdate=Et,Ve.hemisphereLights.needsUpdate=Et}function yRe(Ve){return Ve.isMeshLambertMaterial||Ve.isMeshToonMaterial||Ve.isMeshPhongMaterial||Ve.isMeshStandardMaterial||Ve.isShadowMaterial||Ve.isShaderMaterial&&Ve.lights===!0}this.setTexture2D=function(){var Ve=!1;return function(Et,jt){Et&&Et.isWebGLRenderTarget&&(Ve||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),Ve=!0),Et=Et.texture),vr.setTexture2D(Et,jt)}}(),this.getActiveCubeFace=function(){return qe},this.getActiveMipmapLevel=function(){return Je},this.getRenderTarget=function(){return it},this.setRenderTargetTextures=function(Ve,Et,jt){er.get(Ve.texture).__webglTexture=Et,er.get(Ve.depthTexture).__webglTexture=jt;const Dt=er.get(Ve);Dt.__hasExternalTextures=!0,Dt.__autoAllocateDepthBuffer=jt===void 0,!Dt.__autoAllocateDepthBuffer&&(!it||!it.isWebGLMultiviewRenderTarget)&&$t.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Dt.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(Ve,Et){const jt=er.get(Ve);jt.__webglFramebuffer=Et,jt.__useDefaultFramebuffer=Et===void 0},this.setRenderTarget=function(Ve,Et=0,jt=0){it=Ve,qe=Et,Je=jt;let Dt=!0,Nt=null,Hi=!1,Lr=!1;if(Ve){const Nr=er.get(Ve);Nr.__useDefaultFramebuffer!==void 0?(oi.bindFramebuffer(tt.FRAMEBUFFER,null),Dt=!1):Nr.__webglFramebuffer===void 0?vr.setupRenderTarget(Ve):Nr.__hasExternalTextures&&vr.rebindTextures(Ve,er.get(Ve.texture).__webglTexture,er.get(Ve.depthTexture).__webglTexture);const Wr=Ve.texture;(Wr.isData3DTexture||Wr.isDataArrayTexture||Wr.isCompressedArrayTexture)&&(Lr=!0);const un=er.get(Ve).__webglFramebuffer;Ve.isWebGLCubeRenderTarget?(Array.isArray(un[Et])?Nt=un[Et][jt]:Nt=un[Et],Hi=!0):Ve.samples>0&&vr.useMultisampledRTT(Ve)===!1?Nt=er.get(Ve).__webglMultisampledFramebuffer:Array.isArray(un)?Nt=un[jt]:Nt=un,rt.copy(Ve.viewport),mt.copy(Ve.scissor),pt=Ve.scissorTest}else rt.copy(jr).multiplyScalar(kt).floor(),mt.copy(En).multiplyScalar(kt).floor(),pt=ns;if(oi.bindFramebuffer(tt.FRAMEBUFFER,Nt)&&Dt&&oi.drawBuffers(Ve,Nt),oi.viewport(rt),oi.scissor(mt),oi.setScissorTest(pt),Hi){const Nr=er.get(Ve.texture);tt.framebufferTexture2D(tt.FRAMEBUFFER,tt.COLOR_ATTACHMENT0,tt.TEXTURE_CUBE_MAP_POSITIVE_X+Et,Nr.__webglTexture,jt)}else if(Lr){const Nr=er.get(Ve.texture),Wr=Et||0;tt.framebufferTextureLayer(tt.FRAMEBUFFER,tt.COLOR_ATTACHMENT0,Nr.__webglTexture,jt||0,Wr)}ze=-1},this.readRenderTargetPixels=function(Ve,Et,jt,Dt,Nt,Hi,Lr){if(!(Ve&&Ve.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Nr=er.get(Ve).__webglFramebuffer;if(Ve.isWebGLCubeRenderTarget&&Lr!==void 0&&(Nr=Nr[Lr]),Nr){oi.bindFramebuffer(tt.FRAMEBUFFER,Nr);try{const Wr=Ve.texture,un=Wr.format,On=Wr.type;if(!$i.textureFormatReadable(un)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!$i.textureTypeReadable(On)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Et>=0&&Et<=Ve.width-Dt&&jt>=0&&jt<=Ve.height-Nt&&tt.readPixels(Et,jt,Dt,Nt,wr.convert(un),wr.convert(On),Hi)}finally{const Wr=it!==null?er.get(it).__webglFramebuffer:null;oi.bindFramebuffer(tt.FRAMEBUFFER,Wr)}}},this.copyFramebufferToTexture=function(Ve,Et,jt=0){const Dt=Math.pow(2,-jt),Nt=Math.floor(Et.image.width*Dt),Hi=Math.floor(Et.image.height*Dt);vr.setTexture2D(Et,0),tt.copyTexSubImage2D(tt.TEXTURE_2D,jt,0,0,Ve.x,Ve.y,Nt,Hi),oi.unbindTexture()},this.copyTextureToTexture=function(Ve,Et,jt,Dt=0){const Nt=Et.image.width,Hi=Et.image.height,Lr=wr.convert(jt.format),Nr=wr.convert(jt.type);vr.setTexture2D(jt,0),tt.pixelStorei(tt.UNPACK_FLIP_Y_WEBGL,jt.flipY),tt.pixelStorei(tt.UNPACK_PREMULTIPLY_ALPHA_WEBGL,jt.premultiplyAlpha),tt.pixelStorei(tt.UNPACK_ALIGNMENT,jt.unpackAlignment),Et.isDataTexture?tt.texSubImage2D(tt.TEXTURE_2D,Dt,Ve.x,Ve.y,Nt,Hi,Lr,Nr,Et.image.data):Et.isCompressedTexture?tt.compressedTexSubImage2D(tt.TEXTURE_2D,Dt,Ve.x,Ve.y,Et.mipmaps[0].width,Et.mipmaps[0].height,Lr,Et.mipmaps[0].data):tt.texSubImage2D(tt.TEXTURE_2D,Dt,Ve.x,Ve.y,Lr,Nr,Et.image),Dt===0&&jt.generateMipmaps&&tt.generateMipmap(tt.TEXTURE_2D),oi.unbindTexture()},this.copyTextureToTexture3D=function(Ve,Et,jt,Dt,Nt=0){const Hi=Ve.max.x-Ve.min.x,Lr=Ve.max.y-Ve.min.y,Nr=Ve.max.z-Ve.min.z,Wr=wr.convert(Dt.format),un=wr.convert(Dt.type);let On;if(Dt.isData3DTexture)vr.setTexture3D(Dt,0),On=tt.TEXTURE_3D;else if(Dt.isDataArrayTexture||Dt.isCompressedArrayTexture)vr.setTexture2DArray(Dt,0),On=tt.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}tt.pixelStorei(tt.UNPACK_FLIP_Y_WEBGL,Dt.flipY),tt.pixelStorei(tt.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Dt.premultiplyAlpha),tt.pixelStorei(tt.UNPACK_ALIGNMENT,Dt.unpackAlignment);const Nn=tt.getParameter(tt.UNPACK_ROW_LENGTH),Ea=tt.getParameter(tt.UNPACK_IMAGE_HEIGHT),sl=tt.getParameter(tt.UNPACK_SKIP_PIXELS),Ql=tt.getParameter(tt.UNPACK_SKIP_ROWS),al=tt.getParameter(tt.UNPACK_SKIP_IMAGES),Es=jt.isCompressedTexture?jt.mipmaps[Nt]:jt.image;tt.pixelStorei(tt.UNPACK_ROW_LENGTH,Es.width),tt.pixelStorei(tt.UNPACK_IMAGE_HEIGHT,Es.height),tt.pixelStorei(tt.UNPACK_SKIP_PIXELS,Ve.min.x),tt.pixelStorei(tt.UNPACK_SKIP_ROWS,Ve.min.y),tt.pixelStorei(tt.UNPACK_SKIP_IMAGES,Ve.min.z),jt.isDataTexture||jt.isData3DTexture?tt.texSubImage3D(On,Nt,Et.x,Et.y,Et.z,Hi,Lr,Nr,Wr,un,Es.data):Dt.isCompressedArrayTexture?tt.compressedTexSubImage3D(On,Nt,Et.x,Et.y,Et.z,Hi,Lr,Nr,Wr,Es.data):tt.texSubImage3D(On,Nt,Et.x,Et.y,Et.z,Hi,Lr,Nr,Wr,un,Es),tt.pixelStorei(tt.UNPACK_ROW_LENGTH,Nn),tt.pixelStorei(tt.UNPACK_IMAGE_HEIGHT,Ea),tt.pixelStorei(tt.UNPACK_SKIP_PIXELS,sl),tt.pixelStorei(tt.UNPACK_SKIP_ROWS,Ql),tt.pixelStorei(tt.UNPACK_SKIP_IMAGES,al),Nt===0&&Dt.generateMipmaps&&tt.generateMipmap(On),oi.unbindTexture()},this.initTexture=function(Ve){Ve.isCubeTexture?vr.setTextureCube(Ve,0):Ve.isData3DTexture?vr.setTexture3D(Ve,0):Ve.isDataArrayTexture||Ve.isCompressedArrayTexture?vr.setTexture2DArray(Ve,0):vr.setTexture2D(Ve,0),oi.unbindTexture()},this.resetState=function(){qe=0,Je=0,it=null,oi.reset(),wn.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Vl}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(a){this._outputColorSpace=a;const d=this.getContext();d.drawingBufferColorSpace=a===Zg?"display-p3":"srgb",d.unpackColorSpace=Zn.workingColorSpace===af?"display-p3":"srgb"}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(a){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=a}}class tw{constructor(a,d=25e-5){this.isFogExp2=!0,this.name="",this.color=new lr(a),this.density=d}clone(){return new tw(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class iw{constructor(a,d=1,A=1e3){this.isFog=!0,this.name="",this.color=new lr(a),this.near=d,this.far=A}clone(){return new iw(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class oV extends Qn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Sl,this.environmentIntensity=1,this.environmentRotation=new Sl,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(a,d){return super.copy(a,d),a.background!==null&&(this.background=a.background.clone()),a.environment!==null&&(this.environment=a.environment.clone()),a.fog!==null&&(this.fog=a.fog.clone()),this.backgroundBlurriness=a.backgroundBlurriness,this.backgroundIntensity=a.backgroundIntensity,this.backgroundRotation.copy(a.backgroundRotation),this.environmentIntensity=a.environmentIntensity,this.environmentRotation.copy(a.environmentRotation),a.overrideMaterial!==null&&(this.overrideMaterial=a.overrideMaterial.clone()),this.matrixAutoUpdate=a.matrixAutoUpdate,this}toJSON(a){const d=super.toJSON(a);return this.fog!==null&&(d.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(d.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(d.object.backgroundIntensity=this.backgroundIntensity),d.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(d.object.environmentIntensity=this.environmentIntensity),d.object.environmentRotation=this.environmentRotation.toArray(),d}}class rw{constructor(a,d){this.isInterleavedBuffer=!0,this.array=a,this.stride=d,this.count=a!==void 0?a.length/d:0,this.usage=uf,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=Bo()}onUploadCallback(){}set needsUpdate(a){a===!0&&this.version++}get updateRange(){return IE("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(a){return this.usage=a,this}addUpdateRange(a,d){this.updateRanges.push({start:a,count:d})}clearUpdateRanges(){this.updateRanges.length=0}copy(a){return this.array=new a.array.constructor(a.array),this.count=a.count,this.stride=a.stride,this.usage=a.usage,this}copyAt(a,d,A){a*=this.stride,A*=d.stride;for(let b=0,E=this.stride;b<E;b++)this.array[a+b]=d.array[A+b];return this}set(a,d=0){return this.array.set(a,d),this}clone(a){a.arrayBuffers===void 0&&(a.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Bo()),a.arrayBuffers[this.array.buffer._uuid]===void 0&&(a.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const d=new this.array.constructor(a.arrayBuffers[this.array.buffer._uuid]),A=new this.constructor(d,this.stride);return A.setUsage(this.usage),A}onUpload(a){return this.onUploadCallback=a,this}toJSON(a){return a.arrayBuffers===void 0&&(a.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Bo()),a.arrayBuffers[this.array.buffer._uuid]===void 0&&(a.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Do=new He;class _f{constructor(a,d,A,b=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=a,this.itemSize=d,this.offset=A,this.normalized=b}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(a){this.data.needsUpdate=a}applyMatrix4(a){for(let d=0,A=this.data.count;d<A;d++)Do.fromBufferAttribute(this,d),Do.applyMatrix4(a),this.setXYZ(d,Do.x,Do.y,Do.z);return this}applyNormalMatrix(a){for(let d=0,A=this.count;d<A;d++)Do.fromBufferAttribute(this,d),Do.applyNormalMatrix(a),this.setXYZ(d,Do.x,Do.y,Do.z);return this}transformDirection(a){for(let d=0,A=this.count;d<A;d++)Do.fromBufferAttribute(this,d),Do.transformDirection(a),this.setXYZ(d,Do.x,Do.y,Do.z);return this}getComponent(a,d){let A=this.array[a*this.data.stride+this.offset+d];return this.normalized&&(A=Ya(A,this.array)),A}setComponent(a,d,A){return this.normalized&&(A=Zr(A,this.array)),this.data.array[a*this.data.stride+this.offset+d]=A,this}setX(a,d){return this.normalized&&(d=Zr(d,this.array)),this.data.array[a*this.data.stride+this.offset]=d,this}setY(a,d){return this.normalized&&(d=Zr(d,this.array)),this.data.array[a*this.data.stride+this.offset+1]=d,this}setZ(a,d){return this.normalized&&(d=Zr(d,this.array)),this.data.array[a*this.data.stride+this.offset+2]=d,this}setW(a,d){return this.normalized&&(d=Zr(d,this.array)),this.data.array[a*this.data.stride+this.offset+3]=d,this}getX(a){let d=this.data.array[a*this.data.stride+this.offset];return this.normalized&&(d=Ya(d,this.array)),d}getY(a){let d=this.data.array[a*this.data.stride+this.offset+1];return this.normalized&&(d=Ya(d,this.array)),d}getZ(a){let d=this.data.array[a*this.data.stride+this.offset+2];return this.normalized&&(d=Ya(d,this.array)),d}getW(a){let d=this.data.array[a*this.data.stride+this.offset+3];return this.normalized&&(d=Ya(d,this.array)),d}setXY(a,d,A){return a=a*this.data.stride+this.offset,this.normalized&&(d=Zr(d,this.array),A=Zr(A,this.array)),this.data.array[a+0]=d,this.data.array[a+1]=A,this}setXYZ(a,d,A,b){return a=a*this.data.stride+this.offset,this.normalized&&(d=Zr(d,this.array),A=Zr(A,this.array),b=Zr(b,this.array)),this.data.array[a+0]=d,this.data.array[a+1]=A,this.data.array[a+2]=b,this}setXYZW(a,d,A,b,E){return a=a*this.data.stride+this.offset,this.normalized&&(d=Zr(d,this.array),A=Zr(A,this.array),b=Zr(b,this.array),E=Zr(E,this.array)),this.data.array[a+0]=d,this.data.array[a+1]=A,this.data.array[a+2]=b,this.data.array[a+3]=E,this}clone(a){if(a===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const d=[];for(let A=0;A<this.count;A++){const b=A*this.data.stride+this.offset;for(let E=0;E<this.itemSize;E++)d.push(this.data.array[b+E])}return new ls(new this.array.constructor(d),this.itemSize,this.normalized)}else return a.interleavedBuffers===void 0&&(a.interleavedBuffers={}),a.interleavedBuffers[this.data.uuid]===void 0&&(a.interleavedBuffers[this.data.uuid]=this.data.clone(a)),new _f(a.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(a){if(a===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const d=[];for(let A=0;A<this.count;A++){const b=A*this.data.stride+this.offset;for(let E=0;E<this.itemSize;E++)d.push(this.data.array[b+E])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:d,normalized:this.normalized}}else return a.interleavedBuffers===void 0&&(a.interleavedBuffers={}),a.interleavedBuffers[this.data.uuid]===void 0&&(a.interleavedBuffers[this.data.uuid]=this.data.toJSON(a)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class vN extends po{constructor(a){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new lr(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.color.copy(a.color),this.map=a.map,this.alphaMap=a.alphaMap,this.rotation=a.rotation,this.sizeAttenuation=a.sizeAttenuation,this.fog=a.fog,this}}let _0;const _v=new He,E0=new He,w0=new He,C0=new si,Ev=new si,lV=new mr,nw=new He,wv=new He,sw=new He,cV=new si,xN=new si,uV=new si;class hV extends Qn{constructor(a=new vN){if(super(),this.isSprite=!0,this.type="Sprite",_0===void 0){_0=new fn;const d=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),A=new rw(d,5);_0.setIndex([0,1,2,0,2,3]),_0.setAttribute("position",new _f(A,3,0,!1)),_0.setAttribute("uv",new _f(A,2,3,!1))}this.geometry=_0,this.material=a,this.center=new si(.5,.5)}raycast(a,d){a.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),E0.setFromMatrixScale(this.matrixWorld),lV.copy(a.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(a.camera.matrixWorldInverse,this.matrixWorld),w0.setFromMatrixPosition(this.modelViewMatrix),a.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&E0.multiplyScalar(-w0.z);const A=this.material.rotation;let b,E;A!==0&&(E=Math.cos(A),b=Math.sin(A));const M=this.center;aw(nw.set(-.5,-.5,0),w0,M,E0,b,E),aw(wv.set(.5,-.5,0),w0,M,E0,b,E),aw(sw.set(.5,.5,0),w0,M,E0,b,E),cV.set(0,0),xN.set(1,0),uV.set(1,1);let N=a.ray.intersectTriangle(nw,wv,sw,!1,_v);if(N===null&&(aw(wv.set(-.5,.5,0),w0,M,E0,b,E),xN.set(0,1),N=a.ray.intersectTriangle(nw,sw,wv,!1,_v),N===null))return;const P=a.ray.origin.distanceTo(_v);P<a.near||P>a.far||d.push({distance:P,point:_v.clone(),uv:Tl.getInterpolation(_v,nw,wv,sw,cV,xN,uV,new si),face:null,object:this})}copy(a,d){return super.copy(a,d),a.center!==void 0&&this.center.copy(a.center),this.material=a.material,this}}function aw(C,a,d,A,b,E){C0.subVectors(C,d).addScalar(.5).multiply(A),b!==void 0?(Ev.x=E*C0.x-b*C0.y,Ev.y=b*C0.x+E*C0.y):Ev.copy(C0),C.copy(a),C.x+=Ev.x,C.y+=Ev.y,C.applyMatrix4(lV)}const ow=new He,dV=new He;class pV extends Qn{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(a){super.copy(a,!1);const d=a.levels;for(let A=0,b=d.length;A<b;A++){const E=d[A];this.addLevel(E.object.clone(),E.distance,E.hysteresis)}return this.autoUpdate=a.autoUpdate,this}addLevel(a,d=0,A=0){d=Math.abs(d);const b=this.levels;let E;for(E=0;E<b.length&&!(d<b[E].distance);E++);return b.splice(E,0,{distance:d,hysteresis:A,object:a}),this.add(a),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(a){const d=this.levels;if(d.length>0){let A,b;for(A=1,b=d.length;A<b;A++){let E=d[A].distance;if(d[A].object.visible&&(E-=E*d[A].hysteresis),a<E)break}return d[A-1].object}return null}raycast(a,d){if(this.levels.length>0){ow.setFromMatrixPosition(this.matrixWorld);const A=a.ray.origin.distanceTo(ow);this.getObjectForDistance(A).raycast(a,d)}}update(a){const d=this.levels;if(d.length>1){ow.setFromMatrixPosition(a.matrixWorld),dV.setFromMatrixPosition(this.matrixWorld);const A=ow.distanceTo(dV)/a.zoom;d[0].object.visible=!0;let b,E;for(b=1,E=d.length;b<E;b++){let M=d[b].distance;if(d[b].object.visible&&(M-=M*d[b].hysteresis),A>=M)d[b-1].object.visible=!1,d[b].object.visible=!0;else break}for(this._currentLevel=b-1;b<E;b++)d[b].object.visible=!1}}toJSON(a){const d=super.toJSON(a);this.autoUpdate===!1&&(d.object.autoUpdate=!1),d.object.levels=[];const A=this.levels;for(let b=0,E=A.length;b<E;b++){const M=A[b];d.object.levels.push({object:M.object.uuid,distance:M.distance,hysteresis:M.hysteresis})}return d}}const fV=new He,mV=new jn,gV=new jn,EMe=new He,AV=new mr,lw=new He,bN=new ya,yV=new mr,_N=new va;class vV extends ua{constructor(a,d){super(a,d),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=Te,this.bindMatrix=new mr,this.bindMatrixInverse=new mr,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const a=this.geometry;this.boundingBox===null&&(this.boundingBox=new Ds),this.boundingBox.makeEmpty();const d=a.getAttribute("position");for(let A=0;A<d.count;A++)this.getVertexPosition(A,lw),this.boundingBox.expandByPoint(lw)}computeBoundingSphere(){const a=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new ya),this.boundingSphere.makeEmpty();const d=a.getAttribute("position");for(let A=0;A<d.count;A++)this.getVertexPosition(A,lw),this.boundingSphere.expandByPoint(lw)}copy(a,d){return super.copy(a,d),this.bindMode=a.bindMode,this.bindMatrix.copy(a.bindMatrix),this.bindMatrixInverse.copy(a.bindMatrixInverse),this.skeleton=a.skeleton,a.boundingBox!==null&&(this.boundingBox=a.boundingBox.clone()),a.boundingSphere!==null&&(this.boundingSphere=a.boundingSphere.clone()),this}raycast(a,d){const A=this.material,b=this.matrixWorld;A!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),bN.copy(this.boundingSphere),bN.applyMatrix4(b),a.ray.intersectsSphere(bN)!==!1&&(yV.copy(b).invert(),_N.copy(a.ray).applyMatrix4(yV),!(this.boundingBox!==null&&_N.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(a,d,_N)))}getVertexPosition(a,d){return super.getVertexPosition(a,d),this.applyBoneTransform(a,d),d}bind(a,d){this.skeleton=a,d===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),d=this.matrixWorld),this.bindMatrix.copy(d),this.bindMatrixInverse.copy(d).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const a=new jn,d=this.geometry.attributes.skinWeight;for(let A=0,b=d.count;A<b;A++){a.fromBufferAttribute(d,A);const E=1/a.manhattanLength();E!==1/0?a.multiplyScalar(E):a.set(1,0,0,0),d.setXYZW(A,a.x,a.y,a.z,a.w)}}updateMatrixWorld(a){super.updateMatrixWorld(a),this.bindMode===Te?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===ke?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(a,d){const A=this.skeleton,b=this.geometry;mV.fromBufferAttribute(b.attributes.skinIndex,a),gV.fromBufferAttribute(b.attributes.skinWeight,a),fV.copy(d).applyMatrix4(this.bindMatrix),d.set(0,0,0);for(let E=0;E<4;E++){const M=gV.getComponent(E);if(M!==0){const N=mV.getComponent(E);AV.multiplyMatrices(A.bones[N].matrixWorld,A.boneInverses[N]),d.addScaledVector(EMe.copy(fV).applyMatrix4(AV),M)}}return d.applyMatrix4(this.bindMatrixInverse)}}class EN extends Qn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class jd extends fs{constructor(a=null,d=1,A=1,b,E,M,N,P,k=It,j=It,X,q){super(null,M,N,P,k,j,b,E,X,q),this.isDataTexture=!0,this.image={data:a,width:d,height:A},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const xV=new mr,wMe=new mr;class cw{constructor(a=[],d=[]){this.uuid=Bo(),this.bones=a.slice(0),this.boneInverses=d,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const a=this.bones,d=this.boneInverses;if(this.boneMatrices=new Float32Array(a.length*16),d.length===0)this.calculateInverses();else if(a.length!==d.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let A=0,b=this.bones.length;A<b;A++)this.boneInverses.push(new mr)}}calculateInverses(){this.boneInverses.length=0;for(let a=0,d=this.bones.length;a<d;a++){const A=new mr;this.bones[a]&&A.copy(this.bones[a].matrixWorld).invert(),this.boneInverses.push(A)}}pose(){for(let a=0,d=this.bones.length;a<d;a++){const A=this.bones[a];A&&A.matrixWorld.copy(this.boneInverses[a]).invert()}for(let a=0,d=this.bones.length;a<d;a++){const A=this.bones[a];A&&(A.parent&&A.parent.isBone?(A.matrix.copy(A.parent.matrixWorld).invert(),A.matrix.multiply(A.matrixWorld)):A.matrix.copy(A.matrixWorld),A.matrix.decompose(A.position,A.quaternion,A.scale))}}update(){const a=this.bones,d=this.boneInverses,A=this.boneMatrices,b=this.boneTexture;for(let E=0,M=a.length;E<M;E++){const N=a[E]?a[E].matrixWorld:wMe;xV.multiplyMatrices(N,d[E]),xV.toArray(A,E*16)}b!==null&&(b.needsUpdate=!0)}clone(){return new cw(this.bones,this.boneInverses)}computeBoneTexture(){let a=Math.sqrt(this.bones.length*4);a=Math.ceil(a/4)*4,a=Math.max(a,4);const d=new Float32Array(a*a*4);d.set(this.boneMatrices);const A=new jd(d,a,a,ge,St);return A.needsUpdate=!0,this.boneMatrices=d,this.boneTexture=A,this}getBoneByName(a){for(let d=0,A=this.bones.length;d<A;d++){const b=this.bones[d];if(b.name===a)return b}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(a,d){this.uuid=a.uuid;for(let A=0,b=a.bones.length;A<b;A++){const E=a.bones[A];let M=d[E];M===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",E),M=new EN),this.bones.push(M),this.boneInverses.push(new mr().fromArray(a.boneInverses[A]))}return this.init(),this}toJSON(){const a={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};a.uuid=this.uuid;const d=this.bones,A=this.boneInverses;for(let b=0,E=d.length;b<E;b++){const M=d[b];a.bones.push(M.uuid);const N=A[b];a.boneInverses.push(N.toArray())}return a}}class S0 extends ls{constructor(a,d,A,b=1){super(a,d,A),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=b}copy(a){return super.copy(a),this.meshPerAttribute=a.meshPerAttribute,this}toJSON(){const a=super.toJSON();return a.meshPerAttribute=this.meshPerAttribute,a.isInstancedBufferAttribute=!0,a}}const T0=new mr,bV=new mr,uw=[],_V=new Ds,CMe=new mr,Cv=new ua,Sv=new ya;class EV extends ua{constructor(a,d,A){super(a,d),this.isInstancedMesh=!0,this.instanceMatrix=new S0(new Float32Array(A*16),16),this.instanceColor=null,this.morphTexture=null,this.count=A,this.boundingBox=null,this.boundingSphere=null;for(let b=0;b<A;b++)this.setMatrixAt(b,CMe)}computeBoundingBox(){const a=this.geometry,d=this.count;this.boundingBox===null&&(this.boundingBox=new Ds),a.boundingBox===null&&a.computeBoundingBox(),this.boundingBox.makeEmpty();for(let A=0;A<d;A++)this.getMatrixAt(A,T0),_V.copy(a.boundingBox).applyMatrix4(T0),this.boundingBox.union(_V)}computeBoundingSphere(){const a=this.geometry,d=this.count;this.boundingSphere===null&&(this.boundingSphere=new ya),a.boundingSphere===null&&a.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let A=0;A<d;A++)this.getMatrixAt(A,T0),Sv.copy(a.boundingSphere).applyMatrix4(T0),this.boundingSphere.union(Sv)}copy(a,d){return super.copy(a,d),this.instanceMatrix.copy(a.instanceMatrix),a.morphTexture!==null&&(this.morphTexture=a.morphTexture.clone()),a.instanceColor!==null&&(this.instanceColor=a.instanceColor.clone()),this.count=a.count,a.boundingBox!==null&&(this.boundingBox=a.boundingBox.clone()),a.boundingSphere!==null&&(this.boundingSphere=a.boundingSphere.clone()),this}getColorAt(a,d){d.fromArray(this.instanceColor.array,a*3)}getMatrixAt(a,d){d.fromArray(this.instanceMatrix.array,a*16)}getMorphAt(a,d){const A=d.morphTargetInfluences,b=this.morphTexture.source.data.data,E=A.length+1,M=a*E+1;for(let N=0;N<A.length;N++)A[N]=b[M+N]}raycast(a,d){const A=this.matrixWorld,b=this.count;if(Cv.geometry=this.geometry,Cv.material=this.material,Cv.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Sv.copy(this.boundingSphere),Sv.applyMatrix4(A),a.ray.intersectsSphere(Sv)!==!1))for(let E=0;E<b;E++){this.getMatrixAt(E,T0),bV.multiplyMatrices(A,T0),Cv.matrixWorld=bV,Cv.raycast(a,uw);for(let M=0,N=uw.length;M<N;M++){const P=uw[M];P.instanceId=E,P.object=this,d.push(P)}uw.length=0}}setColorAt(a,d){this.instanceColor===null&&(this.instanceColor=new S0(new Float32Array(this.instanceMatrix.count*3),3)),d.toArray(this.instanceColor.array,a*3)}setMatrixAt(a,d){d.toArray(this.instanceMatrix.array,a*16)}setMorphAt(a,d){const A=d.morphTargetInfluences,b=A.length+1;this.morphTexture===null&&(this.morphTexture=new jd(new Float32Array(b*this.count),b,this.count,wt,St));const E=this.morphTexture.source.data.data;let M=0;for(let k=0;k<A.length;k++)M+=A[k];const N=this.geometry.morphTargetsRelative?1:1-M,P=b*a;E[P]=N,E.set(A,P+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null),this}}function SMe(C,a){return C.z-a.z}function TMe(C,a){return a.z-C.z}class MMe{constructor(){this.index=0,this.pool=[],this.list=[]}push(a,d){const A=this.pool,b=this.list;this.index>=A.length&&A.push({start:-1,count:-1,z:-1});const E=A[this.index];b.push(E),this.index++,E.start=a.start,E.count=a.count,E.z=d}reset(){this.list.length=0,this.index=0}}const M0="batchId",Vd=new mr,wV=new mr,RMe=new mr,CV=new mr,wN=new xv,hw=new Ds,Ef=new ya,Tv=new He,CN=new MMe,fo=new ua,dw=[];function IMe(C,a,d=0){const A=a.itemSize;if(C.isInterleavedBufferAttribute||C.array.constructor!==a.array.constructor){const b=C.count;for(let E=0;E<b;E++)for(let M=0;M<A;M++)a.setComponent(E+d,M,C.getComponent(E,M))}else a.array.set(C.array,d*A);a.needsUpdate=!0}class SV extends ua{get maxGeometryCount(){return this._maxGeometryCount}constructor(a,d,A=d*2,b){super(new fn,b),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._drawRanges=[],this._reservedRanges=[],this._visibility=[],this._active=[],this._bounds=[],this._maxGeometryCount=a,this._maxVertexCount=d,this._maxIndexCount=A,this._geometryInitialized=!1,this._geometryCount=0,this._multiDrawCounts=new Int32Array(a),this._multiDrawStarts=new Int32Array(a),this._multiDrawCount=0,this._multiDrawInstances=null,this._visibilityChanged=!0,this._matricesTexture=null,this._initMatricesTexture()}_initMatricesTexture(){let a=Math.sqrt(this._maxGeometryCount*4);a=Math.ceil(a/4)*4,a=Math.max(a,4);const d=new Float32Array(a*a*4),A=new jd(d,a,a,ge,St);this._matricesTexture=A}_initializeGeometry(a){const d=this.geometry,A=this._maxVertexCount,b=this._maxGeometryCount,E=this._maxIndexCount;if(this._geometryInitialized===!1){for(const N in a.attributes){const P=a.getAttribute(N),{array:k,itemSize:j,normalized:X}=P,q=new k.constructor(A*j),K=new ls(q,j,X);d.setAttribute(N,K)}if(a.getIndex()!==null){const N=A>65536?new Uint32Array(E):new Uint16Array(E);d.setIndex(new ls(N,1))}const M=b>65536?new Uint32Array(A):new Uint16Array(A);d.setAttribute(M0,new ls(M,1)),this._geometryInitialized=!0}}_validateGeometry(a){if(a.getAttribute(M0))throw new Error(`BatchedMesh: Geometry cannot use attribute "${M0}"`);const d=this.geometry;if(!!a.getIndex()!=!!d.getIndex())throw new Error('BatchedMesh: All geometries must consistently have "index".');for(const A in d.attributes){if(A===M0)continue;if(!a.hasAttribute(A))throw new Error(`BatchedMesh: Added geometry missing "${A}". All geometries must have consistent attributes.`);const b=a.getAttribute(A),E=d.getAttribute(A);if(b.itemSize!==E.itemSize||b.normalized!==E.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(a){return this.customSort=a,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Ds);const a=this._geometryCount,d=this.boundingBox,A=this._active;d.makeEmpty();for(let b=0;b<a;b++)A[b]!==!1&&(this.getMatrixAt(b,Vd),this.getBoundingBoxAt(b,hw).applyMatrix4(Vd),d.union(hw))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new ya);const a=this._geometryCount,d=this.boundingSphere,A=this._active;d.makeEmpty();for(let b=0;b<a;b++)A[b]!==!1&&(this.getMatrixAt(b,Vd),this.getBoundingSphereAt(b,Ef).applyMatrix4(Vd),d.union(Ef))}addGeometry(a,d=-1,A=-1){if(this._initializeGeometry(a),this._validateGeometry(a),this._geometryCount>=this._maxGeometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");const b={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1};let E=null;const M=this._reservedRanges,N=this._drawRanges,P=this._bounds;this._geometryCount!==0&&(E=M[M.length-1]),d===-1?b.vertexCount=a.getAttribute("position").count:b.vertexCount=d,E===null?b.vertexStart=0:b.vertexStart=E.vertexStart+E.vertexCount;const k=a.getIndex(),j=k!==null;if(j&&(A===-1?b.indexCount=k.count:b.indexCount=A,E===null?b.indexStart=0:b.indexStart=E.indexStart+E.indexCount),b.indexStart!==-1&&b.indexStart+b.indexCount>this._maxIndexCount||b.vertexStart+b.vertexCount>this._maxVertexCount)throw new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");const X=this._visibility,q=this._active,K=this._matricesTexture,te=this._matricesTexture.image.data;X.push(!0),q.push(!0);const oe=this._geometryCount;this._geometryCount++,RMe.toArray(te,oe*16),K.needsUpdate=!0,M.push(b),N.push({start:j?b.indexStart:b.vertexStart,count:-1}),P.push({boxInitialized:!1,box:new Ds,sphereInitialized:!1,sphere:new ya});const re=this.geometry.getAttribute(M0);for(let ee=0;ee<b.vertexCount;ee++)re.setX(b.vertexStart+ee,oe);return re.needsUpdate=!0,this.setGeometryAt(oe,a),oe}setGeometryAt(a,d){if(a>=this._geometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(d);const A=this.geometry,b=A.getIndex()!==null,E=A.getIndex(),M=d.getIndex(),N=this._reservedRanges[a];if(b&&M.count>N.indexCount||d.attributes.position.count>N.vertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");const P=N.vertexStart,k=N.vertexCount;for(const K in A.attributes){if(K===M0)continue;const te=d.getAttribute(K),oe=A.getAttribute(K);IMe(te,oe,P);const re=te.itemSize;for(let ee=te.count,Me=k;ee<Me;ee++){const we=P+ee;for(let _e=0;_e<re;_e++)oe.setComponent(we,_e,0)}oe.needsUpdate=!0,oe.addUpdateRange(P*re,k*re)}if(b){const K=N.indexStart;for(let te=0;te<M.count;te++)E.setX(K+te,P+M.getX(te));for(let te=M.count,oe=N.indexCount;te<oe;te++)E.setX(K+te,P);E.needsUpdate=!0,E.addUpdateRange(K,N.indexCount)}const j=this._bounds[a];d.boundingBox!==null?(j.box.copy(d.boundingBox),j.boxInitialized=!0):j.boxInitialized=!1,d.boundingSphere!==null?(j.sphere.copy(d.boundingSphere),j.sphereInitialized=!0):j.sphereInitialized=!1;const X=this._drawRanges[a],q=d.getAttribute("position");return X.count=b?M.count:q.count,this._visibilityChanged=!0,a}deleteGeometry(a){const d=this._active;return a>=d.length||d[a]===!1?this:(d[a]=!1,this._visibilityChanged=!0,this)}getInstanceCountAt(a){return this._multiDrawInstances===null?null:this._multiDrawInstances[a]}setInstanceCountAt(a,d){return this._multiDrawInstances===null&&(this._multiDrawInstances=new Int32Array(this._maxGeometryCount).fill(1)),this._multiDrawInstances[a]=d,a}getBoundingBoxAt(a,d){if(this._active[a]===!1)return null;const A=this._bounds[a],b=A.box,E=this.geometry;if(A.boxInitialized===!1){b.makeEmpty();const M=E.index,N=E.attributes.position,P=this._drawRanges[a];for(let k=P.start,j=P.start+P.count;k<j;k++){let X=k;M&&(X=M.getX(X)),b.expandByPoint(Tv.fromBufferAttribute(N,X))}A.boxInitialized=!0}return d.copy(b),d}getBoundingSphereAt(a,d){if(this._active[a]===!1)return null;const A=this._bounds[a],b=A.sphere,E=this.geometry;if(A.sphereInitialized===!1){b.makeEmpty(),this.getBoundingBoxAt(a,hw),hw.getCenter(b.center);const M=E.index,N=E.attributes.position,P=this._drawRanges[a];let k=0;for(let j=P.start,X=P.start+P.count;j<X;j++){let q=j;M&&(q=M.getX(q)),Tv.fromBufferAttribute(N,q),k=Math.max(k,b.center.distanceToSquared(Tv))}b.radius=Math.sqrt(k),A.sphereInitialized=!0}return d.copy(b),d}setMatrixAt(a,d){const A=this._active,b=this._matricesTexture,E=this._matricesTexture.image.data,M=this._geometryCount;return a>=M||A[a]===!1?this:(d.toArray(E,a*16),b.needsUpdate=!0,this)}getMatrixAt(a,d){const A=this._active,b=this._matricesTexture.image.data,E=this._geometryCount;return a>=E||A[a]===!1?null:d.fromArray(b,a*16)}setVisibleAt(a,d){const A=this._visibility,b=this._active,E=this._geometryCount;return a>=E||b[a]===!1||A[a]===d?this:(A[a]=d,this._visibilityChanged=!0,this)}getVisibleAt(a){const d=this._visibility,A=this._active,b=this._geometryCount;return a>=b||A[a]===!1?!1:d[a]}raycast(a,d){const A=this._visibility,b=this._active,E=this._drawRanges,M=this._geometryCount,N=this.matrixWorld,P=this.geometry;fo.material=this.material,fo.geometry.index=P.index,fo.geometry.attributes=P.attributes,fo.geometry.boundingBox===null&&(fo.geometry.boundingBox=new Ds),fo.geometry.boundingSphere===null&&(fo.geometry.boundingSphere=new ya);for(let k=0;k<M;k++){if(!A[k]||!b[k])continue;const j=E[k];fo.geometry.setDrawRange(j.start,j.count),this.getMatrixAt(k,fo.matrixWorld).premultiply(N),this.getBoundingBoxAt(k,fo.geometry.boundingBox),this.getBoundingSphereAt(k,fo.geometry.boundingSphere),fo.raycast(a,dw);for(let X=0,q=dw.length;X<q;X++){const K=dw[X];K.object=this,K.batchId=k,d.push(K)}dw.length=0}fo.material=null,fo.geometry.index=null,fo.geometry.attributes={},fo.geometry.setDrawRange(0,1/0)}copy(a){return super.copy(a),this.geometry=a.geometry.clone(),this.perObjectFrustumCulled=a.perObjectFrustumCulled,this.sortObjects=a.sortObjects,this.boundingBox=a.boundingBox!==null?a.boundingBox.clone():null,this.boundingSphere=a.boundingSphere!==null?a.boundingSphere.clone():null,this._drawRanges=a._drawRanges.map(d=>({...d})),this._reservedRanges=a._reservedRanges.map(d=>({...d})),this._visibility=a._visibility.slice(),this._active=a._active.slice(),this._bounds=a._bounds.map(d=>({boxInitialized:d.boxInitialized,box:d.box.clone(),sphereInitialized:d.sphereInitialized,sphere:d.sphere.clone()})),this._maxGeometryCount=a._maxGeometryCount,this._maxVertexCount=a._maxVertexCount,this._maxIndexCount=a._maxIndexCount,this._geometryInitialized=a._geometryInitialized,this._geometryCount=a._geometryCount,this._multiDrawCounts=a._multiDrawCounts.slice(),this._multiDrawStarts=a._multiDrawStarts.slice(),this._matricesTexture=a._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.slice(),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this}onBeforeRender(a,d,A,b,E){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const M=b.getIndex(),N=M===null?1:M.array.BYTES_PER_ELEMENT,P=this._active,k=this._visibility,j=this._multiDrawStarts,X=this._multiDrawCounts,q=this._drawRanges,K=this.perObjectFrustumCulled;K&&(CV.multiplyMatrices(A.projectionMatrix,A.matrixWorldInverse).multiply(this.matrixWorld),wN.setFromProjectionMatrix(CV,a.coordinateSystem));let te=0;if(this.sortObjects){wV.copy(this.matrixWorld).invert(),Tv.setFromMatrixPosition(A.matrixWorld).applyMatrix4(wV);for(let ee=0,Me=k.length;ee<Me;ee++)if(k[ee]&&P[ee]){this.getMatrixAt(ee,Vd),this.getBoundingSphereAt(ee,Ef).applyMatrix4(Vd);let we=!1;if(K&&(we=!wN.intersectsSphere(Ef)),!we){const _e=Tv.distanceTo(Ef.center);CN.push(q[ee],_e)}}const oe=CN.list,re=this.customSort;re===null?oe.sort(E.transparent?TMe:SMe):re.call(this,oe,A);for(let ee=0,Me=oe.length;ee<Me;ee++){const we=oe[ee];j[te]=we.start*N,X[te]=we.count,te++}CN.reset()}else for(let oe=0,re=k.length;oe<re;oe++)if(k[oe]&&P[oe]){let ee=!1;if(K&&(this.getMatrixAt(oe,Vd),this.getBoundingSphereAt(oe,Ef).applyMatrix4(Vd),ee=!wN.intersectsSphere(Ef)),!ee){const Me=q[oe];j[te]=Me.start*N,X[te]=Me.count,te++}}this._multiDrawCount=te,this._visibilityChanged=!1}onBeforeShadow(a,d,A,b,E,M){this.onBeforeRender(a,null,b,E,M)}}class Oo extends po{constructor(a){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new lr(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.color.copy(a.color),this.map=a.map,this.linewidth=a.linewidth,this.linecap=a.linecap,this.linejoin=a.linejoin,this.fog=a.fog,this}}const pw=new He,fw=new He,TV=new mr,Mv=new va,mw=new ya,SN=new He,MV=new He;class Gd extends Qn{constructor(a=new fn,d=new Oo){super(),this.isLine=!0,this.type="Line",this.geometry=a,this.material=d,this.updateMorphTargets()}copy(a,d){return super.copy(a,d),this.material=Array.isArray(a.material)?a.material.slice():a.material,this.geometry=a.geometry,this}computeLineDistances(){const a=this.geometry;if(a.index===null){const d=a.attributes.position,A=[0];for(let b=1,E=d.count;b<E;b++)pw.fromBufferAttribute(d,b-1),fw.fromBufferAttribute(d,b),A[b]=A[b-1],A[b]+=pw.distanceTo(fw);a.setAttribute("lineDistance",new br(A,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(a,d){const A=this.geometry,b=this.matrixWorld,E=a.params.Line.threshold,M=A.drawRange;if(A.boundingSphere===null&&A.computeBoundingSphere(),mw.copy(A.boundingSphere),mw.applyMatrix4(b),mw.radius+=E,a.ray.intersectsSphere(mw)===!1)return;TV.copy(b).invert(),Mv.copy(a.ray).applyMatrix4(TV);const N=E/((this.scale.x+this.scale.y+this.scale.z)/3),P=N*N,k=this.isLineSegments?2:1,j=A.index,X=A.attributes.position;if(j!==null){const q=Math.max(0,M.start),K=Math.min(j.count,M.start+M.count);for(let te=q,oe=K-1;te<oe;te+=k){const re=j.getX(te),ee=j.getX(te+1),Me=gw(this,a,Mv,P,re,ee);Me&&d.push(Me)}if(this.isLineLoop){const te=j.getX(K-1),oe=j.getX(q),re=gw(this,a,Mv,P,te,oe);re&&d.push(re)}}else{const q=Math.max(0,M.start),K=Math.min(X.count,M.start+M.count);for(let te=q,oe=K-1;te<oe;te+=k){const re=gw(this,a,Mv,P,te,te+1);re&&d.push(re)}if(this.isLineLoop){const te=gw(this,a,Mv,P,K-1,q);te&&d.push(te)}}}updateMorphTargets(){const a=this.geometry.morphAttributes,d=Object.keys(a);if(d.length>0){const A=a[d[0]];if(A!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let b=0,E=A.length;b<E;b++){const M=A[b].name||String(b);this.morphTargetInfluences.push(0),this.morphTargetDictionary[M]=b}}}}}function gw(C,a,d,A,b,E){const M=C.geometry.attributes.position;if(pw.fromBufferAttribute(M,b),fw.fromBufferAttribute(M,E),d.distanceSqToSegment(pw,fw,SN,MV)>A)return;SN.applyMatrix4(C.matrixWorld);const N=a.ray.origin.distanceTo(SN);if(!(N<a.near||N>a.far))return{distance:N,point:MV.clone().applyMatrix4(C.matrixWorld),index:b,face:null,faceIndex:null,object:C}}const RV=new He,IV=new He;class nu extends Gd{constructor(a,d){super(a,d),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const a=this.geometry;if(a.index===null){const d=a.attributes.position,A=[];for(let b=0,E=d.count;b<E;b+=2)RV.fromBufferAttribute(d,b),IV.fromBufferAttribute(d,b+1),A[b]=b===0?0:A[b-1],A[b+1]=A[b]+RV.distanceTo(IV);a.setAttribute("lineDistance",new br(A,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class BV extends Gd{constructor(a,d){super(a,d),this.isLineLoop=!0,this.type="LineLoop"}}class TN extends po{constructor(a){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new lr(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.color.copy(a.color),this.map=a.map,this.alphaMap=a.alphaMap,this.size=a.size,this.sizeAttenuation=a.sizeAttenuation,this.fog=a.fog,this}}const NV=new mr,MN=new va,Aw=new ya,yw=new He;class LV extends Qn{constructor(a=new fn,d=new TN){super(),this.isPoints=!0,this.type="Points",this.geometry=a,this.material=d,this.updateMorphTargets()}copy(a,d){return super.copy(a,d),this.material=Array.isArray(a.material)?a.material.slice():a.material,this.geometry=a.geometry,this}raycast(a,d){const A=this.geometry,b=this.matrixWorld,E=a.params.Points.threshold,M=A.drawRange;if(A.boundingSphere===null&&A.computeBoundingSphere(),Aw.copy(A.boundingSphere),Aw.applyMatrix4(b),Aw.radius+=E,a.ray.intersectsSphere(Aw)===!1)return;NV.copy(b).invert(),MN.copy(a.ray).applyMatrix4(NV);const N=E/((this.scale.x+this.scale.y+this.scale.z)/3),P=N*N,k=A.index,j=A.attributes.position;if(k!==null){const X=Math.max(0,M.start),q=Math.min(k.count,M.start+M.count);for(let K=X,te=q;K<te;K++){const oe=k.getX(K);yw.fromBufferAttribute(j,oe),DV(yw,oe,P,b,a,d,this)}}else{const X=Math.max(0,M.start),q=Math.min(j.count,M.start+M.count);for(let K=X,te=q;K<te;K++)yw.fromBufferAttribute(j,K),DV(yw,K,P,b,a,d,this)}}updateMorphTargets(){const a=this.geometry.morphAttributes,d=Object.keys(a);if(d.length>0){const A=a[d[0]];if(A!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let b=0,E=A.length;b<E;b++){const M=A[b].name||String(b);this.morphTargetInfluences.push(0),this.morphTargetDictionary[M]=b}}}}}function DV(C,a,d,A,b,E,M){const N=MN.distanceSqToPoint(C);if(N<d){const P=new He;MN.closestPointToPoint(C,P),P.applyMatrix4(A);const k=b.ray.origin.distanceTo(P);if(k<b.near||k>b.far)return;E.push({distance:k,distanceToRay:Math.sqrt(N),point:P,index:a,face:null,object:M})}}class BMe extends fs{constructor(a,d,A,b,E,M,N,P,k){super(a,d,A,b,E,M,N,P,k),this.isVideoTexture=!0,this.minFilter=M!==void 0?M:ki,this.magFilter=E!==void 0?E:ki,this.generateMipmaps=!1;const j=this;function X(){j.needsUpdate=!0,a.requestVideoFrameCallback(X)}"requestVideoFrameCallback"in a&&a.requestVideoFrameCallback(X)}clone(){return new this.constructor(this.image).copy(this)}update(){const a=this.image;!("requestVideoFrameCallback"in a)&&a.readyState>=a.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class NMe extends fs{constructor(a,d){super({width:a,height:d}),this.isFramebufferTexture=!0,this.magFilter=It,this.minFilter=It,this.generateMipmaps=!1,this.needsUpdate=!0}}class vw extends fs{constructor(a,d,A,b,E,M,N,P,k,j,X,q){super(null,M,N,P,k,j,b,E,X,q),this.isCompressedTexture=!0,this.image={width:d,height:A},this.mipmaps=a,this.flipY=!1,this.generateMipmaps=!1}}class LMe extends vw{constructor(a,d,A,b,E,M){super(a,d,A,E,M),this.isCompressedArrayTexture=!0,this.image.depth=b,this.wrapR=je}}class DMe extends vw{constructor(a,d,A){super(void 0,a[0].width,a[0].height,d,A,F),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=a}}class OMe extends fs{constructor(a,d,A,b,E,M,N,P,k){super(a,d,A,b,E,M,N,P,k),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Dc{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(a,d){const A=this.getUtoTmapping(a);return this.getPoint(A,d)}getPoints(a=5){const d=[];for(let A=0;A<=a;A++)d.push(this.getPoint(A/a));return d}getSpacedPoints(a=5){const d=[];for(let A=0;A<=a;A++)d.push(this.getPointAt(A/a));return d}getLength(){const a=this.getLengths();return a[a.length-1]}getLengths(a=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===a+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const d=[];let A,b=this.getPoint(0),E=0;d.push(0);for(let M=1;M<=a;M++)A=this.getPoint(M/a),E+=A.distanceTo(b),d.push(E),b=A;return this.cacheArcLengths=d,d}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(a,d){const A=this.getLengths();let b=0;const E=A.length;let M;d?M=d:M=a*A[E-1];let N=0,P=E-1,k;for(;N<=P;)if(b=Math.floor(N+(P-N)/2),k=A[b]-M,k<0)N=b+1;else if(k>0)P=b-1;else{P=b;break}if(b=P,A[b]===M)return b/(E-1);const j=A[b],X=A[b+1]-j,q=(M-j)/X;return(b+q)/(E-1)}getTangent(a,d){let A=a-1e-4,b=a+1e-4;A<0&&(A=0),b>1&&(b=1);const E=this.getPoint(A),M=this.getPoint(b),N=d||(E.isVector2?new si:new He);return N.copy(M).sub(E).normalize(),N}getTangentAt(a,d){const A=this.getUtoTmapping(a);return this.getTangent(A,d)}computeFrenetFrames(a,d){const A=new He,b=[],E=[],M=[],N=new He,P=new mr;for(let K=0;K<=a;K++){const te=K/a;b[K]=this.getTangentAt(te,new He)}E[0]=new He,M[0]=new He;let k=Number.MAX_VALUE;const j=Math.abs(b[0].x),X=Math.abs(b[0].y),q=Math.abs(b[0].z);j<=k&&(k=j,A.set(1,0,0)),X<=k&&(k=X,A.set(0,1,0)),q<=k&&A.set(0,0,1),N.crossVectors(b[0],A).normalize(),E[0].crossVectors(b[0],N),M[0].crossVectors(b[0],E[0]);for(let K=1;K<=a;K++){if(E[K]=E[K-1].clone(),M[K]=M[K-1].clone(),N.crossVectors(b[K-1],b[K]),N.length()>Number.EPSILON){N.normalize();const te=Math.acos(Ms(b[K-1].dot(b[K]),-1,1));E[K].applyMatrix4(P.makeRotationAxis(N,te))}M[K].crossVectors(b[K],E[K])}if(d===!0){let K=Math.acos(Ms(E[0].dot(E[a]),-1,1));K/=a,b[0].dot(N.crossVectors(E[0],E[a]))>0&&(K=-K);for(let te=1;te<=a;te++)E[te].applyMatrix4(P.makeRotationAxis(b[te],K*te)),M[te].crossVectors(b[te],E[te])}return{tangents:b,normals:E,binormals:M}}clone(){return new this.constructor().copy(this)}copy(a){return this.arcLengthDivisions=a.arcLengthDivisions,this}toJSON(){const a={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return a.arcLengthDivisions=this.arcLengthDivisions,a.type=this.type,a}fromJSON(a){return this.arcLengthDivisions=a.arcLengthDivisions,this}}class xw extends Dc{constructor(a=0,d=0,A=1,b=1,E=0,M=Math.PI*2,N=!1,P=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=a,this.aY=d,this.xRadius=A,this.yRadius=b,this.aStartAngle=E,this.aEndAngle=M,this.aClockwise=N,this.aRotation=P}getPoint(a,d=new si){const A=d,b=Math.PI*2;let E=this.aEndAngle-this.aStartAngle;const M=Math.abs(E)<Number.EPSILON;for(;E<0;)E+=b;for(;E>b;)E-=b;E<Number.EPSILON&&(M?E=0:E=b),this.aClockwise===!0&&!M&&(E===b?E=-b:E=E-b);const N=this.aStartAngle+a*E;let P=this.aX+this.xRadius*Math.cos(N),k=this.aY+this.yRadius*Math.sin(N);if(this.aRotation!==0){const j=Math.cos(this.aRotation),X=Math.sin(this.aRotation),q=P-this.aX,K=k-this.aY;P=q*j-K*X+this.aX,k=q*X+K*j+this.aY}return A.set(P,k)}copy(a){return super.copy(a),this.aX=a.aX,this.aY=a.aY,this.xRadius=a.xRadius,this.yRadius=a.yRadius,this.aStartAngle=a.aStartAngle,this.aEndAngle=a.aEndAngle,this.aClockwise=a.aClockwise,this.aRotation=a.aRotation,this}toJSON(){const a=super.toJSON();return a.aX=this.aX,a.aY=this.aY,a.xRadius=this.xRadius,a.yRadius=this.yRadius,a.aStartAngle=this.aStartAngle,a.aEndAngle=this.aEndAngle,a.aClockwise=this.aClockwise,a.aRotation=this.aRotation,a}fromJSON(a){return super.fromJSON(a),this.aX=a.aX,this.aY=a.aY,this.xRadius=a.xRadius,this.yRadius=a.yRadius,this.aStartAngle=a.aStartAngle,this.aEndAngle=a.aEndAngle,this.aClockwise=a.aClockwise,this.aRotation=a.aRotation,this}}class OV extends xw{constructor(a,d,A,b,E,M){super(a,d,A,A,b,E,M),this.isArcCurve=!0,this.type="ArcCurve"}}function RN(){let C=0,a=0,d=0,A=0;function b(E,M,N,P){C=E,a=N,d=-3*E+3*M-2*N-P,A=2*E-2*M+N+P}return{initCatmullRom:function(E,M,N,P,k){b(M,N,k*(N-E),k*(P-M))},initNonuniformCatmullRom:function(E,M,N,P,k,j,X){let q=(M-E)/k-(N-E)/(k+j)+(N-M)/j,K=(N-M)/j-(P-M)/(j+X)+(P-N)/X;q*=j,K*=j,b(M,N,q,K)},calc:function(E){const M=E*E,N=M*E;return C+a*E+d*M+A*N}}}const bw=new He,IN=new RN,BN=new RN,NN=new RN;class PV extends Dc{constructor(a=[],d=!1,A="centripetal",b=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=a,this.closed=d,this.curveType=A,this.tension=b}getPoint(a,d=new He){const A=d,b=this.points,E=b.length,M=(E-(this.closed?0:1))*a;let N=Math.floor(M),P=M-N;this.closed?N+=N>0?0:(Math.floor(Math.abs(N)/E)+1)*E:P===0&&N===E-1&&(N=E-2,P=1);let k,j;this.closed||N>0?k=b[(N-1)%E]:(bw.subVectors(b[0],b[1]).add(b[0]),k=bw);const X=b[N%E],q=b[(N+1)%E];if(this.closed||N+2<E?j=b[(N+2)%E]:(bw.subVectors(b[E-1],b[E-2]).add(b[E-1]),j=bw),this.curveType==="centripetal"||this.curveType==="chordal"){const K=this.curveType==="chordal"?.5:.25;let te=Math.pow(k.distanceToSquared(X),K),oe=Math.pow(X.distanceToSquared(q),K),re=Math.pow(q.distanceToSquared(j),K);oe<1e-4&&(oe=1),te<1e-4&&(te=oe),re<1e-4&&(re=oe),IN.initNonuniformCatmullRom(k.x,X.x,q.x,j.x,te,oe,re),BN.initNonuniformCatmullRom(k.y,X.y,q.y,j.y,te,oe,re),NN.initNonuniformCatmullRom(k.z,X.z,q.z,j.z,te,oe,re)}else this.curveType==="catmullrom"&&(IN.initCatmullRom(k.x,X.x,q.x,j.x,this.tension),BN.initCatmullRom(k.y,X.y,q.y,j.y,this.tension),NN.initCatmullRom(k.z,X.z,q.z,j.z,this.tension));return A.set(IN.calc(P),BN.calc(P),NN.calc(P)),A}copy(a){super.copy(a),this.points=[];for(let d=0,A=a.points.length;d<A;d++){const b=a.points[d];this.points.push(b.clone())}return this.closed=a.closed,this.curveType=a.curveType,this.tension=a.tension,this}toJSON(){const a=super.toJSON();a.points=[];for(let d=0,A=this.points.length;d<A;d++){const b=this.points[d];a.points.push(b.toArray())}return a.closed=this.closed,a.curveType=this.curveType,a.tension=this.tension,a}fromJSON(a){super.fromJSON(a),this.points=[];for(let d=0,A=a.points.length;d<A;d++){const b=a.points[d];this.points.push(new He().fromArray(b))}return this.closed=a.closed,this.curveType=a.curveType,this.tension=a.tension,this}}function kV(C,a,d,A,b){const E=(A-a)*.5,M=(b-d)*.5,N=C*C,P=C*N;return(2*d-2*A+E+M)*P+(-3*d+3*A-2*E-M)*N+E*C+d}function PMe(C,a){const d=1-C;return d*d*a}function kMe(C,a){return 2*(1-C)*C*a}function FMe(C,a){return C*C*a}function Rv(C,a,d,A){return PMe(C,a)+kMe(C,d)+FMe(C,A)}function UMe(C,a){const d=1-C;return d*d*d*a}function zMe(C,a){const d=1-C;return 3*d*d*C*a}function jMe(C,a){return 3*(1-C)*C*C*a}function VMe(C,a){return C*C*C*a}function Iv(C,a,d,A,b){return UMe(C,a)+zMe(C,d)+jMe(C,A)+VMe(C,b)}class LN extends Dc{constructor(a=new si,d=new si,A=new si,b=new si){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=a,this.v1=d,this.v2=A,this.v3=b}getPoint(a,d=new si){const A=d,b=this.v0,E=this.v1,M=this.v2,N=this.v3;return A.set(Iv(a,b.x,E.x,M.x,N.x),Iv(a,b.y,E.y,M.y,N.y)),A}copy(a){return super.copy(a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this.v3.copy(a.v3),this}toJSON(){const a=super.toJSON();return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a.v3=this.v3.toArray(),a}fromJSON(a){return super.fromJSON(a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this.v3.fromArray(a.v3),this}}class FV extends Dc{constructor(a=new He,d=new He,A=new He,b=new He){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=a,this.v1=d,this.v2=A,this.v3=b}getPoint(a,d=new He){const A=d,b=this.v0,E=this.v1,M=this.v2,N=this.v3;return A.set(Iv(a,b.x,E.x,M.x,N.x),Iv(a,b.y,E.y,M.y,N.y),Iv(a,b.z,E.z,M.z,N.z)),A}copy(a){return super.copy(a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this.v3.copy(a.v3),this}toJSON(){const a=super.toJSON();return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a.v3=this.v3.toArray(),a}fromJSON(a){return super.fromJSON(a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this.v3.fromArray(a.v3),this}}class DN extends Dc{constructor(a=new si,d=new si){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=a,this.v2=d}getPoint(a,d=new si){const A=d;return a===1?A.copy(this.v2):(A.copy(this.v2).sub(this.v1),A.multiplyScalar(a).add(this.v1)),A}getPointAt(a,d){return this.getPoint(a,d)}getTangent(a,d=new si){return d.subVectors(this.v2,this.v1).normalize()}getTangentAt(a,d){return this.getTangent(a,d)}copy(a){return super.copy(a),this.v1.copy(a.v1),this.v2.copy(a.v2),this}toJSON(){const a=super.toJSON();return a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a}fromJSON(a){return super.fromJSON(a),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this}}class UV extends Dc{constructor(a=new He,d=new He){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=a,this.v2=d}getPoint(a,d=new He){const A=d;return a===1?A.copy(this.v2):(A.copy(this.v2).sub(this.v1),A.multiplyScalar(a).add(this.v1)),A}getPointAt(a,d){return this.getPoint(a,d)}getTangent(a,d=new He){return d.subVectors(this.v2,this.v1).normalize()}getTangentAt(a,d){return this.getTangent(a,d)}copy(a){return super.copy(a),this.v1.copy(a.v1),this.v2.copy(a.v2),this}toJSON(){const a=super.toJSON();return a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a}fromJSON(a){return super.fromJSON(a),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this}}class ON extends Dc{constructor(a=new si,d=new si,A=new si){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=a,this.v1=d,this.v2=A}getPoint(a,d=new si){const A=d,b=this.v0,E=this.v1,M=this.v2;return A.set(Rv(a,b.x,E.x,M.x),Rv(a,b.y,E.y,M.y)),A}copy(a){return super.copy(a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this}toJSON(){const a=super.toJSON();return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a}fromJSON(a){return super.fromJSON(a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this}}class PN extends Dc{constructor(a=new He,d=new He,A=new He){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=a,this.v1=d,this.v2=A}getPoint(a,d=new He){const A=d,b=this.v0,E=this.v1,M=this.v2;return A.set(Rv(a,b.x,E.x,M.x),Rv(a,b.y,E.y,M.y),Rv(a,b.z,E.z,M.z)),A}copy(a){return super.copy(a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this}toJSON(){const a=super.toJSON();return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a}fromJSON(a){return super.fromJSON(a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this}}class kN extends Dc{constructor(a=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=a}getPoint(a,d=new si){const A=d,b=this.points,E=(b.length-1)*a,M=Math.floor(E),N=E-M,P=b[M===0?M:M-1],k=b[M],j=b[M>b.length-2?b.length-1:M+1],X=b[M>b.length-3?b.length-1:M+2];return A.set(kV(N,P.x,k.x,j.x,X.x),kV(N,P.y,k.y,j.y,X.y)),A}copy(a){super.copy(a),this.points=[];for(let d=0,A=a.points.length;d<A;d++){const b=a.points[d];this.points.push(b.clone())}return this}toJSON(){const a=super.toJSON();a.points=[];for(let d=0,A=this.points.length;d<A;d++){const b=this.points[d];a.points.push(b.toArray())}return a}fromJSON(a){super.fromJSON(a),this.points=[];for(let d=0,A=a.points.length;d<A;d++){const b=a.points[d];this.points.push(new si().fromArray(b))}return this}}var _w=Object.freeze({__proto__:null,ArcCurve:OV,CatmullRomCurve3:PV,CubicBezierCurve:LN,CubicBezierCurve3:FV,EllipseCurve:xw,LineCurve:DN,LineCurve3:UV,QuadraticBezierCurve:ON,QuadraticBezierCurve3:PN,SplineCurve:kN});class zV extends Dc{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(a){this.curves.push(a)}closePath(){const a=this.curves[0].getPoint(0),d=this.curves[this.curves.length-1].getPoint(1);if(!a.equals(d)){const A=a.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new _w[A](d,a))}return this}getPoint(a,d){const A=a*this.getLength(),b=this.getCurveLengths();let E=0;for(;E<b.length;){if(b[E]>=A){const M=b[E]-A,N=this.curves[E],P=N.getLength(),k=P===0?0:1-M/P;return N.getPointAt(k,d)}E++}return null}getLength(){const a=this.getCurveLengths();return a[a.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const a=[];let d=0;for(let A=0,b=this.curves.length;A<b;A++)d+=this.curves[A].getLength(),a.push(d);return this.cacheLengths=a,a}getSpacedPoints(a=40){const d=[];for(let A=0;A<=a;A++)d.push(this.getPoint(A/a));return this.autoClose&&d.push(d[0]),d}getPoints(a=12){const d=[];let A;for(let b=0,E=this.curves;b<E.length;b++){const M=E[b],N=M.isEllipseCurve?a*2:M.isLineCurve||M.isLineCurve3?1:M.isSplineCurve?a*M.points.length:a,P=M.getPoints(N);for(let k=0;k<P.length;k++){const j=P[k];A&&A.equals(j)||(d.push(j),A=j)}}return this.autoClose&&d.length>1&&!d[d.length-1].equals(d[0])&&d.push(d[0]),d}copy(a){super.copy(a),this.curves=[];for(let d=0,A=a.curves.length;d<A;d++){const b=a.curves[d];this.curves.push(b.clone())}return this.autoClose=a.autoClose,this}toJSON(){const a=super.toJSON();a.autoClose=this.autoClose,a.curves=[];for(let d=0,A=this.curves.length;d<A;d++){const b=this.curves[d];a.curves.push(b.toJSON())}return a}fromJSON(a){super.fromJSON(a),this.autoClose=a.autoClose,this.curves=[];for(let d=0,A=a.curves.length;d<A;d++){const b=a.curves[d];this.curves.push(new _w[b.type]().fromJSON(b))}return this}}class Bv extends zV{constructor(a){super(),this.type="Path",this.currentPoint=new si,a&&this.setFromPoints(a)}setFromPoints(a){this.moveTo(a[0].x,a[0].y);for(let d=1,A=a.length;d<A;d++)this.lineTo(a[d].x,a[d].y);return this}moveTo(a,d){return this.currentPoint.set(a,d),this}lineTo(a,d){const A=new DN(this.currentPoint.clone(),new si(a,d));return this.curves.push(A),this.currentPoint.set(a,d),this}quadraticCurveTo(a,d,A,b){const E=new ON(this.currentPoint.clone(),new si(a,d),new si(A,b));return this.curves.push(E),this.currentPoint.set(A,b),this}bezierCurveTo(a,d,A,b,E,M){const N=new LN(this.currentPoint.clone(),new si(a,d),new si(A,b),new si(E,M));return this.curves.push(N),this.currentPoint.set(E,M),this}splineThru(a){const d=[this.currentPoint.clone()].concat(a),A=new kN(d);return this.curves.push(A),this.currentPoint.copy(a[a.length-1]),this}arc(a,d,A,b,E,M){const N=this.currentPoint.x,P=this.currentPoint.y;return this.absarc(a+N,d+P,A,b,E,M),this}absarc(a,d,A,b,E,M){return this.absellipse(a,d,A,A,b,E,M),this}ellipse(a,d,A,b,E,M,N,P){const k=this.currentPoint.x,j=this.currentPoint.y;return this.absellipse(a+k,d+j,A,b,E,M,N,P),this}absellipse(a,d,A,b,E,M,N,P){const k=new xw(a,d,A,b,E,M,N,P);if(this.curves.length>0){const X=k.getPoint(0);X.equals(this.currentPoint)||this.lineTo(X.x,X.y)}this.curves.push(k);const j=k.getPoint(1);return this.currentPoint.copy(j),this}copy(a){return super.copy(a),this.currentPoint.copy(a.currentPoint),this}toJSON(){const a=super.toJSON();return a.currentPoint=this.currentPoint.toArray(),a}fromJSON(a){return super.fromJSON(a),this.currentPoint.fromArray(a.currentPoint),this}}class Nv extends fn{constructor(a=[new si(0,-.5),new si(.5,0),new si(0,.5)],d=12,A=0,b=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:a,segments:d,phiStart:A,phiLength:b},d=Math.floor(d),b=Ms(b,0,Math.PI*2);const E=[],M=[],N=[],P=[],k=[],j=1/d,X=new He,q=new si,K=new He,te=new He,oe=new He;let re=0,ee=0;for(let Me=0;Me<=a.length-1;Me++)switch(Me){case 0:re=a[Me+1].x-a[Me].x,ee=a[Me+1].y-a[Me].y,K.x=ee*1,K.y=-re,K.z=ee*0,oe.copy(K),K.normalize(),P.push(K.x,K.y,K.z);break;case a.length-1:P.push(oe.x,oe.y,oe.z);break;default:re=a[Me+1].x-a[Me].x,ee=a[Me+1].y-a[Me].y,K.x=ee*1,K.y=-re,K.z=ee*0,te.copy(K),K.x+=oe.x,K.y+=oe.y,K.z+=oe.z,K.normalize(),P.push(K.x,K.y,K.z),oe.copy(te)}for(let Me=0;Me<=d;Me++){const we=A+Me*j*b,_e=Math.sin(we),nt=Math.cos(we);for(let qe=0;qe<=a.length-1;qe++){X.x=a[qe].x*_e,X.y=a[qe].y,X.z=a[qe].x*nt,M.push(X.x,X.y,X.z),q.x=Me/d,q.y=qe/(a.length-1),N.push(q.x,q.y);const Je=P[3*qe+0]*_e,it=P[3*qe+1],ze=P[3*qe+0]*nt;k.push(Je,it,ze)}}for(let Me=0;Me<d;Me++)for(let we=0;we<a.length-1;we++){const _e=we+Me*a.length,nt=_e,qe=_e+a.length,Je=_e+a.length+1,it=_e+1;E.push(nt,qe,it),E.push(Je,it,qe)}this.setIndex(E),this.setAttribute("position",new br(M,3)),this.setAttribute("uv",new br(N,2)),this.setAttribute("normal",new br(k,3))}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}static fromJSON(a){return new Nv(a.points,a.segments,a.phiStart,a.phiLength)}}class Ew extends Nv{constructor(a=1,d=1,A=4,b=8){const E=new Bv;E.absarc(0,-d/2,a,Math.PI*1.5,0),E.absarc(0,d/2,a,0,Math.PI*.5),super(E.getPoints(A),b),this.type="CapsuleGeometry",this.parameters={radius:a,length:d,capSegments:A,radialSegments:b}}static fromJSON(a){return new Ew(a.radius,a.length,a.capSegments,a.radialSegments)}}class ww extends fn{constructor(a=1,d=32,A=0,b=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:a,segments:d,thetaStart:A,thetaLength:b},d=Math.max(3,d);const E=[],M=[],N=[],P=[],k=new He,j=new si;M.push(0,0,0),N.push(0,0,1),P.push(.5,.5);for(let X=0,q=3;X<=d;X++,q+=3){const K=A+X/d*b;k.x=a*Math.cos(K),k.y=a*Math.sin(K),M.push(k.x,k.y,k.z),N.push(0,0,1),j.x=(M[q]/a+1)/2,j.y=(M[q+1]/a+1)/2,P.push(j.x,j.y)}for(let X=1;X<=d;X++)E.push(X,X+1,0);this.setIndex(E),this.setAttribute("position",new br(M,3)),this.setAttribute("normal",new br(N,3)),this.setAttribute("uv",new br(P,2))}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}static fromJSON(a){return new ww(a.radius,a.segments,a.thetaStart,a.thetaLength)}}class R0 extends fn{constructor(a=1,d=1,A=1,b=32,E=1,M=!1,N=0,P=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:a,radiusBottom:d,height:A,radialSegments:b,heightSegments:E,openEnded:M,thetaStart:N,thetaLength:P};const k=this;b=Math.floor(b),E=Math.floor(E);const j=[],X=[],q=[],K=[];let te=0;const oe=[],re=A/2;let ee=0;Me(),M===!1&&(a>0&&we(!0),d>0&&we(!1)),this.setIndex(j),this.setAttribute("position",new br(X,3)),this.setAttribute("normal",new br(q,3)),this.setAttribute("uv",new br(K,2));function Me(){const _e=new He,nt=new He;let qe=0;const Je=(d-a)/A;for(let it=0;it<=E;it++){const ze=[],Oe=it/E,rt=Oe*(d-a)+a;for(let mt=0;mt<=b;mt++){const pt=mt/b,Tt=pt*P+N,Pt=Math.sin(Tt),hi=Math.cos(Tt);nt.x=rt*Pt,nt.y=-Oe*A+re,nt.z=rt*hi,X.push(nt.x,nt.y,nt.z),_e.set(Pt,Je,hi).normalize(),q.push(_e.x,_e.y,_e.z),K.push(pt,1-Oe),ze.push(te++)}oe.push(ze)}for(let it=0;it<b;it++)for(let ze=0;ze<E;ze++){const Oe=oe[ze][it],rt=oe[ze+1][it],mt=oe[ze+1][it+1],pt=oe[ze][it+1];j.push(Oe,rt,pt),j.push(rt,mt,pt),qe+=6}k.addGroup(ee,qe,0),ee+=qe}function we(_e){const nt=te,qe=new si,Je=new He;let it=0;const ze=_e===!0?a:d,Oe=_e===!0?1:-1;for(let mt=1;mt<=b;mt++)X.push(0,re*Oe,0),q.push(0,Oe,0),K.push(.5,.5),te++;const rt=te;for(let mt=0;mt<=b;mt++){const pt=mt/b*P+N,Tt=Math.cos(pt),Pt=Math.sin(pt);Je.x=ze*Pt,Je.y=re*Oe,Je.z=ze*Tt,X.push(Je.x,Je.y,Je.z),q.push(0,Oe,0),qe.x=Tt*.5+.5,qe.y=Pt*.5*Oe+.5,K.push(qe.x,qe.y),te++}for(let mt=0;mt<b;mt++){const pt=nt+mt,Tt=rt+mt;_e===!0?j.push(Tt,Tt+1,pt):j.push(Tt+1,Tt,pt),it+=3}k.addGroup(ee,it,_e===!0?1:2),ee+=it}}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}static fromJSON(a){return new R0(a.radiusTop,a.radiusBottom,a.height,a.radialSegments,a.heightSegments,a.openEnded,a.thetaStart,a.thetaLength)}}class Cw extends R0{constructor(a=1,d=1,A=32,b=1,E=!1,M=0,N=Math.PI*2){super(0,a,d,A,b,E,M,N),this.type="ConeGeometry",this.parameters={radius:a,height:d,radialSegments:A,heightSegments:b,openEnded:E,thetaStart:M,thetaLength:N}}static fromJSON(a){return new Cw(a.radius,a.height,a.radialSegments,a.heightSegments,a.openEnded,a.thetaStart,a.thetaLength)}}class Hd extends fn{constructor(a=[],d=[],A=1,b=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:a,indices:d,radius:A,detail:b};const E=[],M=[];N(b),k(A),j(),this.setAttribute("position",new br(E,3)),this.setAttribute("normal",new br(E.slice(),3)),this.setAttribute("uv",new br(M,2)),b===0?this.computeVertexNormals():this.normalizeNormals();function N(Me){const we=new He,_e=new He,nt=new He;for(let qe=0;qe<d.length;qe+=3)K(d[qe+0],we),K(d[qe+1],_e),K(d[qe+2],nt),P(we,_e,nt,Me)}function P(Me,we,_e,nt){const qe=nt+1,Je=[];for(let it=0;it<=qe;it++){Je[it]=[];const ze=Me.clone().lerp(_e,it/qe),Oe=we.clone().lerp(_e,it/qe),rt=qe-it;for(let mt=0;mt<=rt;mt++)mt===0&&it===qe?Je[it][mt]=ze:Je[it][mt]=ze.clone().lerp(Oe,mt/rt)}for(let it=0;it<qe;it++)for(let ze=0;ze<2*(qe-it)-1;ze++){const Oe=Math.floor(ze/2);ze%2===0?(q(Je[it][Oe+1]),q(Je[it+1][Oe]),q(Je[it][Oe])):(q(Je[it][Oe+1]),q(Je[it+1][Oe+1]),q(Je[it+1][Oe]))}}function k(Me){const we=new He;for(let _e=0;_e<E.length;_e+=3)we.x=E[_e+0],we.y=E[_e+1],we.z=E[_e+2],we.normalize().multiplyScalar(Me),E[_e+0]=we.x,E[_e+1]=we.y,E[_e+2]=we.z}function j(){const Me=new He;for(let we=0;we<E.length;we+=3){Me.x=E[we+0],Me.y=E[we+1],Me.z=E[we+2];const _e=re(Me)/2/Math.PI+.5,nt=ee(Me)/Math.PI+.5;M.push(_e,1-nt)}te(),X()}function X(){for(let Me=0;Me<M.length;Me+=6){const we=M[Me+0],_e=M[Me+2],nt=M[Me+4],qe=Math.max(we,_e,nt),Je=Math.min(we,_e,nt);qe>.9&&Je<.1&&(we<.2&&(M[Me+0]+=1),_e<.2&&(M[Me+2]+=1),nt<.2&&(M[Me+4]+=1))}}function q(Me){E.push(Me.x,Me.y,Me.z)}function K(Me,we){const _e=Me*3;we.x=a[_e+0],we.y=a[_e+1],we.z=a[_e+2]}function te(){const Me=new He,we=new He,_e=new He,nt=new He,qe=new si,Je=new si,it=new si;for(let ze=0,Oe=0;ze<E.length;ze+=9,Oe+=6){Me.set(E[ze+0],E[ze+1],E[ze+2]),we.set(E[ze+3],E[ze+4],E[ze+5]),_e.set(E[ze+6],E[ze+7],E[ze+8]),qe.set(M[Oe+0],M[Oe+1]),Je.set(M[Oe+2],M[Oe+3]),it.set(M[Oe+4],M[Oe+5]),nt.copy(Me).add(we).add(_e).divideScalar(3);const rt=re(nt);oe(qe,Oe+0,Me,rt),oe(Je,Oe+2,we,rt),oe(it,Oe+4,_e,rt)}}function oe(Me,we,_e,nt){nt<0&&Me.x===1&&(M[we]=Me.x-1),_e.x===0&&_e.z===0&&(M[we]=nt/2/Math.PI+.5)}function re(Me){return Math.atan2(Me.z,-Me.x)}function ee(Me){return Math.atan2(-Me.y,Math.sqrt(Me.x*Me.x+Me.z*Me.z))}}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}static fromJSON(a){return new Hd(a.vertices,a.indices,a.radius,a.details)}}class Sw extends Hd{constructor(a=1,d=0){const A=(1+Math.sqrt(5))/2,b=1/A,E=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-b,-A,0,-b,A,0,b,-A,0,b,A,-b,-A,0,-b,A,0,b,-A,0,b,A,0,-A,0,-b,A,0,-b,-A,0,b,A,0,b],M=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(E,M,a,d),this.type="DodecahedronGeometry",this.parameters={radius:a,detail:d}}static fromJSON(a){return new Sw(a.radius,a.detail)}}const Tw=new He,Mw=new He,FN=new He,Rw=new Tl;class jV extends fn{constructor(a=null,d=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:a,thresholdAngle:d},a!==null){const A=Math.pow(10,4),b=Math.cos(gh*d),E=a.getIndex(),M=a.getAttribute("position"),N=E?E.count:M.count,P=[0,0,0],k=["a","b","c"],j=new Array(3),X={},q=[];for(let K=0;K<N;K+=3){E?(P[0]=E.getX(K),P[1]=E.getX(K+1),P[2]=E.getX(K+2)):(P[0]=K,P[1]=K+1,P[2]=K+2);const{a:te,b:oe,c:re}=Rw;if(te.fromBufferAttribute(M,P[0]),oe.fromBufferAttribute(M,P[1]),re.fromBufferAttribute(M,P[2]),Rw.getNormal(FN),j[0]=`${Math.round(te.x*A)},${Math.round(te.y*A)},${Math.round(te.z*A)}`,j[1]=`${Math.round(oe.x*A)},${Math.round(oe.y*A)},${Math.round(oe.z*A)}`,j[2]=`${Math.round(re.x*A)},${Math.round(re.y*A)},${Math.round(re.z*A)}`,!(j[0]===j[1]||j[1]===j[2]||j[2]===j[0]))for(let ee=0;ee<3;ee++){const Me=(ee+1)%3,we=j[ee],_e=j[Me],nt=Rw[k[ee]],qe=Rw[k[Me]],Je=`${we}_${_e}`,it=`${_e}_${we}`;it in X&&X[it]?(FN.dot(X[it].normal)<=b&&(q.push(nt.x,nt.y,nt.z),q.push(qe.x,qe.y,qe.z)),X[it]=null):Je in X||(X[Je]={index0:P[ee],index1:P[Me],normal:FN.clone()})}}for(const K in X)if(X[K]){const{index0:te,index1:oe}=X[K];Tw.fromBufferAttribute(M,te),Mw.fromBufferAttribute(M,oe),q.push(Tw.x,Tw.y,Tw.z),q.push(Mw.x,Mw.y,Mw.z)}this.setAttribute("position",new br(q,3))}}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}}class wf extends Bv{constructor(a){super(a),this.uuid=Bo(),this.type="Shape",this.holes=[]}getPointsHoles(a){const d=[];for(let A=0,b=this.holes.length;A<b;A++)d[A]=this.holes[A].getPoints(a);return d}extractPoints(a){return{shape:this.getPoints(a),holes:this.getPointsHoles(a)}}copy(a){super.copy(a),this.holes=[];for(let d=0,A=a.holes.length;d<A;d++){const b=a.holes[d];this.holes.push(b.clone())}return this}toJSON(){const a=super.toJSON();a.uuid=this.uuid,a.holes=[];for(let d=0,A=this.holes.length;d<A;d++){const b=this.holes[d];a.holes.push(b.toJSON())}return a}fromJSON(a){super.fromJSON(a),this.uuid=a.uuid,this.holes=[];for(let d=0,A=a.holes.length;d<A;d++){const b=a.holes[d];this.holes.push(new Bv().fromJSON(b))}return this}}const GMe={triangulate:function(C,a,d=2){const A=a&&a.length,b=A?a[0]*d:C.length;let E=VV(C,0,b,d,!0);const M=[];if(!E||E.next===E.prev)return M;let N,P,k,j,X,q,K;if(A&&(E=XMe(C,a,E,d)),C.length>80*d){N=k=C[0],P=j=C[1];for(let te=d;te<b;te+=d)X=C[te],q=C[te+1],X<N&&(N=X),q<P&&(P=q),X>k&&(k=X),q>j&&(j=q);K=Math.max(k-N,j-P),K=K!==0?32767/K:0}return Lv(E,M,d,N,P,K,0),M}};function VV(C,a,d,A,b){let E,M;if(b===s3e(C,a,d,A)>0)for(E=a;E<d;E+=A)M=WV(E,C[E],C[E+1],M);else for(E=d-A;E>=a;E-=A)M=WV(E,C[E],C[E+1],M);return M&&Iw(M,M.next)&&(Ov(M),M=M.next),M}function Cf(C,a){if(!C)return C;a||(a=C);let d=C,A;do if(A=!1,!d.steiner&&(Iw(d,d.next)||Os(d.prev,d,d.next)===0)){if(Ov(d),d=a=d.prev,d===d.next)break;A=!0}else d=d.next;while(A||d!==a);return a}function Lv(C,a,d,A,b,E,M){if(!C)return;!M&&E&&$Me(C,A,b,E);let N=C,P,k;for(;C.prev!==C.next;){if(P=C.prev,k=C.next,E?WMe(C,A,b,E):HMe(C)){a.push(P.i/d|0),a.push(C.i/d|0),a.push(k.i/d|0),Ov(C),C=k.next,N=k.next;continue}if(C=k,C===N){M?M===1?(C=QMe(Cf(C),a,d),Lv(C,a,d,A,b,E,2)):M===2&&qMe(C,a,d,A,b,E):Lv(Cf(C),a,d,A,b,E,1);break}}}function HMe(C){const a=C.prev,d=C,A=C.next;if(Os(a,d,A)>=0)return!1;const b=a.x,E=d.x,M=A.x,N=a.y,P=d.y,k=A.y,j=b<E?b<M?b:M:E<M?E:M,X=N<P?N<k?N:k:P<k?P:k,q=b>E?b>M?b:M:E>M?E:M,K=N>P?N>k?N:k:P>k?P:k;let te=A.next;for(;te!==a;){if(te.x>=j&&te.x<=q&&te.y>=X&&te.y<=K&&I0(b,N,E,P,M,k,te.x,te.y)&&Os(te.prev,te,te.next)>=0)return!1;te=te.next}return!0}function WMe(C,a,d,A){const b=C.prev,E=C,M=C.next;if(Os(b,E,M)>=0)return!1;const N=b.x,P=E.x,k=M.x,j=b.y,X=E.y,q=M.y,K=N<P?N<k?N:k:P<k?P:k,te=j<X?j<q?j:q:X<q?X:q,oe=N>P?N>k?N:k:P>k?P:k,re=j>X?j>q?j:q:X>q?X:q,ee=UN(K,te,a,d,A),Me=UN(oe,re,a,d,A);let we=C.prevZ,_e=C.nextZ;for(;we&&we.z>=ee&&_e&&_e.z<=Me;){if(we.x>=K&&we.x<=oe&&we.y>=te&&we.y<=re&&we!==b&&we!==M&&I0(N,j,P,X,k,q,we.x,we.y)&&Os(we.prev,we,we.next)>=0||(we=we.prevZ,_e.x>=K&&_e.x<=oe&&_e.y>=te&&_e.y<=re&&_e!==b&&_e!==M&&I0(N,j,P,X,k,q,_e.x,_e.y)&&Os(_e.prev,_e,_e.next)>=0))return!1;_e=_e.nextZ}for(;we&&we.z>=ee;){if(we.x>=K&&we.x<=oe&&we.y>=te&&we.y<=re&&we!==b&&we!==M&&I0(N,j,P,X,k,q,we.x,we.y)&&Os(we.prev,we,we.next)>=0)return!1;we=we.prevZ}for(;_e&&_e.z<=Me;){if(_e.x>=K&&_e.x<=oe&&_e.y>=te&&_e.y<=re&&_e!==b&&_e!==M&&I0(N,j,P,X,k,q,_e.x,_e.y)&&Os(_e.prev,_e,_e.next)>=0)return!1;_e=_e.nextZ}return!0}function QMe(C,a,d){let A=C;do{const b=A.prev,E=A.next.next;!Iw(b,E)&&GV(b,A,A.next,E)&&Dv(b,E)&&Dv(E,b)&&(a.push(b.i/d|0),a.push(A.i/d|0),a.push(E.i/d|0),Ov(A),Ov(A.next),A=C=E),A=A.next}while(A!==C);return Cf(A)}function qMe(C,a,d,A,b,E){let M=C;do{let N=M.next.next;for(;N!==M.prev;){if(M.i!==N.i&&i3e(M,N)){let P=HV(M,N);M=Cf(M,M.next),P=Cf(P,P.next),Lv(M,a,d,A,b,E,0),Lv(P,a,d,A,b,E,0);return}N=N.next}M=M.next}while(M!==C)}function XMe(C,a,d,A){const b=[];let E,M,N,P,k;for(E=0,M=a.length;E<M;E++)N=a[E]*A,P=E<M-1?a[E+1]*A:C.length,k=VV(C,N,P,A,!1),k===k.next&&(k.steiner=!0),b.push(t3e(k));for(b.sort(YMe),E=0;E<b.length;E++)d=KMe(b[E],d);return d}function YMe(C,a){return C.x-a.x}function KMe(C,a){const d=JMe(C,a);if(!d)return a;const A=HV(d,C);return Cf(A,A.next),Cf(d,d.next)}function JMe(C,a){let d=a,A=-1/0,b;const E=C.x,M=C.y;do{if(M<=d.y&&M>=d.next.y&&d.next.y!==d.y){const q=d.x+(M-d.y)*(d.next.x-d.x)/(d.next.y-d.y);if(q<=E&&q>A&&(A=q,b=d.x<d.next.x?d:d.next,q===E))return b}d=d.next}while(d!==a);if(!b)return null;const N=b,P=b.x,k=b.y;let j=1/0,X;d=b;do E>=d.x&&d.x>=P&&E!==d.x&&I0(M<k?E:A,M,P,k,M<k?A:E,M,d.x,d.y)&&(X=Math.abs(M-d.y)/(E-d.x),Dv(d,C)&&(X<j||X===j&&(d.x>b.x||d.x===b.x&&ZMe(b,d)))&&(b=d,j=X)),d=d.next;while(d!==N);return b}function ZMe(C,a){return Os(C.prev,C,a.prev)<0&&Os(a.next,C,C.next)<0}function $Me(C,a,d,A){let b=C;do b.z===0&&(b.z=UN(b.x,b.y,a,d,A)),b.prevZ=b.prev,b.nextZ=b.next,b=b.next;while(b!==C);b.prevZ.nextZ=null,b.prevZ=null,e3e(b)}function e3e(C){let a,d,A,b,E,M,N,P,k=1;do{for(d=C,C=null,E=null,M=0;d;){for(M++,A=d,N=0,a=0;a<k&&(N++,A=A.nextZ,!!A);a++);for(P=k;N>0||P>0&&A;)N!==0&&(P===0||!A||d.z<=A.z)?(b=d,d=d.nextZ,N--):(b=A,A=A.nextZ,P--),E?E.nextZ=b:C=b,b.prevZ=E,E=b;d=A}E.nextZ=null,k*=2}while(M>1);return C}function UN(C,a,d,A,b){return C=(C-d)*b|0,a=(a-A)*b|0,C=(C|C<<8)&16711935,C=(C|C<<4)&252645135,C=(C|C<<2)&858993459,C=(C|C<<1)&1431655765,a=(a|a<<8)&16711935,a=(a|a<<4)&252645135,a=(a|a<<2)&858993459,a=(a|a<<1)&1431655765,C|a<<1}function t3e(C){let a=C,d=C;do(a.x<d.x||a.x===d.x&&a.y<d.y)&&(d=a),a=a.next;while(a!==C);return d}function I0(C,a,d,A,b,E,M,N){return(b-M)*(a-N)>=(C-M)*(E-N)&&(C-M)*(A-N)>=(d-M)*(a-N)&&(d-M)*(E-N)>=(b-M)*(A-N)}function i3e(C,a){return C.next.i!==a.i&&C.prev.i!==a.i&&!r3e(C,a)&&(Dv(C,a)&&Dv(a,C)&&n3e(C,a)&&(Os(C.prev,C,a.prev)||Os(C,a.prev,a))||Iw(C,a)&&Os(C.prev,C,C.next)>0&&Os(a.prev,a,a.next)>0)}function Os(C,a,d){return(a.y-C.y)*(d.x-a.x)-(a.x-C.x)*(d.y-a.y)}function Iw(C,a){return C.x===a.x&&C.y===a.y}function GV(C,a,d,A){const b=Nw(Os(C,a,d)),E=Nw(Os(C,a,A)),M=Nw(Os(d,A,C)),N=Nw(Os(d,A,a));return!!(b!==E&&M!==N||b===0&&Bw(C,d,a)||E===0&&Bw(C,A,a)||M===0&&Bw(d,C,A)||N===0&&Bw(d,a,A))}function Bw(C,a,d){return a.x<=Math.max(C.x,d.x)&&a.x>=Math.min(C.x,d.x)&&a.y<=Math.max(C.y,d.y)&&a.y>=Math.min(C.y,d.y)}function Nw(C){return C>0?1:C<0?-1:0}function r3e(C,a){let d=C;do{if(d.i!==C.i&&d.next.i!==C.i&&d.i!==a.i&&d.next.i!==a.i&&GV(d,d.next,C,a))return!0;d=d.next}while(d!==C);return!1}function Dv(C,a){return Os(C.prev,C,C.next)<0?Os(C,a,C.next)>=0&&Os(C,C.prev,a)>=0:Os(C,a,C.prev)<0||Os(C,C.next,a)<0}function n3e(C,a){let d=C,A=!1;const b=(C.x+a.x)/2,E=(C.y+a.y)/2;do d.y>E!=d.next.y>E&&d.next.y!==d.y&&b<(d.next.x-d.x)*(E-d.y)/(d.next.y-d.y)+d.x&&(A=!A),d=d.next;while(d!==C);return A}function HV(C,a){const d=new zN(C.i,C.x,C.y),A=new zN(a.i,a.x,a.y),b=C.next,E=a.prev;return C.next=a,a.prev=C,d.next=b,b.prev=d,A.next=d,d.prev=A,E.next=A,A.prev=E,A}function WV(C,a,d,A){const b=new zN(C,a,d);return A?(b.next=A.next,b.prev=A,A.next.prev=b,A.next=b):(b.prev=b,b.next=b),b}function Ov(C){C.next.prev=C.prev,C.prev.next=C.next,C.prevZ&&(C.prevZ.nextZ=C.nextZ),C.nextZ&&(C.nextZ.prevZ=C.prevZ)}function zN(C,a,d){this.i=C,this.x=a,this.y=d,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function s3e(C,a,d,A){let b=0;for(let E=a,M=d-A;E<d;E+=A)b+=(C[M]-C[E])*(C[E+1]+C[M+1]),M=E;return b}class su{static area(a){const d=a.length;let A=0;for(let b=d-1,E=0;E<d;b=E++)A+=a[b].x*a[E].y-a[E].x*a[b].y;return A*.5}static isClockWise(a){return su.area(a)<0}static triangulateShape(a,d){const A=[],b=[],E=[];QV(a),qV(A,a);let M=a.length;d.forEach(QV);for(let P=0;P<d.length;P++)b.push(M),M+=d[P].length,qV(A,d[P]);const N=GMe.triangulate(A,b);for(let P=0;P<N.length;P+=3)E.push(N.slice(P,P+3));return E}}function QV(C){const a=C.length;a>2&&C[a-1].equals(C[0])&&C.pop()}function qV(C,a){for(let d=0;d<a.length;d++)C.push(a[d].x),C.push(a[d].y)}class Lw extends fn{constructor(a=new wf([new si(.5,.5),new si(-.5,.5),new si(-.5,-.5),new si(.5,-.5)]),d={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:a,options:d},a=Array.isArray(a)?a:[a];const A=this,b=[],E=[];for(let N=0,P=a.length;N<P;N++){const k=a[N];M(k)}this.setAttribute("position",new br(b,3)),this.setAttribute("uv",new br(E,2)),this.computeVertexNormals();function M(N){const P=[],k=d.curveSegments!==void 0?d.curveSegments:12,j=d.steps!==void 0?d.steps:1,X=d.depth!==void 0?d.depth:1;let q=d.bevelEnabled!==void 0?d.bevelEnabled:!0,K=d.bevelThickness!==void 0?d.bevelThickness:.2,te=d.bevelSize!==void 0?d.bevelSize:K-.1,oe=d.bevelOffset!==void 0?d.bevelOffset:0,re=d.bevelSegments!==void 0?d.bevelSegments:3;const ee=d.extrudePath,Me=d.UVGenerator!==void 0?d.UVGenerator:a3e;let we,_e=!1,nt,qe,Je,it;ee&&(we=ee.getSpacedPoints(j),_e=!0,q=!1,nt=ee.computeFrenetFrames(j,!1),qe=new He,Je=new He,it=new He),q||(re=0,K=0,te=0,oe=0);const ze=N.extractPoints(k);let Oe=ze.shape;const rt=ze.holes;if(!su.isClockWise(Oe)){Oe=Oe.reverse();for(let tt=0,fi=rt.length;tt<fi;tt++){const $t=rt[tt];su.isClockWise($t)&&(rt[tt]=$t.reverse())}}const mt=su.triangulateShape(Oe,rt),pt=Oe;for(let tt=0,fi=rt.length;tt<fi;tt++){const $t=rt[tt];Oe=Oe.concat($t)}function Tt(tt,fi,$t){return fi||console.error("THREE.ExtrudeGeometry: vec does not exist"),tt.clone().addScaledVector(fi,$t)}const Pt=Oe.length,hi=mt.length;function Di(tt,fi,$t){let $i,oi,tr;const er=tt.x-fi.x,vr=tt.y-fi.y,vn=$t.x-tt.x,qr=$t.y-tt.y,ha=er*er+vr*vr,Xs=er*qr-vr*vn;if(Math.abs(Xs)>Number.EPSILON){const qn=Math.sqrt(ha),et=Math.sqrt(vn*vn+qr*qr),De=fi.x-vr/qn,Ft=fi.y+er/qn,ui=$t.x-qr/et,mi=$t.y+vn/et,ai=((ui-De)*qr-(mi-Ft)*vn)/(er*qr-vr*vn);$i=De+er*ai-tt.x,oi=Ft+vr*ai-tt.y;const Ir=$i*$i+oi*oi;if(Ir<=2)return new si($i,oi);tr=Math.sqrt(Ir/2)}else{let qn=!1;er>Number.EPSILON?vn>Number.EPSILON&&(qn=!0):er<-Number.EPSILON?vn<-Number.EPSILON&&(qn=!0):Math.sign(vr)===Math.sign(qr)&&(qn=!0),qn?($i=-vr,oi=er,tr=Math.sqrt(ha)):($i=er,oi=vr,tr=Math.sqrt(ha/2))}return new si($i/tr,oi/tr)}const kt=[];for(let tt=0,fi=pt.length,$t=fi-1,$i=tt+1;tt<fi;tt++,$t++,$i++)$t===fi&&($t=0),$i===fi&&($i=0),kt[tt]=Di(pt[tt],pt[$t],pt[$i]);const yi=[];let Oi,jr=kt.concat();for(let tt=0,fi=rt.length;tt<fi;tt++){const $t=rt[tt];Oi=[];for(let $i=0,oi=$t.length,tr=oi-1,er=$i+1;$i<oi;$i++,tr++,er++)tr===oi&&(tr=0),er===oi&&(er=0),Oi[$i]=Di($t[$i],$t[tr],$t[er]);yi.push(Oi),jr=jr.concat(Oi)}for(let tt=0;tt<re;tt++){const fi=tt/re,$t=K*Math.cos(fi*Math.PI/2),$i=te*Math.sin(fi*Math.PI/2)+oe;for(let oi=0,tr=pt.length;oi<tr;oi++){const er=Tt(pt[oi],kt[oi],$i);Dn(er.x,er.y,-$t)}for(let oi=0,tr=rt.length;oi<tr;oi++){const er=rt[oi];Oi=yi[oi];for(let vr=0,vn=er.length;vr<vn;vr++){const qr=Tt(er[vr],Oi[vr],$i);Dn(qr.x,qr.y,-$t)}}}const En=te+oe;for(let tt=0;tt<Pt;tt++){const fi=q?Tt(Oe[tt],jr[tt],En):Oe[tt];_e?(Je.copy(nt.normals[0]).multiplyScalar(fi.x),qe.copy(nt.binormals[0]).multiplyScalar(fi.y),it.copy(we[0]).add(Je).add(qe),Dn(it.x,it.y,it.z)):Dn(fi.x,fi.y,0)}for(let tt=1;tt<=j;tt++)for(let fi=0;fi<Pt;fi++){const $t=q?Tt(Oe[fi],jr[fi],En):Oe[fi];_e?(Je.copy(nt.normals[tt]).multiplyScalar($t.x),qe.copy(nt.binormals[tt]).multiplyScalar($t.y),it.copy(we[tt]).add(Je).add(qe),Dn(it.x,it.y,it.z)):Dn($t.x,$t.y,X/j*tt)}for(let tt=re-1;tt>=0;tt--){const fi=tt/re,$t=K*Math.cos(fi*Math.PI/2),$i=te*Math.sin(fi*Math.PI/2)+oe;for(let oi=0,tr=pt.length;oi<tr;oi++){const er=Tt(pt[oi],kt[oi],$i);Dn(er.x,er.y,X+$t)}for(let oi=0,tr=rt.length;oi<tr;oi++){const er=rt[oi];Oi=yi[oi];for(let vr=0,vn=er.length;vr<vn;vr++){const qr=Tt(er[vr],Oi[vr],$i);_e?Dn(qr.x,qr.y+we[j-1].y,we[j-1].x+$t):Dn(qr.x,qr.y,X+$t)}}}ns(),ms();function ns(){const tt=b.length/3;if(q){let fi=0,$t=Pt*fi;for(let $i=0;$i<hi;$i++){const oi=mt[$i];Sr(oi[2]+$t,oi[1]+$t,oi[0]+$t)}fi=j+re*2,$t=Pt*fi;for(let $i=0;$i<hi;$i++){const oi=mt[$i];Sr(oi[0]+$t,oi[1]+$t,oi[2]+$t)}}else{for(let fi=0;fi<hi;fi++){const $t=mt[fi];Sr($t[2],$t[1],$t[0])}for(let fi=0;fi<hi;fi++){const $t=mt[fi];Sr($t[0]+Pt*j,$t[1]+Pt*j,$t[2]+Pt*j)}}A.addGroup(tt,b.length/3-tt,0)}function ms(){const tt=b.length/3;let fi=0;Gn(pt,fi),fi+=pt.length;for(let $t=0,$i=rt.length;$t<$i;$t++){const oi=rt[$t];Gn(oi,fi),fi+=oi.length}A.addGroup(tt,b.length/3-tt,1)}function Gn(tt,fi){let $t=tt.length;for(;--$t>=0;){const $i=$t;let oi=$t-1;oi<0&&(oi=tt.length-1);for(let tr=0,er=j+re*2;tr<er;tr++){const vr=Pt*tr,vn=Pt*(tr+1),qr=fi+$i+vr,ha=fi+oi+vr,Xs=fi+oi+vn,qn=fi+$i+vn;ci(qr,ha,Xs,qn)}}}function Dn(tt,fi,$t){P.push(tt),P.push(fi),P.push($t)}function Sr(tt,fi,$t){wi(tt),wi(fi),wi($t);const $i=b.length/3,oi=Me.generateTopUV(A,b,$i-3,$i-2,$i-1);qi(oi[0]),qi(oi[1]),qi(oi[2])}function ci(tt,fi,$t,$i){wi(tt),wi(fi),wi($i),wi(fi),wi($t),wi($i);const oi=b.length/3,tr=Me.generateSideWallUV(A,b,oi-6,oi-3,oi-2,oi-1);qi(tr[0]),qi(tr[1]),qi(tr[3]),qi(tr[1]),qi(tr[2]),qi(tr[3])}function wi(tt){b.push(P[tt*3+0]),b.push(P[tt*3+1]),b.push(P[tt*3+2])}function qi(tt){E.push(tt.x),E.push(tt.y)}}}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}toJSON(){const a=super.toJSON(),d=this.parameters.shapes,A=this.parameters.options;return o3e(d,A,a)}static fromJSON(a,d){const A=[];for(let E=0,M=a.shapes.length;E<M;E++){const N=d[a.shapes[E]];A.push(N)}const b=a.options.extrudePath;return b!==void 0&&(a.options.extrudePath=new _w[b.type]().fromJSON(b)),new Lw(A,a.options)}}const a3e={generateTopUV:function(C,a,d,A,b){const E=a[d*3],M=a[d*3+1],N=a[A*3],P=a[A*3+1],k=a[b*3],j=a[b*3+1];return[new si(E,M),new si(N,P),new si(k,j)]},generateSideWallUV:function(C,a,d,A,b,E){const M=a[d*3],N=a[d*3+1],P=a[d*3+2],k=a[A*3],j=a[A*3+1],X=a[A*3+2],q=a[b*3],K=a[b*3+1],te=a[b*3+2],oe=a[E*3],re=a[E*3+1],ee=a[E*3+2];return Math.abs(N-j)<Math.abs(M-k)?[new si(M,1-P),new si(k,1-X),new si(q,1-te),new si(oe,1-ee)]:[new si(N,1-P),new si(j,1-X),new si(K,1-te),new si(re,1-ee)]}};function o3e(C,a,d){if(d.shapes=[],Array.isArray(C))for(let A=0,b=C.length;A<b;A++){const E=C[A];d.shapes.push(E.uuid)}else d.shapes.push(C.uuid);return d.options=Object.assign({},a),a.extrudePath!==void 0&&(d.options.extrudePath=a.extrudePath.toJSON()),d}class Dw extends Hd{constructor(a=1,d=0){const A=(1+Math.sqrt(5))/2,b=[-1,A,0,1,A,0,-1,-A,0,1,-A,0,0,-1,A,0,1,A,0,-1,-A,0,1,-A,A,0,-1,A,0,1,-A,0,-1,-A,0,1],E=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(b,E,a,d),this.type="IcosahedronGeometry",this.parameters={radius:a,detail:d}}static fromJSON(a){return new Dw(a.radius,a.detail)}}class Pv extends Hd{constructor(a=1,d=0){const A=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],b=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(A,b,a,d),this.type="OctahedronGeometry",this.parameters={radius:a,detail:d}}static fromJSON(a){return new Pv(a.radius,a.detail)}}class Ow extends fn{constructor(a=.5,d=1,A=32,b=1,E=0,M=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:a,outerRadius:d,thetaSegments:A,phiSegments:b,thetaStart:E,thetaLength:M},A=Math.max(3,A),b=Math.max(1,b);const N=[],P=[],k=[],j=[];let X=a;const q=(d-a)/b,K=new He,te=new si;for(let oe=0;oe<=b;oe++){for(let re=0;re<=A;re++){const ee=E+re/A*M;K.x=X*Math.cos(ee),K.y=X*Math.sin(ee),P.push(K.x,K.y,K.z),k.push(0,0,1),te.x=(K.x/d+1)/2,te.y=(K.y/d+1)/2,j.push(te.x,te.y)}X+=q}for(let oe=0;oe<b;oe++){const re=oe*(A+1);for(let ee=0;ee<A;ee++){const Me=ee+re,we=Me,_e=Me+A+1,nt=Me+A+2,qe=Me+1;N.push(we,_e,qe),N.push(_e,nt,qe)}}this.setIndex(N),this.setAttribute("position",new br(P,3)),this.setAttribute("normal",new br(k,3)),this.setAttribute("uv",new br(j,2))}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}static fromJSON(a){return new Ow(a.innerRadius,a.outerRadius,a.thetaSegments,a.phiSegments,a.thetaStart,a.thetaLength)}}class Pw extends fn{constructor(a=new wf([new si(0,.5),new si(-.5,-.5),new si(.5,-.5)]),d=12){super(),this.type="ShapeGeometry",this.parameters={shapes:a,curveSegments:d};const A=[],b=[],E=[],M=[];let N=0,P=0;if(Array.isArray(a)===!1)k(a);else for(let j=0;j<a.length;j++)k(a[j]),this.addGroup(N,P,j),N+=P,P=0;this.setIndex(A),this.setAttribute("position",new br(b,3)),this.setAttribute("normal",new br(E,3)),this.setAttribute("uv",new br(M,2));function k(j){const X=b.length/3,q=j.extractPoints(d);let K=q.shape;const te=q.holes;su.isClockWise(K)===!1&&(K=K.reverse());for(let re=0,ee=te.length;re<ee;re++){const Me=te[re];su.isClockWise(Me)===!0&&(te[re]=Me.reverse())}const oe=su.triangulateShape(K,te);for(let re=0,ee=te.length;re<ee;re++){const Me=te[re];K=K.concat(Me)}for(let re=0,ee=K.length;re<ee;re++){const Me=K[re];b.push(Me.x,Me.y,0),E.push(0,0,1),M.push(Me.x,Me.y)}for(let re=0,ee=oe.length;re<ee;re++){const Me=oe[re],we=Me[0]+X,_e=Me[1]+X,nt=Me[2]+X;A.push(we,_e,nt),P+=3}}}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}toJSON(){const a=super.toJSON(),d=this.parameters.shapes;return l3e(d,a)}static fromJSON(a,d){const A=[];for(let b=0,E=a.shapes.length;b<E;b++){const M=d[a.shapes[b]];A.push(M)}return new Pw(A,a.curveSegments)}}function l3e(C,a){if(a.shapes=[],Array.isArray(C))for(let d=0,A=C.length;d<A;d++){const b=C[d];a.shapes.push(b.uuid)}else a.shapes.push(C.uuid);return a}class kv extends fn{constructor(a=1,d=32,A=16,b=0,E=Math.PI*2,M=0,N=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:a,widthSegments:d,heightSegments:A,phiStart:b,phiLength:E,thetaStart:M,thetaLength:N},d=Math.max(3,Math.floor(d)),A=Math.max(2,Math.floor(A));const P=Math.min(M+N,Math.PI);let k=0;const j=[],X=new He,q=new He,K=[],te=[],oe=[],re=[];for(let ee=0;ee<=A;ee++){const Me=[],we=ee/A;let _e=0;ee===0&&M===0?_e=.5/d:ee===A&&P===Math.PI&&(_e=-.5/d);for(let nt=0;nt<=d;nt++){const qe=nt/d;X.x=-a*Math.cos(b+qe*E)*Math.sin(M+we*N),X.y=a*Math.cos(M+we*N),X.z=a*Math.sin(b+qe*E)*Math.sin(M+we*N),te.push(X.x,X.y,X.z),q.copy(X).normalize(),oe.push(q.x,q.y,q.z),re.push(qe+_e,1-we),Me.push(k++)}j.push(Me)}for(let ee=0;ee<A;ee++)for(let Me=0;Me<d;Me++){const we=j[ee][Me+1],_e=j[ee][Me],nt=j[ee+1][Me],qe=j[ee+1][Me+1];(ee!==0||M>0)&&K.push(we,_e,qe),(ee!==A-1||P<Math.PI)&&K.push(_e,nt,qe)}this.setIndex(K),this.setAttribute("position",new br(te,3)),this.setAttribute("normal",new br(oe,3)),this.setAttribute("uv",new br(re,2))}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}static fromJSON(a){return new kv(a.radius,a.widthSegments,a.heightSegments,a.phiStart,a.phiLength,a.thetaStart,a.thetaLength)}}class kw extends Hd{constructor(a=1,d=0){const A=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],b=[2,1,0,0,3,2,1,3,0,2,3,1];super(A,b,a,d),this.type="TetrahedronGeometry",this.parameters={radius:a,detail:d}}static fromJSON(a){return new kw(a.radius,a.detail)}}class Fw extends fn{constructor(a=1,d=.4,A=12,b=48,E=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:a,tube:d,radialSegments:A,tubularSegments:b,arc:E},A=Math.floor(A),b=Math.floor(b);const M=[],N=[],P=[],k=[],j=new He,X=new He,q=new He;for(let K=0;K<=A;K++)for(let te=0;te<=b;te++){const oe=te/b*E,re=K/A*Math.PI*2;X.x=(a+d*Math.cos(re))*Math.cos(oe),X.y=(a+d*Math.cos(re))*Math.sin(oe),X.z=d*Math.sin(re),N.push(X.x,X.y,X.z),j.x=a*Math.cos(oe),j.y=a*Math.sin(oe),q.subVectors(X,j).normalize(),P.push(q.x,q.y,q.z),k.push(te/b),k.push(K/A)}for(let K=1;K<=A;K++)for(let te=1;te<=b;te++){const oe=(b+1)*K+te-1,re=(b+1)*(K-1)+te-1,ee=(b+1)*(K-1)+te,Me=(b+1)*K+te;M.push(oe,re,Me),M.push(re,ee,Me)}this.setIndex(M),this.setAttribute("position",new br(N,3)),this.setAttribute("normal",new br(P,3)),this.setAttribute("uv",new br(k,2))}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}static fromJSON(a){return new Fw(a.radius,a.tube,a.radialSegments,a.tubularSegments,a.arc)}}class Uw extends fn{constructor(a=1,d=.4,A=64,b=8,E=2,M=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:a,tube:d,tubularSegments:A,radialSegments:b,p:E,q:M},A=Math.floor(A),b=Math.floor(b);const N=[],P=[],k=[],j=[],X=new He,q=new He,K=new He,te=new He,oe=new He,re=new He,ee=new He;for(let we=0;we<=A;++we){const _e=we/A*E*Math.PI*2;Me(_e,E,M,a,K),Me(_e+.01,E,M,a,te),re.subVectors(te,K),ee.addVectors(te,K),oe.crossVectors(re,ee),ee.crossVectors(oe,re),oe.normalize(),ee.normalize();for(let nt=0;nt<=b;++nt){const qe=nt/b*Math.PI*2,Je=-d*Math.cos(qe),it=d*Math.sin(qe);X.x=K.x+(Je*ee.x+it*oe.x),X.y=K.y+(Je*ee.y+it*oe.y),X.z=K.z+(Je*ee.z+it*oe.z),P.push(X.x,X.y,X.z),q.subVectors(X,K).normalize(),k.push(q.x,q.y,q.z),j.push(we/A),j.push(nt/b)}}for(let we=1;we<=A;we++)for(let _e=1;_e<=b;_e++){const nt=(b+1)*(we-1)+(_e-1),qe=(b+1)*we+(_e-1),Je=(b+1)*we+_e,it=(b+1)*(we-1)+_e;N.push(nt,qe,it),N.push(qe,Je,it)}this.setIndex(N),this.setAttribute("position",new br(P,3)),this.setAttribute("normal",new br(k,3)),this.setAttribute("uv",new br(j,2));function Me(we,_e,nt,qe,Je){const it=Math.cos(we),ze=Math.sin(we),Oe=nt/_e*we,rt=Math.cos(Oe);Je.x=qe*(2+rt)*.5*it,Je.y=qe*(2+rt)*ze*.5,Je.z=qe*Math.sin(Oe)*.5}}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}static fromJSON(a){return new Uw(a.radius,a.tube,a.tubularSegments,a.radialSegments,a.p,a.q)}}class zw extends fn{constructor(a=new PN(new He(-1,-1,0),new He(-1,1,0),new He(1,1,0)),d=64,A=1,b=8,E=!1){super(),this.type="TubeGeometry",this.parameters={path:a,tubularSegments:d,radius:A,radialSegments:b,closed:E};const M=a.computeFrenetFrames(d,E);this.tangents=M.tangents,this.normals=M.normals,this.binormals=M.binormals;const N=new He,P=new He,k=new si;let j=new He;const X=[],q=[],K=[],te=[];oe(),this.setIndex(te),this.setAttribute("position",new br(X,3)),this.setAttribute("normal",new br(q,3)),this.setAttribute("uv",new br(K,2));function oe(){for(let we=0;we<d;we++)re(we);re(E===!1?d:0),Me(),ee()}function re(we){j=a.getPointAt(we/d,j);const _e=M.normals[we],nt=M.binormals[we];for(let qe=0;qe<=b;qe++){const Je=qe/b*Math.PI*2,it=Math.sin(Je),ze=-Math.cos(Je);P.x=ze*_e.x+it*nt.x,P.y=ze*_e.y+it*nt.y,P.z=ze*_e.z+it*nt.z,P.normalize(),q.push(P.x,P.y,P.z),N.x=j.x+A*P.x,N.y=j.y+A*P.y,N.z=j.z+A*P.z,X.push(N.x,N.y,N.z)}}function ee(){for(let we=1;we<=d;we++)for(let _e=1;_e<=b;_e++){const nt=(b+1)*(we-1)+(_e-1),qe=(b+1)*we+(_e-1),Je=(b+1)*we+_e,it=(b+1)*(we-1)+_e;te.push(nt,qe,it),te.push(qe,Je,it)}}function Me(){for(let we=0;we<=d;we++)for(let _e=0;_e<=b;_e++)k.x=we/d,k.y=_e/b,K.push(k.x,k.y)}}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}toJSON(){const a=super.toJSON();return a.path=this.parameters.path.toJSON(),a}static fromJSON(a){return new zw(new _w[a.path.type]().fromJSON(a.path),a.tubularSegments,a.radius,a.radialSegments,a.closed)}}class XV extends fn{constructor(a=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:a},a!==null){const d=[],A=new Set,b=new He,E=new He;if(a.index!==null){const M=a.attributes.position,N=a.index;let P=a.groups;P.length===0&&(P=[{start:0,count:N.count,materialIndex:0}]);for(let k=0,j=P.length;k<j;++k){const X=P[k],q=X.start,K=X.count;for(let te=q,oe=q+K;te<oe;te+=3)for(let re=0;re<3;re++){const ee=N.getX(te+re),Me=N.getX(te+(re+1)%3);b.fromBufferAttribute(M,ee),E.fromBufferAttribute(M,Me),YV(b,E,A)===!0&&(d.push(b.x,b.y,b.z),d.push(E.x,E.y,E.z))}}}else{const M=a.attributes.position;for(let N=0,P=M.count/3;N<P;N++)for(let k=0;k<3;k++){const j=3*N+k,X=3*N+(k+1)%3;b.fromBufferAttribute(M,j),E.fromBufferAttribute(M,X),YV(b,E,A)===!0&&(d.push(b.x,b.y,b.z),d.push(E.x,E.y,E.z))}}this.setAttribute("position",new br(d,3))}}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}}function YV(C,a,d){const A=`${C.x},${C.y},${C.z}-${a.x},${a.y},${a.z}`,b=`${a.x},${a.y},${a.z}-${C.x},${C.y},${C.z}`;return d.has(A)===!0||d.has(b)===!0?!1:(d.add(A),d.add(b),!0)}var KV=Object.freeze({__proto__:null,BoxGeometry:mf,CapsuleGeometry:Ew,CircleGeometry:ww,ConeGeometry:Cw,CylinderGeometry:R0,DodecahedronGeometry:Sw,EdgesGeometry:jV,ExtrudeGeometry:Lw,IcosahedronGeometry:Dw,LatheGeometry:Nv,OctahedronGeometry:Pv,PlaneGeometry:y0,PolyhedronGeometry:Hd,RingGeometry:Ow,ShapeGeometry:Pw,SphereGeometry:kv,TetrahedronGeometry:kw,TorusGeometry:Fw,TorusKnotGeometry:Uw,TubeGeometry:zw,WireframeGeometry:XV});class JV extends po{constructor(a){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new lr(0),this.transparent=!0,this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.color.copy(a.color),this.fog=a.fog,this}}class ZV extends Nc{constructor(a){super(a),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class jN extends po{constructor(a){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new lr(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new lr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=co,this.normalScale=new si(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Sl,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.defines={STANDARD:""},this.color.copy(a.color),this.roughness=a.roughness,this.metalness=a.metalness,this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.roughnessMap=a.roughnessMap,this.metalnessMap=a.metalnessMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.envMapRotation.copy(a.envMapRotation),this.envMapIntensity=a.envMapIntensity,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.flatShading=a.flatShading,this.fog=a.fog,this}}class $V extends jN{constructor(a){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new si(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Ms(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(d){this.ior=(1+.4*d)/(1-.4*d)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new lr(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new lr(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new lr(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(a)}get anisotropy(){return this._anisotropy}set anisotropy(a){this._anisotropy>0!=a>0&&this.version++,this._anisotropy=a}get clearcoat(){return this._clearcoat}set clearcoat(a){this._clearcoat>0!=a>0&&this.version++,this._clearcoat=a}get iridescence(){return this._iridescence}set iridescence(a){this._iridescence>0!=a>0&&this.version++,this._iridescence=a}get dispersion(){return this._dispersion}set dispersion(a){this._dispersion>0!=a>0&&this.version++,this._dispersion=a}get sheen(){return this._sheen}set sheen(a){this._sheen>0!=a>0&&this.version++,this._sheen=a}get transmission(){return this._transmission}set transmission(a){this._transmission>0!=a>0&&this.version++,this._transmission=a}copy(a){return super.copy(a),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=a.anisotropy,this.anisotropyRotation=a.anisotropyRotation,this.anisotropyMap=a.anisotropyMap,this.clearcoat=a.clearcoat,this.clearcoatMap=a.clearcoatMap,this.clearcoatRoughness=a.clearcoatRoughness,this.clearcoatRoughnessMap=a.clearcoatRoughnessMap,this.clearcoatNormalMap=a.clearcoatNormalMap,this.clearcoatNormalScale.copy(a.clearcoatNormalScale),this.dispersion=a.dispersion,this.ior=a.ior,this.iridescence=a.iridescence,this.iridescenceMap=a.iridescenceMap,this.iridescenceIOR=a.iridescenceIOR,this.iridescenceThicknessRange=[...a.iridescenceThicknessRange],this.iridescenceThicknessMap=a.iridescenceThicknessMap,this.sheen=a.sheen,this.sheenColor.copy(a.sheenColor),this.sheenColorMap=a.sheenColorMap,this.sheenRoughness=a.sheenRoughness,this.sheenRoughnessMap=a.sheenRoughnessMap,this.transmission=a.transmission,this.transmissionMap=a.transmissionMap,this.thickness=a.thickness,this.thicknessMap=a.thicknessMap,this.attenuationDistance=a.attenuationDistance,this.attenuationColor.copy(a.attenuationColor),this.specularIntensity=a.specularIntensity,this.specularIntensityMap=a.specularIntensityMap,this.specularColor.copy(a.specularColor),this.specularColorMap=a.specularColorMap,this}}class eG extends po{constructor(a){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new lr(16777215),this.specular=new lr(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new lr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=co,this.normalScale=new si(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Sl,this.combine=Qe,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.color.copy(a.color),this.specular.copy(a.specular),this.shininess=a.shininess,this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.specularMap=a.specularMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.envMapRotation.copy(a.envMapRotation),this.combine=a.combine,this.reflectivity=a.reflectivity,this.refractionRatio=a.refractionRatio,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.flatShading=a.flatShading,this.fog=a.fog,this}}class tG extends po{constructor(a){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new lr(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new lr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=co,this.normalScale=new si(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.color.copy(a.color),this.map=a.map,this.gradientMap=a.gradientMap,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.alphaMap=a.alphaMap,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.fog=a.fog,this}}class iG extends po{constructor(a){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=co,this.normalScale=new si(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(a)}copy(a){return super.copy(a),this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.flatShading=a.flatShading,this}}class rG extends po{constructor(a){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new lr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new lr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=co,this.normalScale=new si(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Sl,this.combine=Qe,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.color.copy(a.color),this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.specularMap=a.specularMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.envMapRotation.copy(a.envMapRotation),this.combine=a.combine,this.reflectivity=a.reflectivity,this.refractionRatio=a.refractionRatio,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.flatShading=a.flatShading,this.fog=a.fog,this}}class nG extends po{constructor(a){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new lr(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=co,this.normalScale=new si(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.defines={MATCAP:""},this.color.copy(a.color),this.matcap=a.matcap,this.map=a.map,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.alphaMap=a.alphaMap,this.flatShading=a.flatShading,this.fog=a.fog,this}}class sG extends Oo{constructor(a){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(a)}copy(a){return super.copy(a),this.scale=a.scale,this.dashSize=a.dashSize,this.gapSize=a.gapSize,this}}function Sf(C,a,d){return!C||!d&&C.constructor===a?C:typeof a.BYTES_PER_ELEMENT=="number"?new a(C):Array.prototype.slice.call(C)}function aG(C){return ArrayBuffer.isView(C)&&!(C instanceof DataView)}function oG(C){function a(b,E){return C[b]-C[E]}const d=C.length,A=new Array(d);for(let b=0;b!==d;++b)A[b]=b;return A.sort(a),A}function VN(C,a,d){const A=C.length,b=new C.constructor(A);for(let E=0,M=0;M!==A;++E){const N=d[E]*a;for(let P=0;P!==a;++P)b[M++]=C[N+P]}return b}function GN(C,a,d,A){let b=1,E=C[0];for(;E!==void 0&&E[A]===void 0;)E=C[b++];if(E===void 0)return;let M=E[A];if(M!==void 0)if(Array.isArray(M))do M=E[A],M!==void 0&&(a.push(E.time),d.push.apply(d,M)),E=C[b++];while(E!==void 0);else if(M.toArray!==void 0)do M=E[A],M!==void 0&&(a.push(E.time),M.toArray(d,d.length)),E=C[b++];while(E!==void 0);else do M=E[A],M!==void 0&&(a.push(E.time),d.push(M)),E=C[b++];while(E!==void 0)}function c3e(C,a,d,A,b=30){const E=C.clone();E.name=a;const M=[];for(let P=0;P<E.tracks.length;++P){const k=E.tracks[P],j=k.getValueSize(),X=[],q=[];for(let K=0;K<k.times.length;++K){const te=k.times[K]*b;if(!(te<d||te>=A)){X.push(k.times[K]);for(let oe=0;oe<j;++oe)q.push(k.values[K*j+oe])}}X.length!==0&&(k.times=Sf(X,k.times.constructor),k.values=Sf(q,k.values.constructor),M.push(k))}E.tracks=M;let N=1/0;for(let P=0;P<E.tracks.length;++P)N>E.tracks[P].times[0]&&(N=E.tracks[P].times[0]);for(let P=0;P<E.tracks.length;++P)E.tracks[P].shift(-1*N);return E.resetDuration(),E}function u3e(C,a=0,d=C,A=30){A<=0&&(A=30);const b=d.tracks.length,E=a/A;for(let M=0;M<b;++M){const N=d.tracks[M],P=N.ValueTypeName;if(P==="bool"||P==="string")continue;const k=C.tracks.find(function(ee){return ee.name===N.name&&ee.ValueTypeName===P});if(k===void 0)continue;let j=0;const X=N.getValueSize();N.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(j=X/3);let q=0;const K=k.getValueSize();k.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(q=K/3);const te=N.times.length-1;let oe;if(E<=N.times[0]){const ee=j,Me=X-j;oe=N.values.slice(ee,Me)}else if(E>=N.times[te]){const ee=te*X+j,Me=ee+X-j;oe=N.values.slice(ee,Me)}else{const ee=N.createInterpolant(),Me=j,we=X-j;ee.evaluate(E),oe=ee.resultBuffer.slice(Me,we)}P==="quaternion"&&new Wn().fromArray(oe).normalize().conjugate().toArray(oe);const re=k.times.length;for(let ee=0;ee<re;++ee){const Me=ee*K+q;if(P==="quaternion")Wn.multiplyQuaternionsFlat(k.values,Me,oe,0,k.values,Me);else{const we=K-q*2;for(let _e=0;_e<we;++_e)k.values[Me+_e]-=oe[_e]}}}return C.blendMode=Or,C}const h3e={convertArray:Sf,isTypedArray:aG,getKeyframeOrder:oG,sortedArray:VN,flattenJSON:GN,subclip:c3e,makeClipAdditive:u3e};class Fv{constructor(a,d,A,b){this.parameterPositions=a,this._cachedIndex=0,this.resultBuffer=b!==void 0?b:new d.constructor(A),this.sampleValues=d,this.valueSize=A,this.settings=null,this.DefaultSettings_={}}evaluate(a){const d=this.parameterPositions;let A=this._cachedIndex,b=d[A],E=d[A-1];i:{e:{let M;t:{r:if(!(a<b)){for(let N=A+2;;){if(b===void 0){if(a<E)break r;return A=d.length,this._cachedIndex=A,this.copySampleValue_(A-1)}if(A===N)break;if(E=b,b=d[++A],a<b)break e}M=d.length;break t}if(!(a>=E)){const N=d[1];a<N&&(A=2,E=N);for(let P=A-2;;){if(E===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(A===P)break;if(b=E,E=d[--A-1],a>=E)break e}M=A,A=0;break t}break i}for(;A<M;){const N=A+M>>>1;a<d[N]?M=N:A=N+1}if(b=d[A],E=d[A-1],E===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(b===void 0)return A=d.length,this._cachedIndex=A,this.copySampleValue_(A-1)}this._cachedIndex=A,this.intervalChanged_(A,E,b)}return this.interpolate_(A,E,a,b)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(a){const d=this.resultBuffer,A=this.sampleValues,b=this.valueSize,E=a*b;for(let M=0;M!==b;++M)d[M]=A[E+M];return d}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class lG extends Fv{constructor(a,d,A,b){super(a,d,A,b),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Hr,endingEnd:Hr}}intervalChanged_(a,d,A){const b=this.parameterPositions;let E=a-2,M=a+1,N=b[E],P=b[M];if(N===void 0)switch(this.getSettings_().endingStart){case _n:E=a,N=2*d-A;break;case Gr:E=b.length-2,N=d+b[E]-b[E+1];break;default:E=a,N=A}if(P===void 0)switch(this.getSettings_().endingEnd){case _n:M=a,P=2*A-d;break;case Gr:M=1,P=A+b[1]-b[0];break;default:M=a-1,P=d}const k=(A-d)*.5,j=this.valueSize;this._weightPrev=k/(d-N),this._weightNext=k/(P-A),this._offsetPrev=E*j,this._offsetNext=M*j}interpolate_(a,d,A,b){const E=this.resultBuffer,M=this.sampleValues,N=this.valueSize,P=a*N,k=P-N,j=this._offsetPrev,X=this._offsetNext,q=this._weightPrev,K=this._weightNext,te=(A-d)/(b-d),oe=te*te,re=oe*te,ee=-q*re+2*q*oe-q*te,Me=(1+q)*re+(-1.5-2*q)*oe+(-.5+q)*te+1,we=(-1-K)*re+(1.5+K)*oe+.5*te,_e=K*re-K*oe;for(let nt=0;nt!==N;++nt)E[nt]=ee*M[j+nt]+Me*M[k+nt]+we*M[P+nt]+_e*M[X+nt];return E}}class HN extends Fv{constructor(a,d,A,b){super(a,d,A,b)}interpolate_(a,d,A,b){const E=this.resultBuffer,M=this.sampleValues,N=this.valueSize,P=a*N,k=P-N,j=(A-d)/(b-d),X=1-j;for(let q=0;q!==N;++q)E[q]=M[k+q]*X+M[P+q]*j;return E}}class cG extends Fv{constructor(a,d,A,b){super(a,d,A,b)}interpolate_(a){return this.copySampleValue_(a-1)}}class Oc{constructor(a,d,A,b){if(a===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(d===void 0||d.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+a);this.name=a,this.times=Sf(d,this.TimeBufferType),this.values=Sf(A,this.ValueBufferType),this.setInterpolation(b||this.DefaultInterpolation)}static toJSON(a){const d=a.constructor;let A;if(d.toJSON!==this.toJSON)A=d.toJSON(a);else{A={name:a.name,times:Sf(a.times,Array),values:Sf(a.values,Array)};const b=a.getInterpolation();b!==a.DefaultInterpolation&&(A.interpolation=b)}return A.type=a.ValueTypeName,A}InterpolantFactoryMethodDiscrete(a){return new cG(this.times,this.values,this.getValueSize(),a)}InterpolantFactoryMethodLinear(a){return new HN(this.times,this.values,this.getValueSize(),a)}InterpolantFactoryMethodSmooth(a){return new lG(this.times,this.values,this.getValueSize(),a)}setInterpolation(a){let d;switch(a){case Cr:d=this.InterpolantFactoryMethodDiscrete;break;case Mr:d=this.InterpolantFactoryMethodLinear;break;case zr:d=this.InterpolantFactoryMethodSmooth;break}if(d===void 0){const A="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(a!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(A);return console.warn("THREE.KeyframeTrack:",A),this}return this.createInterpolant=d,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Cr;case this.InterpolantFactoryMethodLinear:return Mr;case this.InterpolantFactoryMethodSmooth:return zr}}getValueSize(){return this.values.length/this.times.length}shift(a){if(a!==0){const d=this.times;for(let A=0,b=d.length;A!==b;++A)d[A]+=a}return this}scale(a){if(a!==1){const d=this.times;for(let A=0,b=d.length;A!==b;++A)d[A]*=a}return this}trim(a,d){const A=this.times,b=A.length;let E=0,M=b-1;for(;E!==b&&A[E]<a;)++E;for(;M!==-1&&A[M]>d;)--M;if(++M,E!==0||M!==b){E>=M&&(M=Math.max(M,1),E=M-1);const N=this.getValueSize();this.times=A.slice(E,M),this.values=this.values.slice(E*N,M*N)}return this}validate(){let a=!0;const d=this.getValueSize();d-Math.floor(d)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),a=!1);const A=this.times,b=this.values,E=A.length;E===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),a=!1);let M=null;for(let N=0;N!==E;N++){const P=A[N];if(typeof P=="number"&&isNaN(P)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,N,P),a=!1;break}if(M!==null&&M>P){console.error("THREE.KeyframeTrack: Out of order keys.",this,N,P,M),a=!1;break}M=P}if(b!==void 0&&aG(b))for(let N=0,P=b.length;N!==P;++N){const k=b[N];if(isNaN(k)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,N,k),a=!1;break}}return a}optimize(){const a=this.times.slice(),d=this.values.slice(),A=this.getValueSize(),b=this.getInterpolation()===zr,E=a.length-1;let M=1;for(let N=1;N<E;++N){let P=!1;const k=a[N],j=a[N+1];if(k!==j&&(N!==1||k!==a[0]))if(b)P=!0;else{const X=N*A,q=X-A,K=X+A;for(let te=0;te!==A;++te){const oe=d[X+te];if(oe!==d[q+te]||oe!==d[K+te]){P=!0;break}}}if(P){if(N!==M){a[M]=a[N];const X=N*A,q=M*A;for(let K=0;K!==A;++K)d[q+K]=d[X+K]}++M}}if(E>0){a[M]=a[E];for(let N=E*A,P=M*A,k=0;k!==A;++k)d[P+k]=d[N+k];++M}return M!==a.length?(this.times=a.slice(0,M),this.values=d.slice(0,M*A)):(this.times=a,this.values=d),this}clone(){const a=this.times.slice(),d=this.values.slice(),A=this.constructor,b=new A(this.name,a,d);return b.createInterpolant=this.createInterpolant,b}}Oc.prototype.TimeBufferType=Float32Array,Oc.prototype.ValueBufferType=Float32Array,Oc.prototype.DefaultInterpolation=Mr;class Tf extends Oc{}Tf.prototype.ValueTypeName="bool",Tf.prototype.ValueBufferType=Array,Tf.prototype.DefaultInterpolation=Cr,Tf.prototype.InterpolantFactoryMethodLinear=void 0,Tf.prototype.InterpolantFactoryMethodSmooth=void 0;class WN extends Oc{}WN.prototype.ValueTypeName="color";class Uv extends Oc{}Uv.prototype.ValueTypeName="number";class uG extends Fv{constructor(a,d,A,b){super(a,d,A,b)}interpolate_(a,d,A,b){const E=this.resultBuffer,M=this.sampleValues,N=this.valueSize,P=(A-d)/(b-d);let k=a*N;for(let j=k+N;k!==j;k+=4)Wn.slerpFlat(E,0,M,k-N,M,k,P);return E}}class B0 extends Oc{InterpolantFactoryMethodLinear(a){return new uG(this.times,this.values,this.getValueSize(),a)}}B0.prototype.ValueTypeName="quaternion",B0.prototype.DefaultInterpolation=Mr,B0.prototype.InterpolantFactoryMethodSmooth=void 0;class Mf extends Oc{}Mf.prototype.ValueTypeName="string",Mf.prototype.ValueBufferType=Array,Mf.prototype.DefaultInterpolation=Cr,Mf.prototype.InterpolantFactoryMethodLinear=void 0,Mf.prototype.InterpolantFactoryMethodSmooth=void 0;class zv extends Oc{}zv.prototype.ValueTypeName="vector";class jv{constructor(a="",d=-1,A=[],b=ps){this.name=a,this.tracks=A,this.duration=d,this.blendMode=b,this.uuid=Bo(),this.duration<0&&this.resetDuration()}static parse(a){const d=[],A=a.tracks,b=1/(a.fps||1);for(let M=0,N=A.length;M!==N;++M)d.push(p3e(A[M]).scale(b));const E=new this(a.name,a.duration,d,a.blendMode);return E.uuid=a.uuid,E}static toJSON(a){const d=[],A=a.tracks,b={name:a.name,duration:a.duration,tracks:d,uuid:a.uuid,blendMode:a.blendMode};for(let E=0,M=A.length;E!==M;++E)d.push(Oc.toJSON(A[E]));return b}static CreateFromMorphTargetSequence(a,d,A,b){const E=d.length,M=[];for(let N=0;N<E;N++){let P=[],k=[];P.push((N+E-1)%E,N,(N+1)%E),k.push(0,1,0);const j=oG(P);P=VN(P,1,j),k=VN(k,1,j),!b&&P[0]===0&&(P.push(E),k.push(k[0])),M.push(new Uv(".morphTargetInfluences["+d[N].name+"]",P,k).scale(1/A))}return new this(a,-1,M)}static findByName(a,d){let A=a;if(!Array.isArray(a)){const b=a;A=b.geometry&&b.geometry.animations||b.animations}for(let b=0;b<A.length;b++)if(A[b].name===d)return A[b];return null}static CreateClipsFromMorphTargetSequences(a,d,A){const b={},E=/^([\w-]*?)([\d]+)$/;for(let N=0,P=a.length;N<P;N++){const k=a[N],j=k.name.match(E);if(j&&j.length>1){const X=j[1];let q=b[X];q||(b[X]=q=[]),q.push(k)}}const M=[];for(const N in b)M.push(this.CreateFromMorphTargetSequence(N,b[N],d,A));return M}static parseAnimation(a,d){if(!a)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const A=function(j,X,q,K,te){if(q.length!==0){const oe=[],re=[];GN(q,oe,re,K),oe.length!==0&&te.push(new j(X,oe,re))}},b=[],E=a.name||"default",M=a.fps||30,N=a.blendMode;let P=a.length||-1;const k=a.hierarchy||[];for(let j=0;j<k.length;j++){const X=k[j].keys;if(!(!X||X.length===0))if(X[0].morphTargets){const q={};let K;for(K=0;K<X.length;K++)if(X[K].morphTargets)for(let te=0;te<X[K].morphTargets.length;te++)q[X[K].morphTargets[te]]=-1;for(const te in q){const oe=[],re=[];for(let ee=0;ee!==X[K].morphTargets.length;++ee){const Me=X[K];oe.push(Me.time),re.push(Me.morphTarget===te?1:0)}b.push(new Uv(".morphTargetInfluence["+te+"]",oe,re))}P=q.length*M}else{const q=".bones["+d[j].name+"]";A(zv,q+".position",X,"pos",b),A(B0,q+".quaternion",X,"rot",b),A(zv,q+".scale",X,"scl",b)}}return b.length===0?null:new this(E,P,b,N)}resetDuration(){const a=this.tracks;let d=0;for(let A=0,b=a.length;A!==b;++A){const E=this.tracks[A];d=Math.max(d,E.times[E.times.length-1])}return this.duration=d,this}trim(){for(let a=0;a<this.tracks.length;a++)this.tracks[a].trim(0,this.duration);return this}validate(){let a=!0;for(let d=0;d<this.tracks.length;d++)a=a&&this.tracks[d].validate();return a}optimize(){for(let a=0;a<this.tracks.length;a++)this.tracks[a].optimize();return this}clone(){const a=[];for(let d=0;d<this.tracks.length;d++)a.push(this.tracks[d].clone());return new this.constructor(this.name,this.duration,a,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function d3e(C){switch(C.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Uv;case"vector":case"vector2":case"vector3":case"vector4":return zv;case"color":return WN;case"quaternion":return B0;case"bool":case"boolean":return Tf;case"string":return Mf}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+C)}function p3e(C){if(C.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const a=d3e(C.type);if(C.times===void 0){const d=[],A=[];GN(C.keys,d,A,"value"),C.times=d,C.values=A}return a.parse!==void 0?a.parse(C):new a(C.name,C.times,C.values,C.interpolation)}const wh={enabled:!1,files:{},add:function(C,a){this.enabled!==!1&&(this.files[C]=a)},get:function(C){if(this.enabled!==!1)return this.files[C]},remove:function(C){delete this.files[C]},clear:function(){this.files={}}};class QN{constructor(a,d,A){const b=this;let E=!1,M=0,N=0,P;const k=[];this.onStart=void 0,this.onLoad=a,this.onProgress=d,this.onError=A,this.itemStart=function(j){N++,E===!1&&b.onStart!==void 0&&b.onStart(j,M,N),E=!0},this.itemEnd=function(j){M++,b.onProgress!==void 0&&b.onProgress(j,M,N),M===N&&(E=!1,b.onLoad!==void 0&&b.onLoad())},this.itemError=function(j){b.onError!==void 0&&b.onError(j)},this.resolveURL=function(j){return P?P(j):j},this.setURLModifier=function(j){return P=j,this},this.addHandler=function(j,X){return k.push(j,X),this},this.removeHandler=function(j){const X=k.indexOf(j);return X!==-1&&k.splice(X,2),this},this.getHandler=function(j){for(let X=0,q=k.length;X<q;X+=2){const K=k[X],te=k[X+1];if(K.global&&(K.lastIndex=0),K.test(j))return te}return null}}}const hG=new QN;class nl{constructor(a){this.manager=a!==void 0?a:hG,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(a,d){const A=this;return new Promise(function(b,E){A.load(a,b,d,E)})}parse(){}setCrossOrigin(a){return this.crossOrigin=a,this}setWithCredentials(a){return this.withCredentials=a,this}setPath(a){return this.path=a,this}setResourcePath(a){return this.resourcePath=a,this}setRequestHeader(a){return this.requestHeader=a,this}}nl.DEFAULT_MATERIAL_NAME="__DEFAULT";const Ch={};class f3e extends Error{constructor(a,d){super(a),this.response=d}}class Sh extends nl{constructor(a){super(a)}load(a,d,A,b){a===void 0&&(a=""),this.path!==void 0&&(a=this.path+a),a=this.manager.resolveURL(a);const E=wh.get(a);if(E!==void 0)return this.manager.itemStart(a),setTimeout(()=>{d&&d(E),this.manager.itemEnd(a)},0),E;if(Ch[a]!==void 0){Ch[a].push({onLoad:d,onProgress:A,onError:b});return}Ch[a]=[],Ch[a].push({onLoad:d,onProgress:A,onError:b});const M=new Request(a,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),N=this.mimeType,P=this.responseType;fetch(M).then(k=>{if(k.status===200||k.status===0){if(k.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||k.body===void 0||k.body.getReader===void 0)return k;const j=Ch[a],X=k.body.getReader(),q=k.headers.get("X-File-Size")||k.headers.get("Content-Length"),K=q?parseInt(q):0,te=K!==0;let oe=0;const re=new ReadableStream({start(ee){Me();function Me(){X.read().then(({done:we,value:_e})=>{if(we)ee.close();else{oe+=_e.byteLength;const nt=new ProgressEvent("progress",{lengthComputable:te,loaded:oe,total:K});for(let qe=0,Je=j.length;qe<Je;qe++){const it=j[qe];it.onProgress&&it.onProgress(nt)}ee.enqueue(_e),Me()}})}}});return new Response(re)}else throw new f3e(`fetch for "${k.url}" responded with ${k.status}: ${k.statusText}`,k)}).then(k=>{switch(P){case"arraybuffer":return k.arrayBuffer();case"blob":return k.blob();case"document":return k.text().then(j=>new DOMParser().parseFromString(j,N));case"json":return k.json();default:if(N===void 0)return k.text();{const j=/charset="?([^;"\s]*)"?/i.exec(N),X=j&&j[1]?j[1].toLowerCase():void 0,q=new TextDecoder(X);return k.arrayBuffer().then(K=>q.decode(K))}}}).then(k=>{wh.add(a,k);const j=Ch[a];delete Ch[a];for(let X=0,q=j.length;X<q;X++){const K=j[X];K.onLoad&&K.onLoad(k)}}).catch(k=>{const j=Ch[a];if(j===void 0)throw this.manager.itemError(a),k;delete Ch[a];for(let X=0,q=j.length;X<q;X++){const K=j[X];K.onError&&K.onError(k)}this.manager.itemError(a)}).finally(()=>{this.manager.itemEnd(a)}),this.manager.itemStart(a)}setResponseType(a){return this.responseType=a,this}setMimeType(a){return this.mimeType=a,this}}class m3e extends nl{constructor(a){super(a)}load(a,d,A,b){const E=this,M=new Sh(this.manager);M.setPath(this.path),M.setRequestHeader(this.requestHeader),M.setWithCredentials(this.withCredentials),M.load(a,function(N){try{d(E.parse(JSON.parse(N)))}catch(P){b?b(P):console.error(P),E.manager.itemError(a)}},A,b)}parse(a){const d=[];for(let A=0;A<a.length;A++){const b=jv.parse(a[A]);d.push(b)}return d}}class g3e extends nl{constructor(a){super(a)}load(a,d,A,b){const E=this,M=[],N=new vw,P=new Sh(this.manager);P.setPath(this.path),P.setResponseType("arraybuffer"),P.setRequestHeader(this.requestHeader),P.setWithCredentials(E.withCredentials);let k=0;function j(X){P.load(a[X],function(q){const K=E.parse(q,!0);M[X]={width:K.width,height:K.height,format:K.format,mipmaps:K.mipmaps},k+=1,k===6&&(K.mipmapCount===1&&(N.minFilter=ki),N.image=M,N.format=K.format,N.needsUpdate=!0,d&&d(N))},A,b)}if(Array.isArray(a))for(let X=0,q=a.length;X<q;++X)j(X);else P.load(a,function(X){const q=E.parse(X,!0);if(q.isCubemap){const K=q.mipmaps.length/q.mipmapCount;for(let te=0;te<K;te++){M[te]={mipmaps:[]};for(let oe=0;oe<q.mipmapCount;oe++)M[te].mipmaps.push(q.mipmaps[te*q.mipmapCount+oe]),M[te].format=q.format,M[te].width=q.width,M[te].height=q.height}N.image=M}else N.image.width=q.width,N.image.height=q.height,N.mipmaps=q.mipmaps;q.mipmapCount===1&&(N.minFilter=ki),N.format=q.format,N.needsUpdate=!0,d&&d(N)},A,b);return N}}class Vv extends nl{constructor(a){super(a)}load(a,d,A,b){this.path!==void 0&&(a=this.path+a),a=this.manager.resolveURL(a);const E=this,M=wh.get(a);if(M!==void 0)return E.manager.itemStart(a),setTimeout(function(){d&&d(M),E.manager.itemEnd(a)},0),M;const N=pf("img");function P(){j(),wh.add(a,this),d&&d(this),E.manager.itemEnd(a)}function k(X){j(),b&&b(X),E.manager.itemError(a),E.manager.itemEnd(a)}function j(){N.removeEventListener("load",P,!1),N.removeEventListener("error",k,!1)}return N.addEventListener("load",P,!1),N.addEventListener("error",k,!1),a.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(N.crossOrigin=this.crossOrigin),E.manager.itemStart(a),N.src=a,N}}class A3e extends nl{constructor(a){super(a)}load(a,d,A,b){const E=new vv;E.colorSpace=kn;const M=new Vv(this.manager);M.setCrossOrigin(this.crossOrigin),M.setPath(this.path);let N=0;function P(k){M.load(a[k],function(j){E.images[k]=j,N++,N===6&&(E.needsUpdate=!0,d&&d(E))},void 0,b)}for(let k=0;k<a.length;++k)P(k);return E}}class y3e extends nl{constructor(a){super(a)}load(a,d,A,b){const E=this,M=new jd,N=new Sh(this.manager);return N.setResponseType("arraybuffer"),N.setRequestHeader(this.requestHeader),N.setPath(this.path),N.setWithCredentials(E.withCredentials),N.load(a,function(P){let k;try{k=E.parse(P)}catch(j){if(b!==void 0)b(j);else{console.error(j);return}}k.image!==void 0?M.image=k.image:k.data!==void 0&&(M.image.width=k.width,M.image.height=k.height,M.image.data=k.data),M.wrapS=k.wrapS!==void 0?k.wrapS:je,M.wrapT=k.wrapT!==void 0?k.wrapT:je,M.magFilter=k.magFilter!==void 0?k.magFilter:ki,M.minFilter=k.minFilter!==void 0?k.minFilter:ki,M.anisotropy=k.anisotropy!==void 0?k.anisotropy:1,k.colorSpace!==void 0&&(M.colorSpace=k.colorSpace),k.flipY!==void 0&&(M.flipY=k.flipY),k.format!==void 0&&(M.format=k.format),k.type!==void 0&&(M.type=k.type),k.mipmaps!==void 0&&(M.mipmaps=k.mipmaps,M.minFilter=sn),k.mipmapCount===1&&(M.minFilter=ki),k.generateMipmaps!==void 0&&(M.generateMipmaps=k.generateMipmaps),M.needsUpdate=!0,d&&d(M,k)},A,b),M}}class v3e extends nl{constructor(a){super(a)}load(a,d,A,b){const E=new fs,M=new Vv(this.manager);return M.setCrossOrigin(this.crossOrigin),M.setPath(this.path),M.load(a,function(N){E.image=N,E.needsUpdate=!0,d!==void 0&&d(E)},A,b),E}}class Wd extends Qn{constructor(a,d=1){super(),this.isLight=!0,this.type="Light",this.color=new lr(a),this.intensity=d}dispose(){}copy(a,d){return super.copy(a,d),this.color.copy(a.color),this.intensity=a.intensity,this}toJSON(a){const d=super.toJSON(a);return d.object.color=this.color.getHex(),d.object.intensity=this.intensity,this.groundColor!==void 0&&(d.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(d.object.distance=this.distance),this.angle!==void 0&&(d.object.angle=this.angle),this.decay!==void 0&&(d.object.decay=this.decay),this.penumbra!==void 0&&(d.object.penumbra=this.penumbra),this.shadow!==void 0&&(d.object.shadow=this.shadow.toJSON()),d}}class dG extends Wd{constructor(a,d,A){super(a,A),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Qn.DEFAULT_UP),this.updateMatrix(),this.groundColor=new lr(d)}copy(a,d){return super.copy(a,d),this.groundColor.copy(a.groundColor),this}}const qN=new mr,pG=new He,fG=new He;class XN{constructor(a){this.camera=a,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new si(512,512),this.map=null,this.mapPass=null,this.matrix=new mr,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new xv,this._frameExtents=new si(1,1),this._viewportCount=1,this._viewports=[new jn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(a){const d=this.camera,A=this.matrix;pG.setFromMatrixPosition(a.matrixWorld),d.position.copy(pG),fG.setFromMatrixPosition(a.target.matrixWorld),d.lookAt(fG),d.updateMatrixWorld(),qN.multiplyMatrices(d.projectionMatrix,d.matrixWorldInverse),this._frustum.setFromProjectionMatrix(qN),A.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),A.multiply(qN)}getViewport(a){return this._viewports[a]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(a){return this.camera=a.camera.clone(),this.bias=a.bias,this.radius=a.radius,this.mapSize.copy(a.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const a={};return this.bias!==0&&(a.bias=this.bias),this.normalBias!==0&&(a.normalBias=this.normalBias),this.radius!==1&&(a.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(a.mapSize=this.mapSize.toArray()),a.camera=this.camera.toJSON(!1).object,delete a.camera.matrix,a}}class x3e extends XN{constructor(){super(new xa(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(a){const d=this.camera,A=Bd*2*a.angle*this.focus,b=this.mapSize.width/this.mapSize.height,E=a.distance||d.far;(A!==d.fov||b!==d.aspect||E!==d.far)&&(d.fov=A,d.aspect=b,d.far=E,d.updateProjectionMatrix()),super.updateMatrices(a)}copy(a){return super.copy(a),this.focus=a.focus,this}}class mG extends Wd{constructor(a,d,A=0,b=Math.PI/3,E=0,M=2){super(a,d),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Qn.DEFAULT_UP),this.updateMatrix(),this.target=new Qn,this.distance=A,this.angle=b,this.penumbra=E,this.decay=M,this.map=null,this.shadow=new x3e}get power(){return this.intensity*Math.PI}set power(a){this.intensity=a/Math.PI}dispose(){this.shadow.dispose()}copy(a,d){return super.copy(a,d),this.distance=a.distance,this.angle=a.angle,this.penumbra=a.penumbra,this.decay=a.decay,this.target=a.target.clone(),this.shadow=a.shadow.clone(),this}}const gG=new mr,Gv=new He,YN=new He;class b3e extends XN{constructor(){super(new xa(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new si(4,2),this._viewportCount=6,this._viewports=[new jn(2,1,1,1),new jn(0,1,1,1),new jn(3,1,1,1),new jn(1,1,1,1),new jn(3,0,1,1),new jn(1,0,1,1)],this._cubeDirections=[new He(1,0,0),new He(-1,0,0),new He(0,0,1),new He(0,0,-1),new He(0,1,0),new He(0,-1,0)],this._cubeUps=[new He(0,1,0),new He(0,1,0),new He(0,1,0),new He(0,1,0),new He(0,0,1),new He(0,0,-1)]}updateMatrices(a,d=0){const A=this.camera,b=this.matrix,E=a.distance||A.far;E!==A.far&&(A.far=E,A.updateProjectionMatrix()),Gv.setFromMatrixPosition(a.matrixWorld),A.position.copy(Gv),YN.copy(A.position),YN.add(this._cubeDirections[d]),A.up.copy(this._cubeUps[d]),A.lookAt(YN),A.updateMatrixWorld(),b.makeTranslation(-Gv.x,-Gv.y,-Gv.z),gG.multiplyMatrices(A.projectionMatrix,A.matrixWorldInverse),this._frustum.setFromProjectionMatrix(gG)}}class AG extends Wd{constructor(a,d,A=0,b=2){super(a,d),this.isPointLight=!0,this.type="PointLight",this.distance=A,this.decay=b,this.shadow=new b3e}get power(){return this.intensity*4*Math.PI}set power(a){this.intensity=a/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(a,d){return super.copy(a,d),this.distance=a.distance,this.decay=a.decay,this.shadow=a.shadow.clone(),this}}class _3e extends XN{constructor(){super(new JE(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class yG extends Wd{constructor(a,d){super(a,d),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Qn.DEFAULT_UP),this.updateMatrix(),this.target=new Qn,this.shadow=new _3e}dispose(){this.shadow.dispose()}copy(a){return super.copy(a),this.target=a.target.clone(),this.shadow=a.shadow.clone(),this}}class vG extends Wd{constructor(a,d){super(a,d),this.isAmbientLight=!0,this.type="AmbientLight"}}class xG extends Wd{constructor(a,d,A=10,b=10){super(a,d),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=A,this.height=b}get power(){return this.intensity*this.width*this.height*Math.PI}set power(a){this.intensity=a/(this.width*this.height*Math.PI)}copy(a){return super.copy(a),this.width=a.width,this.height=a.height,this}toJSON(a){const d=super.toJSON(a);return d.object.width=this.width,d.object.height=this.height,d}}class bG{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let a=0;a<9;a++)this.coefficients.push(new He)}set(a){for(let d=0;d<9;d++)this.coefficients[d].copy(a[d]);return this}zero(){for(let a=0;a<9;a++)this.coefficients[a].set(0,0,0);return this}getAt(a,d){const A=a.x,b=a.y,E=a.z,M=this.coefficients;return d.copy(M[0]).multiplyScalar(.282095),d.addScaledVector(M[1],.488603*b),d.addScaledVector(M[2],.488603*E),d.addScaledVector(M[3],.488603*A),d.addScaledVector(M[4],1.092548*(A*b)),d.addScaledVector(M[5],1.092548*(b*E)),d.addScaledVector(M[6],.315392*(3*E*E-1)),d.addScaledVector(M[7],1.092548*(A*E)),d.addScaledVector(M[8],.546274*(A*A-b*b)),d}getIrradianceAt(a,d){const A=a.x,b=a.y,E=a.z,M=this.coefficients;return d.copy(M[0]).multiplyScalar(.886227),d.addScaledVector(M[1],1.023328*b),d.addScaledVector(M[2],1.023328*E),d.addScaledVector(M[3],1.023328*A),d.addScaledVector(M[4],.858086*A*b),d.addScaledVector(M[5],.858086*b*E),d.addScaledVector(M[6],.743125*E*E-.247708),d.addScaledVector(M[7],.858086*A*E),d.addScaledVector(M[8],.429043*(A*A-b*b)),d}add(a){for(let d=0;d<9;d++)this.coefficients[d].add(a.coefficients[d]);return this}addScaledSH(a,d){for(let A=0;A<9;A++)this.coefficients[A].addScaledVector(a.coefficients[A],d);return this}scale(a){for(let d=0;d<9;d++)this.coefficients[d].multiplyScalar(a);return this}lerp(a,d){for(let A=0;A<9;A++)this.coefficients[A].lerp(a.coefficients[A],d);return this}equals(a){for(let d=0;d<9;d++)if(!this.coefficients[d].equals(a.coefficients[d]))return!1;return!0}copy(a){return this.set(a.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(a,d=0){const A=this.coefficients;for(let b=0;b<9;b++)A[b].fromArray(a,d+b*3);return this}toArray(a=[],d=0){const A=this.coefficients;for(let b=0;b<9;b++)A[b].toArray(a,d+b*3);return a}static getBasisAt(a,d){const A=a.x,b=a.y,E=a.z;d[0]=.282095,d[1]=.488603*b,d[2]=.488603*E,d[3]=.488603*A,d[4]=1.092548*A*b,d[5]=1.092548*b*E,d[6]=.315392*(3*E*E-1),d[7]=1.092548*A*E,d[8]=.546274*(A*A-b*b)}}class _G extends Wd{constructor(a=new bG,d=1){super(void 0,d),this.isLightProbe=!0,this.sh=a}copy(a){return super.copy(a),this.sh.copy(a.sh),this}fromJSON(a){return this.intensity=a.intensity,this.sh.fromArray(a.sh),this}toJSON(a){const d=super.toJSON(a);return d.object.sh=this.sh.toArray(),d}}class jw extends nl{constructor(a){super(a),this.textures={}}load(a,d,A,b){const E=this,M=new Sh(E.manager);M.setPath(E.path),M.setRequestHeader(E.requestHeader),M.setWithCredentials(E.withCredentials),M.load(a,function(N){try{d(E.parse(JSON.parse(N)))}catch(P){b?b(P):console.error(P),E.manager.itemError(a)}},A,b)}parse(a){const d=this.textures;function A(E){return d[E]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",E),d[E]}const b=jw.createMaterialFromType(a.type);if(a.uuid!==void 0&&(b.uuid=a.uuid),a.name!==void 0&&(b.name=a.name),a.color!==void 0&&b.color!==void 0&&b.color.setHex(a.color),a.roughness!==void 0&&(b.roughness=a.roughness),a.metalness!==void 0&&(b.metalness=a.metalness),a.sheen!==void 0&&(b.sheen=a.sheen),a.sheenColor!==void 0&&(b.sheenColor=new lr().setHex(a.sheenColor)),a.sheenRoughness!==void 0&&(b.sheenRoughness=a.sheenRoughness),a.emissive!==void 0&&b.emissive!==void 0&&b.emissive.setHex(a.emissive),a.specular!==void 0&&b.specular!==void 0&&b.specular.setHex(a.specular),a.specularIntensity!==void 0&&(b.specularIntensity=a.specularIntensity),a.specularColor!==void 0&&b.specularColor!==void 0&&b.specularColor.setHex(a.specularColor),a.shininess!==void 0&&(b.shininess=a.shininess),a.clearcoat!==void 0&&(b.clearcoat=a.clearcoat),a.clearcoatRoughness!==void 0&&(b.clearcoatRoughness=a.clearcoatRoughness),a.dispersion!==void 0&&(b.dispersion=a.dispersion),a.iridescence!==void 0&&(b.iridescence=a.iridescence),a.iridescenceIOR!==void 0&&(b.iridescenceIOR=a.iridescenceIOR),a.iridescenceThicknessRange!==void 0&&(b.iridescenceThicknessRange=a.iridescenceThicknessRange),a.transmission!==void 0&&(b.transmission=a.transmission),a.thickness!==void 0&&(b.thickness=a.thickness),a.attenuationDistance!==void 0&&(b.attenuationDistance=a.attenuationDistance),a.attenuationColor!==void 0&&b.attenuationColor!==void 0&&b.attenuationColor.setHex(a.attenuationColor),a.anisotropy!==void 0&&(b.anisotropy=a.anisotropy),a.anisotropyRotation!==void 0&&(b.anisotropyRotation=a.anisotropyRotation),a.fog!==void 0&&(b.fog=a.fog),a.flatShading!==void 0&&(b.flatShading=a.flatShading),a.blending!==void 0&&(b.blending=a.blending),a.combine!==void 0&&(b.combine=a.combine),a.side!==void 0&&(b.side=a.side),a.shadowSide!==void 0&&(b.shadowSide=a.shadowSide),a.opacity!==void 0&&(b.opacity=a.opacity),a.transparent!==void 0&&(b.transparent=a.transparent),a.alphaTest!==void 0&&(b.alphaTest=a.alphaTest),a.alphaHash!==void 0&&(b.alphaHash=a.alphaHash),a.depthFunc!==void 0&&(b.depthFunc=a.depthFunc),a.depthTest!==void 0&&(b.depthTest=a.depthTest),a.depthWrite!==void 0&&(b.depthWrite=a.depthWrite),a.colorWrite!==void 0&&(b.colorWrite=a.colorWrite),a.blendSrc!==void 0&&(b.blendSrc=a.blendSrc),a.blendDst!==void 0&&(b.blendDst=a.blendDst),a.blendEquation!==void 0&&(b.blendEquation=a.blendEquation),a.blendSrcAlpha!==void 0&&(b.blendSrcAlpha=a.blendSrcAlpha),a.blendDstAlpha!==void 0&&(b.blendDstAlpha=a.blendDstAlpha),a.blendEquationAlpha!==void 0&&(b.blendEquationAlpha=a.blendEquationAlpha),a.blendColor!==void 0&&b.blendColor!==void 0&&b.blendColor.setHex(a.blendColor),a.blendAlpha!==void 0&&(b.blendAlpha=a.blendAlpha),a.stencilWriteMask!==void 0&&(b.stencilWriteMask=a.stencilWriteMask),a.stencilFunc!==void 0&&(b.stencilFunc=a.stencilFunc),a.stencilRef!==void 0&&(b.stencilRef=a.stencilRef),a.stencilFuncMask!==void 0&&(b.stencilFuncMask=a.stencilFuncMask),a.stencilFail!==void 0&&(b.stencilFail=a.stencilFail),a.stencilZFail!==void 0&&(b.stencilZFail=a.stencilZFail),a.stencilZPass!==void 0&&(b.stencilZPass=a.stencilZPass),a.stencilWrite!==void 0&&(b.stencilWrite=a.stencilWrite),a.wireframe!==void 0&&(b.wireframe=a.wireframe),a.wireframeLinewidth!==void 0&&(b.wireframeLinewidth=a.wireframeLinewidth),a.wireframeLinecap!==void 0&&(b.wireframeLinecap=a.wireframeLinecap),a.wireframeLinejoin!==void 0&&(b.wireframeLinejoin=a.wireframeLinejoin),a.rotation!==void 0&&(b.rotation=a.rotation),a.linewidth!==void 0&&(b.linewidth=a.linewidth),a.dashSize!==void 0&&(b.dashSize=a.dashSize),a.gapSize!==void 0&&(b.gapSize=a.gapSize),a.scale!==void 0&&(b.scale=a.scale),a.polygonOffset!==void 0&&(b.polygonOffset=a.polygonOffset),a.polygonOffsetFactor!==void 0&&(b.polygonOffsetFactor=a.polygonOffsetFactor),a.polygonOffsetUnits!==void 0&&(b.polygonOffsetUnits=a.polygonOffsetUnits),a.dithering!==void 0&&(b.dithering=a.dithering),a.alphaToCoverage!==void 0&&(b.alphaToCoverage=a.alphaToCoverage),a.premultipliedAlpha!==void 0&&(b.premultipliedAlpha=a.premultipliedAlpha),a.forceSinglePass!==void 0&&(b.forceSinglePass=a.forceSinglePass),a.visible!==void 0&&(b.visible=a.visible),a.toneMapped!==void 0&&(b.toneMapped=a.toneMapped),a.userData!==void 0&&(b.userData=a.userData),a.vertexColors!==void 0&&(typeof a.vertexColors=="number"?b.vertexColors=a.vertexColors>0:b.vertexColors=a.vertexColors),a.uniforms!==void 0)for(const E in a.uniforms){const M=a.uniforms[E];switch(b.uniforms[E]={},M.type){case"t":b.uniforms[E].value=A(M.value);break;case"c":b.uniforms[E].value=new lr().setHex(M.value);break;case"v2":b.uniforms[E].value=new si().fromArray(M.value);break;case"v3":b.uniforms[E].value=new He().fromArray(M.value);break;case"v4":b.uniforms[E].value=new jn().fromArray(M.value);break;case"m3":b.uniforms[E].value=new Kr().fromArray(M.value);break;case"m4":b.uniforms[E].value=new mr().fromArray(M.value);break;default:b.uniforms[E].value=M.value}}if(a.defines!==void 0&&(b.defines=a.defines),a.vertexShader!==void 0&&(b.vertexShader=a.vertexShader),a.fragmentShader!==void 0&&(b.fragmentShader=a.fragmentShader),a.glslVersion!==void 0&&(b.glslVersion=a.glslVersion),a.extensions!==void 0)for(const E in a.extensions)b.extensions[E]=a.extensions[E];if(a.lights!==void 0&&(b.lights=a.lights),a.clipping!==void 0&&(b.clipping=a.clipping),a.size!==void 0&&(b.size=a.size),a.sizeAttenuation!==void 0&&(b.sizeAttenuation=a.sizeAttenuation),a.map!==void 0&&(b.map=A(a.map)),a.matcap!==void 0&&(b.matcap=A(a.matcap)),a.alphaMap!==void 0&&(b.alphaMap=A(a.alphaMap)),a.bumpMap!==void 0&&(b.bumpMap=A(a.bumpMap)),a.bumpScale!==void 0&&(b.bumpScale=a.bumpScale),a.normalMap!==void 0&&(b.normalMap=A(a.normalMap)),a.normalMapType!==void 0&&(b.normalMapType=a.normalMapType),a.normalScale!==void 0){let E=a.normalScale;Array.isArray(E)===!1&&(E=[E,E]),b.normalScale=new si().fromArray(E)}return a.displacementMap!==void 0&&(b.displacementMap=A(a.displacementMap)),a.displacementScale!==void 0&&(b.displacementScale=a.displacementScale),a.displacementBias!==void 0&&(b.displacementBias=a.displacementBias),a.roughnessMap!==void 0&&(b.roughnessMap=A(a.roughnessMap)),a.metalnessMap!==void 0&&(b.metalnessMap=A(a.metalnessMap)),a.emissiveMap!==void 0&&(b.emissiveMap=A(a.emissiveMap)),a.emissiveIntensity!==void 0&&(b.emissiveIntensity=a.emissiveIntensity),a.specularMap!==void 0&&(b.specularMap=A(a.specularMap)),a.specularIntensityMap!==void 0&&(b.specularIntensityMap=A(a.specularIntensityMap)),a.specularColorMap!==void 0&&(b.specularColorMap=A(a.specularColorMap)),a.envMap!==void 0&&(b.envMap=A(a.envMap)),a.envMapRotation!==void 0&&b.envMapRotation.fromArray(a.envMapRotation),a.envMapIntensity!==void 0&&(b.envMapIntensity=a.envMapIntensity),a.reflectivity!==void 0&&(b.reflectivity=a.reflectivity),a.refractionRatio!==void 0&&(b.refractionRatio=a.refractionRatio),a.lightMap!==void 0&&(b.lightMap=A(a.lightMap)),a.lightMapIntensity!==void 0&&(b.lightMapIntensity=a.lightMapIntensity),a.aoMap!==void 0&&(b.aoMap=A(a.aoMap)),a.aoMapIntensity!==void 0&&(b.aoMapIntensity=a.aoMapIntensity),a.gradientMap!==void 0&&(b.gradientMap=A(a.gradientMap)),a.clearcoatMap!==void 0&&(b.clearcoatMap=A(a.clearcoatMap)),a.clearcoatRoughnessMap!==void 0&&(b.clearcoatRoughnessMap=A(a.clearcoatRoughnessMap)),a.clearcoatNormalMap!==void 0&&(b.clearcoatNormalMap=A(a.clearcoatNormalMap)),a.clearcoatNormalScale!==void 0&&(b.clearcoatNormalScale=new si().fromArray(a.clearcoatNormalScale)),a.iridescenceMap!==void 0&&(b.iridescenceMap=A(a.iridescenceMap)),a.iridescenceThicknessMap!==void 0&&(b.iridescenceThicknessMap=A(a.iridescenceThicknessMap)),a.transmissionMap!==void 0&&(b.transmissionMap=A(a.transmissionMap)),a.thicknessMap!==void 0&&(b.thicknessMap=A(a.thicknessMap)),a.anisotropyMap!==void 0&&(b.anisotropyMap=A(a.anisotropyMap)),a.sheenColorMap!==void 0&&(b.sheenColorMap=A(a.sheenColorMap)),a.sheenRoughnessMap!==void 0&&(b.sheenRoughnessMap=A(a.sheenRoughnessMap)),b}setTextures(a){return this.textures=a,this}static createMaterialFromType(a){const d={ShadowMaterial:JV,SpriteMaterial:vN,RawShaderMaterial:ZV,ShaderMaterial:Nc,PointsMaterial:TN,MeshPhysicalMaterial:$V,MeshStandardMaterial:jN,MeshPhongMaterial:eG,MeshToonMaterial:tG,MeshNormalMaterial:iG,MeshLambertMaterial:rG,MeshDepthMaterial:mN,MeshDistanceMaterial:gN,MeshBasicMaterial:Fd,MeshMatcapMaterial:nG,LineDashedMaterial:sG,LineBasicMaterial:Oo,Material:po};return new d[a]}}class KN{static decodeText(a){if(typeof TextDecoder<"u")return new TextDecoder().decode(a);let d="";for(let A=0,b=a.length;A<b;A++)d+=String.fromCharCode(a[A]);try{return decodeURIComponent(escape(d))}catch{return d}}static extractUrlBase(a){const d=a.lastIndexOf("/");return d===-1?"./":a.slice(0,d+1)}static resolveURL(a,d){return typeof a!="string"||a===""?"":(/^https?:\/\//i.test(d)&&/^\//.test(a)&&(d=d.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(a)||/^data:.*,.*$/i.test(a)||/^blob:.*$/i.test(a)?a:d+a)}}class EG extends fn{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(a){return super.copy(a),this.instanceCount=a.instanceCount,this}toJSON(){const a=super.toJSON();return a.instanceCount=this.instanceCount,a.isInstancedBufferGeometry=!0,a}}class wG extends nl{constructor(a){super(a)}load(a,d,A,b){const E=this,M=new Sh(E.manager);M.setPath(E.path),M.setRequestHeader(E.requestHeader),M.setWithCredentials(E.withCredentials),M.load(a,function(N){try{d(E.parse(JSON.parse(N)))}catch(P){b?b(P):console.error(P),E.manager.itemError(a)}},A,b)}parse(a){const d={},A={};function b(q,K){if(d[K]!==void 0)return d[K];const te=q.interleavedBuffers[K],oe=E(q,te.buffer),re=Nd(te.type,oe),ee=new rw(re,te.stride);return ee.uuid=te.uuid,d[K]=ee,ee}function E(q,K){if(A[K]!==void 0)return A[K];const te=q.arrayBuffers[K],oe=new Uint32Array(te).buffer;return A[K]=oe,oe}const M=a.isInstancedBufferGeometry?new EG:new fn,N=a.data.index;if(N!==void 0){const q=Nd(N.type,N.array);M.setIndex(new ls(q,1))}const P=a.data.attributes;for(const q in P){const K=P[q];let te;if(K.isInterleavedBufferAttribute){const oe=b(a.data,K.data);te=new _f(oe,K.itemSize,K.offset,K.normalized)}else{const oe=Nd(K.type,K.array),re=K.isInstancedBufferAttribute?S0:ls;te=new re(oe,K.itemSize,K.normalized)}K.name!==void 0&&(te.name=K.name),K.usage!==void 0&&te.setUsage(K.usage),M.setAttribute(q,te)}const k=a.data.morphAttributes;if(k)for(const q in k){const K=k[q],te=[];for(let oe=0,re=K.length;oe<re;oe++){const ee=K[oe];let Me;if(ee.isInterleavedBufferAttribute){const we=b(a.data,ee.data);Me=new _f(we,ee.itemSize,ee.offset,ee.normalized)}else{const we=Nd(ee.type,ee.array);Me=new ls(we,ee.itemSize,ee.normalized)}ee.name!==void 0&&(Me.name=ee.name),te.push(Me)}M.morphAttributes[q]=te}a.data.morphTargetsRelative&&(M.morphTargetsRelative=!0);const j=a.data.groups||a.data.drawcalls||a.data.offsets;if(j!==void 0)for(let q=0,K=j.length;q!==K;++q){const te=j[q];M.addGroup(te.start,te.count,te.materialIndex)}const X=a.data.boundingSphere;if(X!==void 0){const q=new He;X.center!==void 0&&q.fromArray(X.center),M.boundingSphere=new ya(q,X.radius)}return a.name&&(M.name=a.name),a.userData&&(M.userData=a.userData),M}}class E3e extends nl{constructor(a){super(a)}load(a,d,A,b){const E=this,M=this.path===""?KN.extractUrlBase(a):this.path;this.resourcePath=this.resourcePath||M;const N=new Sh(this.manager);N.setPath(this.path),N.setRequestHeader(this.requestHeader),N.setWithCredentials(this.withCredentials),N.load(a,function(P){let k=null;try{k=JSON.parse(P)}catch(X){b!==void 0&&b(X),console.error("THREE:ObjectLoader: Can't parse "+a+".",X.message);return}const j=k.metadata;if(j===void 0||j.type===void 0||j.type.toLowerCase()==="geometry"){b!==void 0&&b(new Error("THREE.ObjectLoader: Can't load "+a)),console.error("THREE.ObjectLoader: Can't load "+a);return}E.parse(k,d)},A,b)}async loadAsync(a,d){const A=this,b=this.path===""?KN.extractUrlBase(a):this.path;this.resourcePath=this.resourcePath||b;const E=new Sh(this.manager);E.setPath(this.path),E.setRequestHeader(this.requestHeader),E.setWithCredentials(this.withCredentials);const M=await E.loadAsync(a,d),N=JSON.parse(M),P=N.metadata;if(P===void 0||P.type===void 0||P.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+a);return await A.parseAsync(N)}parse(a,d){const A=this.parseAnimations(a.animations),b=this.parseShapes(a.shapes),E=this.parseGeometries(a.geometries,b),M=this.parseImages(a.images,function(){d!==void 0&&d(k)}),N=this.parseTextures(a.textures,M),P=this.parseMaterials(a.materials,N),k=this.parseObject(a.object,E,P,N,A),j=this.parseSkeletons(a.skeletons,k);if(this.bindSkeletons(k,j),d!==void 0){let X=!1;for(const q in M)if(M[q].data instanceof HTMLImageElement){X=!0;break}X===!1&&d(k)}return k}async parseAsync(a){const d=this.parseAnimations(a.animations),A=this.parseShapes(a.shapes),b=this.parseGeometries(a.geometries,A),E=await this.parseImagesAsync(a.images),M=this.parseTextures(a.textures,E),N=this.parseMaterials(a.materials,M),P=this.parseObject(a.object,b,N,M,d),k=this.parseSkeletons(a.skeletons,P);return this.bindSkeletons(P,k),P}parseShapes(a){const d={};if(a!==void 0)for(let A=0,b=a.length;A<b;A++){const E=new wf().fromJSON(a[A]);d[E.uuid]=E}return d}parseSkeletons(a,d){const A={},b={};if(d.traverse(function(E){E.isBone&&(b[E.uuid]=E)}),a!==void 0)for(let E=0,M=a.length;E<M;E++){const N=new cw().fromJSON(a[E],b);A[N.uuid]=N}return A}parseGeometries(a,d){const A={};if(a!==void 0){const E=new wG;for(let M=0,N=a.length;M<N;M++){let P;const k=a[M];switch(k.type){case"BufferGeometry":case"InstancedBufferGeometry":P=E.parse(k);break;case"Geometry":if("THREE"in window&&"LegacyJSONLoader"in THREE){var b=new THREE.LegacyJSONLoader;P=b.parse(k,this.resourcePath).geometry}else console.error('THREE.ObjectLoader: You have to import LegacyJSONLoader in order load geometry data of type "Geometry".');break;default:k.type in KV?P=KV[k.type].fromJSON(k,d):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${k.type}"`)}P.uuid=k.uuid,k.name!==void 0&&(P.name=k.name),k.userData!==void 0&&(P.userData=k.userData),A[k.uuid]=P}}return A}parseMaterials(a,d){const A={},b={};if(a!==void 0){const E=new jw;E.setTextures(d);for(let M=0,N=a.length;M<N;M++){const P=a[M];A[P.uuid]===void 0&&(A[P.uuid]=E.parse(P)),b[P.uuid]=A[P.uuid]}}return b}parseAnimations(a){const d={};if(a!==void 0)for(let A=0;A<a.length;A++){const b=a[A],E=jv.parse(b);d[E.uuid]=E}return d}parseImages(a,d){const A=this,b={};let E;function M(P){return A.manager.itemStart(P),E.load(P,function(){A.manager.itemEnd(P)},void 0,function(){A.manager.itemError(P),A.manager.itemEnd(P)})}function N(P){if(typeof P=="string"){const k=P,j=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(k)?k:A.resourcePath+k;return M(j)}else return P.data?{data:Nd(P.type,P.data),width:P.width,height:P.height}:null}if(a!==void 0&&a.length>0){const P=new QN(d);E=new Vv(P),E.setCrossOrigin(this.crossOrigin);for(let k=0,j=a.length;k<j;k++){const X=a[k],q=X.url;if(Array.isArray(q)){const K=[];for(let te=0,oe=q.length;te<oe;te++){const re=q[te],ee=N(re);ee!==null&&(ee instanceof HTMLImageElement?K.push(ee):K.push(new jd(ee.data,ee.width,ee.height)))}b[X.uuid]=new _s(K)}else{const K=N(X.url);b[X.uuid]=new _s(K)}}}return b}async parseImagesAsync(a){const d=this,A={};let b;async function E(M){if(typeof M=="string"){const N=M,P=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(N)?N:d.resourcePath+N;return await b.loadAsync(P)}else return M.data?{data:Nd(M.type,M.data),width:M.width,height:M.height}:null}if(a!==void 0&&a.length>0){b=new Vv(this.manager),b.setCrossOrigin(this.crossOrigin);for(let M=0,N=a.length;M<N;M++){const P=a[M],k=P.url;if(Array.isArray(k)){const j=[];for(let X=0,q=k.length;X<q;X++){const K=k[X],te=await E(K);te!==null&&(te instanceof HTMLImageElement?j.push(te):j.push(new jd(te.data,te.width,te.height)))}A[P.uuid]=new _s(j)}else{const j=await E(P.url);A[P.uuid]=new _s(j)}}}return A}parseTextures(a,d){function A(E,M){return typeof E=="number"?E:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",E),M[E])}const b={};if(a!==void 0)for(let E=0,M=a.length;E<M;E++){const N=a[E];N.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',N.uuid),d[N.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",N.image);const P=d[N.image],k=P.data;let j;Array.isArray(k)?(j=new vv,k.length===6&&(j.needsUpdate=!0)):(k&&k.data?j=new jd:j=new fs,k&&(j.needsUpdate=!0)),j.source=P,j.uuid=N.uuid,N.name!==void 0&&(j.name=N.name),N.mapping!==void 0&&(j.mapping=A(N.mapping,w3e)),N.channel!==void 0&&(j.channel=N.channel),N.offset!==void 0&&j.offset.fromArray(N.offset),N.repeat!==void 0&&j.repeat.fromArray(N.repeat),N.center!==void 0&&j.center.fromArray(N.center),N.rotation!==void 0&&(j.rotation=N.rotation),N.wrap!==void 0&&(j.wrapS=A(N.wrap[0],CG),j.wrapT=A(N.wrap[1],CG)),N.format!==void 0&&(j.format=N.format),N.internalFormat!==void 0&&(j.internalFormat=N.internalFormat),N.type!==void 0&&(j.type=N.type),N.colorSpace!==void 0&&(j.colorSpace=N.colorSpace),N.minFilter!==void 0&&(j.minFilter=A(N.minFilter,SG)),N.magFilter!==void 0&&(j.magFilter=A(N.magFilter,SG)),N.anisotropy!==void 0&&(j.anisotropy=N.anisotropy),N.flipY!==void 0&&(j.flipY=N.flipY),N.generateMipmaps!==void 0&&(j.generateMipmaps=N.generateMipmaps),N.premultiplyAlpha!==void 0&&(j.premultiplyAlpha=N.premultiplyAlpha),N.unpackAlignment!==void 0&&(j.unpackAlignment=N.unpackAlignment),N.compareFunction!==void 0&&(j.compareFunction=N.compareFunction),N.userData!==void 0&&(j.userData=N.userData),b[N.uuid]=j}return b}parseObject(a,d,A,b,E){let M;function N(q){return d[q]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",q),d[q]}function P(q){if(q!==void 0){if(Array.isArray(q)){const K=[];for(let te=0,oe=q.length;te<oe;te++){const re=q[te];A[re]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",re),K.push(A[re])}return K}return A[q]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",q),A[q]}}function k(q){return b[q]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",q),b[q]}let j,X;switch(a.type){case"Scene":M=new oV,a.background!==void 0&&(Number.isInteger(a.background)?M.background=new lr(a.background):M.background=k(a.background)),a.environment!==void 0&&(M.environment=k(a.environment)),a.fog!==void 0&&(a.fog.type==="Fog"?M.fog=new iw(a.fog.color,a.fog.near,a.fog.far):a.fog.type==="FogExp2"&&(M.fog=new tw(a.fog.color,a.fog.density)),a.fog.name!==""&&(M.fog.name=a.fog.name)),a.backgroundBlurriness!==void 0&&(M.backgroundBlurriness=a.backgroundBlurriness),a.backgroundIntensity!==void 0&&(M.backgroundIntensity=a.backgroundIntensity),a.backgroundRotation!==void 0&&M.backgroundRotation.fromArray(a.backgroundRotation),a.environmentIntensity!==void 0&&(M.environmentIntensity=a.environmentIntensity),a.environmentRotation!==void 0&&M.environmentRotation.fromArray(a.environmentRotation);break;case"PerspectiveCamera":M=new xa(a.fov,a.aspect,a.near,a.far),a.focus!==void 0&&(M.focus=a.focus),a.zoom!==void 0&&(M.zoom=a.zoom),a.filmGauge!==void 0&&(M.filmGauge=a.filmGauge),a.filmOffset!==void 0&&(M.filmOffset=a.filmOffset),a.view!==void 0&&(M.view=Object.assign({},a.view));break;case"OrthographicCamera":M=new JE(a.left,a.right,a.top,a.bottom,a.near,a.far),a.zoom!==void 0&&(M.zoom=a.zoom),a.view!==void 0&&(M.view=Object.assign({},a.view));break;case"AmbientLight":M=new vG(a.color,a.intensity);break;case"DirectionalLight":M=new yG(a.color,a.intensity);break;case"PointLight":M=new AG(a.color,a.intensity,a.distance,a.decay);break;case"RectAreaLight":M=new xG(a.color,a.intensity,a.width,a.height);break;case"SpotLight":M=new mG(a.color,a.intensity,a.distance,a.angle,a.penumbra,a.decay);break;case"HemisphereLight":M=new dG(a.color,a.groundColor,a.intensity);break;case"LightProbe":M=new _G().fromJSON(a);break;case"SkinnedMesh":j=N(a.geometry),X=P(a.material),M=new vV(j,X),a.bindMode!==void 0&&(M.bindMode=a.bindMode),a.bindMatrix!==void 0&&M.bindMatrix.fromArray(a.bindMatrix),a.skeleton!==void 0&&(M.skeleton=a.skeleton);break;case"Mesh":j=N(a.geometry),X=P(a.material),M=new ua(j,X);break;case"InstancedMesh":j=N(a.geometry),X=P(a.material);const q=a.count,K=a.instanceMatrix,te=a.instanceColor;M=new EV(j,X,q),M.instanceMatrix=new S0(new Float32Array(K.array),16),te!==void 0&&(M.instanceColor=new S0(new Float32Array(te.array),te.itemSize));break;case"BatchedMesh":j=N(a.geometry),X=P(a.material),M=new SV(a.maxGeometryCount,a.maxVertexCount,a.maxIndexCount,X),M.geometry=j,M.perObjectFrustumCulled=a.perObjectFrustumCulled,M.sortObjects=a.sortObjects,M._drawRanges=a.drawRanges,M._reservedRanges=a.reservedRanges,M._visibility=a.visibility,M._active=a.active,M._bounds=a.bounds.map(oe=>{const re=new Ds;re.min.fromArray(oe.boxMin),re.max.fromArray(oe.boxMax);const ee=new ya;return ee.radius=oe.sphereRadius,ee.center.fromArray(oe.sphereCenter),{boxInitialized:oe.boxInitialized,box:re,sphereInitialized:oe.sphereInitialized,sphere:ee}}),M._maxGeometryCount=a.maxGeometryCount,M._maxVertexCount=a.maxVertexCount,M._maxIndexCount=a.maxIndexCount,M._geometryInitialized=a.geometryInitialized,M._geometryCount=a.geometryCount,M._matricesTexture=k(a.matricesTexture.uuid);break;case"LOD":M=new pV;break;case"Line":M=new Gd(N(a.geometry),P(a.material));break;case"LineLoop":M=new BV(N(a.geometry),P(a.material));break;case"LineSegments":M=new nu(N(a.geometry),P(a.material));break;case"PointCloud":case"Points":M=new LV(N(a.geometry),P(a.material));break;case"Sprite":M=new hV(P(a.material));break;case"Group":M=new xf;break;case"Bone":M=new EN;break;default:M=new Qn}if(M.uuid=a.uuid,a.name!==void 0&&(M.name=a.name),a.matrix!==void 0?(M.matrix.fromArray(a.matrix),a.matrixAutoUpdate!==void 0&&(M.matrixAutoUpdate=a.matrixAutoUpdate),M.matrixAutoUpdate&&M.matrix.decompose(M.position,M.quaternion,M.scale)):(a.position!==void 0&&M.position.fromArray(a.position),a.rotation!==void 0&&M.rotation.fromArray(a.rotation),a.quaternion!==void 0&&M.quaternion.fromArray(a.quaternion),a.scale!==void 0&&M.scale.fromArray(a.scale)),a.up!==void 0&&M.up.fromArray(a.up),a.castShadow!==void 0&&(M.castShadow=a.castShadow),a.receiveShadow!==void 0&&(M.receiveShadow=a.receiveShadow),a.shadow&&(a.shadow.bias!==void 0&&(M.shadow.bias=a.shadow.bias),a.shadow.normalBias!==void 0&&(M.shadow.normalBias=a.shadow.normalBias),a.shadow.radius!==void 0&&(M.shadow.radius=a.shadow.radius),a.shadow.mapSize!==void 0&&M.shadow.mapSize.fromArray(a.shadow.mapSize),a.shadow.camera!==void 0&&(M.shadow.camera=this.parseObject(a.shadow.camera))),a.visible!==void 0&&(M.visible=a.visible),a.frustumCulled!==void 0&&(M.frustumCulled=a.frustumCulled),a.renderOrder!==void 0&&(M.renderOrder=a.renderOrder),a.userData!==void 0&&(M.userData=a.userData),a.layers!==void 0&&(M.layers.mask=a.layers),a.children!==void 0){const q=a.children;for(let K=0;K<q.length;K++)M.add(this.parseObject(q[K],d,A,b,E))}if(a.animations!==void 0){const q=a.animations;for(let K=0;K<q.length;K++){const te=q[K];M.animations.push(E[te])}}if(a.type==="LOD"){a.autoUpdate!==void 0&&(M.autoUpdate=a.autoUpdate);const q=a.levels;for(let K=0;K<q.length;K++){const te=q[K],oe=M.getObjectByProperty("uuid",te.object);oe!==void 0&&M.addLevel(oe,te.distance,te.hysteresis)}}return M}bindSkeletons(a,d){Object.keys(d).length!==0&&a.traverse(function(A){if(A.isSkinnedMesh===!0&&A.skeleton!==void 0){const b=d[A.skeleton];b===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",A.skeleton):A.bind(b,A.bindMatrix)}})}}const w3e={UVMapping:Pe,CubeReflectionMapping:F,CubeRefractionMapping:J,EquirectangularReflectionMapping:ie,EquirectangularRefractionMapping:Re,CubeUVReflectionMapping:ce},CG={RepeatWrapping:Ue,ClampToEdgeWrapping:je,MirroredRepeatWrapping:dt},SG={NearestFilter:It,NearestMipmapNearestFilter:bt,NearestMipmapLinearFilter:pi,LinearFilter:ki,LinearMipmapNearestFilter:An,LinearMipmapLinearFilter:sn};class C3e extends nl{constructor(a){super(a),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(a){return this.options=a,this}load(a,d,A,b){a===void 0&&(a=""),this.path!==void 0&&(a=this.path+a),a=this.manager.resolveURL(a);const E=this,M=wh.get(a);if(M!==void 0){if(E.manager.itemStart(a),M.then){M.then(k=>{d&&d(k),E.manager.itemEnd(a)}).catch(k=>{b&&b(k)});return}return setTimeout(function(){d&&d(M),E.manager.itemEnd(a)},0),M}const N={};N.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",N.headers=this.requestHeader;const P=fetch(a,N).then(function(k){return k.blob()}).then(function(k){return createImageBitmap(k,Object.assign(E.options,{colorSpaceConversion:"none"}))}).then(function(k){return wh.add(a,k),d&&d(k),E.manager.itemEnd(a),k}).catch(function(k){b&&b(k),wh.remove(a),E.manager.itemError(a),E.manager.itemEnd(a)});wh.add(a,P),E.manager.itemStart(a)}}let Vw;class JN{static getContext(){return Vw===void 0&&(Vw=new(window.AudioContext||window.webkitAudioContext)),Vw}static setContext(a){Vw=a}}class S3e extends nl{constructor(a){super(a)}load(a,d,A,b){const E=this,M=new Sh(this.manager);M.setResponseType("arraybuffer"),M.setPath(this.path),M.setRequestHeader(this.requestHeader),M.setWithCredentials(this.withCredentials),M.load(a,function(P){try{const k=P.slice(0);JN.getContext().decodeAudioData(k,function(j){d(j)}).catch(N)}catch(k){N(k)}},A,b);function N(P){b?b(P):console.error(P),E.manager.itemError(a)}}}const TG=new mr,MG=new mr,Rf=new mr;class T3e{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new xa,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new xa,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(a){const d=this._cache;if(d.focus!==a.focus||d.fov!==a.fov||d.aspect!==a.aspect*this.aspect||d.near!==a.near||d.far!==a.far||d.zoom!==a.zoom||d.eyeSep!==this.eyeSep){d.focus=a.focus,d.fov=a.fov,d.aspect=a.aspect*this.aspect,d.near=a.near,d.far=a.far,d.zoom=a.zoom,d.eyeSep=this.eyeSep,Rf.copy(a.projectionMatrix);const A=d.eyeSep/2,b=A*d.near/d.focus,E=d.near*Math.tan(gh*d.fov*.5)/d.zoom;let M,N;MG.elements[12]=-A,TG.elements[12]=A,M=-E*d.aspect+b,N=E*d.aspect+b,Rf.elements[0]=2*d.near/(N-M),Rf.elements[8]=(N+M)/(N-M),this.cameraL.projectionMatrix.copy(Rf),M=-E*d.aspect-b,N=E*d.aspect-b,Rf.elements[0]=2*d.near/(N-M),Rf.elements[8]=(N+M)/(N-M),this.cameraR.projectionMatrix.copy(Rf)}this.cameraL.matrixWorld.copy(a.matrixWorld).multiply(MG),this.cameraR.matrixWorld.copy(a.matrixWorld).multiply(TG)}}class RG{constructor(a=!0){this.autoStart=a,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=IG(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let a=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const d=IG();a=(d-this.oldTime)/1e3,this.oldTime=d,this.elapsedTime+=a}return a}}function IG(){return(typeof performance>"u"?Date:performance).now()}const If=new He,BG=new Wn,M3e=new He,Bf=new He;class R3e extends Qn{constructor(){super(),this.type="AudioListener",this.context=JN.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new RG}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(a){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=a,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(a){return this.gain.gain.setTargetAtTime(a,this.context.currentTime,.01),this}updateMatrixWorld(a){super.updateMatrixWorld(a);const d=this.context.listener,A=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(If,BG,M3e),Bf.set(0,0,-1).applyQuaternion(BG),d.positionX){const b=this.context.currentTime+this.timeDelta;d.positionX.linearRampToValueAtTime(If.x,b),d.positionY.linearRampToValueAtTime(If.y,b),d.positionZ.linearRampToValueAtTime(If.z,b),d.forwardX.linearRampToValueAtTime(Bf.x,b),d.forwardY.linearRampToValueAtTime(Bf.y,b),d.forwardZ.linearRampToValueAtTime(Bf.z,b),d.upX.linearRampToValueAtTime(A.x,b),d.upY.linearRampToValueAtTime(A.y,b),d.upZ.linearRampToValueAtTime(A.z,b)}else d.setPosition(If.x,If.y,If.z),d.setOrientation(Bf.x,Bf.y,Bf.z,A.x,A.y,A.z)}}class NG extends Qn{constructor(a){super(),this.type="Audio",this.listener=a,this.context=a.context,this.gain=this.context.createGain(),this.gain.connect(a.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(a){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=a,this.connect(),this}setMediaElementSource(a){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(a),this.connect(),this}setMediaStreamSource(a){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(a),this.connect(),this}setBuffer(a){return this.buffer=a,this.sourceType="buffer",this.autoplay&&this.play(),this}play(a=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+a;const d=this.context.createBufferSource();return d.buffer=this.buffer,d.loop=this.loop,d.loopStart=this.loopStart,d.loopEnd=this.loopEnd,d.onended=this.onEnded.bind(this),d.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=d,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let a=1,d=this.filters.length;a<d;a++)this.filters[a-1].connect(this.filters[a]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let a=1,d=this.filters.length;a<d;a++)this.filters[a-1].disconnect(this.filters[a]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(a){return a||(a=[]),this._connected===!0?(this.disconnect(),this.filters=a.slice(),this.connect()):this.filters=a.slice(),this}setDetune(a){return this.detune=a,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(a){return this.setFilters(a?[a]:[])}setPlaybackRate(a){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=a,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(a){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=a,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(a){return this.loopStart=a,this}setLoopEnd(a){return this.loopEnd=a,this}getVolume(){return this.gain.gain.value}setVolume(a){return this.gain.gain.setTargetAtTime(a,this.context.currentTime,.01),this}}const Nf=new He,LG=new Wn,I3e=new He,Lf=new He;class B3e extends NG{constructor(a){super(a),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(a){return this.panner.refDistance=a,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(a){return this.panner.rolloffFactor=a,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(a){return this.panner.distanceModel=a,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(a){return this.panner.maxDistance=a,this}setDirectionalCone(a,d,A){return this.panner.coneInnerAngle=a,this.panner.coneOuterAngle=d,this.panner.coneOuterGain=A,this}updateMatrixWorld(a){if(super.updateMatrixWorld(a),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Nf,LG,I3e),Lf.set(0,0,1).applyQuaternion(LG);const d=this.panner;if(d.positionX){const A=this.context.currentTime+this.listener.timeDelta;d.positionX.linearRampToValueAtTime(Nf.x,A),d.positionY.linearRampToValueAtTime(Nf.y,A),d.positionZ.linearRampToValueAtTime(Nf.z,A),d.orientationX.linearRampToValueAtTime(Lf.x,A),d.orientationY.linearRampToValueAtTime(Lf.y,A),d.orientationZ.linearRampToValueAtTime(Lf.z,A)}else d.setPosition(Nf.x,Nf.y,Nf.z),d.setOrientation(Lf.x,Lf.y,Lf.z)}}class N3e{constructor(a,d=2048){this.analyser=a.context.createAnalyser(),this.analyser.fftSize=d,this.data=new Uint8Array(this.analyser.frequencyBinCount),a.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let a=0;const d=this.getFrequencyData();for(let A=0;A<d.length;A++)a+=d[A];return a/d.length}}class DG{constructor(a,d,A){this.binding=a,this.valueSize=A;let b,E,M;switch(d){case"quaternion":b=this._slerp,E=this._slerpAdditive,M=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(A*6),this._workIndex=5;break;case"string":case"bool":b=this._select,E=this._select,M=this._setAdditiveIdentityOther,this.buffer=new Array(A*5);break;default:b=this._lerp,E=this._lerpAdditive,M=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(A*5)}this._mixBufferRegion=b,this._mixBufferRegionAdditive=E,this._setIdentity=M,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(a,d){const A=this.buffer,b=this.valueSize,E=a*b+b;let M=this.cumulativeWeight;if(M===0){for(let N=0;N!==b;++N)A[E+N]=A[N];M=d}else{M+=d;const N=d/M;this._mixBufferRegion(A,E,0,N,b)}this.cumulativeWeight=M}accumulateAdditive(a){const d=this.buffer,A=this.valueSize,b=A*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(d,b,0,a,A),this.cumulativeWeightAdditive+=a}apply(a){const d=this.valueSize,A=this.buffer,b=a*d+d,E=this.cumulativeWeight,M=this.cumulativeWeightAdditive,N=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,E<1){const P=d*this._origIndex;this._mixBufferRegion(A,b,P,1-E,d)}M>0&&this._mixBufferRegionAdditive(A,b,this._addIndex*d,1,d);for(let P=d,k=d+d;P!==k;++P)if(A[P]!==A[P+d]){N.setValue(A,b);break}}saveOriginalState(){const a=this.binding,d=this.buffer,A=this.valueSize,b=A*this._origIndex;a.getValue(d,b);for(let E=A,M=b;E!==M;++E)d[E]=d[b+E%A];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const a=this.valueSize*3;this.binding.setValue(this.buffer,a)}_setAdditiveIdentityNumeric(){const a=this._addIndex*this.valueSize,d=a+this.valueSize;for(let A=a;A<d;A++)this.buffer[A]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const a=this._origIndex*this.valueSize,d=this._addIndex*this.valueSize;for(let A=0;A<this.valueSize;A++)this.buffer[d+A]=this.buffer[a+A]}_select(a,d,A,b,E){if(b>=.5)for(let M=0;M!==E;++M)a[d+M]=a[A+M]}_slerp(a,d,A,b){Wn.slerpFlat(a,d,a,d,a,A,b)}_slerpAdditive(a,d,A,b,E){const M=this._workIndex*E;Wn.multiplyQuaternionsFlat(a,M,a,d,a,A),Wn.slerpFlat(a,d,a,d,a,M,b)}_lerp(a,d,A,b,E){const M=1-b;for(let N=0;N!==E;++N){const P=d+N;a[P]=a[P]*M+a[A+N]*b}}_lerpAdditive(a,d,A,b,E){for(let M=0;M!==E;++M){const N=d+M;a[N]=a[N]+a[A+M]*b}}}const ZN="\\[\\]\\.:\\/",L3e=new RegExp("["+ZN+"]","g"),$N="[^"+ZN+"]",D3e="[^"+ZN.replace("\\.","")+"]",O3e=/((?:WC+[\/:])*)/.source.replace("WC",$N),P3e=/(WCOD+)?/.source.replace("WCOD",D3e),k3e=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",$N),F3e=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",$N),U3e=new RegExp("^"+O3e+P3e+k3e+F3e+"$"),z3e=["material","materials","bones","map"];class j3e{constructor(a,d,A){const b=A||Vn.parseTrackName(d);this._targetGroup=a,this._bindings=a.subscribe_(d,b)}getValue(a,d){this.bind();const A=this._targetGroup.nCachedObjects_,b=this._bindings[A];b!==void 0&&b.getValue(a,d)}setValue(a,d){const A=this._bindings;for(let b=this._targetGroup.nCachedObjects_,E=A.length;b!==E;++b)A[b].setValue(a,d)}bind(){const a=this._bindings;for(let d=this._targetGroup.nCachedObjects_,A=a.length;d!==A;++d)a[d].bind()}unbind(){const a=this._bindings;for(let d=this._targetGroup.nCachedObjects_,A=a.length;d!==A;++d)a[d].unbind()}}class Vn{constructor(a,d,A){this.path=d,this.parsedPath=A||Vn.parseTrackName(d),this.node=Vn.findNode(a,this.parsedPath.nodeName),this.rootNode=a,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(a,d,A){return a&&a.isAnimationObjectGroup?new Vn.Composite(a,d,A):new Vn(a,d,A)}static sanitizeNodeName(a){return a.replace(/\s/g,"_").replace(L3e,"")}static parseTrackName(a){const d=U3e.exec(a);if(d===null)throw new Error("PropertyBinding: Cannot parse trackName: "+a);const A={nodeName:d[2],objectName:d[3],objectIndex:d[4],propertyName:d[5],propertyIndex:d[6]},b=A.nodeName&&A.nodeName.lastIndexOf(".");if(b!==void 0&&b!==-1){const E=A.nodeName.substring(b+1);z3e.indexOf(E)!==-1&&(A.nodeName=A.nodeName.substring(0,b),A.objectName=E)}if(A.propertyName===null||A.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+a);return A}static findNode(a,d){if(d===void 0||d===""||d==="."||d===-1||d===a.name||d===a.uuid)return a;if(a.skeleton){const A=a.skeleton.getBoneByName(d);if(A!==void 0)return A}if(a.children){const A=function(E){for(let M=0;M<E.length;M++){const N=E[M];if(N.name===d||N.uuid===d)return N;const P=A(N.children);if(P)return P}return null},b=A(a.children);if(b)return b}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(a,d){a[d]=this.targetObject[this.propertyName]}_getValue_array(a,d){const A=this.resolvedProperty;for(let b=0,E=A.length;b!==E;++b)a[d++]=A[b]}_getValue_arrayElement(a,d){a[d]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(a,d){this.resolvedProperty.toArray(a,d)}_setValue_direct(a,d){this.targetObject[this.propertyName]=a[d]}_setValue_direct_setNeedsUpdate(a,d){this.targetObject[this.propertyName]=a[d],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(a,d){this.targetObject[this.propertyName]=a[d],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(a,d){const A=this.resolvedProperty;for(let b=0,E=A.length;b!==E;++b)A[b]=a[d++]}_setValue_array_setNeedsUpdate(a,d){const A=this.resolvedProperty;for(let b=0,E=A.length;b!==E;++b)A[b]=a[d++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(a,d){const A=this.resolvedProperty;for(let b=0,E=A.length;b!==E;++b)A[b]=a[d++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(a,d){this.resolvedProperty[this.propertyIndex]=a[d]}_setValue_arrayElement_setNeedsUpdate(a,d){this.resolvedProperty[this.propertyIndex]=a[d],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(a,d){this.resolvedProperty[this.propertyIndex]=a[d],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(a,d){this.resolvedProperty.fromArray(a,d)}_setValue_fromArray_setNeedsUpdate(a,d){this.resolvedProperty.fromArray(a,d),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(a,d){this.resolvedProperty.fromArray(a,d),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(a,d){this.bind(),this.getValue(a,d)}_setValue_unbound(a,d){this.bind(),this.setValue(a,d)}bind(){let a=this.node;const d=this.parsedPath,A=d.objectName,b=d.propertyName;let E=d.propertyIndex;if(a||(a=Vn.findNode(this.rootNode,d.nodeName),this.node=a),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!a){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(A){let k=d.objectIndex;switch(A){case"materials":if(!a.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!a.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}a=a.material.materials;break;case"bones":if(!a.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}a=a.skeleton.bones;for(let j=0;j<a.length;j++)if(a[j].name===k){k=j;break}break;case"map":if("map"in a){a=a.map;break}if(!a.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!a.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}a=a.material.map;break;default:if(a[A]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}a=a[A]}if(k!==void 0){if(a[k]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,a);return}a=a[k]}}const M=a[b];if(M===void 0){const k=d.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+k+"."+b+" but it wasn't found.",a);return}let N=this.Versioning.None;this.targetObject=a,a.needsUpdate!==void 0?N=this.Versioning.NeedsUpdate:a.matrixWorldNeedsUpdate!==void 0&&(N=this.Versioning.MatrixWorldNeedsUpdate);let P=this.BindingType.Direct;if(E!==void 0){if(b==="morphTargetInfluences"){if(!a.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!a.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}a.morphTargetDictionary[E]!==void 0&&(E=a.morphTargetDictionary[E])}P=this.BindingType.ArrayElement,this.resolvedProperty=M,this.propertyIndex=E}else M.fromArray!==void 0&&M.toArray!==void 0?(P=this.BindingType.HasFromToArray,this.resolvedProperty=M):Array.isArray(M)?(P=this.BindingType.EntireArray,this.resolvedProperty=M):this.propertyName=b;this.getValue=this.GetterByBindingType[P],this.setValue=this.SetterByBindingTypeAndVersioning[P][N]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Vn.Composite=j3e,Vn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Vn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Vn.prototype.GetterByBindingType=[Vn.prototype._getValue_direct,Vn.prototype._getValue_array,Vn.prototype._getValue_arrayElement,Vn.prototype._getValue_toArray],Vn.prototype.SetterByBindingTypeAndVersioning=[[Vn.prototype._setValue_direct,Vn.prototype._setValue_direct_setNeedsUpdate,Vn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Vn.prototype._setValue_array,Vn.prototype._setValue_array_setNeedsUpdate,Vn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Vn.prototype._setValue_arrayElement,Vn.prototype._setValue_arrayElement_setNeedsUpdate,Vn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Vn.prototype._setValue_fromArray,Vn.prototype._setValue_fromArray_setNeedsUpdate,Vn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class V3e{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Bo(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const a={};this._indicesByUUID=a;for(let A=0,b=arguments.length;A!==b;++A)a[arguments[A].uuid]=A;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const d=this;this.stats={objects:{get total(){return d._objects.length},get inUse(){return this.total-d.nCachedObjects_}},get bindingsPerObject(){return d._bindings.length}}}add(){const a=this._objects,d=this._indicesByUUID,A=this._paths,b=this._parsedPaths,E=this._bindings,M=E.length;let N,P=a.length,k=this.nCachedObjects_;for(let j=0,X=arguments.length;j!==X;++j){const q=arguments[j],K=q.uuid;let te=d[K];if(te===void 0){te=P++,d[K]=te,a.push(q);for(let oe=0,re=M;oe!==re;++oe)E[oe].push(new Vn(q,A[oe],b[oe]))}else if(te<k){N=a[te];const oe=--k,re=a[oe];d[re.uuid]=te,a[te]=re,d[K]=oe,a[oe]=q;for(let ee=0,Me=M;ee!==Me;++ee){const we=E[ee],_e=we[oe];let nt=we[te];we[te]=_e,nt===void 0&&(nt=new Vn(q,A[ee],b[ee])),we[oe]=nt}}else a[te]!==N&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=k}remove(){const a=this._objects,d=this._indicesByUUID,A=this._bindings,b=A.length;let E=this.nCachedObjects_;for(let M=0,N=arguments.length;M!==N;++M){const P=arguments[M],k=P.uuid,j=d[k];if(j!==void 0&&j>=E){const X=E++,q=a[X];d[q.uuid]=j,a[j]=q,d[k]=X,a[X]=P;for(let K=0,te=b;K!==te;++K){const oe=A[K],re=oe[X],ee=oe[j];oe[j]=re,oe[X]=ee}}}this.nCachedObjects_=E}uncache(){const a=this._objects,d=this._indicesByUUID,A=this._bindings,b=A.length;let E=this.nCachedObjects_,M=a.length;for(let N=0,P=arguments.length;N!==P;++N){const k=arguments[N],j=k.uuid,X=d[j];if(X!==void 0)if(delete d[j],X<E){const q=--E,K=a[q],te=--M,oe=a[te];d[K.uuid]=X,a[X]=K,d[oe.uuid]=q,a[q]=oe,a.pop();for(let re=0,ee=b;re!==ee;++re){const Me=A[re],we=Me[q],_e=Me[te];Me[X]=we,Me[q]=_e,Me.pop()}}else{const q=--M,K=a[q];q>0&&(d[K.uuid]=X),a[X]=K,a.pop();for(let te=0,oe=b;te!==oe;++te){const re=A[te];re[X]=re[q],re.pop()}}}this.nCachedObjects_=E}subscribe_(a,d){const A=this._bindingsIndicesByPath;let b=A[a];const E=this._bindings;if(b!==void 0)return E[b];const M=this._paths,N=this._parsedPaths,P=this._objects,k=P.length,j=this.nCachedObjects_,X=new Array(k);b=E.length,A[a]=b,M.push(a),N.push(d),E.push(X);for(let q=j,K=P.length;q!==K;++q){const te=P[q];X[q]=new Vn(te,a,d)}return X}unsubscribe_(a){const d=this._bindingsIndicesByPath,A=d[a];if(A!==void 0){const b=this._paths,E=this._parsedPaths,M=this._bindings,N=M.length-1,P=M[N],k=a[N];d[k]=A,M[A]=P,M.pop(),E[A]=E[N],E.pop(),b[A]=b[N],b.pop()}}}class OG{constructor(a,d,A=null,b=d.blendMode){this._mixer=a,this._clip=d,this._localRoot=A,this.blendMode=b;const E=d.tracks,M=E.length,N=new Array(M),P={endingStart:Hr,endingEnd:Hr};for(let k=0;k!==M;++k){const j=E[k].createInterpolant(null);N[k]=j,j.settings=P}this._interpolantSettings=P,this._interpolants=N,this._propertyBindings=new Array(M),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=fr,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(a){return this._startTime=a,this}setLoop(a,d){return this.loop=a,this.repetitions=d,this}setEffectiveWeight(a){return this.weight=a,this._effectiveWeight=this.enabled?a:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(a){return this._scheduleFading(a,0,1)}fadeOut(a){return this._scheduleFading(a,1,0)}crossFadeFrom(a,d,A){if(a.fadeOut(d),this.fadeIn(d),A){const b=this._clip.duration,E=a._clip.duration,M=E/b,N=b/E;a.warp(1,M,d),this.warp(N,1,d)}return this}crossFadeTo(a,d,A){return a.crossFadeFrom(this,d,A)}stopFading(){const a=this._weightInterpolant;return a!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(a)),this}setEffectiveTimeScale(a){return this.timeScale=a,this._effectiveTimeScale=this.paused?0:a,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(a){return this.timeScale=this._clip.duration/a,this.stopWarping()}syncWith(a){return this.time=a.time,this.timeScale=a.timeScale,this.stopWarping()}halt(a){return this.warp(this._effectiveTimeScale,0,a)}warp(a,d,A){const b=this._mixer,E=b.time,M=this.timeScale;let N=this._timeScaleInterpolant;N===null&&(N=b._lendControlInterpolant(),this._timeScaleInterpolant=N);const P=N.parameterPositions,k=N.sampleValues;return P[0]=E,P[1]=E+A,k[0]=a/M,k[1]=d/M,this}stopWarping(){const a=this._timeScaleInterpolant;return a!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(a)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(a,d,A,b){if(!this.enabled){this._updateWeight(a);return}const E=this._startTime;if(E!==null){const P=(a-E)*A;P<0||A===0?d=0:(this._startTime=null,d=A*P)}d*=this._updateTimeScale(a);const M=this._updateTime(d),N=this._updateWeight(a);if(N>0){const P=this._interpolants,k=this._propertyBindings;switch(this.blendMode){case Or:for(let j=0,X=P.length;j!==X;++j)P[j].evaluate(M),k[j].accumulateAdditive(N);break;case ps:default:for(let j=0,X=P.length;j!==X;++j)P[j].evaluate(M),k[j].accumulate(b,N)}}}_updateWeight(a){let d=0;if(this.enabled){d=this.weight;const A=this._weightInterpolant;if(A!==null){const b=A.evaluate(a)[0];d*=b,a>A.parameterPositions[1]&&(this.stopFading(),b===0&&(this.enabled=!1))}}return this._effectiveWeight=d,d}_updateTimeScale(a){let d=0;if(!this.paused){d=this.timeScale;const A=this._timeScaleInterpolant;if(A!==null){const b=A.evaluate(a)[0];d*=b,a>A.parameterPositions[1]&&(this.stopWarping(),d===0?this.paused=!0:this.timeScale=d)}}return this._effectiveTimeScale=d,d}_updateTime(a){const d=this._clip.duration,A=this.loop;let b=this.time+a,E=this._loopCount;const M=A===Wi;if(a===0)return E===-1?b:M&&(E&1)===1?d-b:b;if(A===pr){E===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));i:{if(b>=d)b=d;else if(b<0)b=0;else{this.time=b;break i}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=b,this._mixer.dispatchEvent({type:"finished",action:this,direction:a<0?-1:1})}}else{if(E===-1&&(a>=0?(E=0,this._setEndings(!0,this.repetitions===0,M)):this._setEndings(this.repetitions===0,!0,M)),b>=d||b<0){const N=Math.floor(b/d);b-=d*N,E+=Math.abs(N);const P=this.repetitions-E;if(P<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,b=a>0?d:0,this.time=b,this._mixer.dispatchEvent({type:"finished",action:this,direction:a>0?1:-1});else{if(P===1){const k=a<0;this._setEndings(k,!k,M)}else this._setEndings(!1,!1,M);this._loopCount=E,this.time=b,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:N})}}else this.time=b;if(M&&(E&1)===1)return d-b}return b}_setEndings(a,d,A){const b=this._interpolantSettings;A?(b.endingStart=_n,b.endingEnd=_n):(a?b.endingStart=this.zeroSlopeAtStart?_n:Hr:b.endingStart=Gr,d?b.endingEnd=this.zeroSlopeAtEnd?_n:Hr:b.endingEnd=Gr)}_scheduleFading(a,d,A){const b=this._mixer,E=b.time;let M=this._weightInterpolant;M===null&&(M=b._lendControlInterpolant(),this._weightInterpolant=M);const N=M.parameterPositions,P=M.sampleValues;return N[0]=E,P[0]=d,N[1]=E+a,P[1]=A,this}}const G3e=new Float32Array(1);class H3e extends Io{constructor(a){super(),this._root=a,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(a,d){const A=a._localRoot||this._root,b=a._clip.tracks,E=b.length,M=a._propertyBindings,N=a._interpolants,P=A.uuid,k=this._bindingsByRootAndName;let j=k[P];j===void 0&&(j={},k[P]=j);for(let X=0;X!==E;++X){const q=b[X],K=q.name;let te=j[K];if(te!==void 0)++te.referenceCount,M[X]=te;else{if(te=M[X],te!==void 0){te._cacheIndex===null&&(++te.referenceCount,this._addInactiveBinding(te,P,K));continue}const oe=d&&d._propertyBindings[X].binding.parsedPath;te=new DG(Vn.create(A,K,oe),q.ValueTypeName,q.getValueSize()),++te.referenceCount,this._addInactiveBinding(te,P,K),M[X]=te}N[X].resultBuffer=te.buffer}}_activateAction(a){if(!this._isActiveAction(a)){if(a._cacheIndex===null){const A=(a._localRoot||this._root).uuid,b=a._clip.uuid,E=this._actionsByClip[b];this._bindAction(a,E&&E.knownActions[0]),this._addInactiveAction(a,b,A)}const d=a._propertyBindings;for(let A=0,b=d.length;A!==b;++A){const E=d[A];E.useCount++===0&&(this._lendBinding(E),E.saveOriginalState())}this._lendAction(a)}}_deactivateAction(a){if(this._isActiveAction(a)){const d=a._propertyBindings;for(let A=0,b=d.length;A!==b;++A){const E=d[A];--E.useCount===0&&(E.restoreOriginalState(),this._takeBackBinding(E))}this._takeBackAction(a)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const a=this;this.stats={actions:{get total(){return a._actions.length},get inUse(){return a._nActiveActions}},bindings:{get total(){return a._bindings.length},get inUse(){return a._nActiveBindings}},controlInterpolants:{get total(){return a._controlInterpolants.length},get inUse(){return a._nActiveControlInterpolants}}}}_isActiveAction(a){const d=a._cacheIndex;return d!==null&&d<this._nActiveActions}_addInactiveAction(a,d,A){const b=this._actions,E=this._actionsByClip;let M=E[d];if(M===void 0)M={knownActions:[a],actionByRoot:{}},a._byClipCacheIndex=0,E[d]=M;else{const N=M.knownActions;a._byClipCacheIndex=N.length,N.push(a)}a._cacheIndex=b.length,b.push(a),M.actionByRoot[A]=a}_removeInactiveAction(a){const d=this._actions,A=d[d.length-1],b=a._cacheIndex;A._cacheIndex=b,d[b]=A,d.pop(),a._cacheIndex=null;const E=a._clip.uuid,M=this._actionsByClip,N=M[E],P=N.knownActions,k=P[P.length-1],j=a._byClipCacheIndex;k._byClipCacheIndex=j,P[j]=k,P.pop(),a._byClipCacheIndex=null;const X=N.actionByRoot,q=(a._localRoot||this._root).uuid;delete X[q],P.length===0&&delete M[E],this._removeInactiveBindingsForAction(a)}_removeInactiveBindingsForAction(a){const d=a._propertyBindings;for(let A=0,b=d.length;A!==b;++A){const E=d[A];--E.referenceCount===0&&this._removeInactiveBinding(E)}}_lendAction(a){const d=this._actions,A=a._cacheIndex,b=this._nActiveActions++,E=d[b];a._cacheIndex=b,d[b]=a,E._cacheIndex=A,d[A]=E}_takeBackAction(a){const d=this._actions,A=a._cacheIndex,b=--this._nActiveActions,E=d[b];a._cacheIndex=b,d[b]=a,E._cacheIndex=A,d[A]=E}_addInactiveBinding(a,d,A){const b=this._bindingsByRootAndName,E=this._bindings;let M=b[d];M===void 0&&(M={},b[d]=M),M[A]=a,a._cacheIndex=E.length,E.push(a)}_removeInactiveBinding(a){const d=this._bindings,A=a.binding,b=A.rootNode.uuid,E=A.path,M=this._bindingsByRootAndName,N=M[b],P=d[d.length-1],k=a._cacheIndex;P._cacheIndex=k,d[k]=P,d.pop(),delete N[E],Object.keys(N).length===0&&delete M[b]}_lendBinding(a){const d=this._bindings,A=a._cacheIndex,b=this._nActiveBindings++,E=d[b];a._cacheIndex=b,d[b]=a,E._cacheIndex=A,d[A]=E}_takeBackBinding(a){const d=this._bindings,A=a._cacheIndex,b=--this._nActiveBindings,E=d[b];a._cacheIndex=b,d[b]=a,E._cacheIndex=A,d[A]=E}_lendControlInterpolant(){const a=this._controlInterpolants,d=this._nActiveControlInterpolants++;let A=a[d];return A===void 0&&(A=new HN(new Float32Array(2),new Float32Array(2),1,G3e),A.__cacheIndex=d,a[d]=A),A}_takeBackControlInterpolant(a){const d=this._controlInterpolants,A=a.__cacheIndex,b=--this._nActiveControlInterpolants,E=d[b];a.__cacheIndex=b,d[b]=a,E.__cacheIndex=A,d[A]=E}clipAction(a,d,A){const b=d||this._root,E=b.uuid;let M=typeof a=="string"?jv.findByName(b,a):a;const N=M!==null?M.uuid:a,P=this._actionsByClip[N];let k=null;if(A===void 0&&(M!==null?A=M.blendMode:A=ps),P!==void 0){const X=P.actionByRoot[E];if(X!==void 0&&X.blendMode===A)return X;k=P.knownActions[0],M===null&&(M=k._clip)}if(M===null)return null;const j=new OG(this,M,d,A);return this._bindAction(j,k),this._addInactiveAction(j,N,E),j}existingAction(a,d){const A=d||this._root,b=A.uuid,E=typeof a=="string"?jv.findByName(A,a):a,M=E?E.uuid:a,N=this._actionsByClip[M];return N!==void 0&&N.actionByRoot[b]||null}stopAllAction(){const a=this._actions,d=this._nActiveActions;for(let A=d-1;A>=0;--A)a[A].stop();return this}update(a){a*=this.timeScale;const d=this._actions,A=this._nActiveActions,b=this.time+=a,E=Math.sign(a),M=this._accuIndex^=1;for(let k=0;k!==A;++k)d[k]._update(b,a,E,M);const N=this._bindings,P=this._nActiveBindings;for(let k=0;k!==P;++k)N[k].apply(M);return this}setTime(a){this.time=0;for(let d=0;d<this._actions.length;d++)this._actions[d].time=0;return this.update(a)}getRoot(){return this._root}uncacheClip(a){const d=this._actions,A=a.uuid,b=this._actionsByClip,E=b[A];if(E!==void 0){const M=E.knownActions;for(let N=0,P=M.length;N!==P;++N){const k=M[N];this._deactivateAction(k);const j=k._cacheIndex,X=d[d.length-1];k._cacheIndex=null,k._byClipCacheIndex=null,X._cacheIndex=j,d[j]=X,d.pop(),this._removeInactiveBindingsForAction(k)}delete b[A]}}uncacheRoot(a){const d=a.uuid,A=this._actionsByClip;for(const M in A){const N=A[M].actionByRoot,P=N[d];P!==void 0&&(this._deactivateAction(P),this._removeInactiveAction(P))}const b=this._bindingsByRootAndName,E=b[d];if(E!==void 0)for(const M in E){const N=E[M];N.restoreOriginalState(),this._removeInactiveBinding(N)}}uncacheAction(a,d){const A=this.existingAction(a,d);A!==null&&(this._deactivateAction(A),this._removeInactiveAction(A))}}class eL{constructor(a){this.value=a}clone(){return new eL(this.value.clone===void 0?this.value:this.value.clone())}}let W3e=0;class Q3e extends Io{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:W3e++}),this.name="",this.usage=uf,this.uniforms=[]}add(a){return this.uniforms.push(a),this}remove(a){const d=this.uniforms.indexOf(a);return d!==-1&&this.uniforms.splice(d,1),this}setName(a){return this.name=a,this}setUsage(a){return this.usage=a,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(a){this.name=a.name,this.usage=a.usage;const d=a.uniforms;this.uniforms.length=0;for(let A=0,b=d.length;A<b;A++){const E=Array.isArray(d[A])?d[A]:[d[A]];for(let M=0;M<E.length;M++)this.uniforms.push(E[M].clone())}return this}clone(){return new this.constructor().copy(this)}}class q3e extends rw{constructor(a,d,A=1){super(a,d),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=A}copy(a){return super.copy(a),this.meshPerAttribute=a.meshPerAttribute,this}clone(a){const d=super.clone(a);return d.meshPerAttribute=this.meshPerAttribute,d}toJSON(a){const d=super.toJSON(a);return d.isInstancedInterleavedBuffer=!0,d.meshPerAttribute=this.meshPerAttribute,d}}class X3e{constructor(a,d,A,b,E){this.isGLBufferAttribute=!0,this.name="",this.buffer=a,this.type=d,this.itemSize=A,this.elementSize=b,this.count=E,this.version=0}set needsUpdate(a){a===!0&&this.version++}setBuffer(a){return this.buffer=a,this}setType(a,d){return this.type=a,this.elementSize=d,this}setItemSize(a){return this.itemSize=a,this}setCount(a){return this.count=a,this}}const PG=new mr;class Y3e{constructor(a,d,A=0,b=1/0){this.ray=new va(a,d),this.near=A,this.far=b,this.camera=null,this.layers=new PE,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(a,d){this.ray.set(a,d)}setFromCamera(a,d){d.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(d.matrixWorld),this.ray.direction.set(a.x,a.y,.5).unproject(d).sub(this.ray.origin).normalize(),this.camera=d):d.isOrthographicCamera?(this.ray.origin.set(a.x,a.y,(d.near+d.far)/(d.near-d.far)).unproject(d),this.ray.direction.set(0,0,-1).transformDirection(d.matrixWorld),this.camera=d):console.error("THREE.Raycaster: Unsupported camera type: "+d.type)}setFromXRController(a){return PG.identity().extractRotation(a.matrixWorld),this.ray.origin.setFromMatrixPosition(a.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(PG),this}intersectObject(a,d=!0,A=[]){return tL(a,this,A,d),A.sort(kG),A}intersectObjects(a,d=!0,A=[]){for(let b=0,E=a.length;b<E;b++)tL(a[b],this,A,d);return A.sort(kG),A}}function kG(C,a){return C.distance-a.distance}function tL(C,a,d,A){if(C.layers.test(a.layers)&&C.raycast(a,d),A===!0){const b=C.children;for(let E=0,M=b.length;E<M;E++)tL(b[E],a,d,!0)}}class K3e{constructor(a=1,d=0,A=0){return this.radius=a,this.phi=d,this.theta=A,this}set(a,d,A){return this.radius=a,this.phi=d,this.theta=A,this}copy(a){return this.radius=a.radius,this.phi=a.phi,this.theta=a.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(a){return this.setFromCartesianCoords(a.x,a.y,a.z)}setFromCartesianCoords(a,d,A){return this.radius=Math.sqrt(a*a+d*d+A*A),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(a,A),this.phi=Math.acos(Ms(d/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class J3e{constructor(a=1,d=0,A=0){return this.radius=a,this.theta=d,this.y=A,this}set(a,d,A){return this.radius=a,this.theta=d,this.y=A,this}copy(a){return this.radius=a.radius,this.theta=a.theta,this.y=a.y,this}setFromVector3(a){return this.setFromCartesianCoords(a.x,a.y,a.z)}setFromCartesianCoords(a,d,A){return this.radius=Math.sqrt(a*a+A*A),this.theta=Math.atan2(a,A),this.y=d,this}clone(){return new this.constructor().copy(this)}}const FG=new si;class Z3e{constructor(a=new si(1/0,1/0),d=new si(-1/0,-1/0)){this.isBox2=!0,this.min=a,this.max=d}set(a,d){return this.min.copy(a),this.max.copy(d),this}setFromPoints(a){this.makeEmpty();for(let d=0,A=a.length;d<A;d++)this.expandByPoint(a[d]);return this}setFromCenterAndSize(a,d){const A=FG.copy(d).multiplyScalar(.5);return this.min.copy(a).sub(A),this.max.copy(a).add(A),this}clone(){return new this.constructor().copy(this)}copy(a){return this.min.copy(a.min),this.max.copy(a.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(a){return this.isEmpty()?a.set(0,0):a.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(a){return this.isEmpty()?a.set(0,0):a.subVectors(this.max,this.min)}expandByPoint(a){return this.min.min(a),this.max.max(a),this}expandByVector(a){return this.min.sub(a),this.max.add(a),this}expandByScalar(a){return this.min.addScalar(-a),this.max.addScalar(a),this}containsPoint(a){return!(a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y)}containsBox(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y}getParameter(a,d){return d.set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(a){return!(a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y)}clampPoint(a,d){return d.copy(a).clamp(this.min,this.max)}distanceToPoint(a){return this.clampPoint(a,FG).distanceTo(a)}intersect(a){return this.min.max(a.min),this.max.min(a.max),this.isEmpty()&&this.makeEmpty(),this}union(a){return this.min.min(a.min),this.max.max(a.max),this}translate(a){return this.min.add(a),this.max.add(a),this}equals(a){return a.min.equals(this.min)&&a.max.equals(this.max)}}const UG=new He,Gw=new He;class $3e{constructor(a=new He,d=new He){this.start=a,this.end=d}set(a,d){return this.start.copy(a),this.end.copy(d),this}copy(a){return this.start.copy(a.start),this.end.copy(a.end),this}getCenter(a){return a.addVectors(this.start,this.end).multiplyScalar(.5)}delta(a){return a.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(a,d){return this.delta(d).multiplyScalar(a).add(this.start)}closestPointToPointParameter(a,d){UG.subVectors(a,this.start),Gw.subVectors(this.end,this.start);const A=Gw.dot(Gw);let b=Gw.dot(UG)/A;return d&&(b=Ms(b,0,1)),b}closestPointToPoint(a,d,A){const b=this.closestPointToPointParameter(a,d);return this.delta(A).multiplyScalar(b).add(this.start)}applyMatrix4(a){return this.start.applyMatrix4(a),this.end.applyMatrix4(a),this}equals(a){return a.start.equals(this.start)&&a.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const zG=new He;class eRe extends Qn{constructor(a,d){super(),this.light=a,this.matrixAutoUpdate=!1,this.color=d,this.type="SpotLightHelper";const A=new fn,b=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let M=0,N=1,P=32;M<P;M++,N++){const k=M/P*Math.PI*2,j=N/P*Math.PI*2;b.push(Math.cos(k),Math.sin(k),1,Math.cos(j),Math.sin(j),1)}A.setAttribute("position",new br(b,3));const E=new Oo({fog:!1,toneMapped:!1});this.cone=new nu(A,E),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const a=this.light.distance?this.light.distance:1e3,d=a*Math.tan(this.light.angle);this.cone.scale.set(d,d,a),zG.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(zG),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Qd=new He,Hw=new mr,iL=new mr;class tRe extends nu{constructor(a){const d=jG(a),A=new fn,b=[],E=[],M=new lr(0,0,1),N=new lr(0,1,0);for(let k=0;k<d.length;k++){const j=d[k];j.parent&&j.parent.isBone&&(b.push(0,0,0),b.push(0,0,0),E.push(M.r,M.g,M.b),E.push(N.r,N.g,N.b))}A.setAttribute("position",new br(b,3)),A.setAttribute("color",new br(E,3));const P=new Oo({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(A,P),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=a,this.bones=d,this.matrix=a.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(a){const d=this.bones,A=this.geometry,b=A.getAttribute("position");iL.copy(this.root.matrixWorld).invert();for(let E=0,M=0;E<d.length;E++){const N=d[E];N.parent&&N.parent.isBone&&(Hw.multiplyMatrices(iL,N.matrixWorld),Qd.setFromMatrixPosition(Hw),b.setXYZ(M,Qd.x,Qd.y,Qd.z),Hw.multiplyMatrices(iL,N.parent.matrixWorld),Qd.setFromMatrixPosition(Hw),b.setXYZ(M+1,Qd.x,Qd.y,Qd.z),M+=2)}A.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(a)}dispose(){this.geometry.dispose(),this.material.dispose()}}function jG(C){const a=[];C.isBone===!0&&a.push(C);for(let d=0;d<C.children.length;d++)a.push.apply(a,jG(C.children[d]));return a}class iRe extends ua{constructor(a,d,A){const b=new kv(d,4,2),E=new Fd({wireframe:!0,fog:!1,toneMapped:!1});super(b,E),this.light=a,this.color=A,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const rRe=new He,VG=new lr,GG=new lr;class nRe extends Qn{constructor(a,d,A){super(),this.light=a,this.matrix=a.matrixWorld,this.matrixAutoUpdate=!1,this.color=A,this.type="HemisphereLightHelper";const b=new Pv(d);b.rotateY(Math.PI*.5),this.material=new Fd({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const E=b.getAttribute("position"),M=new Float32Array(E.count*3);b.setAttribute("color",new ls(M,3)),this.add(new ua(b,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const a=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const d=a.geometry.getAttribute("color");VG.copy(this.light.color),GG.copy(this.light.groundColor);for(let A=0,b=d.count;A<b;A++){const E=A<b/2?VG:GG;d.setXYZ(A,E.r,E.g,E.b)}d.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),a.lookAt(rRe.setFromMatrixPosition(this.light.matrixWorld).negate())}}class sRe extends nu{constructor(a=10,d=10,A=4473924,b=8947848){A=new lr(A),b=new lr(b);const E=d/2,M=a/d,N=a/2,P=[],k=[];for(let q=0,K=0,te=-N;q<=d;q++,te+=M){P.push(-N,0,te,N,0,te),P.push(te,0,-N,te,0,N);const oe=q===E?A:b;oe.toArray(k,K),K+=3,oe.toArray(k,K),K+=3,oe.toArray(k,K),K+=3,oe.toArray(k,K),K+=3}const j=new fn;j.setAttribute("position",new br(P,3)),j.setAttribute("color",new br(k,3));const X=new Oo({vertexColors:!0,toneMapped:!1});super(j,X),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class aRe extends nu{constructor(a=10,d=16,A=8,b=64,E=4473924,M=8947848){E=new lr(E),M=new lr(M);const N=[],P=[];if(d>1)for(let X=0;X<d;X++){const q=X/d*(Math.PI*2),K=Math.sin(q)*a,te=Math.cos(q)*a;N.push(0,0,0),N.push(K,0,te);const oe=X&1?E:M;P.push(oe.r,oe.g,oe.b),P.push(oe.r,oe.g,oe.b)}for(let X=0;X<A;X++){const q=X&1?E:M,K=a-a/A*X;for(let te=0;te<b;te++){let oe=te/b*(Math.PI*2),re=Math.sin(oe)*K,ee=Math.cos(oe)*K;N.push(re,0,ee),P.push(q.r,q.g,q.b),oe=(te+1)/b*(Math.PI*2),re=Math.sin(oe)*K,ee=Math.cos(oe)*K,N.push(re,0,ee),P.push(q.r,q.g,q.b)}}const k=new fn;k.setAttribute("position",new br(N,3)),k.setAttribute("color",new br(P,3));const j=new Oo({vertexColors:!0,toneMapped:!1});super(k,j),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const HG=new He,Ww=new He,WG=new He;class oRe extends Qn{constructor(a,d,A){super(),this.light=a,this.matrix=a.matrixWorld,this.matrixAutoUpdate=!1,this.color=A,this.type="DirectionalLightHelper",d===void 0&&(d=1);let b=new fn;b.setAttribute("position",new br([-d,d,0,d,d,0,d,-d,0,-d,-d,0,-d,d,0],3));const E=new Oo({fog:!1,toneMapped:!1});this.lightPlane=new Gd(b,E),this.add(this.lightPlane),b=new fn,b.setAttribute("position",new br([0,0,0,0,0,1],3)),this.targetLine=new Gd(b,E),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),HG.setFromMatrixPosition(this.light.matrixWorld),Ww.setFromMatrixPosition(this.light.target.matrixWorld),WG.subVectors(Ww,HG),this.lightPlane.lookAt(Ww),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Ww),this.targetLine.scale.z=WG.length()}}const Qw=new He,Vs=new XE;class lRe extends nu{constructor(a){const d=new fn,A=new Oo({color:16777215,vertexColors:!0,toneMapped:!1}),b=[],E=[],M={};N("n1","n2"),N("n2","n4"),N("n4","n3"),N("n3","n1"),N("f1","f2"),N("f2","f4"),N("f4","f3"),N("f3","f1"),N("n1","f1"),N("n2","f2"),N("n3","f3"),N("n4","f4"),N("p","n1"),N("p","n2"),N("p","n3"),N("p","n4"),N("u1","u2"),N("u2","u3"),N("u3","u1"),N("c","t"),N("p","c"),N("cn1","cn2"),N("cn3","cn4"),N("cf1","cf2"),N("cf3","cf4");function N(te,oe){P(te),P(oe)}function P(te){b.push(0,0,0),E.push(0,0,0),M[te]===void 0&&(M[te]=[]),M[te].push(b.length/3-1)}d.setAttribute("position",new br(b,3)),d.setAttribute("color",new br(E,3)),super(d,A),this.type="CameraHelper",this.camera=a,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=a.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=M,this.update();const k=new lr(16755200),j=new lr(16711680),X=new lr(43775),q=new lr(16777215),K=new lr(3355443);this.setColors(k,j,X,q,K)}setColors(a,d,A,b,E){const M=this.geometry.getAttribute("color");M.setXYZ(0,a.r,a.g,a.b),M.setXYZ(1,a.r,a.g,a.b),M.setXYZ(2,a.r,a.g,a.b),M.setXYZ(3,a.r,a.g,a.b),M.setXYZ(4,a.r,a.g,a.b),M.setXYZ(5,a.r,a.g,a.b),M.setXYZ(6,a.r,a.g,a.b),M.setXYZ(7,a.r,a.g,a.b),M.setXYZ(8,a.r,a.g,a.b),M.setXYZ(9,a.r,a.g,a.b),M.setXYZ(10,a.r,a.g,a.b),M.setXYZ(11,a.r,a.g,a.b),M.setXYZ(12,a.r,a.g,a.b),M.setXYZ(13,a.r,a.g,a.b),M.setXYZ(14,a.r,a.g,a.b),M.setXYZ(15,a.r,a.g,a.b),M.setXYZ(16,a.r,a.g,a.b),M.setXYZ(17,a.r,a.g,a.b),M.setXYZ(18,a.r,a.g,a.b),M.setXYZ(19,a.r,a.g,a.b),M.setXYZ(20,a.r,a.g,a.b),M.setXYZ(21,a.r,a.g,a.b),M.setXYZ(22,a.r,a.g,a.b),M.setXYZ(23,a.r,a.g,a.b),M.setXYZ(24,d.r,d.g,d.b),M.setXYZ(25,d.r,d.g,d.b),M.setXYZ(26,d.r,d.g,d.b),M.setXYZ(27,d.r,d.g,d.b),M.setXYZ(28,d.r,d.g,d.b),M.setXYZ(29,d.r,d.g,d.b),M.setXYZ(30,d.r,d.g,d.b),M.setXYZ(31,d.r,d.g,d.b),M.setXYZ(32,A.r,A.g,A.b),M.setXYZ(33,A.r,A.g,A.b),M.setXYZ(34,A.r,A.g,A.b),M.setXYZ(35,A.r,A.g,A.b),M.setXYZ(36,A.r,A.g,A.b),M.setXYZ(37,A.r,A.g,A.b),M.setXYZ(38,b.r,b.g,b.b),M.setXYZ(39,b.r,b.g,b.b),M.setXYZ(40,E.r,E.g,E.b),M.setXYZ(41,E.r,E.g,E.b),M.setXYZ(42,E.r,E.g,E.b),M.setXYZ(43,E.r,E.g,E.b),M.setXYZ(44,E.r,E.g,E.b),M.setXYZ(45,E.r,E.g,E.b),M.setXYZ(46,E.r,E.g,E.b),M.setXYZ(47,E.r,E.g,E.b),M.setXYZ(48,E.r,E.g,E.b),M.setXYZ(49,E.r,E.g,E.b),M.needsUpdate=!0}update(){const a=this.geometry,d=this.pointMap,A=1,b=1;Vs.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),qs("c",d,a,Vs,0,0,-1),qs("t",d,a,Vs,0,0,1),qs("n1",d,a,Vs,-1,-1,-1),qs("n2",d,a,Vs,A,-1,-1),qs("n3",d,a,Vs,-1,b,-1),qs("n4",d,a,Vs,A,b,-1),qs("f1",d,a,Vs,-1,-1,1),qs("f2",d,a,Vs,A,-1,1),qs("f3",d,a,Vs,-1,b,1),qs("f4",d,a,Vs,A,b,1),qs("u1",d,a,Vs,A*.7,b*1.1,-1),qs("u2",d,a,Vs,-.7,b*1.1,-1),qs("u3",d,a,Vs,0,b*2,-1),qs("cf1",d,a,Vs,-1,0,1),qs("cf2",d,a,Vs,A,0,1),qs("cf3",d,a,Vs,0,-1,1),qs("cf4",d,a,Vs,0,b,1),qs("cn1",d,a,Vs,-1,0,-1),qs("cn2",d,a,Vs,A,0,-1),qs("cn3",d,a,Vs,0,-1,-1),qs("cn4",d,a,Vs,0,b,-1),a.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function qs(C,a,d,A,b,E,M){Qw.set(b,E,M).unproject(A);const N=a[C];if(N!==void 0){const P=d.getAttribute("position");for(let k=0,j=N.length;k<j;k++)P.setXYZ(N[k],Qw.x,Qw.y,Qw.z)}}const qw=new Ds;class cRe extends nu{constructor(a,d=16776960){const A=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),b=new Float32Array(8*3),E=new fn;E.setIndex(new ls(A,1)),E.setAttribute("position",new ls(b,3)),super(E,new Oo({color:d,toneMapped:!1})),this.object=a,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(a){if(a!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&qw.setFromObject(this.object),qw.isEmpty())return;const d=qw.min,A=qw.max,b=this.geometry.attributes.position,E=b.array;E[0]=A.x,E[1]=A.y,E[2]=A.z,E[3]=d.x,E[4]=A.y,E[5]=A.z,E[6]=d.x,E[7]=d.y,E[8]=A.z,E[9]=A.x,E[10]=d.y,E[11]=A.z,E[12]=A.x,E[13]=A.y,E[14]=d.z,E[15]=d.x,E[16]=A.y,E[17]=d.z,E[18]=d.x,E[19]=d.y,E[20]=d.z,E[21]=A.x,E[22]=d.y,E[23]=d.z,b.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(a){return this.object=a,this.update(),this}copy(a,d){return super.copy(a,d),this.object=a.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class uRe extends nu{constructor(a,d=16776960){const A=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),b=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],E=new fn;E.setIndex(new ls(A,1)),E.setAttribute("position",new br(b,3)),super(E,new Oo({color:d,toneMapped:!1})),this.box=a,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(a){const d=this.box;d.isEmpty()||(d.getCenter(this.position),d.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(a))}dispose(){this.geometry.dispose(),this.material.dispose()}}class hRe extends Gd{constructor(a,d=1,A=16776960){const b=A,E=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],M=new fn;M.setAttribute("position",new br(E,3)),M.computeBoundingSphere(),super(M,new Oo({color:b,toneMapped:!1})),this.type="PlaneHelper",this.plane=a,this.size=d;const N=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],P=new fn;P.setAttribute("position",new br(N,3)),P.computeBoundingSphere(),this.add(new ua(P,new Fd({color:b,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(a){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(a)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const QG=new He;let Xw,rL;class dRe extends Qn{constructor(a=new He(0,0,1),d=new He(0,0,0),A=1,b=16776960,E=A*.2,M=E*.2){super(),this.type="ArrowHelper",Xw===void 0&&(Xw=new fn,Xw.setAttribute("position",new br([0,0,0,0,1,0],3)),rL=new R0(0,.5,1,5,1),rL.translate(0,-.5,0)),this.position.copy(d),this.line=new Gd(Xw,new Oo({color:b,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new ua(rL,new Fd({color:b,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(a),this.setLength(A,E,M)}setDirection(a){if(a.y>.99999)this.quaternion.set(0,0,0,1);else if(a.y<-.99999)this.quaternion.set(1,0,0,0);else{QG.set(a.z,0,-a.x).normalize();const d=Math.acos(a.y);this.quaternion.setFromAxisAngle(QG,d)}}setLength(a,d=a*.2,A=d*.2){this.line.scale.set(1,Math.max(1e-4,a-d),1),this.line.updateMatrix(),this.cone.scale.set(A,d,A),this.cone.position.y=a,this.cone.updateMatrix()}setColor(a){this.line.material.color.set(a),this.cone.material.color.set(a)}copy(a){return super.copy(a,!1),this.line.copy(a.line),this.cone.copy(a.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class pRe extends nu{constructor(a=1){const d=[0,0,0,a,0,0,0,0,0,0,a,0,0,0,0,0,0,a],A=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],b=new fn;b.setAttribute("position",new br(d,3)),b.setAttribute("color",new br(A,3));const E=new Oo({vertexColors:!0,toneMapped:!1});super(b,E),this.type="AxesHelper"}setColors(a,d,A){const b=new lr,E=this.geometry.attributes.color.array;return b.set(a),b.toArray(E,0),b.toArray(E,3),b.set(d),b.toArray(E,6),b.toArray(E,9),b.set(A),b.toArray(E,12),b.toArray(E,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class fRe{constructor(){this.type="ShapePath",this.color=new lr,this.subPaths=[],this.currentPath=null}moveTo(a,d){return this.currentPath=new Bv,this.subPaths.push(this.currentPath),this.currentPath.moveTo(a,d),this}lineTo(a,d){return this.currentPath.lineTo(a,d),this}quadraticCurveTo(a,d,A,b){return this.currentPath.quadraticCurveTo(a,d,A,b),this}bezierCurveTo(a,d,A,b,E,M){return this.currentPath.bezierCurveTo(a,d,A,b,E,M),this}splineThru(a){return this.currentPath.splineThru(a),this}toShapes(a){function d(ee){const Me=[];for(let we=0,_e=ee.length;we<_e;we++){const nt=ee[we],qe=new wf;qe.curves=nt.curves,Me.push(qe)}return Me}function A(ee,Me){const we=Me.length;let _e=!1;for(let nt=we-1,qe=0;qe<we;nt=qe++){let Je=Me[nt],it=Me[qe],ze=it.x-Je.x,Oe=it.y-Je.y;if(Math.abs(Oe)>Number.EPSILON){if(Oe<0&&(Je=Me[qe],ze=-ze,it=Me[nt],Oe=-Oe),ee.y<Je.y||ee.y>it.y)continue;if(ee.y===Je.y){if(ee.x===Je.x)return!0}else{const rt=Oe*(ee.x-Je.x)-ze*(ee.y-Je.y);if(rt===0)return!0;if(rt<0)continue;_e=!_e}}else{if(ee.y!==Je.y)continue;if(it.x<=ee.x&&ee.x<=Je.x||Je.x<=ee.x&&ee.x<=it.x)return!0}}return _e}const b=su.isClockWise,E=this.subPaths;if(E.length===0)return[];let M,N,P;const k=[];if(E.length===1)return N=E[0],P=new wf,P.curves=N.curves,k.push(P),k;let j=!b(E[0].getPoints());j=a?!j:j;const X=[],q=[];let K=[],te=0,oe;q[te]=void 0,K[te]=[];for(let ee=0,Me=E.length;ee<Me;ee++)N=E[ee],oe=N.getPoints(),M=b(oe),M=a?!M:M,M?(!j&&q[te]&&te++,q[te]={s:new wf,p:oe},q[te].s.curves=N.curves,j&&te++,K[te]=[]):K[te].push({h:N,p:oe[0]});if(!q[0])return d(E);if(q.length>1){let ee=!1,Me=0;for(let we=0,_e=q.length;we<_e;we++)X[we]=[];for(let we=0,_e=q.length;we<_e;we++){const nt=K[we];for(let qe=0;qe<nt.length;qe++){const Je=nt[qe];let it=!0;for(let ze=0;ze<q.length;ze++)A(Je.p,q[ze].p)&&(we!==ze&&Me++,it?(it=!1,X[ze].push(Je)):ee=!0);it&&X[we].push(Je)}}Me>0&&ee===!1&&(K=X)}let re;for(let ee=0,Me=q.length;ee<Me;ee++){P=q[ee].s,k.push(P),re=K[ee];for(let we=0,_e=re.length;we<_e;we++)P.holes.push(re[we].h)}return k}}class mRe extends el{constructor(a=1,d=1,A=1,b={}){console.warn('THREE.WebGLMultipleRenderTargets has been deprecated and will be removed in r172. Use THREE.WebGLRenderTarget and set the "count" parameter to enable MRT.'),super(a,d,{...b,count:A}),this.isWebGLMultipleRenderTargets=!0}get texture(){return this.textures}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:h}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=h)},"./node_modules/three/examples/jsm/libs/ktx-parse.module.js":(l,u,c)=>{c.r(u),c.d(u,{KHR_DF_CHANNEL_RGBSDA_ALPHA:()=>Jt,KHR_DF_CHANNEL_RGBSDA_BLUE:()=>Ce,KHR_DF_CHANNEL_RGBSDA_DEPTH:()=>Ot,KHR_DF_CHANNEL_RGBSDA_GREEN:()=>Qe,KHR_DF_CHANNEL_RGBSDA_RED:()=>Gi,KHR_DF_CHANNEL_RGBSDA_STENCIL:()=>yt,KHR_DF_FLAG_ALPHA_PREMULTIPLIED:()=>D,KHR_DF_FLAG_ALPHA_STRAIGHT:()=>I,KHR_DF_KHR_DESCRIPTORTYPE_BASICFORMAT:()=>y,KHR_DF_MODEL_ASTC:()=>R,KHR_DF_MODEL_ETC1:()=>w,KHR_DF_MODEL_ETC1S:()=>B,KHR_DF_MODEL_ETC2:()=>S,KHR_DF_MODEL_RGBSDA:()=>T,KHR_DF_MODEL_UNSPECIFIED:()=>_,KHR_DF_PRIMARIES_ACES:()=>Ze,KHR_DF_PRIMARIES_ACESCC:()=>Ui,KHR_DF_PRIMARIES_ADOBERGB:()=>ir,KHR_DF_PRIMARIES_BT2020:()=>gt,KHR_DF_PRIMARIES_BT601_EBU:()=>At,KHR_DF_PRIMARIES_BT601_SMPTE:()=>Gt,KHR_DF_PRIMARIES_BT709:()=>lt,KHR_DF_PRIMARIES_CIEXYZ:()=>xi,KHR_DF_PRIMARIES_DISPLAYP3:()=>Ti,KHR_DF_PRIMARIES_NTSC1953:()=>di,KHR_DF_PRIMARIES_PAL525:()=>Ii,KHR_DF_PRIMARIES_UNSPECIFIED:()=>$e,KHR_DF_SAMPLE_DATATYPE_EXPONENT:()=>vt,KHR_DF_SAMPLE_DATATYPE_FLOAT:()=>zt,KHR_DF_SAMPLE_DATATYPE_LINEAR:()=>ye,KHR_DF_SAMPLE_DATATYPE_SIGNED:()=>_i,KHR_DF_TRANSFER_ACESCC:()=>Ie,KHR_DF_TRANSFER_ACESCCT:()=>Ge,KHR_DF_TRANSFER_ADOBERGB:()=>Xe,KHR_DF_TRANSFER_BT1886:()=>Q,KHR_DF_TRANSFER_DCIP3:()=>ae,KHR_DF_TRANSFER_HLG_EOTF:()=>V,KHR_DF_TRANSFER_HLG_OETF:()=>H,KHR_DF_TRANSFER_ITU:()=>Z,KHR_DF_TRANSFER_LINEAR:()=>O,KHR_DF_TRANSFER_NTSC:()=>G,KHR_DF_TRANSFER_PAL625_EOTF:()=>fe,KHR_DF_TRANSFER_PAL_OETF:()=>xe,KHR_DF_TRANSFER_PQ_EOTF:()=>ne,KHR_DF_TRANSFER_PQ_OETF:()=>Y,KHR_DF_TRANSFER_SLOG:()=>z,KHR_DF_TRANSFER_SLOG2:()=>$,KHR_DF_TRANSFER_SRGB:()=>U,KHR_DF_TRANSFER_ST240:()=>de,KHR_DF_TRANSFER_UNSPECIFIED:()=>L,KHR_DF_VENDORID_KHRONOS:()=>x,KHR_DF_VERSION:()=>v,KHR_SUPERCOMPRESSION_BASISLZ:()=>f,KHR_SUPERCOMPRESSION_NONE:()=>p,KHR_SUPERCOMPRESSION_ZLIB:()=>g,KHR_SUPERCOMPRESSION_ZSTD:()=>m,KTX2Container:()=>Ah,VK_FORMAT_A1R5G5B5_UNORM_PACK16:()=>Re,VK_FORMAT_A2B10G10R10_SINT_PACK32:()=>ti,VK_FORMAT_A2B10G10R10_SNORM_PACK32:()=>Kt,VK_FORMAT_A2B10G10R10_UINT_PACK32:()=>Mt,VK_FORMAT_A2B10G10R10_UNORM_PACK32:()=>qt,VK_FORMAT_A2R10G10B10_SINT_PACK32:()=>wt,VK_FORMAT_A2R10G10B10_SNORM_PACK32:()=>Ke,VK_FORMAT_A2R10G10B10_UINT_PACK32:()=>ot,VK_FORMAT_A2R10G10B10_UNORM_PACK32:()=>Fe,VK_FORMAT_A4B4G4R4_UNORM_PACK16_EXT:()=>pv,VK_FORMAT_A4R4G4B4_UNORM_PACK16_EXT:()=>Ld,VK_FORMAT_ASTC_10x10_SFLOAT_BLOCK_EXT:()=>$g,VK_FORMAT_ASTC_10x10_SRGB_BLOCK:()=>Ms,VK_FORMAT_ASTC_10x10_UNORM_BLOCK:()=>Bo,VK_FORMAT_ASTC_10x5_SFLOAT_BLOCK_EXT:()=>IE,VK_FORMAT_ASTC_10x5_SRGB_BLOCK:()=>Io,VK_FORMAT_ASTC_10x5_UNORM_BLOCK:()=>hf,VK_FORMAT_ASTC_10x6_SFLOAT_BLOCK_EXT:()=>BE,VK_FORMAT_ASTC_10x6_SRGB_BLOCK:()=>SE,VK_FORMAT_ASTC_10x6_UNORM_BLOCK:()=>La,VK_FORMAT_ASTC_10x8_SFLOAT_BLOCK_EXT:()=>NE,VK_FORMAT_ASTC_10x8_SRGB_BLOCK:()=>Bd,VK_FORMAT_ASTC_10x8_UNORM_BLOCK:()=>gh,VK_FORMAT_ASTC_12x10_SFLOAT_BLOCK_EXT:()=>QB,VK_FORMAT_ASTC_12x10_SRGB_BLOCK:()=>MB,VK_FORMAT_ASTC_12x10_UNORM_BLOCK:()=>hv,VK_FORMAT_ASTC_12x12_SFLOAT_BLOCK_EXT:()=>Zn,VK_FORMAT_ASTC_12x12_SRGB_BLOCK:()=>df,VK_FORMAT_ASTC_12x12_UNORM_BLOCK:()=>RB,VK_FORMAT_ASTC_4x4_SFLOAT_BLOCK_EXT:()=>Kr,VK_FORMAT_ASTC_4x4_SRGB_BLOCK:()=>EE,VK_FORMAT_ASTC_4x4_UNORM_BLOCK:()=>_E,VK_FORMAT_ASTC_5x4_SFLOAT_BLOCK_EXT:()=>dv,VK_FORMAT_ASTC_5x4_SRGB_BLOCK:()=>CE,VK_FORMAT_ASTC_5x4_UNORM_BLOCK:()=>wE,VK_FORMAT_ASTC_5x5_SFLOAT_BLOCK_EXT:()=>TE,VK_FORMAT_ASTC_5x5_SRGB_BLOCK:()=>vB,VK_FORMAT_ASTC_5x5_UNORM_BLOCK:()=>uf,VK_FORMAT_ASTC_6x5_SFLOAT_BLOCK_EXT:()=>WB,VK_FORMAT_ASTC_6x5_SRGB_BLOCK:()=>bB,VK_FORMAT_ASTC_6x5_UNORM_BLOCK:()=>xB,VK_FORMAT_ASTC_6x6_SFLOAT_BLOCK_EXT:()=>Nd,VK_FORMAT_ASTC_6x6_SRGB_BLOCK:()=>EB,VK_FORMAT_ASTC_6x6_UNORM_BLOCK:()=>_B,VK_FORMAT_ASTC_8x5_SFLOAT_BLOCK_EXT:()=>pf,VK_FORMAT_ASTC_8x5_SRGB_BLOCK:()=>CB,VK_FORMAT_ASTC_8x5_UNORM_BLOCK:()=>wB,VK_FORMAT_ASTC_8x6_SFLOAT_BLOCK_EXT:()=>ME,VK_FORMAT_ASTC_8x6_SRGB_BLOCK:()=>TB,VK_FORMAT_ASTC_8x6_UNORM_BLOCK:()=>SB,VK_FORMAT_ASTC_8x8_SFLOAT_BLOCK_EXT:()=>RE,VK_FORMAT_ASTC_8x8_SRGB_BLOCK:()=>Vl,VK_FORMAT_ASTC_8x8_UNORM_BLOCK:()=>uv,VK_FORMAT_B10G11R11_UFLOAT_PACK32:()=>$o,VK_FORMAT_B10X6G10X6R10X6G10X6_422_UNORM_4PACK16:()=>DB,VK_FORMAT_B12X4G12X4R12X4G12X4_422_UNORM_4PACK16:()=>UB,VK_FORMAT_B4G4R4A4_UNORM_PACK16:()=>ke,VK_FORMAT_B5G5R5A1_UNORM_PACK16:()=>ie,VK_FORMAT_B5G6R5_UNORM_PACK16:()=>F,VK_FORMAT_B8G8R8A8_SINT:()=>ge,VK_FORMAT_B8G8R8A8_SNORM:()=>Be,VK_FORMAT_B8G8R8A8_SRGB:()=>Ne,VK_FORMAT_B8G8R8A8_UINT:()=>se,VK_FORMAT_B8G8R8A8_UNORM:()=>Pi,VK_FORMAT_B8G8R8_SINT:()=>me,VK_FORMAT_B8G8R8_SNORM:()=>rs,VK_FORMAT_B8G8R8_SRGB:()=>ct,VK_FORMAT_B8G8R8_UINT:()=>bs,VK_FORMAT_B8G8R8_UNORM:()=>Ls,VK_FORMAT_BC1_RGBA_SRGB_BLOCK:()=>hs,VK_FORMAT_BC1_RGBA_UNORM_BLOCK:()=>of,VK_FORMAT_BC1_RGB_SRGB_BLOCK:()=>af,VK_FORMAT_BC1_RGB_UNORM_BLOCK:()=>Zg,VK_FORMAT_BC2_SRGB_BLOCK:()=>cf,VK_FORMAT_BC2_UNORM_BLOCK:()=>lf,VK_FORMAT_BC3_SRGB_BLOCK:()=>mh,VK_FORMAT_BC3_UNORM_BLOCK:()=>sB,VK_FORMAT_BC4_SNORM_BLOCK:()=>oB,VK_FORMAT_BC4_UNORM_BLOCK:()=>aB,VK_FORMAT_BC5_SNORM_BLOCK:()=>cB,VK_FORMAT_BC5_UNORM_BLOCK:()=>lB,VK_FORMAT_BC6H_SFLOAT_BLOCK:()=>hB,VK_FORMAT_BC6H_UFLOAT_BLOCK:()=>uB,VK_FORMAT_BC7_SRGB_BLOCK:()=>pB,VK_FORMAT_BC7_UNORM_BLOCK:()=>dB,VK_FORMAT_D16_UNORM:()=>$c,VK_FORMAT_D16_UNORM_S8_UINT:()=>Xa,VK_FORMAT_D24_UNORM_S8_UINT:()=>kn,VK_FORMAT_D32_SFLOAT:()=>co,VK_FORMAT_D32_SFLOAT_S8_UINT:()=>Ic,VK_FORMAT_E5B9G9R9_UFLOAT_PACK32:()=>Rc,VK_FORMAT_EAC_R11G11_SNORM_BLOCK:()=>cv,VK_FORMAT_EAC_R11G11_UNORM_BLOCK:()=>bE,VK_FORMAT_EAC_R11_SNORM_BLOCK:()=>xE,VK_FORMAT_EAC_R11_UNORM_BLOCK:()=>vE,VK_FORMAT_ETC2_R8G8B8A1_SRGB_BLOCK:()=>AB,VK_FORMAT_ETC2_R8G8B8A1_UNORM_BLOCK:()=>gB,VK_FORMAT_ETC2_R8G8B8A8_SRGB_BLOCK:()=>lv,VK_FORMAT_ETC2_R8G8B8A8_UNORM_BLOCK:()=>yB,VK_FORMAT_ETC2_R8G8B8_SRGB_BLOCK:()=>mB,VK_FORMAT_ETC2_R8G8B8_UNORM_BLOCK:()=>fB,VK_FORMAT_G10X6B10X6G10X6R10X6_422_UNORM_4PACK16:()=>LB,VK_FORMAT_G12X4B12X4G12X4R12X4_422_UNORM_4PACK16:()=>FB,VK_FORMAT_PVRTC1_2BPP_SRGB_BLOCK_IMG:()=>Ya,VK_FORMAT_PVRTC1_2BPP_UNORM_BLOCK_IMG:()=>zB,VK_FORMAT_PVRTC1_4BPP_SRGB_BLOCK_IMG:()=>Zr,VK_FORMAT_PVRTC1_4BPP_UNORM_BLOCK_IMG:()=>jB,VK_FORMAT_PVRTC2_2BPP_SRGB_BLOCK_IMG:()=>HB,VK_FORMAT_PVRTC2_2BPP_UNORM_BLOCK_IMG:()=>VB,VK_FORMAT_PVRTC2_4BPP_SRGB_BLOCK_IMG:()=>si,VK_FORMAT_PVRTC2_4BPP_UNORM_BLOCK_IMG:()=>GB,VK_FORMAT_R10X6G10X6B10X6A10X6_UNORM_4PACK16:()=>NB,VK_FORMAT_R10X6G10X6_UNORM_2PACK16:()=>BB,VK_FORMAT_R10X6_UNORM_PACK16:()=>IB,VK_FORMAT_R12X4G12X4B12X4A12X4_UNORM_4PACK16:()=>kB,VK_FORMAT_R12X4G12X4_UNORM_2PACK16:()=>PB,VK_FORMAT_R12X4_UNORM_PACK16:()=>OB,VK_FORMAT_R16G16B16A16_SFLOAT:()=>he,VK_FORMAT_R16G16B16A16_SINT:()=>ft,VK_FORMAT_R16G16B16A16_SNORM:()=>We,VK_FORMAT_R16G16B16A16_UINT:()=>Ye,VK_FORMAT_R16G16B16A16_UNORM:()=>Se,VK_FORMAT_R16G16B16_SFLOAT:()=>Ae,VK_FORMAT_R16G16B16_SINT:()=>ue,VK_FORMAT_R16G16B16_SNORM:()=>Yr,VK_FORMAT_R16G16B16_UINT:()=>W,VK_FORMAT_R16G16B16_UNORM:()=>pn,VK_FORMAT_R16G16_SFLOAT:()=>or,VK_FORMAT_R16G16_SINT:()=>Ri,VK_FORMAT_R16G16_SNORM:()=>Bn,VK_FORMAT_R16G16_UINT:()=>Jn,VK_FORMAT_R16G16_UNORM:()=>bi,VK_FORMAT_R16_SFLOAT:()=>Zi,VK_FORMAT_R16_SINT:()=>hr,VK_FORMAT_R16_SNORM:()=>Fi,VK_FORMAT_R16_UINT:()=>Tr,VK_FORMAT_R16_UNORM:()=>Ei,VK_FORMAT_R32G32B32A32_SFLOAT:()=>xr,VK_FORMAT_R32G32B32A32_SINT:()=>Ni,VK_FORMAT_R32G32B32A32_UINT:()=>Wt,VK_FORMAT_R32G32B32_SFLOAT:()=>Ai,VK_FORMAT_R32G32B32_SINT:()=>ii,VK_FORMAT_R32G32B32_UINT:()=>Ht,VK_FORMAT_R32G32_SFLOAT:()=>Ct,VK_FORMAT_R32G32_SINT:()=>st,VK_FORMAT_R32G32_UINT:()=>Ee,VK_FORMAT_R32_SFLOAT:()=>be,VK_FORMAT_R32_SINT:()=>pe,VK_FORMAT_R32_UINT:()=>le,VK_FORMAT_R4G4B4A4_UNORM_PACK16:()=>Te,VK_FORMAT_R4G4_UNORM_PACK8:()=>Le,VK_FORMAT_R5G5B5A1_UNORM_PACK16:()=>J,VK_FORMAT_R5G6B5_UNORM_PACK16:()=>Pe,VK_FORMAT_R64G64B64A64_SFLOAT:()=>_l,VK_FORMAT_R64G64B64A64_SINT:()=>Or,VK_FORMAT_R64G64B64A64_UINT:()=>ps,VK_FORMAT_R64G64B64_SFLOAT:()=>Gr,VK_FORMAT_R64G64B64_SINT:()=>_n,VK_FORMAT_R64G64B64_UINT:()=>Hr,VK_FORMAT_R64G64_SFLOAT:()=>zr,VK_FORMAT_R64G64_SINT:()=>Mr,VK_FORMAT_R64G64_UINT:()=>Cr,VK_FORMAT_R64_SFLOAT:()=>Wi,VK_FORMAT_R64_SINT:()=>fr,VK_FORMAT_R64_UINT:()=>pr,VK_FORMAT_R8G8B8A8_SINT:()=>ar,VK_FORMAT_R8G8B8A8_SNORM:()=>Xt,VK_FORMAT_R8G8B8A8_SRGB:()=>Li,VK_FORMAT_R8G8B8A8_UINT:()=>Bi,VK_FORMAT_R8G8B8A8_UNORM:()=>St,VK_FORMAT_R8G8B8_SINT:()=>xs,VK_FORMAT_R8G8B8_SNORM:()=>Ur,VK_FORMAT_R8G8B8_SRGB:()=>yn,VK_FORMAT_R8G8B8_UINT:()=>sn,VK_FORMAT_R8G8B8_UNORM:()=>An,VK_FORMAT_R8G8_SINT:()=>Er,VK_FORMAT_R8G8_SNORM:()=>Ut,VK_FORMAT_R8G8_SRGB:()=>ki,VK_FORMAT_R8G8_UINT:()=>pi,VK_FORMAT_R8G8_UNORM:()=>bt,VK_FORMAT_R8_SINT:()=>dt,VK_FORMAT_R8_SNORM:()=>Ue,VK_FORMAT_R8_SRGB:()=>It,VK_FORMAT_R8_UINT:()=>je,VK_FORMAT_R8_UNORM:()=>ce,VK_FORMAT_S8_UINT:()=>tu,VK_FORMAT_UNDEFINED:()=>ve,VK_FORMAT_X8_D24_UNORM_PACK32:()=>eu,read:()=>jn,write:()=>i0});var h=c("./node_modules/buffer/index.js").Buffer;const p=0,f=1,m=2,g=3,y=0,x=0,v=2,_=0,T=1,w=160,S=161,R=162,B=163,I=0,D=1,L=0,O=1,U=2,Z=3,G=4,z=5,$=6,Q=7,H=8,V=9,ne=10,Y=11,ae=12,xe=13,fe=14,de=15,Ie=16,Ge=17,Xe=18,$e=0,lt=1,At=2,Gt=3,gt=4,xi=5,Ze=6,Ui=7,di=8,Ii=9,Ti=10,ir=11,Gi=0,Qe=1,Ce=2,yt=13,Ot=14,Jt=15,zt=128,_i=64,vt=32,ye=16,ve=0,Le=1,Te=2,ke=3,Pe=4,F=5,J=6,ie=7,Re=8,ce=9,Ue=10,je=13,dt=14,It=15,bt=16,Ut=17,pi=20,Er=21,ki=22,An=23,Ur=24,sn=27,xs=28,yn=29,Ls=30,rs=31,bs=34,me=35,ct=36,St=37,Xt=38,Bi=41,ar=42,Li=43,Pi=44,Be=45,se=48,ge=49,Ne=50,Fe=58,Ke=59,ot=62,wt=63,qt=64,Kt=65,Mt=68,ti=69,Ei=70,Fi=71,Tr=74,hr=75,Zi=76,bi=77,Bn=78,Jn=81,Ri=82,or=83,pn=84,Yr=85,W=88,ue=89,Ae=90,Se=91,We=92,Ye=95,ft=96,he=97,le=98,pe=99,be=100,Ee=101,st=102,Ct=103,Ht=104,ii=105,Ai=106,Wt=107,Ni=108,xr=109,pr=110,fr=111,Wi=112,Cr=113,Mr=114,zr=115,Hr=116,_n=117,Gr=118,ps=119,Or=120,_l=121,$o=122,Rc=123,$c=124,eu=125,co=126,tu=127,Xa=128,kn=129,Ic=130,Zg=131,af=132,of=133,hs=134,lf=135,cf=136,sB=137,mh=138,aB=139,oB=140,lB=141,cB=142,uB=143,hB=144,dB=145,pB=146,fB=147,mB=148,gB=149,AB=150,yB=151,lv=152,vE=153,xE=154,bE=155,cv=156,_E=157,EE=158,wE=159,CE=160,uf=161,vB=162,xB=163,bB=164,_B=165,EB=166,wB=167,CB=168,SB=169,TB=170,uv=171,Vl=172,hf=173,Io=174,La=175,SE=176,gh=177,Bd=178,Bo=179,Ms=180,hv=181,MB=182,RB=183,df=184,IB=1000156007,BB=1000156008,NB=1000156009,LB=1000156010,DB=1000156011,OB=1000156017,PB=1000156018,kB=1000156019,FB=1000156020,UB=1000156021,zB=1000054e3,jB=1000054001,VB=1000054002,GB=1000054003,Ya=1000054004,Zr=1000054005,HB=1000054006,si=1000054007,Kr=1000066e3,dv=1000066001,TE=1000066002,WB=1000066003,Nd=1000066004,pf=1000066005,ME=1000066006,RE=1000066007,IE=1000066008,BE=1000066009,NE=1000066010,$g=1000066011,QB=1000066012,Zn=1000066013,Ld=100034e4,pv=1000340001;class Ah{constructor(){this.vkFormat=0,this.typeSize=1,this.pixelWidth=0,this.pixelHeight=0,this.pixelDepth=0,this.layerCount=0,this.faceCount=1,this.supercompressionScheme=0,this.levels=[],this.dataFormatDescriptor=[{vendorId:0,descriptorType:0,descriptorBlockSize:0,versionNumber:2,colorModel:0,colorPrimaries:1,transferFunction:2,flags:0,texelBlockDimension:[0,0,0,0],bytesPlane:[0,0,0,0,0,0,0,0],samples:[]}],this.keyValue={},this.globalData=null}}class Dd{constructor(Jr,Ln,Wn,He){this._dataView=new DataView(Jr.buffer,Jr.byteOffset+Ln,Wn),this._littleEndian=He,this._offset=0}_nextUint8(){const Jr=this._dataView.getUint8(this._offset);return this._offset+=1,Jr}_nextUint16(){const Jr=this._dataView.getUint16(this._offset,this._littleEndian);return this._offset+=2,Jr}_nextUint32(){const Jr=this._dataView.getUint32(this._offset,this._littleEndian);return this._offset+=4,Jr}_nextUint64(){const Jr=this._dataView.getUint32(this._offset,this._littleEndian)+4294967296*this._dataView.getUint32(this._offset+4,this._littleEndian);return this._offset+=8,Jr}_nextInt32(){const Jr=this._dataView.getInt32(this._offset,this._littleEndian);return this._offset+=4,Jr}_skip(Jr){return this._offset+=Jr,this}_scan(Jr,Ln=0){const Wn=this._offset;let He=0;for(;this._dataView.getUint8(this._offset)!==Ln&&He<Jr;)He++,this._offset++;return He<Jr&&this._offset++,new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+Wn,He)}}const LE=new Uint8Array([0]),_s=[171,75,84,88,32,50,48,187,13,10,26,10];function e0(dr){return typeof TextEncoder<"u"?new TextEncoder().encode(dr):h.from(dr)}function DE(dr){return typeof TextDecoder<"u"?new TextDecoder().decode(dr):h.from(dr).toString("utf8")}function fs(dr){let Jr=0;for(const He of dr)Jr+=He.byteLength;const Ln=new Uint8Array(Jr);let Wn=0;for(const He of dr)Ln.set(new Uint8Array(He),Wn),Wn+=He.byteLength;return Ln}function jn(dr){const Jr=new Uint8Array(dr.buffer,dr.byteOffset,_s.length);if(Jr[0]!==_s[0]||Jr[1]!==_s[1]||Jr[2]!==_s[2]||Jr[3]!==_s[3]||Jr[4]!==_s[4]||Jr[5]!==_s[5]||Jr[6]!==_s[6]||Jr[7]!==_s[7]||Jr[8]!==_s[8]||Jr[9]!==_s[9]||Jr[10]!==_s[10]||Jr[11]!==_s[11])throw new Error("Missing KTX 2.0 identifier.");const Ln=new Ah,Wn=17*Uint32Array.BYTES_PER_ELEMENT,He=new Dd(dr,_s.length,Wn,!0);Ln.vkFormat=He._nextUint32(),Ln.typeSize=He._nextUint32(),Ln.pixelWidth=He._nextUint32(),Ln.pixelHeight=He._nextUint32(),Ln.pixelDepth=He._nextUint32(),Ln.layerCount=He._nextUint32(),Ln.faceCount=He._nextUint32();const El=He._nextUint32();Ln.supercompressionScheme=He._nextUint32();const js=He._nextUint32(),Ds=He._nextUint32(),Cn=He._nextUint32(),uo=He._nextUint32(),iu=He._nextUint64(),tl=He._nextUint64(),Da=new Dd(dr,_s.length+Wn,3*El*8,!0);for(let va=0;va<El;va++)Ln.levels.push({levelData:new Uint8Array(dr.buffer,dr.byteOffset+Da._nextUint64(),Da._nextUint64()),uncompressedByteLength:Da._nextUint64()});const an=new Dd(dr,js,Ds,!0),Ka={vendorId:an._skip(4)._nextUint16(),descriptorType:an._nextUint16(),versionNumber:an._nextUint16(),descriptorBlockSize:an._nextUint16(),colorModel:an._nextUint8(),colorPrimaries:an._nextUint8(),transferFunction:an._nextUint8(),flags:an._nextUint8(),texelBlockDimension:[an._nextUint8(),an._nextUint8(),an._nextUint8(),an._nextUint8()],bytesPlane:[an._nextUint8(),an._nextUint8(),an._nextUint8(),an._nextUint8(),an._nextUint8(),an._nextUint8(),an._nextUint8(),an._nextUint8()],samples:[]},wl=(Ka.descriptorBlockSize/4-6)/4;for(let va=0;va<wl;va++){const mr={bitOffset:an._nextUint16(),bitLength:an._nextUint8(),channelType:an._nextUint8(),samplePosition:[an._nextUint8(),an._nextUint8(),an._nextUint8(),an._nextUint8()],sampleLower:-1/0,sampleUpper:1/0};64&mr.channelType?(mr.sampleLower=an._nextInt32(),mr.sampleUpper=an._nextInt32()):(mr.sampleLower=an._nextUint32(),mr.sampleUpper=an._nextUint32()),Ka.samples[va]=mr}Ln.dataFormatDescriptor.length=0,Ln.dataFormatDescriptor.push(Ka);const Oa=new Dd(dr,Cn,uo,!0);for(;Oa._offset<uo;){const va=Oa._nextUint32(),mr=Oa._scan(va),vh=DE(mr),il=Oa._scan(va-mr.byteLength);Ln.keyValue[vh]=vh.match(/^ktx/i)?DE(il):il,Oa._offset%4&&Oa._skip(4-Oa._offset%4)}if(tl<=0)return Ln;const Fn=new Dd(dr,iu,tl,!0),os=Fn._nextUint16(),on=Fn._nextUint16(),Un=Fn._nextUint32(),No=Fn._nextUint32(),Od=Fn._nextUint32(),yh=Fn._nextUint32(),r0=[];for(let va=0;va<El;va++)r0.push({imageFlags:Fn._nextUint32(),rgbSliceByteOffset:Fn._nextUint32(),rgbSliceByteLength:Fn._nextUint32(),alphaSliceByteOffset:Fn._nextUint32(),alphaSliceByteLength:Fn._nextUint32()});const ya=iu+Fn._offset,Gl=ya+Un,n0=Gl+No,s0=n0+Od,ru=new Uint8Array(dr.buffer,dr.byteOffset+ya,Un),fv=new Uint8Array(dr.buffer,dr.byteOffset+Gl,No),a0=new Uint8Array(dr.buffer,dr.byteOffset+n0,Od),mv=new Uint8Array(dr.buffer,dr.byteOffset+s0,yh);return Ln.globalData={endpointCount:os,selectorCount:on,imageDescs:r0,endpointsData:ru,selectorsData:fv,tablesData:a0,extendedData:mv},Ln}function t0(){return(t0=Object.assign||function(dr){for(var Jr=1;Jr<arguments.length;Jr++){var Ln=arguments[Jr];for(var Wn in Ln)Object.prototype.hasOwnProperty.call(Ln,Wn)&&(dr[Wn]=Ln[Wn])}return dr}).apply(this,arguments)}const el={keepWriter:!1};function i0(dr,Jr={}){Jr=t0({},el,Jr);let Ln=new ArrayBuffer(0);if(dr.globalData){const os=new ArrayBuffer(20+5*dr.globalData.imageDescs.length*4),on=new DataView(os);on.setUint16(0,dr.globalData.endpointCount,!0),on.setUint16(2,dr.globalData.selectorCount,!0),on.setUint32(4,dr.globalData.endpointsData.byteLength,!0),on.setUint32(8,dr.globalData.selectorsData.byteLength,!0),on.setUint32(12,dr.globalData.tablesData.byteLength,!0),on.setUint32(16,dr.globalData.extendedData.byteLength,!0);for(let Un=0;Un<dr.globalData.imageDescs.length;Un++){const No=dr.globalData.imageDescs[Un];on.setUint32(20+5*Un*4+0,No.imageFlags,!0),on.setUint32(20+5*Un*4+4,No.rgbSliceByteOffset,!0),on.setUint32(20+5*Un*4+8,No.rgbSliceByteLength,!0),on.setUint32(20+5*Un*4+12,No.alphaSliceByteOffset,!0),on.setUint32(20+5*Un*4+16,No.alphaSliceByteLength,!0)}Ln=fs([os,dr.globalData.endpointsData,dr.globalData.selectorsData,dr.globalData.tablesData,dr.globalData.extendedData])}const Wn=[];let He=dr.keyValue;Jr.keepWriter||(He=t0({},dr.keyValue,{KTXwriter:"KTX-Parse v0.3.1"}));for(const os in He){const on=He[os],Un=e0(os),No=typeof on=="string"?e0(on):on,Od=Un.byteLength+1+No.byteLength+1,yh=Od%4?4-Od%4:0;Wn.push(fs([new Uint32Array([Od]),Un,LE,No,LE,new Uint8Array(yh).fill(0)]))}const El=fs(Wn);if(dr.dataFormatDescriptor.length!==1||dr.dataFormatDescriptor[0].descriptorType!==0)throw new Error("Only BASICFORMAT Data Format Descriptor output supported.");const js=dr.dataFormatDescriptor[0],Ds=new ArrayBuffer(28+16*js.samples.length),Cn=new DataView(Ds),uo=24+16*js.samples.length;if(Cn.setUint32(0,Ds.byteLength,!0),Cn.setUint16(4,js.vendorId,!0),Cn.setUint16(6,js.descriptorType,!0),Cn.setUint16(8,js.versionNumber,!0),Cn.setUint16(10,uo,!0),Cn.setUint8(12,js.colorModel),Cn.setUint8(13,js.colorPrimaries),Cn.setUint8(14,js.transferFunction),Cn.setUint8(15,js.flags),!Array.isArray(js.texelBlockDimension))throw new Error("texelBlockDimension is now an array. For dimensionality `d`, set `d - 1`.");Cn.setUint8(16,js.texelBlockDimension[0]),Cn.setUint8(17,js.texelBlockDimension[1]),Cn.setUint8(18,js.texelBlockDimension[2]),Cn.setUint8(19,js.texelBlockDimension[3]);for(let os=0;os<8;os++)Cn.setUint8(20+os,js.bytesPlane[os]);for(let os=0;os<js.samples.length;os++){const on=js.samples[os],Un=28+16*os;if(on.channelID)throw new Error("channelID has been renamed to channelType.");Cn.setUint16(Un+0,on.bitOffset,!0),Cn.setUint8(Un+2,on.bitLength),Cn.setUint8(Un+3,on.channelType),Cn.setUint8(Un+4,on.samplePosition[0]),Cn.setUint8(Un+5,on.samplePosition[1]),Cn.setUint8(Un+6,on.samplePosition[2]),Cn.setUint8(Un+7,on.samplePosition[3]),64&on.channelType?(Cn.setInt32(Un+8,on.sampleLower,!0),Cn.setInt32(Un+12,on.sampleUpper,!0)):(Cn.setUint32(Un+8,on.sampleLower,!0),Cn.setUint32(Un+12,on.sampleUpper,!0))}const iu=_s.length+68+3*dr.levels.length*8,tl=iu+Ds.byteLength;let Da=Ln.byteLength>0?tl+El.byteLength:0;Da%8&&(Da+=8-Da%8);const an=[],Ka=new DataView(new ArrayBuffer(3*dr.levels.length*8));let wl=(Da||tl+El.byteLength)+Ln.byteLength;for(let os=0;os<dr.levels.length;os++){const on=dr.levels[os];an.push(on.levelData),Ka.setBigUint64(24*os+0,BigInt(wl),!0),Ka.setBigUint64(24*os+8,BigInt(on.levelData.byteLength),!0),Ka.setBigUint64(24*os+16,BigInt(on.uncompressedByteLength),!0),wl+=on.levelData.byteLength}const Oa=new ArrayBuffer(68),Fn=new DataView(Oa);return Fn.setUint32(0,dr.vkFormat,!0),Fn.setUint32(4,dr.typeSize,!0),Fn.setUint32(8,dr.pixelWidth,!0),Fn.setUint32(12,dr.pixelHeight,!0),Fn.setUint32(16,dr.pixelDepth,!0),Fn.setUint32(20,dr.layerCount,!0),Fn.setUint32(24,dr.faceCount,!0),Fn.setUint32(28,dr.levels.length,!0),Fn.setUint32(32,dr.supercompressionScheme,!0),Fn.setUint32(36,iu,!0),Fn.setUint32(40,Ds.byteLength,!0),Fn.setUint32(44,tl,!0),Fn.setUint32(48,El.byteLength,!0),Fn.setBigUint64(52,BigInt(Ln.byteLength>0?Da:0),!0),Fn.setBigUint64(60,BigInt(Ln.byteLength),!0),new Uint8Array(fs([new Uint8Array(_s).buffer,Oa,Ka.buffer,Ds,El,Da>0?new ArrayBuffer(Da-(tl+El.byteLength)):new ArrayBuffer(0),Ln,...an]))}},"./node_modules/three/examples/jsm/libs/zstddec.module.js":(l,u,c)=>{c.r(u),c.d(u,{ZSTDDecoder:()=>y});var h=c("./node_modules/buffer/index.js").Buffer;let p,f,m;const g={env:{emscripten_notify_memory_growth:function(v){m=new Uint8Array(f.exports.memory.buffer)}}};class y{init(){return p||(p=typeof fetch<"u"?fetch("data:application/wasm;base64,"+x).then(_=>_.arrayBuffer()).then(_=>WebAssembly.instantiate(_,g)).then(this._init):WebAssembly.instantiate(h.from(x,"base64"),g).then(this._init),p)}_init(_){f=_.instance,g.env.emscripten_notify_memory_growth(0)}decode(_,T=0){if(!f)throw new Error("ZSTDDecoder: Await .init() before decoding.");const w=_.byteLength,S=f.exports.malloc(w);m.set(_,S),T=T||Number(f.exports.ZSTD_findDecompressedSize(S,w));const R=f.exports.malloc(T),B=f.exports.ZSTD_decompress(R,T,S,w),I=m.slice(R,R+B);return f.exports.free(S),f.exports.free(R),I}}const x="AGFzbQEAAAABpQEVYAF/AX9gAn9/AGADf39/AX9gBX9/f39/AX9gAX8AYAJ/fwF/YAR/f39/AX9gA39/fwBgBn9/f39/fwF/YAd/f39/f39/AX9gAn9/AX5gAn5+AX5gAABgBX9/f39/AGAGf39/f39/AGAIf39/f39/f38AYAl/f39/f39/f38AYAABf2AIf39/f39/f38Bf2ANf39/f39/f39/f39/fwF/YAF/AX4CJwEDZW52H2Vtc2NyaXB0ZW5fbm90aWZ5X21lbW9yeV9ncm93dGgABANpaAEFAAAFAgEFCwACAQABAgIFBQcAAwABDgsBAQcAEhMHAAUBDAQEAAANBwQCAgYCBAgDAwMDBgEACQkHBgICAAYGAgQUBwYGAwIGAAMCAQgBBwUGCgoEEQAEBAEIAwgDBQgDEA8IAAcABAUBcAECAgUEAQCAAgYJAX8BQaCgwAILB2AHBm1lbW9yeQIABm1hbGxvYwAoBGZyZWUAJgxaU1REX2lzRXJyb3IAaBlaU1REX2ZpbmREZWNvbXByZXNzZWRTaXplAFQPWlNURF9kZWNvbXByZXNzAEoGX3N0YXJ0ACQJBwEAQQELASQKussBaA8AIAAgACgCBCABajYCBAsZACAAKAIAIAAoAgRBH3F0QQAgAWtBH3F2CwgAIABBiH9LC34BBH9BAyEBIAAoAgQiA0EgTQRAIAAoAggiASAAKAIQTwRAIAAQDQ8LIAAoAgwiAiABRgRAQQFBAiADQSBJGw8LIAAgASABIAJrIANBA3YiBCABIARrIAJJIgEbIgJrIgQ2AgggACADIAJBA3RrNgIEIAAgBCgAADYCAAsgAQsUAQF/IAAgARACIQIgACABEAEgAgv3AQECfyACRQRAIABCADcCACAAQQA2AhAgAEIANwIIQbh/DwsgACABNgIMIAAgAUEEajYCECACQQRPBEAgACABIAJqIgFBfGoiAzYCCCAAIAMoAAA2AgAgAUF/ai0AACIBBEAgAEEIIAEQFGs2AgQgAg8LIABBADYCBEF/DwsgACABNgIIIAAgAS0AACIDNgIAIAJBfmoiBEEBTQRAIARBAWtFBEAgACABLQACQRB0IANyIgM2AgALIAAgAS0AAUEIdCADajYCAAsgASACakF/ai0AACIBRQRAIABBADYCBEFsDwsgAEEoIAEQFCACQQN0ams2AgQgAgsWACAAIAEpAAA3AAAgACABKQAINwAICy8BAX8gAUECdEGgHWooAgAgACgCAEEgIAEgACgCBGprQR9xdnEhAiAAIAEQASACCyEAIAFCz9bTvtLHq9lCfiAAfEIfiUKHla+vmLbem55/fgsdAQF/IAAoAgggACgCDEYEfyAAKAIEQSBGBUEACwuCBAEDfyACQYDAAE8EQCAAIAEgAhBnIAAPCyAAIAJqIQMCQCAAIAFzQQNxRQRAAkAgAkEBSARAIAAhAgwBCyAAQQNxRQRAIAAhAgwBCyAAIQIDQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADTw0BIAJBA3ENAAsLAkAgA0F8cSIEQcAASQ0AIAIgBEFAaiIFSw0AA0AgAiABKAIANgIAIAIgASgCBDYCBCACIAEoAgg2AgggAiABKAIMNgIMIAIgASgCEDYCECACIAEoAhQ2AhQgAiABKAIYNgIYIAIgASgCHDYCHCACIAEoAiA2AiAgAiABKAIkNgIkIAIgASgCKDYCKCACIAEoAiw2AiwgAiABKAIwNgIwIAIgASgCNDYCNCACIAEoAjg2AjggAiABKAI8NgI8IAFBQGshASACQUBrIgIgBU0NAAsLIAIgBE8NAQNAIAIgASgCADYCACABQQRqIQEgAkEEaiICIARJDQALDAELIANBBEkEQCAAIQIMAQsgA0F8aiIEIABJBEAgACECDAELIAAhAgNAIAIgAS0AADoAACACIAEtAAE6AAEgAiABLQACOgACIAIgAS0AAzoAAyABQQRqIQEgAkEEaiICIARNDQALCyACIANJBEADQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADRw0ACwsgAAsMACAAIAEpAAA3AAALQQECfyAAKAIIIgEgACgCEEkEQEEDDwsgACAAKAIEIgJBB3E2AgQgACABIAJBA3ZrIgE2AgggACABKAAANgIAQQALDAAgACABKAIANgAAC/cCAQJ/AkAgACABRg0AAkAgASACaiAASwRAIAAgAmoiBCABSw0BCyAAIAEgAhALDwsgACABc0EDcSEDAkACQCAAIAFJBEAgAwRAIAAhAwwDCyAAQQNxRQRAIAAhAwwCCyAAIQMDQCACRQ0EIAMgAS0AADoAACABQQFqIQEgAkF/aiECIANBAWoiA0EDcQ0ACwwBCwJAIAMNACAEQQNxBEADQCACRQ0FIAAgAkF/aiICaiIDIAEgAmotAAA6AAAgA0EDcQ0ACwsgAkEDTQ0AA0AgACACQXxqIgJqIAEgAmooAgA2AgAgAkEDSw0ACwsgAkUNAgNAIAAgAkF/aiICaiABIAJqLQAAOgAAIAINAAsMAgsgAkEDTQ0AIAIhBANAIAMgASgCADYCACABQQRqIQEgA0EEaiEDIARBfGoiBEEDSw0ACyACQQNxIQILIAJFDQADQCADIAEtAAA6AAAgA0EBaiEDIAFBAWohASACQX9qIgINAAsLIAAL8wICAn8BfgJAIAJFDQAgACACaiIDQX9qIAE6AAAgACABOgAAIAJBA0kNACADQX5qIAE6AAAgACABOgABIANBfWogAToAACAAIAE6AAIgAkEHSQ0AIANBfGogAToAACAAIAE6AAMgAkEJSQ0AIABBACAAa0EDcSIEaiIDIAFB/wFxQYGChAhsIgE2AgAgAyACIARrQXxxIgRqIgJBfGogATYCACAEQQlJDQAgAyABNgIIIAMgATYCBCACQXhqIAE2AgAgAkF0aiABNgIAIARBGUkNACADIAE2AhggAyABNgIUIAMgATYCECADIAE2AgwgAkFwaiABNgIAIAJBbGogATYCACACQWhqIAE2AgAgAkFkaiABNgIAIAQgA0EEcUEYciIEayICQSBJDQAgAa0iBUIghiAFhCEFIAMgBGohAQNAIAEgBTcDGCABIAU3AxAgASAFNwMIIAEgBTcDACABQSBqIQEgAkFgaiICQR9LDQALCyAACy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAIajYCACADCy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAFajYCACADCx8AIAAgASACKAIEEAg2AgAgARAEGiAAIAJBCGo2AgQLCAAgAGdBH3MLugUBDX8jAEEQayIKJAACfyAEQQNNBEAgCkEANgIMIApBDGogAyAEEAsaIAAgASACIApBDGpBBBAVIgBBbCAAEAMbIAAgACAESxsMAQsgAEEAIAEoAgBBAXRBAmoQECENQVQgAygAACIGQQ9xIgBBCksNABogAiAAQQVqNgIAIAMgBGoiAkF8aiEMIAJBeWohDiACQXtqIRAgAEEGaiELQQQhBSAGQQR2IQRBICAAdCIAQQFyIQkgASgCACEPQQAhAiADIQYCQANAIAlBAkggAiAPS3JFBEAgAiEHAkAgCARAA0AgBEH//wNxQf//A0YEQCAHQRhqIQcgBiAQSQR/IAZBAmoiBigAACAFdgUgBUEQaiEFIARBEHYLIQQMAQsLA0AgBEEDcSIIQQNGBEAgBUECaiEFIARBAnYhBCAHQQNqIQcMAQsLIAcgCGoiByAPSw0EIAVBAmohBQNAIAIgB0kEQCANIAJBAXRqQQA7AQAgAkEBaiECDAELCyAGIA5LQQAgBiAFQQN1aiIHIAxLG0UEQCAHKAAAIAVBB3EiBXYhBAwCCyAEQQJ2IQQLIAYhBwsCfyALQX9qIAQgAEF/anEiBiAAQQF0QX9qIgggCWsiEUkNABogBCAIcSIEQQAgESAEIABIG2shBiALCyEIIA0gAkEBdGogBkF/aiIEOwEAIAlBASAGayAEIAZBAUgbayEJA0AgCSAASARAIABBAXUhACALQX9qIQsMAQsLAn8gByAOS0EAIAcgBSAIaiIFQQN1aiIGIAxLG0UEQCAFQQdxDAELIAUgDCIGIAdrQQN0awshBSACQQFqIQIgBEUhCCAGKAAAIAVBH3F2IQQMAQsLQWwgCUEBRyAFQSBKcg0BGiABIAJBf2o2AgAgBiAFQQdqQQN1aiADawwBC0FQCyEAIApBEGokACAACwkAQQFBBSAAGwsMACAAIAEoAAA2AAALqgMBCn8jAEHwAGsiCiQAIAJBAWohDiAAQQhqIQtBgIAEIAVBf2p0QRB1IQxBACECQQEhBkEBIAV0IglBf2oiDyEIA0AgAiAORkUEQAJAIAEgAkEBdCINai8BACIHQf//A0YEQCALIAhBA3RqIAI2AgQgCEF/aiEIQQEhBwwBCyAGQQAgDCAHQRB0QRB1ShshBgsgCiANaiAHOwEAIAJBAWohAgwBCwsgACAFNgIEIAAgBjYCACAJQQN2IAlBAXZqQQNqIQxBACEAQQAhBkEAIQIDQCAGIA5GBEADQAJAIAAgCUYNACAKIAsgAEEDdGoiASgCBCIGQQF0aiICIAIvAQAiAkEBajsBACABIAUgAhAUayIIOgADIAEgAiAIQf8BcXQgCWs7AQAgASAEIAZBAnQiAmooAgA6AAIgASACIANqKAIANgIEIABBAWohAAwBCwsFIAEgBkEBdGouAQAhDUEAIQcDQCAHIA1ORQRAIAsgAkEDdGogBjYCBANAIAIgDGogD3EiAiAISw0ACyAHQQFqIQcMAQsLIAZBAWohBgwBCwsgCkHwAGokAAsjAEIAIAEQCSAAhUKHla+vmLbem55/fkLj3MqV/M7y9YV/fAsQACAAQn43AwggACABNgIACyQBAX8gAARAIAEoAgQiAgRAIAEoAgggACACEQEADwsgABAmCwsfACAAIAEgAi8BABAINgIAIAEQBBogACACQQRqNgIEC0oBAX9BoCAoAgAiASAAaiIAQX9MBEBBiCBBMDYCAEF/DwsCQCAAPwBBEHRNDQAgABBmDQBBiCBBMDYCAEF/DwtBoCAgADYCACABC9cBAQh/Qbp/IQoCQCACKAIEIgggAigCACIJaiIOIAEgAGtLDQBBbCEKIAkgBCADKAIAIgtrSw0AIAAgCWoiBCACKAIIIgxrIQ0gACABQWBqIg8gCyAJQQAQKSADIAkgC2o2AgACQAJAIAwgBCAFa00EQCANIQUMAQsgDCAEIAZrSw0CIAcgDSAFayIAaiIBIAhqIAdNBEAgBCABIAgQDxoMAgsgBCABQQAgAGsQDyEBIAIgACAIaiIINgIEIAEgAGshBAsgBCAPIAUgCEEBECkLIA4hCgsgCgubAgEBfyMAQYABayINJAAgDSADNgJ8AkAgAkEDSwRAQX8hCQwBCwJAAkACQAJAIAJBAWsOAwADAgELIAZFBEBBuH8hCQwEC0FsIQkgBS0AACICIANLDQMgACAHIAJBAnQiAmooAgAgAiAIaigCABA7IAEgADYCAEEBIQkMAwsgASAJNgIAQQAhCQwCCyAKRQRAQWwhCQwCC0EAIQkgC0UgDEEZSHINAUEIIAR0QQhqIQBBACECA0AgAiAATw0CIAJBQGshAgwAAAsAC0FsIQkgDSANQfwAaiANQfgAaiAFIAYQFSICEAMNACANKAJ4IgMgBEsNACAAIA0gDSgCfCAHIAggAxAYIAEgADYCACACIQkLIA1BgAFqJAAgCQsLACAAIAEgAhALGgsQACAALwAAIAAtAAJBEHRyCy8AAn9BuH8gAUEISQ0AGkFyIAAoAAQiAEF3Sw0AGkG4fyAAQQhqIgAgACABSxsLCwkAIAAgATsAAAsDAAELigYBBX8gACAAKAIAIgVBfnE2AgBBACAAIAVBAXZqQYQgKAIAIgQgAEYbIQECQAJAIAAoAgQiAkUNACACKAIAIgNBAXENACACQQhqIgUgA0EBdkF4aiIDQQggA0EISxtnQR9zQQJ0QYAfaiIDKAIARgRAIAMgAigCDDYCAAsgAigCCCIDBEAgAyACKAIMNgIECyACKAIMIgMEQCADIAIoAgg2AgALIAIgAigCACAAKAIAQX5xajYCAEGEICEAAkACQCABRQ0AIAEgAjYCBCABKAIAIgNBAXENASADQQF2QXhqIgNBCCADQQhLG2dBH3NBAnRBgB9qIgMoAgAgAUEIakYEQCADIAEoAgw2AgALIAEoAggiAwRAIAMgASgCDDYCBAsgASgCDCIDBEAgAyABKAIINgIAQYQgKAIAIQQLIAIgAigCACABKAIAQX5xajYCACABIARGDQAgASABKAIAQQF2akEEaiEACyAAIAI2AgALIAIoAgBBAXZBeGoiAEEIIABBCEsbZ0Efc0ECdEGAH2oiASgCACEAIAEgBTYCACACIAA2AgwgAkEANgIIIABFDQEgACAFNgIADwsCQCABRQ0AIAEoAgAiAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAigCACABQQhqRgRAIAIgASgCDDYCAAsgASgCCCICBEAgAiABKAIMNgIECyABKAIMIgIEQCACIAEoAgg2AgBBhCAoAgAhBAsgACAAKAIAIAEoAgBBfnFqIgI2AgACQCABIARHBEAgASABKAIAQQF2aiAANgIEIAAoAgAhAgwBC0GEICAANgIACyACQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgIoAgAhASACIABBCGoiAjYCACAAIAE2AgwgAEEANgIIIAFFDQEgASACNgIADwsgBUEBdkF4aiIBQQggAUEISxtnQR9zQQJ0QYAfaiICKAIAIQEgAiAAQQhqIgI2AgAgACABNgIMIABBADYCCCABRQ0AIAEgAjYCAAsLDgAgAARAIABBeGoQJQsLgAIBA38CQCAAQQ9qQXhxQYQgKAIAKAIAQQF2ayICEB1Bf0YNAAJAQYQgKAIAIgAoAgAiAUEBcQ0AIAFBAXZBeGoiAUEIIAFBCEsbZ0Efc0ECdEGAH2oiASgCACAAQQhqRgRAIAEgACgCDDYCAAsgACgCCCIBBEAgASAAKAIMNgIECyAAKAIMIgFFDQAgASAAKAIINgIAC0EBIQEgACAAKAIAIAJBAXRqIgI2AgAgAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAygCACECIAMgAEEIaiIDNgIAIAAgAjYCDCAAQQA2AgggAkUNACACIAM2AgALIAELtwIBA38CQAJAIABBASAAGyICEDgiAA0AAkACQEGEICgCACIARQ0AIAAoAgAiA0EBcQ0AIAAgA0EBcjYCACADQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgAgAEEIakYEQCABIAAoAgw2AgALIAAoAggiAQRAIAEgACgCDDYCBAsgACgCDCIBBEAgASAAKAIINgIACyACECchAkEAIQFBhCAoAgAhACACDQEgACAAKAIAQX5xNgIAQQAPCyACQQ9qQXhxIgMQHSICQX9GDQIgAkEHakF4cSIAIAJHBEAgACACaxAdQX9GDQMLAkBBhCAoAgAiAUUEQEGAICAANgIADAELIAAgATYCBAtBhCAgADYCACAAIANBAXRBAXI2AgAMAQsgAEUNAQsgAEEIaiEBCyABC7kDAQJ/IAAgA2ohBQJAIANBB0wEQANAIAAgBU8NAiAAIAItAAA6AAAgAEEBaiEAIAJBAWohAgwAAAsACyAEQQFGBEACQCAAIAJrIgZBB00EQCAAIAItAAA6AAAgACACLQABOgABIAAgAi0AAjoAAiAAIAItAAM6AAMgAEEEaiACIAZBAnQiBkHAHmooAgBqIgIQFyACIAZB4B5qKAIAayECDAELIAAgAhAMCyACQQhqIQIgAEEIaiEACwJAAkACQAJAIAUgAU0EQCAAIANqIQEgBEEBRyAAIAJrQQ9Kcg0BA0AgACACEAwgAkEIaiECIABBCGoiACABSQ0ACwwFCyAAIAFLBEAgACEBDAQLIARBAUcgACACa0EPSnINASAAIQMgAiEEA0AgAyAEEAwgBEEIaiEEIANBCGoiAyABSQ0ACwwCCwNAIAAgAhAHIAJBEGohAiAAQRBqIgAgAUkNAAsMAwsgACEDIAIhBANAIAMgBBAHIARBEGohBCADQRBqIgMgAUkNAAsLIAIgASAAa2ohAgsDQCABIAVPDQEgASACLQAAOgAAIAFBAWohASACQQFqIQIMAAALAAsLQQECfyAAIAAoArjgASIDNgLE4AEgACgCvOABIQQgACABNgK84AEgACABIAJqNgK44AEgACABIAQgA2tqNgLA4AELpgEBAX8gACAAKALs4QEQFjYCyOABIABCADcD+OABIABCADcDuOABIABBwOABakIANwMAIABBqNAAaiIBQYyAgOAANgIAIABBADYCmOIBIABCADcDiOEBIABCAzcDgOEBIABBrNABakHgEikCADcCACAAQbTQAWpB6BIoAgA2AgAgACABNgIMIAAgAEGYIGo2AgggACAAQaAwajYCBCAAIABBEGo2AgALYQEBf0G4fyEDAkAgAUEDSQ0AIAIgABAhIgFBA3YiADYCCCACIAFBAXE2AgQgAiABQQF2QQNxIgM2AgACQCADQX9qIgFBAksNAAJAIAFBAWsOAgEAAgtBbA8LIAAhAwsgAwsMACAAIAEgAkEAEC4LiAQCA38CfiADEBYhBCAAQQBBKBAQIQAgBCACSwRAIAQPCyABRQRAQX8PCwJAAkAgA0EBRg0AIAEoAAAiBkGo6r5pRg0AQXYhAyAGQXBxQdDUtMIBRw0BQQghAyACQQhJDQEgAEEAQSgQECEAIAEoAAQhASAAQQE2AhQgACABrTcDAEEADwsgASACIAMQLyIDIAJLDQAgACADNgIYQXIhAyABIARqIgVBf2otAAAiAkEIcQ0AIAJBIHEiBkUEQEFwIQMgBS0AACIFQacBSw0BIAVBB3GtQgEgBUEDdkEKaq2GIgdCA4h+IAd8IQggBEEBaiEECyACQQZ2IQMgAkECdiEFAkAgAkEDcUF/aiICQQJLBEBBACECDAELAkACQAJAIAJBAWsOAgECAAsgASAEai0AACECIARBAWohBAwCCyABIARqLwAAIQIgBEECaiEEDAELIAEgBGooAAAhAiAEQQRqIQQLIAVBAXEhBQJ+AkACQAJAIANBf2oiA0ECTQRAIANBAWsOAgIDAQtCfyAGRQ0DGiABIARqMQAADAMLIAEgBGovAACtQoACfAwCCyABIARqKAAArQwBCyABIARqKQAACyEHIAAgBTYCICAAIAI2AhwgACAHNwMAQQAhAyAAQQA2AhQgACAHIAggBhsiBzcDCCAAIAdCgIAIIAdCgIAIVBs+AhALIAMLWwEBf0G4fyEDIAIQFiICIAFNBH8gACACakF/ai0AACIAQQNxQQJ0QaAeaigCACACaiAAQQZ2IgFBAnRBsB5qKAIAaiAAQSBxIgBFaiABRSAAQQV2cWoFQbh/CwsdACAAKAKQ4gEQWiAAQQA2AqDiASAAQgA3A5DiAQu1AwEFfyMAQZACayIKJABBuH8hBgJAIAVFDQAgBCwAACIIQf8BcSEHAkAgCEF/TARAIAdBgn9qQQF2IgggBU8NAkFsIQYgB0GBf2oiBUGAAk8NAiAEQQFqIQdBACEGA0AgBiAFTwRAIAUhBiAIIQcMAwUgACAGaiAHIAZBAXZqIgQtAABBBHY6AAAgACAGQQFyaiAELQAAQQ9xOgAAIAZBAmohBgwBCwAACwALIAcgBU8NASAAIARBAWogByAKEFMiBhADDQELIAYhBEEAIQYgAUEAQTQQECEJQQAhBQNAIAQgBkcEQCAAIAZqIggtAAAiAUELSwRAQWwhBgwDBSAJIAFBAnRqIgEgASgCAEEBajYCACAGQQFqIQZBASAILQAAdEEBdSAFaiEFDAILAAsLQWwhBiAFRQ0AIAUQFEEBaiIBQQxLDQAgAyABNgIAQQFBASABdCAFayIDEBQiAXQgA0cNACAAIARqIAFBAWoiADoAACAJIABBAnRqIgAgACgCAEEBajYCACAJKAIEIgBBAkkgAEEBcXINACACIARBAWo2AgAgB0EBaiEGCyAKQZACaiQAIAYLxhEBDH8jAEHwAGsiBSQAQWwhCwJAIANBCkkNACACLwAAIQogAi8AAiEJIAIvAAQhByAFQQhqIAQQDgJAIAMgByAJIApqakEGaiIMSQ0AIAUtAAohCCAFQdgAaiACQQZqIgIgChAGIgsQAw0BIAVBQGsgAiAKaiICIAkQBiILEAMNASAFQShqIAIgCWoiAiAHEAYiCxADDQEgBUEQaiACIAdqIAMgDGsQBiILEAMNASAAIAFqIg9BfWohECAEQQRqIQZBASELIAAgAUEDakECdiIDaiIMIANqIgIgA2oiDiEDIAIhBCAMIQcDQCALIAMgEElxBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgCS0AAyELIAcgBiAFQUBrIAgQAkECdGoiCS8BADsAACAFQUBrIAktAAIQASAJLQADIQogBCAGIAVBKGogCBACQQJ0aiIJLwEAOwAAIAVBKGogCS0AAhABIAktAAMhCSADIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgDS0AAyENIAAgC2oiCyAGIAVB2ABqIAgQAkECdGoiAC8BADsAACAFQdgAaiAALQACEAEgAC0AAyEAIAcgCmoiCiAGIAVBQGsgCBACQQJ0aiIHLwEAOwAAIAVBQGsgBy0AAhABIActAAMhByAEIAlqIgkgBiAFQShqIAgQAkECdGoiBC8BADsAACAFQShqIAQtAAIQASAELQADIQQgAyANaiIDIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgACALaiEAIAcgCmohByAEIAlqIQQgAyANLQADaiEDIAVB2ABqEA0gBUFAaxANciAFQShqEA1yIAVBEGoQDXJFIQsMAQsLIAQgDksgByACS3INAEFsIQsgACAMSw0BIAxBfWohCQNAQQAgACAJSSAFQdgAahAEGwRAIAAgBiAFQdgAaiAIEAJBAnRqIgovAQA7AAAgBUHYAGogCi0AAhABIAAgCi0AA2oiACAGIAVB2ABqIAgQAkECdGoiCi8BADsAACAFQdgAaiAKLQACEAEgACAKLQADaiEADAEFIAxBfmohCgNAIAVB2ABqEAQgACAKS3JFBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgACAJLQADaiEADAELCwNAIAAgCk0EQCAAIAYgBUHYAGogCBACQQJ0aiIJLwEAOwAAIAVB2ABqIAktAAIQASAAIAktAANqIQAMAQsLAkAgACAMTw0AIAAgBiAFQdgAaiAIEAIiAEECdGoiDC0AADoAACAMLQADQQFGBEAgBUHYAGogDC0AAhABDAELIAUoAlxBH0sNACAFQdgAaiAGIABBAnRqLQACEAEgBSgCXEEhSQ0AIAVBIDYCXAsgAkF9aiEMA0BBACAHIAxJIAVBQGsQBBsEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiIAIAYgBUFAayAIEAJBAnRqIgcvAQA7AAAgBUFAayAHLQACEAEgACAHLQADaiEHDAEFIAJBfmohDANAIAVBQGsQBCAHIAxLckUEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwNAIAcgDE0EQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwJAIAcgAk8NACAHIAYgBUFAayAIEAIiAEECdGoiAi0AADoAACACLQADQQFGBEAgBUFAayACLQACEAEMAQsgBSgCREEfSw0AIAVBQGsgBiAAQQJ0ai0AAhABIAUoAkRBIUkNACAFQSA2AkQLIA5BfWohAgNAQQAgBCACSSAFQShqEAQbBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2oiACAGIAVBKGogCBACQQJ0aiIELwEAOwAAIAVBKGogBC0AAhABIAAgBC0AA2ohBAwBBSAOQX5qIQIDQCAFQShqEAQgBCACS3JFBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsDQCAEIAJNBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsCQCAEIA5PDQAgBCAGIAVBKGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBKGogAi0AAhABDAELIAUoAixBH0sNACAFQShqIAYgAEECdGotAAIQASAFKAIsQSFJDQAgBUEgNgIsCwNAQQAgAyAQSSAFQRBqEAQbBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2oiACAGIAVBEGogCBACQQJ0aiICLwEAOwAAIAVBEGogAi0AAhABIAAgAi0AA2ohAwwBBSAPQX5qIQIDQCAFQRBqEAQgAyACS3JFBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsDQCADIAJNBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsCQCADIA9PDQAgAyAGIAVBEGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBEGogAi0AAhABDAELIAUoAhRBH0sNACAFQRBqIAYgAEECdGotAAIQASAFKAIUQSFJDQAgBUEgNgIUCyABQWwgBUHYAGoQCiAFQUBrEApxIAVBKGoQCnEgBUEQahAKcRshCwwJCwAACwALAAALAAsAAAsACwAACwALQWwhCwsgBUHwAGokACALC7UEAQ5/IwBBEGsiBiQAIAZBBGogABAOQVQhBQJAIARB3AtJDQAgBi0ABCEHIANB8ARqQQBB7AAQECEIIAdBDEsNACADQdwJaiIJIAggBkEIaiAGQQxqIAEgAhAxIhAQA0UEQCAGKAIMIgQgB0sNASADQdwFaiEPIANBpAVqIREgAEEEaiESIANBqAVqIQEgBCEFA0AgBSICQX9qIQUgCCACQQJ0aigCAEUNAAsgAkEBaiEOQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgASALaiAKNgIAIAVBAWohBSAKIAxqIQoMAQsLIAEgCjYCAEEAIQUgBigCCCELA0AgBSALRkUEQCABIAUgCWotAAAiDEECdGoiDSANKAIAIg1BAWo2AgAgDyANQQF0aiINIAw6AAEgDSAFOgAAIAVBAWohBQwBCwtBACEBIANBADYCqAUgBEF/cyAHaiEJQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgAyALaiABNgIAIAwgBSAJanQgAWohASAFQQFqIQUMAQsLIAcgBEEBaiIBIAJrIgRrQQFqIQgDQEEBIQUgBCAIT0UEQANAIAUgDk9FBEAgBUECdCIJIAMgBEE0bGpqIAMgCWooAgAgBHY2AgAgBUEBaiEFDAELCyAEQQFqIQQMAQsLIBIgByAPIAogESADIAIgARBkIAZBAToABSAGIAc6AAYgACAGKAIENgIACyAQIQULIAZBEGokACAFC8ENAQt/IwBB8ABrIgUkAEFsIQkCQCADQQpJDQAgAi8AACEKIAIvAAIhDCACLwAEIQYgBUEIaiAEEA4CQCADIAYgCiAMampBBmoiDUkNACAFLQAKIQcgBUHYAGogAkEGaiICIAoQBiIJEAMNASAFQUBrIAIgCmoiAiAMEAYiCRADDQEgBUEoaiACIAxqIgIgBhAGIgkQAw0BIAVBEGogAiAGaiADIA1rEAYiCRADDQEgACABaiIOQX1qIQ8gBEEEaiEGQQEhCSAAIAFBA2pBAnYiAmoiCiACaiIMIAJqIg0hAyAMIQQgCiECA0AgCSADIA9JcQRAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAACAGIAVBQGsgBxACQQF0aiIILQAAIQsgBUFAayAILQABEAEgAiALOgAAIAYgBUEoaiAHEAJBAXRqIggtAAAhCyAFQShqIAgtAAEQASAEIAs6AAAgBiAFQRBqIAcQAkEBdGoiCC0AACELIAVBEGogCC0AARABIAMgCzoAACAGIAVB2ABqIAcQAkEBdGoiCC0AACELIAVB2ABqIAgtAAEQASAAIAs6AAEgBiAFQUBrIAcQAkEBdGoiCC0AACELIAVBQGsgCC0AARABIAIgCzoAASAGIAVBKGogBxACQQF0aiIILQAAIQsgBUEoaiAILQABEAEgBCALOgABIAYgBUEQaiAHEAJBAXRqIggtAAAhCyAFQRBqIAgtAAEQASADIAs6AAEgA0ECaiEDIARBAmohBCACQQJqIQIgAEECaiEAIAkgBUHYAGoQDUVxIAVBQGsQDUVxIAVBKGoQDUVxIAVBEGoQDUVxIQkMAQsLIAQgDUsgAiAMS3INAEFsIQkgACAKSw0BIApBfWohCQNAIAVB2ABqEAQgACAJT3JFBEAgBiAFQdgAaiAHEAJBAXRqIggtAAAhCyAFQdgAaiAILQABEAEgACALOgAAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAASAAQQJqIQAMAQsLA0AgBUHYAGoQBCAAIApPckUEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCwNAIAAgCkkEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCyAMQX1qIQADQCAFQUBrEAQgAiAAT3JFBEAgBiAFQUBrIAcQAkEBdGoiCi0AACEJIAVBQGsgCi0AARABIAIgCToAACAGIAVBQGsgBxACQQF0aiIKLQAAIQkgBUFAayAKLQABEAEgAiAJOgABIAJBAmohAgwBCwsDQCAFQUBrEAQgAiAMT3JFBEAgBiAFQUBrIAcQAkEBdGoiAC0AACEKIAVBQGsgAC0AARABIAIgCjoAACACQQFqIQIMAQsLA0AgAiAMSQRAIAYgBUFAayAHEAJBAXRqIgAtAAAhCiAFQUBrIAAtAAEQASACIAo6AAAgAkEBaiECDAELCyANQX1qIQADQCAFQShqEAQgBCAAT3JFBEAgBiAFQShqIAcQAkEBdGoiAi0AACEKIAVBKGogAi0AARABIAQgCjoAACAGIAVBKGogBxACQQF0aiICLQAAIQogBUEoaiACLQABEAEgBCAKOgABIARBAmohBAwBCwsDQCAFQShqEAQgBCANT3JFBEAgBiAFQShqIAcQAkEBdGoiAC0AACECIAVBKGogAC0AARABIAQgAjoAACAEQQFqIQQMAQsLA0AgBCANSQRAIAYgBUEoaiAHEAJBAXRqIgAtAAAhAiAFQShqIAAtAAEQASAEIAI6AAAgBEEBaiEEDAELCwNAIAVBEGoQBCADIA9PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIAYgBUEQaiAHEAJBAXRqIgAtAAAhAiAFQRBqIAAtAAEQASADIAI6AAEgA0ECaiEDDAELCwNAIAVBEGoQBCADIA5PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIANBAWohAwwBCwsDQCADIA5JBEAgBiAFQRBqIAcQAkEBdGoiAC0AACECIAVBEGogAC0AARABIAMgAjoAACADQQFqIQMMAQsLIAFBbCAFQdgAahAKIAVBQGsQCnEgBUEoahAKcSAFQRBqEApxGyEJDAELQWwhCQsgBUHwAGokACAJC8oCAQR/IwBBIGsiBSQAIAUgBBAOIAUtAAIhByAFQQhqIAIgAxAGIgIQA0UEQCAEQQRqIQIgACABaiIDQX1qIQQDQCAFQQhqEAQgACAET3JFBEAgAiAFQQhqIAcQAkEBdGoiBi0AACEIIAVBCGogBi0AARABIAAgCDoAACACIAVBCGogBxACQQF0aiIGLQAAIQggBUEIaiAGLQABEAEgACAIOgABIABBAmohAAwBCwsDQCAFQQhqEAQgACADT3JFBEAgAiAFQQhqIAcQAkEBdGoiBC0AACEGIAVBCGogBC0AARABIAAgBjoAACAAQQFqIQAMAQsLA0AgACADT0UEQCACIAVBCGogBxACQQF0aiIELQAAIQYgBUEIaiAELQABEAEgACAGOgAAIABBAWohAAwBCwsgAUFsIAVBCGoQChshAgsgBUEgaiQAIAILtgMBCX8jAEEQayIGJAAgBkEANgIMIAZBADYCCEFUIQQCQAJAIANBQGsiDCADIAZBCGogBkEMaiABIAIQMSICEAMNACAGQQRqIAAQDiAGKAIMIgcgBi0ABEEBaksNASAAQQRqIQogBkEAOgAFIAYgBzoABiAAIAYoAgQ2AgAgB0EBaiEJQQEhBANAIAQgCUkEQCADIARBAnRqIgEoAgAhACABIAU2AgAgACAEQX9qdCAFaiEFIARBAWohBAwBCwsgB0EBaiEHQQAhBSAGKAIIIQkDQCAFIAlGDQEgAyAFIAxqLQAAIgRBAnRqIgBBASAEdEEBdSILIAAoAgAiAWoiADYCACAHIARrIQhBACEEAkAgC0EDTQRAA0AgBCALRg0CIAogASAEakEBdGoiACAIOgABIAAgBToAACAEQQFqIQQMAAALAAsDQCABIABPDQEgCiABQQF0aiIEIAg6AAEgBCAFOgAAIAQgCDoAAyAEIAU6AAIgBCAIOgAFIAQgBToABCAEIAg6AAcgBCAFOgAGIAFBBGohAQwAAAsACyAFQQFqIQUMAAALAAsgAiEECyAGQRBqJAAgBAutAQECfwJAQYQgKAIAIABHIAAoAgBBAXYiAyABa0F4aiICQXhxQQhHcgR/IAIFIAMQJ0UNASACQQhqC0EQSQ0AIAAgACgCACICQQFxIAAgAWpBD2pBeHEiASAAa0EBdHI2AgAgASAANgIEIAEgASgCAEEBcSAAIAJBAXZqIAFrIgJBAXRyNgIAQYQgIAEgAkH/////B3FqQQRqQYQgKAIAIABGGyABNgIAIAEQJQsLygIBBX8CQAJAAkAgAEEIIABBCEsbZ0EfcyAAaUEBR2oiAUEESSAAIAF2cg0AIAFBAnRB/B5qKAIAIgJFDQADQCACQXhqIgMoAgBBAXZBeGoiBSAATwRAIAIgBUEIIAVBCEsbZ0Efc0ECdEGAH2oiASgCAEYEQCABIAIoAgQ2AgALDAMLIARBHksNASAEQQFqIQQgAigCBCICDQALC0EAIQMgAUEgTw0BA0AgAUECdEGAH2ooAgAiAkUEQCABQR5LIQIgAUEBaiEBIAJFDQEMAwsLIAIgAkF4aiIDKAIAQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgBGBEAgASACKAIENgIACwsgAigCACIBBEAgASACKAIENgIECyACKAIEIgEEQCABIAIoAgA2AgALIAMgAygCAEEBcjYCACADIAAQNwsgAwvhCwINfwV+IwBB8ABrIgckACAHIAAoAvDhASIINgJcIAEgAmohDSAIIAAoAoDiAWohDwJAAkAgBUUEQCABIQQMAQsgACgCxOABIRAgACgCwOABIREgACgCvOABIQ4gAEEBNgKM4QFBACEIA0AgCEEDRwRAIAcgCEECdCICaiAAIAJqQazQAWooAgA2AkQgCEEBaiEIDAELC0FsIQwgB0EYaiADIAQQBhADDQEgB0EsaiAHQRhqIAAoAgAQEyAHQTRqIAdBGGogACgCCBATIAdBPGogB0EYaiAAKAIEEBMgDUFgaiESIAEhBEEAIQwDQCAHKAIwIAcoAixBA3RqKQIAIhRCEIinQf8BcSEIIAcoAkAgBygCPEEDdGopAgAiFUIQiKdB/wFxIQsgBygCOCAHKAI0QQN0aikCACIWQiCIpyEJIBVCIIghFyAUQiCIpyECAkAgFkIQiKdB/wFxIgNBAk8EQAJAIAZFIANBGUlyRQRAIAkgB0EYaiADQSAgBygCHGsiCiAKIANLGyIKEAUgAyAKayIDdGohCSAHQRhqEAQaIANFDQEgB0EYaiADEAUgCWohCQwBCyAHQRhqIAMQBSAJaiEJIAdBGGoQBBoLIAcpAkQhGCAHIAk2AkQgByAYNwNIDAELAkAgA0UEQCACBEAgBygCRCEJDAMLIAcoAkghCQwBCwJAAkAgB0EYakEBEAUgCSACRWpqIgNBA0YEQCAHKAJEQX9qIgMgA0VqIQkMAQsgA0ECdCAHaigCRCIJIAlFaiEJIANBAUYNAQsgByAHKAJINgJMCwsgByAHKAJENgJIIAcgCTYCRAsgF6chAyALBEAgB0EYaiALEAUgA2ohAwsgCCALakEUTwRAIAdBGGoQBBoLIAgEQCAHQRhqIAgQBSACaiECCyAHQRhqEAQaIAcgB0EYaiAUQhiIp0H/AXEQCCAUp0H//wNxajYCLCAHIAdBGGogFUIYiKdB/wFxEAggFadB//8DcWo2AjwgB0EYahAEGiAHIAdBGGogFkIYiKdB/wFxEAggFqdB//8DcWo2AjQgByACNgJgIAcoAlwhCiAHIAk2AmggByADNgJkAkACQAJAIAQgAiADaiILaiASSw0AIAIgCmoiEyAPSw0AIA0gBGsgC0Egak8NAQsgByAHKQNoNwMQIAcgBykDYDcDCCAEIA0gB0EIaiAHQdwAaiAPIA4gESAQEB4hCwwBCyACIARqIQggBCAKEAcgAkERTwRAIARBEGohAgNAIAIgCkEQaiIKEAcgAkEQaiICIAhJDQALCyAIIAlrIQIgByATNgJcIAkgCCAOa0sEQCAJIAggEWtLBEBBbCELDAILIBAgAiAOayICaiIKIANqIBBNBEAgCCAKIAMQDxoMAgsgCCAKQQAgAmsQDyEIIAcgAiADaiIDNgJkIAggAmshCCAOIQILIAlBEE8EQCADIAhqIQMDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALDAELAkAgCUEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgCUECdCIDQcAeaigCAGoiAhAXIAIgA0HgHmooAgBrIQIgBygCZCEDDAELIAggAhAMCyADQQlJDQAgAyAIaiEDIAhBCGoiCCACQQhqIgJrQQ9MBEADQCAIIAIQDCACQQhqIQIgCEEIaiIIIANJDQAMAgALAAsDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALCyAHQRhqEAQaIAsgDCALEAMiAhshDCAEIAQgC2ogAhshBCAFQX9qIgUNAAsgDBADDQFBbCEMIAdBGGoQBEECSQ0BQQAhCANAIAhBA0cEQCAAIAhBAnQiAmpBrNABaiACIAdqKAJENgIAIAhBAWohCAwBCwsgBygCXCEIC0G6fyEMIA8gCGsiACANIARrSw0AIAQEfyAEIAggABALIABqBUEACyABayEMCyAHQfAAaiQAIAwLkRcCFn8FfiMAQdABayIHJAAgByAAKALw4QEiCDYCvAEgASACaiESIAggACgCgOIBaiETAkACQCAFRQRAIAEhAwwBCyAAKALE4AEhESAAKALA4AEhFSAAKAK84AEhDyAAQQE2AozhAUEAIQgDQCAIQQNHBEAgByAIQQJ0IgJqIAAgAmpBrNABaigCADYCVCAIQQFqIQgMAQsLIAcgETYCZCAHIA82AmAgByABIA9rNgJoQWwhECAHQShqIAMgBBAGEAMNASAFQQQgBUEESBshFyAHQTxqIAdBKGogACgCABATIAdBxABqIAdBKGogACgCCBATIAdBzABqIAdBKGogACgCBBATQQAhBCAHQeAAaiEMIAdB5ABqIQoDQCAHQShqEARBAksgBCAXTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEJIAcoAkggBygCREEDdGopAgAiH0IgiKchCCAeQiCIISAgHUIgiKchAgJAIB9CEIinQf8BcSIDQQJPBEACQCAGRSADQRlJckUEQCAIIAdBKGogA0EgIAcoAixrIg0gDSADSxsiDRAFIAMgDWsiA3RqIQggB0EoahAEGiADRQ0BIAdBKGogAxAFIAhqIQgMAQsgB0EoaiADEAUgCGohCCAHQShqEAQaCyAHKQJUISEgByAINgJUIAcgITcDWAwBCwJAIANFBEAgAgRAIAcoAlQhCAwDCyAHKAJYIQgMAQsCQAJAIAdBKGpBARAFIAggAkVqaiIDQQNGBEAgBygCVEF/aiIDIANFaiEIDAELIANBAnQgB2ooAlQiCCAIRWohCCADQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAg2AlQLICCnIQMgCQRAIAdBKGogCRAFIANqIQMLIAkgC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgAmohAgsgB0EoahAEGiAHIAcoAmggAmoiCSADajYCaCAKIAwgCCAJSxsoAgAhDSAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogB0EoaiAfQhiIp0H/AXEQCCEOIAdB8ABqIARBBHRqIgsgCSANaiAIazYCDCALIAg2AgggCyADNgIEIAsgAjYCACAHIA4gH6dB//8DcWo2AkQgBEEBaiEEDAELCyAEIBdIDQEgEkFgaiEYIAdB4ABqIRogB0HkAGohGyABIQMDQCAHQShqEARBAksgBCAFTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEIIAcoAkggBygCREEDdGopAgAiH0IgiKchCSAeQiCIISAgHUIgiKchDAJAIB9CEIinQf8BcSICQQJPBEACQCAGRSACQRlJckUEQCAJIAdBKGogAkEgIAcoAixrIgogCiACSxsiChAFIAIgCmsiAnRqIQkgB0EoahAEGiACRQ0BIAdBKGogAhAFIAlqIQkMAQsgB0EoaiACEAUgCWohCSAHQShqEAQaCyAHKQJUISEgByAJNgJUIAcgITcDWAwBCwJAIAJFBEAgDARAIAcoAlQhCQwDCyAHKAJYIQkMAQsCQAJAIAdBKGpBARAFIAkgDEVqaiICQQNGBEAgBygCVEF/aiICIAJFaiEJDAELIAJBAnQgB2ooAlQiCSAJRWohCSACQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAk2AlQLICCnIRQgCARAIAdBKGogCBAFIBRqIRQLIAggC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgDGohDAsgB0EoahAEGiAHIAcoAmggDGoiGSAUajYCaCAbIBogCSAZSxsoAgAhHCAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogByAHQShqIB9CGIinQf8BcRAIIB+nQf//A3FqNgJEIAcgB0HwAGogBEEDcUEEdGoiDSkDCCIdNwPIASAHIA0pAwAiHjcDwAECQAJAAkAgBygCvAEiDiAepyICaiIWIBNLDQAgAyAHKALEASIKIAJqIgtqIBhLDQAgEiADayALQSBqTw0BCyAHIAcpA8gBNwMQIAcgBykDwAE3AwggAyASIAdBCGogB0G8AWogEyAPIBUgERAeIQsMAQsgAiADaiEIIAMgDhAHIAJBEU8EQCADQRBqIQIDQCACIA5BEGoiDhAHIAJBEGoiAiAISQ0ACwsgCCAdpyIOayECIAcgFjYCvAEgDiAIIA9rSwRAIA4gCCAVa0sEQEFsIQsMAgsgESACIA9rIgJqIhYgCmogEU0EQCAIIBYgChAPGgwCCyAIIBZBACACaxAPIQggByACIApqIgo2AsQBIAggAmshCCAPIQILIA5BEE8EQCAIIApqIQoDQCAIIAIQByACQRBqIQIgCEEQaiIIIApJDQALDAELAkAgDkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgDkECdCIKQcAeaigCAGoiAhAXIAIgCkHgHmooAgBrIQIgBygCxAEhCgwBCyAIIAIQDAsgCkEJSQ0AIAggCmohCiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAKSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAKSQ0ACwsgCxADBEAgCyEQDAQFIA0gDDYCACANIBkgHGogCWs2AgwgDSAJNgIIIA0gFDYCBCAEQQFqIQQgAyALaiEDDAILAAsLIAQgBUgNASAEIBdrIQtBACEEA0AgCyAFSARAIAcgB0HwAGogC0EDcUEEdGoiAikDCCIdNwPIASAHIAIpAwAiHjcDwAECQAJAAkAgBygCvAEiDCAepyICaiIKIBNLDQAgAyAHKALEASIJIAJqIhBqIBhLDQAgEiADayAQQSBqTw0BCyAHIAcpA8gBNwMgIAcgBykDwAE3AxggAyASIAdBGGogB0G8AWogEyAPIBUgERAeIRAMAQsgAiADaiEIIAMgDBAHIAJBEU8EQCADQRBqIQIDQCACIAxBEGoiDBAHIAJBEGoiAiAISQ0ACwsgCCAdpyIGayECIAcgCjYCvAEgBiAIIA9rSwRAIAYgCCAVa0sEQEFsIRAMAgsgESACIA9rIgJqIgwgCWogEU0EQCAIIAwgCRAPGgwCCyAIIAxBACACaxAPIQggByACIAlqIgk2AsQBIAggAmshCCAPIQILIAZBEE8EQCAIIAlqIQYDQCAIIAIQByACQRBqIQIgCEEQaiIIIAZJDQALDAELAkAgBkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgBkECdCIGQcAeaigCAGoiAhAXIAIgBkHgHmooAgBrIQIgBygCxAEhCQwBCyAIIAIQDAsgCUEJSQ0AIAggCWohBiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAGSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAGSQ0ACwsgEBADDQMgC0EBaiELIAMgEGohAwwBCwsDQCAEQQNHBEAgACAEQQJ0IgJqQazQAWogAiAHaigCVDYCACAEQQFqIQQMAQsLIAcoArwBIQgLQbp/IRAgEyAIayIAIBIgA2tLDQAgAwR/IAMgCCAAEAsgAGoFQQALIAFrIRALIAdB0AFqJAAgEAslACAAQgA3AgAgAEEAOwEIIABBADoACyAAIAE2AgwgACACOgAKC7QFAQN/IwBBMGsiBCQAIABB/wFqIgVBfWohBgJAIAMvAQIEQCAEQRhqIAEgAhAGIgIQAw0BIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahASOgAAIAMgBEEIaiAEQRhqEBI6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0FIAEgBEEQaiAEQRhqEBI6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBSABIARBCGogBEEYahASOgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEjoAACABIAJqIABrIQIMAwsgAyAEQRBqIARBGGoQEjoAAiADIARBCGogBEEYahASOgADIANBBGohAwwAAAsACyAEQRhqIAEgAhAGIgIQAw0AIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahAROgAAIAMgBEEIaiAEQRhqEBE6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0EIAEgBEEQaiAEQRhqEBE6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBCABIARBCGogBEEYahAROgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEToAACABIAJqIABrIQIMAgsgAyAEQRBqIARBGGoQEToAAiADIARBCGogBEEYahAROgADIANBBGohAwwAAAsACyAEQTBqJAAgAgtpAQF/An8CQAJAIAJBB00NACABKAAAQbfIwuF+Rw0AIAAgASgABDYCmOIBQWIgAEEQaiABIAIQPiIDEAMNAhogAEKBgICAEDcDiOEBIAAgASADaiACIANrECoMAQsgACABIAIQKgtBAAsLrQMBBn8jAEGAAWsiAyQAQWIhCAJAIAJBCUkNACAAQZjQAGogAUEIaiIEIAJBeGogAEGY0AAQMyIFEAMiBg0AIANBHzYCfCADIANB/ABqIANB+ABqIAQgBCAFaiAGGyIEIAEgAmoiAiAEaxAVIgUQAw0AIAMoAnwiBkEfSw0AIAMoAngiB0EJTw0AIABBiCBqIAMgBkGAC0GADCAHEBggA0E0NgJ8IAMgA0H8AGogA0H4AGogBCAFaiIEIAIgBGsQFSIFEAMNACADKAJ8IgZBNEsNACADKAJ4IgdBCk8NACAAQZAwaiADIAZBgA1B4A4gBxAYIANBIzYCfCADIANB/ABqIANB+ABqIAQgBWoiBCACIARrEBUiBRADDQAgAygCfCIGQSNLDQAgAygCeCIHQQpPDQAgACADIAZBwBBB0BEgBxAYIAQgBWoiBEEMaiIFIAJLDQAgAiAFayEFQQAhAgNAIAJBA0cEQCAEKAAAIgZBf2ogBU8NAiAAIAJBAnRqQZzQAWogBjYCACACQQFqIQIgBEEEaiEEDAELCyAEIAFrIQgLIANBgAFqJAAgCAtGAQN/IABBCGohAyAAKAIEIQJBACEAA0AgACACdkUEQCABIAMgAEEDdGotAAJBFktqIQEgAEEBaiEADAELCyABQQggAmt0C4YDAQV/Qbh/IQcCQCADRQ0AIAItAAAiBEUEQCABQQA2AgBBAUG4fyADQQFGGw8LAn8gAkEBaiIFIARBGHRBGHUiBkF/Sg0AGiAGQX9GBEAgA0EDSA0CIAUvAABBgP4BaiEEIAJBA2oMAQsgA0ECSA0BIAItAAEgBEEIdHJBgIB+aiEEIAJBAmoLIQUgASAENgIAIAVBAWoiASACIANqIgNLDQBBbCEHIABBEGogACAFLQAAIgVBBnZBI0EJIAEgAyABa0HAEEHQEUHwEiAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBmCBqIABBCGogBUEEdkEDcUEfQQggASABIAZqIAgbIgEgAyABa0GAC0GADEGAFyAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBoDBqIABBBGogBUECdkEDcUE0QQkgASABIAZqIAgbIgEgAyABa0GADUHgDkGQGSAAKAKM4QEgACgCnOIBIAQQHyIAEAMNACAAIAFqIAJrIQcLIAcLrQMBCn8jAEGABGsiCCQAAn9BUiACQf8BSw0AGkFUIANBDEsNABogAkEBaiELIABBBGohCUGAgAQgA0F/anRBEHUhCkEAIQJBASEEQQEgA3QiB0F/aiIMIQUDQCACIAtGRQRAAkAgASACQQF0Ig1qLwEAIgZB//8DRgRAIAkgBUECdGogAjoAAiAFQX9qIQVBASEGDAELIARBACAKIAZBEHRBEHVKGyEECyAIIA1qIAY7AQAgAkEBaiECDAELCyAAIAQ7AQIgACADOwEAIAdBA3YgB0EBdmpBA2ohBkEAIQRBACECA0AgBCALRkUEQCABIARBAXRqLgEAIQpBACEAA0AgACAKTkUEQCAJIAJBAnRqIAQ6AAIDQCACIAZqIAxxIgIgBUsNAAsgAEEBaiEADAELCyAEQQFqIQQMAQsLQX8gAg0AGkEAIQIDfyACIAdGBH9BAAUgCCAJIAJBAnRqIgAtAAJBAXRqIgEgAS8BACIBQQFqOwEAIAAgAyABEBRrIgU6AAMgACABIAVB/wFxdCAHazsBACACQQFqIQIMAQsLCyEFIAhBgARqJAAgBQvjBgEIf0FsIQcCQCACQQNJDQACQAJAAkACQCABLQAAIgNBA3EiCUEBaw4DAwEAAgsgACgCiOEBDQBBYg8LIAJBBUkNAkEDIQYgASgAACEFAn8CQAJAIANBAnZBA3EiCEF+aiIEQQFNBEAgBEEBaw0BDAILIAVBDnZB/wdxIQQgBUEEdkH/B3EhAyAIRQwCCyAFQRJ2IQRBBCEGIAVBBHZB//8AcSEDQQAMAQsgBUEEdkH//w9xIgNBgIAISw0DIAEtAARBCnQgBUEWdnIhBEEFIQZBAAshBSAEIAZqIgogAksNAgJAIANBgQZJDQAgACgCnOIBRQ0AQQAhAgNAIAJBg4ABSw0BIAJBQGshAgwAAAsACwJ/IAlBA0YEQCABIAZqIQEgAEHw4gFqIQIgACgCDCEGIAUEQCACIAMgASAEIAYQXwwCCyACIAMgASAEIAYQXQwBCyAAQbjQAWohAiABIAZqIQEgAEHw4gFqIQYgAEGo0ABqIQggBQRAIAggBiADIAEgBCACEF4MAQsgCCAGIAMgASAEIAIQXAsQAw0CIAAgAzYCgOIBIABBATYCiOEBIAAgAEHw4gFqNgLw4QEgCUECRgRAIAAgAEGo0ABqNgIMCyAAIANqIgBBiOMBakIANwAAIABBgOMBakIANwAAIABB+OIBakIANwAAIABB8OIBakIANwAAIAoPCwJ/AkACQAJAIANBAnZBA3FBf2oiBEECSw0AIARBAWsOAgACAQtBASEEIANBA3YMAgtBAiEEIAEvAABBBHYMAQtBAyEEIAEQIUEEdgsiAyAEaiIFQSBqIAJLBEAgBSACSw0CIABB8OIBaiABIARqIAMQCyEBIAAgAzYCgOIBIAAgATYC8OEBIAEgA2oiAEIANwAYIABCADcAECAAQgA3AAggAEIANwAAIAUPCyAAIAM2AoDiASAAIAEgBGo2AvDhASAFDwsCfwJAAkACQCADQQJ2QQNxQX9qIgRBAksNACAEQQFrDgIAAgELQQEhByADQQN2DAILQQIhByABLwAAQQR2DAELIAJBBEkgARAhIgJBj4CAAUtyDQFBAyEHIAJBBHYLIQIgAEHw4gFqIAEgB2otAAAgAkEgahAQIQEgACACNgKA4gEgACABNgLw4QEgB0EBaiEHCyAHC0sAIABC+erQ0OfJoeThADcDICAAQgA3AxggAELP1tO+0ser2UI3AxAgAELW64Lu6v2J9eAANwMIIABCADcDACAAQShqQQBBKBAQGgviAgICfwV+IABBKGoiASAAKAJIaiECAn4gACkDACIDQiBaBEAgACkDECIEQgeJIAApAwgiBUIBiXwgACkDGCIGQgyJfCAAKQMgIgdCEol8IAUQGSAEEBkgBhAZIAcQGQwBCyAAKQMYQsXP2bLx5brqJ3wLIAN8IQMDQCABQQhqIgAgAk0EQEIAIAEpAAAQCSADhUIbiUKHla+vmLbem55/fkLj3MqV/M7y9YV/fCEDIAAhAQwBCwsCQCABQQRqIgAgAksEQCABIQAMAQsgASgAAK1Ch5Wvr5i23puef34gA4VCF4lCz9bTvtLHq9lCfkL5893xmfaZqxZ8IQMLA0AgACACSQRAIAAxAABCxc/ZsvHluuonfiADhUILiUKHla+vmLbem55/fiEDIABBAWohAAwBCwsgA0IhiCADhULP1tO+0ser2UJ+IgNCHYggA4VC+fPd8Zn2masWfiIDQiCIIAOFC+8CAgJ/BH4gACAAKQMAIAKtfDcDAAJAAkAgACgCSCIDIAJqIgRBH00EQCABRQ0BIAAgA2pBKGogASACECAgACgCSCACaiEEDAELIAEgAmohAgJ/IAMEQCAAQShqIgQgA2ogAUEgIANrECAgACAAKQMIIAQpAAAQCTcDCCAAIAApAxAgACkAMBAJNwMQIAAgACkDGCAAKQA4EAk3AxggACAAKQMgIABBQGspAAAQCTcDICAAKAJIIQMgAEEANgJIIAEgA2tBIGohAQsgAUEgaiACTQsEQCACQWBqIQMgACkDICEFIAApAxghBiAAKQMQIQcgACkDCCEIA0AgCCABKQAAEAkhCCAHIAEpAAgQCSEHIAYgASkAEBAJIQYgBSABKQAYEAkhBSABQSBqIgEgA00NAAsgACAFNwMgIAAgBjcDGCAAIAc3AxAgACAINwMICyABIAJPDQEgAEEoaiABIAIgAWsiBBAgCyAAIAQ2AkgLCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQEBogAwVBun8LCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQCxogAwVBun8LC6gCAQZ/IwBBEGsiByQAIABB2OABaikDAEKAgIAQViEIQbh/IQUCQCAEQf//B0sNACAAIAMgBBBCIgUQAyIGDQAgACgCnOIBIQkgACAHQQxqIAMgAyAFaiAGGyIKIARBACAFIAYbayIGEEAiAxADBEAgAyEFDAELIAcoAgwhBCABRQRAQbp/IQUgBEEASg0BCyAGIANrIQUgAyAKaiEDAkAgCQRAIABBADYCnOIBDAELAkACQAJAIARBBUgNACAAQdjgAWopAwBCgICACFgNAAwBCyAAQQA2ApziAQwBCyAAKAIIED8hBiAAQQA2ApziASAGQRRPDQELIAAgASACIAMgBSAEIAgQOSEFDAELIAAgASACIAMgBSAEIAgQOiEFCyAHQRBqJAAgBQtnACAAQdDgAWogASACIAAoAuzhARAuIgEQAwRAIAEPC0G4fyECAkAgAQ0AIABB7OABaigCACIBBEBBYCECIAAoApjiASABRw0BC0EAIQIgAEHw4AFqKAIARQ0AIABBkOEBahBDCyACCycBAX8QVyIERQRAQUAPCyAEIAAgASACIAMgBBBLEE8hACAEEFYgAAs/AQF/AkACQAJAIAAoAqDiAUEBaiIBQQJLDQAgAUEBaw4CAAECCyAAEDBBAA8LIABBADYCoOIBCyAAKAKU4gELvAMCB38BfiMAQRBrIgkkAEG4fyEGAkAgBCgCACIIQQVBCSAAKALs4QEiBRtJDQAgAygCACIHQQFBBSAFGyAFEC8iBRADBEAgBSEGDAELIAggBUEDakkNACAAIAcgBRBJIgYQAw0AIAEgAmohCiAAQZDhAWohCyAIIAVrIQIgBSAHaiEHIAEhBQNAIAcgAiAJECwiBhADDQEgAkF9aiICIAZJBEBBuH8hBgwCCyAJKAIAIghBAksEQEFsIQYMAgsgB0EDaiEHAn8CQAJAAkAgCEEBaw4CAgABCyAAIAUgCiAFayAHIAYQSAwCCyAFIAogBWsgByAGEEcMAQsgBSAKIAVrIActAAAgCSgCCBBGCyIIEAMEQCAIIQYMAgsgACgC8OABBEAgCyAFIAgQRQsgAiAGayECIAYgB2ohByAFIAhqIQUgCSgCBEUNAAsgACkD0OABIgxCf1IEQEFsIQYgDCAFIAFrrFINAQsgACgC8OABBEBBaiEGIAJBBEkNASALEEQhDCAHKAAAIAynRw0BIAdBBGohByACQXxqIQILIAMgBzYCACAEIAI2AgAgBSABayEGCyAJQRBqJAAgBgsuACAAECsCf0EAQQAQAw0AGiABRSACRXJFBEBBYiAAIAEgAhA9EAMNARoLQQALCzcAIAEEQCAAIAAoAsTgASABKAIEIAEoAghqRzYCnOIBCyAAECtBABADIAFFckUEQCAAIAEQWwsL0QIBB38jAEEQayIGJAAgBiAENgIIIAYgAzYCDCAFBEAgBSgCBCEKIAUoAgghCQsgASEIAkACQANAIAAoAuzhARAWIQsCQANAIAQgC0kNASADKAAAQXBxQdDUtMIBRgRAIAMgBBAiIgcQAw0EIAQgB2shBCADIAdqIQMMAQsLIAYgAzYCDCAGIAQ2AggCQCAFBEAgACAFEE5BACEHQQAQA0UNAQwFCyAAIAogCRBNIgcQAw0ECyAAIAgQUCAMQQFHQQAgACAIIAIgBkEMaiAGQQhqEEwiByIDa0EAIAMQAxtBCkdyRQRAQbh/IQcMBAsgBxADDQMgAiAHayECIAcgCGohCEEBIQwgBigCDCEDIAYoAgghBAwBCwsgBiADNgIMIAYgBDYCCEG4fyEHIAQNASAIIAFrIQcMAQsgBiADNgIMIAYgBDYCCAsgBkEQaiQAIAcLRgECfyABIAAoArjgASICRwRAIAAgAjYCxOABIAAgATYCuOABIAAoArzgASEDIAAgATYCvOABIAAgASADIAJrajYCwOABCwutAgIEfwF+IwBBQGoiBCQAAkACQCACQQhJDQAgASgAAEFwcUHQ1LTCAUcNACABIAIQIiEBIABCADcDCCAAQQA2AgQgACABNgIADAELIARBGGogASACEC0iAxADBEAgACADEBoMAQsgAwRAIABBuH8QGgwBCyACIAQoAjAiA2shAiABIANqIQMDQAJAIAAgAyACIARBCGoQLCIFEAMEfyAFBSACIAVBA2oiBU8NAUG4fwsQGgwCCyAGQQFqIQYgAiAFayECIAMgBWohAyAEKAIMRQ0ACyAEKAI4BEAgAkEDTQRAIABBuH8QGgwCCyADQQRqIQMLIAQoAighAiAEKQMYIQcgAEEANgIEIAAgAyABazYCACAAIAIgBmytIAcgB0J/URs3AwgLIARBQGskAAslAQF/IwBBEGsiAiQAIAIgACABEFEgAigCACEAIAJBEGokACAAC30BBH8jAEGQBGsiBCQAIARB/wE2AggCQCAEQRBqIARBCGogBEEMaiABIAIQFSIGEAMEQCAGIQUMAQtBVCEFIAQoAgwiB0EGSw0AIAMgBEEQaiAEKAIIIAcQQSIFEAMNACAAIAEgBmogAiAGayADEDwhBQsgBEGQBGokACAFC4cBAgJ/An5BABAWIQMCQANAIAEgA08EQAJAIAAoAABBcHFB0NS0wgFGBEAgACABECIiAhADRQ0BQn4PCyAAIAEQVSIEQn1WDQMgBCAFfCIFIARUIQJCfiEEIAINAyAAIAEQUiICEAMNAwsgASACayEBIAAgAmohAAwBCwtCfiAFIAEbIQQLIAQLPwIBfwF+IwBBMGsiAiQAAn5CfiACQQhqIAAgARAtDQAaQgAgAigCHEEBRg0AGiACKQMICyEDIAJBMGokACADC40BAQJ/IwBBMGsiASQAAkAgAEUNACAAKAKI4gENACABIABB/OEBaigCADYCKCABIAApAvThATcDICAAEDAgACgCqOIBIQIgASABKAIoNgIYIAEgASkDIDcDECACIAFBEGoQGyAAQQA2AqjiASABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALKgECfyMAQRBrIgAkACAAQQA2AgggAEIANwMAIAAQWCEBIABBEGokACABC4cBAQN/IwBBEGsiAiQAAkAgACgCAEUgACgCBEVzDQAgAiAAKAIINgIIIAIgACkCADcDAAJ/IAIoAgAiAQRAIAIoAghBqOMJIAERBQAMAQtBqOMJECgLIgFFDQAgASAAKQIANwL04QEgAUH84QFqIAAoAgg2AgAgARBZIAEhAwsgAkEQaiQAIAMLywEBAn8jAEEgayIBJAAgAEGBgIDAADYCtOIBIABBADYCiOIBIABBADYC7OEBIABCADcDkOIBIABBADYCpOMJIABBADYC3OIBIABCADcCzOIBIABBADYCvOIBIABBADYCxOABIABCADcCnOIBIABBpOIBakIANwIAIABBrOIBakEANgIAIAFCADcCECABQgA3AhggASABKQMYNwMIIAEgASkDEDcDACABKAIIQQh2QQFxIQIgAEEANgLg4gEgACACNgKM4gEgAUEgaiQAC3YBA38jAEEwayIBJAAgAARAIAEgAEHE0AFqIgIoAgA2AiggASAAKQK80AE3AyAgACgCACEDIAEgAigCADYCGCABIAApArzQATcDECADIAFBEGoQGyABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALzAEBAX8gACABKAK00AE2ApjiASAAIAEoAgQiAjYCwOABIAAgAjYCvOABIAAgAiABKAIIaiICNgK44AEgACACNgLE4AEgASgCuNABBEAgAEKBgICAEDcDiOEBIAAgAUGk0ABqNgIMIAAgAUGUIGo2AgggACABQZwwajYCBCAAIAFBDGo2AgAgAEGs0AFqIAFBqNABaigCADYCACAAQbDQAWogAUGs0AFqKAIANgIAIABBtNABaiABQbDQAWooAgA2AgAPCyAAQgA3A4jhAQs7ACACRQRAQbp/DwsgBEUEQEFsDwsgAiAEEGAEQCAAIAEgAiADIAQgBRBhDwsgACABIAIgAyAEIAUQZQtGAQF/IwBBEGsiBSQAIAVBCGogBBAOAn8gBS0ACQRAIAAgASACIAMgBBAyDAELIAAgASACIAMgBBA0CyEAIAVBEGokACAACzQAIAAgAyAEIAUQNiIFEAMEQCAFDwsgBSAESQR/IAEgAiADIAVqIAQgBWsgABA1BUG4fwsLRgEBfyMAQRBrIgUkACAFQQhqIAQQDgJ/IAUtAAkEQCAAIAEgAiADIAQQYgwBCyAAIAEgAiADIAQQNQshACAFQRBqJAAgAAtZAQF/QQ8hAiABIABJBEAgAUEEdCAAbiECCyAAQQh2IgEgAkEYbCIAQYwIaigCAGwgAEGICGooAgBqIgJBA3YgAmogAEGACGooAgAgAEGECGooAgAgAWxqSQs3ACAAIAMgBCAFQYAQEDMiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQMgVBuH8LC78DAQN/IwBBIGsiBSQAIAVBCGogAiADEAYiAhADRQRAIAAgAWoiB0F9aiEGIAUgBBAOIARBBGohAiAFLQACIQMDQEEAIAAgBkkgBUEIahAEGwRAIAAgAiAFQQhqIAMQAkECdGoiBC8BADsAACAFQQhqIAQtAAIQASAAIAQtAANqIgQgAiAFQQhqIAMQAkECdGoiAC8BADsAACAFQQhqIAAtAAIQASAEIAAtAANqIQAMAQUgB0F+aiEEA0AgBUEIahAEIAAgBEtyRQRAIAAgAiAFQQhqIAMQAkECdGoiBi8BADsAACAFQQhqIAYtAAIQASAAIAYtAANqIQAMAQsLA0AgACAES0UEQCAAIAIgBUEIaiADEAJBAnRqIgYvAQA7AAAgBUEIaiAGLQACEAEgACAGLQADaiEADAELCwJAIAAgB08NACAAIAIgBUEIaiADEAIiA0ECdGoiAC0AADoAACAALQADQQFGBEAgBUEIaiAALQACEAEMAQsgBSgCDEEfSw0AIAVBCGogAiADQQJ0ai0AAhABIAUoAgxBIUkNACAFQSA2AgwLIAFBbCAFQQhqEAobIQILCwsgBUEgaiQAIAILkgIBBH8jAEFAaiIJJAAgCSADQTQQCyEDAkAgBEECSA0AIAMgBEECdGooAgAhCSADQTxqIAgQIyADQQE6AD8gAyACOgA+QQAhBCADKAI8IQoDQCAEIAlGDQEgACAEQQJ0aiAKNgEAIARBAWohBAwAAAsAC0EAIQkDQCAGIAlGRQRAIAMgBSAJQQF0aiIKLQABIgtBAnRqIgwoAgAhBCADQTxqIAotAABBCHQgCGpB//8DcRAjIANBAjoAPyADIAcgC2siCiACajoAPiAEQQEgASAKa3RqIQogAygCPCELA0AgACAEQQJ0aiALNgEAIARBAWoiBCAKSQ0ACyAMIAo2AgAgCUEBaiEJDAELCyADQUBrJAALowIBCX8jAEHQAGsiCSQAIAlBEGogBUE0EAsaIAcgBmshDyAHIAFrIRADQAJAIAMgCkcEQEEBIAEgByACIApBAXRqIgYtAAEiDGsiCGsiC3QhDSAGLQAAIQ4gCUEQaiAMQQJ0aiIMKAIAIQYgCyAPTwRAIAAgBkECdGogCyAIIAUgCEE0bGogCCAQaiIIQQEgCEEBShsiCCACIAQgCEECdGooAgAiCEEBdGogAyAIayAHIA4QYyAGIA1qIQgMAgsgCUEMaiAOECMgCUEBOgAPIAkgCDoADiAGIA1qIQggCSgCDCELA0AgBiAITw0CIAAgBkECdGogCzYBACAGQQFqIQYMAAALAAsgCUHQAGokAA8LIAwgCDYCACAKQQFqIQoMAAALAAs0ACAAIAMgBCAFEDYiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQNAVBuH8LCyMAIAA/AEEQdGtB//8DakEQdkAAQX9GBEBBAA8LQQAQAEEBCzsBAX8gAgRAA0AgACABIAJBgCAgAkGAIEkbIgMQCyEAIAFBgCBqIQEgAEGAIGohACACIANrIgINAAsLCwYAIAAQAwsLqBUJAEGICAsNAQAAAAEAAAACAAAAAgBBoAgLswYBAAAAAQAAAAIAAAACAAAAJgAAAIIAAAAhBQAASgAAAGcIAAAmAAAAwAEAAIAAAABJBQAASgAAAL4IAAApAAAALAIAAIAAAABJBQAASgAAAL4IAAAvAAAAygIAAIAAAACKBQAASgAAAIQJAAA1AAAAcwMAAIAAAACdBQAASgAAAKAJAAA9AAAAgQMAAIAAAADrBQAASwAAAD4KAABEAAAAngMAAIAAAABNBgAASwAAAKoKAABLAAAAswMAAIAAAADBBgAATQAAAB8NAABNAAAAUwQAAIAAAAAjCAAAUQAAAKYPAABUAAAAmQQAAIAAAABLCQAAVwAAALESAABYAAAA2gQAAIAAAABvCQAAXQAAACMUAABUAAAARQUAAIAAAABUCgAAagAAAIwUAABqAAAArwUAAIAAAAB2CQAAfAAAAE4QAAB8AAAA0gIAAIAAAABjBwAAkQAAAJAHAACSAAAAAAAAAAEAAAABAAAABQAAAA0AAAAdAAAAPQAAAH0AAAD9AAAA/QEAAP0DAAD9BwAA/Q8AAP0fAAD9PwAA/X8AAP3/AAD9/wEA/f8DAP3/BwD9/w8A/f8fAP3/PwD9/38A/f//AP3//wH9//8D/f//B/3//w/9//8f/f//P/3//38AAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABEAAAASAAAAEwAAABQAAAAVAAAAFgAAABcAAAAYAAAAGQAAABoAAAAbAAAAHAAAAB0AAAAeAAAAHwAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAKAAAACwAAAAwAAAANAAAADgAAAA8AAAAQAAAAEQAAABIAAAATAAAAFAAAABUAAAAWAAAAFwAAABgAAAAZAAAAGgAAABsAAAAcAAAAHQAAAB4AAAAfAAAAIAAAACEAAAAiAAAAIwAAACUAAAAnAAAAKQAAACsAAAAvAAAAMwAAADsAAABDAAAAUwAAAGMAAACDAAAAAwEAAAMCAAADBAAAAwgAAAMQAAADIAAAA0AAAAOAAAADAAEAQeAPC1EBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAEAAAABQAAAAcAAAAIAAAACQAAAAoAAAALAAAADAAAAA0AAAAOAAAADwAAABAAQcQQC4sBAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABIAAAAUAAAAFgAAABgAAAAcAAAAIAAAACgAAAAwAAAAQAAAAIAAAAAAAQAAAAIAAAAEAAAACAAAABAAAAAgAAAAQAAAAIAAAAAAAQBBkBIL5gQBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAAAEAAAAEAAAACAAAAAAAAAABAAEBBgAAAAAAAAQAAAAAEAAABAAAAAAgAAAFAQAAAAAAAAUDAAAAAAAABQQAAAAAAAAFBgAAAAAAAAUHAAAAAAAABQkAAAAAAAAFCgAAAAAAAAUMAAAAAAAABg4AAAAAAAEFEAAAAAAAAQUUAAAAAAABBRYAAAAAAAIFHAAAAAAAAwUgAAAAAAAEBTAAAAAgAAYFQAAAAAAABwWAAAAAAAAIBgABAAAAAAoGAAQAAAAADAYAEAAAIAAABAAAAAAAAAAEAQAAAAAAAAUCAAAAIAAABQQAAAAAAAAFBQAAACAAAAUHAAAAAAAABQgAAAAgAAAFCgAAAAAAAAULAAAAAAAABg0AAAAgAAEFEAAAAAAAAQUSAAAAIAABBRYAAAAAAAIFGAAAACAAAwUgAAAAAAADBSgAAAAAAAYEQAAAABAABgRAAAAAIAAHBYAAAAAAAAkGAAIAAAAACwYACAAAMAAABAAAAAAQAAAEAQAAACAAAAUCAAAAIAAABQMAAAAgAAAFBQAAACAAAAUGAAAAIAAABQgAAAAgAAAFCQAAACAAAAULAAAAIAAABQwAAAAAAAAGDwAAACAAAQUSAAAAIAABBRQAAAAgAAIFGAAAACAAAgUcAAAAIAADBSgAAAAgAAQFMAAAAAAAEAYAAAEAAAAPBgCAAAAAAA4GAEAAAAAADQYAIABBgBcLhwIBAAEBBQAAAAAAAAUAAAAAAAAGBD0AAAAAAAkF/QEAAAAADwX9fwAAAAAVBf3/HwAAAAMFBQAAAAAABwR9AAAAAAAMBf0PAAAAABIF/f8DAAAAFwX9/38AAAAFBR0AAAAAAAgE/QAAAAAADgX9PwAAAAAUBf3/DwAAAAIFAQAAABAABwR9AAAAAAALBf0HAAAAABEF/f8BAAAAFgX9/z8AAAAEBQ0AAAAQAAgE/QAAAAAADQX9HwAAAAATBf3/BwAAAAEFAQAAABAABgQ9AAAAAAAKBf0DAAAAABAF/f8AAAAAHAX9//8PAAAbBf3//wcAABoF/f//AwAAGQX9//8BAAAYBf3//wBBkBkLhgQBAAEBBgAAAAAAAAYDAAAAAAAABAQAAAAgAAAFBQAAAAAAAAUGAAAAAAAABQgAAAAAAAAFCQAAAAAAAAULAAAAAAAABg0AAAAAAAAGEAAAAAAAAAYTAAAAAAAABhYAAAAAAAAGGQAAAAAAAAYcAAAAAAAABh8AAAAAAAAGIgAAAAAAAQYlAAAAAAABBikAAAAAAAIGLwAAAAAAAwY7AAAAAAAEBlMAAAAAAAcGgwAAAAAACQYDAgAAEAAABAQAAAAAAAAEBQAAACAAAAUGAAAAAAAABQcAAAAgAAAFCQAAAAAAAAUKAAAAAAAABgwAAAAAAAAGDwAAAAAAAAYSAAAAAAAABhUAAAAAAAAGGAAAAAAAAAYbAAAAAAAABh4AAAAAAAAGIQAAAAAAAQYjAAAAAAABBicAAAAAAAIGKwAAAAAAAwYzAAAAAAAEBkMAAAAAAAUGYwAAAAAACAYDAQAAIAAABAQAAAAwAAAEBAAAABAAAAQFAAAAIAAABQcAAAAgAAAFCAAAACAAAAUKAAAAIAAABQsAAAAAAAAGDgAAAAAAAAYRAAAAAAAABhQAAAAAAAAGFwAAAAAAAAYaAAAAAAAABh0AAAAAAAAGIAAAAAAAEAYDAAEAAAAPBgOAAAAAAA4GA0AAAAAADQYDIAAAAAAMBgMQAAAAAAsGAwgAAAAACgYDBABBpB0L2QEBAAAAAwAAAAcAAAAPAAAAHwAAAD8AAAB/AAAA/wAAAP8BAAD/AwAA/wcAAP8PAAD/HwAA/z8AAP9/AAD//wAA//8BAP//AwD//wcA//8PAP//HwD//z8A//9/AP///wD///8B////A////wf///8P////H////z////9/AAAAAAEAAAACAAAABAAAAAAAAAACAAAABAAAAAgAAAAAAAAAAQAAAAIAAAABAAAABAAAAAQAAAAEAAAABAAAAAgAAAAIAAAACAAAAAcAAAAIAAAACQAAAAoAAAALAEGgIAsDwBBQ"},"./node_modules/three/examples/jsm/lights/LightProbeGenerator.js":(l,u,c)=>{c.r(u),c.d(u,{LightProbeGenerator:()=>p});var h=c("./node_modules/three/build/three.module.js");class p{static fromCubeTexture(g){let y=0;const x=new h.Vector3,v=new h.Vector3,_=new h.Color,T=[0,0,0,0,0,0,0,0,0],w=new h.SphericalHarmonics3,S=w.coefficients;for(let B=0;B<6;B++){const I=g.image[B],D=I.width,L=I.height,O=document.createElement("canvas");O.width=D,O.height=L;const U=O.getContext("2d");U.drawImage(I,0,0,D,L);const Z=U.getImageData(0,0,D,L),G=Z.data,z=Z.width,$=2/z;for(let Q=0,H=G.length;Q<H;Q+=4){_.setRGB(G[Q]/255,G[Q+1]/255,G[Q+2]/255),f(_,g.colorSpace);const V=Q/4,ne=-1+(V%z+.5)*$,Y=1-(Math.floor(V/z)+.5)*$;switch(B){case 0:x.set(-1,Y,-ne);break;case 1:x.set(1,Y,ne);break;case 2:x.set(-ne,1,-Y);break;case 3:x.set(-ne,-1,Y);break;case 4:x.set(-ne,Y,1);break;case 5:x.set(ne,Y,-1);break}const ae=x.lengthSq(),xe=4/(Math.sqrt(ae)*ae);y+=xe,v.copy(x).normalize(),h.SphericalHarmonics3.getBasisAt(v,T);for(let fe=0;fe<9;fe++)S[fe].x+=T[fe]*_.r*xe,S[fe].y+=T[fe]*_.g*xe,S[fe].z+=T[fe]*_.b*xe}}const R=4*Math.PI/y;for(let B=0;B<9;B++)S[B].x*=R,S[B].y*=R,S[B].z*=R;return new h.LightProbe(w)}static fromCubeRenderTarget(g,y){let x=0;const v=new h.Vector3,_=new h.Vector3,T=new h.Color,w=[0,0,0,0,0,0,0,0,0],S=new h.SphericalHarmonics3,R=S.coefficients,B=y.texture.type;for(let D=0;D<6;D++){const L=y.width;let O;B===h.HalfFloatType?O=new Uint16Array(L*L*4):O=new Uint8Array(L*L*4),g.readRenderTargetPixels(y,0,0,L,L,O,D);const U=2/L;for(let Z=0,G=O.length;Z<G;Z+=4){let z,$,Q;B===h.HalfFloatType?(z=h.DataUtils.fromHalfFloat(O[Z]),$=h.DataUtils.fromHalfFloat(O[Z+1]),Q=h.DataUtils.fromHalfFloat(O[Z+2])):(z=O[Z]/255,$=O[Z+1]/255,Q=O[Z+2]/255),T.setRGB(z,$,Q),f(T,y.texture.colorSpace);const H=Z/4,V=-1+(H%L+.5)*U,ne=1-(Math.floor(H/L)+.5)*U;switch(D){case 0:v.set(1,ne,-V);break;case 1:v.set(-1,ne,V);break;case 2:v.set(V,1,-ne);break;case 3:v.set(V,-1,ne);break;case 4:v.set(V,ne,1);break;case 5:v.set(-V,ne,-1);break}const Y=v.lengthSq(),ae=4/(Math.sqrt(Y)*Y);x+=ae,_.copy(v).normalize(),h.SphericalHarmonics3.getBasisAt(_,w);for(let xe=0;xe<9;xe++)R[xe].x+=w[xe]*T.r*ae,R[xe].y+=w[xe]*T.g*ae,R[xe].z+=w[xe]*T.b*ae}}const I=4*Math.PI/x;for(let D=0;D<9;D++)R[D].x*=I,R[D].y*=I,R[D].z*=I;return new h.LightProbe(S)}}function f(m,g){switch(g){case h.SRGBColorSpace:m.convertSRGBToLinear();break;case h.LinearSRGBColorSpace:case h.NoColorSpace:break;default:console.warn("WARNING: LightProbeGenerator convertColorToLinear() encountered an unsupported color space.");break}return m}},"./node_modules/three/examples/jsm/loaders/DRACOLoader.js":(l,u,c)=>{c.r(u),c.d(u,{DRACOLoader:()=>f});var h=c("./node_modules/three/build/three.module.js");const p=new WeakMap;class f extends h.Loader{constructor(y){super(y),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(y){return this.decoderPath=y,this}setDecoderConfig(y){return this.decoderConfig=y,this}setWorkerLimit(y){return this.workerLimit=y,this}load(y,x,v,_){const T=new h.FileLoader(this.manager);T.setPath(this.path),T.setResponseType("arraybuffer"),T.setRequestHeader(this.requestHeader),T.setWithCredentials(this.withCredentials),T.load(y,w=>{this.parse(w,x,_)},v,_)}parse(y,x,v=()=>{}){this.decodeDracoFile(y,x,null,null,h.SRGBColorSpace).catch(v)}decodeDracoFile(y,x,v,_,T=h.LinearSRGBColorSpace,w=()=>{}){const S={attributeIDs:v||this.defaultAttributeIDs,attributeTypes:_||this.defaultAttributeTypes,useUniqueIDs:!!v,vertexColorSpace:T};return this.decodeGeometry(y,S).then(x).catch(w)}decodeGeometry(y,x){const v=JSON.stringify(x);if(p.has(y)){const R=p.get(y);if(R.key===v)return R.promise;if(y.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let _;const T=this.workerNextTaskID++,w=y.byteLength,S=this._getWorker(T,w).then(R=>(_=R,new Promise((B,I)=>{_._callbacks[T]={resolve:B,reject:I},_.postMessage({type:"decode",id:T,taskConfig:x,buffer:y},[y])}))).then(R=>this._createGeometry(R.geometry));return S.catch(()=>!0).then(()=>{_&&T&&this._releaseTask(_,T)}),p.set(y,{key:v,promise:S}),S}_createGeometry(y){const x=new h.BufferGeometry;y.index&&x.setIndex(new h.BufferAttribute(y.index.array,1));for(let v=0;v<y.attributes.length;v++){const _=y.attributes[v],T=_.name,w=_.array,S=_.itemSize,R=new h.BufferAttribute(w,S);T==="color"&&(this._assignVertexColorSpace(R,_.vertexColorSpace),R.normalized=!(w instanceof Float32Array)),x.setAttribute(T,R)}return x}_assignVertexColorSpace(y,x){if(x!==h.SRGBColorSpace)return;const v=new h.Color;for(let _=0,T=y.count;_<T;_++)v.fromBufferAttribute(y,_).convertSRGBToLinear(),y.setXYZ(_,v.r,v.g,v.b)}_loadLibrary(y,x){const v=new h.FileLoader(this.manager);return v.setPath(this.decoderPath),v.setResponseType(x),v.setWithCredentials(this.withCredentials),new Promise((_,T)=>{v.load(y,_,void 0,T)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const y=typeof WebAssembly!="object"||this.decoderConfig.type==="js",x=[];return y?x.push(this._loadLibrary("draco_decoder.js","text")):(x.push(this._loadLibrary("draco_wasm_wrapper.js","text")),x.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(x).then(v=>{const _=v[0];y||(this.decoderConfig.wasmBinary=v[1]);const T=m.toString(),w=["/* draco decoder */",_,"","/* worker */",T.substring(T.indexOf("{")+1,T.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([w]))}),this.decoderPending}_getWorker(y,x){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const _=new Worker(this.workerSourceURL);_._callbacks={},_._taskCosts={},_._taskLoad=0,_.postMessage({type:"init",decoderConfig:this.decoderConfig}),_.onmessage=function(T){const w=T.data;switch(w.type){case"decode":_._callbacks[w.id].resolve(w);break;case"error":_._callbacks[w.id].reject(w);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+w.type+'"')}},this.workerPool.push(_)}else this.workerPool.sort(function(_,T){return _._taskLoad>T._taskLoad?-1:1});const v=this.workerPool[this.workerPool.length-1];return v._taskCosts[y]=x,v._taskLoad+=x,v})}_releaseTask(y,x){y._taskLoad-=y._taskCosts[x],delete y._callbacks[x],delete y._taskCosts[x]}debug(){console.log("Task load: ",this.workerPool.map(y=>y._taskLoad))}dispose(){for(let y=0;y<this.workerPool.length;++y)this.workerPool[y].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}}function m(){let g,y;onmessage=function(w){const S=w.data;switch(S.type){case"init":g=S.decoderConfig,y=new Promise(function(I){g.onModuleLoaded=function(D){I({draco:D})},DracoDecoderModule(g)});break;case"decode":const R=S.buffer,B=S.taskConfig;y.then(I=>{const D=I.draco,L=new D.Decoder;try{const O=x(D,L,new Int8Array(R),B),U=O.attributes.map(Z=>Z.array.buffer);O.index&&U.push(O.index.array.buffer),self.postMessage({type:"decode",id:S.id,geometry:O},U)}catch(O){console.error(O),self.postMessage({type:"error",id:S.id,error:O.message})}finally{D.destroy(L)}});break}};function x(w,S,R,B){const I=B.attributeIDs,D=B.attributeTypes;let L,O;const U=S.GetEncodedGeometryType(R);if(U===w.TRIANGULAR_MESH)L=new w.Mesh,O=S.DecodeArrayToMesh(R,R.byteLength,L);else if(U===w.POINT_CLOUD)L=new w.PointCloud,O=S.DecodeArrayToPointCloud(R,R.byteLength,L);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!O.ok()||L.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+O.error_msg());const Z={index:null,attributes:[]};for(const G in I){const z=self[D[G]];let $,Q;if(B.useUniqueIDs)Q=I[G],$=S.GetAttributeByUniqueId(L,Q);else{if(Q=S.GetAttributeId(L,w[I[G]]),Q===-1)continue;$=S.GetAttribute(L,Q)}const H=_(w,S,L,G,z,$);G==="color"&&(H.vertexColorSpace=B.vertexColorSpace),Z.attributes.push(H)}return U===w.TRIANGULAR_MESH&&(Z.index=v(w,S,L)),w.destroy(L),Z}function v(w,S,R){const B=R.num_faces()*3,I=B*4,D=w._malloc(I);S.GetTrianglesUInt32Array(R,I,D);const L=new Uint32Array(w.HEAPF32.buffer,D,B).slice();return w._free(D),{array:L,itemSize:1}}function _(w,S,R,B,I,D){const L=D.num_components(),O=R.num_points()*L,U=O*I.BYTES_PER_ELEMENT,Z=T(w,I),G=w._malloc(U);S.GetAttributeDataArrayForAllPoints(R,D,Z,U,G);const z=new I(w.HEAPF32.buffer,G,O).slice();return w._free(G),{name:B,array:z,itemSize:L}}function T(w,S){switch(S){case Float32Array:return w.DT_FLOAT32;case Int8Array:return w.DT_INT8;case Int16Array:return w.DT_INT16;case Int32Array:return w.DT_INT32;case Uint8Array:return w.DT_UINT8;case Uint16Array:return w.DT_UINT16;case Uint32Array:return w.DT_UINT32}}}},"./node_modules/three/examples/jsm/loaders/GLTFLoader.js":(l,u,c)=>{c.r(u),c.d(u,{GLTFLoader:()=>f});var h=c("./node_modules/three/build/three.module.js"),p=c("./node_modules/three/examples/jsm/utils/BufferGeometryUtils.js");class f extends h.Loader{constructor(ye){super(ye),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(ve){return new _(ve)}),this.register(function(ve){return new T(ve)}),this.register(function(ve){return new U(ve)}),this.register(function(ve){return new Z(ve)}),this.register(function(ve){return new G(ve)}),this.register(function(ve){return new S(ve)}),this.register(function(ve){return new R(ve)}),this.register(function(ve){return new B(ve)}),this.register(function(ve){return new I(ve)}),this.register(function(ve){return new v(ve)}),this.register(function(ve){return new D(ve)}),this.register(function(ve){return new w(ve)}),this.register(function(ve){return new O(ve)}),this.register(function(ve){return new L(ve)}),this.register(function(ve){return new y(ve)}),this.register(function(ve){return new z(ve)}),this.register(function(ve){return new $(ve)})}load(ye,ve,Le,Te){const ke=this;let Pe;if(this.resourcePath!=="")Pe=this.resourcePath;else if(this.path!==""){const ie=h.LoaderUtils.extractUrlBase(ye);Pe=h.LoaderUtils.resolveURL(ie,this.path)}else Pe=h.LoaderUtils.extractUrlBase(ye);this.manager.itemStart(ye);const F=function(ie){Te?Te(ie):console.error(ie),ke.manager.itemError(ye),ke.manager.itemEnd(ye)},J=new h.FileLoader(this.manager);J.setPath(this.path),J.setResponseType("arraybuffer"),J.setRequestHeader(this.requestHeader),J.setWithCredentials(this.withCredentials),J.load(ye,function(ie){try{ke.parse(ie,Pe,function(Re){ve(Re),ke.manager.itemEnd(ye)},F)}catch(Re){F(Re)}},Le,F)}setDRACOLoader(ye){return this.dracoLoader=ye,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(ye){return this.ktx2Loader=ye,this}setMeshoptDecoder(ye){return this.meshoptDecoder=ye,this}register(ye){return this.pluginCallbacks.indexOf(ye)===-1&&this.pluginCallbacks.push(ye),this}unregister(ye){return this.pluginCallbacks.indexOf(ye)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(ye),1),this}parse(ye,ve,Le,Te){let ke;const Pe={},F={},J=new TextDecoder;if(typeof ye=="string")ke=JSON.parse(ye);else if(ye instanceof ArrayBuffer)if(J.decode(new Uint8Array(ye,0,4))===Q){try{Pe[g.KHR_BINARY_GLTF]=new ne(ye)}catch(Re){Te&&Te(Re);return}ke=JSON.parse(Pe[g.KHR_BINARY_GLTF].content)}else ke=JSON.parse(J.decode(ye));else ke=ye;if(ke.asset===void 0||ke.asset.version[0]<2){Te&&Te(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const ie=new Jt(ke,{path:ve||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});ie.fileLoader.setRequestHeader(this.requestHeader);for(let Re=0;Re<this.pluginCallbacks.length;Re++){const ce=this.pluginCallbacks[Re](ie);ce.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),F[ce.name]=ce,Pe[ce.name]=!0}if(ke.extensionsUsed)for(let Re=0;Re<ke.extensionsUsed.length;++Re){const ce=ke.extensionsUsed[Re],Ue=ke.extensionsRequired||[];switch(ce){case g.KHR_MATERIALS_UNLIT:Pe[ce]=new x;break;case g.KHR_DRACO_MESH_COMPRESSION:Pe[ce]=new Y(ke,this.dracoLoader);break;case g.KHR_TEXTURE_TRANSFORM:Pe[ce]=new ae;break;case g.KHR_MESH_QUANTIZATION:Pe[ce]=new xe;break;default:Ue.indexOf(ce)>=0&&F[ce]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+ce+'".')}}ie.setExtensions(Pe),ie.setPlugins(F),ie.parse(Le,Te)}parseAsync(ye,ve){const Le=this;return new Promise(function(Te,ke){Le.parse(ye,ve,Te,ke)})}}function m(){let vt={};return{get:function(ye){return vt[ye]},add:function(ye,ve){vt[ye]=ve},remove:function(ye){delete vt[ye]},removeAll:function(){vt={}}}}const g={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class y{constructor(ye){this.parser=ye,this.name=g.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const ye=this.parser,ve=this.parser.json.nodes||[];for(let Le=0,Te=ve.length;Le<Te;Le++){const ke=ve[Le];ke.extensions&&ke.extensions[this.name]&&ke.extensions[this.name].light!==void 0&&ye._addNodeRef(this.cache,ke.extensions[this.name].light)}}_loadLight(ye){const ve=this.parser,Le="light:"+ye;let Te=ve.cache.get(Le);if(Te)return Te;const ke=ve.json,Pe=((ke.extensions&&ke.extensions[this.name]||{}).lights||[])[ye];let F;const J=new h.Color(16777215);Pe.color!==void 0&&J.setRGB(Pe.color[0],Pe.color[1],Pe.color[2],h.LinearSRGBColorSpace);const ie=Pe.range!==void 0?Pe.range:0;switch(Pe.type){case"directional":F=new h.DirectionalLight(J),F.target.position.set(0,0,-1),F.add(F.target);break;case"point":F=new h.PointLight(J),F.distance=ie;break;case"spot":F=new h.SpotLight(J),F.distance=ie,Pe.spot=Pe.spot||{},Pe.spot.innerConeAngle=Pe.spot.innerConeAngle!==void 0?Pe.spot.innerConeAngle:0,Pe.spot.outerConeAngle=Pe.spot.outerConeAngle!==void 0?Pe.spot.outerConeAngle:Math.PI/4,F.angle=Pe.spot.outerConeAngle,F.penumbra=1-Pe.spot.innerConeAngle/Pe.spot.outerConeAngle,F.target.position.set(0,0,-1),F.add(F.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+Pe.type)}return F.position.set(0,0,0),F.decay=2,Ii(F,Pe),Pe.intensity!==void 0&&(F.intensity=Pe.intensity),F.name=ve.createUniqueName(Pe.name||"light_"+ye),Te=Promise.resolve(F),ve.cache.add(Le,Te),Te}getDependency(ye,ve){if(ye==="light")return this._loadLight(ve)}createNodeAttachment(ye){const ve=this,Le=this.parser,Te=Le.json.nodes[ye],ke=(Te.extensions&&Te.extensions[this.name]||{}).light;return ke===void 0?null:this._loadLight(ke).then(function(Pe){return Le._getNodeRef(ve.cache,ke,Pe)})}}class x{constructor(){this.name=g.KHR_MATERIALS_UNLIT}getMaterialType(){return h.MeshBasicMaterial}extendParams(ye,ve,Le){const Te=[];ye.color=new h.Color(1,1,1),ye.opacity=1;const ke=ve.pbrMetallicRoughness;if(ke){if(Array.isArray(ke.baseColorFactor)){const Pe=ke.baseColorFactor;ye.color.setRGB(Pe[0],Pe[1],Pe[2],h.LinearSRGBColorSpace),ye.opacity=Pe[3]}ke.baseColorTexture!==void 0&&Te.push(Le.assignTexture(ye,"map",ke.baseColorTexture,h.SRGBColorSpace))}return Promise.all(Te)}}class v{constructor(ye){this.parser=ye,this.name=g.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(ye,ve){const Le=this.parser.json.materials[ye];if(!Le.extensions||!Le.extensions[this.name])return Promise.resolve();const Te=Le.extensions[this.name].emissiveStrength;return Te!==void 0&&(ve.emissiveIntensity=Te),Promise.resolve()}}class _{constructor(ye){this.parser=ye,this.name=g.KHR_MATERIALS_CLEARCOAT}getMaterialType(ye){const ve=this.parser.json.materials[ye];return!ve.extensions||!ve.extensions[this.name]?null:h.MeshPhysicalMaterial}extendMaterialParams(ye,ve){const Le=this.parser,Te=Le.json.materials[ye];if(!Te.extensions||!Te.extensions[this.name])return Promise.resolve();const ke=[],Pe=Te.extensions[this.name];if(Pe.clearcoatFactor!==void 0&&(ve.clearcoat=Pe.clearcoatFactor),Pe.clearcoatTexture!==void 0&&ke.push(Le.assignTexture(ve,"clearcoatMap",Pe.clearcoatTexture)),Pe.clearcoatRoughnessFactor!==void 0&&(ve.clearcoatRoughness=Pe.clearcoatRoughnessFactor),Pe.clearcoatRoughnessTexture!==void 0&&ke.push(Le.assignTexture(ve,"clearcoatRoughnessMap",Pe.clearcoatRoughnessTexture)),Pe.clearcoatNormalTexture!==void 0&&(ke.push(Le.assignTexture(ve,"clearcoatNormalMap",Pe.clearcoatNormalTexture)),Pe.clearcoatNormalTexture.scale!==void 0)){const F=Pe.clearcoatNormalTexture.scale;ve.clearcoatNormalScale=new h.Vector2(F,F)}return Promise.all(ke)}}class T{constructor(ye){this.parser=ye,this.name=g.KHR_MATERIALS_DISPERSION}getMaterialType(ye){const ve=this.parser.json.materials[ye];return!ve.extensions||!ve.extensions[this.name]?null:h.MeshPhysicalMaterial}extendMaterialParams(ye,ve){const Le=this.parser.json.materials[ye];if(!Le.extensions||!Le.extensions[this.name])return Promise.resolve();const Te=Le.extensions[this.name];return ve.dispersion=Te.dispersion!==void 0?Te.dispersion:0,Promise.resolve()}}class w{constructor(ye){this.parser=ye,this.name=g.KHR_MATERIALS_IRIDESCENCE}getMaterialType(ye){const ve=this.parser.json.materials[ye];return!ve.extensions||!ve.extensions[this.name]?null:h.MeshPhysicalMaterial}extendMaterialParams(ye,ve){const Le=this.parser,Te=Le.json.materials[ye];if(!Te.extensions||!Te.extensions[this.name])return Promise.resolve();const ke=[],Pe=Te.extensions[this.name];return Pe.iridescenceFactor!==void 0&&(ve.iridescence=Pe.iridescenceFactor),Pe.iridescenceTexture!==void 0&&ke.push(Le.assignTexture(ve,"iridescenceMap",Pe.iridescenceTexture)),Pe.iridescenceIor!==void 0&&(ve.iridescenceIOR=Pe.iridescenceIor),ve.iridescenceThicknessRange===void 0&&(ve.iridescenceThicknessRange=[100,400]),Pe.iridescenceThicknessMinimum!==void 0&&(ve.iridescenceThicknessRange[0]=Pe.iridescenceThicknessMinimum),Pe.iridescenceThicknessMaximum!==void 0&&(ve.iridescenceThicknessRange[1]=Pe.iridescenceThicknessMaximum),Pe.iridescenceThicknessTexture!==void 0&&ke.push(Le.assignTexture(ve,"iridescenceThicknessMap",Pe.iridescenceThicknessTexture)),Promise.all(ke)}}class S{constructor(ye){this.parser=ye,this.name=g.KHR_MATERIALS_SHEEN}getMaterialType(ye){const ve=this.parser.json.materials[ye];return!ve.extensions||!ve.extensions[this.name]?null:h.MeshPhysicalMaterial}extendMaterialParams(ye,ve){const Le=this.parser,Te=Le.json.materials[ye];if(!Te.extensions||!Te.extensions[this.name])return Promise.resolve();const ke=[];ve.sheenColor=new h.Color(0,0,0),ve.sheenRoughness=0,ve.sheen=1;const Pe=Te.extensions[this.name];if(Pe.sheenColorFactor!==void 0){const F=Pe.sheenColorFactor;ve.sheenColor.setRGB(F[0],F[1],F[2],h.LinearSRGBColorSpace)}return Pe.sheenRoughnessFactor!==void 0&&(ve.sheenRoughness=Pe.sheenRoughnessFactor),Pe.sheenColorTexture!==void 0&&ke.push(Le.assignTexture(ve,"sheenColorMap",Pe.sheenColorTexture,h.SRGBColorSpace)),Pe.sheenRoughnessTexture!==void 0&&ke.push(Le.assignTexture(ve,"sheenRoughnessMap",Pe.sheenRoughnessTexture)),Promise.all(ke)}}class R{constructor(ye){this.parser=ye,this.name=g.KHR_MATERIALS_TRANSMISSION}getMaterialType(ye){const ve=this.parser.json.materials[ye];return!ve.extensions||!ve.extensions[this.name]?null:h.MeshPhysicalMaterial}extendMaterialParams(ye,ve){const Le=this.parser,Te=Le.json.materials[ye];if(!Te.extensions||!Te.extensions[this.name])return Promise.resolve();const ke=[],Pe=Te.extensions[this.name];return Pe.transmissionFactor!==void 0&&(ve.transmission=Pe.transmissionFactor),Pe.transmissionTexture!==void 0&&ke.push(Le.assignTexture(ve,"transmissionMap",Pe.transmissionTexture)),Promise.all(ke)}}class B{constructor(ye){this.parser=ye,this.name=g.KHR_MATERIALS_VOLUME}getMaterialType(ye){const ve=this.parser.json.materials[ye];return!ve.extensions||!ve.extensions[this.name]?null:h.MeshPhysicalMaterial}extendMaterialParams(ye,ve){const Le=this.parser,Te=Le.json.materials[ye];if(!Te.extensions||!Te.extensions[this.name])return Promise.resolve();const ke=[],Pe=Te.extensions[this.name];ve.thickness=Pe.thicknessFactor!==void 0?Pe.thicknessFactor:0,Pe.thicknessTexture!==void 0&&ke.push(Le.assignTexture(ve,"thicknessMap",Pe.thicknessTexture)),ve.attenuationDistance=Pe.attenuationDistance||1/0;const F=Pe.attenuationColor||[1,1,1];return ve.attenuationColor=new h.Color().setRGB(F[0],F[1],F[2],h.LinearSRGBColorSpace),Promise.all(ke)}}class I{constructor(ye){this.parser=ye,this.name=g.KHR_MATERIALS_IOR}getMaterialType(ye){const ve=this.parser.json.materials[ye];return!ve.extensions||!ve.extensions[this.name]?null:h.MeshPhysicalMaterial}extendMaterialParams(ye,ve){const Le=this.parser.json.materials[ye];if(!Le.extensions||!Le.extensions[this.name])return Promise.resolve();const Te=Le.extensions[this.name];return ve.ior=Te.ior!==void 0?Te.ior:1.5,Promise.resolve()}}class D{constructor(ye){this.parser=ye,this.name=g.KHR_MATERIALS_SPECULAR}getMaterialType(ye){const ve=this.parser.json.materials[ye];return!ve.extensions||!ve.extensions[this.name]?null:h.MeshPhysicalMaterial}extendMaterialParams(ye,ve){const Le=this.parser,Te=Le.json.materials[ye];if(!Te.extensions||!Te.extensions[this.name])return Promise.resolve();const ke=[],Pe=Te.extensions[this.name];ve.specularIntensity=Pe.specularFactor!==void 0?Pe.specularFactor:1,Pe.specularTexture!==void 0&&ke.push(Le.assignTexture(ve,"specularIntensityMap",Pe.specularTexture));const F=Pe.specularColorFactor||[1,1,1];return ve.specularColor=new h.Color().setRGB(F[0],F[1],F[2],h.LinearSRGBColorSpace),Pe.specularColorTexture!==void 0&&ke.push(Le.assignTexture(ve,"specularColorMap",Pe.specularColorTexture,h.SRGBColorSpace)),Promise.all(ke)}}class L{constructor(ye){this.parser=ye,this.name=g.EXT_MATERIALS_BUMP}getMaterialType(ye){const ve=this.parser.json.materials[ye];return!ve.extensions||!ve.extensions[this.name]?null:h.MeshPhysicalMaterial}extendMaterialParams(ye,ve){const Le=this.parser,Te=Le.json.materials[ye];if(!Te.extensions||!Te.extensions[this.name])return Promise.resolve();const ke=[],Pe=Te.extensions[this.name];return ve.bumpScale=Pe.bumpFactor!==void 0?Pe.bumpFactor:1,Pe.bumpTexture!==void 0&&ke.push(Le.assignTexture(ve,"bumpMap",Pe.bumpTexture)),Promise.all(ke)}}class O{constructor(ye){this.parser=ye,this.name=g.KHR_MATERIALS_ANISOTROPY}getMaterialType(ye){const ve=this.parser.json.materials[ye];return!ve.extensions||!ve.extensions[this.name]?null:h.MeshPhysicalMaterial}extendMaterialParams(ye,ve){const Le=this.parser,Te=Le.json.materials[ye];if(!Te.extensions||!Te.extensions[this.name])return Promise.resolve();const ke=[],Pe=Te.extensions[this.name];return Pe.anisotropyStrength!==void 0&&(ve.anisotropy=Pe.anisotropyStrength),Pe.anisotropyRotation!==void 0&&(ve.anisotropyRotation=Pe.anisotropyRotation),Pe.anisotropyTexture!==void 0&&ke.push(Le.assignTexture(ve,"anisotropyMap",Pe.anisotropyTexture)),Promise.all(ke)}}class U{constructor(ye){this.parser=ye,this.name=g.KHR_TEXTURE_BASISU}loadTexture(ye){const ve=this.parser,Le=ve.json,Te=Le.textures[ye];if(!Te.extensions||!Te.extensions[this.name])return null;const ke=Te.extensions[this.name],Pe=ve.options.ktx2Loader;if(!Pe){if(Le.extensionsRequired&&Le.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return ve.loadTextureImage(ye,ke.source,Pe)}}class Z{constructor(ye){this.parser=ye,this.name=g.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(ye){const ve=this.name,Le=this.parser,Te=Le.json,ke=Te.textures[ye];if(!ke.extensions||!ke.extensions[ve])return null;const Pe=ke.extensions[ve],F=Te.images[Pe.source];let J=Le.textureLoader;if(F.uri){const ie=Le.options.manager.getHandler(F.uri);ie!==null&&(J=ie)}return this.detectSupport().then(function(ie){if(ie)return Le.loadTextureImage(ye,Pe.source,J);if(Te.extensionsRequired&&Te.extensionsRequired.indexOf(ve)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return Le.loadTexture(ye)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(ye){const ve=new Image;ve.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",ve.onload=ve.onerror=function(){ye(ve.height===1)}})),this.isSupported}}class G{constructor(ye){this.parser=ye,this.name=g.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(ye){const ve=this.name,Le=this.parser,Te=Le.json,ke=Te.textures[ye];if(!ke.extensions||!ke.extensions[ve])return null;const Pe=ke.extensions[ve],F=Te.images[Pe.source];let J=Le.textureLoader;if(F.uri){const ie=Le.options.manager.getHandler(F.uri);ie!==null&&(J=ie)}return this.detectSupport().then(function(ie){if(ie)return Le.loadTextureImage(ye,Pe.source,J);if(Te.extensionsRequired&&Te.extensionsRequired.indexOf(ve)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return Le.loadTexture(ye)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(ye){const ve=new Image;ve.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",ve.onload=ve.onerror=function(){ye(ve.height===1)}})),this.isSupported}}class z{constructor(ye){this.name=g.EXT_MESHOPT_COMPRESSION,this.parser=ye}loadBufferView(ye){const ve=this.parser.json,Le=ve.bufferViews[ye];if(Le.extensions&&Le.extensions[this.name]){const Te=Le.extensions[this.name],ke=this.parser.getDependency("buffer",Te.buffer),Pe=this.parser.options.meshoptDecoder;if(!Pe||!Pe.supported){if(ve.extensionsRequired&&ve.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return ke.then(function(F){const J=Te.byteOffset||0,ie=Te.byteLength||0,Re=Te.count,ce=Te.byteStride,Ue=new Uint8Array(F,J,ie);return Pe.decodeGltfBufferAsync?Pe.decodeGltfBufferAsync(Re,ce,Ue,Te.mode,Te.filter).then(function(je){return je.buffer}):Pe.ready.then(function(){const je=new ArrayBuffer(Re*ce);return Pe.decodeGltfBuffer(new Uint8Array(je),Re,ce,Ue,Te.mode,Te.filter),je})})}else return null}}class ${constructor(ye){this.name=g.EXT_MESH_GPU_INSTANCING,this.parser=ye}createNodeMesh(ye){const ve=this.parser.json,Le=ve.nodes[ye];if(!Le.extensions||!Le.extensions[this.name]||Le.mesh===void 0)return null;const Te=ve.meshes[Le.mesh];for(const J of Te.primitives)if(J.mode!==Ge.TRIANGLES&&J.mode!==Ge.TRIANGLE_STRIP&&J.mode!==Ge.TRIANGLE_FAN&&J.mode!==void 0)return null;const ke=Le.extensions[this.name].attributes,Pe=[],F={};for(const J in ke)Pe.push(this.parser.getDependency("accessor",ke[J]).then(ie=>(F[J]=ie,F[J])));return Pe.length<1?null:(Pe.push(this.parser.createNodeMesh(ye)),Promise.all(Pe).then(J=>{const ie=J.pop(),Re=ie.isGroup?ie.children:[ie],ce=J[0].count,Ue=[];for(const je of Re){const dt=new h.Matrix4,It=new h.Vector3,bt=new h.Quaternion,Ut=new h.Vector3(1,1,1),pi=new h.InstancedMesh(je.geometry,je.material,ce);for(let Er=0;Er<ce;Er++)F.TRANSLATION&&It.fromBufferAttribute(F.TRANSLATION,Er),F.ROTATION&&bt.fromBufferAttribute(F.ROTATION,Er),F.SCALE&&Ut.fromBufferAttribute(F.SCALE,Er),pi.setMatrixAt(Er,dt.compose(It,bt,Ut));for(const Er in F)if(Er==="_COLOR_0"){const ki=F[Er];pi.instanceColor=new h.InstancedBufferAttribute(ki.array,ki.itemSize,ki.normalized)}else Er!=="TRANSLATION"&&Er!=="ROTATION"&&Er!=="SCALE"&&je.geometry.setAttribute(Er,F[Er]);h.Object3D.prototype.copy.call(pi,je),this.parser.assignFinalMaterial(pi),Ue.push(pi)}return ie.isGroup?(ie.clear(),ie.add(...Ue),ie):Ue[0]}))}}const Q="glTF",H=12,V={JSON:1313821514,BIN:5130562};class ne{constructor(ye){this.name=g.KHR_BINARY_GLTF,this.content=null,this.body=null;const ve=new DataView(ye,0,H),Le=new TextDecoder;if(this.header={magic:Le.decode(new Uint8Array(ye.slice(0,4))),version:ve.getUint32(4,!0),length:ve.getUint32(8,!0)},this.header.magic!==Q)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const Te=this.header.length-H,ke=new DataView(ye,H);let Pe=0;for(;Pe<Te;){const F=ke.getUint32(Pe,!0);Pe+=4;const J=ke.getUint32(Pe,!0);if(Pe+=4,J===V.JSON){const ie=new Uint8Array(ye,H+Pe,F);this.content=Le.decode(ie)}else if(J===V.BIN){const ie=H+Pe;this.body=ye.slice(ie,ie+F)}Pe+=F}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Y{constructor(ye,ve){if(!ve)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=g.KHR_DRACO_MESH_COMPRESSION,this.json=ye,this.dracoLoader=ve,this.dracoLoader.preload()}decodePrimitive(ye,ve){const Le=this.json,Te=this.dracoLoader,ke=ye.extensions[this.name].bufferView,Pe=ye.extensions[this.name].attributes,F={},J={},ie={};for(const Re in Pe){const ce=Gt[Re]||Re.toLowerCase();F[ce]=Pe[Re]}for(const Re in ye.attributes){const ce=Gt[Re]||Re.toLowerCase();if(Pe[Re]!==void 0){const Ue=Le.accessors[ye.attributes[Re]],je=Xe[Ue.componentType];ie[ce]=je.name,J[ce]=Ue.normalized===!0}}return ve.getDependency("bufferView",ke).then(function(Re){return new Promise(function(ce,Ue){Te.decodeDracoFile(Re,function(je){for(const dt in je.attributes){const It=je.attributes[dt],bt=J[dt];bt!==void 0&&(It.normalized=bt)}ce(je)},F,ie,h.LinearSRGBColorSpace,Ue)})})}}class ae{constructor(){this.name=g.KHR_TEXTURE_TRANSFORM}extendTexture(ye,ve){return(ve.texCoord===void 0||ve.texCoord===ye.channel)&&ve.offset===void 0&&ve.rotation===void 0&&ve.scale===void 0||(ye=ye.clone(),ve.texCoord!==void 0&&(ye.channel=ve.texCoord),ve.offset!==void 0&&ye.offset.fromArray(ve.offset),ve.rotation!==void 0&&(ye.rotation=ve.rotation),ve.scale!==void 0&&ye.repeat.fromArray(ve.scale),ye.needsUpdate=!0),ye}}class xe{constructor(){this.name=g.KHR_MESH_QUANTIZATION}}class fe extends h.Interpolant{constructor(ye,ve,Le,Te){super(ye,ve,Le,Te)}copySampleValue_(ye){const ve=this.resultBuffer,Le=this.sampleValues,Te=this.valueSize,ke=ye*Te*3+Te;for(let Pe=0;Pe!==Te;Pe++)ve[Pe]=Le[ke+Pe];return ve}interpolate_(ye,ve,Le,Te){const ke=this.resultBuffer,Pe=this.sampleValues,F=this.valueSize,J=F*2,ie=F*3,Re=Te-ve,ce=(Le-ve)/Re,Ue=ce*ce,je=Ue*ce,dt=ye*ie,It=dt-ie,bt=-2*je+3*Ue,Ut=je-Ue,pi=1-bt,Er=Ut-Ue+ce;for(let ki=0;ki!==F;ki++){const An=Pe[It+ki+F],Ur=Pe[It+ki+J]*Re,sn=Pe[dt+ki+F],xs=Pe[dt+ki]*Re;ke[ki]=pi*An+Er*Ur+bt*sn+Ut*xs}return ke}}const de=new h.Quaternion;class Ie extends fe{interpolate_(ye,ve,Le,Te){const ke=super.interpolate_(ye,ve,Le,Te);return de.fromArray(ke).normalize().toArray(ke),ke}}const Ge={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},Xe={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},$e={9728:h.NearestFilter,9729:h.LinearFilter,9984:h.NearestMipmapNearestFilter,9985:h.LinearMipmapNearestFilter,9986:h.NearestMipmapLinearFilter,9987:h.LinearMipmapLinearFilter},lt={33071:h.ClampToEdgeWrapping,33648:h.MirroredRepeatWrapping,10497:h.RepeatWrapping},At={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Gt={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},gt={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},xi={CUBICSPLINE:void 0,LINEAR:h.InterpolateLinear,STEP:h.InterpolateDiscrete},Ze={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function Ui(vt){return vt.DefaultMaterial===void 0&&(vt.DefaultMaterial=new h.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:h.FrontSide})),vt.DefaultMaterial}function di(vt,ye,ve){for(const Le in ve.extensions)vt[Le]===void 0&&(ye.userData.gltfExtensions=ye.userData.gltfExtensions||{},ye.userData.gltfExtensions[Le]=ve.extensions[Le])}function Ii(vt,ye){ye.extras!==void 0&&(typeof ye.extras=="object"?Object.assign(vt.userData,ye.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+ye.extras))}function Ti(vt,ye,ve){let Le=!1,Te=!1,ke=!1;for(let ie=0,Re=ye.length;ie<Re;ie++){const ce=ye[ie];if(ce.POSITION!==void 0&&(Le=!0),ce.NORMAL!==void 0&&(Te=!0),ce.COLOR_0!==void 0&&(ke=!0),Le&&Te&&ke)break}if(!Le&&!Te&&!ke)return Promise.resolve(vt);const Pe=[],F=[],J=[];for(let ie=0,Re=ye.length;ie<Re;ie++){const ce=ye[ie];if(Le){const Ue=ce.POSITION!==void 0?ve.getDependency("accessor",ce.POSITION):vt.attributes.position;Pe.push(Ue)}if(Te){const Ue=ce.NORMAL!==void 0?ve.getDependency("accessor",ce.NORMAL):vt.attributes.normal;F.push(Ue)}if(ke){const Ue=ce.COLOR_0!==void 0?ve.getDependency("accessor",ce.COLOR_0):vt.attributes.color;J.push(Ue)}}return Promise.all([Promise.all(Pe),Promise.all(F),Promise.all(J)]).then(function(ie){const Re=ie[0],ce=ie[1],Ue=ie[2];return Le&&(vt.morphAttributes.position=Re),Te&&(vt.morphAttributes.normal=ce),ke&&(vt.morphAttributes.color=Ue),vt.morphTargetsRelative=!0,vt})}function ir(vt,ye){if(vt.updateMorphTargets(),ye.weights!==void 0)for(let ve=0,Le=ye.weights.length;ve<Le;ve++)vt.morphTargetInfluences[ve]=ye.weights[ve];if(ye.extras&&Array.isArray(ye.extras.targetNames)){const ve=ye.extras.targetNames;if(vt.morphTargetInfluences.length===ve.length){vt.morphTargetDictionary={};for(let Le=0,Te=ve.length;Le<Te;Le++)vt.morphTargetDictionary[ve[Le]]=Le}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Gi(vt){let ye;const ve=vt.extensions&&vt.extensions[g.KHR_DRACO_MESH_COMPRESSION];if(ve?ye="draco:"+ve.bufferView+":"+ve.indices+":"+Qe(ve.attributes):ye=vt.indices+":"+Qe(vt.attributes)+":"+vt.mode,vt.targets!==void 0)for(let Le=0,Te=vt.targets.length;Le<Te;Le++)ye+=":"+Qe(vt.targets[Le]);return ye}function Qe(vt){let ye="";const ve=Object.keys(vt).sort();for(let Le=0,Te=ve.length;Le<Te;Le++)ye+=ve[Le]+":"+vt[ve[Le]]+";";return ye}function Ce(vt){switch(vt){case Int8Array:return .007874015748031496;case Uint8Array:return .00392156862745098;case Int16Array:return 3051850947599719e-20;case Uint16Array:return 15259021896696422e-21;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function yt(vt){return vt.search(/\.jpe?g($|\?)/i)>0||vt.search(/^data\:image\/jpeg/)===0?"image/jpeg":vt.search(/\.webp($|\?)/i)>0||vt.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const Ot=new h.Matrix4;class Jt{constructor(ye={},ve={}){this.json=ye,this.extensions={},this.plugins={},this.options=ve,this.cache=new m,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let Le=!1,Te=!1,ke=-1;typeof navigator<"u"&&(Le=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,Te=navigator.userAgent.indexOf("Firefox")>-1,ke=Te?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||Le||Te&&ke<98?this.textureLoader=new h.TextureLoader(this.options.manager):this.textureLoader=new h.ImageBitmapLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new h.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(ye){this.extensions=ye}setPlugins(ye){this.plugins=ye}parse(ye,ve){const Le=this,Te=this.json,ke=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(Pe){return Pe._markDefs&&Pe._markDefs()}),Promise.all(this._invokeAll(function(Pe){return Pe.beforeRoot&&Pe.beforeRoot()})).then(function(){return Promise.all([Le.getDependencies("scene"),Le.getDependencies("animation"),Le.getDependencies("camera")])}).then(function(Pe){const F={scene:Pe[0][Te.scene||0],scenes:Pe[0],animations:Pe[1],cameras:Pe[2],asset:Te.asset,parser:Le,userData:{}};return di(ke,F,Te),Ii(F,Te),Promise.all(Le._invokeAll(function(J){return J.afterRoot&&J.afterRoot(F)})).then(function(){for(const J of F.scenes)J.updateMatrixWorld();ye(F)})}).catch(ve)}_markDefs(){const ye=this.json.nodes||[],ve=this.json.skins||[],Le=this.json.meshes||[];for(let Te=0,ke=ve.length;Te<ke;Te++){const Pe=ve[Te].joints;for(let F=0,J=Pe.length;F<J;F++)ye[Pe[F]].isBone=!0}for(let Te=0,ke=ye.length;Te<ke;Te++){const Pe=ye[Te];Pe.mesh!==void 0&&(this._addNodeRef(this.meshCache,Pe.mesh),Pe.skin!==void 0&&(Le[Pe.mesh].isSkinnedMesh=!0)),Pe.camera!==void 0&&this._addNodeRef(this.cameraCache,Pe.camera)}}_addNodeRef(ye,ve){ve!==void 0&&(ye.refs[ve]===void 0&&(ye.refs[ve]=ye.uses[ve]=0),ye.refs[ve]++)}_getNodeRef(ye,ve,Le){if(ye.refs[ve]<=1)return Le;const Te=Le.clone(),ke=(Pe,F)=>{const J=this.associations.get(Pe);J!=null&&this.associations.set(F,J);for(const[ie,Re]of Pe.children.entries())ke(Re,F.children[ie])};return ke(Le,Te),Te.name+="_instance_"+ye.uses[ve]++,Te}_invokeOne(ye){const ve=Object.values(this.plugins);ve.push(this);for(let Le=0;Le<ve.length;Le++){const Te=ye(ve[Le]);if(Te)return Te}return null}_invokeAll(ye){const ve=Object.values(this.plugins);ve.unshift(this);const Le=[];for(let Te=0;Te<ve.length;Te++){const ke=ye(ve[Te]);ke&&Le.push(ke)}return Le}getDependency(ye,ve){const Le=ye+":"+ve;let Te=this.cache.get(Le);if(!Te){switch(ye){case"scene":Te=this.loadScene(ve);break;case"node":Te=this._invokeOne(function(ke){return ke.loadNode&&ke.loadNode(ve)});break;case"mesh":Te=this._invokeOne(function(ke){return ke.loadMesh&&ke.loadMesh(ve)});break;case"accessor":Te=this.loadAccessor(ve);break;case"bufferView":Te=this._invokeOne(function(ke){return ke.loadBufferView&&ke.loadBufferView(ve)});break;case"buffer":Te=this.loadBuffer(ve);break;case"material":Te=this._invokeOne(function(ke){return ke.loadMaterial&&ke.loadMaterial(ve)});break;case"texture":Te=this._invokeOne(function(ke){return ke.loadTexture&&ke.loadTexture(ve)});break;case"skin":Te=this.loadSkin(ve);break;case"animation":Te=this._invokeOne(function(ke){return ke.loadAnimation&&ke.loadAnimation(ve)});break;case"camera":Te=this.loadCamera(ve);break;default:if(Te=this._invokeOne(function(ke){return ke!=this&&ke.getDependency&&ke.getDependency(ye,ve)}),!Te)throw new Error("Unknown type: "+ye);break}this.cache.add(Le,Te)}return Te}getDependencies(ye){let ve=this.cache.get(ye);if(!ve){const Le=this,Te=this.json[ye+(ye==="mesh"?"es":"s")]||[];ve=Promise.all(Te.map(function(ke,Pe){return Le.getDependency(ye,Pe)})),this.cache.add(ye,ve)}return ve}loadBuffer(ye){const ve=this.json.buffers[ye],Le=this.fileLoader;if(ve.type&&ve.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+ve.type+" buffer type is not supported.");if(ve.uri===void 0&&ye===0)return Promise.resolve(this.extensions[g.KHR_BINARY_GLTF].body);const Te=this.options;return new Promise(function(ke,Pe){Le.load(h.LoaderUtils.resolveURL(ve.uri,Te.path),ke,void 0,function(){Pe(new Error('THREE.GLTFLoader: Failed to load buffer "'+ve.uri+'".'))})})}loadBufferView(ye){const ve=this.json.bufferViews[ye];return this.getDependency("buffer",ve.buffer).then(function(Le){const Te=ve.byteLength||0,ke=ve.byteOffset||0;return Le.slice(ke,ke+Te)})}loadAccessor(ye){const ve=this,Le=this.json,Te=this.json.accessors[ye];if(Te.bufferView===void 0&&Te.sparse===void 0){const Pe=At[Te.type],F=Xe[Te.componentType],J=Te.normalized===!0,ie=new F(Te.count*Pe);return Promise.resolve(new h.BufferAttribute(ie,Pe,J))}const ke=[];return Te.bufferView!==void 0?ke.push(this.getDependency("bufferView",Te.bufferView)):ke.push(null),Te.sparse!==void 0&&(ke.push(this.getDependency("bufferView",Te.sparse.indices.bufferView)),ke.push(this.getDependency("bufferView",Te.sparse.values.bufferView))),Promise.all(ke).then(function(Pe){const F=Pe[0],J=At[Te.type],ie=Xe[Te.componentType],Re=ie.BYTES_PER_ELEMENT,ce=Re*J,Ue=Te.byteOffset||0,je=Te.bufferView!==void 0?Le.bufferViews[Te.bufferView].byteStride:void 0,dt=Te.normalized===!0;let It,bt;if(je&&je!==ce){const Ut=Math.floor(Ue/je),pi="InterleavedBuffer:"+Te.bufferView+":"+Te.componentType+":"+Ut+":"+Te.count;let Er=ve.cache.get(pi);Er||(It=new ie(F,Ut*je,Te.count*je/Re),Er=new h.InterleavedBuffer(It,je/Re),ve.cache.add(pi,Er)),bt=new h.InterleavedBufferAttribute(Er,J,Ue%je/Re,dt)}else F===null?It=new ie(Te.count*J):It=new ie(F,Ue,Te.count*J),bt=new h.BufferAttribute(It,J,dt);if(Te.sparse!==void 0){const Ut=At.SCALAR,pi=Xe[Te.sparse.indices.componentType],Er=Te.sparse.indices.byteOffset||0,ki=Te.sparse.values.byteOffset||0,An=new pi(Pe[1],Er,Te.sparse.count*Ut),Ur=new ie(Pe[2],ki,Te.sparse.count*J);F!==null&&(bt=new h.BufferAttribute(bt.array.slice(),bt.itemSize,bt.normalized));for(let sn=0,xs=An.length;sn<xs;sn++){const yn=An[sn];if(bt.setX(yn,Ur[sn*J]),J>=2&&bt.setY(yn,Ur[sn*J+1]),J>=3&&bt.setZ(yn,Ur[sn*J+2]),J>=4&&bt.setW(yn,Ur[sn*J+3]),J>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return bt})}loadTexture(ye){const ve=this.json,Le=this.options,Te=ve.textures[ye].source,ke=ve.images[Te];let Pe=this.textureLoader;if(ke.uri){const F=Le.manager.getHandler(ke.uri);F!==null&&(Pe=F)}return this.loadTextureImage(ye,Te,Pe)}loadTextureImage(ye,ve,Le){const Te=this,ke=this.json,Pe=ke.textures[ye],F=ke.images[ve],J=(F.uri||F.bufferView)+":"+Pe.sampler;if(this.textureCache[J])return this.textureCache[J];const ie=this.loadImageSource(ve,Le).then(function(Re){Re.flipY=!1,Re.name=Pe.name||F.name||"",Re.name===""&&typeof F.uri=="string"&&F.uri.startsWith("data:image/")===!1&&(Re.name=F.uri);const ce=(ke.samplers||{})[Pe.sampler]||{};return Re.magFilter=$e[ce.magFilter]||h.LinearFilter,Re.minFilter=$e[ce.minFilter]||h.LinearMipmapLinearFilter,Re.wrapS=lt[ce.wrapS]||h.RepeatWrapping,Re.wrapT=lt[ce.wrapT]||h.RepeatWrapping,Te.associations.set(Re,{textures:ye}),Re}).catch(function(){return null});return this.textureCache[J]=ie,ie}loadImageSource(ye,ve){const Le=this,Te=this.json,ke=this.options;if(this.sourceCache[ye]!==void 0)return this.sourceCache[ye].then(ce=>ce.clone());const Pe=Te.images[ye],F=self.URL||self.webkitURL;let J=Pe.uri||"",ie=!1;if(Pe.bufferView!==void 0)J=Le.getDependency("bufferView",Pe.bufferView).then(function(ce){ie=!0;const Ue=new Blob([ce],{type:Pe.mimeType});return J=F.createObjectURL(Ue),J});else if(Pe.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+ye+" is missing URI and bufferView");const Re=Promise.resolve(J).then(function(ce){return new Promise(function(Ue,je){let dt=Ue;ve.isImageBitmapLoader===!0&&(dt=function(It){const bt=new h.Texture(It);bt.needsUpdate=!0,Ue(bt)}),ve.load(h.LoaderUtils.resolveURL(ce,ke.path),dt,void 0,je)})}).then(function(ce){return ie===!0&&F.revokeObjectURL(J),ce.userData.mimeType=Pe.mimeType||yt(Pe.uri),ce}).catch(function(ce){throw console.error("THREE.GLTFLoader: Couldn't load texture",J),ce});return this.sourceCache[ye]=Re,Re}assignTexture(ye,ve,Le,Te){const ke=this;return this.getDependency("texture",Le.index).then(function(Pe){if(!Pe)return null;if(Le.texCoord!==void 0&&Le.texCoord>0&&(Pe=Pe.clone(),Pe.channel=Le.texCoord),ke.extensions[g.KHR_TEXTURE_TRANSFORM]){const F=Le.extensions!==void 0?Le.extensions[g.KHR_TEXTURE_TRANSFORM]:void 0;if(F){const J=ke.associations.get(Pe);Pe=ke.extensions[g.KHR_TEXTURE_TRANSFORM].extendTexture(Pe,F),ke.associations.set(Pe,J)}}return Te!==void 0&&(Pe.colorSpace=Te),ye[ve]=Pe,Pe})}assignFinalMaterial(ye){const ve=ye.geometry;let Le=ye.material;const Te=ve.attributes.tangent===void 0,ke=ve.attributes.color!==void 0,Pe=ve.attributes.normal===void 0;if(ye.isPoints){const F="PointsMaterial:"+Le.uuid;let J=this.cache.get(F);J||(J=new h.PointsMaterial,h.Material.prototype.copy.call(J,Le),J.color.copy(Le.color),J.map=Le.map,J.sizeAttenuation=!1,this.cache.add(F,J)),Le=J}else if(ye.isLine){const F="LineBasicMaterial:"+Le.uuid;let J=this.cache.get(F);J||(J=new h.LineBasicMaterial,h.Material.prototype.copy.call(J,Le),J.color.copy(Le.color),J.map=Le.map,this.cache.add(F,J)),Le=J}if(Te||ke||Pe){let F="ClonedMaterial:"+Le.uuid+":";Te&&(F+="derivative-tangents:"),ke&&(F+="vertex-colors:"),Pe&&(F+="flat-shading:");let J=this.cache.get(F);J||(J=Le.clone(),ke&&(J.vertexColors=!0),Pe&&(J.flatShading=!0),Te&&(J.normalScale&&(J.normalScale.y*=-1),J.clearcoatNormalScale&&(J.clearcoatNormalScale.y*=-1)),this.cache.add(F,J),this.associations.set(J,this.associations.get(Le))),Le=J}ye.material=Le}getMaterialType(){return h.MeshStandardMaterial}loadMaterial(ye){const ve=this,Le=this.json,Te=this.extensions,ke=Le.materials[ye];let Pe;const F={},J=ke.extensions||{},ie=[];if(J[g.KHR_MATERIALS_UNLIT]){const ce=Te[g.KHR_MATERIALS_UNLIT];Pe=ce.getMaterialType(),ie.push(ce.extendParams(F,ke,ve))}else{const ce=ke.pbrMetallicRoughness||{};if(F.color=new h.Color(1,1,1),F.opacity=1,Array.isArray(ce.baseColorFactor)){const Ue=ce.baseColorFactor;F.color.setRGB(Ue[0],Ue[1],Ue[2],h.LinearSRGBColorSpace),F.opacity=Ue[3]}ce.baseColorTexture!==void 0&&ie.push(ve.assignTexture(F,"map",ce.baseColorTexture,h.SRGBColorSpace)),F.metalness=ce.metallicFactor!==void 0?ce.metallicFactor:1,F.roughness=ce.roughnessFactor!==void 0?ce.roughnessFactor:1,ce.metallicRoughnessTexture!==void 0&&(ie.push(ve.assignTexture(F,"metalnessMap",ce.metallicRoughnessTexture)),ie.push(ve.assignTexture(F,"roughnessMap",ce.metallicRoughnessTexture))),Pe=this._invokeOne(function(Ue){return Ue.getMaterialType&&Ue.getMaterialType(ye)}),ie.push(Promise.all(this._invokeAll(function(Ue){return Ue.extendMaterialParams&&Ue.extendMaterialParams(ye,F)})))}ke.doubleSided===!0&&(F.side=h.DoubleSide);const Re=ke.alphaMode||Ze.OPAQUE;if(Re===Ze.BLEND?(F.transparent=!0,F.depthWrite=!1):(F.transparent=!1,Re===Ze.MASK&&(F.alphaTest=ke.alphaCutoff!==void 0?ke.alphaCutoff:.5)),ke.normalTexture!==void 0&&Pe!==h.MeshBasicMaterial&&(ie.push(ve.assignTexture(F,"normalMap",ke.normalTexture)),F.normalScale=new h.Vector2(1,1),ke.normalTexture.scale!==void 0)){const ce=ke.normalTexture.scale;F.normalScale.set(ce,ce)}if(ke.occlusionTexture!==void 0&&Pe!==h.MeshBasicMaterial&&(ie.push(ve.assignTexture(F,"aoMap",ke.occlusionTexture)),ke.occlusionTexture.strength!==void 0&&(F.aoMapIntensity=ke.occlusionTexture.strength)),ke.emissiveFactor!==void 0&&Pe!==h.MeshBasicMaterial){const ce=ke.emissiveFactor;F.emissive=new h.Color().setRGB(ce[0],ce[1],ce[2],h.LinearSRGBColorSpace)}return ke.emissiveTexture!==void 0&&Pe!==h.MeshBasicMaterial&&ie.push(ve.assignTexture(F,"emissiveMap",ke.emissiveTexture,h.SRGBColorSpace)),Promise.all(ie).then(function(){const ce=new Pe(F);return ke.name&&(ce.name=ke.name),Ii(ce,ke),ve.associations.set(ce,{materials:ye}),ke.extensions&&di(Te,ce,ke),ce})}createUniqueName(ye){const ve=h.PropertyBinding.sanitizeNodeName(ye||"");return ve in this.nodeNamesUsed?ve+"_"+ ++this.nodeNamesUsed[ve]:(this.nodeNamesUsed[ve]=0,ve)}loadGeometries(ye){const ve=this,Le=this.extensions,Te=this.primitiveCache;function ke(F){return Le[g.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(F,ve).then(function(J){return _i(J,F,ve)})}const Pe=[];for(let F=0,J=ye.length;F<J;F++){const ie=ye[F],Re=Gi(ie),ce=Te[Re];if(ce)Pe.push(ce.promise);else{let Ue;ie.extensions&&ie.extensions[g.KHR_DRACO_MESH_COMPRESSION]?Ue=ke(ie):Ue=_i(new h.BufferGeometry,ie,ve),Te[Re]={primitive:ie,promise:Ue},Pe.push(Ue)}}return Promise.all(Pe)}loadMesh(ye){const ve=this,Le=this.json,Te=this.extensions,ke=Le.meshes[ye],Pe=ke.primitives,F=[];for(let J=0,ie=Pe.length;J<ie;J++){const Re=Pe[J].material===void 0?Ui(this.cache):this.getDependency("material",Pe[J].material);F.push(Re)}return F.push(ve.loadGeometries(Pe)),Promise.all(F).then(function(J){const ie=J.slice(0,J.length-1),Re=J[J.length-1],ce=[];for(let je=0,dt=Re.length;je<dt;je++){const It=Re[je],bt=Pe[je];let Ut;const pi=ie[je];if(bt.mode===Ge.TRIANGLES||bt.mode===Ge.TRIANGLE_STRIP||bt.mode===Ge.TRIANGLE_FAN||bt.mode===void 0)Ut=ke.isSkinnedMesh===!0?new h.SkinnedMesh(It,pi):new h.Mesh(It,pi),Ut.isSkinnedMesh===!0&&Ut.normalizeSkinWeights(),bt.mode===Ge.TRIANGLE_STRIP?Ut.geometry=(0,p.toTrianglesDrawMode)(Ut.geometry,h.TriangleStripDrawMode):bt.mode===Ge.TRIANGLE_FAN&&(Ut.geometry=(0,p.toTrianglesDrawMode)(Ut.geometry,h.TriangleFanDrawMode));else if(bt.mode===Ge.LINES)Ut=new h.LineSegments(It,pi);else if(bt.mode===Ge.LINE_STRIP)Ut=new h.Line(It,pi);else if(bt.mode===Ge.LINE_LOOP)Ut=new h.LineLoop(It,pi);else if(bt.mode===Ge.POINTS)Ut=new h.Points(It,pi);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+bt.mode);Object.keys(Ut.geometry.morphAttributes).length>0&&ir(Ut,ke),Ut.name=ve.createUniqueName(ke.name||"mesh_"+ye),Ii(Ut,ke),bt.extensions&&di(Te,Ut,bt),ve.assignFinalMaterial(Ut),ce.push(Ut)}for(let je=0,dt=ce.length;je<dt;je++)ve.associations.set(ce[je],{meshes:ye,primitives:je});if(ce.length===1)return ke.extensions&&di(Te,ce[0],ke),ce[0];const Ue=new h.Group;ke.extensions&&di(Te,Ue,ke),ve.associations.set(Ue,{meshes:ye});for(let je=0,dt=ce.length;je<dt;je++)Ue.add(ce[je]);return Ue})}loadCamera(ye){let ve;const Le=this.json.cameras[ye],Te=Le[Le.type];if(!Te){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return Le.type==="perspective"?ve=new h.PerspectiveCamera(h.MathUtils.radToDeg(Te.yfov),Te.aspectRatio||1,Te.znear||1,Te.zfar||2e6):Le.type==="orthographic"&&(ve=new h.OrthographicCamera(-Te.xmag,Te.xmag,Te.ymag,-Te.ymag,Te.znear,Te.zfar)),Le.name&&(ve.name=this.createUniqueName(Le.name)),Ii(ve,Le),Promise.resolve(ve)}loadSkin(ye){const ve=this.json.skins[ye],Le=[];for(let Te=0,ke=ve.joints.length;Te<ke;Te++)Le.push(this._loadNodeShallow(ve.joints[Te]));return ve.inverseBindMatrices!==void 0?Le.push(this.getDependency("accessor",ve.inverseBindMatrices)):Le.push(null),Promise.all(Le).then(function(Te){const ke=Te.pop(),Pe=Te,F=[],J=[];for(let ie=0,Re=Pe.length;ie<Re;ie++){const ce=Pe[ie];if(ce){F.push(ce);const Ue=new h.Matrix4;ke!==null&&Ue.fromArray(ke.array,ie*16),J.push(Ue)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',ve.joints[ie])}return new h.Skeleton(F,J)})}loadAnimation(ye){const ve=this.json,Le=this,Te=ve.animations[ye],ke=Te.name?Te.name:"animation_"+ye,Pe=[],F=[],J=[],ie=[],Re=[];for(let ce=0,Ue=Te.channels.length;ce<Ue;ce++){const je=Te.channels[ce],dt=Te.samplers[je.sampler],It=je.target,bt=It.node,Ut=Te.parameters!==void 0?Te.parameters[dt.input]:dt.input,pi=Te.parameters!==void 0?Te.parameters[dt.output]:dt.output;It.node!==void 0&&(Pe.push(this.getDependency("node",bt)),F.push(this.getDependency("accessor",Ut)),J.push(this.getDependency("accessor",pi)),ie.push(dt),Re.push(It))}return Promise.all([Promise.all(Pe),Promise.all(F),Promise.all(J),Promise.all(ie),Promise.all(Re)]).then(function(ce){const Ue=ce[0],je=ce[1],dt=ce[2],It=ce[3],bt=ce[4],Ut=[];for(let pi=0,Er=Ue.length;pi<Er;pi++){const ki=Ue[pi],An=je[pi],Ur=dt[pi],sn=It[pi],xs=bt[pi];if(ki===void 0)continue;ki.updateMatrix&&ki.updateMatrix();const yn=Le._createAnimationTracks(ki,An,Ur,sn,xs);if(yn)for(let Ls=0;Ls<yn.length;Ls++)Ut.push(yn[Ls])}return new h.AnimationClip(ke,void 0,Ut)})}createNodeMesh(ye){const ve=this.json,Le=this,Te=ve.nodes[ye];return Te.mesh===void 0?null:Le.getDependency("mesh",Te.mesh).then(function(ke){const Pe=Le._getNodeRef(Le.meshCache,Te.mesh,ke);return Te.weights!==void 0&&Pe.traverse(function(F){if(F.isMesh)for(let J=0,ie=Te.weights.length;J<ie;J++)F.morphTargetInfluences[J]=Te.weights[J]}),Pe})}loadNode(ye){const ve=this.json,Le=this,Te=ve.nodes[ye],ke=Le._loadNodeShallow(ye),Pe=[],F=Te.children||[];for(let ie=0,Re=F.length;ie<Re;ie++)Pe.push(Le.getDependency("node",F[ie]));const J=Te.skin===void 0?Promise.resolve(null):Le.getDependency("skin",Te.skin);return Promise.all([ke,Promise.all(Pe),J]).then(function(ie){const Re=ie[0],ce=ie[1],Ue=ie[2];Ue!==null&&Re.traverse(function(je){je.isSkinnedMesh&&je.bind(Ue,Ot)});for(let je=0,dt=ce.length;je<dt;je++)Re.add(ce[je]);return Re})}_loadNodeShallow(ye){const ve=this.json,Le=this.extensions,Te=this;if(this.nodeCache[ye]!==void 0)return this.nodeCache[ye];const ke=ve.nodes[ye],Pe=ke.name?Te.createUniqueName(ke.name):"",F=[],J=Te._invokeOne(function(ie){return ie.createNodeMesh&&ie.createNodeMesh(ye)});return J&&F.push(J),ke.camera!==void 0&&F.push(Te.getDependency("camera",ke.camera).then(function(ie){return Te._getNodeRef(Te.cameraCache,ke.camera,ie)})),Te._invokeAll(function(ie){return ie.createNodeAttachment&&ie.createNodeAttachment(ye)}).forEach(function(ie){F.push(ie)}),this.nodeCache[ye]=Promise.all(F).then(function(ie){let Re;if(ke.isBone===!0?Re=new h.Bone:ie.length>1?Re=new h.Group:ie.length===1?Re=ie[0]:Re=new h.Object3D,Re!==ie[0])for(let ce=0,Ue=ie.length;ce<Ue;ce++)Re.add(ie[ce]);if(ke.name&&(Re.userData.name=ke.name,Re.name=Pe),Ii(Re,ke),ke.extensions&&di(Le,Re,ke),ke.matrix!==void 0){const ce=new h.Matrix4;ce.fromArray(ke.matrix),Re.applyMatrix4(ce)}else ke.translation!==void 0&&Re.position.fromArray(ke.translation),ke.rotation!==void 0&&Re.quaternion.fromArray(ke.rotation),ke.scale!==void 0&&Re.scale.fromArray(ke.scale);return Te.associations.has(Re)||Te.associations.set(Re,{}),Te.associations.get(Re).nodes=ye,Re}),this.nodeCache[ye]}loadScene(ye){const ve=this.extensions,Le=this.json.scenes[ye],Te=this,ke=new h.Group;Le.name&&(ke.name=Te.createUniqueName(Le.name)),Ii(ke,Le),Le.extensions&&di(ve,ke,Le);const Pe=Le.nodes||[],F=[];for(let J=0,ie=Pe.length;J<ie;J++)F.push(Te.getDependency("node",Pe[J]));return Promise.all(F).then(function(J){for(let Re=0,ce=J.length;Re<ce;Re++)ke.add(J[Re]);const ie=Re=>{const ce=new Map;for(const[Ue,je]of Te.associations)(Ue instanceof h.Material||Ue instanceof h.Texture)&&ce.set(Ue,je);return Re.traverse(Ue=>{const je=Te.associations.get(Ue);je!=null&&ce.set(Ue,je)}),ce};return Te.associations=ie(ke),ke})}_createAnimationTracks(ye,ve,Le,Te,ke){const Pe=[],F=ye.name?ye.name:ye.uuid,J=[];gt[ke.path]===gt.weights?ye.traverse(function(Ue){Ue.morphTargetInfluences&&J.push(Ue.name?Ue.name:Ue.uuid)}):J.push(F);let ie;switch(gt[ke.path]){case gt.weights:ie=h.NumberKeyframeTrack;break;case gt.rotation:ie=h.QuaternionKeyframeTrack;break;case gt.position:case gt.scale:ie=h.VectorKeyframeTrack;break;default:switch(Le.itemSize){case 1:ie=h.NumberKeyframeTrack;break;case 2:case 3:default:ie=h.VectorKeyframeTrack;break}break}const Re=Te.interpolation!==void 0?xi[Te.interpolation]:h.InterpolateLinear,ce=this._getArrayFromAccessor(Le);for(let Ue=0,je=J.length;Ue<je;Ue++){const dt=new ie(J[Ue]+"."+gt[ke.path],ve.array,ce,Re);Te.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(dt),Pe.push(dt)}return Pe}_getArrayFromAccessor(ye){let ve=ye.array;if(ye.normalized){const Le=Ce(ve.constructor),Te=new Float32Array(ve.length);for(let ke=0,Pe=ve.length;ke<Pe;ke++)Te[ke]=ve[ke]*Le;ve=Te}return ve}_createCubicSplineTrackInterpolant(ye){ye.createInterpolant=function(ve){const Le=this instanceof h.QuaternionKeyframeTrack?Ie:fe;return new Le(this.times,this.values,this.getValueSize()/3,ve)},ye.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function zt(vt,ye,ve){const Le=ye.attributes,Te=new h.Box3;if(Le.POSITION!==void 0){const F=ve.json.accessors[Le.POSITION],J=F.min,ie=F.max;if(J!==void 0&&ie!==void 0){if(Te.set(new h.Vector3(J[0],J[1],J[2]),new h.Vector3(ie[0],ie[1],ie[2])),F.normalized){const Re=Ce(Xe[F.componentType]);Te.min.multiplyScalar(Re),Te.max.multiplyScalar(Re)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const ke=ye.targets;if(ke!==void 0){const F=new h.Vector3,J=new h.Vector3;for(let ie=0,Re=ke.length;ie<Re;ie++){const ce=ke[ie];if(ce.POSITION!==void 0){const Ue=ve.json.accessors[ce.POSITION],je=Ue.min,dt=Ue.max;if(je!==void 0&&dt!==void 0){if(J.setX(Math.max(Math.abs(je[0]),Math.abs(dt[0]))),J.setY(Math.max(Math.abs(je[1]),Math.abs(dt[1]))),J.setZ(Math.max(Math.abs(je[2]),Math.abs(dt[2]))),Ue.normalized){const It=Ce(Xe[Ue.componentType]);J.multiplyScalar(It)}F.max(J)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}Te.expandByVector(F)}vt.boundingBox=Te;const Pe=new h.Sphere;Te.getCenter(Pe.center),Pe.radius=Te.min.distanceTo(Te.max)/2,vt.boundingSphere=Pe}function _i(vt,ye,ve){const Le=ye.attributes,Te=[];function ke(Pe,F){return ve.getDependency("accessor",Pe).then(function(J){vt.setAttribute(F,J)})}for(const Pe in Le){const F=Gt[Pe]||Pe.toLowerCase();F in vt.attributes||Te.push(ke(Le[Pe],F))}if(ye.indices!==void 0&&!vt.index){const Pe=ve.getDependency("accessor",ye.indices).then(function(F){vt.setIndex(F)});Te.push(Pe)}return h.ColorManagement.workingColorSpace!==h.LinearSRGBColorSpace&&"COLOR_0"in Le&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${h.ColorManagement.workingColorSpace}" not supported.`),Ii(vt,ye),zt(vt,ye,ve),Promise.all(Te).then(function(){return ye.targets!==void 0?Ti(vt,ye.targets,ve):vt})}},"./node_modules/three/examples/jsm/loaders/KTX2Loader.js":(l,u,c)=>{c.r(u),c.d(u,{KTX2Loader:()=>v});var h=c("./node_modules/three/build/three.module.js"),p=c("./node_modules/three/examples/jsm/utils/WorkerPool.js"),f=c("./node_modules/three/examples/jsm/libs/ktx-parse.module.js"),m=c("./node_modules/three/examples/jsm/libs/zstddec.module.js");const g=new WeakMap;let y=0,x;class v extends h.Loader{constructor(I){super(I),this.transcoderPath="",this.transcoderBinary=null,this.transcoderPending=null,this.workerPool=new p.WorkerPool,this.workerSourceURL="",this.workerConfig=null,typeof MSC_TRANSCODER<"u"&&console.warn('THREE.KTX2Loader: Please update to latest "basis_transcoder". "msc_basis_transcoder" is no longer supported in three.js r125+.')}setTranscoderPath(I){return this.transcoderPath=I,this}setWorkerLimit(I){return this.workerPool.setWorkerLimit(I),this}async detectSupportAsync(I){return this.workerConfig={astcSupported:await I.hasFeatureAsync("texture-compression-astc"),etc1Supported:await I.hasFeatureAsync("texture-compression-etc1"),etc2Supported:await I.hasFeatureAsync("texture-compression-etc2"),dxtSupported:await I.hasFeatureAsync("texture-compression-bc"),bptcSupported:await I.hasFeatureAsync("texture-compression-bptc"),pvrtcSupported:await I.hasFeatureAsync("texture-compression-pvrtc")},this}detectSupport(I){return I.isWebGPURenderer===!0?this.workerConfig={astcSupported:I.hasFeature("texture-compression-astc"),etc1Supported:I.hasFeature("texture-compression-etc1"),etc2Supported:I.hasFeature("texture-compression-etc2"),dxtSupported:I.hasFeature("texture-compression-bc"),bptcSupported:I.hasFeature("texture-compression-bptc"),pvrtcSupported:I.hasFeature("texture-compression-pvrtc")}:this.workerConfig={astcSupported:I.extensions.has("WEBGL_compressed_texture_astc"),etc1Supported:I.extensions.has("WEBGL_compressed_texture_etc1"),etc2Supported:I.extensions.has("WEBGL_compressed_texture_etc"),dxtSupported:I.extensions.has("WEBGL_compressed_texture_s3tc"),bptcSupported:I.extensions.has("EXT_texture_compression_bptc"),pvrtcSupported:I.extensions.has("WEBGL_compressed_texture_pvrtc")||I.extensions.has("WEBKIT_WEBGL_compressed_texture_pvrtc")},this}init(){if(!this.transcoderPending){const I=new h.FileLoader(this.manager);I.setPath(this.transcoderPath),I.setWithCredentials(this.withCredentials);const D=I.loadAsync("basis_transcoder.js"),L=new h.FileLoader(this.manager);L.setPath(this.transcoderPath),L.setResponseType("arraybuffer"),L.setWithCredentials(this.withCredentials);const O=L.loadAsync("basis_transcoder.wasm");this.transcoderPending=Promise.all([D,O]).then(([U,Z])=>{const G=v.BasisWorker.toString(),z=["/* constants */","let _EngineFormat = "+JSON.stringify(v.EngineFormat),"let _TranscoderFormat = "+JSON.stringify(v.TranscoderFormat),"let _BasisFormat = "+JSON.stringify(v.BasisFormat),"/* basis_transcoder.js */",U,"/* worker */",G.substring(G.indexOf("{")+1,G.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([z])),this.transcoderBinary=Z,this.workerPool.setWorkerCreator(()=>{const $=new Worker(this.workerSourceURL),Q=this.transcoderBinary.slice(0);return $.postMessage({type:"init",config:this.workerConfig,transcoderBinary:Q},[Q]),$})}),y>0&&console.warn("THREE.KTX2Loader: Multiple active KTX2 loaders may cause performance issues. Use a single KTX2Loader instance, or call .dispose() on old instances."),y++}return this.transcoderPending}load(I,D,L,O){if(this.workerConfig===null)throw new Error("THREE.KTX2Loader: Missing initialization with `.detectSupport( renderer )`.");const U=new h.FileLoader(this.manager);U.setResponseType("arraybuffer"),U.setWithCredentials(this.withCredentials),U.load(I,Z=>{if(g.has(Z))return g.get(Z).promise.then(D).catch(O);this._createTexture(Z).then(G=>D?D(G):null).catch(O)},L,O)}_createTextureFrom(I,D){const{faces:L,width:O,height:U,format:Z,type:G,error:z,dfdFlags:$}=I;if(G==="error")return Promise.reject(z);let Q;if(D.faceCount===6)Q=new h.CompressedCubeTexture(L,Z,h.UnsignedByteType);else{const H=L[0].mipmaps;Q=D.layerCount>1?new h.CompressedArrayTexture(H,O,U,D.layerCount,Z,h.UnsignedByteType):new h.CompressedTexture(H,O,U,Z,h.UnsignedByteType)}return Q.minFilter=L[0].mipmaps.length===1?h.LinearFilter:h.LinearMipmapLinearFilter,Q.magFilter=h.LinearFilter,Q.generateMipmaps=!1,Q.needsUpdate=!0,Q.colorSpace=R(D),Q.premultiplyAlpha=!!($&f.KHR_DF_FLAG_ALPHA_PREMULTIPLIED),Q}async _createTexture(I,D={}){const L=(0,f.read)(new Uint8Array(I));if(L.vkFormat!==f.VK_FORMAT_UNDEFINED)return S(L);const O=D,U=this.init().then(()=>this.workerPool.postMessage({type:"transcode",buffer:I,taskConfig:O},[I])).then(Z=>this._createTextureFrom(Z.data,L));return g.set(I,{promise:U}),U}dispose(){return this.workerPool.dispose(),this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),y--,this}}v.BasisFormat={ETC1S:0,UASTC_4x4:1},v.TranscoderFormat={ETC1:0,ETC2:1,BC1:2,BC3:3,BC4:4,BC5:5,BC7_M6_OPAQUE_ONLY:6,BC7_M5:7,PVRTC1_4_RGB:8,PVRTC1_4_RGBA:9,ASTC_4x4:10,ATC_RGB:11,ATC_RGBA_INTERPOLATED_ALPHA:12,RGBA32:13,RGB565:14,BGR565:15,RGBA4444:16},v.EngineFormat={RGBAFormat:h.RGBAFormat,RGBA_ASTC_4x4_Format:h.RGBA_ASTC_4x4_Format,RGBA_BPTC_Format:h.RGBA_BPTC_Format,RGBA_ETC2_EAC_Format:h.RGBA_ETC2_EAC_Format,RGBA_PVRTC_4BPPV1_Format:h.RGBA_PVRTC_4BPPV1_Format,RGBA_S3TC_DXT5_Format:h.RGBA_S3TC_DXT5_Format,RGB_ETC1_Format:h.RGB_ETC1_Format,RGB_ETC2_Format:h.RGB_ETC2_Format,RGB_PVRTC_4BPPV1_Format:h.RGB_PVRTC_4BPPV1_Format,RGBA_S3TC_DXT1_Format:h.RGBA_S3TC_DXT1_Format},v.BasisWorker=function(){let B,I,D;const L=_EngineFormat,O=_TranscoderFormat,U=_BasisFormat;self.addEventListener("message",function(Y){const ae=Y.data;switch(ae.type){case"init":B=ae.config,Z(ae.transcoderBinary);break;case"transcode":I.then(()=>{try{const{faces:xe,buffers:fe,width:de,height:Ie,hasAlpha:Ge,format:Xe,dfdFlags:$e}=G(ae.buffer);self.postMessage({type:"transcode",id:ae.id,faces:xe,width:de,height:Ie,hasAlpha:Ge,format:Xe,dfdFlags:$e},fe)}catch(xe){console.error(xe),self.postMessage({type:"error",id:ae.id,error:xe.message})}});break}});function Z(Y){I=new Promise(ae=>{D={wasmBinary:Y,onRuntimeInitialized:ae},BASIS(D)}).then(()=>{D.initializeBasis(),D.KTX2File===void 0&&console.warn("THREE.KTX2Loader: Please update Basis Universal transcoder.")})}function G(Y){const ae=new D.KTX2File(new Uint8Array(Y));function xe(){ae.close(),ae.delete()}if(!ae.isValid())throw xe(),new Error("THREE.KTX2Loader:	Invalid or unsupported .ktx2 file");const fe=ae.isUASTC()?U.UASTC_4x4:U.ETC1S,de=ae.getWidth(),Ie=ae.getHeight(),Ge=ae.getLayers()||1,Xe=ae.getLevels(),$e=ae.getFaces(),lt=ae.getHasAlpha(),At=ae.getDFDFlags(),{transcoderFormat:Gt,engineFormat:gt}=H(fe,de,Ie,lt);if(!de||!Ie||!Xe)throw xe(),new Error("THREE.KTX2Loader:	Invalid texture");if(!ae.startTranscoding())throw xe(),new Error("THREE.KTX2Loader: .startTranscoding failed");const xi=[],Ze=[];for(let Ui=0;Ui<$e;Ui++){const di=[];for(let Ii=0;Ii<Xe;Ii++){const Ti=[];let ir,Gi;for(let Ce=0;Ce<Ge;Ce++){const yt=ae.getImageLevelInfo(Ii,Ce,Ui);Ui===0&&Ii===0&&Ce===0&&(yt.origWidth%4!==0||yt.origHeight%4!==0)&&console.warn("THREE.KTX2Loader: ETC1S and UASTC textures should use multiple-of-four dimensions."),Xe>1?(ir=yt.origWidth,Gi=yt.origHeight):(ir=yt.width,Gi=yt.height);const Ot=new Uint8Array(ae.getImageTranscodedSizeInBytes(Ii,Ce,0,Gt));if(!ae.transcodeImage(Ot,Ii,Ce,Ui,Gt,0,-1,-1))throw xe(),new Error("THREE.KTX2Loader: .transcodeImage failed.");Ti.push(Ot)}const Qe=ne(Ti);di.push({data:Qe,width:ir,height:Gi}),Ze.push(Qe.buffer)}xi.push({mipmaps:di,width:de,height:Ie,format:gt})}return xe(),{faces:xi,buffers:Ze,width:de,height:Ie,hasAlpha:lt,format:gt,dfdFlags:At}}const z=[{if:"astcSupported",basisFormat:[U.UASTC_4x4],transcoderFormat:[O.ASTC_4x4,O.ASTC_4x4],engineFormat:[L.RGBA_ASTC_4x4_Format,L.RGBA_ASTC_4x4_Format],priorityETC1S:1/0,priorityUASTC:1,needsPowerOfTwo:!1},{if:"bptcSupported",basisFormat:[U.ETC1S,U.UASTC_4x4],transcoderFormat:[O.BC7_M5,O.BC7_M5],engineFormat:[L.RGBA_BPTC_Format,L.RGBA_BPTC_Format],priorityETC1S:3,priorityUASTC:2,needsPowerOfTwo:!1},{if:"dxtSupported",basisFormat:[U.ETC1S,U.UASTC_4x4],transcoderFormat:[O.BC1,O.BC3],engineFormat:[L.RGBA_S3TC_DXT1_Format,L.RGBA_S3TC_DXT5_Format],priorityETC1S:4,priorityUASTC:5,needsPowerOfTwo:!1},{if:"etc2Supported",basisFormat:[U.ETC1S,U.UASTC_4x4],transcoderFormat:[O.ETC1,O.ETC2],engineFormat:[L.RGB_ETC2_Format,L.RGBA_ETC2_EAC_Format],priorityETC1S:1,priorityUASTC:3,needsPowerOfTwo:!1},{if:"etc1Supported",basisFormat:[U.ETC1S,U.UASTC_4x4],transcoderFormat:[O.ETC1],engineFormat:[L.RGB_ETC1_Format],priorityETC1S:2,priorityUASTC:4,needsPowerOfTwo:!1},{if:"pvrtcSupported",basisFormat:[U.ETC1S,U.UASTC_4x4],transcoderFormat:[O.PVRTC1_4_RGB,O.PVRTC1_4_RGBA],engineFormat:[L.RGB_PVRTC_4BPPV1_Format,L.RGBA_PVRTC_4BPPV1_Format],priorityETC1S:5,priorityUASTC:6,needsPowerOfTwo:!0}],$=z.sort(function(Y,ae){return Y.priorityETC1S-ae.priorityETC1S}),Q=z.sort(function(Y,ae){return Y.priorityUASTC-ae.priorityUASTC});function H(Y,ae,xe,fe){let de,Ie;const Ge=Y===U.ETC1S?$:Q;for(let Xe=0;Xe<Ge.length;Xe++){const $e=Ge[Xe];if(B[$e.if]&&$e.basisFormat.includes(Y)&&!(fe&&$e.transcoderFormat.length<2)&&!($e.needsPowerOfTwo&&!(V(ae)&&V(xe))))return de=$e.transcoderFormat[fe?1:0],Ie=$e.engineFormat[fe?1:0],{transcoderFormat:de,engineFormat:Ie}}return console.warn("THREE.KTX2Loader: No suitable compressed texture format found. Decoding to RGBA32."),de=O.RGBA32,Ie=L.RGBAFormat,{transcoderFormat:de,engineFormat:Ie}}function V(Y){return Y<=2?!0:(Y&Y-1)===0&&Y!==0}function ne(Y){if(Y.length===1)return Y[0];let ae=0;for(let de=0;de<Y.length;de++){const Ie=Y[de];ae+=Ie.byteLength}const xe=new Uint8Array(ae);let fe=0;for(let de=0;de<Y.length;de++){const Ie=Y[de];xe.set(Ie,fe),fe+=Ie.byteLength}return xe}};const _=new Set([h.RGBAFormat,h.RGFormat,h.RedFormat]),T={[f.VK_FORMAT_R32G32B32A32_SFLOAT]:h.RGBAFormat,[f.VK_FORMAT_R16G16B16A16_SFLOAT]:h.RGBAFormat,[f.VK_FORMAT_R8G8B8A8_UNORM]:h.RGBAFormat,[f.VK_FORMAT_R8G8B8A8_SRGB]:h.RGBAFormat,[f.VK_FORMAT_R32G32_SFLOAT]:h.RGFormat,[f.VK_FORMAT_R16G16_SFLOAT]:h.RGFormat,[f.VK_FORMAT_R8G8_UNORM]:h.RGFormat,[f.VK_FORMAT_R8G8_SRGB]:h.RGFormat,[f.VK_FORMAT_R32_SFLOAT]:h.RedFormat,[f.VK_FORMAT_R16_SFLOAT]:h.RedFormat,[f.VK_FORMAT_R8_SRGB]:h.RedFormat,[f.VK_FORMAT_R8_UNORM]:h.RedFormat,[f.VK_FORMAT_ASTC_6x6_SRGB_BLOCK]:h.RGBA_ASTC_6x6_Format,[f.VK_FORMAT_ASTC_6x6_UNORM_BLOCK]:h.RGBA_ASTC_6x6_Format},w={[f.VK_FORMAT_R32G32B32A32_SFLOAT]:h.FloatType,[f.VK_FORMAT_R16G16B16A16_SFLOAT]:h.HalfFloatType,[f.VK_FORMAT_R8G8B8A8_UNORM]:h.UnsignedByteType,[f.VK_FORMAT_R8G8B8A8_SRGB]:h.UnsignedByteType,[f.VK_FORMAT_R32G32_SFLOAT]:h.FloatType,[f.VK_FORMAT_R16G16_SFLOAT]:h.HalfFloatType,[f.VK_FORMAT_R8G8_UNORM]:h.UnsignedByteType,[f.VK_FORMAT_R8G8_SRGB]:h.UnsignedByteType,[f.VK_FORMAT_R32_SFLOAT]:h.FloatType,[f.VK_FORMAT_R16_SFLOAT]:h.HalfFloatType,[f.VK_FORMAT_R8_SRGB]:h.UnsignedByteType,[f.VK_FORMAT_R8_UNORM]:h.UnsignedByteType,[f.VK_FORMAT_ASTC_6x6_SRGB_BLOCK]:h.UnsignedByteType,[f.VK_FORMAT_ASTC_6x6_UNORM_BLOCK]:h.UnsignedByteType};async function S(B){const{vkFormat:I}=B;if(T[I]===void 0)throw new Error("THREE.KTX2Loader: Unsupported vkFormat.");let D;B.supercompressionScheme===f.KHR_SUPERCOMPRESSION_ZSTD&&(x||(x=new Promise(async U=>{const Z=new m.ZSTDDecoder;await Z.init(),U(Z)})),D=await x);const L=[];for(let U=0;U<B.levels.length;U++){const Z=Math.max(1,B.pixelWidth>>U),G=Math.max(1,B.pixelHeight>>U),z=B.pixelDepth?Math.max(1,B.pixelDepth>>U):0,$=B.levels[U];let Q;if(B.supercompressionScheme===f.KHR_SUPERCOMPRESSION_NONE)Q=$.levelData;else if(B.supercompressionScheme===f.KHR_SUPERCOMPRESSION_ZSTD)Q=D.decode($.levelData,$.uncompressedByteLength);else throw new Error("THREE.KTX2Loader: Unsupported supercompressionScheme.");let H;w[I]===h.FloatType?H=new Float32Array(Q.buffer,Q.byteOffset,Q.byteLength/Float32Array.BYTES_PER_ELEMENT):w[I]===h.HalfFloatType?H=new Uint16Array(Q.buffer,Q.byteOffset,Q.byteLength/Uint16Array.BYTES_PER_ELEMENT):H=Q,L.push({data:H,width:Z,height:G,depth:z})}let O;if(_.has(T[I]))O=B.pixelDepth===0?new h.DataTexture(L[0].data,B.pixelWidth,B.pixelHeight):new h.Data3DTexture(L[0].data,B.pixelWidth,B.pixelHeight,B.pixelDepth);else{if(B.pixelDepth>0)throw new Error("THREE.KTX2Loader: Unsupported pixelDepth.");O=new h.CompressedTexture(L,B.pixelWidth,B.pixelHeight)}return O.mipmaps=L,O.type=w[I],O.format=T[I],O.colorSpace=R(B),O.needsUpdate=!0,Promise.resolve(O)}function R(B){const I=B.dataFormatDescriptor[0];return I.colorPrimaries===f.KHR_DF_PRIMARIES_BT709?I.transferFunction===f.KHR_DF_TRANSFER_SRGB?h.SRGBColorSpace:h.LinearSRGBColorSpace:I.colorPrimaries===f.KHR_DF_PRIMARIES_DISPLAYP3?I.transferFunction===f.KHR_DF_TRANSFER_SRGB?h.DisplayP3ColorSpace:h.LinearDisplayP3ColorSpace:(I.colorPrimaries===f.KHR_DF_PRIMARIES_UNSPECIFIED||console.warn(`THREE.KTX2Loader: Unsupported color primaries, "${I.colorPrimaries}"`),h.NoColorSpace)}},"./node_modules/three/examples/jsm/loaders/MTLLoader.js":(l,u,c)=>{c.r(u),c.d(u,{MTLLoader:()=>p});var h=c("./node_modules/three/build/three.module.js");class p extends h.Loader{constructor(g){super(g)}load(g,y,x,v){const _=this,T=this.path===""?h.LoaderUtils.extractUrlBase(g):this.path,w=new h.FileLoader(this.manager);w.setPath(this.path),w.setRequestHeader(this.requestHeader),w.setWithCredentials(this.withCredentials),w.load(g,function(S){try{y(_.parse(S,T))}catch(R){v?v(R):console.error(R),_.manager.itemError(g)}},x,v)}setMaterialOptions(g){return this.materialOptions=g,this}parse(g,y){const x=g.split(`
`);let v={};const _=/\s+/,T={};for(let S=0;S<x.length;S++){let R=x[S];if(R=R.trim(),R.length===0||R.charAt(0)==="#")continue;const B=R.indexOf(" ");let I=B>=0?R.substring(0,B):R;I=I.toLowerCase();let D=B>=0?R.substring(B+1):"";if(D=D.trim(),I==="newmtl")v={name:D},T[D]=v;else if(I==="ka"||I==="kd"||I==="ks"||I==="ke"){const L=D.split(_,3);v[I]=[parseFloat(L[0]),parseFloat(L[1]),parseFloat(L[2])]}else v[I]=D}const w=new f(this.resourcePath||y,this.materialOptions);return w.setCrossOrigin(this.crossOrigin),w.setManager(this.manager),w.setMaterials(T),w}}class f{constructor(g="",y={}){this.baseUrl=g,this.options=y,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.crossOrigin="anonymous",this.side=this.options.side!==void 0?this.options.side:h.FrontSide,this.wrap=this.options.wrap!==void 0?this.options.wrap:h.RepeatWrapping}setCrossOrigin(g){return this.crossOrigin=g,this}setManager(g){this.manager=g}setMaterials(g){this.materialsInfo=this.convert(g),this.materials={},this.materialsArray=[],this.nameLookup={}}convert(g){if(!this.options)return g;const y={};for(const x in g){const v=g[x],_={};y[x]=_;for(const T in v){let w=!0,S=v[T];const R=T.toLowerCase();switch(R){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(S=[S[0]/255,S[1]/255,S[2]/255]),this.options&&this.options.ignoreZeroRGBs&&S[0]===0&&S[1]===0&&S[2]===0&&(w=!1);break}w&&(_[R]=S)}}return y}preload(){for(const g in this.materialsInfo)this.create(g)}getIndex(g){return this.nameLookup[g]}getAsArray(){let g=0;for(const y in this.materialsInfo)this.materialsArray[g]=this.create(y),this.nameLookup[y]=g,g++;return this.materialsArray}create(g){return this.materials[g]===void 0&&this.createMaterial_(g),this.materials[g]}createMaterial_(g){const y=this,x=this.materialsInfo[g],v={name:g,side:this.side};function _(w,S){return typeof S!="string"||S===""?"":/^https?:\/\//i.test(S)?S:w+S}function T(w,S){if(v[w])return;const R=y.getTextureParams(S,v),B=y.loadTexture(_(y.baseUrl,R.url));B.repeat.copy(R.scale),B.offset.copy(R.offset),B.wrapS=y.wrap,B.wrapT=y.wrap,(w==="map"||w==="emissiveMap")&&(B.colorSpace=h.SRGBColorSpace),v[w]=B}for(const w in x){const S=x[w];let R;if(S!=="")switch(w.toLowerCase()){case"kd":v.color=new h.Color().fromArray(S).convertSRGBToLinear();break;case"ks":v.specular=new h.Color().fromArray(S).convertSRGBToLinear();break;case"ke":v.emissive=new h.Color().fromArray(S).convertSRGBToLinear();break;case"map_kd":T("map",S);break;case"map_ks":T("specularMap",S);break;case"map_ke":T("emissiveMap",S);break;case"norm":T("normalMap",S);break;case"map_bump":case"bump":T("bumpMap",S);break;case"map_d":T("alphaMap",S),v.transparent=!0;break;case"ns":v.shininess=parseFloat(S);break;case"d":R=parseFloat(S),R<1&&(v.opacity=R,v.transparent=!0);break;case"tr":R=parseFloat(S),this.options&&this.options.invertTrProperty&&(R=1-R),R>0&&(v.opacity=1-R,v.transparent=!0);break}}return this.materials[g]=new h.MeshPhongMaterial(v),this.materials[g]}getTextureParams(g,y){const x={scale:new h.Vector2(1,1),offset:new h.Vector2(0,0)},v=g.split(/\s+/);let _;return _=v.indexOf("-bm"),_>=0&&(y.bumpScale=parseFloat(v[_+1]),v.splice(_,2)),_=v.indexOf("-s"),_>=0&&(x.scale.set(parseFloat(v[_+1]),parseFloat(v[_+2])),v.splice(_,4)),_=v.indexOf("-o"),_>=0&&(x.offset.set(parseFloat(v[_+1]),parseFloat(v[_+2])),v.splice(_,4)),x.url=v.join(" ").trim(),x}loadTexture(g,y,x,v,_){const T=this.manager!==void 0?this.manager:h.DefaultLoadingManager;let w=T.getHandler(g);w===null&&(w=new h.TextureLoader(T)),w.setCrossOrigin&&w.setCrossOrigin(this.crossOrigin);const S=w.load(g,x,v,_);return y!==void 0&&(S.mapping=y),S}}},"./node_modules/three/examples/jsm/loaders/OBJLoader.js":(l,u,c)=>{c.r(u),c.d(u,{OBJLoader:()=>B});var h=c("./node_modules/three/build/three.module.js");const p=/^[og]\s*(.+)?/,f=/^mtllib /,m=/^usemtl /,g=/^usemap /,y=/\s+/,x=new h.Vector3,v=new h.Vector3,_=new h.Vector3,T=new h.Vector3,w=new h.Vector3,S=new h.Color;function R(){const I={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(D,L){if(this.object&&this.object.fromDeclaration===!1){this.object.name=D,this.object.fromDeclaration=L!==!1;return}const O=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:D||"",fromDeclaration:L!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(U,Z){const G=this._finalize(!1);G&&(G.inherited||G.groupCount<=0)&&this.materials.splice(G.index,1);const z={index:this.materials.length,name:U||"",mtllib:Array.isArray(Z)&&Z.length>0?Z[Z.length-1]:"",smooth:G!==void 0?G.smooth:this.smooth,groupStart:G!==void 0?G.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function($){const Q={index:typeof $=="number"?$:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return Q.clone=this.clone.bind(Q),Q}};return this.materials.push(z),z},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(U){const Z=this.currentMaterial();if(Z&&Z.groupEnd===-1&&(Z.groupEnd=this.geometry.vertices.length/3,Z.groupCount=Z.groupEnd-Z.groupStart,Z.inherited=!1),U&&this.materials.length>1)for(let G=this.materials.length-1;G>=0;G--)this.materials[G].groupCount<=0&&this.materials.splice(G,1);return U&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),Z}},O&&O.name&&typeof O.clone=="function"){const U=O.clone(0);U.inherited=!0,this.object.materials.push(U)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(D,L){const O=parseInt(D,10);return(O>=0?O-1:O+L/3)*3},parseNormalIndex:function(D,L){const O=parseInt(D,10);return(O>=0?O-1:O+L/3)*3},parseUVIndex:function(D,L){const O=parseInt(D,10);return(O>=0?O-1:O+L/2)*2},addVertex:function(D,L,O){const U=this.vertices,Z=this.object.geometry.vertices;Z.push(U[D+0],U[D+1],U[D+2]),Z.push(U[L+0],U[L+1],U[L+2]),Z.push(U[O+0],U[O+1],U[O+2])},addVertexPoint:function(D){const L=this.vertices;this.object.geometry.vertices.push(L[D+0],L[D+1],L[D+2])},addVertexLine:function(D){const L=this.vertices;this.object.geometry.vertices.push(L[D+0],L[D+1],L[D+2])},addNormal:function(D,L,O){const U=this.normals,Z=this.object.geometry.normals;Z.push(U[D+0],U[D+1],U[D+2]),Z.push(U[L+0],U[L+1],U[L+2]),Z.push(U[O+0],U[O+1],U[O+2])},addFaceNormal:function(D,L,O){const U=this.vertices,Z=this.object.geometry.normals;x.fromArray(U,D),v.fromArray(U,L),_.fromArray(U,O),w.subVectors(_,v),T.subVectors(x,v),w.cross(T),w.normalize(),Z.push(w.x,w.y,w.z),Z.push(w.x,w.y,w.z),Z.push(w.x,w.y,w.z)},addColor:function(D,L,O){const U=this.colors,Z=this.object.geometry.colors;U[D]!==void 0&&Z.push(U[D+0],U[D+1],U[D+2]),U[L]!==void 0&&Z.push(U[L+0],U[L+1],U[L+2]),U[O]!==void 0&&Z.push(U[O+0],U[O+1],U[O+2])},addUV:function(D,L,O){const U=this.uvs,Z=this.object.geometry.uvs;Z.push(U[D+0],U[D+1]),Z.push(U[L+0],U[L+1]),Z.push(U[O+0],U[O+1])},addDefaultUV:function(){const D=this.object.geometry.uvs;D.push(0,0),D.push(0,0),D.push(0,0)},addUVLine:function(D){const L=this.uvs;this.object.geometry.uvs.push(L[D+0],L[D+1])},addFace:function(D,L,O,U,Z,G,z,$,Q){const H=this.vertices.length;let V=this.parseVertexIndex(D,H),ne=this.parseVertexIndex(L,H),Y=this.parseVertexIndex(O,H);if(this.addVertex(V,ne,Y),this.addColor(V,ne,Y),z!==void 0&&z!==""){const ae=this.normals.length;V=this.parseNormalIndex(z,ae),ne=this.parseNormalIndex($,ae),Y=this.parseNormalIndex(Q,ae),this.addNormal(V,ne,Y)}else this.addFaceNormal(V,ne,Y);if(U!==void 0&&U!==""){const ae=this.uvs.length;V=this.parseUVIndex(U,ae),ne=this.parseUVIndex(Z,ae),Y=this.parseUVIndex(G,ae),this.addUV(V,ne,Y),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(D){this.object.geometry.type="Points";const L=this.vertices.length;for(let O=0,U=D.length;O<U;O++){const Z=this.parseVertexIndex(D[O],L);this.addVertexPoint(Z),this.addColor(Z)}},addLineGeometry:function(D,L){this.object.geometry.type="Line";const O=this.vertices.length,U=this.uvs.length;for(let Z=0,G=D.length;Z<G;Z++)this.addVertexLine(this.parseVertexIndex(D[Z],O));for(let Z=0,G=L.length;Z<G;Z++)this.addUVLine(this.parseUVIndex(L[Z],U))}};return I.startObject("",!1),I}class B extends h.Loader{constructor(D){super(D),this.materials=null}load(D,L,O,U){const Z=this,G=new h.FileLoader(this.manager);G.setPath(this.path),G.setRequestHeader(this.requestHeader),G.setWithCredentials(this.withCredentials),G.load(D,function(z){try{L(Z.parse(z))}catch($){U?U($):console.error($),Z.manager.itemError(D)}},O,U)}setMaterials(D){return this.materials=D,this}parse(D){const L=new R;D.indexOf(`\r
`)!==-1&&(D=D.replace(/\r\n/g,`
`)),D.indexOf(`\\
`)!==-1&&(D=D.replace(/\\\n/g,""));const O=D.split(`
`);let U=[];for(let G=0,z=O.length;G<z;G++){const $=O[G].trimStart();if($.length===0)continue;const Q=$.charAt(0);if(Q!=="#")if(Q==="v"){const H=$.split(y);switch(H[0]){case"v":L.vertices.push(parseFloat(H[1]),parseFloat(H[2]),parseFloat(H[3])),H.length>=7?(S.setRGB(parseFloat(H[4]),parseFloat(H[5]),parseFloat(H[6])).convertSRGBToLinear(),L.colors.push(S.r,S.g,S.b)):L.colors.push(void 0,void 0,void 0);break;case"vn":L.normals.push(parseFloat(H[1]),parseFloat(H[2]),parseFloat(H[3]));break;case"vt":L.uvs.push(parseFloat(H[1]),parseFloat(H[2]));break}}else if(Q==="f"){const H=$.slice(1).trim().split(y),V=[];for(let Y=0,ae=H.length;Y<ae;Y++){const xe=H[Y];if(xe.length>0){const fe=xe.split("/");V.push(fe)}}const ne=V[0];for(let Y=1,ae=V.length-1;Y<ae;Y++){const xe=V[Y],fe=V[Y+1];L.addFace(ne[0],xe[0],fe[0],ne[1],xe[1],fe[1],ne[2],xe[2],fe[2])}}else if(Q==="l"){const H=$.substring(1).trim().split(" ");let V=[];const ne=[];if($.indexOf("/")===-1)V=H;else for(let Y=0,ae=H.length;Y<ae;Y++){const xe=H[Y].split("/");xe[0]!==""&&V.push(xe[0]),xe[1]!==""&&ne.push(xe[1])}L.addLineGeometry(V,ne)}else if(Q==="p"){const H=$.slice(1).trim().split(" ");L.addPointGeometry(H)}else if((U=p.exec($))!==null){const H=(" "+U[0].slice(1).trim()).slice(1);L.startObject(H)}else if(m.test($))L.object.startMaterial($.substring(7).trim(),L.materialLibraries);else if(f.test($))L.materialLibraries.push($.substring(7).trim());else if(g.test($))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(Q==="s"){if(U=$.split(" "),U.length>1){const V=U[1].trim().toLowerCase();L.object.smooth=V!=="0"&&V!=="off"}else L.object.smooth=!0;const H=L.object.currentMaterial();H&&(H.smooth=L.object.smooth)}else{if($==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+$+'"')}}L.finalize();const Z=new h.Group;if(Z.materialLibraries=[].concat(L.materialLibraries),!(L.objects.length===1&&L.objects[0].geometry.vertices.length===0))for(let G=0,z=L.objects.length;G<z;G++){const $=L.objects[G],Q=$.geometry,H=$.materials,V=Q.type==="Line",ne=Q.type==="Points";let Y=!1;if(Q.vertices.length===0)continue;const ae=new h.BufferGeometry;ae.setAttribute("position",new h.Float32BufferAttribute(Q.vertices,3)),Q.normals.length>0&&ae.setAttribute("normal",new h.Float32BufferAttribute(Q.normals,3)),Q.colors.length>0&&(Y=!0,ae.setAttribute("color",new h.Float32BufferAttribute(Q.colors,3))),Q.hasUVIndices===!0&&ae.setAttribute("uv",new h.Float32BufferAttribute(Q.uvs,2));const xe=[];for(let de=0,Ie=H.length;de<Ie;de++){const Ge=H[de],Xe=Ge.name+"_"+Ge.smooth+"_"+Y;let $e=L.materials[Xe];if(this.materials!==null){if($e=this.materials.create(Ge.name),V&&$e&&!($e instanceof h.LineBasicMaterial)){const lt=new h.LineBasicMaterial;h.Material.prototype.copy.call(lt,$e),lt.color.copy($e.color),$e=lt}else if(ne&&$e&&!($e instanceof h.PointsMaterial)){const lt=new h.PointsMaterial({size:10,sizeAttenuation:!1});h.Material.prototype.copy.call(lt,$e),lt.color.copy($e.color),lt.map=$e.map,$e=lt}}$e===void 0&&(V?$e=new h.LineBasicMaterial:ne?$e=new h.PointsMaterial({size:1,sizeAttenuation:!1}):$e=new h.MeshPhongMaterial,$e.name=Ge.name,$e.flatShading=!Ge.smooth,$e.vertexColors=Y,L.materials[Xe]=$e),xe.push($e)}let fe;if(xe.length>1){for(let de=0,Ie=H.length;de<Ie;de++){const Ge=H[de];ae.addGroup(Ge.groupStart,Ge.groupCount,de)}V?fe=new h.LineSegments(ae,xe):ne?fe=new h.Points(ae,xe):fe=new h.Mesh(ae,xe)}else V?fe=new h.LineSegments(ae,xe[0]):ne?fe=new h.Points(ae,xe[0]):fe=new h.Mesh(ae,xe[0]);fe.name=$.name,Z.add(fe)}else if(L.vertices.length>0){const G=new h.PointsMaterial({size:1,sizeAttenuation:!1}),z=new h.BufferGeometry;z.setAttribute("position",new h.Float32BufferAttribute(L.vertices,3)),L.colors.length>0&&L.colors[0]!==void 0&&(z.setAttribute("color",new h.Float32BufferAttribute(L.colors,3)),G.vertexColors=!0);const $=new h.Points(z,G);Z.add($)}return Z}}},"./node_modules/three/examples/jsm/math/OBB.js":(l,u,c)=>{c.r(u),c.d(u,{OBB:()=>O});var h=c("./node_modules/three/build/three.module.js");const p={c:null,u:[new h.Vector3,new h.Vector3,new h.Vector3],e:[]},f={c:null,u:[new h.Vector3,new h.Vector3,new h.Vector3],e:[]},m=[[],[],[]],g=[[],[],[]],y=[],x=new h.Vector3,v=new h.Vector3,_=new h.Vector3,T=new h.Vector3,w=new h.Vector3,S=new h.Vector3,R=new h.Matrix3,B=new h.Box3,I=new h.Matrix4,D=new h.Matrix4,L=new h.Ray;class O{constructor(G=new h.Vector3,z=new h.Vector3,$=new h.Matrix3){this.center=G,this.halfSize=z,this.rotation=$}set(G,z,$){return this.center=G,this.halfSize=z,this.rotation=$,this}copy(G){return this.center.copy(G.center),this.halfSize.copy(G.halfSize),this.rotation.copy(G.rotation),this}clone(){return new this.constructor().copy(this)}getSize(G){return G.copy(this.halfSize).multiplyScalar(2)}clampPoint(G,z){const $=this.halfSize;T.subVectors(G,this.center),this.rotation.extractBasis(x,v,_),z.copy(this.center);const Q=h.MathUtils.clamp(T.dot(x),-$.x,$.x);z.add(x.multiplyScalar(Q));const H=h.MathUtils.clamp(T.dot(v),-$.y,$.y);z.add(v.multiplyScalar(H));const V=h.MathUtils.clamp(T.dot(_),-$.z,$.z);return z.add(_.multiplyScalar(V)),z}containsPoint(G){return T.subVectors(G,this.center),this.rotation.extractBasis(x,v,_),Math.abs(T.dot(x))<=this.halfSize.x&&Math.abs(T.dot(v))<=this.halfSize.y&&Math.abs(T.dot(_))<=this.halfSize.z}intersectsBox3(G){return this.intersectsOBB(U.fromBox3(G))}intersectsSphere(G){return this.clampPoint(G.center,S),S.distanceToSquared(G.center)<=G.radius*G.radius}intersectsOBB(G,z=Number.EPSILON){p.c=this.center,p.e[0]=this.halfSize.x,p.e[1]=this.halfSize.y,p.e[2]=this.halfSize.z,this.rotation.extractBasis(p.u[0],p.u[1],p.u[2]),f.c=G.center,f.e[0]=G.halfSize.x,f.e[1]=G.halfSize.y,f.e[2]=G.halfSize.z,G.rotation.extractBasis(f.u[0],f.u[1],f.u[2]);for(let H=0;H<3;H++)for(let V=0;V<3;V++)m[H][V]=p.u[H].dot(f.u[V]);T.subVectors(f.c,p.c),y[0]=T.dot(p.u[0]),y[1]=T.dot(p.u[1]),y[2]=T.dot(p.u[2]);for(let H=0;H<3;H++)for(let V=0;V<3;V++)g[H][V]=Math.abs(m[H][V])+z;let $,Q;for(let H=0;H<3;H++)if($=p.e[H],Q=f.e[0]*g[H][0]+f.e[1]*g[H][1]+f.e[2]*g[H][2],Math.abs(y[H])>$+Q)return!1;for(let H=0;H<3;H++)if($=p.e[0]*g[0][H]+p.e[1]*g[1][H]+p.e[2]*g[2][H],Q=f.e[H],Math.abs(y[0]*m[0][H]+y[1]*m[1][H]+y[2]*m[2][H])>$+Q)return!1;return $=p.e[1]*g[2][0]+p.e[2]*g[1][0],Q=f.e[1]*g[0][2]+f.e[2]*g[0][1],!(Math.abs(y[2]*m[1][0]-y[1]*m[2][0])>$+Q||($=p.e[1]*g[2][1]+p.e[2]*g[1][1],Q=f.e[0]*g[0][2]+f.e[2]*g[0][0],Math.abs(y[2]*m[1][1]-y[1]*m[2][1])>$+Q)||($=p.e[1]*g[2][2]+p.e[2]*g[1][2],Q=f.e[0]*g[0][1]+f.e[1]*g[0][0],Math.abs(y[2]*m[1][2]-y[1]*m[2][2])>$+Q)||($=p.e[0]*g[2][0]+p.e[2]*g[0][0],Q=f.e[1]*g[1][2]+f.e[2]*g[1][1],Math.abs(y[0]*m[2][0]-y[2]*m[0][0])>$+Q)||($=p.e[0]*g[2][1]+p.e[2]*g[0][1],Q=f.e[0]*g[1][2]+f.e[2]*g[1][0],Math.abs(y[0]*m[2][1]-y[2]*m[0][1])>$+Q)||($=p.e[0]*g[2][2]+p.e[2]*g[0][2],Q=f.e[0]*g[1][1]+f.e[1]*g[1][0],Math.abs(y[0]*m[2][2]-y[2]*m[0][2])>$+Q)||($=p.e[0]*g[1][0]+p.e[1]*g[0][0],Q=f.e[1]*g[2][2]+f.e[2]*g[2][1],Math.abs(y[1]*m[0][0]-y[0]*m[1][0])>$+Q)||($=p.e[0]*g[1][1]+p.e[1]*g[0][1],Q=f.e[0]*g[2][2]+f.e[2]*g[2][0],Math.abs(y[1]*m[0][1]-y[0]*m[1][1])>$+Q)||($=p.e[0]*g[1][2]+p.e[1]*g[0][2],Q=f.e[0]*g[2][1]+f.e[1]*g[2][0],Math.abs(y[1]*m[0][2]-y[0]*m[1][2])>$+Q))}intersectsPlane(G){this.rotation.extractBasis(x,v,_);const z=this.halfSize.x*Math.abs(G.normal.dot(x))+this.halfSize.y*Math.abs(G.normal.dot(v))+this.halfSize.z*Math.abs(G.normal.dot(_)),$=G.normal.dot(this.center)-G.constant;return Math.abs($)<=z}intersectRay(G,z){return this.getSize(w),B.setFromCenterAndSize(T.set(0,0,0),w),I.setFromMatrix3(this.rotation),I.setPosition(this.center),D.copy(I).invert(),L.copy(G).applyMatrix4(D),L.intersectBox(B,z)?z.applyMatrix4(I):null}intersectsRay(G){return this.intersectRay(G,T)!==null}fromBox3(G){return G.getCenter(this.center),G.getSize(this.halfSize).multiplyScalar(.5),this.rotation.identity(),this}equals(G){return G.center.equals(this.center)&&G.halfSize.equals(this.halfSize)&&G.rotation.equals(this.rotation)}applyMatrix4(G){const z=G.elements;let $=T.set(z[0],z[1],z[2]).length();const Q=T.set(z[4],z[5],z[6]).length(),H=T.set(z[8],z[9],z[10]).length();G.determinant()<0&&($=-$),R.setFromMatrix4(G);const V=1/$,ne=1/Q,Y=1/H;return R.elements[0]*=V,R.elements[1]*=V,R.elements[2]*=V,R.elements[3]*=ne,R.elements[4]*=ne,R.elements[5]*=ne,R.elements[6]*=Y,R.elements[7]*=Y,R.elements[8]*=Y,this.rotation.multiply(R),this.halfSize.x*=$,this.halfSize.y*=Q,this.halfSize.z*=H,T.setFromMatrixPosition(G),this.center.add(T),this}}const U=new O},"./node_modules/three/examples/jsm/utils/BufferGeometryUtils.js":(l,u,c)=>{c.r(u),c.d(u,{computeMikkTSpaceTangents:()=>p,computeMorphedAttributes:()=>S,deepCloneAttribute:()=>g,deinterleaveAttribute:()=>x,deinterleaveGeometry:()=>v,estimateBytesUsed:()=>_,interleaveAttributes:()=>y,mergeAttributes:()=>m,mergeGeometries:()=>f,mergeGroups:()=>R,mergeVertices:()=>T,toCreasedNormals:()=>B,toTrianglesDrawMode:()=>w});var h=c("./node_modules/three/build/three.module.js");function p(I,D,L=!0){if(!D||!D.isReady)throw new Error("BufferGeometryUtils: Initialized MikkTSpace library required.");if(!I.hasAttribute("position")||!I.hasAttribute("normal")||!I.hasAttribute("uv"))throw new Error('BufferGeometryUtils: Tangents require "position", "normal", and "uv" attributes.');function O(G){if(G.normalized||G.isInterleavedBufferAttribute){const z=new Float32Array(G.count*G.itemSize);for(let $=0,Q=0;$<G.count;$++)z[Q++]=G.getX($),z[Q++]=G.getY($),G.itemSize>2&&(z[Q++]=G.getZ($));return z}return G.array instanceof Float32Array?G.array:new Float32Array(G.array)}const U=I.index?I.toNonIndexed():I,Z=D.generateTangents(O(U.attributes.position),O(U.attributes.normal),O(U.attributes.uv));if(L)for(let G=3;G<Z.length;G+=4)Z[G]*=-1;return U.setAttribute("tangent",new h.BufferAttribute(Z,4)),I!==U&&I.copy(U),I}function f(I,D=!1){const L=I[0].index!==null,O=new Set(Object.keys(I[0].attributes)),U=new Set(Object.keys(I[0].morphAttributes)),Z={},G={},z=I[0].morphTargetsRelative,$=new h.BufferGeometry;let Q=0;for(let H=0;H<I.length;++H){const V=I[H];let ne=0;if(L!==(V.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+H+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const Y in V.attributes){if(!O.has(Y))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+H+'. All geometries must have compatible attributes; make sure "'+Y+'" attribute exists among all geometries, or in none of them.'),null;Z[Y]===void 0&&(Z[Y]=[]),Z[Y].push(V.attributes[Y]),ne++}if(ne!==O.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+H+". Make sure all geometries have the same number of attributes."),null;if(z!==V.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+H+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const Y in V.morphAttributes){if(!U.has(Y))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+H+".  .morphAttributes must be consistent throughout all geometries."),null;G[Y]===void 0&&(G[Y]=[]),G[Y].push(V.morphAttributes[Y])}if(D){let Y;if(L)Y=V.index.count;else if(V.attributes.position!==void 0)Y=V.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+H+". The geometry must have either an index or a position attribute"),null;$.addGroup(Q,Y,H),Q+=Y}}if(L){let H=0;const V=[];for(let ne=0;ne<I.length;++ne){const Y=I[ne].index;for(let ae=0;ae<Y.count;++ae)V.push(Y.getX(ae)+H);H+=I[ne].attributes.position.count}$.setIndex(V)}for(const H in Z){const V=m(Z[H]);if(!V)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+H+" attribute."),null;$.setAttribute(H,V)}for(const H in G){const V=G[H][0].length;if(V===0)break;$.morphAttributes=$.morphAttributes||{},$.morphAttributes[H]=[];for(let ne=0;ne<V;++ne){const Y=[];for(let xe=0;xe<G[H].length;++xe)Y.push(G[H][xe][ne]);const ae=m(Y);if(!ae)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+H+" morphAttribute."),null;$.morphAttributes[H].push(ae)}}return $}function m(I){let D,L,O,U=-1,Z=0;for(let Q=0;Q<I.length;++Q){const H=I[Q];if(D===void 0&&(D=H.array.constructor),D!==H.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(L===void 0&&(L=H.itemSize),L!==H.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(O===void 0&&(O=H.normalized),O!==H.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(U===-1&&(U=H.gpuType),U!==H.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;Z+=H.count*L}const G=new D(Z),z=new h.BufferAttribute(G,L,O);let $=0;for(let Q=0;Q<I.length;++Q){const H=I[Q];if(H.isInterleavedBufferAttribute){const V=$/L;for(let ne=0,Y=H.count;ne<Y;ne++)for(let ae=0;ae<L;ae++){const xe=H.getComponent(ne,ae);z.setComponent(ne+V,ae,xe)}}else G.set(H.array,$);$+=H.count*L}return U!==void 0&&(z.gpuType=U),z}function g(I){return I.isInstancedInterleavedBufferAttribute||I.isInterleavedBufferAttribute?x(I):I.isInstancedBufferAttribute?new h.InstancedBufferAttribute().copy(I):new h.BufferAttribute().copy(I)}function y(I){let D,L=0,O=0;for(let Q=0,H=I.length;Q<H;++Q){const V=I[Q];if(D===void 0&&(D=V.array.constructor),D!==V.array.constructor)return console.error("AttributeBuffers of different types cannot be interleaved"),null;L+=V.array.length,O+=V.itemSize}const U=new h.InterleavedBuffer(new D(L),O);let Z=0;const G=[],z=["getX","getY","getZ","getW"],$=["setX","setY","setZ","setW"];for(let Q=0,H=I.length;Q<H;Q++){const V=I[Q],ne=V.itemSize,Y=V.count,ae=new h.InterleavedBufferAttribute(U,ne,Z,V.normalized);G.push(ae),Z+=ne;for(let xe=0;xe<Y;xe++)for(let fe=0;fe<ne;fe++)ae[$[fe]](xe,V[z[fe]](xe))}return G}function x(I){const D=I.data.array.constructor,L=I.count,O=I.itemSize,U=I.normalized,Z=new D(L*O);let G;I.isInstancedInterleavedBufferAttribute?G=new h.InstancedBufferAttribute(Z,O,U,I.meshPerAttribute):G=new h.BufferAttribute(Z,O,U);for(let z=0;z<L;z++)G.setX(z,I.getX(z)),O>=2&&G.setY(z,I.getY(z)),O>=3&&G.setZ(z,I.getZ(z)),O>=4&&G.setW(z,I.getW(z));return G}function v(I){const D=I.attributes,L=I.morphTargets,O=new Map;for(const U in D){const Z=D[U];Z.isInterleavedBufferAttribute&&(O.has(Z)||O.set(Z,x(Z)),D[U]=O.get(Z))}for(const U in L){const Z=L[U];Z.isInterleavedBufferAttribute&&(O.has(Z)||O.set(Z,x(Z)),L[U]=O.get(Z))}}function _(I){let D=0;for(const O in I.attributes){const U=I.getAttribute(O);D+=U.count*U.itemSize*U.array.BYTES_PER_ELEMENT}const L=I.getIndex();return D+=L?L.count*L.itemSize*L.array.BYTES_PER_ELEMENT:0,D}function T(I,D=1e-4){D=Math.max(D,Number.EPSILON);const L={},O=I.getIndex(),U=I.getAttribute("position"),Z=O?O.count:U.count;let G=0;const z=Object.keys(I.attributes),$={},Q={},H=[],V=["getX","getY","getZ","getW"],ne=["setX","setY","setZ","setW"];for(let Ie=0,Ge=z.length;Ie<Ge;Ie++){const Xe=z[Ie],$e=I.attributes[Xe];$[Xe]=new h.BufferAttribute(new $e.array.constructor($e.count*$e.itemSize),$e.itemSize,$e.normalized);const lt=I.morphAttributes[Xe];lt&&(Q[Xe]=new h.BufferAttribute(new lt.array.constructor(lt.count*lt.itemSize),lt.itemSize,lt.normalized))}const Y=D*.5,ae=Math.log10(1/D),xe=Math.pow(10,ae),fe=Y*xe;for(let Ie=0;Ie<Z;Ie++){const Ge=O?O.getX(Ie):Ie;let Xe="";for(let $e=0,lt=z.length;$e<lt;$e++){const At=z[$e],Gt=I.getAttribute(At),gt=Gt.itemSize;for(let xi=0;xi<gt;xi++)Xe+=`${~~(Gt[V[xi]](Ge)*xe+fe)},`}if(Xe in L)H.push(L[Xe]);else{for(let $e=0,lt=z.length;$e<lt;$e++){const At=z[$e],Gt=I.getAttribute(At),gt=I.morphAttributes[At],xi=Gt.itemSize,Ze=$[At],Ui=Q[At];for(let di=0;di<xi;di++){const Ii=V[di],Ti=ne[di];if(Ze[Ti](G,Gt[Ii](Ge)),gt)for(let ir=0,Gi=gt.length;ir<Gi;ir++)Ui[ir][Ti](G,gt[ir][Ii](Ge))}}L[Xe]=G,H.push(G),G++}}const de=I.clone();for(const Ie in I.attributes){const Ge=$[Ie];if(de.setAttribute(Ie,new h.BufferAttribute(Ge.array.slice(0,G*Ge.itemSize),Ge.itemSize,Ge.normalized)),Ie in Q)for(let Xe=0;Xe<Q[Ie].length;Xe++){const $e=Q[Ie][Xe];de.morphAttributes[Ie][Xe]=new h.BufferAttribute($e.array.slice(0,G*$e.itemSize),$e.itemSize,$e.normalized)}}return de.setIndex(H),de}function w(I,D){if(D===h.TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),I;if(D===h.TriangleFanDrawMode||D===h.TriangleStripDrawMode){let L=I.getIndex();if(L===null){const G=[],z=I.getAttribute("position");if(z!==void 0){for(let $=0;$<z.count;$++)G.push($);I.setIndex(G),L=I.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),I}const O=L.count-2,U=[];if(D===h.TriangleFanDrawMode)for(let G=1;G<=O;G++)U.push(L.getX(0)),U.push(L.getX(G)),U.push(L.getX(G+1));else for(let G=0;G<O;G++)G%2===0?(U.push(L.getX(G)),U.push(L.getX(G+1)),U.push(L.getX(G+2))):(U.push(L.getX(G+2)),U.push(L.getX(G+1)),U.push(L.getX(G)));U.length/3!==O&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const Z=I.clone();return Z.setIndex(U),Z.clearGroups(),Z}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",D),I}function S(I){const D=new h.Vector3,L=new h.Vector3,O=new h.Vector3,U=new h.Vector3,Z=new h.Vector3,G=new h.Vector3,z=new h.Vector3,$=new h.Vector3,Q=new h.Vector3;function H(Ce,yt,Ot,Jt,zt,_i,vt,ye){D.fromBufferAttribute(yt,zt),L.fromBufferAttribute(yt,_i),O.fromBufferAttribute(yt,vt);const ve=Ce.morphTargetInfluences;if(Ot&&ve){z.set(0,0,0),$.set(0,0,0),Q.set(0,0,0);for(let Le=0,Te=Ot.length;Le<Te;Le++){const ke=ve[Le],Pe=Ot[Le];ke!==0&&(U.fromBufferAttribute(Pe,zt),Z.fromBufferAttribute(Pe,_i),G.fromBufferAttribute(Pe,vt),Jt?(z.addScaledVector(U,ke),$.addScaledVector(Z,ke),Q.addScaledVector(G,ke)):(z.addScaledVector(U.sub(D),ke),$.addScaledVector(Z.sub(L),ke),Q.addScaledVector(G.sub(O),ke)))}D.add(z),L.add($),O.add(Q)}Ce.isSkinnedMesh&&(Ce.applyBoneTransform(zt,D),Ce.applyBoneTransform(_i,L),Ce.applyBoneTransform(vt,O)),ye[zt*3+0]=D.x,ye[zt*3+1]=D.y,ye[zt*3+2]=D.z,ye[_i*3+0]=L.x,ye[_i*3+1]=L.y,ye[_i*3+2]=L.z,ye[vt*3+0]=O.x,ye[vt*3+1]=O.y,ye[vt*3+2]=O.z}const V=I.geometry,ne=I.material;let Y,ae,xe;const fe=V.index,de=V.attributes.position,Ie=V.morphAttributes.position,Ge=V.morphTargetsRelative,Xe=V.attributes.normal,$e=V.morphAttributes.position,lt=V.groups,At=V.drawRange;let Gt,gt,xi,Ze,Ui,di,Ii;const Ti=new Float32Array(de.count*de.itemSize),ir=new Float32Array(Xe.count*Xe.itemSize);if(fe!==null)if(Array.isArray(ne))for(Gt=0,xi=lt.length;Gt<xi;Gt++)for(Ui=lt[Gt],di=Math.max(Ui.start,At.start),Ii=Math.min(Ui.start+Ui.count,At.start+At.count),gt=di,Ze=Ii;gt<Ze;gt+=3)Y=fe.getX(gt),ae=fe.getX(gt+1),xe=fe.getX(gt+2),H(I,de,Ie,Ge,Y,ae,xe,Ti),H(I,Xe,$e,Ge,Y,ae,xe,ir);else for(di=Math.max(0,At.start),Ii=Math.min(fe.count,At.start+At.count),Gt=di,xi=Ii;Gt<xi;Gt+=3)Y=fe.getX(Gt),ae=fe.getX(Gt+1),xe=fe.getX(Gt+2),H(I,de,Ie,Ge,Y,ae,xe,Ti),H(I,Xe,$e,Ge,Y,ae,xe,ir);else if(Array.isArray(ne))for(Gt=0,xi=lt.length;Gt<xi;Gt++)for(Ui=lt[Gt],di=Math.max(Ui.start,At.start),Ii=Math.min(Ui.start+Ui.count,At.start+At.count),gt=di,Ze=Ii;gt<Ze;gt+=3)Y=gt,ae=gt+1,xe=gt+2,H(I,de,Ie,Ge,Y,ae,xe,Ti),H(I,Xe,$e,Ge,Y,ae,xe,ir);else for(di=Math.max(0,At.start),Ii=Math.min(de.count,At.start+At.count),Gt=di,xi=Ii;Gt<xi;Gt+=3)Y=Gt,ae=Gt+1,xe=Gt+2,H(I,de,Ie,Ge,Y,ae,xe,Ti),H(I,Xe,$e,Ge,Y,ae,xe,ir);const Gi=new h.Float32BufferAttribute(Ti,3),Qe=new h.Float32BufferAttribute(ir,3);return{positionAttribute:de,normalAttribute:Xe,morphedPositionAttribute:Gi,morphedNormalAttribute:Qe}}function R(I){if(I.groups.length===0)return console.warn("THREE.BufferGeometryUtils.mergeGroups(): No groups are defined. Nothing to merge."),I;let D=I.groups;if(D=D.sort((G,z)=>G.materialIndex!==z.materialIndex?G.materialIndex-z.materialIndex:G.start-z.start),I.getIndex()===null){const G=I.getAttribute("position"),z=[];for(let $=0;$<G.count;$+=3)z.push($,$+1,$+2);I.setIndex(z)}const L=I.getIndex(),O=[];for(let G=0;G<D.length;G++){const z=D[G],$=z.start,Q=$+z.count;for(let H=$;H<Q;H++)O.push(L.getX(H))}I.dispose(),I.setIndex(O);let U=0;for(let G=0;G<D.length;G++){const z=D[G];z.start=U,U+=z.count}let Z=D[0];I.groups=[Z];for(let G=1;G<D.length;G++){const z=D[G];Z.materialIndex===z.materialIndex?Z.count+=z.count:(Z=z,I.groups.push(Z))}return I}function B(I,D=Math.PI/3){const L=Math.cos(D),O=(1+1e-10)*100,U=[new h.Vector3,new h.Vector3,new h.Vector3],Z=new h.Vector3,G=new h.Vector3,z=new h.Vector3,$=new h.Vector3;function Q(xe){const fe=~~(xe.x*O),de=~~(xe.y*O),Ie=~~(xe.z*O);return`${fe},${de},${Ie}`}const H=I.index?I.toNonIndexed():I,V=H.attributes.position,ne={};for(let xe=0,fe=V.count/3;xe<fe;xe++){const de=3*xe,Ie=U[0].fromBufferAttribute(V,de+0),Ge=U[1].fromBufferAttribute(V,de+1),Xe=U[2].fromBufferAttribute(V,de+2);Z.subVectors(Xe,Ge),G.subVectors(Ie,Ge);const $e=new h.Vector3().crossVectors(Z,G).normalize();for(let lt=0;lt<3;lt++){const At=U[lt],Gt=Q(At);Gt in ne||(ne[Gt]=[]),ne[Gt].push($e)}}const Y=new Float32Array(V.count*3),ae=new h.BufferAttribute(Y,3,!1);for(let xe=0,fe=V.count/3;xe<fe;xe++){const de=3*xe,Ie=U[0].fromBufferAttribute(V,de+0),Ge=U[1].fromBufferAttribute(V,de+1),Xe=U[2].fromBufferAttribute(V,de+2);Z.subVectors(Xe,Ge),G.subVectors(Ie,Ge),z.crossVectors(Z,G).normalize();for(let $e=0;$e<3;$e++){const lt=U[$e],At=Q(lt),Gt=ne[At];$.set(0,0,0);for(let gt=0,xi=Gt.length;gt<xi;gt++){const Ze=Gt[gt];z.dot(Ze)>L&&$.add(Ze)}$.normalize(),ae.setXYZ(de+$e,$.x,$.y,$.z)}}return H.setAttribute("normal",ae),H}},"./node_modules/three/examples/jsm/utils/WorkerPool.js":(l,u,c)=>{c.r(u),c.d(u,{WorkerPool:()=>h});class h{constructor(f=4){this.pool=f,this.queue=[],this.workers=[],this.workersResolve=[],this.workerStatus=0}_initWorker(f){if(!this.workers[f]){const m=this.workerCreator();m.addEventListener("message",this._onMessage.bind(this,f)),this.workers[f]=m}}_getIdleWorker(){for(let f=0;f<this.pool;f++)if(!(this.workerStatus&1<<f))return f;return-1}_onMessage(f,m){const g=this.workersResolve[f];if(g&&g(m),this.queue.length){const{resolve:y,msg:x,transfer:v}=this.queue.shift();this.workersResolve[f]=y,this.workers[f].postMessage(x,v)}else this.workerStatus^=1<<f}setWorkerCreator(f){this.workerCreator=f}setWorkerLimit(f){this.pool=f}postMessage(f,m){return new Promise(g=>{const y=this._getIdleWorker();y!==-1?(this._initWorker(y),this.workerStatus|=1<<y,this.workersResolve[y]=g,this.workers[y].postMessage(f,m)):this.queue.push({resolve:g,msg:f,transfer:m})})}dispose(){this.workers.forEach(f=>f.terminate()),this.workersResolve.length=0,this.workers.length=0,this.queue.length=0,this.workerStatus=0}}},"./src/lib/three.mjs":(l,u,c)=>{c.r(u),c.d(u,{default:()=>w});var h=c("./node_modules/three/build/three.module.js"),p=c("./node_modules/three/examples/jsm/loaders/DRACOLoader.js"),f=c("./node_modules/three/examples/jsm/loaders/GLTFLoader.js"),m=c("./node_modules/three/examples/jsm/loaders/KTX2Loader.js"),g=c("./node_modules/three/examples/jsm/math/OBB.js"),y=c("./node_modules/three/examples/jsm/loaders/OBJLoader.js"),x=c("./node_modules/three/examples/jsm/loaders/MTLLoader.js"),v=c("./node_modules/three/examples/jsm/utils/BufferGeometryUtils.js"),_=c("./node_modules/three/examples/jsm/lights/LightProbeGenerator.js"),T={...h};T.DRACOLoader=p.DRACOLoader,T.GLTFLoader=f.GLTFLoader,T.KTX2Loader=m.KTX2Loader,T.OBJLoader=y.OBJLoader,T.MTLLoader=x.MTLLoader,T.OBB=g.OBB,T.BufferGeometryUtils=v,T.LightProbeGenerator=_.LightProbeGenerator;const w=T},"./package.json":l=>{l.exports=JSON.parse('{"name":"aframe","version":"1.6.0","description":"A web framework for building virtual reality experiences.","homepage":"https://aframe.io/","main":"dist/aframe-master.js","scripts":{"dev":"cross-env INSPECTOR_VERSION=dev webpack serve --port 8080","dist":"node scripts/updateVersionLog.js && npm run dist:min && npm run dist:max","dist:max":"webpack --config webpack.config.js","dist:min":"webpack --config webpack.prod.config.js","docs":"markserv --dir docs --port 9001","preghpages":"node ./scripts/preghpages.js","ghpages":"ghpages -p gh-pages/","lint":"standardx -v | snazzy","lint:fix":"standardx --fix","precommit":"npm run lint","prepush":"node scripts/testOnlyCheck.js","prerelease":"node scripts/release.js 1.5.0 1.6.0","start":"npm run dev","start:https":"npm run dev -- --server-type https","test":"karma start ./tests/karma.conf.js","test:docs":"node scripts/docsLint.js","test:firefox":"npm test -- --browsers Firefox","test:chrome":"npm test -- --browsers Chrome","test:nobrowser":"NO_BROWSER=true npm test","test:node":"node --experimental-require-module ./node_modules/mocha/bin/mocha --ui tdd tests/node"},"repository":"aframevr/aframe","license":"MIT","files":["dist/*","docs/**/*","src/**/*","vendor/**/*"],"dependencies":{"buffer":"^6.0.3","debug":"^4.3.4","deep-assign":"^2.0.0","load-bmfont":"^1.2.3","super-animejs":"^3.1.0","three":"npm:super-three@0.164.0","three-bmfont-text":"dmarcos/three-bmfont-text#eed4878795be9b3e38cf6aec6b903f56acd1f695","webvr-polyfill":"^0.10.12"},"devDependencies":{"@babel/core":"^7.17.10","babel-loader":"^8.2.5","babel-plugin-istanbul":"^6.1.1","chai":"^4.3.6","chai-shallow-deep-equal":"^1.4.0","chalk":"^1.1.3","cross-env":"^7.0.3","css-loader":"^6.7.1","eslint":"^8.45.0","eslint-config-semistandard":"^17.0.0","eslint-config-standard-jsx":"^11.0.0","ghpages":"0.0.8","git-rev":"^0.2.1","glob":"^8.0.3","husky":"^0.11.7","jsdom":"^24.0.0","jsdom-global":"^3.0.2","karma":"^6.4.0","karma-chai-shallow-deep-equal":"0.0.4","karma-chrome-launcher":"^3.1.1","karma-coverage":"^2.2.0","karma-env-preprocessor":"^0.1.1","karma-firefox-launcher":"^2.1.2","karma-mocha":"^2.0.1","karma-mocha-reporter":"^2.2.5","karma-sinon-chai":"^2.0.2","karma-webpack":"^5.0.0","markserv":"github:sukima/markserv#feature/fix-broken-websoketio-link","mocha":"^10.0.0","replace-in-file":"^2.5.3","shelljs":"^0.7.7","shx":"^0.2.2","sinon":"<12.0.0","sinon-chai":"^3.7.0","snazzy":"^5.0.0","standardx":"^7.0.0","style-loader":"^3.3.1","too-wordy":"ngokevin/too-wordy","webpack":"^5.73.0","webpack-cli":"^4.10.0","webpack-dev-server":"^4.11.0","webpack-merge":"^5.8.0","write-good":"^1.0.8"},"link":true,"standardx":{"ignore":["build/**","dist/**","examples/**/shaders/*.js","**/vendor/**"]},"keywords":["3d","aframe","cardboard","components","oculus","three","three.js","rift","vive","vr","quest","meta","web-components","webvr","webxr"],"engines":{"node":">= 4.6.0","npm":">= 2.15.9"}}')}},n={};function s(l){var u=n[l];if(u!==void 0)return u.exports;var c=n[l]={id:l,exports:{}};return i[l].call(c.exports,c,c.exports,s),c.exports}s.m=i,s.n=l=>{var u=l&&l.__esModule?()=>l.default:()=>l;return s.d(u,{a:u}),u},s.d=(l,u)=>{for(var c in u)s.o(u,c)&&!s.o(l,c)&&Object.defineProperty(l,c,{enumerable:!0,get:u[c]})},s.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),s.o=(l,u)=>Object.prototype.hasOwnProperty.call(l,u),s.r=l=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})},s.b=document.baseURI||self.location.href,s.nc=void 0;var o=s("./src/index.js");return o})())})(eq);const MD=.1;AFRAME.registerComponent("checkpoint-controls",{schema:{enabled:{default:!0},mode:{default:"teleport",oneOf:["teleport","animate"]},animateSpeed:{default:3}},init:function(){this.active=!0,this.checkpoint=null,this.isNavMeshConstrained=!1,this.offset=new THREE.Vector3,this.position=new THREE.Vector3,this.targetPosition=new THREE.Vector3},play:function(){this.active=!0},pause:function(){this.active=!1},setCheckpoint:function(r){const e=this.el;if(this.active&&this.checkpoint!==r){if(this.checkpoint&&e.emit("navigation-end",{checkpoint:this.checkpoint}),this.checkpoint=r,this.sync(),this.position.distanceTo(this.targetPosition)<MD){this.checkpoint=null;return}e.emit("navigation-start",{checkpoint:r}),this.data.mode==="teleport"&&(this.el.setAttribute("position",this.targetPosition),this.checkpoint=null,e.emit("navigation-end",{checkpoint:r}),e.components["movement-controls"].updateNavLocation())}},isVelocityActive:function(){return!!(this.active&&this.checkpoint)},getVelocity:function(){if(!this.active)return;const r=this.data,e=this.offset,i=this.position,n=this.targetPosition,s=this.checkpoint;return this.sync(),i.distanceTo(n)<MD?(this.checkpoint=null,this.el.emit("navigation-end",{checkpoint:s}),e.set(0,0,0)):(e.setLength(r.animateSpeed),e)},sync:function(){const r=this.offset,e=this.position,i=this.targetPosition;e.copy(this.el.getAttribute("position")),this.checkpoint.object3D.getWorldPosition(i),i.add(this.checkpoint.components.checkpoint.getOffset()),r.copy(i).sub(e)}});var tq=Object.assign(function(){},{FACE_1:0,FACE_2:1,FACE_3:2,FACE_4:3,L_SHOULDER_1:4,R_SHOULDER_1:5,L_SHOULDER_2:6,R_SHOULDER_2:7,SELECT:8,START:9,DPAD_UP:12,DPAD_DOWN:13,DPAD_LEFT:14,DPAD_RIGHT:15,VENDOR:16});function iq(r,e,i){this.type=r,this.index=e,this.pressed=i.pressed,this.value=i.value}var rq=iq;const Ff=tq,w2=rq,Ih=.2,lu={LEFT:"left",RIGHT:"right"},cu={MOVEMENT:1,ROTATION:2};AFRAME.registerComponent("gamepad-controls",{GamepadButton:Ff,schema:{enabled:{default:!0},rotationSensitivity:{default:2}},init:function(){const r=this.el.sceneEl;this.system=r.systems["tracked-controls-webxr"]||{controllers:[]},this.prevTime=window.performance.now(),this.buttons={};const e=this.el.object3D.rotation;this.pitch=new THREE.Object3D,this.pitch.rotation.x=e.x,this.yaw=new THREE.Object3D,this.yaw.position.y=10,this.yaw.rotation.y=e.y,this.yaw.add(this.pitch),this._lookVector=new THREE.Vector2,this._moveVector=new THREE.Vector2,this._dpadVector=new THREE.Vector2,r.addBehavior(this)},update:function(){this.tick()},tick:function(r,e){this.updateButtonState(),this.updateRotation(e)},remove:function(){},isVelocityActive:function(){if(!this.data.enabled||!this.isConnected())return!1;const r=this._dpadVector,e=this._moveVector;this.getDpad(r),this.getJoystick(cu.MOVEMENT,e);const i=r.x||e.x,n=r.y||e.y;return Math.abs(i)>Ih||Math.abs(n)>Ih},getVelocityDelta:function(){const r=this._dpadVector,e=this._moveVector;this.getDpad(r),this.getJoystick(cu.MOVEMENT,e);const i=r.x||e.x,n=r.y||e.y,s=new THREE.Vector3;return Math.abs(i)>Ih&&(s.x+=i),Math.abs(n)>Ih&&(s.z+=n),s},isRotationActive:function(){if(!this.data.enabled||!this.isConnected())return!1;const r=this._lookVector;return this.getJoystick(cu.ROTATION,r),Math.abs(r.x)>Ih||Math.abs(r.y)>Ih},updateRotation:function(r){if(!this.isRotationActive())return;const e=this.data,i=this.yaw,n=this.pitch;i.rotation.y=this.el.object3D.rotation.y,n.rotation.x=this.el.object3D.rotation.x;const s=this._lookVector;this.getJoystick(cu.ROTATION,s),Math.abs(s.x)<=Ih&&(s.x=0),Math.abs(s.y)<=Ih&&(s.y=0),s.multiplyScalar(e.rotationSensitivity*r/1e3),i.rotation.y-=s.x,n.rotation.x-=s.y,n.rotation.x=Math.max(-Math.PI/2,Math.min(Math.PI/2,n.rotation.x)),this.el.object3D.rotation.set(n.rotation.x,i.rotation.y,0)},updateButtonState:function(){const r=this.getGamepad(lu.RIGHT);if(this.data.enabled&&r)for(var e=0;e<r.buttons.length;e++)r.buttons[e].pressed&&!this.buttons[e]?this.emit(new w2("gamepadbuttondown",e,r.buttons[e])):!r.buttons[e].pressed&&this.buttons[e]&&this.emit(new w2("gamepadbuttonup",e,r.buttons[e])),this.buttons[e]=r.buttons[e].pressed;else for(const i in this.buttons)this.buttons[i]=!1},emit:function(r){this.el.emit(r.type,r),this.el.emit(r.type+":"+r.index,new w2(r.type,r.index,r))},getGamepad:function(){const r=[],e=[];return function(i){const n=this.el.sceneEl.components["proxy-controls"],s=n&&n.isConnected()&&n.getGamepad(0);if(s)return s;r.length=0;for(let l=0;l<this.system.controllers.length;l++){const u=this.system.controllers[l],c=u?u.gamepad:null;if(r.push(c),c&&u.handedness===i)return c}const o=navigator.getGamepads?navigator.getGamepads():e;for(let l=0;l<o.length;l++){const u=o[l];if(u&&u.hand===i)return u}return r[0]||o[0]}}(),getButton:function(r){return this.getGamepad(lu.RIGHT).buttons[r]},getAxis:function(r){return this.getGamepad(r>1?lu.RIGHT:lu.LEFT).axes[r]},getJoystick:function(r,e){const i=this.getGamepad(r===cu.MOVEMENT?lu.LEFT:lu.RIGHT);if(!i)return e.set(0,0);if(i.mapping==="xr-standard")switch(r){case cu.MOVEMENT:return e.set(i.axes[2],i.axes[3]);case cu.ROTATION:return e.set(i.axes[2],0)}else switch(r){case cu.MOVEMENT:return e.set(i.axes[0],i.axes[1]);case cu.ROTATION:return e.set(i.axes[2],i.axes[3])}throw new Error('Unexpected joystick index "%d".',r)},getDpad:function(r){const e=this.getGamepad(lu.LEFT);return!e||!e.buttons[Ff.DPAD_RIGHT]?r.set(0,0):r.set((e.buttons[Ff.DPAD_RIGHT].pressed?1:0)+(e.buttons[Ff.DPAD_LEFT].pressed?-1:0),(e.buttons[Ff.DPAD_UP].pressed?-1:0)+(e.buttons[Ff.DPAD_DOWN].pressed?1:0))},isConnected:function(){const r=this.getGamepad(lu.LEFT);return!!(r&&r.connected)},getID:function(){return this.getGamepad(lu.LEFT).id}}),function(r){var e="KeyboardEvent"in r;e||(r.KeyboardEvent=function(){throw TypeError("Illegal constructor")}),"DOM_KEY_LOCATION_STANDARD"in r.KeyboardEvent||(r.KeyboardEvent.DOM_KEY_LOCATION_STANDARD=0),"DOM_KEY_LOCATION_LEFT"in r.KeyboardEvent||(r.KeyboardEvent.DOM_KEY_LOCATION_LEFT=1),"DOM_KEY_LOCATION_RIGHT"in r.KeyboardEvent||(r.KeyboardEvent.DOM_KEY_LOCATION_RIGHT=2),"DOM_KEY_LOCATION_NUMPAD"in r.KeyboardEvent||(r.KeyboardEvent.DOM_KEY_LOCATION_NUMPAD=3);var i=window.KeyboardEvent.DOM_KEY_LOCATION_STANDARD,n=window.KeyboardEvent.DOM_KEY_LOCATION_LEFT,s=window.KeyboardEvent.DOM_KEY_LOCATION_RIGHT,o=window.KeyboardEvent.DOM_KEY_LOCATION_NUMPAD;function l(R,B){return String(R).indexOf(B)!==-1}var u=function(){return l(navigator.platform,"Win")?"win":l(navigator.platform,"Mac")?"mac":l(navigator.platform,"CrOS")?"cros":l(navigator.platform,"Linux")?"linux":l(navigator.userAgent,"iPad")||l(navigator.platform,"iPod")||l(navigator.platform,"iPhone")?"ios":""}(),c=function(){return l(navigator.userAgent,"Chrome/")?"chrome":l(navigator.vendor,"Apple")?"safari":l(navigator.userAgent,"MSIE")?"ie":l(navigator.userAgent,"Gecko/")?"moz":l(navigator.userAgent,"Opera/")?"opera":""}(),h=c+"-"+u;function p(R,B,I){(h===B||c===B||u===B)&&Object.keys(I).forEach(function(D){R[D]=I[D]})}function f(R,B){var I={};return Object.keys(R).forEach(function(D){var L=R[D];B in L&&(I[L[B]]=L)}),I}var m={3:{code:"Cancel"},6:{code:"Help"},8:{code:"Backspace"},9:{code:"Tab"},12:{code:"Clear"},13:{code:"Enter"},16:{code:"Shift"},17:{code:"Control"},18:{code:"Alt"},19:{code:"Pause"},20:{code:"CapsLock"},21:{code:"KanaMode"},22:{code:"HangulMode"},23:{code:"JunjaMode"},24:{code:"FinalMode"},25:{code:"KanjiMode"},27:{code:"Escape"},28:{code:"Convert"},29:{code:"NonConvert"},30:{code:"Accept"},31:{code:"ModeChange"},32:{code:"Space"},33:{code:"PageUp"},34:{code:"PageDown"},35:{code:"End"},36:{code:"Home"},37:{code:"ArrowLeft"},38:{code:"ArrowUp"},39:{code:"ArrowRight"},40:{code:"ArrowDown"},41:{code:"Select"},42:{code:"Print"},43:{code:"Execute"},44:{code:"PrintScreen"},45:{code:"Insert"},46:{code:"Delete"},47:{code:"Help"},48:{code:"Digit0",keyCap:"0"},49:{code:"Digit1",keyCap:"1"},50:{code:"Digit2",keyCap:"2"},51:{code:"Digit3",keyCap:"3"},52:{code:"Digit4",keyCap:"4"},53:{code:"Digit5",keyCap:"5"},54:{code:"Digit6",keyCap:"6"},55:{code:"Digit7",keyCap:"7"},56:{code:"Digit8",keyCap:"8"},57:{code:"Digit9",keyCap:"9"},65:{code:"KeyA",keyCap:"a"},66:{code:"KeyB",keyCap:"b"},67:{code:"KeyC",keyCap:"c"},68:{code:"KeyD",keyCap:"d"},69:{code:"KeyE",keyCap:"e"},70:{code:"KeyF",keyCap:"f"},71:{code:"KeyG",keyCap:"g"},72:{code:"KeyH",keyCap:"h"},73:{code:"KeyI",keyCap:"i"},74:{code:"KeyJ",keyCap:"j"},75:{code:"KeyK",keyCap:"k"},76:{code:"KeyL",keyCap:"l"},77:{code:"KeyM",keyCap:"m"},78:{code:"KeyN",keyCap:"n"},79:{code:"KeyO",keyCap:"o"},80:{code:"KeyP",keyCap:"p"},81:{code:"KeyQ",keyCap:"q"},82:{code:"KeyR",keyCap:"r"},83:{code:"KeyS",keyCap:"s"},84:{code:"KeyT",keyCap:"t"},85:{code:"KeyU",keyCap:"u"},86:{code:"KeyV",keyCap:"v"},87:{code:"KeyW",keyCap:"w"},88:{code:"KeyX",keyCap:"x"},89:{code:"KeyY",keyCap:"y"},90:{code:"KeyZ",keyCap:"z"},91:{code:"OSLeft",location:n},92:{code:"OSRight",location:s},93:{code:"ContextMenu"},95:{code:"Standby"},96:{code:"Numpad0",keyCap:"0",location:o},97:{code:"Numpad1",keyCap:"1",location:o},98:{code:"Numpad2",keyCap:"2",location:o},99:{code:"Numpad3",keyCap:"3",location:o},100:{code:"Numpad4",keyCap:"4",location:o},101:{code:"Numpad5",keyCap:"5",location:o},102:{code:"Numpad6",keyCap:"6",location:o},103:{code:"Numpad7",keyCap:"7",location:o},104:{code:"Numpad8",keyCap:"8",location:o},105:{code:"Numpad9",keyCap:"9",location:o},106:{code:"NumpadMultiply",keyCap:"*",location:o},107:{code:"NumpadAdd",keyCap:"+",location:o},108:{code:"NumpadComma",keyCap:",",location:o},109:{code:"NumpadSubtract",keyCap:"-",location:o},110:{code:"NumpadDecimal",keyCap:".",location:o},111:{code:"NumpadDivide",keyCap:"/",location:o},112:{code:"F1"},113:{code:"F2"},114:{code:"F3"},115:{code:"F4"},116:{code:"F5"},117:{code:"F6"},118:{code:"F7"},119:{code:"F8"},120:{code:"F9"},121:{code:"F10"},122:{code:"F11"},123:{code:"F12"},124:{code:"F13"},125:{code:"F14"},126:{code:"F15"},127:{code:"F16"},128:{code:"F17"},129:{code:"F18"},130:{code:"F19"},131:{code:"F20"},132:{code:"F21"},133:{code:"F22"},134:{code:"F23"},135:{code:"F24"},144:{code:"NumLock",location:o},145:{code:"ScrollLock"},160:{code:"ShiftLeft",location:n},161:{code:"ShiftRight",location:s},162:{code:"ControlLeft",location:n},163:{code:"ControlRight",location:s},164:{code:"AltLeft",location:n},165:{code:"AltRight",location:s},166:{code:"BrowserBack"},167:{code:"BrowserForward"},168:{code:"BrowserRefresh"},169:{code:"BrowserStop"},170:{code:"BrowserSearch"},171:{code:"BrowserFavorites"},172:{code:"BrowserHome"},173:{code:"VolumeMute"},174:{code:"VolumeDown"},175:{code:"VolumeUp"},176:{code:"MediaTrackNext"},177:{code:"MediaTrackPrevious"},178:{code:"MediaStop"},179:{code:"MediaPlayPause"},180:{code:"LaunchMail"},181:{code:"MediaSelect"},182:{code:"LaunchApp1"},183:{code:"LaunchApp2"},186:{code:"Semicolon",keyCap:";"},187:{code:"Equal",keyCap:"="},188:{code:"Comma",keyCap:","},189:{code:"Minus",keyCap:"-"},190:{code:"Period",keyCap:"."},191:{code:"Slash",keyCap:"/"},192:{code:"Backquote",keyCap:"`"},219:{code:"BracketLeft",keyCap:"["},220:{code:"Backslash",keyCap:"\\"},221:{code:"BracketRight",keyCap:"]"},222:{code:"Quote",keyCap:"'"},226:{code:"IntlBackslash",keyCap:"\\"},229:{code:"Process"},246:{code:"Attn"},247:{code:"CrSel"},248:{code:"ExSel"},249:{code:"EraseEof"},250:{code:"Play"},251:{code:"ZoomToggle"},254:{code:"Clear"}};p(m,"moz",{59:{code:"Semicolon",keyCap:";"},61:{code:"Equal",keyCap:"="},107:{code:"Equal",keyCap:"="},109:{code:"Minus",keyCap:"-"},187:{code:"NumpadAdd",keyCap:"+",location:o},189:{code:"NumpadSubtract",keyCap:"-",location:o}}),p(m,"moz-mac",{12:{code:"NumLock",location:o},173:{code:"Minus",keyCap:"-"}}),p(m,"moz-win",{173:{code:"Minus",keyCap:"-"}}),p(m,"chrome-mac",{93:{code:"OSRight",location:s}}),p(m,"safari",{3:{code:"Enter"},25:{code:"Tab"}}),p(m,"ios",{10:{code:"Enter",location:i}}),p(m,"safari-mac",{91:{code:"OSLeft",location:n},93:{code:"OSRight",location:s},229:{code:"KeyQ",keyCap:"Q"}});var g={};u==="cros"&&(g["U+00A0"]={code:"ShiftLeft",location:n},g["U+00A1"]={code:"ShiftRight",location:s},g["U+00A2"]={code:"ControlLeft",location:n},g["U+00A3"]={code:"ControlRight",location:s},g["U+00A4"]={code:"AltLeft",location:n},g["U+00A5"]={code:"AltRight",location:s}),h==="chrome-mac"&&(g["U+0010"]={code:"ContextMenu"}),h==="safari-mac"&&(g["U+0010"]={code:"ContextMenu"}),u==="ios"&&(g["U+0010"]={code:"Function"},g["U+001C"]={code:"ArrowLeft"},g["U+001D"]={code:"ArrowRight"},g["U+001E"]={code:"ArrowUp"},g["U+001F"]={code:"ArrowDown"},g["U+0001"]={code:"Home"},g["U+0004"]={code:"End"},g["U+000B"]={code:"PageUp"},g["U+000C"]={code:"PageDown"});var y=[];y[n]={16:{code:"ShiftLeft",location:n},17:{code:"ControlLeft",location:n},18:{code:"AltLeft",location:n}},y[s]={16:{code:"ShiftRight",location:s},17:{code:"ControlRight",location:s},18:{code:"AltRight",location:s}},y[o]={13:{code:"NumpadEnter",location:o}},p(y[o],"moz",{109:{code:"NumpadSubtract",location:o},107:{code:"NumpadAdd",location:o}}),p(y[n],"moz-mac",{224:{code:"OSLeft",location:n}}),p(y[s],"moz-mac",{224:{code:"OSRight",location:s}}),p(y[s],"moz-win",{91:{code:"OSRight",location:s}}),p(y[s],"mac",{93:{code:"OSRight",location:s}}),p(y[o],"chrome-mac",{12:{code:"NumLock",location:o}}),p(y[o],"safari-mac",{12:{code:"NumLock",location:o},187:{code:"NumpadAdd",location:o},189:{code:"NumpadSubtract",location:o},190:{code:"NumpadDecimal",location:o},191:{code:"NumpadDivide",location:o}});var x={ShiftLeft:{key:"Shift"},ShiftRight:{key:"Shift"},ControlLeft:{key:"Control"},ControlRight:{key:"Control"},AltLeft:{key:"Alt"},AltRight:{key:"Alt"},OSLeft:{key:"OS"},OSRight:{key:"OS"},NumpadEnter:{key:"Enter"},Space:{key:" "},Digit0:{key:"0",shiftKey:")"},Digit1:{key:"1",shiftKey:"!"},Digit2:{key:"2",shiftKey:"@"},Digit3:{key:"3",shiftKey:"#"},Digit4:{key:"4",shiftKey:"$"},Digit5:{key:"5",shiftKey:"%"},Digit6:{key:"6",shiftKey:"^"},Digit7:{key:"7",shiftKey:"&"},Digit8:{key:"8",shiftKey:"*"},Digit9:{key:"9",shiftKey:"("},KeyA:{key:"a",shiftKey:"A"},KeyB:{key:"b",shiftKey:"B"},KeyC:{key:"c",shiftKey:"C"},KeyD:{key:"d",shiftKey:"D"},KeyE:{key:"e",shiftKey:"E"},KeyF:{key:"f",shiftKey:"F"},KeyG:{key:"g",shiftKey:"G"},KeyH:{key:"h",shiftKey:"H"},KeyI:{key:"i",shiftKey:"I"},KeyJ:{key:"j",shiftKey:"J"},KeyK:{key:"k",shiftKey:"K"},KeyL:{key:"l",shiftKey:"L"},KeyM:{key:"m",shiftKey:"M"},KeyN:{key:"n",shiftKey:"N"},KeyO:{key:"o",shiftKey:"O"},KeyP:{key:"p",shiftKey:"P"},KeyQ:{key:"q",shiftKey:"Q"},KeyR:{key:"r",shiftKey:"R"},KeyS:{key:"s",shiftKey:"S"},KeyT:{key:"t",shiftKey:"T"},KeyU:{key:"u",shiftKey:"U"},KeyV:{key:"v",shiftKey:"V"},KeyW:{key:"w",shiftKey:"W"},KeyX:{key:"x",shiftKey:"X"},KeyY:{key:"y",shiftKey:"Y"},KeyZ:{key:"z",shiftKey:"Z"},Numpad0:{key:"0"},Numpad1:{key:"1"},Numpad2:{key:"2"},Numpad3:{key:"3"},Numpad4:{key:"4"},Numpad5:{key:"5"},Numpad6:{key:"6"},Numpad7:{key:"7"},Numpad8:{key:"8"},Numpad9:{key:"9"},NumpadMultiply:{key:"*"},NumpadAdd:{key:"+"},NumpadComma:{key:","},NumpadSubtract:{key:"-"},NumpadDecimal:{key:"."},NumpadDivide:{key:"/"},Semicolon:{key:";",shiftKey:":"},Equal:{key:"=",shiftKey:"+"},Comma:{key:",",shiftKey:"<"},Minus:{key:"-",shiftKey:"_"},Period:{key:".",shiftKey:">"},Slash:{key:"/",shiftKey:"?"},Backquote:{key:"`",shiftKey:"~"},BracketLeft:{key:"[",shiftKey:"{"},Backslash:{key:"\\",shiftKey:"|"},BracketRight:{key:"]",shiftKey:"}"},Quote:{key:"'",shiftKey:'"'},IntlBackslash:{key:"\\",shiftKey:"|"}};p(x,"mac",{OSLeft:{key:"Meta"},OSRight:{key:"Meta"}});var v={Esc:"Escape",Nonconvert:"NonConvert",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Menu:"ContextMenu",MediaNextTrack:"MediaTrackNext",MediaPreviousTrack:"MediaTrackPrevious",SelectMedia:"MediaSelect",HalfWidth:"Hankaku",FullWidth:"Zenkaku",RomanCharacters:"Romaji",Crsel:"CrSel",Exsel:"ExSel",Zoom:"ZoomToggle"},_=f(m,"code");try{var T=e&&"location"in new KeyboardEvent("")}catch{}function w(R){var B="keyCode"in R?R.keyCode:"which"in R?R.which:0,I=function(){if(T||"keyLocation"in R){var L=T?R.location:R.keyLocation;if(L&&B in y[L])return y[L][B]}return"keyIdentifier"in R&&R.keyIdentifier in g?g[R.keyIdentifier]:B in m?m[B]:null}();if(!I)return null;var D=function(){var L=x[I.code];return L?R.shiftKey&&"shiftKey"in L?L.shiftKey:L.key:I.code}();return{code:I.code,key:D,location:I.location,keyCap:I.keyCap}}function S(R,B){if(R=String(R),!_.hasOwnProperty(R))return"Undefined";if(B&&String(B).toLowerCase()!=="en-us")throw Error("Unsupported locale");var I=_[R];return I.keyCap||I.code||"Undefined"}"KeyboardEvent"in r&&"defineProperty"in Object&&function(){function R(I,D,L){D in I||Object.defineProperty(I,D,L)}if(R(KeyboardEvent.prototype,"code",{get:function(){var I=w(this);return I?I.code:""}}),"key"in KeyboardEvent.prototype){var B=Object.getOwnPropertyDescriptor(KeyboardEvent.prototype,"key");Object.defineProperty(KeyboardEvent.prototype,"key",{get:function(){var I=B.get.call(this);return v.hasOwnProperty(I)?v[I]:I}})}R(KeyboardEvent.prototype,"key",{get:function(){var I=w(this);return I&&"key"in I?I.key:"Unidentified"}}),R(KeyboardEvent.prototype,"location",{get:function(){var I=w(this);return I&&"location"in I?I.location:i}}),R(KeyboardEvent.prototype,"locale",{get:function(){return""}})}(),"queryKeyCap"in r.KeyboardEvent||(r.KeyboardEvent.queryKeyCap=S),r.identifyKey=function(R){if(!("code"in R)){var B=w(R);R.code=B?B.code:"",R.key=B&&"key"in B?B.key:"Unidentified",R.location="location"in R?R.location:"keyLocation"in R?R.keyLocation:B&&"location"in B?B.location:i,R.locale=""}}}(window);const nq="__keyboard-controls-proxy",sq=window.KeyboardEvent;AFRAME.registerComponent("keyboard-controls",{schema:{enabled:{default:!0},debug:{default:!1}},init:function(){this.dVelocity=new THREE.Vector3,this.localKeys={},this.listeners={keydown:this.onKeyDown.bind(this),keyup:this.onKeyUp.bind(this),blur:this.onBlur.bind(this),onContextMenu:this.onContextMenu.bind(this)}},isVelocityActive:function(){return this.data.enabled&&!!Object.keys(this.getKeys()).length},getVelocityDelta:function(){const r=this.data,e=this.getKeys();return this.dVelocity.set(0,0,0),r.enabled&&((e.KeyW||e.ArrowUp)&&(this.dVelocity.z-=1),(e.KeyA||e.ArrowLeft)&&(this.dVelocity.x-=1),(e.KeyS||e.ArrowDown)&&(this.dVelocity.z+=1),(e.KeyD||e.ArrowRight)&&(this.dVelocity.x+=1),e.ShiftLeft&&(this.dVelocity=this.dVelocity.multiplyScalar(2))),this.dVelocity.clone()},play:function(){this.attachEventListeners()},pause:function(){this.removeEventListeners()},attachEventListeners:function(){window.addEventListener("contextmenu",this.listeners.onContextMenu,!1),window.addEventListener("keydown",this.listeners.keydown,!1),window.addEventListener("keyup",this.listeners.keyup,!1),window.addEventListener("blur",this.listeners.blur,!1)},onContextMenu:function(){for(const r in this.localKeys)this.localKeys.hasOwnProperty(r)&&delete this.localKeys[r]},removeEventListeners:function(){window.removeEventListener("keydown",this.listeners.keydown),window.removeEventListener("keyup",this.listeners.keyup),window.removeEventListener("blur",this.listeners.blur)},onKeyDown:function(r){AFRAME.utils.shouldCaptureKeyEvent(r)&&(this.localKeys[r.code]=!0,this.emit(r))},onKeyUp:function(r){AFRAME.utils.shouldCaptureKeyEvent(r)&&(delete this.localKeys[r.code],this.emit(r))},onBlur:function(){for(const r in this.localKeys)this.localKeys.hasOwnProperty(r)&&delete this.localKeys[r]},emit:function(r){nq in r&&this.el.emit(r.type,r),this.el.emit(r.type+":"+r.code,new sq(r.type,r)),this.data.debug&&console.log(r.type+":"+r.code)},isPressed:function(r){return r in this.getKeys()},getKeys:function(){return this.isProxied()?this.el.sceneEl.components["proxy-controls"].getKeyboard():this.localKeys},isProxied:function(){const r=this.el.sceneEl.components["proxy-controls"];return r&&r.isConnected()}}),AFRAME.registerComponent("touch-controls",{schema:{enabled:{default:!0},reverseEnabled:{default:!0}},init:function(){this.dVelocity=new THREE.Vector3,this.bindMethods(),this.direction=0},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.dVelocity.set(0,0,0)},remove:function(){this.pause()},addEventListeners:function(){const r=this.el.sceneEl,e=r.canvas;if(!e){r.addEventListener("render-target-loaded",this.addEventListeners.bind(this));return}e.addEventListener("touchstart",this.onTouchStart,{passive:!0}),e.addEventListener("touchend",this.onTouchEnd,{passive:!0});const i=r.getAttribute("vr-mode-ui");i&&i.cardboardModeEnabled&&r.addEventListener("enter-vr",this.onEnterVR)},removeEventListeners:function(){const r=this.el.sceneEl&&this.el.sceneEl.canvas;r&&(r.removeEventListener("touchstart",this.onTouchStart),r.removeEventListener("touchend",this.onTouchEnd),this.el.sceneEl.removeEventListener("enter-vr",this.onEnterVR))},isVelocityActive:function(){return this.data.enabled&&!!this.direction},getVelocityDelta:function(){return this.dVelocity.z=this.direction,this.dVelocity.clone()},bindMethods:function(){this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onEnterVR=this.onEnterVR.bind(this)},onTouchStart:function(r){this.direction=-1,this.data.reverseEnabled&&r.touches&&r.touches.length===2&&(this.direction=1),r.preventDefault()},onTouchEnd:function(r){this.direction=0,r.preventDefault()},onEnterVR:function(){const r=this.el.sceneEl.xrSession;r&&(r.addEventListener("selectstart",this.onTouchStart),r.addEventListener("selectend",this.onTouchEnd))}});const C2="-controls",aq=.2,oq=1e-5,lq="moved";AFRAME.registerComponent("movement-controls",{dependencies:["rotation"],schema:{enabled:{default:!0},controls:{default:["gamepad","trackpad","keyboard","touch"]},speed:{default:.3,min:0},fly:{default:!1},constrainToNavMesh:{default:!1},camera:{default:"[movement-controls] [camera]",type:"selector"}},init:function(){const r=this.el;this.data.camera||(this.data.camera=r.querySelector("[camera]")),this.velocityCtrl=null,this.velocity=new THREE.Vector3,this.heading=new THREE.Quaternion,this.eventDetail={},this.navGroup=null,this.navNode=null,r.sceneEl.hasLoaded?this.injectControls():r.sceneEl.addEventListener("loaded",this.injectControls.bind(this))},update:function(r){const e=this.el,i=this.data,n=e.sceneEl.systems.nav;if(e.sceneEl.hasLoaded&&this.injectControls(),n&&i.constrainToNavMesh!==r.constrainToNavMesh&&(i.constrainToNavMesh?n.addAgent(this):n.removeAgent(this)),i.enabled!==r.enabled)for(let s=0;s<i.controls.length;s++){const o=i.controls[s]+C2;this.el.setAttribute(o,{enabled:this.data.enabled})}},injectControls:function(){const r=this.data;for(let e=0;e<r.controls.length;e++){const i=r.controls[e]+C2;this.el.setAttribute(i,{enabled:this.data.enabled})}},updateNavLocation:function(){this.navGroup=null,this.navNode=null},tick:function(){const r=new THREE.Vector3,e=new THREE.Vector3,i=new THREE.Vector3;return function(n,s){if(!s)return;const o=this.el,l=this.data;if(!l.enabled)return;this.updateVelocityCtrl();const u=this.velocityCtrl,c=this.velocity;if(u)if(s/1e3>aq?c.set(0,0,0):this.updateVelocity(s),l.constrainToNavMesh&&u.isNavMeshConstrained!==!1){if(c.lengthSq()<oq)return;r.copy(o.object3D.position),e.copy(c).multiplyScalar(s/1e3).add(r);const h=o.sceneEl.systems.nav;this.navGroup=this.navGroup===null?h.getGroup(r):this.navGroup,this.navNode=this.navNode||h.getNode(r,this.navGroup),this.navNode=h.clampStep(r,e,this.navGroup,this.navNode,i),o.object3D.position.copy(i)}else o.hasAttribute("velocity")?o.setAttribute("velocity",c):(o.object3D.position.x+=c.x*s/1e3,o.object3D.position.y+=c.y*s/1e3,o.object3D.position.z+=c.z*s/1e3)}}(),updateVelocityCtrl:function(){const r=this.data;if(r.enabled){for(let e=0,i=r.controls.length;e<i;e++){const n=this.el.components[r.controls[e]+C2];if(n&&n.isVelocityActive()){this.velocityCtrl=n;return}}this.velocityCtrl=null}},updateVelocity:function(){const r=new THREE.Vector2,e=new THREE.Quaternion;return function(i){let n;const s=this.el,o=this.velocityCtrl,l=this.velocity,u=this.data;if(o)if(o.getVelocityDelta)n=o.getVelocityDelta(i);else if(o.getVelocity){l.copy(o.getVelocity());return}else if(o.getPositionDelta){l.copy(o.getPositionDelta(i).multiplyScalar(1e3/i));return}else throw new Error("Incompatible movement controls: ",o);if(s.hasAttribute("velocity")&&!u.constrainToNavMesh&&l.copy(this.el.getAttribute("velocity")),n&&u.enabled){const c=u.camera;e.copy(c.object3D.quaternion),e.premultiply(s.object3D.quaternion),n.applyQuaternion(e);const h=n.length();u.fly?(l.copy(n),l.multiplyScalar(this.data.speed*16.66667)):(r.set(n.x,n.z),r.setLength(h*this.data.speed*16.66667),l.x=r.x,l.y=0,l.z=r.y),(l.x!==0||l.y!==0||l.z!==0)&&(this.eventDetail.velocity=l,this.el.emit(lq,this.eventDetail))}}}()}),AFRAME.registerComponent("trackpad-controls",{schema:{enabled:{default:!0},enableNegX:{default:!0},enablePosX:{default:!0},enableNegZ:{default:!0},enablePosZ:{default:!0},mode:{default:"touch",oneOf:["swipe","touch","press"]}},init:function(){this.dVelocity=new THREE.Vector3,this.zVel=0,this.xVel=0,this.bindMethods()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.dVelocity.set(0,0,0)},remove:function(){this.pause()},addEventListeners:function(){const r=this.data,e=this.el.sceneEl;switch(e.addEventListener("axismove",this.onAxisMove),r.mode){case"swipe":case"touch":e.addEventListener("trackpadtouchstart",this.onTouchStart),e.addEventListener("trackpadtouchend",this.onTouchEnd);break;case"press":e.addEventListener("trackpaddown",this.onTouchStart),e.addEventListener("trackpadup",this.onTouchEnd);break}},removeEventListeners:function(){const r=this.el.sceneEl;r.removeEventListener("axismove",this.onAxisMove),r.removeEventListener("trackpadtouchstart",this.onTouchStart),r.removeEventListener("trackpadtouchend",this.onTouchEnd),r.removeEventListener("trackpaddown",this.onTouchStart),r.removeEventListener("trackpadup",this.onTouchEnd)},isVelocityActive:function(){return this.data.enabled&&this.isMoving},getVelocityDelta:function(){return this.dVelocity.z=this.isMoving?-this.zVel:1,this.dVelocity.x=this.isMoving?this.xVel:1,this.dVelocity.clone()},bindMethods:function(){this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onAxisMove=this.onAxisMove.bind(this)},onTouchStart:function(r){switch(this.data.mode){case"swipe":this.canRecordAxis=!0,this.startingAxisData=[];break;case"touch":this.isMoving=!0;break;case"press":this.isMoving=!0;break}r.preventDefault()},onTouchEnd:function(r){this.data.mode=="swipe"&&(this.startingAxisData=[]),this.isMoving=!1,r.preventDefault()},onAxisMove:function(r){switch(this.data.mode){case"swipe":return this.handleSwipeAxis(r);case"touch":case"press":return this.handleTouchAxis(r)}},handleSwipeAxis:function(r){const e=this.data,i=r.detail.axis;if(this.startingAxisData.length===0&&this.canRecordAxis&&(this.canRecordAxis=!1,this.startingAxisData[0]=i[0],this.startingAxisData[1]=i[1]),this.startingAxisData.length>0){let n=0,s=0;e.enableNegX&&i[0]<this.startingAxisData[0]&&(n=-1),e.enablePosX&&i[0]>this.startingAxisData[0]&&(n=1),e.enablePosZ&&i[1]>this.startingAxisData[1]&&(s=-1),e.enableNegZ&&i[1]<this.startingAxisData[1]&&(s=1);const o=Math.abs(this.startingAxisData[1]-i[1]);Math.abs(this.startingAxisData[0]-i[0])>o?(this.zVel=0,this.xVel=n,this.isMoving=!0):(this.xVel=0,this.zVel=s,this.isMoving=!0)}},handleTouchAxis:function(r){const e=this.data,i=r.detail.axis;let n=0,s=0;e.enableNegX&&i[0]<0&&(n=-1),e.enablePosX&&i[0]>0&&(n=1),e.enablePosZ&&i[1]>0&&(s=-1),e.enableNegZ&&i[1]<0&&(s=1),Math.abs(i[0])>Math.abs(i[1])?(this.zVel=0,this.xVel=n):(this.xVel=0,this.zVel=s)}});const hx=(r,e)=>{const i=e.x-r.x,n=e.y-r.y;return Math.sqrt(i*i+n*n)},cq=(r,e)=>{const i=e.x-r.x,n=e.y-r.y;return hq(Math.atan2(n,i))},uq=(r,e,i)=>{const n={x:0,y:0};return i=S2(i),n.x=r.x-e*Math.cos(i),n.y=r.y-e*Math.sin(i),n},S2=r=>r*(Math.PI/180),hq=r=>r*(180/Math.PI),dq=r=>isNaN(r.buttons)?r.pressure!==0:r.buttons!==0,T2=new Map,RD=r=>{T2.has(r)&&clearTimeout(T2.get(r)),T2.set(r,setTimeout(r,100))},dx=(r,e,i)=>{const n=e.split(/[ ,]+/g);let s;for(let o=0;o<n.length;o+=1)s=n[o],r.addEventListener?r.addEventListener(s,i,!1):r.attachEvent&&r.attachEvent(s,i)},ID=(r,e,i)=>{const n=e.split(/[ ,]+/g);let s;for(let o=0;o<n.length;o+=1)s=n[o],r.removeEventListener?r.removeEventListener(s,i):r.detachEvent&&r.detachEvent(s,i)},BD=r=>(r.preventDefault(),r.type.match(/^touch/)?r.changedTouches:r),ND=()=>{const r=window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,e=window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;return{x:r,y:e}},LD=(r,e)=>{e.top||e.right||e.bottom||e.left?(r.style.top=e.top,r.style.right=e.right,r.style.bottom=e.bottom,r.style.left=e.left):(r.style.left=e.x+"px",r.style.top=e.y+"px")},M2=(r,e,i)=>{const n=DD(r);for(let s in n)if(n.hasOwnProperty(s))if(typeof e=="string")n[s]=e+" "+i;else{let o="";for(let l=0,u=e.length;l<u;l+=1)o+=e[l]+" "+i+", ";n[s]=o.slice(0,-2)}return n},pq=(r,e)=>{const i=DD(r);for(let n in i)i.hasOwnProperty(n)&&(i[n]=e);return i},DD=r=>{const e={};return e[r]="",["webkit","Moz","o"].forEach(function(i){e[i+r.charAt(0).toUpperCase()+r.slice(1)]=""}),e},R2=(r,e)=>{for(let i in e)e.hasOwnProperty(i)&&(r[i]=e[i]);return r},fq=(r,e)=>{const i={};for(let n in r)r.hasOwnProperty(n)&&e.hasOwnProperty(n)?i[n]=e[n]:r.hasOwnProperty(n)&&(i[n]=r[n]);return i},I2=(r,e)=>{if(r.length)for(let i=0,n=r.length;i<n;i+=1)e(r[i]);else e(r)},mq=(r,e,i)=>({x:Math.min(Math.max(r.x,e.x-i),e.x+i),y:Math.min(Math.max(r.y,e.y-i),e.y+i)});var gq="ontouchstart"in window,Aq=!!window.PointerEvent,yq=!!window.MSPointerEvent,Q0={touch:{start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},pointer:{start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"},MSPointer:{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}},Uf,q0={};Aq?Uf=Q0.pointer:yq?Uf=Q0.MSPointer:gq?(Uf=Q0.touch,q0=Q0.mouse):Uf=Q0.mouse;function uu(){}uu.prototype.on=function(r,e){var i=this,n=r.split(/[ ,]+/g),s;i._handlers_=i._handlers_||{};for(var o=0;o<n.length;o+=1)s=n[o],i._handlers_[s]=i._handlers_[s]||[],i._handlers_[s].push(e);return i},uu.prototype.off=function(r,e){var i=this;return i._handlers_=i._handlers_||{},r===void 0?i._handlers_={}:e===void 0?i._handlers_[r]=null:i._handlers_[r]&&i._handlers_[r].indexOf(e)>=0&&i._handlers_[r].splice(i._handlers_[r].indexOf(e),1),i},uu.prototype.trigger=function(r,e){var i=this,n=r.split(/[ ,]+/g),s;i._handlers_=i._handlers_||{};for(var o=0;o<n.length;o+=1)s=n[o],i._handlers_[s]&&i._handlers_[s].length&&i._handlers_[s].forEach(function(l){l.call(i,{type:s,target:i},e)})},uu.prototype.config=function(r){var e=this;e.options=e.defaults||{},r&&(e.options=fq(e.options,r))},uu.prototype.bindEvt=function(r,e){var i=this;return i._domHandlers_=i._domHandlers_||{},i._domHandlers_[e]=function(){typeof i["on"+e]=="function"?i["on"+e].apply(i,arguments):console.warn('[WARNING] : Missing "on'+e+'" handler.')},dx(r,Uf[e],i._domHandlers_[e]),q0[e]&&dx(r,q0[e],i._domHandlers_[e]),i},uu.prototype.unbindEvt=function(r,e){var i=this;return i._domHandlers_=i._domHandlers_||{},ID(r,Uf[e],i._domHandlers_[e]),q0[e]&&ID(r,q0[e],i._domHandlers_[e]),delete i._domHandlers_[e],this};function pa(r,e){return this.identifier=e.identifier,this.position=e.position,this.frontPosition=e.frontPosition,this.collection=r,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(e),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=pa.id,pa.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}pa.prototype=new uu,pa.constructor=pa,pa.id=0,pa.prototype.buildEl=function(r){return this.ui={},this.options.dataOnly?this:(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this)},pa.prototype.stylize=function(){if(this.options.dataOnly)return this;var r=this.options.fadeTime+"ms",e=pq("borderRadius","50%"),i=M2("transition","opacity",r),n={};return n.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},n.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",left:0,marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:this.options.color,opacity:".5"},n.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",left:0,marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:this.options.color,opacity:".5",transform:"translate(0px, 0px)"},R2(n.el,i),this.options.shape==="circle"&&R2(n.back,e),R2(n.front,e),this.applyStyles(n),this},pa.prototype.applyStyles=function(r){for(var e in this.ui)if(this.ui.hasOwnProperty(e))for(var i in r[e])this.ui[e].style[i]=r[e][i];return this},pa.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)?this:(this.options.zone.appendChild(this.ui.el),this)},pa.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)?this:(this.options.zone.removeChild(this.ui.el),this)},pa.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()},pa.prototype.show=function(r){var e=this;return e.options.dataOnly||(clearTimeout(e.removeTimeout),clearTimeout(e.showTimeout),clearTimeout(e.restTimeout),e.addToDom(),e.restCallback(),setTimeout(function(){e.ui.el.style.opacity=1},0),e.showTimeout=setTimeout(function(){e.trigger("shown",e.instance),typeof r=="function"&&r.call(this)},e.options.fadeTime)),e},pa.prototype.hide=function(r){var e=this;if(e.options.dataOnly)return e;if(e.ui.el.style.opacity=e.options.restOpacity,clearTimeout(e.removeTimeout),clearTimeout(e.showTimeout),clearTimeout(e.restTimeout),e.removeTimeout=setTimeout(function(){var i=e.options.mode==="dynamic"?"none":"block";e.ui.el.style.display=i,typeof r=="function"&&r.call(e),e.trigger("hidden",e.instance)},e.options.fadeTime),e.options.restJoystick){const i=e.options.restJoystick,n={};n.x=i===!0||i.x!==!1?0:e.instance.frontPosition.x,n.y=i===!0||i.y!==!1?0:e.instance.frontPosition.y,e.setPosition(r,n)}return e},pa.prototype.setPosition=function(r,e){var i=this;i.frontPosition={x:e.x,y:e.y};var n=i.options.fadeTime+"ms",s={};s.front=M2("transition",["transform"],n);var o={front:{}};o.front={transform:"translate("+i.frontPosition.x+"px,"+i.frontPosition.y+"px)"},i.applyStyles(s),i.applyStyles(o),i.restTimeout=setTimeout(function(){typeof r=="function"&&r.call(i),i.restCallback()},i.options.fadeTime)},pa.prototype.restCallback=function(){var r=this,e={};e.front=M2("transition","none",""),r.applyStyles(e),r.trigger("rested",r.instance)},pa.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}},pa.prototype.computeDirection=function(r){var e=r.angle.radian,i=Math.PI/4,n=Math.PI/2,s,o,l;if(e>i&&e<i*3&&!r.lockX?s="up":e>-i&&e<=i&&!r.lockY?s="left":e>-i*3&&e<=-i&&!r.lockX?s="down":r.lockY||(s="right"),r.lockY||(e>-n&&e<n?o="left":o="right"),r.lockX||(e>0?l="up":l="down"),r.force>this.options.threshold){var u={},c;for(c in this.direction)this.direction.hasOwnProperty(c)&&(u[c]=this.direction[c]);var h={};this.direction={x:o,y:l,angle:s},r.direction=this.direction;for(c in u)u[c]===this.direction[c]&&(h[c]=!0);if(h.x&&h.y&&h.angle)return r;(!h.x||!h.y)&&this.trigger("plain",r),h.x||this.trigger("plain:"+o,r),h.y||this.trigger("plain:"+l,r),h.angle||this.trigger("dir dir:"+s,r)}else this.resetDirection();return r};function Gs(r,e){var i=this;i.nipples=[],i.idles=[],i.actives=[],i.ids=[],i.pressureIntervals={},i.manager=r,i.id=Gs.id,Gs.id+=1,i.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},i.config(e),(i.options.mode==="static"||i.options.mode==="semi")&&(i.options.multitouch=!1),i.options.multitouch||(i.options.maxNumberOfNipples=1);const n=getComputedStyle(i.options.zone.parentElement);return n&&n.display==="flex"&&(i.parentIsFlex=!0),i.updateBox(),i.prepareNipples(),i.bindings(),i.begin(),i.nipples}Gs.prototype=new uu,Gs.constructor=Gs,Gs.id=0,Gs.prototype.prepareNipples=function(){var r=this,e=r.nipples;e.on=r.on.bind(r),e.off=r.off.bind(r),e.options=r.options,e.destroy=r.destroy.bind(r),e.ids=r.ids,e.id=r.id,e.processOnMove=r.processOnMove.bind(r),e.processOnEnd=r.processOnEnd.bind(r),e.get=function(i){if(i===void 0)return e[0];for(var n=0,s=e.length;n<s;n+=1)if(e[n].identifier===i)return e[n];return!1}},Gs.prototype.bindings=function(){var r=this;r.bindEvt(r.options.zone,"start"),r.options.zone.style.touchAction="none",r.options.zone.style.msTouchAction="none"},Gs.prototype.begin=function(){var r=this,e=r.options;if(e.mode==="static"){var i=r.createNipple(e.position,r.manager.getIdentifier());i.add(),r.idles.push(i)}},Gs.prototype.createNipple=function(r,e){var i=this,n=i.manager.scroll,s={},o=i.options,l={x:i.parentIsFlex?n.x:n.x+i.box.left,y:i.parentIsFlex?n.y:n.y+i.box.top};if(r.x&&r.y)s={x:r.x-l.x,y:r.y-l.y};else if(r.top||r.right||r.bottom||r.left){var u=document.createElement("DIV");u.style.display="hidden",u.style.top=r.top,u.style.right=r.right,u.style.bottom=r.bottom,u.style.left=r.left,u.style.position="absolute",o.zone.appendChild(u);var c=u.getBoundingClientRect();o.zone.removeChild(u),s=r,r={x:c.left+n.x,y:c.top+n.y}}var h=new pa(i,{color:o.color,size:o.size,threshold:o.threshold,fadeTime:o.fadeTime,dataOnly:o.dataOnly,restJoystick:o.restJoystick,restOpacity:o.restOpacity,mode:o.mode,identifier:e,position:r,zone:o.zone,frontPosition:{x:0,y:0},shape:o.shape});return o.dataOnly||(LD(h.ui.el,s),LD(h.ui.front,h.frontPosition)),i.nipples.push(h),i.trigger("added "+h.identifier+":added",h),i.manager.trigger("added "+h.identifier+":added",h),i.bindNipple(h),h},Gs.prototype.updateBox=function(){var r=this;r.box=r.options.zone.getBoundingClientRect()},Gs.prototype.bindNipple=function(r){var e=this,i,n=function(s,o){i=s.type+" "+o.id+":"+s.type,e.trigger(i,o)};r.on("destroyed",e.onDestroyed.bind(e)),r.on("shown hidden rested dir plain",n),r.on("dir:up dir:right dir:down dir:left",n),r.on("plain:up plain:right plain:down plain:left",n)},Gs.prototype.pressureFn=function(r,e,i){var n=this,s=0;clearInterval(n.pressureIntervals[i]),n.pressureIntervals[i]=setInterval((function(){var o=r.force||r.pressure||r.webkitForce||0;o!==s&&(e.trigger("pressure",o),n.trigger("pressure "+e.identifier+":pressure",o),s=o)}).bind(n),100)},Gs.prototype.onstart=function(r){var e=this,i=e.options,n=r;r=BD(r),e.updateBox();var s=function(o){e.actives.length<i.maxNumberOfNipples?e.processOnStart(o):n.type.match(/^touch/)&&(Object.keys(e.manager.ids).forEach(function(l){if(Object.values(n.touches).findIndex(function(c){return c.identifier===l})<0){var u=[r[0]];u.identifier=l,e.processOnEnd(u)}}),e.actives.length<i.maxNumberOfNipples&&e.processOnStart(o))};return I2(r,s),e.manager.bindDocument(),!1},Gs.prototype.processOnStart=function(r){var e=this,i=e.options,n,s=e.manager.getIdentifier(r),o=r.force||r.pressure||r.webkitForce||0,l={x:r.pageX,y:r.pageY},u=e.getOrCreate(s,l);u.identifier!==s&&e.manager.removeIdentifier(u.identifier),u.identifier=s;var c=function(p){p.trigger("start",p),e.trigger("start "+p.id+":start",p),p.show(),o>0&&e.pressureFn(r,p,p.identifier),e.processOnMove(r)};if((n=e.idles.indexOf(u))>=0&&e.idles.splice(n,1),e.actives.push(u),e.ids.push(u.identifier),i.mode!=="semi")c(u);else{var h=hx(l,u.position);if(h<=i.catchDistance)c(u);else{u.destroy(),e.processOnStart(r);return}}return u},Gs.prototype.getOrCreate=function(r,e){var i=this,n=i.options,s;return/(semi|static)/.test(n.mode)?(s=i.idles[0],s?(i.idles.splice(0,1),s):n.mode==="semi"?i.createNipple(e,r):(console.warn("Coudln't find the needed nipple."),!1)):(s=i.createNipple(e,r),s)},Gs.prototype.processOnMove=function(r){var e=this,i=e.options,n=e.manager.getIdentifier(r),s=e.nipples.get(n),o=e.manager.scroll;if(!dq(r)){this.processOnEnd(r);return}if(!s){console.error("Found zombie joystick with ID "+n),e.manager.removeIdentifier(n);return}if(i.dynamicPage){var l=s.el.getBoundingClientRect();s.position={x:o.x+l.left,y:o.y+l.top}}s.identifier=n;var u=s.options.size/2,c={x:r.pageX,y:r.pageY};i.lockX&&(c.y=s.position.y),i.lockY&&(c.x=s.position.x);var h=hx(c,s.position),p=cq(c,s.position),f=S2(p),m=h/u,g={distance:h,position:c},y,x;if(s.options.shape==="circle"?(y=Math.min(h,u),x=uq(s.position,y,p)):(x=mq(c,s.position,u),y=hx(x,s.position)),i.follow){if(h>u){let w=c.x-x.x,S=c.y-x.y;s.position.x+=w,s.position.y+=S,s.el.style.top=s.position.y-(e.box.top+o.y)+"px",s.el.style.left=s.position.x-(e.box.left+o.x)+"px",h=hx(c,s.position)}}else c=x,h=y;var v=c.x-s.position.x,_=c.y-s.position.y;s.frontPosition={x:v,y:_},i.dataOnly||(s.ui.front.style.transform="translate("+v+"px,"+_+"px)");var T={identifier:s.identifier,position:c,force:m,pressure:r.force||r.pressure||r.webkitForce||0,distance:h,angle:{radian:f,degree:p},vector:{x:v/u,y:-_/u},raw:g,instance:s,lockX:i.lockX,lockY:i.lockY};T=s.computeDirection(T),T.angle={radian:S2(180-p),degree:180-p},s.trigger("move",T),e.trigger("move "+s.id+":move",T)},Gs.prototype.processOnEnd=function(r){var e=this,i=e.options,n=e.manager.getIdentifier(r),s=e.nipples.get(n),o=e.manager.removeIdentifier(s.identifier);s&&(i.dataOnly||s.hide(function(){i.mode==="dynamic"&&(s.trigger("removed",s),e.trigger("removed "+s.id+":removed",s),e.manager.trigger("removed "+s.id+":removed",s),s.destroy())}),clearInterval(e.pressureIntervals[s.identifier]),s.resetDirection(),s.trigger("end",s),e.trigger("end "+s.id+":end",s),e.ids.indexOf(s.identifier)>=0&&e.ids.splice(e.ids.indexOf(s.identifier),1),e.actives.indexOf(s)>=0&&e.actives.splice(e.actives.indexOf(s),1),/(semi|static)/.test(i.mode)?e.idles.push(s):e.nipples.indexOf(s)>=0&&e.nipples.splice(e.nipples.indexOf(s),1),e.manager.unbindDocument(),/(semi|static)/.test(i.mode)&&(e.manager.ids[o.id]=o.identifier))},Gs.prototype.onDestroyed=function(r,e){var i=this;i.nipples.indexOf(e)>=0&&i.nipples.splice(i.nipples.indexOf(e),1),i.actives.indexOf(e)>=0&&i.actives.splice(i.actives.indexOf(e),1),i.idles.indexOf(e)>=0&&i.idles.splice(i.idles.indexOf(e),1),i.ids.indexOf(e.identifier)>=0&&i.ids.splice(i.ids.indexOf(e.identifier),1),i.manager.removeIdentifier(e.identifier),i.manager.unbindDocument()},Gs.prototype.destroy=function(){var r=this;r.unbindEvt(r.options.zone,"start"),r.nipples.forEach(function(i){i.destroy()});for(var e in r.pressureIntervals)r.pressureIntervals.hasOwnProperty(e)&&clearInterval(r.pressureIntervals[e]);r.trigger("destroyed",r.nipples),r.manager.unbindDocument(),r.off()};function Ca(r){var e=this;e.ids={},e.index=0,e.collections=[],e.scroll=ND(),e.config(r),e.prepareCollections();var i=function(){var s;e.collections.forEach(function(o){o.forEach(function(l){s=l.el.getBoundingClientRect(),l.position={x:e.scroll.x+s.left,y:e.scroll.y+s.top}})})};dx(window,"resize",function(){RD(i)});var n=function(){e.scroll=ND()};return dx(window,"scroll",function(){RD(n)}),e.collections}Ca.prototype=new uu,Ca.constructor=Ca,Ca.prototype.prepareCollections=function(){var r=this;r.collections.create=r.create.bind(r),r.collections.on=r.on.bind(r),r.collections.off=r.off.bind(r),r.collections.destroy=r.destroy.bind(r),r.collections.get=function(e){var i;return r.collections.every(function(n){return i=n.get(e),!i}),i}},Ca.prototype.create=function(r){return this.createCollection(r)},Ca.prototype.createCollection=function(r){var e=this,i=new Gs(e,r);return e.bindCollection(i),e.collections.push(i),i},Ca.prototype.bindCollection=function(r){var e=this,i,n=function(s,o){i=s.type+" "+o.id+":"+s.type,e.trigger(i,o)};r.on("destroyed",e.onDestroyed.bind(e)),r.on("shown hidden rested dir plain",n),r.on("dir:up dir:right dir:down dir:left",n),r.on("plain:up plain:right plain:down plain:left",n)},Ca.prototype.bindDocument=function(){var r=this;r.binded||(r.bindEvt(document,"move").bindEvt(document,"end"),r.binded=!0)},Ca.prototype.unbindDocument=function(r){var e=this;(!Object.keys(e.ids).length||r===!0)&&(e.unbindEvt(document,"move").unbindEvt(document,"end"),e.binded=!1)},Ca.prototype.getIdentifier=function(r){var e;return r?(e=r.identifier===void 0?r.pointerId:r.identifier,e===void 0&&(e=this.latest||0)):e=this.index,this.ids[e]===void 0&&(this.ids[e]=this.index,this.index+=1),this.latest=e,this.ids[e]},Ca.prototype.removeIdentifier=function(r){var e={};for(var i in this.ids)if(this.ids[i]===r){e.id=i,e.identifier=this.ids[i],delete this.ids[i];break}return e},Ca.prototype.onmove=function(r){var e=this;return e.onAny("move",r),!1},Ca.prototype.onend=function(r){var e=this;return e.onAny("end",r),!1},Ca.prototype.oncancel=function(r){var e=this;return e.onAny("end",r),!1},Ca.prototype.onAny=function(r,e){var i=this,n,s="processOn"+r.charAt(0).toUpperCase()+r.slice(1);e=BD(e);var o=function(u,c,h){h.ids.indexOf(c)>=0&&(h[s](u),u._found_=!0)},l=function(u){n=i.getIdentifier(u),I2(i.collections,o.bind(null,u,n)),u._found_||i.removeIdentifier(n)};return I2(e,l),!1},Ca.prototype.destroy=function(){var r=this;r.unbindDocument(!0),r.ids={},r.index=0,r.collections.forEach(function(e){e.destroy()}),r.off()},Ca.prototype.onDestroyed=function(r,e){var i=this;if(i.collections.indexOf(e)<0)return!1;i.collections.splice(i.collections.indexOf(e),1)};const OD=new Ca,PD={create:function(r){return OD.create(r)},factory:OD};AFRAME.registerComponent("nipple-controls",{schema:{enabled:{default:!0},mode:{default:"dynamic",oneOf:["static","semi","dynamic"]},rotationSensitivity:{default:1},moveJoystickEnabled:{default:!0},lookJoystickEnabled:{default:!0},sideMargin:{default:"30px"},bottomMargin:{default:"70px"},moveJoystickPosition:{default:"left",oneOf:["left","right"]},lookJoystickPosition:{default:"right",oneOf:["left","right"]}},init(){this.dVelocity=new THREE.Vector3,this.lookVector=new THREE.Vector2;const r=this.el.querySelector("[look-controls]").components["look-controls"];this.pitchObject=r.pitchObject,this.yawObject=r.yawObject,this.rigRotation=this.el.object3D.rotation,this.moveData=void 0,this.lookData=void 0,this.moving=!1,this.rotating=!1},update(r){(this.data.moveJoystickPosition!==r.moveJoystickPosition||this.data.sideMargin!==r.sideMargin||this.data.bottomMargin!==r.bottomMargin||this.data.mode!==r.mode)&&this.removeMoveJoystick(),(this.data.lookJoystickPosition!==r.lookJoystickPosition||this.data.sideMargin!==r.sideMargin||this.data.bottomMargin!==r.bottomMargin||this.data.mode!==r.mode)&&this.removeLookJoystick(),this.data.enabled&&this.data.moveJoystickEnabled?this.createMoveJoystick():this.removeMoveJoystick(),this.data.enabled&&this.data.lookJoystickEnabled?this.createLookJoystick():this.removeLookJoystick()},pause(){this.moving=!1,this.rotating=!1},remove(){this.removeMoveJoystick(),this.removeLookJoystick()},isVelocityActive(){return this.data.enabled&&this.moving},getVelocityDelta(){if(this.dVelocity.set(0,0,0),this.isVelocityActive()){const r=this.moveData.force<1?this.moveData.force:1,e=this.moveData.angle.radian,i=Math.cos(e)*r,n=-Math.sin(e)*r;this.dVelocity.set(i,0,n)}return this.dVelocity},isRotationActive(){return this.data.enabled&&this.rotating},updateRotation(r){if(!this.isRotationActive())return;const e=this.lookData.force<1?this.lookData.force:1,i=this.lookData.angle.radian,n=this.lookVector;n.x=Math.cos(i)*e,n.y=Math.sin(i)*e,n.multiplyScalar(this.data.rotationSensitivity*r/1e3),this.yawObject.rotation.y-=n.x;let s=this.pitchObject.rotation.x+n.y;s=Math.max(-Math.PI/2,Math.min(Math.PI/2,s)),this.pitchObject.rotation.x=s},tick:function(r,e){this.updateRotation(e)},initLeftZone(){const r=document.createElement("div");r.setAttribute("id","joystickLeftZone"),r.setAttribute("style",`position:absolute;${this.data.moveJoystickPosition}:${this.data.sideMargin};bottom:${this.data.bottomMargin};z-index:1`),document.body.appendChild(r),this.leftZone=r},initRightZone(){const r=document.createElement("div");r.setAttribute("id","joystickRightZone"),r.setAttribute("style",`position:absolute;${this.data.lookJoystickPosition}:${this.data.sideMargin};bottom:${this.data.bottomMargin};z-index:1`),document.body.appendChild(r),this.rightZone=r},createMoveJoystick(){if(this.moveJoystick)return;this.initLeftZone();const r={mode:this.data.mode,zone:this.leftZone,color:"white",fadeTime:0};this.leftZone.style.width="100px",this.data.mode==="static"?(this.leftZone.style.height="100px",r.position={left:"50%",bottom:"50%"}):this.leftZone.style.height="400px",this.moveJoystick=PD.create(r),this.moveJoystick.on("move",(e,i)=>{this.moveData=i,this.moving=!0}),this.moveJoystick.on("end",(e,i)=>{this.moving=!1})},createLookJoystick(){if(this.lookJoystick)return;this.initRightZone();const r={mode:this.data.mode,zone:this.rightZone,color:"white",fadeTime:0};this.rightZone.style.width="100px",this.data.mode==="static"?(this.rightZone.style.height="100px",r.position={left:"50%",bottom:"50%"}):this.rightZone.style.height="400px",this.lookJoystick=PD.create(r),this.lookJoystick.on("move",(e,i)=>{this.lookData=i,this.rotating=!0}),this.lookJoystick.on("end",(e,i)=>{this.rotating=!1})},removeMoveJoystick(){this.moveJoystick&&(this.moveJoystick.destroy(),this.moveJoystick=void 0),this.moveData=void 0,this.leftZone&&this.leftZone.parentNode&&(this.leftZone.remove(),this.leftZone=void 0)},removeLookJoystick(){this.lookJoystick&&(this.lookJoystick.destroy(),this.lookJoystick=void 0),this.lookData=void 0,this.rightZone&&this.rightZone.parentNode&&(this.rightZone.remove(),this.rightZone=void 0)}});const B2={once:THREE.LoopOnce,repeat:THREE.LoopRepeat,pingpong:THREE.LoopPingPong};AFRAME.registerComponent("animation-mixer",{schema:{clip:{default:"*"},useRegExp:{default:!1},duration:{default:0},clampWhenFinished:{default:!1,type:"boolean"},crossFadeDuration:{default:0},loop:{default:"repeat",oneOf:Object.keys(B2)},repetitions:{default:1/0,min:0},timeScale:{default:1},startAt:{default:0}},init:function(){this.model=null,this.mixer=null,this.activeActions=[];const r=this.el.getObject3D("mesh");r?this.load(r):this.el.addEventListener("model-loaded",e=>{this.load(e.detail.model)})},load:function(r){const e=this.el;this.model=r,this.mixer=new THREE.AnimationMixer(r),this.mixer.addEventListener("loop",i=>{e.emit("animation-loop",{action:i.action,loopDelta:i.loopDelta})}),this.mixer.addEventListener("finished",i=>{e.emit("animation-finished",{action:i.action,direction:i.direction})}),this.data.clip&&this.update({})},remove:function(){this.mixer&&this.mixer.stopAllAction()},update:function(r){if(!r)return;const e=this.data,i=AFRAME.utils.diff(e,r);if("clip"in i){this.stopAction(),e.clip&&this.playAction();return}this.activeActions.forEach(n=>{"duration"in i&&e.duration&&n.setDuration(e.duration),"clampWhenFinished"in i&&(n.clampWhenFinished=e.clampWhenFinished),("loop"in i||"repetitions"in i)&&n.setLoop(B2[e.loop],e.repetitions),"timeScale"in i&&n.setEffectiveTimeScale(e.timeScale)})},stopAction:function(){const r=this.data;for(let e=0;e<this.activeActions.length;e++)r.crossFadeDuration?this.activeActions[e].fadeOut(r.crossFadeDuration):this.activeActions[e].stop();this.activeActions.length=0},playAction:function(){if(!this.mixer)return;const r=this.model,e=this.data,i=r.animations||(r.geometry||{}).animations||[];if(!i.length)return;const n=e.useRegExp?e.clip:vq(e.clip);for(let s,o=0;s=i[o];o++)if(s.name.match(n)){const l=this.mixer.clipAction(s,r);l.enabled=!0,l.clampWhenFinished=e.clampWhenFinished,e.duration&&l.setDuration(e.duration),e.timeScale!==1&&l.setEffectiveTimeScale(e.timeScale),l.startAt(this.mixer.time-e.startAt/1e3),l.setLoop(B2[e.loop],e.repetitions).fadeIn(e.crossFadeDuration).play(),this.activeActions.push(l)}},tick:function(r,e){this.mixer&&!isNaN(e)&&this.mixer.update(e/1e3)}});function vq(r){return new RegExp("^"+r.split(/\*+/).map(xq).join(".*")+"$")}function xq(r){return r.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&")}var bq=THREE.ColladaLoader=function(r){this.manager=r!==void 0?r:THREE.DefaultLoadingManager};THREE.ColladaLoader.prototype={constructor:THREE.ColladaLoader,crossOrigin:"anonymous",load:function(r,e,i,n){var s=this,o=s.path===void 0?THREE.LoaderUtils.extractUrlBase(r):s.path,l=new THREE.FileLoader(s.manager);l.setPath(s.path),l.load(r,function(u){e(s.parse(u,o))},i,n)},setPath:function(r){return this.path=r,this},setResourcePath:function(r){return this.resourcePath=r,this},options:{set convertUpAxis(r){console.warn("THREE.ColladaLoader: options.convertUpAxis() has been removed. Up axis is converted automatically.")}},setCrossOrigin:function(r){return this.crossOrigin=r,this},parse:function(r,e){function i(he,le){for(var pe=[],be=he.childNodes,Ee=0,st=be.length;Ee<st;Ee++){var Ct=be[Ee];Ct.nodeName===le&&pe.push(Ct)}return pe}function n(he){if(he.length===0)return[];for(var le=he.trim().split(/\s+/),pe=new Array(le.length),be=0,Ee=le.length;be<Ee;be++)pe[be]=le[be];return pe}function s(he){if(he.length===0)return[];for(var le=he.trim().split(/\s+/),pe=new Array(le.length),be=0,Ee=le.length;be<Ee;be++)pe[be]=parseFloat(le[be]);return pe}function o(he){if(he.length===0)return[];for(var le=he.trim().split(/\s+/),pe=new Array(le.length),be=0,Ee=le.length;be<Ee;be++)pe[be]=parseInt(le[be]);return pe}function l(he){return he.substring(1)}function u(){return"three_default_"+We++}function c(he){return Object.keys(he).length===0}function h(he){return{unit:p(i(he,"unit")[0]),upAxis:f(i(he,"up_axis")[0])}}function p(he){return he!==void 0&&he.hasAttribute("meter")===!0?parseFloat(he.getAttribute("meter")):1}function f(he){return he!==void 0?he.textContent:"Y_UP"}function m(he,le,pe,be){var Ee=i(he,le)[0];if(Ee!==void 0)for(var st=i(Ee,pe),Ct=0;Ct<st.length;Ct++)be(st[Ct])}function g(he,le){for(var pe in he){var be=he[pe];be.build=le(he[pe])}}function y(he,le){return he.build!==void 0||(he.build=le(he)),he.build}function x(he){for(var le={sources:{},samplers:{},channels:{}},pe=0,be=he.childNodes.length;pe<be;pe++){var Ee=he.childNodes[pe];if(Ee.nodeType===1){var st;switch(Ee.nodeName){case"source":st=Ee.getAttribute("id"),le.sources[st]=ce(Ee);break;case"sampler":st=Ee.getAttribute("id"),le.samplers[st]=v(Ee);break;case"channel":st=Ee.getAttribute("target"),le.channels[st]=_(Ee);break;default:console.log(Ee)}}}Ye.animations[he.getAttribute("id")]=le}function v(he){for(var le={inputs:{}},pe=0,be=he.childNodes.length;pe<be;pe++){var Ee=he.childNodes[pe];if(Ee.nodeType===1)switch(Ee.nodeName){case"input":var st=l(Ee.getAttribute("source")),Ct=Ee.getAttribute("semantic");le.inputs[Ct]=st;break}}return le}function _(he){var le={},pe=he.getAttribute("target"),be=pe.split("/"),Ee=be.shift(),st=be.shift(),Ct=st.indexOf("(")!==-1,Ht=st.indexOf(".")!==-1;if(Ht)be=st.split("."),st=be.shift(),le.member=be.shift();else if(Ct){var ii=st.split("(");st=ii.shift();for(var Ai=0;Ai<ii.length;Ai++)ii[Ai]=parseInt(ii[Ai].replace(/\)/,""));le.indices=ii}return le.id=Ee,le.sid=st,le.arraySyntax=Ct,le.memberSyntax=Ht,le.sampler=l(he.getAttribute("source")),le}function T(he){var le=[],pe=he.channels,be=he.samplers,Ee=he.sources;for(var st in pe)if(pe.hasOwnProperty(st)){var Ct=pe[st],Ht=be[Ct.sampler],ii=Ht.inputs.INPUT,Ai=Ht.inputs.OUTPUT,Wt=Ee[ii],Ni=Ee[Ai],xr=S(Ct,Wt,Ni);L(xr,le)}return le}function w(he){return y(Ye.animations[he],T)}function S(he,le,pe){var be=Ye.nodes[he.id],Ee=Fi(be.id),st=be.transforms[he.sid],Ct=be.matrix.clone().transpose(),Ht,ii,Ai,Wt,Ni,xr,pr={};switch(st){case"matrix":for(Ai=0,Wt=le.array.length;Ai<Wt;Ai++)if(Ht=le.array[Ai],ii=Ai*pe.stride,pr[Ht]===void 0&&(pr[Ht]={}),he.arraySyntax===!0){var fr=pe.array[ii],Wi=he.indices[0]+4*he.indices[1];pr[Ht][Wi]=fr}else for(Ni=0,xr=pe.stride;Ni<xr;Ni++)pr[Ht][Ni]=pe.array[ii+Ni];break;case"translate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',st);break;case"rotate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',st);break;case"scale":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',st);break}var Cr=R(pr,Ct),Mr={name:Ee.uuid,keyframes:Cr};return Mr}function R(he,le){var pe=[];for(var be in he)pe.push({time:parseFloat(be),value:he[be]});pe.sort(st);for(var Ee=0;Ee<16;Ee++)O(pe,Ee,le.elements[Ee]);return pe;function st(Ct,Ht){return Ct.time-Ht.time}}var B=new THREE.Vector3,I=new THREE.Vector3,D=new THREE.Quaternion;function L(he,le){for(var pe=he.keyframes,be=he.name,Ee=[],st=[],Ct=[],Ht=[],ii=0,Ai=pe.length;ii<Ai;ii++){var Wt=pe[ii],Ni=Wt.time,xr=Wt.value;ge.fromArray(xr).transpose(),ge.decompose(B,D,I),Ee.push(Ni),st.push(B.x,B.y,B.z),Ct.push(D.x,D.y,D.z,D.w),Ht.push(I.x,I.y,I.z)}return st.length>0&&le.push(new THREE.VectorKeyframeTrack(be+".position",Ee,st)),Ct.length>0&&le.push(new THREE.QuaternionKeyframeTrack(be+".quaternion",Ee,Ct)),Ht.length>0&&le.push(new THREE.VectorKeyframeTrack(be+".scale",Ee,Ht)),le}function O(he,le,pe){var be,Ee=!0,st,Ct;for(st=0,Ct=he.length;st<Ct;st++)be=he[st],be.value[le]===void 0?be.value[le]=null:Ee=!1;if(Ee===!0)for(st=0,Ct=he.length;st<Ct;st++)be=he[st],be.value[le]=pe;else U(he,le)}function U(he,le){for(var pe,be,Ee=0,st=he.length;Ee<st;Ee++){var Ct=he[Ee];if(Ct.value[le]===null){if(pe=Z(he,Ee,le),be=G(he,Ee,le),pe===null){Ct.value[le]=be.value[le];continue}if(be===null){Ct.value[le]=pe.value[le];continue}z(Ct,pe,be,le)}}}function Z(he,le,pe){for(;le>=0;){var be=he[le];if(be.value[pe]!==null)return be;le--}return null}function G(he,le,pe){for(;le<he.length;){var be=he[le];if(be.value[pe]!==null)return be;le++}return null}function z(he,le,pe,be){if(pe.time-le.time===0){he.value[be]=le.value[be];return}he.value[be]=(he.time-le.time)*(pe.value[be]-le.value[be])/(pe.time-le.time)+le.value[be]}function $(he){for(var le={name:he.getAttribute("id")||"default",start:parseFloat(he.getAttribute("start")||0),end:parseFloat(he.getAttribute("end")||0),animations:[]},pe=0,be=he.childNodes.length;pe<be;pe++){var Ee=he.childNodes[pe];if(Ee.nodeType===1)switch(Ee.nodeName){case"instance_animation":le.animations.push(l(Ee.getAttribute("url")));break}}Ye.clips[he.getAttribute("id")]=le}function Q(he){for(var le=[],pe=he.name,be=he.end-he.start||-1,Ee=he.animations,st=0,Ct=Ee.length;st<Ct;st++)for(var Ht=w(Ee[st]),ii=0,Ai=Ht.length;ii<Ai;ii++)le.push(Ht[ii]);return new THREE.AnimationClip(pe,be,le)}function H(he){return y(Ye.clips[he],Q)}function V(he){for(var le={},pe=0,be=he.childNodes.length;pe<be;pe++){var Ee=he.childNodes[pe];if(Ee.nodeType===1)switch(Ee.nodeName){case"skin":le.id=l(Ee.getAttribute("source")),le.skin=ne(Ee);break;case"morph":le.id=l(Ee.getAttribute("source")),console.warn("THREE.ColladaLoader: Morph target animation not supported yet.");break}}Ye.controllers[he.getAttribute("id")]=le}function ne(he){for(var le={sources:{}},pe=0,be=he.childNodes.length;pe<be;pe++){var Ee=he.childNodes[pe];if(Ee.nodeType===1)switch(Ee.nodeName){case"bind_shape_matrix":le.bindShapeMatrix=s(Ee.textContent);break;case"source":var st=Ee.getAttribute("id");le.sources[st]=ce(Ee);break;case"joints":le.joints=Y(Ee);break;case"vertex_weights":le.vertexWeights=ae(Ee);break}}return le}function Y(he){for(var le={inputs:{}},pe=0,be=he.childNodes.length;pe<be;pe++){var Ee=he.childNodes[pe];if(Ee.nodeType===1)switch(Ee.nodeName){case"input":var st=Ee.getAttribute("semantic"),Ct=l(Ee.getAttribute("source"));le.inputs[st]=Ct;break}}return le}function ae(he){for(var le={inputs:{}},pe=0,be=he.childNodes.length;pe<be;pe++){var Ee=he.childNodes[pe];if(Ee.nodeType===1)switch(Ee.nodeName){case"input":var st=Ee.getAttribute("semantic"),Ct=l(Ee.getAttribute("source")),Ht=parseInt(Ee.getAttribute("offset"));le.inputs[st]={id:Ct,offset:Ht};break;case"vcount":le.vcount=o(Ee.textContent);break;case"v":le.v=o(Ee.textContent);break}}return le}function xe(he){var le={id:he.id},pe=Ye.geometries[le.id];return he.skin!==void 0&&(le.skin=fe(he.skin),pe.sources.skinIndices=le.skin.indices,pe.sources.skinWeights=le.skin.weights),le}function fe(he){var le=4,pe={joints:[],indices:{array:[],stride:le},weights:{array:[],stride:le}},be=he.sources,Ee=he.vertexWeights,st=Ee.vcount,Ct=Ee.v,Ht=Ee.inputs.JOINT.offset,ii=Ee.inputs.WEIGHT.offset,Ai=he.sources[he.joints.inputs.JOINT],Wt=he.sources[he.joints.inputs.INV_BIND_MATRIX],Ni=be[Ee.inputs.WEIGHT.id].array,xr=0,pr,fr,Wi;for(pr=0,Wi=st.length;pr<Wi;pr++){var Cr=st[pr],Mr=[];for(fr=0;fr<Cr;fr++){var zr=Ct[xr+Ht],Hr=Ct[xr+ii],_n=Ni[Hr];Mr.push({index:zr,weight:_n}),xr+=2}for(Mr.sort(_l),fr=0;fr<le;fr++){var Gr=Mr[fr];Gr!==void 0?(pe.indices.array.push(Gr.index),pe.weights.array.push(Gr.weight)):(pe.indices.array.push(0),pe.weights.array.push(0))}}for(he.bindShapeMatrix?pe.bindMatrix=new THREE.Matrix4().fromArray(he.bindShapeMatrix).transpose():pe.bindMatrix=new THREE.Matrix4().identity(),pr=0,Wi=Ai.array.length;pr<Wi;pr++){var ps=Ai.array[pr],Or=new THREE.Matrix4().fromArray(Wt.array,pr*Wt.stride).transpose();pe.joints.push({name:ps,boneInverse:Or})}return pe;function _l($o,Rc){return Rc.weight-$o.weight}}function de(he){return y(Ye.controllers[he],xe)}function Ie(he){var le={init_from:i(he,"init_from")[0].textContent};Ye.images[he.getAttribute("id")]=le}function Ge(he){return he.build!==void 0?he.build:he.init_from}function Xe(he){var le=Ye.images[he];return le!==void 0?y(le,Ge):(console.warn("THREE.ColladaLoader: Couldn't find image with ID:",he),null)}function $e(he){for(var le={},pe=0,be=he.childNodes.length;pe<be;pe++){var Ee=he.childNodes[pe];if(Ee.nodeType===1)switch(Ee.nodeName){case"profile_COMMON":le.profile=lt(Ee);break}}Ye.effects[he.getAttribute("id")]=le}function lt(he){for(var le={surfaces:{},samplers:{}},pe=0,be=he.childNodes.length;pe<be;pe++){var Ee=he.childNodes[pe];if(Ee.nodeType===1)switch(Ee.nodeName){case"newparam":At(Ee,le);break;case"technique":le.technique=xi(Ee);break;case"extra":le.extra=ir(Ee);break}}return le}function At(he,le){for(var pe=he.getAttribute("sid"),be=0,Ee=he.childNodes.length;be<Ee;be++){var st=he.childNodes[be];if(st.nodeType===1)switch(st.nodeName){case"surface":le.surfaces[pe]=Gt(st);break;case"sampler2D":le.samplers[pe]=gt(st);break}}}function Gt(he){for(var le={},pe=0,be=he.childNodes.length;pe<be;pe++){var Ee=he.childNodes[pe];if(Ee.nodeType===1)switch(Ee.nodeName){case"init_from":le.init_from=Ee.textContent;break}}return le}function gt(he){for(var le={},pe=0,be=he.childNodes.length;pe<be;pe++){var Ee=he.childNodes[pe];if(Ee.nodeType===1)switch(Ee.nodeName){case"source":le.source=Ee.textContent;break}}return le}function xi(he){for(var le={},pe=0,be=he.childNodes.length;pe<be;pe++){var Ee=he.childNodes[pe];if(Ee.nodeType===1)switch(Ee.nodeName){case"constant":case"lambert":case"blinn":case"phong":le.type=Ee.nodeName,le.parameters=Ze(Ee);break}}return le}function Ze(he){for(var le={},pe=0,be=he.childNodes.length;pe<be;pe++){var Ee=he.childNodes[pe];if(Ee.nodeType===1)switch(Ee.nodeName){case"emission":case"diffuse":case"specular":case"bump":case"ambient":case"shininess":case"transparency":le[Ee.nodeName]=Ui(Ee);break;case"transparent":le[Ee.nodeName]={opaque:Ee.getAttribute("opaque"),data:Ui(Ee)};break}}return le}function Ui(he){for(var le={},pe=0,be=he.childNodes.length;pe<be;pe++){var Ee=he.childNodes[pe];if(Ee.nodeType===1)switch(Ee.nodeName){case"color":le[Ee.nodeName]=s(Ee.textContent);break;case"float":le[Ee.nodeName]=parseFloat(Ee.textContent);break;case"texture":le[Ee.nodeName]={id:Ee.getAttribute("texture"),extra:di(Ee)};break}}return le}function di(he){for(var le={technique:{}},pe=0,be=he.childNodes.length;pe<be;pe++){var Ee=he.childNodes[pe];if(Ee.nodeType===1)switch(Ee.nodeName){case"extra":Ii(Ee,le);break}}return le}function Ii(he,le){for(var pe=0,be=he.childNodes.length;pe<be;pe++){var Ee=he.childNodes[pe];if(Ee.nodeType===1)switch(Ee.nodeName){case"technique":Ti(Ee,le);break}}}function Ti(he,le){for(var pe=0,be=he.childNodes.length;pe<be;pe++){var Ee=he.childNodes[pe];if(Ee.nodeType===1)switch(Ee.nodeName){case"repeatU":case"repeatV":case"offsetU":case"offsetV":le.technique[Ee.nodeName]=parseFloat(Ee.textContent);break;case"wrapU":case"wrapV":Ee.textContent.toUpperCase()==="TRUE"?le.technique[Ee.nodeName]=1:Ee.textContent.toUpperCase()==="FALSE"?le.technique[Ee.nodeName]=0:le.technique[Ee.nodeName]=parseInt(Ee.textContent);break}}}function ir(he){for(var le={},pe=0,be=he.childNodes.length;pe<be;pe++){var Ee=he.childNodes[pe];if(Ee.nodeType===1)switch(Ee.nodeName){case"technique":le.technique=Gi(Ee);break}}return le}function Gi(he){for(var le={},pe=0,be=he.childNodes.length;pe<be;pe++){var Ee=he.childNodes[pe];if(Ee.nodeType===1)switch(Ee.nodeName){case"double_sided":le[Ee.nodeName]=parseInt(Ee.textContent);break}}return le}function Qe(he){return he}function Ce(he){return y(Ye.effects[he],Qe)}function yt(he){for(var le={name:he.getAttribute("name")},pe=0,be=he.childNodes.length;pe<be;pe++){var Ee=he.childNodes[pe];if(Ee.nodeType===1)switch(Ee.nodeName){case"instance_effect":le.url=l(Ee.getAttribute("url"));break}}Ye.materials[he.getAttribute("id")]=le}function Ot(he){var le,pe=he.slice((he.lastIndexOf(".")-1>>>0)+2);switch(pe=pe.toLowerCase(),pe){case"tga":le=ue;break;default:le=W}return le}function Jt(he){var le=Ce(he.url),pe=le.profile.technique,be=le.profile.extra,Ee;switch(pe.type){case"phong":case"blinn":Ee=new THREE.MeshPhongMaterial;break;case"lambert":Ee=new THREE.MeshLambertMaterial;break;default:Ee=new THREE.MeshBasicMaterial;break}Ee.name=he.name;function st(xr){var pr=le.profile.samplers[xr.id],fr=null;if(pr!==void 0){var Wi=le.profile.surfaces[pr.source];fr=Xe(Wi.init_from)}else console.warn("THREE.ColladaLoader: Undefined sampler. Access image directly (see #12530)."),fr=Xe(xr.id);if(fr!==null){var Cr=Ot(fr);if(Cr!==void 0){var Mr=Cr.load(fr),zr=xr.extra;if(zr!==void 0&&zr.technique!==void 0&&c(zr.technique)===!1){var Hr=zr.technique;Mr.wrapS=Hr.wrapU?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,Mr.wrapT=Hr.wrapV?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,Mr.offset.set(Hr.offsetU||0,Hr.offsetV||0),Mr.repeat.set(Hr.repeatU||1,Hr.repeatV||1)}else Mr.wrapS=THREE.RepeatWrapping,Mr.wrapT=THREE.RepeatWrapping;return Mr}else return console.warn("THREE.ColladaLoader: Loader for texture %s not found.",fr),null}else return console.warn("THREE.ColladaLoader: Couldn't create texture with ID:",xr.id),null}var Ct=pe.parameters;for(var Ht in Ct){var ii=Ct[Ht];switch(Ht){case"diffuse":ii.color&&Ee.color.fromArray(ii.color),ii.texture&&(Ee.map=st(ii.texture));break;case"specular":ii.color&&Ee.specular&&Ee.specular.fromArray(ii.color),ii.texture&&(Ee.specularMap=st(ii.texture));break;case"bump":ii.texture&&(Ee.normalMap=st(ii.texture));break;case"ambient":ii.texture&&(Ee.lightMap=st(ii.texture));break;case"shininess":ii.float&&Ee.shininess&&(Ee.shininess=ii.float);break;case"emission":ii.color&&Ee.emissive&&Ee.emissive.fromArray(ii.color),ii.texture&&(Ee.emissiveMap=st(ii.texture));break}}var Ai=Ct.transparent,Wt=Ct.transparency;if(Wt===void 0&&Ai&&(Wt={float:1}),Ai===void 0&&Wt&&(Ai={opaque:"A_ONE",data:{color:[1,1,1,1]}}),Ai&&Wt)if(Ai.data.texture)Ee.transparent=!0;else{var Ni=Ai.data.color;switch(Ai.opaque){case"A_ONE":Ee.opacity=Ni[3]*Wt.float;break;case"RGB_ZERO":Ee.opacity=1-Ni[0]*Wt.float;break;case"A_ZERO":Ee.opacity=1-Ni[3]*Wt.float;break;case"RGB_ONE":Ee.opacity=Ni[0]*Wt.float;break;default:console.warn('THREE.ColladaLoader: Invalid opaque type "%s" of transparent tag.',Ai.opaque)}Ee.opacity<1&&(Ee.transparent=!0)}return be!==void 0&&be.technique!==void 0&&be.technique.double_sided===1&&(Ee.side=THREE.DoubleSide),Ee}function zt(he){return y(Ye.materials[he],Jt)}function _i(he){for(var le={name:he.getAttribute("name")},pe=0,be=he.childNodes.length;pe<be;pe++){var Ee=he.childNodes[pe];if(Ee.nodeType===1)switch(Ee.nodeName){case"optics":le.optics=vt(Ee);break}}Ye.cameras[he.getAttribute("id")]=le}function vt(he){for(var le=0;le<he.childNodes.length;le++){var pe=he.childNodes[le];switch(pe.nodeName){case"technique_common":return ye(pe)}}return{}}function ye(he){for(var le={},pe=0;pe<he.childNodes.length;pe++){var be=he.childNodes[pe];switch(be.nodeName){case"perspective":case"orthographic":le.technique=be.nodeName,le.parameters=ve(be);break}}return le}function ve(he){for(var le={},pe=0;pe<he.childNodes.length;pe++){var be=he.childNodes[pe];switch(be.nodeName){case"xfov":case"yfov":case"xmag":case"ymag":case"znear":case"zfar":case"aspect_ratio":le[be.nodeName]=parseFloat(be.textContent);break}}return le}function Le(he){var le;switch(he.optics.technique){case"perspective":le=new THREE.PerspectiveCamera(he.optics.parameters.yfov,he.optics.parameters.aspect_ratio,he.optics.parameters.znear,he.optics.parameters.zfar);break;case"orthographic":var pe=he.optics.parameters.ymag,be=he.optics.parameters.xmag,Ee=he.optics.parameters.aspect_ratio;be=be===void 0?pe*Ee:be,pe=pe===void 0?be/Ee:pe,be*=.5,pe*=.5,le=new THREE.OrthographicCamera(-be,be,pe,-pe,he.optics.parameters.znear,he.optics.parameters.zfar);break;default:le=new THREE.PerspectiveCamera;break}return le.name=he.name,le}function Te(he){var le=Ye.cameras[he];return le!==void 0?y(le,Le):(console.warn("THREE.ColladaLoader: Couldn't find camera with ID:",he),null)}function ke(he){for(var le={},pe=0,be=he.childNodes.length;pe<be;pe++){var Ee=he.childNodes[pe];if(Ee.nodeType===1)switch(Ee.nodeName){case"technique_common":le=Pe(Ee);break}}Ye.lights[he.getAttribute("id")]=le}function Pe(he){for(var le={},pe=0,be=he.childNodes.length;pe<be;pe++){var Ee=he.childNodes[pe];if(Ee.nodeType===1)switch(Ee.nodeName){case"directional":case"point":case"spot":case"ambient":le.technique=Ee.nodeName,le.parameters=F(Ee)}}return le}function F(he){for(var le={},pe=0,be=he.childNodes.length;pe<be;pe++){var Ee=he.childNodes[pe];if(Ee.nodeType===1)switch(Ee.nodeName){case"color":var st=s(Ee.textContent);le.color=new THREE.Color().fromArray(st);break;case"falloff_angle":le.falloffAngle=parseFloat(Ee.textContent);break;case"quadratic_attenuation":var Ct=parseFloat(Ee.textContent);le.distance=Ct?Math.sqrt(1/Ct):0;break}}return le}function J(he){var le;switch(he.technique){case"directional":le=new THREE.DirectionalLight;break;case"point":le=new THREE.PointLight;break;case"spot":le=new THREE.SpotLight;break;case"ambient":le=new THREE.AmbientLight;break}return he.parameters.color&&le.color.copy(he.parameters.color),he.parameters.distance&&(le.distance=he.parameters.distance),le}function ie(he){var le=Ye.lights[he];return le!==void 0?y(le,J):(console.warn("THREE.ColladaLoader: Couldn't find light with ID:",he),null)}function Re(he){var le={name:he.getAttribute("name"),sources:{},vertices:{},primitives:[]},pe=i(he,"mesh")[0];if(pe!==void 0){for(var be=0;be<pe.childNodes.length;be++){var Ee=pe.childNodes[be];if(Ee.nodeType===1){var st=Ee.getAttribute("id");switch(Ee.nodeName){case"source":le.sources[st]=ce(Ee);break;case"vertices":le.vertices=Ue(Ee);break;case"polygons":console.warn("THREE.ColladaLoader: Unsupported primitive type: ",Ee.nodeName);break;case"lines":case"linestrips":case"polylist":case"triangles":le.primitives.push(je(Ee));break;default:console.log(Ee)}}}Ye.geometries[he.getAttribute("id")]=le}}function ce(he){for(var le={array:[],stride:3},pe=0;pe<he.childNodes.length;pe++){var be=he.childNodes[pe];if(be.nodeType===1)switch(be.nodeName){case"float_array":le.array=s(be.textContent);break;case"Name_array":le.array=n(be.textContent);break;case"technique_common":var Ee=i(be,"accessor")[0];Ee!==void 0&&(le.stride=parseInt(Ee.getAttribute("stride")));break}}return le}function Ue(he){for(var le={},pe=0;pe<he.childNodes.length;pe++){var be=he.childNodes[pe];be.nodeType===1&&(le[be.getAttribute("semantic")]=l(be.getAttribute("source")))}return le}function je(he){for(var le={type:he.nodeName,material:he.getAttribute("material"),count:parseInt(he.getAttribute("count")),inputs:{},stride:0,hasUV:!1},pe=0,be=he.childNodes.length;pe<be;pe++){var Ee=he.childNodes[pe];if(Ee.nodeType===1)switch(Ee.nodeName){case"input":var st=l(Ee.getAttribute("source")),Ct=Ee.getAttribute("semantic"),Ht=parseInt(Ee.getAttribute("offset")),ii=parseInt(Ee.getAttribute("set")),Ai=ii>0?Ct+ii:Ct;le.inputs[Ai]={id:st,offset:Ht},le.stride=Math.max(le.stride,Ht+1),Ct==="TEXCOORD"&&(le.hasUV=!0);break;case"vcount":le.vcount=o(Ee.textContent);break;case"p":le.p=o(Ee.textContent);break}}return le}function dt(he){for(var le={},pe=0;pe<he.length;pe++){var be=he[pe];le[be.type]===void 0&&(le[be.type]=[]),le[be.type].push(be)}return le}function It(he){for(var le=0,pe=0,be=he.length;pe<be;pe++){var Ee=he[pe];Ee.hasUV===!0&&le++}le>0&&le<he.length&&(he.uvsNeedsFix=!0)}function bt(he){var le={},pe=he.sources,be=he.vertices,Ee=he.primitives;if(Ee.length===0)return{};var st=dt(Ee);for(var Ct in st){var Ht=st[Ct];It(Ht),le[Ct]=Ut(Ht,pe,be)}return le}function Ut(he,le,pe){for(var be={},Ee={array:[],stride:0},st={array:[],stride:0},Ct={array:[],stride:0},Ht={array:[],stride:0},ii={array:[],stride:0},Ai={array:[],stride:4},Wt={array:[],stride:4},Ni=new THREE.BufferGeometry,xr=[],pr=0,fr=0;fr<he.length;fr++){var Wi=he[fr],Cr=Wi.inputs,Mr=0;switch(Wi.type){case"lines":case"linestrips":Mr=Wi.count*2;break;case"triangles":Mr=Wi.count*3;break;case"polylist":for(var zr=0;zr<Wi.count;zr++){var Hr=Wi.vcount[zr];switch(Hr){case 3:Mr+=3;break;case 4:Mr+=6;break;default:Mr+=(Hr-2)*3;break}}break;default:console.warn("THREE.ColladaLoader: Unknow primitive type:",Wi.type)}Ni.addGroup(pr,Mr,fr),pr+=Mr,Wi.material&&xr.push(Wi.material);for(var _n in Cr){var Gr=Cr[_n];switch(_n){case"VERTEX":for(var ps in pe){var Or=pe[ps];switch(ps){case"POSITION":var _l=Ee.array.length;if(pi(Wi,le[Or],Gr.offset,Ee.array),Ee.stride=le[Or].stride,le.skinWeights&&le.skinIndices&&(pi(Wi,le.skinIndices,Gr.offset,Ai.array),pi(Wi,le.skinWeights,Gr.offset,Wt.array)),Wi.hasUV===!1&&he.uvsNeedsFix===!0)for(var Mr=(Ee.array.length-_l)/Ee.stride,$o=0;$o<Mr;$o++)Ct.array.push(0,0);break;case"NORMAL":pi(Wi,le[Or],Gr.offset,st.array),st.stride=le[Or].stride;break;case"COLOR":pi(Wi,le[Or],Gr.offset,ii.array),ii.stride=le[Or].stride;break;case"TEXCOORD":pi(Wi,le[Or],Gr.offset,Ct.array),Ct.stride=le[Or].stride;break;case"TEXCOORD1":pi(Wi,le[Or],Gr.offset,Ht.array),Ct.stride=le[Or].stride;break;default:console.warn('THREE.ColladaLoader: Semantic "%s" not handled in geometry build process.',ps)}}break;case"NORMAL":pi(Wi,le[Gr.id],Gr.offset,st.array),st.stride=le[Gr.id].stride;break;case"COLOR":pi(Wi,le[Gr.id],Gr.offset,ii.array),ii.stride=le[Gr.id].stride;break;case"TEXCOORD":pi(Wi,le[Gr.id],Gr.offset,Ct.array),Ct.stride=le[Gr.id].stride;break;case"TEXCOORD1":pi(Wi,le[Gr.id],Gr.offset,Ht.array),Ht.stride=le[Gr.id].stride;break}}}return Ee.array.length>0&&Ni.addAttribute("position",new THREE.Float32BufferAttribute(Ee.array,Ee.stride)),st.array.length>0&&Ni.addAttribute("normal",new THREE.Float32BufferAttribute(st.array,st.stride)),ii.array.length>0&&Ni.addAttribute("color",new THREE.Float32BufferAttribute(ii.array,ii.stride)),Ct.array.length>0&&Ni.addAttribute("uv",new THREE.Float32BufferAttribute(Ct.array,Ct.stride)),Ht.array.length>0&&Ni.addAttribute("uv2",new THREE.Float32BufferAttribute(Ht.array,Ht.stride)),Ai.array.length>0&&Ni.addAttribute("skinIndex",new THREE.Float32BufferAttribute(Ai.array,Ai.stride)),Wt.array.length>0&&Ni.addAttribute("skinWeight",new THREE.Float32BufferAttribute(Wt.array,Wt.stride)),be.data=Ni,be.type=he[0].type,be.materialKeys=xr,be}function pi(he,le,pe,be){var Ee=he.p,st=he.stride,Ct=he.vcount;function Ht(_n){for(var Gr=Ee[_n+pe]*Ai,ps=Gr+Ai;Gr<ps;Gr++)be.push(ii[Gr])}var ii=le.array,Ai=le.stride;if(he.vcount!==void 0)for(var Wt=0,Ni=0,xr=Ct.length;Ni<xr;Ni++){var pr=Ct[Ni];if(pr===4){var fr=Wt+st*0,Wi=Wt+st*1,Cr=Wt+st*2,Mr=Wt+st*3;Ht(fr),Ht(Wi),Ht(Mr),Ht(Wi),Ht(Cr),Ht(Mr)}else if(pr===3){var fr=Wt+st*0,Wi=Wt+st*1,Cr=Wt+st*2;Ht(fr),Ht(Wi),Ht(Cr)}else if(pr>4)for(var zr=1,Hr=pr-2;zr<=Hr;zr++){var fr=Wt+st*0,Wi=Wt+st*zr,Cr=Wt+st*(zr+1);Ht(fr),Ht(Wi),Ht(Cr)}Wt+=st*pr}else for(var Ni=0,xr=Ee.length;Ni<xr;Ni+=st)Ht(Ni)}function Er(he){return y(Ye.geometries[he],bt)}function ki(he){for(var le={name:he.getAttribute("name")||"",joints:{},links:[]},pe=0;pe<he.childNodes.length;pe++){var be=he.childNodes[pe];if(be.nodeType===1)switch(be.nodeName){case"technique_common":sn(be,le);break}}Ye.kinematicsModels[he.getAttribute("id")]=le}function An(he){return he.build!==void 0?he.build:he}function Ur(he){return y(Ye.kinematicsModels[he],An)}function sn(he,le){for(var pe=0;pe<he.childNodes.length;pe++){var be=he.childNodes[pe];if(be.nodeType===1)switch(be.nodeName){case"joint":le.joints[be.getAttribute("sid")]=xs(be);break;case"link":le.links.push(Ls(be));break}}}function xs(he){for(var le,pe=0;pe<he.childNodes.length;pe++){var be=he.childNodes[pe];if(be.nodeType===1)switch(be.nodeName){case"prismatic":case"revolute":le=yn(be);break}}return le}function yn(he,le){for(var le={sid:he.getAttribute("sid"),name:he.getAttribute("name")||"",axis:new THREE.Vector3,limits:{min:0,max:0},type:he.nodeName,static:!1,zeroPosition:0,middlePosition:0},pe=0;pe<he.childNodes.length;pe++){var be=he.childNodes[pe];if(be.nodeType===1)switch(be.nodeName){case"axis":var Ee=s(be.textContent);le.axis.fromArray(Ee);break;case"limits":var st=be.getElementsByTagName("max")[0],Ct=be.getElementsByTagName("min")[0];le.limits.max=parseFloat(st.textContent),le.limits.min=parseFloat(Ct.textContent);break}}return le.limits.min>=le.limits.max&&(le.static=!0),le.middlePosition=(le.limits.min+le.limits.max)/2,le}function Ls(he){for(var le={sid:he.getAttribute("sid"),name:he.getAttribute("name")||"",attachments:[],transforms:[]},pe=0;pe<he.childNodes.length;pe++){var be=he.childNodes[pe];if(be.nodeType===1)switch(be.nodeName){case"attachment_full":le.attachments.push(rs(be));break;case"matrix":case"translate":case"rotate":le.transforms.push(bs(be));break}}return le}function rs(he){for(var le={joint:he.getAttribute("joint").split("/").pop(),transforms:[],links:[]},pe=0;pe<he.childNodes.length;pe++){var be=he.childNodes[pe];if(be.nodeType===1)switch(be.nodeName){case"link":le.links.push(Ls(be));break;case"matrix":case"translate":case"rotate":le.transforms.push(bs(be));break}}return le}function bs(he){var le={type:he.nodeName},pe=s(he.textContent);switch(le.type){case"matrix":le.obj=new THREE.Matrix4,le.obj.fromArray(pe).transpose();break;case"translate":le.obj=new THREE.Vector3,le.obj.fromArray(pe);break;case"rotate":le.obj=new THREE.Vector3,le.obj.fromArray(pe),le.angle=THREE.MathUtils.degToRad(pe[3]);break}return le}function me(he){for(var le={name:he.getAttribute("name")||"",rigidBodies:{}},pe=0;pe<he.childNodes.length;pe++){var be=he.childNodes[pe];if(be.nodeType===1)switch(be.nodeName){case"rigid_body":le.rigidBodies[be.getAttribute("name")]={},ct(be,le.rigidBodies[be.getAttribute("name")]);break}}Ye.physicsModels[he.getAttribute("id")]=le}function ct(he,le){for(var pe=0;pe<he.childNodes.length;pe++){var be=he.childNodes[pe];if(be.nodeType===1)switch(be.nodeName){case"technique_common":St(be,le);break}}}function St(he,le){for(var pe=0;pe<he.childNodes.length;pe++){var be=he.childNodes[pe];if(be.nodeType===1)switch(be.nodeName){case"inertia":le.inertia=s(be.textContent);break;case"mass":le.mass=s(be.textContent)[0];break}}}function Xt(he){for(var le={bindJointAxis:[]},pe=0;pe<he.childNodes.length;pe++){var be=he.childNodes[pe];if(be.nodeType===1)switch(be.nodeName){case"bind_joint_axis":le.bindJointAxis.push(Bi(be));break}}Ye.kinematicsScenes[l(he.getAttribute("url"))]=le}function Bi(he){for(var le={target:he.getAttribute("target").split("/").pop()},pe=0;pe<he.childNodes.length;pe++){var be=he.childNodes[pe];if(be.nodeType===1)switch(be.nodeName){case"axis":var Ee=be.getElementsByTagName("param")[0];le.axis=Ee.textContent;var st=le.axis.split("inst_").pop().split("axis")[0];le.jointIndex=st.substr(0,st.length-1);break}}return le}function ar(he){return he.build!==void 0?he.build:he}function Li(he){return y(Ye.kinematicsScenes[he],ar)}function Pi(){var he=Object.keys(Ye.kinematicsModels)[0],le=Object.keys(Ye.kinematicsScenes)[0],pe=Object.keys(Ye.visualScenes)[0];if(he===void 0||le===void 0)return;for(var be=Ur(he),Ee=Li(le),st=bi(pe),Ct=Ee.bindJointAxis,Ht={},ii=0,Ai=Ct.length;ii<Ai;ii++){var Wt=Ct[ii],Ni=or.querySelector('[sid="'+Wt.target+'"]');if(Ni){var xr=Ni.parentElement;pr(Wt.jointIndex,xr)}}function pr(Wi,Cr){var Mr=Cr.getAttribute("name"),zr=be.joints[Wi];st.traverse(function(Hr){Hr.name===Mr&&(Ht[Wi]={object:Hr,transforms:Be(Cr),joint:zr,position:zr.zeroPosition})})}var fr=new THREE.Matrix4;Se={joints:be&&be.joints,getJointValue:function(Wi){var Cr=Ht[Wi];if(Cr)return Cr.position;console.warn("THREE.ColladaLoader: Joint "+Wi+" doesn't exist.")},setJointValue:function(Wi,Cr){var Mr=Ht[Wi];if(Mr){var zr=Mr.joint;if(Cr>zr.limits.max||Cr<zr.limits.min)console.warn("THREE.ColladaLoader: Joint "+Wi+" value "+Cr+" outside of limits (min: "+zr.limits.min+", max: "+zr.limits.max+").");else if(zr.static)console.warn("THREE.ColladaLoader: Joint "+Wi+" is static.");else{var Hr=Mr.object,_n=zr.axis,Gr=Mr.transforms;ge.identity();for(var ps=0;ps<Gr.length;ps++){var Or=Gr[ps];if(Or.sid&&Or.sid.indexOf(Wi)!==-1)switch(zr.type){case"revolute":ge.multiply(fr.makeRotationAxis(_n,THREE.MathUtils.degToRad(Cr)));break;case"prismatic":ge.multiply(fr.makeTranslation(_n.x*Cr,_n.y*Cr,_n.z*Cr));break;default:console.warn("THREE.ColladaLoader: Unknown joint type: "+zr.type);break}else switch(Or.type){case"matrix":ge.multiply(Or.obj);break;case"translate":ge.multiply(fr.makeTranslation(Or.obj.x,Or.obj.y,Or.obj.z));break;case"scale":ge.scale(Or.obj);break;case"rotate":ge.multiply(fr.makeRotationAxis(Or.obj,Or.angle));break}}Hr.matrix.copy(ge),Hr.matrix.decompose(Hr.position,Hr.quaternion,Hr.scale),Ht[Wi].position=Cr}}else console.log("THREE.ColladaLoader: "+Wi+" does not exist.")}}}function Be(he){for(var le=[],pe=or.querySelector('[id="'+he.id+'"]'),be=0;be<pe.childNodes.length;be++){var Ee=pe.childNodes[be];if(Ee.nodeType===1)switch(Ee.nodeName){case"matrix":var Ct=s(Ee.textContent),st=new THREE.Matrix4().fromArray(Ct).transpose();le.push({sid:Ee.getAttribute("sid"),type:Ee.nodeName,obj:st});break;case"translate":case"scale":var Ct=s(Ee.textContent),Ht=new THREE.Vector3().fromArray(Ct);le.push({sid:Ee.getAttribute("sid"),type:Ee.nodeName,obj:Ht});break;case"rotate":var Ct=s(Ee.textContent),Ht=new THREE.Vector3().fromArray(Ct),ii=THREE.MathUtils.degToRad(Ct[3]);le.push({sid:Ee.getAttribute("sid"),type:Ee.nodeName,obj:Ht,angle:ii});break}}return le}function se(he){for(var le=he.getElementsByTagName("node"),pe=0;pe<le.length;pe++){var be=le[pe];be.hasAttribute("id")===!1&&be.setAttribute("id",u())}}var ge=new THREE.Matrix4,Ne=new THREE.Vector3;function Fe(he){for(var le={name:he.getAttribute("name")||"",type:he.getAttribute("type"),id:he.getAttribute("id"),sid:he.getAttribute("sid"),matrix:new THREE.Matrix4,nodes:[],instanceCameras:[],instanceControllers:[],instanceLights:[],instanceGeometries:[],instanceNodes:[],transforms:{}},pe=0;pe<he.childNodes.length;pe++){var be=he.childNodes[pe];if(be.nodeType===1)switch(be.nodeName){case"node":le.nodes.push(be.getAttribute("id")),Fe(be);break;case"instance_camera":le.instanceCameras.push(l(be.getAttribute("url")));break;case"instance_controller":le.instanceControllers.push(Ke(be));break;case"instance_light":le.instanceLights.push(l(be.getAttribute("url")));break;case"instance_geometry":le.instanceGeometries.push(Ke(be));break;case"instance_node":le.instanceNodes.push(l(be.getAttribute("url")));break;case"matrix":var st=s(be.textContent);le.matrix.multiply(ge.fromArray(st).transpose()),le.transforms[be.getAttribute("sid")]=be.nodeName;break;case"translate":var st=s(be.textContent);Ne.fromArray(st),le.matrix.multiply(ge.makeTranslation(Ne.x,Ne.y,Ne.z)),le.transforms[be.getAttribute("sid")]=be.nodeName;break;case"rotate":var st=s(be.textContent),Ee=THREE.MathUtils.degToRad(st[3]);le.matrix.multiply(ge.makeRotationAxis(Ne.fromArray(st),Ee)),le.transforms[be.getAttribute("sid")]=be.nodeName;break;case"scale":var st=s(be.textContent);le.matrix.scale(Ne.fromArray(st)),le.transforms[be.getAttribute("sid")]=be.nodeName;break;case"extra":break;default:console.log(be)}}return Ei(le.id)?console.warn("THREE.ColladaLoader: There is already a node with ID %s. Exclude current node from further processing.",le.id):Ye.nodes[le.id]=le,le}function Ke(he){for(var le={id:l(he.getAttribute("url")),materials:{},skeletons:[]},pe=0;pe<he.childNodes.length;pe++){var be=he.childNodes[pe];switch(be.nodeName){case"bind_material":for(var Ee=be.getElementsByTagName("instance_material"),st=0;st<Ee.length;st++){var Ct=Ee[st],Ht=Ct.getAttribute("symbol"),ii=Ct.getAttribute("target");le.materials[Ht]=l(ii)}break;case"skeleton":le.skeletons.push(l(be.textContent));break}}return le}function ot(he,le){var pe=[],be=[],Ee,st,Ct;for(Ee=0;Ee<he.length;Ee++){var Ht=he[Ee],ii;if(Ei(Ht))ii=Fi(Ht),wt(ii,le,pe);else if(Zi(Ht))for(var Ai=Ye.visualScenes[Ht],Wt=Ai.children,st=0;st<Wt.length;st++){var Ni=Wt[st];if(Ni.type==="JOINT"){var ii=Fi(Ni.id);wt(ii,le,pe)}}else console.error("THREE.ColladaLoader: Unable to find root bone of skeleton with ID:",Ht)}for(Ee=0;Ee<le.length;Ee++)for(st=0;st<pe.length;st++)if(Ct=pe[st],Ct.bone.name===le[Ee].name){be[Ee]=Ct,Ct.processed=!0;break}for(Ee=0;Ee<pe.length;Ee++)Ct=pe[Ee],Ct.processed===!1&&(be.push(Ct),Ct.processed=!0);var xr=[],pr=[];for(Ee=0;Ee<be.length;Ee++)Ct=be[Ee],xr.push(Ct.bone),pr.push(Ct.boneInverse);return new THREE.Skeleton(xr,pr)}function wt(he,le,pe){he.traverse(function(be){if(be.isBone===!0){for(var Ee,st=0;st<le.length;st++){var Ct=le[st];if(Ct.name===be.name){Ee=Ct.boneInverse;break}}Ee===void 0&&(Ee=new THREE.Matrix4),pe.push({bone:be,boneInverse:Ee,processed:!1})}})}function qt(he){for(var le=[],pe=he.matrix,be=he.nodes,Ee=he.type,st=he.instanceCameras,Ct=he.instanceControllers,Ht=he.instanceLights,ii=he.instanceGeometries,Ai=he.instanceNodes,Wt=0,Ni=be.length;Wt<Ni;Wt++)le.push(Fi(be[Wt]));for(var Wt=0,Ni=st.length;Wt<Ni;Wt++){var xr=Te(st[Wt]);xr!==null&&le.push(xr.clone())}for(var Wt=0,Ni=Ct.length;Wt<Ni;Wt++)for(var pr=Ct[Wt],fr=de(pr.id),Wi=Er(fr.id),Cr=ti(Wi,pr.materials),Mr=pr.skeletons,zr=fr.skin.joints,Hr=ot(Mr,zr),_n=0,Gr=Cr.length;_n<Gr;_n++){var Or=Cr[_n];Or.isSkinnedMesh&&(Or.bind(Hr,fr.skin.bindMatrix),Or.normalizeSkinWeights()),le.push(Or)}for(var Wt=0,Ni=Ht.length;Wt<Ni;Wt++){var ps=ie(Ht[Wt]);ps!==null&&le.push(ps.clone())}for(var Wt=0,Ni=ii.length;Wt<Ni;Wt++)for(var pr=ii[Wt],Wi=Er(pr.id),Cr=ti(Wi,pr.materials),_n=0,Gr=Cr.length;_n<Gr;_n++)le.push(Cr[_n]);for(var Wt=0,Ni=Ai.length;Wt<Ni;Wt++)le.push(Fi(Ai[Wt]).clone());var Or;if(be.length===0&&le.length===1)Or=le[0];else{Or=Ee==="JOINT"?new THREE.Bone:new THREE.Group;for(var Wt=0;Wt<le.length;Wt++)Or.add(le[Wt])}return Or.name===""&&(Or.name=Ee==="JOINT"?he.sid:he.name),Or.matrix.copy(pe),Or.matrix.decompose(Or.position,Or.quaternion,Or.scale),Or}var Kt=new THREE.MeshBasicMaterial({color:16711935});function Mt(he,le){for(var pe=[],be=0,Ee=he.length;be<Ee;be++){var st=le[he[be]];st===void 0?(console.warn("THREE.ColladaLoader: Material with key %s not found. Apply fallback material.",he[be]),pe.push(Kt)):pe.push(zt(st))}return pe}function ti(he,le){var pe=[];for(var be in he){var Ee=he[be],st=Mt(Ee.materialKeys,le);st.length===0&&(be==="lines"||be==="linestrips"?st.push(new THREE.LineBasicMaterial):st.push(new THREE.MeshPhongMaterial));var Ct=Ee.data.attributes.skinIndex!==void 0;if(Ct)for(var Ht=0,ii=st.length;Ht<ii;Ht++)st[Ht].skinning=!0;var Ai=st.length===1?st[0]:st,Wt;switch(be){case"lines":Wt=new THREE.LineSegments(Ee.data,Ai);break;case"linestrips":Wt=new THREE.Line(Ee.data,Ai);break;case"triangles":case"polylist":Ct?Wt=new THREE.SkinnedMesh(Ee.data,Ai):Wt=new THREE.Mesh(Ee.data,Ai);break}pe.push(Wt)}return pe}function Ei(he){return Ye.nodes[he]!==void 0}function Fi(he){return y(Ye.nodes[he],qt)}function Tr(he){var le={name:he.getAttribute("name"),children:[]};se(he);for(var pe=i(he,"node"),be=0;be<pe.length;be++)le.children.push(Fe(pe[be]));Ye.visualScenes[he.getAttribute("id")]=le}function hr(he){var le=new THREE.Group;le.name=he.name;for(var pe=he.children,be=0;be<pe.length;be++){var Ee=pe[be];le.add(Fi(Ee.id))}return le}function Zi(he){return Ye.visualScenes[he]!==void 0}function bi(he){return y(Ye.visualScenes[he],hr)}function Bn(he){var le=i(he,"instance_visual_scene")[0];return bi(l(le.getAttribute("url")))}function Jn(){var he=Ye.clips;if(c(he)===!0){if(c(Ye.animations)===!1){var le=[];for(var pe in Ye.animations)for(var be=w(pe),Ee=0,st=be.length;Ee<st;Ee++)le.push(be[Ee]);Ae.push(new THREE.AnimationClip("default",-1,le))}}else for(var pe in he)Ae.push(H(pe))}if(r.length===0)return{scene:new THREE.Scene};var Ri=new DOMParser().parseFromString(r,"application/xml"),or=i(Ri,"COLLADA")[0],pn=or.getAttribute("version");console.log("THREE.ColladaLoader: File version",pn);var Yr=h(i(or,"asset")[0]),W=new THREE.TextureLoader(this.manager);W.setPath(this.resourcePath||e).setCrossOrigin(this.crossOrigin);var ue;THREE.TGALoader&&(ue=new THREE.TGALoader(this.manager),ue.setPath(this.resourcePath||e));var Ae=[],Se={},We=0,Ye={animations:{},clips:{},controllers:{},images:{},effects:{},materials:{},cameras:{},lights:{},geometries:{},nodes:{},visualScenes:{},kinematicsModels:{},physicsModels:{},kinematicsScenes:{}};m(or,"library_animations","animation",x),m(or,"library_animation_clips","animation_clip",$),m(or,"library_controllers","controller",V),m(or,"library_images","image",Ie),m(or,"library_effects","effect",$e),m(or,"library_materials","material",yt),m(or,"library_cameras","camera",_i),m(or,"library_lights","light",ke),m(or,"library_geometries","geometry",Re),m(or,"library_nodes","node",Fe),m(or,"library_visual_scenes","visual_scene",Tr),m(or,"library_kinematics_models","kinematics_model",ki),m(or,"library_physics_models","physics_model",me),m(or,"scene","instance_kinematics_scene",Xt),g(Ye.animations,T),g(Ye.clips,Q),g(Ye.controllers,xe),g(Ye.images,Ge),g(Ye.effects,Qe),g(Ye.materials,Jt),g(Ye.cameras,Le),g(Ye.lights,J),g(Ye.geometries,bt),g(Ye.visualScenes,hr),Jn(),Pi();var ft=Bn(i(or,"scene")[0]);return Yr.upAxis==="Z_UP"&&ft.quaternion.setFromEuler(new THREE.Euler(-Math.PI/2,0,0)),ft.scale.multiplyScalar(Yr.unit),{animations:Ae,kinematics:Se,library:Ye,scene:ft}}},THREE.ColladaLoader=bq,AFRAME.registerComponent("collada-model-legacy",{schema:{type:"asset"},init:function(){this.model=null,this.loader=new THREE.ColladaLoader},update:function(){var r=this,e=this.el,i=this.data,n=this.el.sceneEl.systems.renderer;i&&(this.remove(),this.loader.load(i,function(s){r.model=s.scene,r.model.traverse(function(o){if(o.isMesh){var l=o.material;l.color&&n.applyColorCorrection(l.color),l.map&&n.applyColorCorrection(l.map),l.emissive&&n.applyColorCorrection(l.emissive),l.emissiveMap&&n.applyColorCorrection(l.emissiveMap)}}),e.setObject3D("mesh",r.model),e.emit("model-loaded",{format:"collada",model:r.model})}))},remove:function(){this.model&&this.el.removeObject3D("mesh")}});/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const kD="164",N2=0,_q=1,FD=1,UD=100,zD=204,jD=205,VD=3,L2=0,GD="attached",Eq="detached",HD=300,wq=303,px=1e3,zf=1001,WD=1002,fx=1003,Cq=1006,Sq=1008,Tq=1009,Mq=1014,QD=1015,Rq=1020,qD=1023,D2=1026,XD=1027,mx=2300,gx=2301,O2=2302,YD=2400,KD=2401,JD=2402,Iq=2500,ZD=0,$D="",Rl="srgb",P2="srgb-linear",Bq="display-p3",eO="display-p3-linear",k2="linear",tO="srgb",iO="rec709",rO="p3",jf=7680,nO=519,Nq=515,sO=35044,Zd=2e3,F2=2001;let Ax=class{addEventListener(r,e){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[r]===void 0&&(i[r]=[]),i[r].indexOf(e)===-1&&i[r].push(e)}hasEventListener(r,e){if(this._listeners===void 0)return!1;const i=this._listeners;return i[r]!==void 0&&i[r].indexOf(e)!==-1}removeEventListener(r,e){if(this._listeners===void 0)return;const i=this._listeners[r];if(i!==void 0){const n=i.indexOf(e);n!==-1&&i.splice(n,1)}}dispatchEvent(r){if(this._listeners===void 0)return;const e=this._listeners[r.type];if(e!==void 0){r.target=this;const i=e.slice(0);for(let n=0,s=i.length;n<s;n++)i[n].call(this,r);r.target=null}}};const Za=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let aO=1234567;const X0=Math.PI/180,Y0=180/Math.PI;function Bh(){const r=Math.random()*4294967295|0,e=Math.random()*4294967295|0,i=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(Za[r&255]+Za[r>>8&255]+Za[r>>16&255]+Za[r>>24&255]+"-"+Za[e&255]+Za[e>>8&255]+"-"+Za[e>>16&15|64]+Za[e>>24&255]+"-"+Za[i&63|128]+Za[i>>8&255]+"-"+Za[i>>16&255]+Za[i>>24&255]+Za[n&255]+Za[n>>8&255]+Za[n>>16&255]+Za[n>>24&255]).toLowerCase()}function ka(r,e,i){return Math.max(e,Math.min(i,r))}function U2(r,e){return(r%e+e)%e}function Lq(r,e,i,n,s){return n+(r-e)*(s-n)/(i-e)}function Dq(r,e,i){return r!==e?(i-r)/(e-r):0}function K0(r,e,i){return(1-i)*r+i*e}function Oq(r,e,i,n){return K0(r,e,1-Math.exp(-i*n))}function Pq(r,e=1){return e-Math.abs(U2(r,e*2)-e)}function kq(r,e,i){return r<=e?0:r>=i?1:(r=(r-e)/(i-e),r*r*(3-2*r))}function Fq(r,e,i){return r<=e?0:r>=i?1:(r=(r-e)/(i-e),r*r*r*(r*(r*6-15)+10))}function Uq(r,e){return r+Math.floor(Math.random()*(e-r+1))}function zq(r,e){return r+Math.random()*(e-r)}function jq(r){return r*(.5-Math.random())}function Vq(r){r!==void 0&&(aO=r);let e=aO+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function Gq(r){return r*X0}function Hq(r){return r*Y0}function Wq(r){return(r&r-1)===0&&r!==0}function Qq(r){return Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))}function qq(r){return Math.pow(2,Math.floor(Math.log(r)/Math.LN2))}function Xq(r,e,i,n,s){const o=Math.cos,l=Math.sin,u=o(i/2),c=l(i/2),h=o((e+n)/2),p=l((e+n)/2),f=o((e-n)/2),m=l((e-n)/2),g=o((n-e)/2),y=l((n-e)/2);switch(s){case"XYX":r.set(u*p,c*f,c*m,u*h);break;case"YZY":r.set(c*m,u*p,c*f,u*h);break;case"ZXZ":r.set(c*f,c*m,u*p,u*h);break;case"XZX":r.set(u*p,c*y,c*g,u*h);break;case"YXY":r.set(c*g,u*p,c*y,u*h);break;case"ZYZ":r.set(c*y,c*g,u*p,u*h);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+s)}}function Vf(r,e){switch(e.constructor){case Float32Array:return r;case Uint32Array:return r/4294967295;case Uint16Array:return r/65535;case Uint8Array:return r/255;case Int32Array:return Math.max(r/2147483647,-1);case Int16Array:return Math.max(r/32767,-1);case Int8Array:return Math.max(r/127,-1);default:throw new Error("Invalid component type.")}}function mo(r,e){switch(e.constructor){case Float32Array:return r;case Uint32Array:return Math.round(r*4294967295);case Uint16Array:return Math.round(r*65535);case Uint8Array:return Math.round(r*255);case Int32Array:return Math.round(r*2147483647);case Int16Array:return Math.round(r*32767);case Int8Array:return Math.round(r*127);default:throw new Error("Invalid component type.")}}const go={DEG2RAD:X0,RAD2DEG:Y0,generateUUID:Bh,clamp:ka,euclideanModulo:U2,mapLinear:Lq,inverseLerp:Dq,lerp:K0,damp:Oq,pingpong:Pq,smoothstep:kq,smootherstep:Fq,randInt:Uq,randFloat:zq,randFloatSpread:jq,seededRandom:Vq,degToRad:Gq,radToDeg:Hq,isPowerOfTwo:Wq,ceilPowerOfTwo:Qq,floorPowerOfTwo:qq,setQuaternionFromProperEuler:Xq,normalize:mo,denormalize:Vf};let Hs=class iH{constructor(e=0,i=0){iH.prototype.isVector2=!0,this.x=e,this.y=i}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,i){return this.x=e,this.y=i,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const i=this.x,n=this.y,s=e.elements;return this.x=s[0]*i+s[3]*n+s[6],this.y=s[1]*i+s[4]*n+s[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,i){return this.x=Math.max(e.x,Math.min(i.x,this.x)),this.y=Math.max(e.y,Math.min(i.y,this.y)),this}clampScalar(e,i){return this.x=Math.max(e,Math.min(i,this.x)),this.y=Math.max(e,Math.min(i,this.y)),this}clampLength(e,i){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(i,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const i=Math.sqrt(this.lengthSq()*e.lengthSq());if(i===0)return Math.PI/2;const n=this.dot(e)/i;return Math.acos(ka(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const i=this.x-e.x,n=this.y-e.y;return i*i+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this}lerpVectors(e,i,n){return this.x=e.x+(i.x-e.x)*n,this.y=e.y+(i.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e}fromBufferAttribute(e,i){return this.x=e.getX(i),this.y=e.getY(i),this}rotateAround(e,i){const n=Math.cos(i),s=Math.sin(i),o=this.x-e.x,l=this.y-e.y;return this.x=o*n-l*s+e.x,this.y=o*s+l*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},Nh=class rH{constructor(e,i,n,s,o,l,u,c,h){rH.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,i,n,s,o,l,u,c,h)}set(e,i,n,s,o,l,u,c,h){const p=this.elements;return p[0]=e,p[1]=s,p[2]=u,p[3]=i,p[4]=o,p[5]=c,p[6]=n,p[7]=l,p[8]=h,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const i=this.elements,n=e.elements;return i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],this}extractBasis(e,i,n){return e.setFromMatrix3Column(this,0),i.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const i=e.elements;return this.set(i[0],i[4],i[8],i[1],i[5],i[9],i[2],i[6],i[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,i){const n=e.elements,s=i.elements,o=this.elements,l=n[0],u=n[3],c=n[6],h=n[1],p=n[4],f=n[7],m=n[2],g=n[5],y=n[8],x=s[0],v=s[3],_=s[6],T=s[1],w=s[4],S=s[7],R=s[2],B=s[5],I=s[8];return o[0]=l*x+u*T+c*R,o[3]=l*v+u*w+c*B,o[6]=l*_+u*S+c*I,o[1]=h*x+p*T+f*R,o[4]=h*v+p*w+f*B,o[7]=h*_+p*S+f*I,o[2]=m*x+g*T+y*R,o[5]=m*v+g*w+y*B,o[8]=m*_+g*S+y*I,this}multiplyScalar(e){const i=this.elements;return i[0]*=e,i[3]*=e,i[6]*=e,i[1]*=e,i[4]*=e,i[7]*=e,i[2]*=e,i[5]*=e,i[8]*=e,this}determinant(){const e=this.elements,i=e[0],n=e[1],s=e[2],o=e[3],l=e[4],u=e[5],c=e[6],h=e[7],p=e[8];return i*l*p-i*u*h-n*o*p+n*u*c+s*o*h-s*l*c}invert(){const e=this.elements,i=e[0],n=e[1],s=e[2],o=e[3],l=e[4],u=e[5],c=e[6],h=e[7],p=e[8],f=p*l-u*h,m=u*c-p*o,g=h*o-l*c,y=i*f+n*m+s*g;if(y===0)return this.set(0,0,0,0,0,0,0,0,0);const x=1/y;return e[0]=f*x,e[1]=(s*h-p*n)*x,e[2]=(u*n-s*l)*x,e[3]=m*x,e[4]=(p*i-s*c)*x,e[5]=(s*o-u*i)*x,e[6]=g*x,e[7]=(n*c-h*i)*x,e[8]=(l*i-n*o)*x,this}transpose(){let e;const i=this.elements;return e=i[1],i[1]=i[3],i[3]=e,e=i[2],i[2]=i[6],i[6]=e,e=i[5],i[5]=i[7],i[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const i=this.elements;return e[0]=i[0],e[1]=i[3],e[2]=i[6],e[3]=i[1],e[4]=i[4],e[5]=i[7],e[6]=i[2],e[7]=i[5],e[8]=i[8],this}setUvTransform(e,i,n,s,o,l,u){const c=Math.cos(o),h=Math.sin(o);return this.set(n*c,n*h,-n*(c*l+h*u)+l+e,-s*h,s*c,-s*(-h*l+c*u)+u+i,0,0,1),this}scale(e,i){return this.premultiply(z2.makeScale(e,i)),this}rotate(e){return this.premultiply(z2.makeRotation(-e)),this}translate(e,i){return this.premultiply(z2.makeTranslation(e,i)),this}makeTranslation(e,i){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,i,0,0,1),this}makeRotation(e){const i=Math.cos(e),n=Math.sin(e);return this.set(i,-n,0,n,i,0,0,0,1),this}makeScale(e,i){return this.set(e,0,0,0,i,0,0,0,1),this}equals(e){const i=this.elements,n=e.elements;for(let s=0;s<9;s++)if(i[s]!==n[s])return!1;return!0}fromArray(e,i=0){for(let n=0;n<9;n++)this.elements[n]=e[n+i];return this}toArray(e=[],i=0){const n=this.elements;return e[i]=n[0],e[i+1]=n[1],e[i+2]=n[2],e[i+3]=n[3],e[i+4]=n[4],e[i+5]=n[5],e[i+6]=n[6],e[i+7]=n[7],e[i+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}};const z2=new Nh;function Yq(r){for(let e=r.length-1;e>=0;--e)if(r[e]>=65535)return!0;return!1}function j2(r){return document.createElementNS("http://www.w3.org/1999/xhtml",r)}const oO={};function Kq(r){r in oO||(oO[r]=!0,console.warn(r))}const lO=new Nh().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),cO=new Nh().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),yx={[P2]:{transfer:k2,primaries:iO,toReference:r=>r,fromReference:r=>r},[Rl]:{transfer:tO,primaries:iO,toReference:r=>r.convertSRGBToLinear(),fromReference:r=>r.convertLinearToSRGB()},[eO]:{transfer:k2,primaries:rO,toReference:r=>r.applyMatrix3(cO),fromReference:r=>r.applyMatrix3(lO)},[Bq]:{transfer:tO,primaries:rO,toReference:r=>r.convertSRGBToLinear().applyMatrix3(cO),fromReference:r=>r.applyMatrix3(lO).convertLinearToSRGB()}},Jq=new Set([P2,eO]),Yl={enabled:!0,_workingColorSpace:P2,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(r){if(!Jq.has(r))throw new Error(`Unsupported working color space, "${r}".`);this._workingColorSpace=r},convert:function(r,e,i){if(this.enabled===!1||e===i||!e||!i)return r;const n=yx[e].toReference,s=yx[i].fromReference;return s(n(r))},fromWorkingColorSpace:function(r,e){return this.convert(r,this._workingColorSpace,e)},toWorkingColorSpace:function(r,e){return this.convert(r,e,this._workingColorSpace)},getPrimaries:function(r){return yx[r].primaries},getTransfer:function(r){return r===$D?k2:yx[r].transfer}};function Gf(r){return r<.04045?r*.0773993808:Math.pow(r*.9478672986+.0521327014,2.4)}function V2(r){return r<.0031308?r*12.92:1.055*Math.pow(r,.41666)-.055}let Hf,Zq=class{static getDataURL(r){if(/^data:/i.test(r.src)||typeof HTMLCanvasElement>"u")return r.src;let e;if(r instanceof HTMLCanvasElement)e=r;else{Hf===void 0&&(Hf=j2("canvas")),Hf.width=r.width,Hf.height=r.height;const i=Hf.getContext("2d");r instanceof ImageData?i.putImageData(r,0,0):i.drawImage(r,0,0,r.width,r.height),e=Hf}return e.width>2048||e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",r),e.toDataURL("image/jpeg",.6)):e.toDataURL("image/png")}static sRGBToLinear(r){if(typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&r instanceof ImageBitmap){const e=j2("canvas");e.width=r.width,e.height=r.height;const i=e.getContext("2d");i.drawImage(r,0,0,r.width,r.height);const n=i.getImageData(0,0,r.width,r.height),s=n.data;for(let o=0;o<s.length;o++)s[o]=Gf(s[o]/255)*255;return i.putImageData(n,0,0),e}else if(r.data){const e=r.data.slice(0);for(let i=0;i<e.length;i++)e instanceof Uint8Array||e instanceof Uint8ClampedArray?e[i]=Math.floor(Gf(e[i]/255)*255):e[i]=Gf(e[i]);return{data:e,width:r.width,height:r.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),r}},$q=0,eX=class{constructor(r=null){this.isSource=!0,Object.defineProperty(this,"id",{value:$q++}),this.uuid=Bh(),this.data=r,this.dataReady=!0,this.version=0}set needsUpdate(r){r===!0&&this.version++}toJSON(r){const e=r===void 0||typeof r=="string";if(!e&&r.images[this.uuid]!==void 0)return r.images[this.uuid];const i={uuid:this.uuid,url:""},n=this.data;if(n!==null){let s;if(Array.isArray(n)){s=[];for(let o=0,l=n.length;o<l;o++)n[o].isDataTexture?s.push(G2(n[o].image)):s.push(G2(n[o]))}else s=G2(n);i.url=s}return e||(r.images[this.uuid]=i),i}};function G2(r){return typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&r instanceof ImageBitmap?Zq.getDataURL(r):r.data?{data:Array.from(r.data),width:r.width,height:r.height,type:r.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let tX=0,hu=class Jw extends Ax{constructor(e=Jw.DEFAULT_IMAGE,i=Jw.DEFAULT_MAPPING,n=zf,s=zf,o=Cq,l=Sq,u=qD,c=Tq,h=Jw.DEFAULT_ANISOTROPY,p=$D){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:tX++}),this.uuid=Bh(),this.name="",this.source=new eX(e),this.mipmaps=[],this.mapping=i,this.channel=0,this.wrapS=n,this.wrapT=s,this.magFilter=o,this.minFilter=l,this.anisotropy=h,this.format=u,this.internalFormat=null,this.type=c,this.offset=new Hs(0,0),this.repeat=new Hs(1,1),this.center=new Hs(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Nh,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=p,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const i=e===void 0||typeof e=="string";if(!i&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),i||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==HD)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case px:e.x=e.x-Math.floor(e.x);break;case zf:e.x=e.x<0?0:1;break;case WD:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case px:e.y=e.y-Math.floor(e.y);break;case zf:e.y=e.y<0?0:1;break;case WD:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}};hu.DEFAULT_IMAGE=null,hu.DEFAULT_MAPPING=HD,hu.DEFAULT_ANISOTROPY=1;let Fo=class nH{constructor(e=0,i=0,n=0,s=1){nH.prototype.isVector4=!0,this.x=e,this.y=i,this.z=n,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,i,n,s){return this.x=e,this.y=i,this.z=n,this.w=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;case 3:this.w=i;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this.z=e.z+i.z,this.w=e.w+i.w,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this.z+=e.z*i,this.w+=e.w*i,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this.z=e.z-i.z,this.w=e.w-i.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const i=this.x,n=this.y,s=this.z,o=this.w,l=e.elements;return this.x=l[0]*i+l[4]*n+l[8]*s+l[12]*o,this.y=l[1]*i+l[5]*n+l[9]*s+l[13]*o,this.z=l[2]*i+l[6]*n+l[10]*s+l[14]*o,this.w=l[3]*i+l[7]*n+l[11]*s+l[15]*o,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const i=Math.sqrt(1-e.w*e.w);return i<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/i,this.y=e.y/i,this.z=e.z/i),this}setAxisAngleFromRotationMatrix(e){let i,n,s,o;const l=e.elements,u=l[0],c=l[4],h=l[8],p=l[1],f=l[5],m=l[9],g=l[2],y=l[6],x=l[10];if(Math.abs(c-p)<.01&&Math.abs(h-g)<.01&&Math.abs(m-y)<.01){if(Math.abs(c+p)<.1&&Math.abs(h+g)<.1&&Math.abs(m+y)<.1&&Math.abs(u+f+x-3)<.1)return this.set(1,0,0,0),this;i=Math.PI;const _=(u+1)/2,T=(f+1)/2,w=(x+1)/2,S=(c+p)/4,R=(h+g)/4,B=(m+y)/4;return _>T&&_>w?_<.01?(n=0,s=.707106781,o=.707106781):(n=Math.sqrt(_),s=S/n,o=R/n):T>w?T<.01?(n=.707106781,s=0,o=.707106781):(s=Math.sqrt(T),n=S/s,o=B/s):w<.01?(n=.707106781,s=.707106781,o=0):(o=Math.sqrt(w),n=R/o,s=B/o),this.set(n,s,o,i),this}let v=Math.sqrt((y-m)*(y-m)+(h-g)*(h-g)+(p-c)*(p-c));return Math.abs(v)<.001&&(v=1),this.x=(y-m)/v,this.y=(h-g)/v,this.z=(p-c)/v,this.w=Math.acos((u+f+x-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,i){return this.x=Math.max(e.x,Math.min(i.x,this.x)),this.y=Math.max(e.y,Math.min(i.y,this.y)),this.z=Math.max(e.z,Math.min(i.z,this.z)),this.w=Math.max(e.w,Math.min(i.w,this.w)),this}clampScalar(e,i){return this.x=Math.max(e,Math.min(i,this.x)),this.y=Math.max(e,Math.min(i,this.y)),this.z=Math.max(e,Math.min(i,this.z)),this.w=Math.max(e,Math.min(i,this.w)),this}clampLength(e,i){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(i,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this.z+=(e.z-this.z)*i,this.w+=(e.w-this.w)*i,this}lerpVectors(e,i,n){return this.x=e.x+(i.x-e.x)*n,this.y=e.y+(i.y-e.y)*n,this.z=e.z+(i.z-e.z)*n,this.w=e.w+(i.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this.z=e[i+2],this.w=e[i+3],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e[i+2]=this.z,e[i+3]=this.w,e}fromBufferAttribute(e,i){return this.x=e.getX(i),this.y=e.getY(i),this.z=e.getZ(i),this.w=e.getW(i),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},Uo=class{constructor(r=0,e=0,i=0,n=1){this.isQuaternion=!0,this._x=r,this._y=e,this._z=i,this._w=n}static slerpFlat(r,e,i,n,s,o,l){let u=i[n+0],c=i[n+1],h=i[n+2],p=i[n+3];const f=s[o+0],m=s[o+1],g=s[o+2],y=s[o+3];if(l===0){r[e+0]=u,r[e+1]=c,r[e+2]=h,r[e+3]=p;return}if(l===1){r[e+0]=f,r[e+1]=m,r[e+2]=g,r[e+3]=y;return}if(p!==y||u!==f||c!==m||h!==g){let x=1-l;const v=u*f+c*m+h*g+p*y,_=v>=0?1:-1,T=1-v*v;if(T>Number.EPSILON){const S=Math.sqrt(T),R=Math.atan2(S,v*_);x=Math.sin(x*R)/S,l=Math.sin(l*R)/S}const w=l*_;if(u=u*x+f*w,c=c*x+m*w,h=h*x+g*w,p=p*x+y*w,x===1-l){const S=1/Math.sqrt(u*u+c*c+h*h+p*p);u*=S,c*=S,h*=S,p*=S}}r[e]=u,r[e+1]=c,r[e+2]=h,r[e+3]=p}static multiplyQuaternionsFlat(r,e,i,n,s,o){const l=i[n],u=i[n+1],c=i[n+2],h=i[n+3],p=s[o],f=s[o+1],m=s[o+2],g=s[o+3];return r[e]=l*g+h*p+u*m-c*f,r[e+1]=u*g+h*f+c*p-l*m,r[e+2]=c*g+h*m+l*f-u*p,r[e+3]=h*g-l*p-u*f-c*m,r}get x(){return this._x}set x(r){this._x=r,this._onChangeCallback()}get y(){return this._y}set y(r){this._y=r,this._onChangeCallback()}get z(){return this._z}set z(r){this._z=r,this._onChangeCallback()}get w(){return this._w}set w(r){this._w=r,this._onChangeCallback()}set(r,e,i,n){return this._x=r,this._y=e,this._z=i,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(r){return this._x=r.x,this._y=r.y,this._z=r.z,this._w=r.w,this._onChangeCallback(),this}setFromEuler(r,e=!0){const i=r._x,n=r._y,s=r._z,o=r._order,l=Math.cos,u=Math.sin,c=l(i/2),h=l(n/2),p=l(s/2),f=u(i/2),m=u(n/2),g=u(s/2);switch(o){case"XYZ":this._x=f*h*p+c*m*g,this._y=c*m*p-f*h*g,this._z=c*h*g+f*m*p,this._w=c*h*p-f*m*g;break;case"YXZ":this._x=f*h*p+c*m*g,this._y=c*m*p-f*h*g,this._z=c*h*g-f*m*p,this._w=c*h*p+f*m*g;break;case"ZXY":this._x=f*h*p-c*m*g,this._y=c*m*p+f*h*g,this._z=c*h*g+f*m*p,this._w=c*h*p-f*m*g;break;case"ZYX":this._x=f*h*p-c*m*g,this._y=c*m*p+f*h*g,this._z=c*h*g-f*m*p,this._w=c*h*p+f*m*g;break;case"YZX":this._x=f*h*p+c*m*g,this._y=c*m*p+f*h*g,this._z=c*h*g-f*m*p,this._w=c*h*p-f*m*g;break;case"XZY":this._x=f*h*p-c*m*g,this._y=c*m*p-f*h*g,this._z=c*h*g+f*m*p,this._w=c*h*p+f*m*g;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return e===!0&&this._onChangeCallback(),this}setFromAxisAngle(r,e){const i=e/2,n=Math.sin(i);return this._x=r.x*n,this._y=r.y*n,this._z=r.z*n,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(r){const e=r.elements,i=e[0],n=e[4],s=e[8],o=e[1],l=e[5],u=e[9],c=e[2],h=e[6],p=e[10],f=i+l+p;if(f>0){const m=.5/Math.sqrt(f+1);this._w=.25/m,this._x=(h-u)*m,this._y=(s-c)*m,this._z=(o-n)*m}else if(i>l&&i>p){const m=2*Math.sqrt(1+i-l-p);this._w=(h-u)/m,this._x=.25*m,this._y=(n+o)/m,this._z=(s+c)/m}else if(l>p){const m=2*Math.sqrt(1+l-i-p);this._w=(s-c)/m,this._x=(n+o)/m,this._y=.25*m,this._z=(u+h)/m}else{const m=2*Math.sqrt(1+p-i-l);this._w=(o-n)/m,this._x=(s+c)/m,this._y=(u+h)/m,this._z=.25*m}return this._onChangeCallback(),this}setFromUnitVectors(r,e){let i=r.dot(e)+1;return i<Number.EPSILON?(i=0,Math.abs(r.x)>Math.abs(r.z)?(this._x=-r.y,this._y=r.x,this._z=0,this._w=i):(this._x=0,this._y=-r.z,this._z=r.y,this._w=i)):(this._x=r.y*e.z-r.z*e.y,this._y=r.z*e.x-r.x*e.z,this._z=r.x*e.y-r.y*e.x,this._w=i),this.normalize()}angleTo(r){return 2*Math.acos(Math.abs(ka(this.dot(r),-1,1)))}rotateTowards(r,e){const i=this.angleTo(r);if(i===0)return this;const n=Math.min(1,e/i);return this.slerp(r,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(r){return this._x*r._x+this._y*r._y+this._z*r._z+this._w*r._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let r=this.length();return r===0?(this._x=0,this._y=0,this._z=0,this._w=1):(r=1/r,this._x=this._x*r,this._y=this._y*r,this._z=this._z*r,this._w=this._w*r),this._onChangeCallback(),this}multiply(r){return this.multiplyQuaternions(this,r)}premultiply(r){return this.multiplyQuaternions(r,this)}multiplyQuaternions(r,e){const i=r._x,n=r._y,s=r._z,o=r._w,l=e._x,u=e._y,c=e._z,h=e._w;return this._x=i*h+o*l+n*c-s*u,this._y=n*h+o*u+s*l-i*c,this._z=s*h+o*c+i*u-n*l,this._w=o*h-i*l-n*u-s*c,this._onChangeCallback(),this}slerp(r,e){if(e===0)return this;if(e===1)return this.copy(r);const i=this._x,n=this._y,s=this._z,o=this._w;let l=o*r._w+i*r._x+n*r._y+s*r._z;if(l<0?(this._w=-r._w,this._x=-r._x,this._y=-r._y,this._z=-r._z,l=-l):this.copy(r),l>=1)return this._w=o,this._x=i,this._y=n,this._z=s,this;const u=1-l*l;if(u<=Number.EPSILON){const m=1-e;return this._w=m*o+e*this._w,this._x=m*i+e*this._x,this._y=m*n+e*this._y,this._z=m*s+e*this._z,this.normalize(),this}const c=Math.sqrt(u),h=Math.atan2(c,l),p=Math.sin((1-e)*h)/c,f=Math.sin(e*h)/c;return this._w=o*p+this._w*f,this._x=i*p+this._x*f,this._y=n*p+this._y*f,this._z=s*p+this._z*f,this._onChangeCallback(),this}slerpQuaternions(r,e,i){return this.copy(r).slerp(e,i)}random(){const r=2*Math.PI*Math.random(),e=2*Math.PI*Math.random(),i=Math.random(),n=Math.sqrt(1-i),s=Math.sqrt(i);return this.set(n*Math.sin(r),n*Math.cos(r),s*Math.sin(e),s*Math.cos(e))}equals(r){return r._x===this._x&&r._y===this._y&&r._z===this._z&&r._w===this._w}fromArray(r,e=0){return this._x=r[e],this._y=r[e+1],this._z=r[e+2],this._w=r[e+3],this._onChangeCallback(),this}toArray(r=[],e=0){return r[e]=this._x,r[e+1]=this._y,r[e+2]=this._z,r[e+3]=this._w,r}fromBufferAttribute(r,e){return this._x=r.getX(e),this._y=r.getY(e),this._z=r.getZ(e),this._w=r.getW(e),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(r){return this._onChangeCallback=r,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},Lt=class sH{constructor(e=0,i=0,n=0){sH.prototype.isVector3=!0,this.x=e,this.y=i,this.z=n}set(e,i,n){return n===void 0&&(n=this.z),this.x=e,this.y=i,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this.z=e.z+i.z,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this.z+=e.z*i,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this.z=e.z-i.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,i){return this.x=e.x*i.x,this.y=e.y*i.y,this.z=e.z*i.z,this}applyEuler(e){return this.applyQuaternion(uO.setFromEuler(e))}applyAxisAngle(e,i){return this.applyQuaternion(uO.setFromAxisAngle(e,i))}applyMatrix3(e){const i=this.x,n=this.y,s=this.z,o=e.elements;return this.x=o[0]*i+o[3]*n+o[6]*s,this.y=o[1]*i+o[4]*n+o[7]*s,this.z=o[2]*i+o[5]*n+o[8]*s,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const i=this.x,n=this.y,s=this.z,o=e.elements,l=1/(o[3]*i+o[7]*n+o[11]*s+o[15]);return this.x=(o[0]*i+o[4]*n+o[8]*s+o[12])*l,this.y=(o[1]*i+o[5]*n+o[9]*s+o[13])*l,this.z=(o[2]*i+o[6]*n+o[10]*s+o[14])*l,this}applyQuaternion(e){const i=this.x,n=this.y,s=this.z,o=e.x,l=e.y,u=e.z,c=e.w,h=2*(l*s-u*n),p=2*(u*i-o*s),f=2*(o*n-l*i);return this.x=i+c*h+l*f-u*p,this.y=n+c*p+u*h-o*f,this.z=s+c*f+o*p-l*h,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const i=this.x,n=this.y,s=this.z,o=e.elements;return this.x=o[0]*i+o[4]*n+o[8]*s,this.y=o[1]*i+o[5]*n+o[9]*s,this.z=o[2]*i+o[6]*n+o[10]*s,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,i){return this.x=Math.max(e.x,Math.min(i.x,this.x)),this.y=Math.max(e.y,Math.min(i.y,this.y)),this.z=Math.max(e.z,Math.min(i.z,this.z)),this}clampScalar(e,i){return this.x=Math.max(e,Math.min(i,this.x)),this.y=Math.max(e,Math.min(i,this.y)),this.z=Math.max(e,Math.min(i,this.z)),this}clampLength(e,i){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(i,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this.z+=(e.z-this.z)*i,this}lerpVectors(e,i,n){return this.x=e.x+(i.x-e.x)*n,this.y=e.y+(i.y-e.y)*n,this.z=e.z+(i.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,i){const n=e.x,s=e.y,o=e.z,l=i.x,u=i.y,c=i.z;return this.x=s*c-o*u,this.y=o*l-n*c,this.z=n*u-s*l,this}projectOnVector(e){const i=e.lengthSq();if(i===0)return this.set(0,0,0);const n=e.dot(this)/i;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return H2.copy(this).projectOnVector(e),this.sub(H2)}reflect(e){return this.sub(H2.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const i=Math.sqrt(this.lengthSq()*e.lengthSq());if(i===0)return Math.PI/2;const n=this.dot(e)/i;return Math.acos(ka(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const i=this.x-e.x,n=this.y-e.y,s=this.z-e.z;return i*i+n*n+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,i,n){const s=Math.sin(i)*e;return this.x=s*Math.sin(n),this.y=Math.cos(i)*e,this.z=s*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,i,n){return this.x=e*Math.sin(i),this.y=n,this.z=e*Math.cos(i),this}setFromMatrixPosition(e){const i=e.elements;return this.x=i[12],this.y=i[13],this.z=i[14],this}setFromMatrixScale(e){const i=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),s=this.setFromMatrixColumn(e,2).length();return this.x=i,this.y=n,this.z=s,this}setFromMatrixColumn(e,i){return this.fromArray(e.elements,i*4)}setFromMatrix3Column(e,i){return this.fromArray(e.elements,i*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this.z=e[i+2],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e[i+2]=this.z,e}fromBufferAttribute(e,i){return this.x=e.getX(i),this.y=e.getY(i),this.z=e.getZ(i),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,i=Math.random()*2-1,n=Math.sqrt(1-i*i);return this.x=n*Math.cos(e),this.y=i,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}};const H2=new Lt,uO=new Uo;let Wf=class{constructor(r=new Lt(1/0,1/0,1/0),e=new Lt(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=r,this.max=e}set(r,e){return this.min.copy(r),this.max.copy(e),this}setFromArray(r){this.makeEmpty();for(let e=0,i=r.length;e<i;e+=3)this.expandByPoint(Kl.fromArray(r,e));return this}setFromBufferAttribute(r){this.makeEmpty();for(let e=0,i=r.count;e<i;e++)this.expandByPoint(Kl.fromBufferAttribute(r,e));return this}setFromPoints(r){this.makeEmpty();for(let e=0,i=r.length;e<i;e++)this.expandByPoint(r[e]);return this}setFromCenterAndSize(r,e){const i=Kl.copy(e).multiplyScalar(.5);return this.min.copy(r).sub(i),this.max.copy(r).add(i),this}setFromObject(r,e=!1){return this.makeEmpty(),this.expandByObject(r,e)}clone(){return new this.constructor().copy(this)}copy(r){return this.min.copy(r.min),this.max.copy(r.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(r){return this.isEmpty()?r.set(0,0,0):r.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(r){return this.isEmpty()?r.set(0,0,0):r.subVectors(this.max,this.min)}expandByPoint(r){return this.min.min(r),this.max.max(r),this}expandByVector(r){return this.min.sub(r),this.max.add(r),this}expandByScalar(r){return this.min.addScalar(-r),this.max.addScalar(r),this}expandByObject(r,e=!1){r.updateWorldMatrix(!1,!1);const i=r.geometry;if(i!==void 0){const s=i.getAttribute("position");if(e===!0&&s!==void 0&&r.isInstancedMesh!==!0)for(let o=0,l=s.count;o<l;o++)r.isMesh===!0?r.getVertexPosition(o,Kl):Kl.fromBufferAttribute(s,o),Kl.applyMatrix4(r.matrixWorld),this.expandByPoint(Kl);else r.boundingBox!==void 0?(r.boundingBox===null&&r.computeBoundingBox(),vx.copy(r.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),vx.copy(i.boundingBox)),vx.applyMatrix4(r.matrixWorld),this.union(vx)}const n=r.children;for(let s=0,o=n.length;s<o;s++)this.expandByObject(n[s],e);return this}containsPoint(r){return!(r.x<this.min.x||r.x>this.max.x||r.y<this.min.y||r.y>this.max.y||r.z<this.min.z||r.z>this.max.z)}containsBox(r){return this.min.x<=r.min.x&&r.max.x<=this.max.x&&this.min.y<=r.min.y&&r.max.y<=this.max.y&&this.min.z<=r.min.z&&r.max.z<=this.max.z}getParameter(r,e){return e.set((r.x-this.min.x)/(this.max.x-this.min.x),(r.y-this.min.y)/(this.max.y-this.min.y),(r.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(r){return!(r.max.x<this.min.x||r.min.x>this.max.x||r.max.y<this.min.y||r.min.y>this.max.y||r.max.z<this.min.z||r.min.z>this.max.z)}intersectsSphere(r){return this.clampPoint(r.center,Kl),Kl.distanceToSquared(r.center)<=r.radius*r.radius}intersectsPlane(r){let e,i;return r.normal.x>0?(e=r.normal.x*this.min.x,i=r.normal.x*this.max.x):(e=r.normal.x*this.max.x,i=r.normal.x*this.min.x),r.normal.y>0?(e+=r.normal.y*this.min.y,i+=r.normal.y*this.max.y):(e+=r.normal.y*this.max.y,i+=r.normal.y*this.min.y),r.normal.z>0?(e+=r.normal.z*this.min.z,i+=r.normal.z*this.max.z):(e+=r.normal.z*this.max.z,i+=r.normal.z*this.min.z),e<=-r.constant&&i>=-r.constant}intersectsTriangle(r){if(this.isEmpty())return!1;this.getCenter(J0),xx.subVectors(this.max,J0),Qf.subVectors(r.a,J0),qf.subVectors(r.b,J0),Xf.subVectors(r.c,J0),Lh.subVectors(qf,Qf),Dh.subVectors(Xf,qf),$d.subVectors(Qf,Xf);let e=[0,-Lh.z,Lh.y,0,-Dh.z,Dh.y,0,-$d.z,$d.y,Lh.z,0,-Lh.x,Dh.z,0,-Dh.x,$d.z,0,-$d.x,-Lh.y,Lh.x,0,-Dh.y,Dh.x,0,-$d.y,$d.x,0];return!W2(e,Qf,qf,Xf,xx)||(e=[1,0,0,0,1,0,0,0,1],!W2(e,Qf,qf,Xf,xx))?!1:(bx.crossVectors(Lh,Dh),e=[bx.x,bx.y,bx.z],W2(e,Qf,qf,Xf,xx))}clampPoint(r,e){return e.copy(r).clamp(this.min,this.max)}distanceToPoint(r){return this.clampPoint(r,Kl).distanceTo(r)}getBoundingSphere(r){return this.isEmpty()?r.makeEmpty():(this.getCenter(r.center),r.radius=this.getSize(Kl).length()*.5),r}intersect(r){return this.min.max(r.min),this.max.min(r.max),this.isEmpty()&&this.makeEmpty(),this}union(r){return this.min.min(r.min),this.max.max(r.max),this}applyMatrix4(r){return this.isEmpty()?this:(du[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(r),du[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(r),du[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(r),du[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(r),du[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(r),du[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(r),du[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(r),du[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(r),this.setFromPoints(du),this)}translate(r){return this.min.add(r),this.max.add(r),this}equals(r){return r.min.equals(this.min)&&r.max.equals(this.max)}};const du=[new Lt,new Lt,new Lt,new Lt,new Lt,new Lt,new Lt,new Lt],Kl=new Lt,vx=new Wf,Qf=new Lt,qf=new Lt,Xf=new Lt,Lh=new Lt,Dh=new Lt,$d=new Lt,J0=new Lt,xx=new Lt,bx=new Lt,ep=new Lt;function W2(r,e,i,n,s){for(let o=0,l=r.length-3;o<=l;o+=3){ep.fromArray(r,o);const u=s.x*Math.abs(ep.x)+s.y*Math.abs(ep.y)+s.z*Math.abs(ep.z),c=e.dot(ep),h=i.dot(ep),p=n.dot(ep);if(Math.max(-Math.max(c,h,p),Math.min(c,h,p))>u)return!1}return!0}const iX=new Wf,Z0=new Lt,Q2=new Lt;let Yf=class{constructor(r=new Lt,e=-1){this.isSphere=!0,this.center=r,this.radius=e}set(r,e){return this.center.copy(r),this.radius=e,this}setFromPoints(r,e){const i=this.center;e!==void 0?i.copy(e):iX.setFromPoints(r).getCenter(i);let n=0;for(let s=0,o=r.length;s<o;s++)n=Math.max(n,i.distanceToSquared(r[s]));return this.radius=Math.sqrt(n),this}copy(r){return this.center.copy(r.center),this.radius=r.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(r){return r.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(r){return r.distanceTo(this.center)-this.radius}intersectsSphere(r){const e=this.radius+r.radius;return r.center.distanceToSquared(this.center)<=e*e}intersectsBox(r){return r.intersectsSphere(this)}intersectsPlane(r){return Math.abs(r.distanceToPoint(this.center))<=this.radius}clampPoint(r,e){const i=this.center.distanceToSquared(r);return e.copy(r),i>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(r){return this.isEmpty()?(r.makeEmpty(),r):(r.set(this.center,this.center),r.expandByScalar(this.radius),r)}applyMatrix4(r){return this.center.applyMatrix4(r),this.radius=this.radius*r.getMaxScaleOnAxis(),this}translate(r){return this.center.add(r),this}expandByPoint(r){if(this.isEmpty())return this.center.copy(r),this.radius=0,this;Z0.subVectors(r,this.center);const e=Z0.lengthSq();if(e>this.radius*this.radius){const i=Math.sqrt(e),n=(i-this.radius)*.5;this.center.addScaledVector(Z0,n/i),this.radius+=n}return this}union(r){return r.isEmpty()?this:this.isEmpty()?(this.copy(r),this):(this.center.equals(r.center)===!0?this.radius=Math.max(this.radius,r.radius):(Q2.subVectors(r.center,this.center).setLength(r.radius),this.expandByPoint(Z0.copy(r.center).add(Q2)),this.expandByPoint(Z0.copy(r.center).sub(Q2))),this)}equals(r){return r.center.equals(this.center)&&r.radius===this.radius}clone(){return new this.constructor().copy(this)}};const pu=new Lt,q2=new Lt,_x=new Lt,Oh=new Lt,X2=new Lt,Ex=new Lt,Y2=new Lt;let K2=class{constructor(r=new Lt,e=new Lt(0,0,-1)){this.origin=r,this.direction=e}set(r,e){return this.origin.copy(r),this.direction.copy(e),this}copy(r){return this.origin.copy(r.origin),this.direction.copy(r.direction),this}at(r,e){return e.copy(this.origin).addScaledVector(this.direction,r)}lookAt(r){return this.direction.copy(r).sub(this.origin).normalize(),this}recast(r){return this.origin.copy(this.at(r,pu)),this}closestPointToPoint(r,e){e.subVectors(r,this.origin);const i=e.dot(this.direction);return i<0?e.copy(this.origin):e.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(r){return Math.sqrt(this.distanceSqToPoint(r))}distanceSqToPoint(r){const e=pu.subVectors(r,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(r):(pu.copy(this.origin).addScaledVector(this.direction,e),pu.distanceToSquared(r))}distanceSqToSegment(r,e,i,n){q2.copy(r).add(e).multiplyScalar(.5),_x.copy(e).sub(r).normalize(),Oh.copy(this.origin).sub(q2);const s=r.distanceTo(e)*.5,o=-this.direction.dot(_x),l=Oh.dot(this.direction),u=-Oh.dot(_x),c=Oh.lengthSq(),h=Math.abs(1-o*o);let p,f,m,g;if(h>0)if(p=o*u-l,f=o*l-u,g=s*h,p>=0)if(f>=-g)if(f<=g){const y=1/h;p*=y,f*=y,m=p*(p+o*f+2*l)+f*(o*p+f+2*u)+c}else f=s,p=Math.max(0,-(o*f+l)),m=-p*p+f*(f+2*u)+c;else f=-s,p=Math.max(0,-(o*f+l)),m=-p*p+f*(f+2*u)+c;else f<=-g?(p=Math.max(0,-(-o*s+l)),f=p>0?-s:Math.min(Math.max(-s,-u),s),m=-p*p+f*(f+2*u)+c):f<=g?(p=0,f=Math.min(Math.max(-s,-u),s),m=f*(f+2*u)+c):(p=Math.max(0,-(o*s+l)),f=p>0?s:Math.min(Math.max(-s,-u),s),m=-p*p+f*(f+2*u)+c);else f=o>0?-s:s,p=Math.max(0,-(o*f+l)),m=-p*p+f*(f+2*u)+c;return i&&i.copy(this.origin).addScaledVector(this.direction,p),n&&n.copy(q2).addScaledVector(_x,f),m}intersectSphere(r,e){pu.subVectors(r.center,this.origin);const i=pu.dot(this.direction),n=pu.dot(pu)-i*i,s=r.radius*r.radius;if(n>s)return null;const o=Math.sqrt(s-n),l=i-o,u=i+o;return u<0?null:l<0?this.at(u,e):this.at(l,e)}intersectsSphere(r){return this.distanceSqToPoint(r.center)<=r.radius*r.radius}distanceToPlane(r){const e=r.normal.dot(this.direction);if(e===0)return r.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(r.normal)+r.constant)/e;return i>=0?i:null}intersectPlane(r,e){const i=this.distanceToPlane(r);return i===null?null:this.at(i,e)}intersectsPlane(r){const e=r.distanceToPoint(this.origin);return e===0||r.normal.dot(this.direction)*e<0}intersectBox(r,e){let i,n,s,o,l,u;const c=1/this.direction.x,h=1/this.direction.y,p=1/this.direction.z,f=this.origin;return c>=0?(i=(r.min.x-f.x)*c,n=(r.max.x-f.x)*c):(i=(r.max.x-f.x)*c,n=(r.min.x-f.x)*c),h>=0?(s=(r.min.y-f.y)*h,o=(r.max.y-f.y)*h):(s=(r.max.y-f.y)*h,o=(r.min.y-f.y)*h),i>o||s>n||((s>i||isNaN(i))&&(i=s),(o<n||isNaN(n))&&(n=o),p>=0?(l=(r.min.z-f.z)*p,u=(r.max.z-f.z)*p):(l=(r.max.z-f.z)*p,u=(r.min.z-f.z)*p),i>u||l>n)||((l>i||i!==i)&&(i=l),(u<n||n!==n)&&(n=u),n<0)?null:this.at(i>=0?i:n,e)}intersectsBox(r){return this.intersectBox(r,pu)!==null}intersectTriangle(r,e,i,n,s){X2.subVectors(e,r),Ex.subVectors(i,r),Y2.crossVectors(X2,Ex);let o=this.direction.dot(Y2),l;if(o>0){if(n)return null;l=1}else if(o<0)l=-1,o=-o;else return null;Oh.subVectors(this.origin,r);const u=l*this.direction.dot(Ex.crossVectors(Oh,Ex));if(u<0)return null;const c=l*this.direction.dot(X2.cross(Oh));if(c<0||u+c>o)return null;const h=-l*Oh.dot(Y2);return h<0?null:this.at(h/o,s)}applyMatrix4(r){return this.origin.applyMatrix4(r),this.direction.transformDirection(r),this}equals(r){return r.origin.equals(this.origin)&&r.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},Qr=class cL{constructor(e,i,n,s,o,l,u,c,h,p,f,m,g,y,x,v){cL.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,i,n,s,o,l,u,c,h,p,f,m,g,y,x,v)}set(e,i,n,s,o,l,u,c,h,p,f,m,g,y,x,v){const _=this.elements;return _[0]=e,_[4]=i,_[8]=n,_[12]=s,_[1]=o,_[5]=l,_[9]=u,_[13]=c,_[2]=h,_[6]=p,_[10]=f,_[14]=m,_[3]=g,_[7]=y,_[11]=x,_[15]=v,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new cL().fromArray(this.elements)}copy(e){const i=this.elements,n=e.elements;return i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],this}copyPosition(e){const i=this.elements,n=e.elements;return i[12]=n[12],i[13]=n[13],i[14]=n[14],this}setFromMatrix3(e){const i=e.elements;return this.set(i[0],i[3],i[6],0,i[1],i[4],i[7],0,i[2],i[5],i[8],0,0,0,0,1),this}extractBasis(e,i,n){return e.setFromMatrixColumn(this,0),i.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,i,n){return this.set(e.x,i.x,n.x,0,e.y,i.y,n.y,0,e.z,i.z,n.z,0,0,0,0,1),this}extractRotation(e){const i=this.elements,n=e.elements,s=1/Kf.setFromMatrixColumn(e,0).length(),o=1/Kf.setFromMatrixColumn(e,1).length(),l=1/Kf.setFromMatrixColumn(e,2).length();return i[0]=n[0]*s,i[1]=n[1]*s,i[2]=n[2]*s,i[3]=0,i[4]=n[4]*o,i[5]=n[5]*o,i[6]=n[6]*o,i[7]=0,i[8]=n[8]*l,i[9]=n[9]*l,i[10]=n[10]*l,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromEuler(e){const i=this.elements,n=e.x,s=e.y,o=e.z,l=Math.cos(n),u=Math.sin(n),c=Math.cos(s),h=Math.sin(s),p=Math.cos(o),f=Math.sin(o);if(e.order==="XYZ"){const m=l*p,g=l*f,y=u*p,x=u*f;i[0]=c*p,i[4]=-c*f,i[8]=h,i[1]=g+y*h,i[5]=m-x*h,i[9]=-u*c,i[2]=x-m*h,i[6]=y+g*h,i[10]=l*c}else if(e.order==="YXZ"){const m=c*p,g=c*f,y=h*p,x=h*f;i[0]=m+x*u,i[4]=y*u-g,i[8]=l*h,i[1]=l*f,i[5]=l*p,i[9]=-u,i[2]=g*u-y,i[6]=x+m*u,i[10]=l*c}else if(e.order==="ZXY"){const m=c*p,g=c*f,y=h*p,x=h*f;i[0]=m-x*u,i[4]=-l*f,i[8]=y+g*u,i[1]=g+y*u,i[5]=l*p,i[9]=x-m*u,i[2]=-l*h,i[6]=u,i[10]=l*c}else if(e.order==="ZYX"){const m=l*p,g=l*f,y=u*p,x=u*f;i[0]=c*p,i[4]=y*h-g,i[8]=m*h+x,i[1]=c*f,i[5]=x*h+m,i[9]=g*h-y,i[2]=-h,i[6]=u*c,i[10]=l*c}else if(e.order==="YZX"){const m=l*c,g=l*h,y=u*c,x=u*h;i[0]=c*p,i[4]=x-m*f,i[8]=y*f+g,i[1]=f,i[5]=l*p,i[9]=-u*p,i[2]=-h*p,i[6]=g*f+y,i[10]=m-x*f}else if(e.order==="XZY"){const m=l*c,g=l*h,y=u*c,x=u*h;i[0]=c*p,i[4]=-f,i[8]=h*p,i[1]=m*f+x,i[5]=l*p,i[9]=g*f-y,i[2]=y*f-g,i[6]=u*p,i[10]=x*f+m}return i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromQuaternion(e){return this.compose(rX,e,nX)}lookAt(e,i,n){const s=this.elements;return ol.subVectors(e,i),ol.lengthSq()===0&&(ol.z=1),ol.normalize(),Ph.crossVectors(n,ol),Ph.lengthSq()===0&&(Math.abs(n.z)===1?ol.x+=1e-4:ol.z+=1e-4,ol.normalize(),Ph.crossVectors(n,ol)),Ph.normalize(),wx.crossVectors(ol,Ph),s[0]=Ph.x,s[4]=wx.x,s[8]=ol.x,s[1]=Ph.y,s[5]=wx.y,s[9]=ol.y,s[2]=Ph.z,s[6]=wx.z,s[10]=ol.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,i){const n=e.elements,s=i.elements,o=this.elements,l=n[0],u=n[4],c=n[8],h=n[12],p=n[1],f=n[5],m=n[9],g=n[13],y=n[2],x=n[6],v=n[10],_=n[14],T=n[3],w=n[7],S=n[11],R=n[15],B=s[0],I=s[4],D=s[8],L=s[12],O=s[1],U=s[5],Z=s[9],G=s[13],z=s[2],$=s[6],Q=s[10],H=s[14],V=s[3],ne=s[7],Y=s[11],ae=s[15];return o[0]=l*B+u*O+c*z+h*V,o[4]=l*I+u*U+c*$+h*ne,o[8]=l*D+u*Z+c*Q+h*Y,o[12]=l*L+u*G+c*H+h*ae,o[1]=p*B+f*O+m*z+g*V,o[5]=p*I+f*U+m*$+g*ne,o[9]=p*D+f*Z+m*Q+g*Y,o[13]=p*L+f*G+m*H+g*ae,o[2]=y*B+x*O+v*z+_*V,o[6]=y*I+x*U+v*$+_*ne,o[10]=y*D+x*Z+v*Q+_*Y,o[14]=y*L+x*G+v*H+_*ae,o[3]=T*B+w*O+S*z+R*V,o[7]=T*I+w*U+S*$+R*ne,o[11]=T*D+w*Z+S*Q+R*Y,o[15]=T*L+w*G+S*H+R*ae,this}multiplyScalar(e){const i=this.elements;return i[0]*=e,i[4]*=e,i[8]*=e,i[12]*=e,i[1]*=e,i[5]*=e,i[9]*=e,i[13]*=e,i[2]*=e,i[6]*=e,i[10]*=e,i[14]*=e,i[3]*=e,i[7]*=e,i[11]*=e,i[15]*=e,this}determinant(){const e=this.elements,i=e[0],n=e[4],s=e[8],o=e[12],l=e[1],u=e[5],c=e[9],h=e[13],p=e[2],f=e[6],m=e[10],g=e[14],y=e[3],x=e[7],v=e[11],_=e[15];return y*(+o*c*f-s*h*f-o*u*m+n*h*m+s*u*g-n*c*g)+x*(+i*c*g-i*h*m+o*l*m-s*l*g+s*h*p-o*c*p)+v*(+i*h*f-i*u*g-o*l*f+n*l*g+o*u*p-n*h*p)+_*(-s*u*p-i*c*f+i*u*m+s*l*f-n*l*m+n*c*p)}transpose(){const e=this.elements;let i;return i=e[1],e[1]=e[4],e[4]=i,i=e[2],e[2]=e[8],e[8]=i,i=e[6],e[6]=e[9],e[9]=i,i=e[3],e[3]=e[12],e[12]=i,i=e[7],e[7]=e[13],e[13]=i,i=e[11],e[11]=e[14],e[14]=i,this}setPosition(e,i,n){const s=this.elements;return e.isVector3?(s[12]=e.x,s[13]=e.y,s[14]=e.z):(s[12]=e,s[13]=i,s[14]=n),this}invert(){const e=this.elements,i=e[0],n=e[1],s=e[2],o=e[3],l=e[4],u=e[5],c=e[6],h=e[7],p=e[8],f=e[9],m=e[10],g=e[11],y=e[12],x=e[13],v=e[14],_=e[15],T=f*v*h-x*m*h+x*c*g-u*v*g-f*c*_+u*m*_,w=y*m*h-p*v*h-y*c*g+l*v*g+p*c*_-l*m*_,S=p*x*h-y*f*h+y*u*g-l*x*g-p*u*_+l*f*_,R=y*f*c-p*x*c-y*u*m+l*x*m+p*u*v-l*f*v,B=i*T+n*w+s*S+o*R;if(B===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const I=1/B;return e[0]=T*I,e[1]=(x*m*o-f*v*o-x*s*g+n*v*g+f*s*_-n*m*_)*I,e[2]=(u*v*o-x*c*o+x*s*h-n*v*h-u*s*_+n*c*_)*I,e[3]=(f*c*o-u*m*o-f*s*h+n*m*h+u*s*g-n*c*g)*I,e[4]=w*I,e[5]=(p*v*o-y*m*o+y*s*g-i*v*g-p*s*_+i*m*_)*I,e[6]=(y*c*o-l*v*o-y*s*h+i*v*h+l*s*_-i*c*_)*I,e[7]=(l*m*o-p*c*o+p*s*h-i*m*h-l*s*g+i*c*g)*I,e[8]=S*I,e[9]=(y*f*o-p*x*o-y*n*g+i*x*g+p*n*_-i*f*_)*I,e[10]=(l*x*o-y*u*o+y*n*h-i*x*h-l*n*_+i*u*_)*I,e[11]=(p*u*o-l*f*o-p*n*h+i*f*h+l*n*g-i*u*g)*I,e[12]=R*I,e[13]=(p*x*s-y*f*s+y*n*m-i*x*m-p*n*v+i*f*v)*I,e[14]=(y*u*s-l*x*s-y*n*c+i*x*c+l*n*v-i*u*v)*I,e[15]=(l*f*s-p*u*s+p*n*c-i*f*c-l*n*m+i*u*m)*I,this}scale(e){const i=this.elements,n=e.x,s=e.y,o=e.z;return i[0]*=n,i[4]*=s,i[8]*=o,i[1]*=n,i[5]*=s,i[9]*=o,i[2]*=n,i[6]*=s,i[10]*=o,i[3]*=n,i[7]*=s,i[11]*=o,this}getMaxScaleOnAxis(){const e=this.elements,i=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],s=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(i,n,s))}makeTranslation(e,i,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,i,0,0,1,n,0,0,0,1),this}makeRotationX(e){const i=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,i,-n,0,0,n,i,0,0,0,0,1),this}makeRotationY(e){const i=Math.cos(e),n=Math.sin(e);return this.set(i,0,n,0,0,1,0,0,-n,0,i,0,0,0,0,1),this}makeRotationZ(e){const i=Math.cos(e),n=Math.sin(e);return this.set(i,-n,0,0,n,i,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,i){const n=Math.cos(i),s=Math.sin(i),o=1-n,l=e.x,u=e.y,c=e.z,h=o*l,p=o*u;return this.set(h*l+n,h*u-s*c,h*c+s*u,0,h*u+s*c,p*u+n,p*c-s*l,0,h*c-s*u,p*c+s*l,o*c*c+n,0,0,0,0,1),this}makeScale(e,i,n){return this.set(e,0,0,0,0,i,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,i,n,s,o,l){return this.set(1,n,o,0,e,1,l,0,i,s,1,0,0,0,0,1),this}compose(e,i,n){const s=this.elements,o=i._x,l=i._y,u=i._z,c=i._w,h=o+o,p=l+l,f=u+u,m=o*h,g=o*p,y=o*f,x=l*p,v=l*f,_=u*f,T=c*h,w=c*p,S=c*f,R=n.x,B=n.y,I=n.z;return s[0]=(1-(x+_))*R,s[1]=(g+S)*R,s[2]=(y-w)*R,s[3]=0,s[4]=(g-S)*B,s[5]=(1-(m+_))*B,s[6]=(v+T)*B,s[7]=0,s[8]=(y+w)*I,s[9]=(v-T)*I,s[10]=(1-(m+x))*I,s[11]=0,s[12]=e.x,s[13]=e.y,s[14]=e.z,s[15]=1,this}decompose(e,i,n){const s=this.elements;let o=Kf.set(s[0],s[1],s[2]).length();const l=Kf.set(s[4],s[5],s[6]).length(),u=Kf.set(s[8],s[9],s[10]).length();this.determinant()<0&&(o=-o),e.x=s[12],e.y=s[13],e.z=s[14],Jl.copy(this);const c=1/o,h=1/l,p=1/u;return Jl.elements[0]*=c,Jl.elements[1]*=c,Jl.elements[2]*=c,Jl.elements[4]*=h,Jl.elements[5]*=h,Jl.elements[6]*=h,Jl.elements[8]*=p,Jl.elements[9]*=p,Jl.elements[10]*=p,i.setFromRotationMatrix(Jl),n.x=o,n.y=l,n.z=u,this}makePerspective(e,i,n,s,o,l,u=Zd){const c=this.elements,h=2*o/(i-e),p=2*o/(n-s),f=(i+e)/(i-e),m=(n+s)/(n-s);let g,y;if(u===Zd)g=-(l+o)/(l-o),y=-2*l*o/(l-o);else if(u===F2)g=-l/(l-o),y=-l*o/(l-o);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+u);return c[0]=h,c[4]=0,c[8]=f,c[12]=0,c[1]=0,c[5]=p,c[9]=m,c[13]=0,c[2]=0,c[6]=0,c[10]=g,c[14]=y,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}makeOrthographic(e,i,n,s,o,l,u=Zd){const c=this.elements,h=1/(i-e),p=1/(n-s),f=1/(l-o),m=(i+e)*h,g=(n+s)*p;let y,x;if(u===Zd)y=(l+o)*f,x=-2*f;else if(u===F2)y=o*f,x=-1*f;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+u);return c[0]=2*h,c[4]=0,c[8]=0,c[12]=-m,c[1]=0,c[5]=2*p,c[9]=0,c[13]=-g,c[2]=0,c[6]=0,c[10]=x,c[14]=-y,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}equals(e){const i=this.elements,n=e.elements;for(let s=0;s<16;s++)if(i[s]!==n[s])return!1;return!0}fromArray(e,i=0){for(let n=0;n<16;n++)this.elements[n]=e[n+i];return this}toArray(e=[],i=0){const n=this.elements;return e[i]=n[0],e[i+1]=n[1],e[i+2]=n[2],e[i+3]=n[3],e[i+4]=n[4],e[i+5]=n[5],e[i+6]=n[6],e[i+7]=n[7],e[i+8]=n[8],e[i+9]=n[9],e[i+10]=n[10],e[i+11]=n[11],e[i+12]=n[12],e[i+13]=n[13],e[i+14]=n[14],e[i+15]=n[15],e}};const Kf=new Lt,Jl=new Qr,rX=new Lt(0,0,0),nX=new Lt(1,1,1),Ph=new Lt,wx=new Lt,ol=new Lt,hO=new Qr,dO=new Uo;let Ao=class aH{constructor(e=0,i=0,n=0,s=aH.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=i,this._z=n,this._order=s}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,i,n,s=this._order){return this._x=e,this._y=i,this._z=n,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,i=this._order,n=!0){const s=e.elements,o=s[0],l=s[4],u=s[8],c=s[1],h=s[5],p=s[9],f=s[2],m=s[6],g=s[10];switch(i){case"XYZ":this._y=Math.asin(ka(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-p,g),this._z=Math.atan2(-l,o)):(this._x=Math.atan2(m,h),this._z=0);break;case"YXZ":this._x=Math.asin(-ka(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(u,g),this._z=Math.atan2(c,h)):(this._y=Math.atan2(-f,o),this._z=0);break;case"ZXY":this._x=Math.asin(ka(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(-f,g),this._z=Math.atan2(-l,h)):(this._y=0,this._z=Math.atan2(c,o));break;case"ZYX":this._y=Math.asin(-ka(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(m,g),this._z=Math.atan2(c,o)):(this._x=0,this._z=Math.atan2(-l,h));break;case"YZX":this._z=Math.asin(ka(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-p,h),this._y=Math.atan2(-f,o)):(this._x=0,this._y=Math.atan2(u,g));break;case"XZY":this._z=Math.asin(-ka(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(m,h),this._y=Math.atan2(u,o)):(this._x=Math.atan2(-p,g),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,i,n){return hO.makeRotationFromQuaternion(e),this.setFromRotationMatrix(hO,i,n)}setFromVector3(e,i=this._order){return this.set(e.x,e.y,e.z,i)}reorder(e){return dO.setFromEuler(this),this.setFromQuaternion(dO,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],i=0){return e[i]=this._x,e[i+1]=this._y,e[i+2]=this._z,e[i+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};Ao.DEFAULT_ORDER="XYZ";let sX=class{constructor(){this.mask=1}set(r){this.mask=(1<<r|0)>>>0}enable(r){this.mask|=1<<r|0}enableAll(){this.mask=-1}toggle(r){this.mask^=1<<r|0}disable(r){this.mask&=~(1<<r|0)}disableAll(){this.mask=0}test(r){return(this.mask&r.mask)!==0}isEnabled(r){return(this.mask&(1<<r|0))!==0}},aX=0;const pO=new Lt,Jf=new Uo,fu=new Qr,Cx=new Lt,$0=new Lt,oX=new Lt,lX=new Uo,fO=new Lt(1,0,0),mO=new Lt(0,1,0),gO=new Lt(0,0,1),AO={type:"added"},cX={type:"removed"},Zf={type:"childadded",child:null},J2={type:"childremoved",child:null};let Fa=class Zw extends Ax{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:aX++}),this.uuid=Bh(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Zw.DEFAULT_UP.clone();const e=new Lt,i=new Ao,n=new Uo,s=new Lt(1,1,1);function o(){n.setFromEuler(i,!1)}function l(){i.setFromQuaternion(n,void 0,!1)}i._onChange(o),n._onChange(l),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new Qr},normalMatrix:{value:new Nh}}),this.matrix=new Qr,this.matrixWorld=new Qr,this.matrixAutoUpdate=Zw.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Zw.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new sX,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,i){this.quaternion.setFromAxisAngle(e,i)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,i){return Jf.setFromAxisAngle(e,i),this.quaternion.multiply(Jf),this}rotateOnWorldAxis(e,i){return Jf.setFromAxisAngle(e,i),this.quaternion.premultiply(Jf),this}rotateX(e){return this.rotateOnAxis(fO,e)}rotateY(e){return this.rotateOnAxis(mO,e)}rotateZ(e){return this.rotateOnAxis(gO,e)}translateOnAxis(e,i){return pO.copy(e).applyQuaternion(this.quaternion),this.position.add(pO.multiplyScalar(i)),this}translateX(e){return this.translateOnAxis(fO,e)}translateY(e){return this.translateOnAxis(mO,e)}translateZ(e){return this.translateOnAxis(gO,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(fu.copy(this.matrixWorld).invert())}lookAt(e,i,n){e.isVector3?Cx.copy(e):Cx.set(e,i,n);const s=this.parent;this.updateWorldMatrix(!0,!1),$0.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?fu.lookAt($0,Cx,this.up):fu.lookAt(Cx,$0,this.up),this.quaternion.setFromRotationMatrix(fu),s&&(fu.extractRotation(s.matrixWorld),Jf.setFromRotationMatrix(fu),this.quaternion.premultiply(Jf.invert()))}add(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(AO),Zf.child=e,this.dispatchEvent(Zf),Zf.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const i=this.children.indexOf(e);return i!==-1&&(e.parent=null,this.children.splice(i,1),e.dispatchEvent(cX),J2.child=e,this.dispatchEvent(J2),J2.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),fu.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),fu.multiply(e.parent.matrixWorld)),e.applyMatrix4(fu),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(AO),Zf.child=e,this.dispatchEvent(Zf),Zf.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,i){if(this[e]===i)return this;for(let n=0,s=this.children.length;n<s;n++){const o=this.children[n].getObjectByProperty(e,i);if(o!==void 0)return o}}getObjectsByProperty(e,i,n=[]){this[e]===i&&n.push(this);const s=this.children;for(let o=0,l=s.length;o<l;o++)s[o].getObjectsByProperty(e,i,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose($0,e,oX),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose($0,lX,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return e.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(e){e(this);const i=this.children;for(let n=0,s=i.length;n<s;n++)i[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const i=this.children;for(let n=0,s=i.length;n<s;n++)i[n].traverseVisible(e)}traverseAncestors(e){const i=this.parent;i!==null&&(e(i),i.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const i=this.children;for(let n=0,s=i.length;n<s;n++){const o=i[n];(o.matrixWorldAutoUpdate===!0||e===!0)&&o.updateMatrixWorld(e)}}updateWorldMatrix(e,i){const n=this.parent;if(e===!0&&n!==null&&n.matrixWorldAutoUpdate===!0&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),i===!0){const s=this.children;for(let o=0,l=s.length;o<l;o++){const u=s[o];u.matrixWorldAutoUpdate===!0&&u.updateWorldMatrix(!1,!0)}}}toJSON(e){const i=e===void 0||typeof e=="string",n={};i&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const s={};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.castShadow===!0&&(s.castShadow=!0),this.receiveShadow===!0&&(s.receiveShadow=!0),this.visible===!1&&(s.visible=!1),this.frustumCulled===!1&&(s.frustumCulled=!1),this.renderOrder!==0&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(s.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(s.type="BatchedMesh",s.perObjectFrustumCulled=this.perObjectFrustumCulled,s.sortObjects=this.sortObjects,s.drawRanges=this._drawRanges,s.reservedRanges=this._reservedRanges,s.visibility=this._visibility,s.active=this._active,s.bounds=this._bounds.map(u=>({boxInitialized:u.boxInitialized,boxMin:u.box.min.toArray(),boxMax:u.box.max.toArray(),sphereInitialized:u.sphereInitialized,sphereRadius:u.sphere.radius,sphereCenter:u.sphere.center.toArray()})),s.maxGeometryCount=this._maxGeometryCount,s.maxVertexCount=this._maxVertexCount,s.maxIndexCount=this._maxIndexCount,s.geometryInitialized=this._geometryInitialized,s.geometryCount=this._geometryCount,s.matricesTexture=this._matricesTexture.toJSON(e),this.boundingSphere!==null&&(s.boundingSphere={center:s.boundingSphere.center.toArray(),radius:s.boundingSphere.radius}),this.boundingBox!==null&&(s.boundingBox={min:s.boundingBox.min.toArray(),max:s.boundingBox.max.toArray()}));function o(u,c){return u[c.uuid]===void 0&&(u[c.uuid]=c.toJSON(e)),c.uuid}if(this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(s.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(e.geometries,this.geometry);const u=this.geometry.parameters;if(u!==void 0&&u.shapes!==void 0){const c=u.shapes;if(Array.isArray(c))for(let h=0,p=c.length;h<p;h++){const f=c[h];o(e.shapes,f)}else o(e.shapes,c)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(o(e.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const u=[];for(let c=0,h=this.material.length;c<h;c++)u.push(o(e.materials,this.material[c]));s.material=u}else s.material=o(e.materials,this.material);if(this.children.length>0){s.children=[];for(let u=0;u<this.children.length;u++)s.children.push(this.children[u].toJSON(e).object)}if(this.animations.length>0){s.animations=[];for(let u=0;u<this.animations.length;u++){const c=this.animations[u];s.animations.push(o(e.animations,c))}}if(i){const u=l(e.geometries),c=l(e.materials),h=l(e.textures),p=l(e.images),f=l(e.shapes),m=l(e.skeletons),g=l(e.animations),y=l(e.nodes);u.length>0&&(n.geometries=u),c.length>0&&(n.materials=c),h.length>0&&(n.textures=h),p.length>0&&(n.images=p),f.length>0&&(n.shapes=f),m.length>0&&(n.skeletons=m),g.length>0&&(n.animations=g),y.length>0&&(n.nodes=y)}return n.object=s,n;function l(u){const c=[];for(const h in u){const p=u[h];delete p.metadata,c.push(p)}return c}}clone(e){return new this.constructor().copy(this,e)}copy(e,i=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),i===!0)for(let n=0;n<e.children.length;n++){const s=e.children[n];this.add(s.clone())}return this}};Fa.DEFAULT_UP=new Lt(0,1,0),Fa.DEFAULT_MATRIX_AUTO_UPDATE=!0,Fa.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Zl=new Lt,mu=new Lt,Z2=new Lt,gu=new Lt,$f=new Lt,em=new Lt,yO=new Lt,$2=new Lt,eC=new Lt,tC=new Lt;let Sx=class L0{constructor(e=new Lt,i=new Lt,n=new Lt){this.a=e,this.b=i,this.c=n}static getNormal(e,i,n,s){s.subVectors(n,i),Zl.subVectors(e,i),s.cross(Zl);const o=s.lengthSq();return o>0?s.multiplyScalar(1/Math.sqrt(o)):s.set(0,0,0)}static getBarycoord(e,i,n,s,o){Zl.subVectors(s,i),mu.subVectors(n,i),Z2.subVectors(e,i);const l=Zl.dot(Zl),u=Zl.dot(mu),c=Zl.dot(Z2),h=mu.dot(mu),p=mu.dot(Z2),f=l*h-u*u;if(f===0)return o.set(0,0,0),null;const m=1/f,g=(h*c-u*p)*m,y=(l*p-u*c)*m;return o.set(1-g-y,y,g)}static containsPoint(e,i,n,s){return this.getBarycoord(e,i,n,s,gu)===null?!1:gu.x>=0&&gu.y>=0&&gu.x+gu.y<=1}static getInterpolation(e,i,n,s,o,l,u,c){return this.getBarycoord(e,i,n,s,gu)===null?(c.x=0,c.y=0,"z"in c&&(c.z=0),"w"in c&&(c.w=0),null):(c.setScalar(0),c.addScaledVector(o,gu.x),c.addScaledVector(l,gu.y),c.addScaledVector(u,gu.z),c)}static isFrontFacing(e,i,n,s){return Zl.subVectors(n,i),mu.subVectors(e,i),Zl.cross(mu).dot(s)<0}set(e,i,n){return this.a.copy(e),this.b.copy(i),this.c.copy(n),this}setFromPointsAndIndices(e,i,n,s){return this.a.copy(e[i]),this.b.copy(e[n]),this.c.copy(e[s]),this}setFromAttributeAndIndices(e,i,n,s){return this.a.fromBufferAttribute(e,i),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,s),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Zl.subVectors(this.c,this.b),mu.subVectors(this.a,this.b),Zl.cross(mu).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return L0.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,i){return L0.getBarycoord(e,this.a,this.b,this.c,i)}getInterpolation(e,i,n,s,o){return L0.getInterpolation(e,this.a,this.b,this.c,i,n,s,o)}containsPoint(e){return L0.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return L0.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,i){const n=this.a,s=this.b,o=this.c;let l,u;$f.subVectors(s,n),em.subVectors(o,n),$2.subVectors(e,n);const c=$f.dot($2),h=em.dot($2);if(c<=0&&h<=0)return i.copy(n);eC.subVectors(e,s);const p=$f.dot(eC),f=em.dot(eC);if(p>=0&&f<=p)return i.copy(s);const m=c*f-p*h;if(m<=0&&c>=0&&p<=0)return l=c/(c-p),i.copy(n).addScaledVector($f,l);tC.subVectors(e,o);const g=$f.dot(tC),y=em.dot(tC);if(y>=0&&g<=y)return i.copy(o);const x=g*h-c*y;if(x<=0&&h>=0&&y<=0)return u=h/(h-y),i.copy(n).addScaledVector(em,u);const v=p*y-g*f;if(v<=0&&f-p>=0&&g-y>=0)return yO.subVectors(o,s),u=(f-p)/(f-p+(g-y)),i.copy(s).addScaledVector(yO,u);const _=1/(v+x+m);return l=x*_,u=m*_,i.copy(n).addScaledVector($f,l).addScaledVector(em,u)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}};const vO={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},kh={h:0,s:0,l:0},Tx={h:0,s:0,l:0};function iC(r,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?r+(e-r)*6*i:i<1/2?e:i<2/3?r+(e-r)*6*(2/3-i):r}let Ys=class{constructor(r,e,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(r,e,i)}set(r,e,i){if(e===void 0&&i===void 0){const n=r;n&&n.isColor?this.copy(n):typeof n=="number"?this.setHex(n):typeof n=="string"&&this.setStyle(n)}else this.setRGB(r,e,i);return this}setScalar(r){return this.r=r,this.g=r,this.b=r,this}setHex(r,e=Rl){return r=Math.floor(r),this.r=(r>>16&255)/255,this.g=(r>>8&255)/255,this.b=(r&255)/255,Yl.toWorkingColorSpace(this,e),this}setRGB(r,e,i,n=Yl.workingColorSpace){return this.r=r,this.g=e,this.b=i,Yl.toWorkingColorSpace(this,n),this}setHSL(r,e,i,n=Yl.workingColorSpace){if(r=U2(r,1),e=ka(e,0,1),i=ka(i,0,1),e===0)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+e):i+e-i*e,o=2*i-s;this.r=iC(o,s,r+1/3),this.g=iC(o,s,r),this.b=iC(o,s,r-1/3)}return Yl.toWorkingColorSpace(this,n),this}setStyle(r,e=Rl){function i(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+r+" will be ignored.")}let n;if(n=/^(\w+)\(([^\)]*)\)/.exec(r)){let s;const o=n[1],l=n[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,e);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,e);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,e);break;default:console.warn("THREE.Color: Unknown color model "+r)}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(r)){const s=n[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,e);if(o===6)return this.setHex(parseInt(s,16),e);console.warn("THREE.Color: Invalid hex color "+r)}else if(r&&r.length>0)return this.setColorName(r,e);return this}setColorName(r,e=Rl){const i=vO[r.toLowerCase()];return i!==void 0?this.setHex(i,e):console.warn("THREE.Color: Unknown color "+r),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(r){return this.r=r.r,this.g=r.g,this.b=r.b,this}copySRGBToLinear(r){return this.r=Gf(r.r),this.g=Gf(r.g),this.b=Gf(r.b),this}copyLinearToSRGB(r){return this.r=V2(r.r),this.g=V2(r.g),this.b=V2(r.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(r=Rl){return Yl.fromWorkingColorSpace($a.copy(this),r),Math.round(ka($a.r*255,0,255))*65536+Math.round(ka($a.g*255,0,255))*256+Math.round(ka($a.b*255,0,255))}getHexString(r=Rl){return("000000"+this.getHex(r).toString(16)).slice(-6)}getHSL(r,e=Yl.workingColorSpace){Yl.fromWorkingColorSpace($a.copy(this),e);const i=$a.r,n=$a.g,s=$a.b,o=Math.max(i,n,s),l=Math.min(i,n,s);let u,c;const h=(l+o)/2;if(l===o)u=0,c=0;else{const p=o-l;switch(c=h<=.5?p/(o+l):p/(2-o-l),o){case i:u=(n-s)/p+(n<s?6:0);break;case n:u=(s-i)/p+2;break;case s:u=(i-n)/p+4;break}u/=6}return r.h=u,r.s=c,r.l=h,r}getRGB(r,e=Yl.workingColorSpace){return Yl.fromWorkingColorSpace($a.copy(this),e),r.r=$a.r,r.g=$a.g,r.b=$a.b,r}getStyle(r=Rl){Yl.fromWorkingColorSpace($a.copy(this),r);const e=$a.r,i=$a.g,n=$a.b;return r!==Rl?`color(${r} ${e.toFixed(3)} ${i.toFixed(3)} ${n.toFixed(3)})`:`rgb(${Math.round(e*255)},${Math.round(i*255)},${Math.round(n*255)})`}offsetHSL(r,e,i){return this.getHSL(kh),this.setHSL(kh.h+r,kh.s+e,kh.l+i)}add(r){return this.r+=r.r,this.g+=r.g,this.b+=r.b,this}addColors(r,e){return this.r=r.r+e.r,this.g=r.g+e.g,this.b=r.b+e.b,this}addScalar(r){return this.r+=r,this.g+=r,this.b+=r,this}sub(r){return this.r=Math.max(0,this.r-r.r),this.g=Math.max(0,this.g-r.g),this.b=Math.max(0,this.b-r.b),this}multiply(r){return this.r*=r.r,this.g*=r.g,this.b*=r.b,this}multiplyScalar(r){return this.r*=r,this.g*=r,this.b*=r,this}lerp(r,e){return this.r+=(r.r-this.r)*e,this.g+=(r.g-this.g)*e,this.b+=(r.b-this.b)*e,this}lerpColors(r,e,i){return this.r=r.r+(e.r-r.r)*i,this.g=r.g+(e.g-r.g)*i,this.b=r.b+(e.b-r.b)*i,this}lerpHSL(r,e){this.getHSL(kh),r.getHSL(Tx);const i=K0(kh.h,Tx.h,e),n=K0(kh.s,Tx.s,e),s=K0(kh.l,Tx.l,e);return this.setHSL(i,n,s),this}setFromVector3(r){return this.r=r.x,this.g=r.y,this.b=r.z,this}applyMatrix3(r){const e=this.r,i=this.g,n=this.b,s=r.elements;return this.r=s[0]*e+s[3]*i+s[6]*n,this.g=s[1]*e+s[4]*i+s[7]*n,this.b=s[2]*e+s[5]*i+s[8]*n,this}equals(r){return r.r===this.r&&r.g===this.g&&r.b===this.b}fromArray(r,e=0){return this.r=r[e],this.g=r[e+1],this.b=r[e+2],this}toArray(r=[],e=0){return r[e]=this.r,r[e+1]=this.g,r[e+2]=this.b,r}fromBufferAttribute(r,e){return this.r=r.getX(e),this.g=r.getY(e),this.b=r.getZ(e),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const $a=new Ys;Ys.NAMES=vO;let uX=0,Mx=class extends Ax{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:uX++}),this.uuid=Bh(),this.name="",this.type="Material",this.blending=FD,this.side=N2,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=zD,this.blendDst=jD,this.blendEquation=UD,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Ys(0,0,0),this.blendAlpha=0,this.depthFunc=VD,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=nO,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=jf,this.stencilZFail=jf,this.stencilZPass=jf,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(r){this._alphaTest>0!=r>0&&this.version++,this._alphaTest=r}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(r){if(r!==void 0)for(const e in r){const i=r[e];if(i===void 0){console.warn(`THREE.Material: parameter '${e}' has value of undefined.`);continue}const n=this[e];if(n===void 0){console.warn(`THREE.Material: '${e}' is not a property of THREE.${this.type}.`);continue}n&&n.isColor?n.set(i):n&&n.isVector3&&i&&i.isVector3?n.copy(i):this[e]=i}}toJSON(r){const e=r===void 0||typeof r=="string";e&&(r={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(r).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(r).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(r).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(i.dispersion=this.dispersion),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(r).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(r).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(r).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(r).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(r).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(r).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(r).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(r).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(r).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(r).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(r).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(r).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(r).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(r).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(r).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(r).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(r).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(r).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapRotation!==void 0&&(i.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(r).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(r).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(r).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==FD&&(i.blending=this.blending),this.side!==N2&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==zD&&(i.blendSrc=this.blendSrc),this.blendDst!==jD&&(i.blendDst=this.blendDst),this.blendEquation!==UD&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==VD&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==nO&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==jf&&(i.stencilFail=this.stencilFail),this.stencilZFail!==jf&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==jf&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function n(s){const o=[];for(const l in s){const u=s[l];delete u.metadata,o.push(u)}return o}if(e){const s=n(r.textures),o=n(r.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return new this.constructor().copy(this)}copy(r){this.name=r.name,this.blending=r.blending,this.side=r.side,this.vertexColors=r.vertexColors,this.opacity=r.opacity,this.transparent=r.transparent,this.blendSrc=r.blendSrc,this.blendDst=r.blendDst,this.blendEquation=r.blendEquation,this.blendSrcAlpha=r.blendSrcAlpha,this.blendDstAlpha=r.blendDstAlpha,this.blendEquationAlpha=r.blendEquationAlpha,this.blendColor.copy(r.blendColor),this.blendAlpha=r.blendAlpha,this.depthFunc=r.depthFunc,this.depthTest=r.depthTest,this.depthWrite=r.depthWrite,this.stencilWriteMask=r.stencilWriteMask,this.stencilFunc=r.stencilFunc,this.stencilRef=r.stencilRef,this.stencilFuncMask=r.stencilFuncMask,this.stencilFail=r.stencilFail,this.stencilZFail=r.stencilZFail,this.stencilZPass=r.stencilZPass,this.stencilWrite=r.stencilWrite;const e=r.clippingPlanes;let i=null;if(e!==null){const n=e.length;i=new Array(n);for(let s=0;s!==n;++s)i[s]=e[s].clone()}return this.clippingPlanes=i,this.clipIntersection=r.clipIntersection,this.clipShadows=r.clipShadows,this.shadowSide=r.shadowSide,this.colorWrite=r.colorWrite,this.precision=r.precision,this.polygonOffset=r.polygonOffset,this.polygonOffsetFactor=r.polygonOffsetFactor,this.polygonOffsetUnits=r.polygonOffsetUnits,this.dithering=r.dithering,this.alphaTest=r.alphaTest,this.alphaHash=r.alphaHash,this.alphaToCoverage=r.alphaToCoverage,this.premultipliedAlpha=r.premultipliedAlpha,this.forceSinglePass=r.forceSinglePass,this.visible=r.visible,this.toneMapped=r.toneMapped,this.userData=JSON.parse(JSON.stringify(r.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(r){r===!0&&this.version++}},hX=class extends Mx{constructor(r){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Ys(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Ao,this.combine=L2,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(r)}copy(r){return super.copy(r),this.color.copy(r.color),this.map=r.map,this.lightMap=r.lightMap,this.lightMapIntensity=r.lightMapIntensity,this.aoMap=r.aoMap,this.aoMapIntensity=r.aoMapIntensity,this.specularMap=r.specularMap,this.alphaMap=r.alphaMap,this.envMap=r.envMap,this.envMapRotation.copy(r.envMapRotation),this.combine=r.combine,this.reflectivity=r.reflectivity,this.refractionRatio=r.refractionRatio,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.wireframeLinecap=r.wireframeLinecap,this.wireframeLinejoin=r.wireframeLinejoin,this.fog=r.fog,this}};const Ks=new Lt,Rx=new Hs;let tm=class{constructor(r,e,i=!1){if(Array.isArray(r))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=r,this.itemSize=e,this.count=r!==void 0?r.length/e:0,this.normalized=i,this.usage=sO,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=QD,this.version=0}onUploadCallback(){}set needsUpdate(r){r===!0&&this.version++}get updateRange(){return Kq("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(r){return this.usage=r,this}addUpdateRange(r,e){this.updateRanges.push({start:r,count:e})}clearUpdateRanges(){this.updateRanges.length=0}copy(r){return this.name=r.name,this.array=new r.array.constructor(r.array),this.itemSize=r.itemSize,this.count=r.count,this.normalized=r.normalized,this.usage=r.usage,this.gpuType=r.gpuType,this}copyAt(r,e,i){r*=this.itemSize,i*=e.itemSize;for(let n=0,s=this.itemSize;n<s;n++)this.array[r+n]=e.array[i+n];return this}copyArray(r){return this.array.set(r),this}applyMatrix3(r){if(this.itemSize===2)for(let e=0,i=this.count;e<i;e++)Rx.fromBufferAttribute(this,e),Rx.applyMatrix3(r),this.setXY(e,Rx.x,Rx.y);else if(this.itemSize===3)for(let e=0,i=this.count;e<i;e++)Ks.fromBufferAttribute(this,e),Ks.applyMatrix3(r),this.setXYZ(e,Ks.x,Ks.y,Ks.z);return this}applyMatrix4(r){for(let e=0,i=this.count;e<i;e++)Ks.fromBufferAttribute(this,e),Ks.applyMatrix4(r),this.setXYZ(e,Ks.x,Ks.y,Ks.z);return this}applyNormalMatrix(r){for(let e=0,i=this.count;e<i;e++)Ks.fromBufferAttribute(this,e),Ks.applyNormalMatrix(r),this.setXYZ(e,Ks.x,Ks.y,Ks.z);return this}transformDirection(r){for(let e=0,i=this.count;e<i;e++)Ks.fromBufferAttribute(this,e),Ks.transformDirection(r),this.setXYZ(e,Ks.x,Ks.y,Ks.z);return this}set(r,e=0){return this.array.set(r,e),this}getComponent(r,e){let i=this.array[r*this.itemSize+e];return this.normalized&&(i=Vf(i,this.array)),i}setComponent(r,e,i){return this.normalized&&(i=mo(i,this.array)),this.array[r*this.itemSize+e]=i,this}getX(r){let e=this.array[r*this.itemSize];return this.normalized&&(e=Vf(e,this.array)),e}setX(r,e){return this.normalized&&(e=mo(e,this.array)),this.array[r*this.itemSize]=e,this}getY(r){let e=this.array[r*this.itemSize+1];return this.normalized&&(e=Vf(e,this.array)),e}setY(r,e){return this.normalized&&(e=mo(e,this.array)),this.array[r*this.itemSize+1]=e,this}getZ(r){let e=this.array[r*this.itemSize+2];return this.normalized&&(e=Vf(e,this.array)),e}setZ(r,e){return this.normalized&&(e=mo(e,this.array)),this.array[r*this.itemSize+2]=e,this}getW(r){let e=this.array[r*this.itemSize+3];return this.normalized&&(e=Vf(e,this.array)),e}setW(r,e){return this.normalized&&(e=mo(e,this.array)),this.array[r*this.itemSize+3]=e,this}setXY(r,e,i){return r*=this.itemSize,this.normalized&&(e=mo(e,this.array),i=mo(i,this.array)),this.array[r+0]=e,this.array[r+1]=i,this}setXYZ(r,e,i,n){return r*=this.itemSize,this.normalized&&(e=mo(e,this.array),i=mo(i,this.array),n=mo(n,this.array)),this.array[r+0]=e,this.array[r+1]=i,this.array[r+2]=n,this}setXYZW(r,e,i,n,s){return r*=this.itemSize,this.normalized&&(e=mo(e,this.array),i=mo(i,this.array),n=mo(n,this.array),s=mo(s,this.array)),this.array[r+0]=e,this.array[r+1]=i,this.array[r+2]=n,this.array[r+3]=s,this}onUpload(r){return this.onUploadCallback=r,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const r={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(r.name=this.name),this.usage!==sO&&(r.usage=this.usage),r}},xO=class extends tm{constructor(r,e,i){super(new Uint16Array(r),e,i)}},dX=class extends tm{constructor(r,e,i){super(new Uint32Array(r),e,i)}},Fh=class extends tm{constructor(r,e,i){super(new Float32Array(r),e,i)}},pX=0;const Il=new Qr,rC=new Fa,im=new Lt,ll=new Wf,eA=new Wf,Sa=new Lt;let tA=class oH extends Ax{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:pX++}),this.uuid=Bh(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(Yq(e)?dX:xO)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,i){return this.attributes[e]=i,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,i,n=0){this.groups.push({start:e,count:i,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,i){this.drawRange.start=e,this.drawRange.count=i}applyMatrix4(e){const i=this.attributes.position;i!==void 0&&(i.applyMatrix4(e),i.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const o=new Nh().getNormalMatrix(e);n.applyNormalMatrix(o),n.needsUpdate=!0}const s=this.attributes.tangent;return s!==void 0&&(s.transformDirection(e),s.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Il.makeRotationFromQuaternion(e),this.applyMatrix4(Il),this}rotateX(e){return Il.makeRotationX(e),this.applyMatrix4(Il),this}rotateY(e){return Il.makeRotationY(e),this.applyMatrix4(Il),this}rotateZ(e){return Il.makeRotationZ(e),this.applyMatrix4(Il),this}translate(e,i,n){return Il.makeTranslation(e,i,n),this.applyMatrix4(Il),this}scale(e,i,n){return Il.makeScale(e,i,n),this.applyMatrix4(Il),this}lookAt(e){return rC.lookAt(e),rC.updateMatrix(),this.applyMatrix4(rC.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(im).negate(),this.translate(im.x,im.y,im.z),this}setFromPoints(e){const i=[];for(let n=0,s=e.length;n<s;n++){const o=e[n];i.push(o.x,o.y,o.z||0)}return this.setAttribute("position",new Fh(i,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Wf);const e=this.attributes.position,i=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new Lt(-1/0,-1/0,-1/0),new Lt(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),i)for(let n=0,s=i.length;n<s;n++){const o=i[n];ll.setFromBufferAttribute(o),this.morphTargetsRelative?(Sa.addVectors(this.boundingBox.min,ll.min),this.boundingBox.expandByPoint(Sa),Sa.addVectors(this.boundingBox.max,ll.max),this.boundingBox.expandByPoint(Sa)):(this.boundingBox.expandByPoint(ll.min),this.boundingBox.expandByPoint(ll.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Yf);const e=this.attributes.position,i=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new Lt,1/0);return}if(e){const n=this.boundingSphere.center;if(ll.setFromBufferAttribute(e),i)for(let o=0,l=i.length;o<l;o++){const u=i[o];eA.setFromBufferAttribute(u),this.morphTargetsRelative?(Sa.addVectors(ll.min,eA.min),ll.expandByPoint(Sa),Sa.addVectors(ll.max,eA.max),ll.expandByPoint(Sa)):(ll.expandByPoint(eA.min),ll.expandByPoint(eA.max))}ll.getCenter(n);let s=0;for(let o=0,l=e.count;o<l;o++)Sa.fromBufferAttribute(e,o),s=Math.max(s,n.distanceToSquared(Sa));if(i)for(let o=0,l=i.length;o<l;o++){const u=i[o],c=this.morphTargetsRelative;for(let h=0,p=u.count;h<p;h++)Sa.fromBufferAttribute(u,h),c&&(im.fromBufferAttribute(e,h),Sa.add(im)),s=Math.max(s,n.distanceToSquared(Sa))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,i=this.attributes;if(e===null||i.position===void 0||i.normal===void 0||i.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=i.position,s=i.normal,o=i.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new tm(new Float32Array(4*n.count),4));const l=this.getAttribute("tangent"),u=[],c=[];for(let D=0;D<n.count;D++)u[D]=new Lt,c[D]=new Lt;const h=new Lt,p=new Lt,f=new Lt,m=new Hs,g=new Hs,y=new Hs,x=new Lt,v=new Lt;function _(D,L,O){h.fromBufferAttribute(n,D),p.fromBufferAttribute(n,L),f.fromBufferAttribute(n,O),m.fromBufferAttribute(o,D),g.fromBufferAttribute(o,L),y.fromBufferAttribute(o,O),p.sub(h),f.sub(h),g.sub(m),y.sub(m);const U=1/(g.x*y.y-y.x*g.y);isFinite(U)&&(x.copy(p).multiplyScalar(y.y).addScaledVector(f,-g.y).multiplyScalar(U),v.copy(f).multiplyScalar(g.x).addScaledVector(p,-y.x).multiplyScalar(U),u[D].add(x),u[L].add(x),u[O].add(x),c[D].add(v),c[L].add(v),c[O].add(v))}let T=this.groups;T.length===0&&(T=[{start:0,count:e.count}]);for(let D=0,L=T.length;D<L;++D){const O=T[D],U=O.start,Z=O.count;for(let G=U,z=U+Z;G<z;G+=3)_(e.getX(G+0),e.getX(G+1),e.getX(G+2))}const w=new Lt,S=new Lt,R=new Lt,B=new Lt;function I(D){R.fromBufferAttribute(s,D),B.copy(R);const L=u[D];w.copy(L),w.sub(R.multiplyScalar(R.dot(L))).normalize(),S.crossVectors(B,L);const O=S.dot(c[D])<0?-1:1;l.setXYZW(D,w.x,w.y,w.z,O)}for(let D=0,L=T.length;D<L;++D){const O=T[D],U=O.start,Z=O.count;for(let G=U,z=U+Z;G<z;G+=3)I(e.getX(G+0)),I(e.getX(G+1)),I(e.getX(G+2))}}computeVertexNormals(){const e=this.index,i=this.getAttribute("position");if(i!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new tm(new Float32Array(i.count*3),3),this.setAttribute("normal",n);else for(let m=0,g=n.count;m<g;m++)n.setXYZ(m,0,0,0);const s=new Lt,o=new Lt,l=new Lt,u=new Lt,c=new Lt,h=new Lt,p=new Lt,f=new Lt;if(e)for(let m=0,g=e.count;m<g;m+=3){const y=e.getX(m+0),x=e.getX(m+1),v=e.getX(m+2);s.fromBufferAttribute(i,y),o.fromBufferAttribute(i,x),l.fromBufferAttribute(i,v),p.subVectors(l,o),f.subVectors(s,o),p.cross(f),u.fromBufferAttribute(n,y),c.fromBufferAttribute(n,x),h.fromBufferAttribute(n,v),u.add(p),c.add(p),h.add(p),n.setXYZ(y,u.x,u.y,u.z),n.setXYZ(x,c.x,c.y,c.z),n.setXYZ(v,h.x,h.y,h.z)}else for(let m=0,g=i.count;m<g;m+=3)s.fromBufferAttribute(i,m+0),o.fromBufferAttribute(i,m+1),l.fromBufferAttribute(i,m+2),p.subVectors(l,o),f.subVectors(s,o),p.cross(f),n.setXYZ(m+0,p.x,p.y,p.z),n.setXYZ(m+1,p.x,p.y,p.z),n.setXYZ(m+2,p.x,p.y,p.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let i=0,n=e.count;i<n;i++)Sa.fromBufferAttribute(e,i),Sa.normalize(),e.setXYZ(i,Sa.x,Sa.y,Sa.z)}toNonIndexed(){function e(u,c){const h=u.array,p=u.itemSize,f=u.normalized,m=new h.constructor(c.length*p);let g=0,y=0;for(let x=0,v=c.length;x<v;x++){u.isInterleavedBufferAttribute?g=c[x]*u.data.stride+u.offset:g=c[x]*p;for(let _=0;_<p;_++)m[y++]=h[g++]}return new tm(m,p,f)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const i=new oH,n=this.index.array,s=this.attributes;for(const u in s){const c=s[u],h=e(c,n);i.setAttribute(u,h)}const o=this.morphAttributes;for(const u in o){const c=[],h=o[u];for(let p=0,f=h.length;p<f;p++){const m=h[p],g=e(m,n);c.push(g)}i.morphAttributes[u]=c}i.morphTargetsRelative=this.morphTargetsRelative;const l=this.groups;for(let u=0,c=l.length;u<c;u++){const h=l[u];i.addGroup(h.start,h.count,h.materialIndex)}return i}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const c=this.parameters;for(const h in c)c[h]!==void 0&&(e[h]=c[h]);return e}e.data={attributes:{}};const i=this.index;i!==null&&(e.data.index={type:i.array.constructor.name,array:Array.prototype.slice.call(i.array)});const n=this.attributes;for(const c in n){const h=n[c];e.data.attributes[c]=h.toJSON(e.data)}const s={};let o=!1;for(const c in this.morphAttributes){const h=this.morphAttributes[c],p=[];for(let f=0,m=h.length;f<m;f++){const g=h[f];p.push(g.toJSON(e.data))}p.length>0&&(s[c]=p,o=!0)}o&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);const l=this.groups;l.length>0&&(e.data.groups=JSON.parse(JSON.stringify(l)));const u=this.boundingSphere;return u!==null&&(e.data.boundingSphere={center:u.center.toArray(),radius:u.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const i={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone(i));const s=e.attributes;for(const h in s){const p=s[h];this.setAttribute(h,p.clone(i))}const o=e.morphAttributes;for(const h in o){const p=[],f=o[h];for(let m=0,g=f.length;m<g;m++)p.push(f[m].clone(i));this.morphAttributes[h]=p}this.morphTargetsRelative=e.morphTargetsRelative;const l=e.groups;for(let h=0,p=l.length;h<p;h++){const f=l[h];this.addGroup(f.start,f.count,f.materialIndex)}const u=e.boundingBox;u!==null&&(this.boundingBox=u.clone());const c=e.boundingSphere;return c!==null&&(this.boundingSphere=c.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}};const bO=new Qr,tp=new K2,Ix=new Yf,_O=new Lt,rm=new Lt,nm=new Lt,sm=new Lt,nC=new Lt,Bx=new Lt,Nx=new Hs,Lx=new Hs,Dx=new Hs,EO=new Lt,wO=new Lt,CO=new Lt,Ox=new Lt,Px=new Lt;let SO=class extends Fa{constructor(r=new tA,e=new hX){super(),this.isMesh=!0,this.type="Mesh",this.geometry=r,this.material=e,this.updateMorphTargets()}copy(r,e){return super.copy(r,e),r.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=r.morphTargetInfluences.slice()),r.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},r.morphTargetDictionary)),this.material=Array.isArray(r.material)?r.material.slice():r.material,this.geometry=r.geometry,this}updateMorphTargets(){const r=this.geometry.morphAttributes,e=Object.keys(r);if(e.length>0){const i=r[e[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let n=0,s=i.length;n<s;n++){const o=i[n].name||String(n);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=n}}}}getVertexPosition(r,e){const i=this.geometry,n=i.attributes.position,s=i.morphAttributes.position,o=i.morphTargetsRelative;e.fromBufferAttribute(n,r);const l=this.morphTargetInfluences;if(s&&l){Bx.set(0,0,0);for(let u=0,c=s.length;u<c;u++){const h=l[u],p=s[u];h!==0&&(nC.fromBufferAttribute(p,r),o?Bx.addScaledVector(nC,h):Bx.addScaledVector(nC.sub(e),h))}e.add(Bx)}return e}raycast(r,e){const i=this.geometry,n=this.material,s=this.matrixWorld;n!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),Ix.copy(i.boundingSphere),Ix.applyMatrix4(s),tp.copy(r.ray).recast(r.near),!(Ix.containsPoint(tp.origin)===!1&&(tp.intersectSphere(Ix,_O)===null||tp.origin.distanceToSquared(_O)>(r.far-r.near)**2))&&(bO.copy(s).invert(),tp.copy(r.ray).applyMatrix4(bO),!(i.boundingBox!==null&&tp.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(r,e,tp)))}_computeIntersections(r,e,i){let n;const s=this.geometry,o=this.material,l=s.index,u=s.attributes.position,c=s.attributes.uv,h=s.attributes.uv1,p=s.attributes.normal,f=s.groups,m=s.drawRange;if(l!==null)if(Array.isArray(o))for(let g=0,y=f.length;g<y;g++){const x=f[g],v=o[x.materialIndex],_=Math.max(x.start,m.start),T=Math.min(l.count,Math.min(x.start+x.count,m.start+m.count));for(let w=_,S=T;w<S;w+=3){const R=l.getX(w),B=l.getX(w+1),I=l.getX(w+2);n=kx(this,v,r,i,c,h,p,R,B,I),n&&(n.faceIndex=Math.floor(w/3),n.face.materialIndex=x.materialIndex,e.push(n))}}else{const g=Math.max(0,m.start),y=Math.min(l.count,m.start+m.count);for(let x=g,v=y;x<v;x+=3){const _=l.getX(x),T=l.getX(x+1),w=l.getX(x+2);n=kx(this,o,r,i,c,h,p,_,T,w),n&&(n.faceIndex=Math.floor(x/3),e.push(n))}}else if(u!==void 0)if(Array.isArray(o))for(let g=0,y=f.length;g<y;g++){const x=f[g],v=o[x.materialIndex],_=Math.max(x.start,m.start),T=Math.min(u.count,Math.min(x.start+x.count,m.start+m.count));for(let w=_,S=T;w<S;w+=3){const R=w,B=w+1,I=w+2;n=kx(this,v,r,i,c,h,p,R,B,I),n&&(n.faceIndex=Math.floor(w/3),n.face.materialIndex=x.materialIndex,e.push(n))}}else{const g=Math.max(0,m.start),y=Math.min(u.count,m.start+m.count);for(let x=g,v=y;x<v;x+=3){const _=x,T=x+1,w=x+2;n=kx(this,o,r,i,c,h,p,_,T,w),n&&(n.faceIndex=Math.floor(x/3),e.push(n))}}}};function fX(r,e,i,n,s,o,l,u){let c;if(e.side===_q?c=n.intersectTriangle(l,o,s,!0,u):c=n.intersectTriangle(s,o,l,e.side===N2,u),c===null)return null;Px.copy(u),Px.applyMatrix4(r.matrixWorld);const h=i.ray.origin.distanceTo(Px);return h<i.near||h>i.far?null:{distance:h,point:Px.clone(),object:r}}function kx(r,e,i,n,s,o,l,u,c,h){r.getVertexPosition(u,rm),r.getVertexPosition(c,nm),r.getVertexPosition(h,sm);const p=fX(r,e,i,n,rm,nm,sm,Ox);if(p){s&&(Nx.fromBufferAttribute(s,u),Lx.fromBufferAttribute(s,c),Dx.fromBufferAttribute(s,h),p.uv=Sx.getInterpolation(Ox,rm,nm,sm,Nx,Lx,Dx,new Hs)),o&&(Nx.fromBufferAttribute(o,u),Lx.fromBufferAttribute(o,c),Dx.fromBufferAttribute(o,h),p.uv1=Sx.getInterpolation(Ox,rm,nm,sm,Nx,Lx,Dx,new Hs)),l&&(EO.fromBufferAttribute(l,u),wO.fromBufferAttribute(l,c),CO.fromBufferAttribute(l,h),p.normal=Sx.getInterpolation(Ox,rm,nm,sm,EO,wO,CO,new Lt),p.normal.dot(n.direction)>0&&p.normal.multiplyScalar(-1));const f={a:u,b:c,c:h,normal:new Lt,materialIndex:0};Sx.getNormal(rm,nm,sm,f.normal),p.face=f}return p}let TO=class extends Fa{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Qr,this.projectionMatrix=new Qr,this.projectionMatrixInverse=new Qr,this.coordinateSystem=Zd}copy(r,e){return super.copy(r,e),this.matrixWorldInverse.copy(r.matrixWorldInverse),this.projectionMatrix.copy(r.projectionMatrix),this.projectionMatrixInverse.copy(r.projectionMatrixInverse),this.coordinateSystem=r.coordinateSystem,this}getWorldDirection(r){return super.getWorldDirection(r).negate()}updateMatrixWorld(r){super.updateMatrixWorld(r),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(r,e){super.updateWorldMatrix(r,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}};const Uh=new Lt,MO=new Hs,RO=new Hs;let sC=class extends TO{constructor(r=50,e=1,i=.1,n=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=r,this.zoom=1,this.near=i,this.far=n,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(r,e){return super.copy(r,e),this.fov=r.fov,this.zoom=r.zoom,this.near=r.near,this.far=r.far,this.focus=r.focus,this.aspect=r.aspect,this.view=r.view===null?null:Object.assign({},r.view),this.filmGauge=r.filmGauge,this.filmOffset=r.filmOffset,this}setFocalLength(r){const e=.5*this.getFilmHeight()/r;this.fov=Y0*2*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){const r=Math.tan(X0*.5*this.fov);return .5*this.getFilmHeight()/r}getEffectiveFOV(){return Y0*2*Math.atan(Math.tan(X0*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(r,e,i){Uh.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),e.set(Uh.x,Uh.y).multiplyScalar(-r/Uh.z),Uh.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(Uh.x,Uh.y).multiplyScalar(-r/Uh.z)}getViewSize(r,e){return this.getViewBounds(r,MO,RO),e.subVectors(RO,MO)}setViewOffset(r,e,i,n,s,o){this.aspect=r/e,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=r,this.view.fullHeight=e,this.view.offsetX=i,this.view.offsetY=n,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const r=this.near;let e=r*Math.tan(X0*.5*this.fov)/this.zoom,i=2*e,n=this.aspect*i,s=-.5*n;const o=this.view;if(this.view!==null&&this.view.enabled){const u=o.fullWidth,c=o.fullHeight;s+=o.offsetX*n/u,e-=o.offsetY*i/c,n*=o.width/u,i*=o.height/c}const l=this.filmOffset;l!==0&&(s+=r*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+n,e,e-i,r,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(r){const e=super.toJSON(r);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,this.view!==null&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}};const aC=new Lt,mX=new Lt,gX=new Nh;let am=class{constructor(r=new Lt(1,0,0),e=0){this.isPlane=!0,this.normal=r,this.constant=e}set(r,e){return this.normal.copy(r),this.constant=e,this}setComponents(r,e,i,n){return this.normal.set(r,e,i),this.constant=n,this}setFromNormalAndCoplanarPoint(r,e){return this.normal.copy(r),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(r,e,i){const n=aC.subVectors(i,e).cross(mX.subVectors(r,e)).normalize();return this.setFromNormalAndCoplanarPoint(n,r),this}copy(r){return this.normal.copy(r.normal),this.constant=r.constant,this}normalize(){const r=1/this.normal.length();return this.normal.multiplyScalar(r),this.constant*=r,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(r){return this.normal.dot(r)+this.constant}distanceToSphere(r){return this.distanceToPoint(r.center)-r.radius}projectPoint(r,e){return e.copy(r).addScaledVector(this.normal,-this.distanceToPoint(r))}intersectLine(r,e){const i=r.delta(aC),n=this.normal.dot(i);if(n===0)return this.distanceToPoint(r.start)===0?e.copy(r.start):null;const s=-(r.start.dot(this.normal)+this.constant)/n;return s<0||s>1?null:e.copy(r.start).addScaledVector(i,s)}intersectsLine(r){const e=this.distanceToPoint(r.start),i=this.distanceToPoint(r.end);return e<0&&i>0||i<0&&e>0}intersectsBox(r){return r.intersectsPlane(this)}intersectsSphere(r){return r.intersectsPlane(this)}coplanarPoint(r){return r.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(r,e){const i=e||gX.getNormalMatrix(r),n=this.coplanarPoint(aC).applyMatrix4(r),s=this.normal.applyMatrix3(i).normalize();return this.constant=-n.dot(s),this}translate(r){return this.constant-=r.dot(this.normal),this}equals(r){return r.normal.equals(this.normal)&&r.constant===this.constant}clone(){return new this.constructor().copy(this)}};const ip=new Yf,Fx=new Lt;let AX=class{constructor(r=new am,e=new am,i=new am,n=new am,s=new am,o=new am){this.planes=[r,e,i,n,s,o]}set(r,e,i,n,s,o){const l=this.planes;return l[0].copy(r),l[1].copy(e),l[2].copy(i),l[3].copy(n),l[4].copy(s),l[5].copy(o),this}copy(r){const e=this.planes;for(let i=0;i<6;i++)e[i].copy(r.planes[i]);return this}setFromProjectionMatrix(r,e=Zd){const i=this.planes,n=r.elements,s=n[0],o=n[1],l=n[2],u=n[3],c=n[4],h=n[5],p=n[6],f=n[7],m=n[8],g=n[9],y=n[10],x=n[11],v=n[12],_=n[13],T=n[14],w=n[15];if(i[0].setComponents(u-s,f-c,x-m,w-v).normalize(),i[1].setComponents(u+s,f+c,x+m,w+v).normalize(),i[2].setComponents(u+o,f+h,x+g,w+_).normalize(),i[3].setComponents(u-o,f-h,x-g,w-_).normalize(),i[4].setComponents(u-l,f-p,x-y,w-T).normalize(),e===Zd)i[5].setComponents(u+l,f+p,x+y,w+T).normalize();else if(e===F2)i[5].setComponents(l,p,y,T).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+e);return this}intersectsObject(r){if(r.boundingSphere!==void 0)r.boundingSphere===null&&r.computeBoundingSphere(),ip.copy(r.boundingSphere).applyMatrix4(r.matrixWorld);else{const e=r.geometry;e.boundingSphere===null&&e.computeBoundingSphere(),ip.copy(e.boundingSphere).applyMatrix4(r.matrixWorld)}return this.intersectsSphere(ip)}intersectsSprite(r){return ip.center.set(0,0,0),ip.radius=.7071067811865476,ip.applyMatrix4(r.matrixWorld),this.intersectsSphere(ip)}intersectsSphere(r){const e=this.planes,i=r.center,n=-r.radius;for(let s=0;s<6;s++)if(e[s].distanceToPoint(i)<n)return!1;return!0}intersectsBox(r){const e=this.planes;for(let i=0;i<6;i++){const n=e[i];if(Fx.x=n.normal.x>0?r.max.x:r.min.x,Fx.y=n.normal.y>0?r.max.y:r.min.y,Fx.z=n.normal.z>0?r.max.z:r.min.z,n.distanceToPoint(Fx)<0)return!1}return!0}containsPoint(r){const e=this.planes;for(let i=0;i<6;i++)if(e[i].distanceToPoint(r)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}},IO=class extends TO{constructor(r=-1,e=1,i=1,n=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=r,this.right=e,this.top=i,this.bottom=n,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(r,e){return super.copy(r,e),this.left=r.left,this.right=r.right,this.top=r.top,this.bottom=r.bottom,this.near=r.near,this.far=r.far,this.zoom=r.zoom,this.view=r.view===null?null:Object.assign({},r.view),this}setViewOffset(r,e,i,n,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=r,this.view.fullHeight=e,this.view.offsetX=i,this.view.offsetY=n,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const r=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,n=(this.top+this.bottom)/2;let s=i-r,o=i+r,l=n+e,u=n-e;if(this.view!==null&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,h=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,l-=h*this.view.offsetY,u=l-h*this.view.height}this.projectionMatrix.makeOrthographic(s,o,l,u,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(r){const e=super.toJSON(r);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,this.view!==null&&(e.object.view=Object.assign({},this.view)),e}},yX=class extends hu{constructor(r,e,i,n,s,o,l,u,c,h){if(h=h!==void 0?h:D2,h!==D2&&h!==XD)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&h===D2&&(i=Mq),i===void 0&&h===XD&&(i=Rq),super(null,n,s,o,l,u,h,i,c),this.isDepthTexture=!0,this.image={width:r,height:e},this.magFilter=l!==void 0?l:fx,this.minFilter=u!==void 0?u:fx,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(r){return super.copy(r),this.compareFunction=r.compareFunction,this}toJSON(r){const e=super.toJSON(r);return this.compareFunction!==null&&(e.compareFunction=this.compareFunction),e}};const vX=new yX(1,1);vX.compareFunction=Nq;let BO=class extends Fa{constructor(){super(),this.isGroup=!0,this.type="Group"}};const NO=new Lt,LO=new Fo,DO=new Fo,xX=new Lt,OO=new Qr,Ux=new Lt,oC=new Yf,PO=new Qr,lC=new K2;class bX extends SO{constructor(e,i){super(e,i),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=GD,this.bindMatrix=new Qr,this.bindMatrixInverse=new Qr,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Wf),this.boundingBox.makeEmpty();const i=e.getAttribute("position");for(let n=0;n<i.count;n++)this.getVertexPosition(n,Ux),this.boundingBox.expandByPoint(Ux)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Yf),this.boundingSphere.makeEmpty();const i=e.getAttribute("position");for(let n=0;n<i.count;n++)this.getVertexPosition(n,Ux),this.boundingSphere.expandByPoint(Ux)}copy(e,i){return super.copy(e,i),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,i){const n=this.material,s=this.matrixWorld;n!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),oC.copy(this.boundingSphere),oC.applyMatrix4(s),e.ray.intersectsSphere(oC)!==!1&&(PO.copy(s).invert(),lC.copy(e.ray).applyMatrix4(PO),!(this.boundingBox!==null&&lC.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,i,lC)))}getVertexPosition(e,i){return super.getVertexPosition(e,i),this.applyBoneTransform(e,i),i}bind(e,i){this.skeleton=e,i===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),i=this.matrixWorld),this.bindMatrix.copy(i),this.bindMatrixInverse.copy(i).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Fo,i=this.geometry.attributes.skinWeight;for(let n=0,s=i.count;n<s;n++){e.fromBufferAttribute(i,n);const o=1/e.manhattanLength();o!==1/0?e.multiplyScalar(o):e.set(1,0,0,0),i.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===GD?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===Eq?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,i){const n=this.skeleton,s=this.geometry;LO.fromBufferAttribute(s.attributes.skinIndex,e),DO.fromBufferAttribute(s.attributes.skinWeight,e),NO.copy(i).applyMatrix4(this.bindMatrix),i.set(0,0,0);for(let o=0;o<4;o++){const l=DO.getComponent(o);if(l!==0){const u=LO.getComponent(o);OO.multiplyMatrices(n.bones[u].matrixWorld,n.boneInverses[u]),i.addScaledVector(xX.copy(NO).applyMatrix4(OO),l)}}return i.applyMatrix4(this.bindMatrixInverse)}}class cC extends Fa{constructor(){super(),this.isBone=!0,this.type="Bone"}}let _X=class extends hu{constructor(r=null,e=1,i=1,n,s,o,l,u,c=fx,h=fx,p,f){super(null,o,l,u,c,h,n,s,p,f),this.isDataTexture=!0,this.image={data:r,width:e,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};const kO=new Qr,EX=new Qr;class uC{constructor(e=[],i=[]){this.uuid=Bh(),this.bones=e.slice(0),this.boneInverses=i,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,i=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),i.length===0)this.calculateInverses();else if(e.length!==i.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,s=this.bones.length;n<s;n++)this.boneInverses.push(new Qr)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,i=this.bones.length;e<i;e++){const n=new Qr;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,i=this.bones.length;e<i;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,i=this.bones.length;e<i;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,i=this.boneInverses,n=this.boneMatrices,s=this.boneTexture;for(let o=0,l=e.length;o<l;o++){const u=e[o]?e[o].matrixWorld:EX;kO.multiplyMatrices(u,i[o]),kO.toArray(n,o*16)}s!==null&&(s.needsUpdate=!0)}clone(){return new uC(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const i=new Float32Array(e*e*4);i.set(this.boneMatrices);const n=new _X(i,e,e,qD,QD);return n.needsUpdate=!0,this.boneMatrices=i,this.boneTexture=n,this}getBoneByName(e){for(let i=0,n=this.bones.length;i<n;i++){const s=this.bones[i];if(s.name===e)return s}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,i){this.uuid=e.uuid;for(let n=0,s=e.bones.length;n<s;n++){const o=e.bones[n];let l=i[o];l===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",o),l=new cC),this.bones.push(l),this.boneInverses.push(new Qr().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const i=this.bones,n=this.boneInverses;for(let s=0,o=i.length;s<o;s++){const l=i[s];e.bones.push(l.uuid);const u=n[s];e.boneInverses.push(u.toArray())}return e}}let FO=class extends Mx{constructor(r){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Ys(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(r)}copy(r){return super.copy(r),this.color.copy(r.color),this.map=r.map,this.linewidth=r.linewidth,this.linecap=r.linecap,this.linejoin=r.linejoin,this.fog=r.fog,this}};const zx=new Lt,jx=new Lt,UO=new Qr,iA=new K2,Vx=new Yf,hC=new Lt,zO=new Lt;let wX=class extends Fa{constructor(r=new tA,e=new FO){super(),this.isLine=!0,this.type="Line",this.geometry=r,this.material=e,this.updateMorphTargets()}copy(r,e){return super.copy(r,e),this.material=Array.isArray(r.material)?r.material.slice():r.material,this.geometry=r.geometry,this}computeLineDistances(){const r=this.geometry;if(r.index===null){const e=r.attributes.position,i=[0];for(let n=1,s=e.count;n<s;n++)zx.fromBufferAttribute(e,n-1),jx.fromBufferAttribute(e,n),i[n]=i[n-1],i[n]+=zx.distanceTo(jx);r.setAttribute("lineDistance",new Fh(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(r,e){const i=this.geometry,n=this.matrixWorld,s=r.params.Line.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),Vx.copy(i.boundingSphere),Vx.applyMatrix4(n),Vx.radius+=s,r.ray.intersectsSphere(Vx)===!1)return;UO.copy(n).invert(),iA.copy(r.ray).applyMatrix4(UO);const l=s/((this.scale.x+this.scale.y+this.scale.z)/3),u=l*l,c=this.isLineSegments?2:1,h=i.index,p=i.attributes.position;if(h!==null){const f=Math.max(0,o.start),m=Math.min(h.count,o.start+o.count);for(let g=f,y=m-1;g<y;g+=c){const x=h.getX(g),v=h.getX(g+1),_=Gx(this,r,iA,u,x,v);_&&e.push(_)}if(this.isLineLoop){const g=h.getX(m-1),y=h.getX(f),x=Gx(this,r,iA,u,g,y);x&&e.push(x)}}else{const f=Math.max(0,o.start),m=Math.min(p.count,o.start+o.count);for(let g=f,y=m-1;g<y;g+=c){const x=Gx(this,r,iA,u,g,g+1);x&&e.push(x)}if(this.isLineLoop){const g=Gx(this,r,iA,u,m-1,f);g&&e.push(g)}}}updateMorphTargets(){const r=this.geometry.morphAttributes,e=Object.keys(r);if(e.length>0){const i=r[e[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let n=0,s=i.length;n<s;n++){const o=i[n].name||String(n);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=n}}}}};function Gx(r,e,i,n,s,o){const l=r.geometry.attributes.position;if(zx.fromBufferAttribute(l,s),jx.fromBufferAttribute(l,o),i.distanceSqToSegment(zx,jx,hC,zO)>n)return;hC.applyMatrix4(r.matrixWorld);const u=e.ray.origin.distanceTo(hC);if(!(u<e.near||u>e.far))return{distance:u,point:zO.clone().applyMatrix4(r.matrixWorld),index:s,face:null,faceIndex:null,object:r}}let CX=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(r,e){const i=this.getUtoTmapping(r);return this.getPoint(i,e)}getPoints(r=5){const e=[];for(let i=0;i<=r;i++)e.push(this.getPoint(i/r));return e}getSpacedPoints(r=5){const e=[];for(let i=0;i<=r;i++)e.push(this.getPointAt(i/r));return e}getLength(){const r=this.getLengths();return r[r.length-1]}getLengths(r=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===r+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const e=[];let i,n=this.getPoint(0),s=0;e.push(0);for(let o=1;o<=r;o++)i=this.getPoint(o/r),s+=i.distanceTo(n),e.push(s),n=i;return this.cacheArcLengths=e,e}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(r,e){const i=this.getLengths();let n=0;const s=i.length;let o;e?o=e:o=r*i[s-1];let l=0,u=s-1,c;for(;l<=u;)if(n=Math.floor(l+(u-l)/2),c=i[n]-o,c<0)l=n+1;else if(c>0)u=n-1;else{u=n;break}if(n=u,i[n]===o)return n/(s-1);const h=i[n],p=i[n+1]-h,f=(o-h)/p;return(n+f)/(s-1)}getTangent(r,e){let i=r-1e-4,n=r+1e-4;i<0&&(i=0),n>1&&(n=1);const s=this.getPoint(i),o=this.getPoint(n),l=e||(s.isVector2?new Hs:new Lt);return l.copy(o).sub(s).normalize(),l}getTangentAt(r,e){const i=this.getUtoTmapping(r);return this.getTangent(i,e)}computeFrenetFrames(r,e){const i=new Lt,n=[],s=[],o=[],l=new Lt,u=new Qr;for(let m=0;m<=r;m++){const g=m/r;n[m]=this.getTangentAt(g,new Lt)}s[0]=new Lt,o[0]=new Lt;let c=Number.MAX_VALUE;const h=Math.abs(n[0].x),p=Math.abs(n[0].y),f=Math.abs(n[0].z);h<=c&&(c=h,i.set(1,0,0)),p<=c&&(c=p,i.set(0,1,0)),f<=c&&i.set(0,0,1),l.crossVectors(n[0],i).normalize(),s[0].crossVectors(n[0],l),o[0].crossVectors(n[0],s[0]);for(let m=1;m<=r;m++){if(s[m]=s[m-1].clone(),o[m]=o[m-1].clone(),l.crossVectors(n[m-1],n[m]),l.length()>Number.EPSILON){l.normalize();const g=Math.acos(ka(n[m-1].dot(n[m]),-1,1));s[m].applyMatrix4(u.makeRotationAxis(l,g))}o[m].crossVectors(n[m],s[m])}if(e===!0){let m=Math.acos(ka(s[0].dot(s[r]),-1,1));m/=r,n[0].dot(l.crossVectors(s[0],s[r]))>0&&(m=-m);for(let g=1;g<=r;g++)s[g].applyMatrix4(u.makeRotationAxis(n[g],m*g)),o[g].crossVectors(n[g],s[g])}return{tangents:n,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(r){return this.arcLengthDivisions=r.arcLengthDivisions,this}toJSON(){const r={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return r.arcLengthDivisions=this.arcLengthDivisions,r.type=this.type,r}fromJSON(r){return this.arcLengthDivisions=r.arcLengthDivisions,this}};const SX={triangulate:function(r,e,i=2){const n=e&&e.length,s=n?e[0]*i:r.length;let o=jO(r,0,s,i,!0);const l=[];if(!o||o.next===o.prev)return l;let u,c,h,p,f,m,g;if(n&&(o=BX(r,e,o,i)),r.length>80*i){u=h=r[0],c=p=r[1];for(let y=i;y<s;y+=i)f=r[y],m=r[y+1],f<u&&(u=f),m<c&&(c=m),f>h&&(h=f),m>p&&(p=m);g=Math.max(h-u,p-c),g=g!==0?32767/g:0}return rA(o,l,i,u,c,g,0),l}};function jO(r,e,i,n,s){let o,l;if(s===VX(r,e,i,n)>0)for(o=e;o<i;o+=n)l=HO(o,r[o],r[o+1],l);else for(o=i-n;o>=e;o-=n)l=HO(o,r[o],r[o+1],l);return l&&Hx(l,l.next)&&(sA(l),l=l.next),l}function rp(r,e){if(!r)return r;e||(e=r);let i=r,n;do if(n=!1,!i.steiner&&(Hx(i,i.next)||Is(i.prev,i,i.next)===0)){if(sA(i),i=e=i.prev,i===i.next)break;n=!0}else i=i.next;while(n||i!==e);return e}function rA(r,e,i,n,s,o,l){if(!r)return;!l&&o&&PX(r,n,s,o);let u=r,c,h;for(;r.prev!==r.next;){if(c=r.prev,h=r.next,o?MX(r,n,s,o):TX(r)){e.push(c.i/i|0),e.push(r.i/i|0),e.push(h.i/i|0),sA(r),r=h.next,u=h.next;continue}if(r=h,r===u){l?l===1?(r=RX(rp(r),e,i),rA(r,e,i,n,s,o,2)):l===2&&IX(r,e,i,n,s,o):rA(rp(r),e,i,n,s,o,1);break}}}function TX(r){const e=r.prev,i=r,n=r.next;if(Is(e,i,n)>=0)return!1;const s=e.x,o=i.x,l=n.x,u=e.y,c=i.y,h=n.y,p=s<o?s<l?s:l:o<l?o:l,f=u<c?u<h?u:h:c<h?c:h,m=s>o?s>l?s:l:o>l?o:l,g=u>c?u>h?u:h:c>h?c:h;let y=n.next;for(;y!==e;){if(y.x>=p&&y.x<=m&&y.y>=f&&y.y<=g&&om(s,u,o,c,l,h,y.x,y.y)&&Is(y.prev,y,y.next)>=0)return!1;y=y.next}return!0}function MX(r,e,i,n){const s=r.prev,o=r,l=r.next;if(Is(s,o,l)>=0)return!1;const u=s.x,c=o.x,h=l.x,p=s.y,f=o.y,m=l.y,g=u<c?u<h?u:h:c<h?c:h,y=p<f?p<m?p:m:f<m?f:m,x=u>c?u>h?u:h:c>h?c:h,v=p>f?p>m?p:m:f>m?f:m,_=dC(g,y,e,i,n),T=dC(x,v,e,i,n);let w=r.prevZ,S=r.nextZ;for(;w&&w.z>=_&&S&&S.z<=T;){if(w.x>=g&&w.x<=x&&w.y>=y&&w.y<=v&&w!==s&&w!==l&&om(u,p,c,f,h,m,w.x,w.y)&&Is(w.prev,w,w.next)>=0||(w=w.prevZ,S.x>=g&&S.x<=x&&S.y>=y&&S.y<=v&&S!==s&&S!==l&&om(u,p,c,f,h,m,S.x,S.y)&&Is(S.prev,S,S.next)>=0))return!1;S=S.nextZ}for(;w&&w.z>=_;){if(w.x>=g&&w.x<=x&&w.y>=y&&w.y<=v&&w!==s&&w!==l&&om(u,p,c,f,h,m,w.x,w.y)&&Is(w.prev,w,w.next)>=0)return!1;w=w.prevZ}for(;S&&S.z<=T;){if(S.x>=g&&S.x<=x&&S.y>=y&&S.y<=v&&S!==s&&S!==l&&om(u,p,c,f,h,m,S.x,S.y)&&Is(S.prev,S,S.next)>=0)return!1;S=S.nextZ}return!0}function RX(r,e,i){let n=r;do{const s=n.prev,o=n.next.next;!Hx(s,o)&&VO(s,n,n.next,o)&&nA(s,o)&&nA(o,s)&&(e.push(s.i/i|0),e.push(n.i/i|0),e.push(o.i/i|0),sA(n),sA(n.next),n=r=o),n=n.next}while(n!==r);return rp(n)}function IX(r,e,i,n,s,o){let l=r;do{let u=l.next.next;for(;u!==l.prev;){if(l.i!==u.i&&UX(l,u)){let c=GO(l,u);l=rp(l,l.next),c=rp(c,c.next),rA(l,e,i,n,s,o,0),rA(c,e,i,n,s,o,0);return}u=u.next}l=l.next}while(l!==r)}function BX(r,e,i,n){const s=[];let o,l,u,c,h;for(o=0,l=e.length;o<l;o++)u=e[o]*n,c=o<l-1?e[o+1]*n:r.length,h=jO(r,u,c,n,!1),h===h.next&&(h.steiner=!0),s.push(FX(h));for(s.sort(NX),o=0;o<s.length;o++)i=LX(s[o],i);return i}function NX(r,e){return r.x-e.x}function LX(r,e){const i=DX(r,e);if(!i)return e;const n=GO(i,r);return rp(n,n.next),rp(i,i.next)}function DX(r,e){let i=e,n=-1/0,s;const o=r.x,l=r.y;do{if(l<=i.y&&l>=i.next.y&&i.next.y!==i.y){const m=i.x+(l-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(m<=o&&m>n&&(n=m,s=i.x<i.next.x?i:i.next,m===o))return s}i=i.next}while(i!==e);if(!s)return null;const u=s,c=s.x,h=s.y;let p=1/0,f;i=s;do o>=i.x&&i.x>=c&&o!==i.x&&om(l<h?o:n,l,c,h,l<h?n:o,l,i.x,i.y)&&(f=Math.abs(l-i.y)/(o-i.x),nA(i,r)&&(f<p||f===p&&(i.x>s.x||i.x===s.x&&OX(s,i)))&&(s=i,p=f)),i=i.next;while(i!==u);return s}function OX(r,e){return Is(r.prev,r,e.prev)<0&&Is(e.next,r,r.next)<0}function PX(r,e,i,n){let s=r;do s.z===0&&(s.z=dC(s.x,s.y,e,i,n)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==r);s.prevZ.nextZ=null,s.prevZ=null,kX(s)}function kX(r){let e,i,n,s,o,l,u,c,h=1;do{for(i=r,r=null,o=null,l=0;i;){for(l++,n=i,u=0,e=0;e<h&&(u++,n=n.nextZ,!!n);e++);for(c=h;u>0||c>0&&n;)u!==0&&(c===0||!n||i.z<=n.z)?(s=i,i=i.nextZ,u--):(s=n,n=n.nextZ,c--),o?o.nextZ=s:r=s,s.prevZ=o,o=s;i=n}o.nextZ=null,h*=2}while(l>1);return r}function dC(r,e,i,n,s){return r=(r-i)*s|0,e=(e-n)*s|0,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,r|e<<1}function FX(r){let e=r,i=r;do(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next;while(e!==r);return i}function om(r,e,i,n,s,o,l,u){return(s-l)*(e-u)>=(r-l)*(o-u)&&(r-l)*(n-u)>=(i-l)*(e-u)&&(i-l)*(o-u)>=(s-l)*(n-u)}function UX(r,e){return r.next.i!==e.i&&r.prev.i!==e.i&&!zX(r,e)&&(nA(r,e)&&nA(e,r)&&jX(r,e)&&(Is(r.prev,r,e.prev)||Is(r,e.prev,e))||Hx(r,e)&&Is(r.prev,r,r.next)>0&&Is(e.prev,e,e.next)>0)}function Is(r,e,i){return(e.y-r.y)*(i.x-e.x)-(e.x-r.x)*(i.y-e.y)}function Hx(r,e){return r.x===e.x&&r.y===e.y}function VO(r,e,i,n){const s=Qx(Is(r,e,i)),o=Qx(Is(r,e,n)),l=Qx(Is(i,n,r)),u=Qx(Is(i,n,e));return!!(s!==o&&l!==u||s===0&&Wx(r,i,e)||o===0&&Wx(r,n,e)||l===0&&Wx(i,r,n)||u===0&&Wx(i,e,n))}function Wx(r,e,i){return e.x<=Math.max(r.x,i.x)&&e.x>=Math.min(r.x,i.x)&&e.y<=Math.max(r.y,i.y)&&e.y>=Math.min(r.y,i.y)}function Qx(r){return r>0?1:r<0?-1:0}function zX(r,e){let i=r;do{if(i.i!==r.i&&i.next.i!==r.i&&i.i!==e.i&&i.next.i!==e.i&&VO(i,i.next,r,e))return!0;i=i.next}while(i!==r);return!1}function nA(r,e){return Is(r.prev,r,r.next)<0?Is(r,e,r.next)>=0&&Is(r,r.prev,e)>=0:Is(r,e,r.prev)<0||Is(r,r.next,e)<0}function jX(r,e){let i=r,n=!1;const s=(r.x+e.x)/2,o=(r.y+e.y)/2;do i.y>o!=i.next.y>o&&i.next.y!==i.y&&s<(i.next.x-i.x)*(o-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next;while(i!==r);return n}function GO(r,e){const i=new pC(r.i,r.x,r.y),n=new pC(e.i,e.x,e.y),s=r.next,o=e.prev;return r.next=e,e.prev=r,i.next=s,s.prev=i,n.next=i,i.prev=n,o.next=n,n.prev=o,n}function HO(r,e,i,n){const s=new pC(r,e,i);return n?(s.next=n.next,s.prev=n,n.next.prev=s,n.next=s):(s.prev=s,s.next=s),s}function sA(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function pC(r,e,i){this.i=r,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function VX(r,e,i,n){let s=0;for(let o=e,l=i-n;o<i;o+=n)s+=(r[l]-r[o])*(r[o+1]+r[l+1]),l=o;return s}class fC{static area(e){const i=e.length;let n=0;for(let s=i-1,o=0;o<i;s=o++)n+=e[s].x*e[o].y-e[o].x*e[s].y;return n*.5}static isClockWise(e){return fC.area(e)<0}static triangulateShape(e,i){const n=[],s=[],o=[];WO(e),QO(n,e);let l=e.length;i.forEach(WO);for(let c=0;c<i.length;c++)s.push(l),l+=i[c].length,QO(n,i[c]);const u=SX.triangulate(n,s);for(let c=0;c<u.length;c+=3)o.push(u.slice(c,c+3));return o}}function WO(r){const e=r.length;e>2&&r[e-1].equals(r[0])&&r.pop()}function QO(r,e){for(let i=0;i<e.length;i++)r.push(e[i].x),r.push(e[i].y)}let mC=class extends Mx{constructor(r){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Ys(16777215),this.specular=new Ys(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ys(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ZD,this.normalScale=new Hs(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Ao,this.combine=L2,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(r)}copy(r){return super.copy(r),this.color.copy(r.color),this.specular.copy(r.specular),this.shininess=r.shininess,this.map=r.map,this.lightMap=r.lightMap,this.lightMapIntensity=r.lightMapIntensity,this.aoMap=r.aoMap,this.aoMapIntensity=r.aoMapIntensity,this.emissive.copy(r.emissive),this.emissiveMap=r.emissiveMap,this.emissiveIntensity=r.emissiveIntensity,this.bumpMap=r.bumpMap,this.bumpScale=r.bumpScale,this.normalMap=r.normalMap,this.normalMapType=r.normalMapType,this.normalScale.copy(r.normalScale),this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.specularMap=r.specularMap,this.alphaMap=r.alphaMap,this.envMap=r.envMap,this.envMapRotation.copy(r.envMapRotation),this.combine=r.combine,this.reflectivity=r.reflectivity,this.refractionRatio=r.refractionRatio,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.wireframeLinecap=r.wireframeLinecap,this.wireframeLinejoin=r.wireframeLinejoin,this.flatShading=r.flatShading,this.fog=r.fog,this}},GX=class extends Mx{constructor(r){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Ys(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ys(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ZD,this.normalScale=new Hs(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Ao,this.combine=L2,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(r)}copy(r){return super.copy(r),this.color.copy(r.color),this.map=r.map,this.lightMap=r.lightMap,this.lightMapIntensity=r.lightMapIntensity,this.aoMap=r.aoMap,this.aoMapIntensity=r.aoMapIntensity,this.emissive.copy(r.emissive),this.emissiveMap=r.emissiveMap,this.emissiveIntensity=r.emissiveIntensity,this.bumpMap=r.bumpMap,this.bumpScale=r.bumpScale,this.normalMap=r.normalMap,this.normalMapType=r.normalMapType,this.normalScale.copy(r.normalScale),this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.specularMap=r.specularMap,this.alphaMap=r.alphaMap,this.envMap=r.envMap,this.envMapRotation.copy(r.envMapRotation),this.combine=r.combine,this.reflectivity=r.reflectivity,this.refractionRatio=r.refractionRatio,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.wireframeLinecap=r.wireframeLinecap,this.wireframeLinejoin=r.wireframeLinejoin,this.flatShading=r.flatShading,this.fog=r.fog,this}};function qx(r,e,i){return!r||r.constructor===e?r:typeof e.BYTES_PER_ELEMENT=="number"?new e(r):Array.prototype.slice.call(r)}function HX(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}function WX(r){function e(s,o){return r[s]-r[o]}const i=r.length,n=new Array(i);for(let s=0;s!==i;++s)n[s]=s;return n.sort(e),n}function qO(r,e,i){const n=r.length,s=new r.constructor(n);for(let o=0,l=0;l!==n;++o){const u=i[o]*e;for(let c=0;c!==e;++c)s[l++]=r[u+c]}return s}function XO(r,e,i,n){let s=1,o=r[0];for(;o!==void 0&&o[n]===void 0;)o=r[s++];if(o===void 0)return;let l=o[n];if(l!==void 0)if(Array.isArray(l))do l=o[n],l!==void 0&&(e.push(o.time),i.push.apply(i,l)),o=r[s++];while(o!==void 0);else if(l.toArray!==void 0)do l=o[n],l!==void 0&&(e.push(o.time),l.toArray(i,i.length)),o=r[s++];while(o!==void 0);else do l=o[n],l!==void 0&&(e.push(o.time),i.push(l)),o=r[s++];while(o!==void 0)}class Xx{constructor(e,i,n,s){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=s!==void 0?s:new i.constructor(n),this.sampleValues=i,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const i=this.parameterPositions;let n=this._cachedIndex,s=i[n],o=i[n-1];i:{e:{let l;t:{r:if(!(e<s)){for(let u=n+2;;){if(s===void 0){if(e<o)break r;return n=i.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===u)break;if(o=s,s=i[++n],e<s)break e}l=i.length;break t}if(!(e>=o)){const u=i[1];e<u&&(n=2,o=u);for(let c=n-2;;){if(o===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===c)break;if(s=o,o=i[--n-1],e>=o)break e}l=n,n=0;break t}break i}for(;n<l;){const u=n+l>>>1;e<i[u]?l=u:n=u+1}if(s=i[n],o=i[n-1],o===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(s===void 0)return n=i.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,o,s)}return this.interpolate_(n,o,e,s)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const i=this.resultBuffer,n=this.sampleValues,s=this.valueSize,o=e*s;for(let l=0;l!==s;++l)i[l]=n[o+l];return i}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class QX extends Xx{constructor(e,i,n,s){super(e,i,n,s),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:YD,endingEnd:YD}}intervalChanged_(e,i,n){const s=this.parameterPositions;let o=e-2,l=e+1,u=s[o],c=s[l];if(u===void 0)switch(this.getSettings_().endingStart){case KD:o=e,u=2*i-n;break;case JD:o=s.length-2,u=i+s[o]-s[o+1];break;default:o=e,u=n}if(c===void 0)switch(this.getSettings_().endingEnd){case KD:l=e,c=2*n-i;break;case JD:l=1,c=n+s[1]-s[0];break;default:l=e-1,c=i}const h=(n-i)*.5,p=this.valueSize;this._weightPrev=h/(i-u),this._weightNext=h/(c-n),this._offsetPrev=o*p,this._offsetNext=l*p}interpolate_(e,i,n,s){const o=this.resultBuffer,l=this.sampleValues,u=this.valueSize,c=e*u,h=c-u,p=this._offsetPrev,f=this._offsetNext,m=this._weightPrev,g=this._weightNext,y=(n-i)/(s-i),x=y*y,v=x*y,_=-m*v+2*m*x-m*y,T=(1+m)*v+(-1.5-2*m)*x+(-.5+m)*y+1,w=(-1-g)*v+(1.5+g)*x+.5*y,S=g*v-g*x;for(let R=0;R!==u;++R)o[R]=_*l[p+R]+T*l[h+R]+w*l[c+R]+S*l[f+R];return o}}class qX extends Xx{constructor(e,i,n,s){super(e,i,n,s)}interpolate_(e,i,n,s){const o=this.resultBuffer,l=this.sampleValues,u=this.valueSize,c=e*u,h=c-u,p=(n-i)/(s-i),f=1-p;for(let m=0;m!==u;++m)o[m]=l[h+m]*f+l[c+m]*p;return o}}class XX extends Xx{constructor(e,i,n,s){super(e,i,n,s)}interpolate_(e){return this.copySampleValue_(e-1)}}class kc{constructor(e,i,n,s){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(i===void 0||i.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=qx(i,this.TimeBufferType),this.values=qx(n,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation)}static toJSON(e){const i=e.constructor;let n;if(i.toJSON!==this.toJSON)n=i.toJSON(e);else{n={name:e.name,times:qx(e.times,Array),values:qx(e.values,Array)};const s=e.getInterpolation();s!==e.DefaultInterpolation&&(n.interpolation=s)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new XX(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new qX(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new QX(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let i;switch(e){case mx:i=this.InterpolantFactoryMethodDiscrete;break;case gx:i=this.InterpolantFactoryMethodLinear;break;case O2:i=this.InterpolantFactoryMethodSmooth;break}if(i===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=i,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return mx;case this.InterpolantFactoryMethodLinear:return gx;case this.InterpolantFactoryMethodSmooth:return O2}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const i=this.times;for(let n=0,s=i.length;n!==s;++n)i[n]+=e}return this}scale(e){if(e!==1){const i=this.times;for(let n=0,s=i.length;n!==s;++n)i[n]*=e}return this}trim(e,i){const n=this.times,s=n.length;let o=0,l=s-1;for(;o!==s&&n[o]<e;)++o;for(;l!==-1&&n[l]>i;)--l;if(++l,o!==0||l!==s){o>=l&&(l=Math.max(l,1),o=l-1);const u=this.getValueSize();this.times=n.slice(o,l),this.values=this.values.slice(o*u,l*u)}return this}validate(){let e=!0;const i=this.getValueSize();i-Math.floor(i)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,s=this.values,o=n.length;o===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let l=null;for(let u=0;u!==o;u++){const c=n[u];if(typeof c=="number"&&isNaN(c)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,u,c),e=!1;break}if(l!==null&&l>c){console.error("THREE.KeyframeTrack: Out of order keys.",this,u,c,l),e=!1;break}l=c}if(s!==void 0&&HX(s))for(let u=0,c=s.length;u!==c;++u){const h=s[u];if(isNaN(h)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,u,h),e=!1;break}}return e}optimize(){const e=this.times.slice(),i=this.values.slice(),n=this.getValueSize(),s=this.getInterpolation()===O2,o=e.length-1;let l=1;for(let u=1;u<o;++u){let c=!1;const h=e[u],p=e[u+1];if(h!==p&&(u!==1||h!==e[0]))if(s)c=!0;else{const f=u*n,m=f-n,g=f+n;for(let y=0;y!==n;++y){const x=i[f+y];if(x!==i[m+y]||x!==i[g+y]){c=!0;break}}}if(c){if(u!==l){e[l]=e[u];const f=u*n,m=l*n;for(let g=0;g!==n;++g)i[m+g]=i[f+g]}++l}}if(o>0){e[l]=e[o];for(let u=o*n,c=l*n,h=0;h!==n;++h)i[c+h]=i[u+h];++l}return l!==e.length?(this.times=e.slice(0,l),this.values=i.slice(0,l*n)):(this.times=e,this.values=i),this}clone(){const e=this.times.slice(),i=this.values.slice(),n=this.constructor,s=new n(this.name,e,i);return s.createInterpolant=this.createInterpolant,s}}kc.prototype.TimeBufferType=Float32Array,kc.prototype.ValueBufferType=Float32Array,kc.prototype.DefaultInterpolation=gx;class lm extends kc{}lm.prototype.ValueTypeName="bool",lm.prototype.ValueBufferType=Array,lm.prototype.DefaultInterpolation=mx,lm.prototype.InterpolantFactoryMethodLinear=void 0,lm.prototype.InterpolantFactoryMethodSmooth=void 0;class YO extends kc{}YO.prototype.ValueTypeName="color";class aA extends kc{}aA.prototype.ValueTypeName="number";class YX extends Xx{constructor(e,i,n,s){super(e,i,n,s)}interpolate_(e,i,n,s){const o=this.resultBuffer,l=this.sampleValues,u=this.valueSize,c=(n-i)/(s-i);let h=e*u;for(let p=h+u;h!==p;h+=4)Uo.slerpFlat(o,0,l,h-u,l,h,c);return o}}class np extends kc{InterpolantFactoryMethodLinear(e){return new YX(this.times,this.values,this.getValueSize(),e)}}np.prototype.ValueTypeName="quaternion",np.prototype.DefaultInterpolation=gx,np.prototype.InterpolantFactoryMethodSmooth=void 0;class cm extends kc{}cm.prototype.ValueTypeName="string",cm.prototype.ValueBufferType=Array,cm.prototype.DefaultInterpolation=mx,cm.prototype.InterpolantFactoryMethodLinear=void 0,cm.prototype.InterpolantFactoryMethodSmooth=void 0;class oA extends kc{}oA.prototype.ValueTypeName="vector";class KX{constructor(e="",i=-1,n=[],s=Iq){this.name=e,this.tracks=n,this.duration=i,this.blendMode=s,this.uuid=Bh(),this.duration<0&&this.resetDuration()}static parse(e){const i=[],n=e.tracks,s=1/(e.fps||1);for(let l=0,u=n.length;l!==u;++l)i.push(ZX(n[l]).scale(s));const o=new this(e.name,e.duration,i,e.blendMode);return o.uuid=e.uuid,o}static toJSON(e){const i=[],n=e.tracks,s={name:e.name,duration:e.duration,tracks:i,uuid:e.uuid,blendMode:e.blendMode};for(let o=0,l=n.length;o!==l;++o)i.push(kc.toJSON(n[o]));return s}static CreateFromMorphTargetSequence(e,i,n,s){const o=i.length,l=[];for(let u=0;u<o;u++){let c=[],h=[];c.push((u+o-1)%o,u,(u+1)%o),h.push(0,1,0);const p=WX(c);c=qO(c,1,p),h=qO(h,1,p),!s&&c[0]===0&&(c.push(o),h.push(h[0])),l.push(new aA(".morphTargetInfluences["+i[u].name+"]",c,h).scale(1/n))}return new this(e,-1,l)}static findByName(e,i){let n=e;if(!Array.isArray(e)){const s=e;n=s.geometry&&s.geometry.animations||s.animations}for(let s=0;s<n.length;s++)if(n[s].name===i)return n[s];return null}static CreateClipsFromMorphTargetSequences(e,i,n){const s={},o=/^([\w-]*?)([\d]+)$/;for(let u=0,c=e.length;u<c;u++){const h=e[u],p=h.name.match(o);if(p&&p.length>1){const f=p[1];let m=s[f];m||(s[f]=m=[]),m.push(h)}}const l=[];for(const u in s)l.push(this.CreateFromMorphTargetSequence(u,s[u],i,n));return l}static parseAnimation(e,i){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(p,f,m,g,y){if(m.length!==0){const x=[],v=[];XO(m,x,v,g),x.length!==0&&y.push(new p(f,x,v))}},s=[],o=e.name||"default",l=e.fps||30,u=e.blendMode;let c=e.length||-1;const h=e.hierarchy||[];for(let p=0;p<h.length;p++){const f=h[p].keys;if(!(!f||f.length===0))if(f[0].morphTargets){const m={};let g;for(g=0;g<f.length;g++)if(f[g].morphTargets)for(let y=0;y<f[g].morphTargets.length;y++)m[f[g].morphTargets[y]]=-1;for(const y in m){const x=[],v=[];for(let _=0;_!==f[g].morphTargets.length;++_){const T=f[g];x.push(T.time),v.push(T.morphTarget===y?1:0)}s.push(new aA(".morphTargetInfluence["+y+"]",x,v))}c=m.length*l}else{const m=".bones["+i[p].name+"]";n(oA,m+".position",f,"pos",s),n(np,m+".quaternion",f,"rot",s),n(oA,m+".scale",f,"scl",s)}}return s.length===0?null:new this(o,c,s,u)}resetDuration(){const e=this.tracks;let i=0;for(let n=0,s=e.length;n!==s;++n){const o=this.tracks[n];i=Math.max(i,o.times[o.times.length-1])}return this.duration=i,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let i=0;i<this.tracks.length;i++)e=e&&this.tracks[i].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let i=0;i<this.tracks.length;i++)e.push(this.tracks[i].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function JX(r){switch(r.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return aA;case"vector":case"vector2":case"vector3":case"vector4":return oA;case"color":return YO;case"quaternion":return np;case"bool":case"boolean":return lm;case"string":return cm}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+r)}function ZX(r){if(r.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=JX(r.type);if(r.times===void 0){const i=[],n=[];XO(r.keys,i,n,"value"),r.times=i,r.values=n}return e.parse!==void 0?e.parse(r):new e(r.name,r.times,r.values,r.interpolation)}const Yx={enabled:!1,files:{},add:function(r,e){this.enabled!==!1&&(this.files[r]=e)},get:function(r){if(this.enabled!==!1)return this.files[r]},remove:function(r){delete this.files[r]},clear:function(){this.files={}}};let $X=class{constructor(r,e,i){const n=this;let s=!1,o=0,l=0,u;const c=[];this.onStart=void 0,this.onLoad=r,this.onProgress=e,this.onError=i,this.itemStart=function(h){l++,s===!1&&n.onStart!==void 0&&n.onStart(h,o,l),s=!0},this.itemEnd=function(h){o++,n.onProgress!==void 0&&n.onProgress(h,o,l),o===l&&(s=!1,n.onLoad!==void 0&&n.onLoad())},this.itemError=function(h){n.onError!==void 0&&n.onError(h)},this.resolveURL=function(h){return u?u(h):h},this.setURLModifier=function(h){return u=h,this},this.addHandler=function(h,p){return c.push(h,p),this},this.removeHandler=function(h){const p=c.indexOf(h);return p!==-1&&c.splice(p,2),this},this.getHandler=function(h){for(let p=0,f=c.length;p<f;p+=2){const m=c[p],g=c[p+1];if(m.global&&(m.lastIndex=0),m.test(h))return g}return null}}};const eY=new $X;let sp=class{constructor(r){this.manager=r!==void 0?r:eY,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(r,e){const i=this;return new Promise(function(n,s){i.load(r,n,e,s)})}parse(){}setCrossOrigin(r){return this.crossOrigin=r,this}setWithCredentials(r){return this.withCredentials=r,this}setPath(r){return this.path=r,this}setResourcePath(r){return this.resourcePath=r,this}setRequestHeader(r){return this.requestHeader=r,this}};sp.DEFAULT_MATERIAL_NAME="__DEFAULT";const Au={};class tY extends Error{constructor(e,i){super(e),this.response=i}}class iY extends sp{constructor(e){super(e)}load(e,i,n,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const o=Yx.get(e);if(o!==void 0)return this.manager.itemStart(e),setTimeout(()=>{i&&i(o),this.manager.itemEnd(e)},0),o;if(Au[e]!==void 0){Au[e].push({onLoad:i,onProgress:n,onError:s});return}Au[e]=[],Au[e].push({onLoad:i,onProgress:n,onError:s});const l=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),u=this.mimeType,c=this.responseType;fetch(l).then(h=>{if(h.status===200||h.status===0){if(h.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||h.body===void 0||h.body.getReader===void 0)return h;const p=Au[e],f=h.body.getReader(),m=h.headers.get("X-File-Size")||h.headers.get("Content-Length"),g=m?parseInt(m):0,y=g!==0;let x=0;const v=new ReadableStream({start(_){T();function T(){f.read().then(({done:w,value:S})=>{if(w)_.close();else{x+=S.byteLength;const R=new ProgressEvent("progress",{lengthComputable:y,loaded:x,total:g});for(let B=0,I=p.length;B<I;B++){const D=p[B];D.onProgress&&D.onProgress(R)}_.enqueue(S),T()}})}}});return new Response(v)}else throw new tY(`fetch for "${h.url}" responded with ${h.status}: ${h.statusText}`,h)}).then(h=>{switch(c){case"arraybuffer":return h.arrayBuffer();case"blob":return h.blob();case"document":return h.text().then(p=>new DOMParser().parseFromString(p,u));case"json":return h.json();default:if(u===void 0)return h.text();{const p=/charset="?([^;"\s]*)"?/i.exec(u),f=p&&p[1]?p[1].toLowerCase():void 0,m=new TextDecoder(f);return h.arrayBuffer().then(g=>m.decode(g))}}}).then(h=>{Yx.add(e,h);const p=Au[e];delete Au[e];for(let f=0,m=p.length;f<m;f++){const g=p[f];g.onLoad&&g.onLoad(h)}}).catch(h=>{const p=Au[e];if(p===void 0)throw this.manager.itemError(e),h;delete Au[e];for(let f=0,m=p.length;f<m;f++){const g=p[f];g.onError&&g.onError(h)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}let rY=class extends sp{constructor(r){super(r)}load(r,e,i,n){this.path!==void 0&&(r=this.path+r),r=this.manager.resolveURL(r);const s=this,o=Yx.get(r);if(o!==void 0)return s.manager.itemStart(r),setTimeout(function(){e&&e(o),s.manager.itemEnd(r)},0),o;const l=j2("img");function u(){h(),Yx.add(r,this),e&&e(this),s.manager.itemEnd(r)}function c(p){h(),n&&n(p),s.manager.itemError(r),s.manager.itemEnd(r)}function h(){l.removeEventListener("load",u,!1),l.removeEventListener("error",c,!1)}return l.addEventListener("load",u,!1),l.addEventListener("error",c,!1),r.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(l.crossOrigin=this.crossOrigin),s.manager.itemStart(r),l.src=r,l}},nY=class extends sp{constructor(r){super(r)}load(r,e,i,n){const s=new hu,o=new rY(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(r,function(l){s.image=l,s.needsUpdate=!0,e!==void 0&&e(s)},i,n),s}},Kx=class extends Fa{constructor(r,e=1){super(),this.isLight=!0,this.type="Light",this.color=new Ys(r),this.intensity=e}dispose(){}copy(r,e){return super.copy(r,e),this.color.copy(r.color),this.intensity=r.intensity,this}toJSON(r){const e=super.toJSON(r);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,this.groundColor!==void 0&&(e.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(e.object.distance=this.distance),this.angle!==void 0&&(e.object.angle=this.angle),this.decay!==void 0&&(e.object.decay=this.decay),this.penumbra!==void 0&&(e.object.penumbra=this.penumbra),this.shadow!==void 0&&(e.object.shadow=this.shadow.toJSON()),e}};const gC=new Qr,KO=new Lt,JO=new Lt;let AC=class{constructor(r){this.camera=r,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Hs(512,512),this.map=null,this.mapPass=null,this.matrix=new Qr,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new AX,this._frameExtents=new Hs(1,1),this._viewportCount=1,this._viewports=[new Fo(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(r){const e=this.camera,i=this.matrix;KO.setFromMatrixPosition(r.matrixWorld),e.position.copy(KO),JO.setFromMatrixPosition(r.target.matrixWorld),e.lookAt(JO),e.updateMatrixWorld(),gC.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(gC),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(gC)}getViewport(r){return this._viewports[r]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(r){return this.camera=r.camera.clone(),this.bias=r.bias,this.radius=r.radius,this.mapSize.copy(r.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const r={};return this.bias!==0&&(r.bias=this.bias),this.normalBias!==0&&(r.normalBias=this.normalBias),this.radius!==1&&(r.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(r.mapSize=this.mapSize.toArray()),r.camera=this.camera.toJSON(!1).object,delete r.camera.matrix,r}},sY=class extends AC{constructor(){super(new sC(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(r){const e=this.camera,i=Y0*2*r.angle*this.focus,n=this.mapSize.width/this.mapSize.height,s=r.distance||e.far;(i!==e.fov||n!==e.aspect||s!==e.far)&&(e.fov=i,e.aspect=n,e.far=s,e.updateProjectionMatrix()),super.updateMatrices(r)}copy(r){return super.copy(r),this.focus=r.focus,this}},aY=class extends Kx{constructor(r,e,i=0,n=Math.PI/3,s=0,o=2){super(r,e),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Fa.DEFAULT_UP),this.updateMatrix(),this.target=new Fa,this.distance=i,this.angle=n,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new sY}get power(){return this.intensity*Math.PI}set power(r){this.intensity=r/Math.PI}dispose(){this.shadow.dispose()}copy(r,e){return super.copy(r,e),this.distance=r.distance,this.angle=r.angle,this.penumbra=r.penumbra,this.decay=r.decay,this.target=r.target.clone(),this.shadow=r.shadow.clone(),this}};const ZO=new Qr,lA=new Lt,yC=new Lt;let oY=class extends AC{constructor(){super(new sC(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Hs(4,2),this._viewportCount=6,this._viewports=[new Fo(2,1,1,1),new Fo(0,1,1,1),new Fo(3,1,1,1),new Fo(1,1,1,1),new Fo(3,0,1,1),new Fo(1,0,1,1)],this._cubeDirections=[new Lt(1,0,0),new Lt(-1,0,0),new Lt(0,0,1),new Lt(0,0,-1),new Lt(0,1,0),new Lt(0,-1,0)],this._cubeUps=[new Lt(0,1,0),new Lt(0,1,0),new Lt(0,1,0),new Lt(0,1,0),new Lt(0,0,1),new Lt(0,0,-1)]}updateMatrices(r,e=0){const i=this.camera,n=this.matrix,s=r.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),lA.setFromMatrixPosition(r.matrixWorld),i.position.copy(lA),yC.copy(i.position),yC.add(this._cubeDirections[e]),i.up.copy(this._cubeUps[e]),i.lookAt(yC),i.updateMatrixWorld(),n.makeTranslation(-lA.x,-lA.y,-lA.z),ZO.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(ZO)}},$O=class extends Kx{constructor(r,e,i=0,n=2){super(r,e),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=n,this.shadow=new oY}get power(){return this.intensity*4*Math.PI}set power(r){this.intensity=r/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(r,e){return super.copy(r,e),this.distance=r.distance,this.decay=r.decay,this.shadow=r.shadow.clone(),this}},lY=class extends AC{constructor(){super(new IO(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},cY=class extends Kx{constructor(r,e){super(r,e),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Fa.DEFAULT_UP),this.updateMatrix(),this.target=new Fa,this.shadow=new lY}dispose(){this.shadow.dispose()}copy(r){return super.copy(r),this.target=r.target.clone(),this.shadow=r.shadow.clone(),this}},uY=class extends Kx{constructor(r,e){super(r,e),this.isAmbientLight=!0,this.type="AmbientLight"}};class hY{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let i="";for(let n=0,s=e.length;n<s;n++)i+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(i))}catch{return i}}static extractUrlBase(e){const i=e.lastIndexOf("/");return i===-1?"./":e.slice(0,i+1)}static resolveURL(e,i){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(i)&&/^\//.test(e)&&(i=i.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:i+e)}}const vC="\\[\\]\\.:\\/",dY=new RegExp("["+vC+"]","g"),xC="[^"+vC+"]",pY="[^"+vC.replace("\\.","")+"]",fY=/((?:WC+[\/:])*)/.source.replace("WC",xC),mY=/(WCOD+)?/.source.replace("WCOD",pY),gY=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",xC),AY=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",xC),yY=new RegExp("^"+fY+mY+gY+AY+"$"),vY=["material","materials","bones","map"];class xY{constructor(e,i,n){const s=n||Hn.parseTrackName(i);this._targetGroup=e,this._bindings=e.subscribe_(i,s)}getValue(e,i){this.bind();const n=this._targetGroup.nCachedObjects_,s=this._bindings[n];s!==void 0&&s.getValue(e,i)}setValue(e,i){const n=this._bindings;for(let s=this._targetGroup.nCachedObjects_,o=n.length;s!==o;++s)n[s].setValue(e,i)}bind(){const e=this._bindings;for(let i=this._targetGroup.nCachedObjects_,n=e.length;i!==n;++i)e[i].bind()}unbind(){const e=this._bindings;for(let i=this._targetGroup.nCachedObjects_,n=e.length;i!==n;++i)e[i].unbind()}}class Hn{constructor(e,i,n){this.path=i,this.parsedPath=n||Hn.parseTrackName(i),this.node=Hn.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,i,n){return e&&e.isAnimationObjectGroup?new Hn.Composite(e,i,n):new Hn(e,i,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(dY,"")}static parseTrackName(e){const i=yY.exec(e);if(i===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},s=n.nodeName&&n.nodeName.lastIndexOf(".");if(s!==void 0&&s!==-1){const o=n.nodeName.substring(s+1);vY.indexOf(o)!==-1&&(n.nodeName=n.nodeName.substring(0,s),n.objectName=o)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,i){if(i===void 0||i===""||i==="."||i===-1||i===e.name||i===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(i);if(n!==void 0)return n}if(e.children){const n=function(o){for(let l=0;l<o.length;l++){const u=o[l];if(u.name===i||u.uuid===i)return u;const c=n(u.children);if(c)return c}return null},s=n(e.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,i){e[i]=this.targetObject[this.propertyName]}_getValue_array(e,i){const n=this.resolvedProperty;for(let s=0,o=n.length;s!==o;++s)e[i++]=n[s]}_getValue_arrayElement(e,i){e[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,i){this.resolvedProperty.toArray(e,i)}_setValue_direct(e,i){this.targetObject[this.propertyName]=e[i]}_setValue_direct_setNeedsUpdate(e,i){this.targetObject[this.propertyName]=e[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,i){this.targetObject[this.propertyName]=e[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,i){const n=this.resolvedProperty;for(let s=0,o=n.length;s!==o;++s)n[s]=e[i++]}_setValue_array_setNeedsUpdate(e,i){const n=this.resolvedProperty;for(let s=0,o=n.length;s!==o;++s)n[s]=e[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,i){const n=this.resolvedProperty;for(let s=0,o=n.length;s!==o;++s)n[s]=e[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,i){this.resolvedProperty[this.propertyIndex]=e[i]}_setValue_arrayElement_setNeedsUpdate(e,i){this.resolvedProperty[this.propertyIndex]=e[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,i){this.resolvedProperty[this.propertyIndex]=e[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,i){this.resolvedProperty.fromArray(e,i)}_setValue_fromArray_setNeedsUpdate(e,i){this.resolvedProperty.fromArray(e,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,i){this.resolvedProperty.fromArray(e,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,i){this.bind(),this.getValue(e,i)}_setValue_unbound(e,i){this.bind(),this.setValue(e,i)}bind(){let e=this.node;const i=this.parsedPath,n=i.objectName,s=i.propertyName;let o=i.propertyIndex;if(e||(e=Hn.findNode(this.rootNode,i.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(n){let h=i.objectIndex;switch(n){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let p=0;p<e.length;p++)if(e[p].name===h){h=p;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[n]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(h!==void 0){if(e[h]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[h]}}const l=e[s];if(l===void 0){const h=i.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+h+"."+s+" but it wasn't found.",e);return}let u=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?u=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(u=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(o!==void 0){if(s==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[o]!==void 0&&(o=e.morphTargetDictionary[o])}c=this.BindingType.ArrayElement,this.resolvedProperty=l,this.propertyIndex=o}else l.fromArray!==void 0&&l.toArray!==void 0?(c=this.BindingType.HasFromToArray,this.resolvedProperty=l):Array.isArray(l)?(c=this.BindingType.EntireArray,this.resolvedProperty=l):this.propertyName=s;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][u]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Hn.Composite=xY,Hn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Hn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Hn.prototype.GetterByBindingType=[Hn.prototype._getValue_direct,Hn.prototype._getValue_array,Hn.prototype._getValue_arrayElement,Hn.prototype._getValue_toArray],Hn.prototype.SetterByBindingTypeAndVersioning=[[Hn.prototype._setValue_direct,Hn.prototype._setValue_direct_setNeedsUpdate,Hn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Hn.prototype._setValue_array,Hn.prototype._setValue_array_setNeedsUpdate,Hn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Hn.prototype._setValue_arrayElement,Hn.prototype._setValue_arrayElement_setNeedsUpdate,Hn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Hn.prototype._setValue_fromArray,Hn.prototype._setValue_fromArray_setNeedsUpdate,Hn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:kD}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=kD);/*!
fflate - fast JavaScript compression/decompression
<https://101arrowz.github.io/fflate>
Licensed under MIT. https://github.com/101arrowz/fflate/blob/master/LICENSE
version 0.8.2
*/var Bl=Uint8Array,cA=Uint16Array,bY=Int32Array,eP=new Bl([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),tP=new Bl([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),_Y=new Bl([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),iP=function(r,e){for(var i=new cA(31),n=0;n<31;++n)i[n]=e+=1<<r[n-1];for(var s=new bY(i[30]),n=1;n<30;++n)for(var o=i[n];o<i[n+1];++o)s[o]=o-i[n]<<5|n;return{b:i,r:s}},rP=iP(eP,2),nP=rP.b,EY=rP.r;nP[28]=258,EY[258]=28;for(var wY=iP(tP,0),CY=wY.b,sP=new cA(32768),gs=0;gs<32768;++gs){var zh=(gs&43690)>>1|(gs&21845)<<1;zh=(zh&52428)>>2|(zh&13107)<<2,zh=(zh&61680)>>4|(zh&3855)<<4,sP[gs]=((zh&65280)>>8|(zh&255)<<8)>>1}for(var uA=function(r,e,i){for(var n=r.length,s=0,o=new cA(e);s<n;++s)r[s]&&++o[r[s]-1];var l=new cA(e);for(s=1;s<e;++s)l[s]=l[s-1]+o[s-1]<<1;var u;{u=new cA(1<<e);var c=15-e;for(s=0;s<n;++s)if(r[s])for(var h=s<<4|r[s],p=e-r[s],f=l[r[s]-1]++<<p,m=f|(1<<p)-1;f<=m;++f)u[sP[f]>>c]=h}return u},hA=new Bl(288),gs=0;gs<144;++gs)hA[gs]=8;for(var gs=144;gs<256;++gs)hA[gs]=9;for(var gs=256;gs<280;++gs)hA[gs]=7;for(var gs=280;gs<288;++gs)hA[gs]=8;for(var aP=new Bl(32),gs=0;gs<32;++gs)aP[gs]=5;var SY=uA(hA,9),TY=uA(aP,5),bC=function(r){for(var e=r[0],i=1;i<r.length;++i)r[i]>e&&(e=r[i]);return e},$l=function(r,e,i){var n=e/8|0;return(r[n]|r[n+1]<<8)>>(e&7)&i},_C=function(r,e){var i=e/8|0;return(r[i]|r[i+1]<<8|r[i+2]<<16)>>(e&7)},MY=function(r){return(r+7)/8|0},RY=function(r,e,i){return(i==null||i>r.length)&&(i=r.length),new Bl(r.subarray(e,i))},IY=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ec=function(r,e,i){var n=new Error(e||IY[r]);if(n.code=r,Error.captureStackTrace&&Error.captureStackTrace(n,ec),!i)throw n;return n},BY=function(r,e,i,n){var s=r.length,o=0;if(!s||e.f&&!e.l)return i||new Bl(0);var l=!i,u=l||e.i!=2,c=e.i;l&&(i=new Bl(s*3));var h=function(Gt){var gt=i.length;if(Gt>gt){var xi=new Bl(Math.max(gt*2,Gt));xi.set(i),i=xi}},p=e.f||0,f=e.p||0,m=e.b||0,g=e.l,y=e.d,x=e.m,v=e.n,_=s*8;do{if(!g){p=$l(r,f,1);var T=$l(r,f+1,3);if(f+=3,T)if(T==1)g=SY,y=TY,x=9,v=5;else if(T==2){var w=$l(r,f,31)+257,S=$l(r,f+10,15)+4,R=w+$l(r,f+5,31)+1;f+=14;for(var B=new Bl(R),I=new Bl(19),D=0;D<S;++D)I[_Y[D]]=$l(r,f+D*3,7);f+=S*3;for(var L=bC(I),O=(1<<L)-1,U=uA(I,L),D=0;D<R;){var Z=U[$l(r,f,O)];f+=Z&15;var G=Z>>4;if(G<16)B[D++]=G;else{var z=0,$=0;for(G==16?($=3+$l(r,f,3),f+=2,z=B[D-1]):G==17?($=3+$l(r,f,7),f+=3):G==18&&($=11+$l(r,f,127),f+=7);$--;)B[D++]=z}}var Q=B.subarray(0,w),H=B.subarray(w);x=bC(Q),v=bC(H),g=uA(Q,x),y=uA(H,v)}else ec(1);else{var G=MY(f)+4,V=r[G-4]|r[G-3]<<8,ne=G+V;if(ne>s){c&&ec(0);break}u&&h(m+V),i.set(r.subarray(G,ne),m),e.b=m+=V,e.p=f=ne*8,e.f=p;continue}if(f>_){c&&ec(0);break}}u&&h(m+131072);for(var Y=(1<<x)-1,ae=(1<<v)-1,xe=f;;xe=f){var z=g[_C(r,f)&Y],fe=z>>4;if(f+=z&15,f>_){c&&ec(0);break}if(z||ec(2),fe<256)i[m++]=fe;else if(fe==256){xe=f,g=null;break}else{var de=fe-254;if(fe>264){var D=fe-257,Ie=eP[D];de=$l(r,f,(1<<Ie)-1)+nP[D],f+=Ie}var Ge=y[_C(r,f)&ae],Xe=Ge>>4;Ge||ec(3),f+=Ge&15;var H=CY[Xe];if(Xe>3){var Ie=tP[Xe];H+=_C(r,f)&(1<<Ie)-1,f+=Ie}if(f>_){c&&ec(0);break}u&&h(m+131072);var $e=m+de;if(m<H){var lt=o-H,At=Math.min(H,$e);for(lt+m<0&&ec(3);m<At;++m)i[m]=n[lt+m]}for(;m<$e;++m)i[m]=i[m-H]}}e.l=g,e.p=xe,e.b=m,e.f=p,g&&(p=1,e.m=x,e.d=y,e.n=v)}while(!p);return m!=i.length&&l?RY(i,0,m):i.subarray(0,m)},NY=new Bl(0),LY=function(r,e){return((r[0]&15)!=8||r[0]>>4>7||(r[0]<<8|r[1])%31)&&ec(6,"invalid zlib data"),(r[1]>>5&1)==1&&ec(6,"invalid zlib data: "+(r[1]&32?"need":"unexpected")+" dictionary"),(r[1]>>3&4)+2};function DY(r,e){return BY(r.subarray(LY(r),-4),{i:2},e,e)}var OY=typeof TextDecoder<"u"&&new TextDecoder,PY=0;try{OY.decode(NY,{stream:!0}),PY=1}catch{}function oP(r,e,i){const n=i.length-r-1;if(e>=i[n])return n-1;if(e<=i[r])return r;let s=r,o=n,l=Math.floor((s+o)/2);for(;e<i[l]||e>=i[l+1];)e<i[l]?o=l:s=l,l=Math.floor((s+o)/2);return l}function kY(r,e,i,n){const s=[],o=[],l=[];s[0]=1;for(let u=1;u<=i;++u){o[u]=e-n[r+1-u],l[u]=n[r+u]-e;let c=0;for(let h=0;h<u;++h){const p=l[h+1],f=o[u-h],m=s[h]/(p+f);s[h]=c+p*m,c=f*m}s[u]=c}return s}function FY(r,e,i,n){const s=oP(r,n,e),o=kY(s,n,r,e),l=new Fo(0,0,0,0);for(let u=0;u<=r;++u){const c=i[s-r+u],h=o[u],p=c.w*h;l.x+=c.x*p,l.y+=c.y*p,l.z+=c.z*p,l.w+=c.w*h}return l}function UY(r,e,i,n,s){const o=[];for(let f=0;f<=i;++f)o[f]=0;const l=[];for(let f=0;f<=n;++f)l[f]=o.slice(0);const u=[];for(let f=0;f<=i;++f)u[f]=o.slice(0);u[0][0]=1;const c=o.slice(0),h=o.slice(0);for(let f=1;f<=i;++f){c[f]=e-s[r+1-f],h[f]=s[r+f]-e;let m=0;for(let g=0;g<f;++g){const y=h[g+1],x=c[f-g];u[f][g]=y+x;const v=u[g][f-1]/u[f][g];u[g][f]=m+y*v,m=x*v}u[f][f]=m}for(let f=0;f<=i;++f)l[0][f]=u[f][i];for(let f=0;f<=i;++f){let m=0,g=1;const y=[];for(let x=0;x<=i;++x)y[x]=o.slice(0);y[0][0]=1;for(let x=1;x<=n;++x){let v=0;const _=f-x,T=i-x;f>=x&&(y[g][0]=y[m][0]/u[T+1][_],v=y[g][0]*u[_][T]);const w=_>=-1?1:-_,S=f-1<=T?x-1:i-f;for(let B=w;B<=S;++B)y[g][B]=(y[m][B]-y[m][B-1])/u[T+1][_+B],v+=y[g][B]*u[_+B][T];f<=T&&(y[g][x]=-y[m][x-1]/u[T+1][f],v+=y[g][x]*u[f][T]),l[x][f]=v;const R=m;m=g,g=R}}let p=i;for(let f=1;f<=n;++f){for(let m=0;m<=i;++m)l[f][m]*=p;p*=i-f}return l}function zY(r,e,i,n,s){const o=s<r?s:r,l=[],u=oP(r,n,e),c=UY(u,n,r,o,e),h=[];for(let p=0;p<i.length;++p){const f=i[p].clone(),m=f.w;f.x*=m,f.y*=m,f.z*=m,h[p]=f}for(let p=0;p<=o;++p){const f=h[u-r].clone().multiplyScalar(c[p][0]);for(let m=1;m<=r;++m)f.add(h[u-r+m].clone().multiplyScalar(c[p][m]));l[p]=f}for(let p=o+1;p<=s+1;++p)l[p]=new Fo(0,0,0);return l}function jY(r,e){let i=1;for(let s=2;s<=r;++s)i*=s;let n=1;for(let s=2;s<=e;++s)n*=s;for(let s=2;s<=r-e;++s)n*=s;return i/n}function VY(r){const e=r.length,i=[],n=[];for(let o=0;o<e;++o){const l=r[o];i[o]=new Lt(l.x,l.y,l.z),n[o]=l.w}const s=[];for(let o=0;o<e;++o){const l=i[o].clone();for(let u=1;u<=o;++u)l.sub(s[o-u].clone().multiplyScalar(jY(o,u)*n[u]));s[o]=l.divideScalar(n[0])}return s}function GY(r,e,i,n,s){const o=zY(r,e,i,n,s);return VY(o)}class HY extends CX{constructor(e,i,n,s,o){super(),this.degree=e,this.knots=i,this.controlPoints=[],this.startKnot=s||0,this.endKnot=o||this.knots.length-1;for(let l=0;l<n.length;++l){const u=n[l];this.controlPoints[l]=new Fo(u.x,u.y,u.z,u.w)}}getPoint(e,i=new Lt){const n=i,s=this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]),o=FY(this.degree,this.knots,this.controlPoints,s);return o.w!==1&&o.divideScalar(o.w),n.set(o.x,o.y,o.z)}getTangent(e,i=new Lt){const n=i,s=this.knots[0]+e*(this.knots[this.knots.length-1]-this.knots[0]),o=GY(this.degree,this.knots,this.controlPoints,s,1);return n.copy(o[1]).normalize(),n}}let mn,Ws,yo;class WY extends sp{constructor(e){super(e)}load(e,i,n,s){const o=this,l=o.path===""?hY.extractUrlBase(e):o.path,u=new iY(this.manager);u.setPath(o.path),u.setResponseType("arraybuffer"),u.setRequestHeader(o.requestHeader),u.setWithCredentials(o.withCredentials),u.load(e,function(c){try{i(o.parse(c,l))}catch(h){s?s(h):console.error(h),o.manager.itemError(e)}},n,s)}parse(e,i){if(JY(e))mn=new KY().parse(e);else{const s=pP(e);if(!ZY(s))throw new Error("THREE.FBXLoader: Unknown format.");if(uP(s)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+uP(s));mn=new YY().parse(s)}const n=new nY(this.manager).setPath(this.resourcePath||i).setCrossOrigin(this.crossOrigin);return new QY(n,this.manager).parse(mn)}}class QY{constructor(e,i){this.textureLoader=e,this.manager=i}parse(){Ws=this.parseConnections();const e=this.parseImages(),i=this.parseTextures(e),n=this.parseMaterials(i),s=this.parseDeformers(),o=new qY().parse(s);return this.parseScene(s,o,n),yo}parseConnections(){const e=new Map;return"Connections"in mn&&mn.Connections.connections.forEach(function(i){const n=i[0],s=i[1],o=i[2];e.has(n)||e.set(n,{parents:[],children:[]});const l={ID:s,relationship:o};e.get(n).parents.push(l),e.has(s)||e.set(s,{parents:[],children:[]});const u={ID:n,relationship:o};e.get(s).children.push(u)}),e}parseImages(){const e={},i={};if("Video"in mn.Objects){const n=mn.Objects.Video;for(const s in n){const o=n[s],l=parseInt(s);if(e[l]=o.RelativeFilename||o.Filename,"Content"in o){const u=o.Content instanceof ArrayBuffer&&o.Content.byteLength>0,c=typeof o.Content=="string"&&o.Content!=="";if(u||c){const h=this.parseImage(n[s]);i[o.RelativeFilename||o.Filename]=h}}}}for(const n in e){const s=e[n];i[s]!==void 0?e[n]=i[s]:e[n]=e[n].split("\\").pop()}return e}parseImage(e){const i=e.Content,n=e.RelativeFilename||e.Filename,s=n.slice(n.lastIndexOf(".")+1).toLowerCase();let o;switch(s){case"bmp":o="image/bmp";break;case"jpg":case"jpeg":o="image/jpeg";break;case"png":o="image/png";break;case"tif":o="image/tiff";break;case"tga":this.manager.getHandler(".tga")===null&&console.warn("FBXLoader: TGA loader not found, skipping ",n),o="image/tga";break;default:console.warn('FBXLoader: Image type "'+s+'" is not supported.');return}if(typeof i=="string")return"data:"+o+";base64,"+i;{const l=new Uint8Array(i);return window.URL.createObjectURL(new Blob([l],{type:o}))}}parseTextures(e){const i=new Map;if("Texture"in mn.Objects){const n=mn.Objects.Texture;for(const s in n){const o=this.parseTexture(n[s],e);i.set(parseInt(s),o)}}return i}parseTexture(e,i){const n=this.loadTexture(e,i);n.ID=e.id,n.name=e.attrName;const s=e.WrapModeU,o=e.WrapModeV,l=s!==void 0?s.value:0,u=o!==void 0?o.value:0;if(n.wrapS=l===0?px:zf,n.wrapT=u===0?px:zf,"Scaling"in e){const c=e.Scaling.value;n.repeat.x=c[0],n.repeat.y=c[1]}if("Translation"in e){const c=e.Translation.value;n.offset.x=c[0],n.offset.y=c[1]}return n}loadTexture(e,i){let n;const s=this.textureLoader.path,o=Ws.get(e.id).children;o!==void 0&&o.length>0&&i[o[0].ID]!==void 0&&(n=i[o[0].ID],(n.indexOf("blob:")===0||n.indexOf("data:")===0)&&this.textureLoader.setPath(void 0));let l;const u=e.FileName.slice(-3).toLowerCase();if(u==="tga"){const c=this.manager.getHandler(".tga");c===null?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",e.RelativeFilename),l=new hu):(c.setPath(this.textureLoader.path),l=c.load(n))}else if(u==="dds"){const c=this.manager.getHandler(".dds");c===null?(console.warn("FBXLoader: DDS loader not found, creating placeholder texture for",e.RelativeFilename),l=new hu):(c.setPath(this.textureLoader.path),l=c.load(n))}else u==="psd"?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",e.RelativeFilename),l=new hu):l=this.textureLoader.load(n);return this.textureLoader.setPath(s),l}parseMaterials(e){const i=new Map;if("Material"in mn.Objects){const n=mn.Objects.Material;for(const s in n){const o=this.parseMaterial(n[s],e);o!==null&&i.set(parseInt(s),o)}}return i}parseMaterial(e,i){const n=e.id,s=e.attrName;let o=e.ShadingModel;if(typeof o=="object"&&(o=o.value),!Ws.has(n))return null;const l=this.parseParameters(e,i,n);let u;switch(o.toLowerCase()){case"phong":u=new mC;break;case"lambert":u=new GX;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',o),u=new mC;break}return u.setValues(l),u.name=s,u}parseParameters(e,i,n){const s={};e.BumpFactor&&(s.bumpScale=e.BumpFactor.value),e.Diffuse?s.color=new Ys().fromArray(e.Diffuse.value).convertSRGBToLinear():e.DiffuseColor&&(e.DiffuseColor.type==="Color"||e.DiffuseColor.type==="ColorRGB")&&(s.color=new Ys().fromArray(e.DiffuseColor.value).convertSRGBToLinear()),e.DisplacementFactor&&(s.displacementScale=e.DisplacementFactor.value),e.Emissive?s.emissive=new Ys().fromArray(e.Emissive.value).convertSRGBToLinear():e.EmissiveColor&&(e.EmissiveColor.type==="Color"||e.EmissiveColor.type==="ColorRGB")&&(s.emissive=new Ys().fromArray(e.EmissiveColor.value).convertSRGBToLinear()),e.EmissiveFactor&&(s.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),e.Opacity&&(s.opacity=parseFloat(e.Opacity.value)),s.opacity<1&&(s.transparent=!0),e.ReflectionFactor&&(s.reflectivity=e.ReflectionFactor.value),e.Shininess&&(s.shininess=e.Shininess.value),e.Specular?s.specular=new Ys().fromArray(e.Specular.value).convertSRGBToLinear():e.SpecularColor&&e.SpecularColor.type==="Color"&&(s.specular=new Ys().fromArray(e.SpecularColor.value).convertSRGBToLinear());const o=this;return Ws.get(n).children.forEach(function(l){const u=l.relationship;switch(u){case"Bump":s.bumpMap=o.getTexture(i,l.ID);break;case"Maya|TEX_ao_map":s.aoMap=o.getTexture(i,l.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":s.map=o.getTexture(i,l.ID),s.map!==void 0&&(s.map.colorSpace=Rl);break;case"DisplacementColor":s.displacementMap=o.getTexture(i,l.ID);break;case"EmissiveColor":s.emissiveMap=o.getTexture(i,l.ID),s.emissiveMap!==void 0&&(s.emissiveMap.colorSpace=Rl);break;case"NormalMap":case"Maya|TEX_normal_map":s.normalMap=o.getTexture(i,l.ID);break;case"ReflectionColor":s.envMap=o.getTexture(i,l.ID),s.envMap!==void 0&&(s.envMap.mapping=wq,s.envMap.colorSpace=Rl);break;case"SpecularColor":s.specularMap=o.getTexture(i,l.ID),s.specularMap!==void 0&&(s.specularMap.colorSpace=Rl);break;case"TransparentColor":case"TransparencyFactor":s.alphaMap=o.getTexture(i,l.ID),s.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",u);break}}),s}getTexture(e,i){return"LayeredTexture"in mn.Objects&&i in mn.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),i=Ws.get(i).children[0].ID),e.get(i)}parseDeformers(){const e={},i={};if("Deformer"in mn.Objects){const n=mn.Objects.Deformer;for(const s in n){const o=n[s],l=Ws.get(parseInt(s));if(o.attrType==="Skin"){const u=this.parseSkeleton(l,n);u.ID=s,l.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),u.geometryID=l.parents[0].ID,e[s]=u}else if(o.attrType==="BlendShape"){const u={id:s};u.rawTargets=this.parseMorphTargets(l,n),u.id=s,l.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),i[s]=u}}}return{skeletons:e,morphTargets:i}}parseSkeleton(e,i){const n=[];return e.children.forEach(function(s){const o=i[s.ID];if(o.attrType!=="Cluster")return;const l={ID:s.ID,indices:[],weights:[],transformLink:new Qr().fromArray(o.TransformLink.a)};"Indexes"in o&&(l.indices=o.Indexes.a,l.weights=o.Weights.a),n.push(l)}),{rawBones:n,bones:[]}}parseMorphTargets(e,i){const n=[];for(let s=0;s<e.children.length;s++){const o=e.children[s],l=i[o.ID],u={name:l.attrName,initialWeight:l.DeformPercent,id:l.id,fullWeights:l.FullWeights.a};if(l.attrType!=="BlendShapeChannel")return;u.geoID=Ws.get(parseInt(o.ID)).children.filter(function(c){return c.relationship===void 0})[0].ID,n.push(u)}return n}parseScene(e,i,n){yo=new BO;const s=this.parseModels(e.skeletons,i,n),o=mn.Objects.Model,l=this;s.forEach(function(c){const h=o[c.ID];l.setLookAtProperties(c,h),Ws.get(c.ID).parents.forEach(function(p){const f=s.get(p.ID);f!==void 0&&f.add(c)}),c.parent===null&&yo.add(c)}),this.bindSkeleton(e.skeletons,i,s),this.addGlobalSceneSettings(),yo.traverse(function(c){if(c.userData.transformData){c.parent&&(c.userData.transformData.parentMatrix=c.parent.matrix,c.userData.transformData.parentMatrixWorld=c.parent.matrixWorld);const h=hP(c.userData.transformData);c.applyMatrix4(h),c.updateWorldMatrix()}});const u=new XY().parse();yo.children.length===1&&yo.children[0].isGroup&&(yo.children[0].animations=u,yo=yo.children[0]),yo.animations=u}parseModels(e,i,n){const s=new Map,o=mn.Objects.Model;for(const l in o){const u=parseInt(l),c=o[l],h=Ws.get(u);let p=this.buildSkeleton(h,e,u,c.attrName);if(!p){switch(c.attrType){case"Camera":p=this.createCamera(h);break;case"Light":p=this.createLight(h);break;case"Mesh":p=this.createMesh(h,i,n);break;case"NurbsCurve":p=this.createCurve(h,i);break;case"LimbNode":case"Root":p=new cC;break;case"Null":default:p=new BO;break}p.name=c.attrName?Hn.sanitizeNodeName(c.attrName):"",p.userData.originalName=c.attrName,p.ID=u}this.getTransformData(p,c),s.set(u,p)}return s}buildSkeleton(e,i,n,s){let o=null;return e.parents.forEach(function(l){for(const u in i){const c=i[u];c.rawBones.forEach(function(h,p){if(h.ID===l.ID){const f=o;o=new cC,o.matrixWorld.copy(h.transformLink),o.name=s?Hn.sanitizeNodeName(s):"",o.userData.originalName=s,o.ID=n,c.bones[p]=o,f!==null&&o.add(f)}})}}),o}createCamera(e){let i,n;if(e.children.forEach(function(s){const o=mn.Objects.NodeAttribute[s.ID];o!==void 0&&(n=o)}),n===void 0)i=new Fa;else{let s=0;n.CameraProjectionType!==void 0&&n.CameraProjectionType.value===1&&(s=1);let o=1;n.NearPlane!==void 0&&(o=n.NearPlane.value/1e3);let l=1e3;n.FarPlane!==void 0&&(l=n.FarPlane.value/1e3);let u=window.innerWidth,c=window.innerHeight;n.AspectWidth!==void 0&&n.AspectHeight!==void 0&&(u=n.AspectWidth.value,c=n.AspectHeight.value);const h=u/c;let p=45;n.FieldOfView!==void 0&&(p=n.FieldOfView.value);const f=n.FocalLength?n.FocalLength.value:null;switch(s){case 0:i=new sC(p,h,o,l),f!==null&&i.setFocalLength(f);break;case 1:i=new IO(-u/2,u/2,c/2,-c/2,o,l);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+s+"."),i=new Fa;break}}return i}createLight(e){let i,n;if(e.children.forEach(function(s){const o=mn.Objects.NodeAttribute[s.ID];o!==void 0&&(n=o)}),n===void 0)i=new Fa;else{let s;n.LightType===void 0?s=0:s=n.LightType.value;let o=16777215;n.Color!==void 0&&(o=new Ys().fromArray(n.Color.value).convertSRGBToLinear());let l=n.Intensity===void 0?1:n.Intensity.value/100;n.CastLightOnObject!==void 0&&n.CastLightOnObject.value===0&&(l=0);let u=0;n.FarAttenuationEnd!==void 0&&(n.EnableFarAttenuation!==void 0&&n.EnableFarAttenuation.value===0?u=0:u=n.FarAttenuationEnd.value);const c=1;switch(s){case 0:i=new $O(o,l,u,c);break;case 1:i=new cY(o,l);break;case 2:let h=Math.PI/3;n.InnerAngle!==void 0&&(h=go.degToRad(n.InnerAngle.value));let p=0;n.OuterAngle!==void 0&&(p=go.degToRad(n.OuterAngle.value),p=Math.max(p,1)),i=new aY(o,l,u,h,p,c);break;default:console.warn("THREE.FBXLoader: Unknown light type "+n.LightType.value+", defaulting to a PointLight."),i=new $O(o,l);break}n.CastShadows!==void 0&&n.CastShadows.value===1&&(i.castShadow=!0)}return i}createMesh(e,i,n){let s,o=null,l=null;const u=[];return e.children.forEach(function(c){i.has(c.ID)&&(o=i.get(c.ID)),n.has(c.ID)&&u.push(n.get(c.ID))}),u.length>1?l=u:u.length>0?l=u[0]:(l=new mC({name:sp.DEFAULT_MATERIAL_NAME,color:13421772}),u.push(l)),"color"in o.attributes&&u.forEach(function(c){c.vertexColors=!0}),o.FBX_Deformer?(s=new bX(o,l),s.normalizeSkinWeights()):s=new SO(o,l),s}createCurve(e,i){const n=e.children.reduce(function(o,l){return i.has(l.ID)&&(o=i.get(l.ID)),o},null),s=new FO({name:sp.DEFAULT_MATERIAL_NAME,color:3342591,linewidth:1});return new wX(n,s)}getTransformData(e,i){const n={};"InheritType"in i&&(n.inheritType=parseInt(i.InheritType.value)),"RotationOrder"in i?n.eulerOrder=dP(i.RotationOrder.value):n.eulerOrder="ZYX","Lcl_Translation"in i&&(n.translation=i.Lcl_Translation.value),"PreRotation"in i&&(n.preRotation=i.PreRotation.value),"Lcl_Rotation"in i&&(n.rotation=i.Lcl_Rotation.value),"PostRotation"in i&&(n.postRotation=i.PostRotation.value),"Lcl_Scaling"in i&&(n.scale=i.Lcl_Scaling.value),"ScalingOffset"in i&&(n.scalingOffset=i.ScalingOffset.value),"ScalingPivot"in i&&(n.scalingPivot=i.ScalingPivot.value),"RotationOffset"in i&&(n.rotationOffset=i.RotationOffset.value),"RotationPivot"in i&&(n.rotationPivot=i.RotationPivot.value),e.userData.transformData=n}setLookAtProperties(e,i){"LookAtProperty"in i&&Ws.get(e.ID).children.forEach(function(n){if(n.relationship==="LookAtProperty"){const s=mn.Objects.Model[n.ID];if("Lcl_Translation"in s){const o=s.Lcl_Translation.value;e.target!==void 0?(e.target.position.fromArray(o),yo.add(e.target)):e.lookAt(new Lt().fromArray(o))}}})}bindSkeleton(e,i,n){const s=this.parsePoseNodes();for(const o in e){const l=e[o];Ws.get(parseInt(l.ID)).parents.forEach(function(u){if(i.has(u.ID)){const c=u.ID;Ws.get(c).parents.forEach(function(h){n.has(h.ID)&&n.get(h.ID).bind(new uC(l.bones),s[h.ID])})}})}}parsePoseNodes(){const e={};if("Pose"in mn.Objects){const i=mn.Objects.Pose;for(const n in i)if(i[n].attrType==="BindPose"&&i[n].NbPoseNodes>0){const s=i[n].PoseNode;Array.isArray(s)?s.forEach(function(o){e[o.Node]=new Qr().fromArray(o.Matrix.a)}):e[s.Node]=new Qr().fromArray(s.Matrix.a)}}return e}addGlobalSceneSettings(){if("GlobalSettings"in mn){if("AmbientColor"in mn.GlobalSettings){const e=mn.GlobalSettings.AmbientColor.value,i=e[0],n=e[1],s=e[2];if(i!==0||n!==0||s!==0){const o=new Ys(i,n,s).convertSRGBToLinear();yo.add(new uY(o,1))}}"UnitScaleFactor"in mn.GlobalSettings&&(yo.userData.unitScaleFactor=mn.GlobalSettings.UnitScaleFactor.value)}}}class qY{constructor(){this.negativeMaterialIndices=!1}parse(e){const i=new Map;if("Geometry"in mn.Objects){const n=mn.Objects.Geometry;for(const s in n){const o=Ws.get(parseInt(s)),l=this.parseGeometry(o,n[s],e);i.set(parseInt(s),l)}}return this.negativeMaterialIndices===!0&&console.warn("THREE.FBXLoader: The FBX file contains invalid (negative) material indices. The asset might not render as expected."),i}parseGeometry(e,i,n){switch(i.attrType){case"Mesh":return this.parseMeshGeometry(e,i,n);case"NurbsCurve":return this.parseNurbsGeometry(i)}}parseMeshGeometry(e,i,n){const s=n.skeletons,o=[],l=e.parents.map(function(f){return mn.Objects.Model[f.ID]});if(l.length===0)return;const u=e.children.reduce(function(f,m){return s[m.ID]!==void 0&&(f=s[m.ID]),f},null);e.children.forEach(function(f){n.morphTargets[f.ID]!==void 0&&o.push(n.morphTargets[f.ID])});const c=l[0],h={};"RotationOrder"in c&&(h.eulerOrder=dP(c.RotationOrder.value)),"InheritType"in c&&(h.inheritType=parseInt(c.InheritType.value)),"GeometricTranslation"in c&&(h.translation=c.GeometricTranslation.value),"GeometricRotation"in c&&(h.rotation=c.GeometricRotation.value),"GeometricScaling"in c&&(h.scale=c.GeometricScaling.value);const p=hP(h);return this.genGeometry(i,u,o,p)}genGeometry(e,i,n,s){const o=new tA;e.attrName&&(o.name=e.attrName);const l=this.parseGeoNode(e,i),u=this.genBuffers(l),c=new Fh(u.vertex,3);if(c.applyMatrix4(s),o.setAttribute("position",c),u.colors.length>0&&o.setAttribute("color",new Fh(u.colors,3)),i&&(o.setAttribute("skinIndex",new xO(u.weightsIndices,4)),o.setAttribute("skinWeight",new Fh(u.vertexWeights,4)),o.FBX_Deformer=i),u.normal.length>0){const h=new Nh().getNormalMatrix(s),p=new Fh(u.normal,3);p.applyNormalMatrix(h),o.setAttribute("normal",p)}if(u.uvs.forEach(function(h,p){const f=p===0?"uv":`uv${p}`;o.setAttribute(f,new Fh(u.uvs[p],2))}),l.material&&l.material.mappingType!=="AllSame"){let h=u.materialIndex[0],p=0;if(u.materialIndex.forEach(function(f,m){f!==h&&(o.addGroup(p,m-p,h),h=f,p=m)}),o.groups.length>0){const f=o.groups[o.groups.length-1],m=f.start+f.count;m!==u.materialIndex.length&&o.addGroup(m,u.materialIndex.length-m,h)}o.groups.length===0&&o.addGroup(0,u.materialIndex.length,u.materialIndex[0])}return this.addMorphTargets(o,e,n,s),o}parseGeoNode(e,i){const n={};if(n.vertexPositions=e.Vertices!==void 0?e.Vertices.a:[],n.vertexIndices=e.PolygonVertexIndex!==void 0?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(n.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(n.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(n.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){n.uv=[];let s=0;for(;e.LayerElementUV[s];)e.LayerElementUV[s].UV&&n.uv.push(this.parseUVs(e.LayerElementUV[s])),s++}return n.weightTable={},i!==null&&(n.skeleton=i,i.rawBones.forEach(function(s,o){s.indices.forEach(function(l,u){n.weightTable[l]===void 0&&(n.weightTable[l]=[]),n.weightTable[l].push({id:o,weight:s.weights[u]})})})),n}genBuffers(e){const i={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let n=0,s=0,o=!1,l=[],u=[],c=[],h=[],p=[],f=[];const m=this;return e.vertexIndices.forEach(function(g,y){let x,v=!1;g<0&&(g=g^-1,v=!0);let _=[],T=[];if(l.push(g*3,g*3+1,g*3+2),e.color){const w=Jx(y,n,g,e.color);c.push(w[0],w[1],w[2])}if(e.skeleton){if(e.weightTable[g]!==void 0&&e.weightTable[g].forEach(function(w){T.push(w.weight),_.push(w.id)}),T.length>4){o||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),o=!0);const w=[0,0,0,0],S=[0,0,0,0];T.forEach(function(R,B){let I=R,D=_[B];S.forEach(function(L,O,U){if(I>L){U[O]=I,I=L;const Z=w[O];w[O]=D,D=Z}})}),_=w,T=S}for(;T.length<4;)T.push(0),_.push(0);for(let w=0;w<4;++w)p.push(T[w]),f.push(_[w])}if(e.normal){const w=Jx(y,n,g,e.normal);u.push(w[0],w[1],w[2])}e.material&&e.material.mappingType!=="AllSame"&&(x=Jx(y,n,g,e.material)[0],x<0&&(m.negativeMaterialIndices=!0,x=0)),e.uv&&e.uv.forEach(function(w,S){const R=Jx(y,n,g,w);h[S]===void 0&&(h[S]=[]),h[S].push(R[0]),h[S].push(R[1])}),s++,v&&(m.genFace(i,e,l,x,u,c,h,p,f,s),n++,s=0,l=[],u=[],c=[],h=[],p=[],f=[])}),i}getNormalNewell(e){const i=new Lt(0,0,0);for(let n=0;n<e.length;n++){const s=e[n],o=e[(n+1)%e.length];i.x+=(s.y-o.y)*(s.z+o.z),i.y+=(s.z-o.z)*(s.x+o.x),i.z+=(s.x-o.x)*(s.y+o.y)}return i.normalize(),i}getNormalTangentAndBitangent(e){const i=this.getNormalNewell(e),n=(Math.abs(i.z)>.5?new Lt(0,1,0):new Lt(0,0,1)).cross(i).normalize(),s=i.clone().cross(n).normalize();return{normal:i,tangent:n,bitangent:s}}flattenVertex(e,i,n){return new Hs(e.dot(i),e.dot(n))}genFace(e,i,n,s,o,l,u,c,h,p){let f;if(p>3){const m=[];for(let v=0;v<n.length;v+=3)m.push(new Lt(i.vertexPositions[n[v]],i.vertexPositions[n[v+1]],i.vertexPositions[n[v+2]]));const{tangent:g,bitangent:y}=this.getNormalTangentAndBitangent(m),x=[];for(const v of m)x.push(this.flattenVertex(v,g,y));f=fC.triangulateShape(x,[])}else f=[[0,1,2]];for(const[m,g,y]of f)e.vertex.push(i.vertexPositions[n[m*3]]),e.vertex.push(i.vertexPositions[n[m*3+1]]),e.vertex.push(i.vertexPositions[n[m*3+2]]),e.vertex.push(i.vertexPositions[n[g*3]]),e.vertex.push(i.vertexPositions[n[g*3+1]]),e.vertex.push(i.vertexPositions[n[g*3+2]]),e.vertex.push(i.vertexPositions[n[y*3]]),e.vertex.push(i.vertexPositions[n[y*3+1]]),e.vertex.push(i.vertexPositions[n[y*3+2]]),i.skeleton&&(e.vertexWeights.push(c[m*4]),e.vertexWeights.push(c[m*4+1]),e.vertexWeights.push(c[m*4+2]),e.vertexWeights.push(c[m*4+3]),e.vertexWeights.push(c[g*4]),e.vertexWeights.push(c[g*4+1]),e.vertexWeights.push(c[g*4+2]),e.vertexWeights.push(c[g*4+3]),e.vertexWeights.push(c[y*4]),e.vertexWeights.push(c[y*4+1]),e.vertexWeights.push(c[y*4+2]),e.vertexWeights.push(c[y*4+3]),e.weightsIndices.push(h[m*4]),e.weightsIndices.push(h[m*4+1]),e.weightsIndices.push(h[m*4+2]),e.weightsIndices.push(h[m*4+3]),e.weightsIndices.push(h[g*4]),e.weightsIndices.push(h[g*4+1]),e.weightsIndices.push(h[g*4+2]),e.weightsIndices.push(h[g*4+3]),e.weightsIndices.push(h[y*4]),e.weightsIndices.push(h[y*4+1]),e.weightsIndices.push(h[y*4+2]),e.weightsIndices.push(h[y*4+3])),i.color&&(e.colors.push(l[m*3]),e.colors.push(l[m*3+1]),e.colors.push(l[m*3+2]),e.colors.push(l[g*3]),e.colors.push(l[g*3+1]),e.colors.push(l[g*3+2]),e.colors.push(l[y*3]),e.colors.push(l[y*3+1]),e.colors.push(l[y*3+2])),i.material&&i.material.mappingType!=="AllSame"&&(e.materialIndex.push(s),e.materialIndex.push(s),e.materialIndex.push(s)),i.normal&&(e.normal.push(o[m*3]),e.normal.push(o[m*3+1]),e.normal.push(o[m*3+2]),e.normal.push(o[g*3]),e.normal.push(o[g*3+1]),e.normal.push(o[g*3+2]),e.normal.push(o[y*3]),e.normal.push(o[y*3+1]),e.normal.push(o[y*3+2])),i.uv&&i.uv.forEach(function(x,v){e.uvs[v]===void 0&&(e.uvs[v]=[]),e.uvs[v].push(u[v][m*2]),e.uvs[v].push(u[v][m*2+1]),e.uvs[v].push(u[v][g*2]),e.uvs[v].push(u[v][g*2+1]),e.uvs[v].push(u[v][y*2]),e.uvs[v].push(u[v][y*2+1])})}addMorphTargets(e,i,n,s){if(n.length===0)return;e.morphTargetsRelative=!0,e.morphAttributes.position=[];const o=this;n.forEach(function(l){l.rawTargets.forEach(function(u){const c=mn.Objects.Geometry[u.geoID];c!==void 0&&o.genMorphGeometry(e,i,c,s,u.name)})})}genMorphGeometry(e,i,n,s,o){const l=i.PolygonVertexIndex!==void 0?i.PolygonVertexIndex.a:[],u=n.Vertices!==void 0?n.Vertices.a:[],c=n.Indexes!==void 0?n.Indexes.a:[],h=e.attributes.position.count*3,p=new Float32Array(h);for(let y=0;y<c.length;y++){const x=c[y]*3;p[x]=u[y*3],p[x+1]=u[y*3+1],p[x+2]=u[y*3+2]}const f={vertexIndices:l,vertexPositions:p},m=this.genBuffers(f),g=new Fh(m.vertex,3);g.name=o||n.attrName,g.applyMatrix4(s),e.morphAttributes.position.push(g)}parseNormals(e){const i=e.MappingInformationType,n=e.ReferenceInformationType,s=e.Normals.a;let o=[];return n==="IndexToDirect"&&("NormalIndex"in e?o=e.NormalIndex.a:"NormalsIndex"in e&&(o=e.NormalsIndex.a)),{dataSize:3,buffer:s,indices:o,mappingType:i,referenceType:n}}parseUVs(e){const i=e.MappingInformationType,n=e.ReferenceInformationType,s=e.UV.a;let o=[];return n==="IndexToDirect"&&(o=e.UVIndex.a),{dataSize:2,buffer:s,indices:o,mappingType:i,referenceType:n}}parseVertexColors(e){const i=e.MappingInformationType,n=e.ReferenceInformationType,s=e.Colors.a;let o=[];n==="IndexToDirect"&&(o=e.ColorIndex.a);for(let l=0,u=new Ys;l<s.length;l+=4)u.fromArray(s,l).convertSRGBToLinear().toArray(s,l);return{dataSize:4,buffer:s,indices:o,mappingType:i,referenceType:n}}parseMaterialIndices(e){const i=e.MappingInformationType,n=e.ReferenceInformationType;if(i==="NoMappingInformation")return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:n};const s=e.Materials.a,o=[];for(let l=0;l<s.length;++l)o.push(l);return{dataSize:1,buffer:s,indices:o,mappingType:i,referenceType:n}}parseNurbsGeometry(e){const i=parseInt(e.Order);if(isNaN(i))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new tA;const n=i-1,s=e.KnotVector.a,o=[],l=e.Points.a;for(let p=0,f=l.length;p<f;p+=4)o.push(new Fo().fromArray(l,p));let u,c;if(e.Form==="Closed")o.push(o[0]);else if(e.Form==="Periodic"){u=n,c=s.length-1-u;for(let p=0;p<n;++p)o.push(o[p])}const h=new HY(n,s,o,u,c).getPoints(o.length*12);return new tA().setFromPoints(h)}}class XY{parse(){const e=[],i=this.parseClips();if(i!==void 0)for(const n in i){const s=i[n],o=this.addClip(s);e.push(o)}return e}parseClips(){if(mn.Objects.AnimationCurve===void 0)return;const e=this.parseAnimationCurveNodes();this.parseAnimationCurves(e);const i=this.parseAnimationLayers(e);return this.parseAnimStacks(i)}parseAnimationCurveNodes(){const e=mn.Objects.AnimationCurveNode,i=new Map;for(const n in e){const s=e[n];if(s.attrName.match(/S|R|T|DeformPercent/)!==null){const o={id:s.id,attr:s.attrName,curves:{}};i.set(o.id,o)}}return i}parseAnimationCurves(e){const i=mn.Objects.AnimationCurve;for(const n in i){const s={id:i[n].id,times:i[n].KeyTime.a.map($Y),values:i[n].KeyValueFloat.a},o=Ws.get(s.id);if(o!==void 0){const l=o.parents[0].ID,u=o.parents[0].relationship;u.match(/X/)?e.get(l).curves.x=s:u.match(/Y/)?e.get(l).curves.y=s:u.match(/Z/)?e.get(l).curves.z=s:u.match(/DeformPercent/)&&e.has(l)&&(e.get(l).curves.morph=s)}}}parseAnimationLayers(e){const i=mn.Objects.AnimationLayer,n=new Map;for(const s in i){const o=[],l=Ws.get(parseInt(s));l!==void 0&&(l.children.forEach(function(u,c){if(e.has(u.ID)){const h=e.get(u.ID);if(h.curves.x!==void 0||h.curves.y!==void 0||h.curves.z!==void 0){if(o[c]===void 0){const p=Ws.get(u.ID).parents.filter(function(f){return f.relationship!==void 0})[0].ID;if(p!==void 0){const f=mn.Objects.Model[p.toString()];if(f===void 0){console.warn("THREE.FBXLoader: Encountered a unused curve.",u);return}const m={modelName:f.attrName?Hn.sanitizeNodeName(f.attrName):"",ID:f.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};yo.traverse(function(g){g.ID===f.id&&(m.transform=g.matrix,g.userData.transformData&&(m.eulerOrder=g.userData.transformData.eulerOrder))}),m.transform||(m.transform=new Qr),"PreRotation"in f&&(m.preRotation=f.PreRotation.value),"PostRotation"in f&&(m.postRotation=f.PostRotation.value),o[c]=m}}o[c]&&(o[c][h.attr]=h)}else if(h.curves.morph!==void 0){if(o[c]===void 0){const p=Ws.get(u.ID).parents.filter(function(v){return v.relationship!==void 0})[0].ID,f=Ws.get(p).parents[0].ID,m=Ws.get(f).parents[0].ID,g=Ws.get(m).parents[0].ID,y=mn.Objects.Model[g],x={modelName:y.attrName?Hn.sanitizeNodeName(y.attrName):"",morphName:mn.Objects.Deformer[p].attrName};o[c]=x}o[c][h.attr]=h}}}),n.set(parseInt(s),o))}return n}parseAnimStacks(e){const i=mn.Objects.AnimationStack,n={};for(const s in i){const o=Ws.get(parseInt(s)).children;o.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const l=e.get(o[0].ID);n[s]={name:i[s].attrName,layer:l}}return n}addClip(e){let i=[];const n=this;return e.layer.forEach(function(s){i=i.concat(n.generateTracks(s))}),new KX(e.name,-1,i)}generateTracks(e){const i=[];let n=new Lt,s=new Lt;if(e.transform&&e.transform.decompose(n,new Uo,s),n=n.toArray(),s=s.toArray(),e.T!==void 0&&Object.keys(e.T.curves).length>0){const o=this.generateVectorTrack(e.modelName,e.T.curves,n,"position");o!==void 0&&i.push(o)}if(e.R!==void 0&&Object.keys(e.R.curves).length>0){const o=this.generateRotationTrack(e.modelName,e.R.curves,e.preRotation,e.postRotation,e.eulerOrder);o!==void 0&&i.push(o)}if(e.S!==void 0&&Object.keys(e.S.curves).length>0){const o=this.generateVectorTrack(e.modelName,e.S.curves,s,"scale");o!==void 0&&i.push(o)}if(e.DeformPercent!==void 0){const o=this.generateMorphTrack(e);o!==void 0&&i.push(o)}return i}generateVectorTrack(e,i,n,s){const o=this.getTimesForAllAxes(i),l=this.getKeyframeTrackValues(o,i,n);return new oA(e+"."+s,o,l)}generateRotationTrack(e,i,n,s,o){let l,u;if(i.x!==void 0&&i.y!==void 0&&i.z!==void 0){const f=this.interpolateRotations(i.x,i.y,i.z,o);l=f[0],u=f[1]}n!==void 0&&(n=n.map(go.degToRad),n.push(o),n=new Ao().fromArray(n),n=new Uo().setFromEuler(n)),s!==void 0&&(s=s.map(go.degToRad),s.push(o),s=new Ao().fromArray(s),s=new Uo().setFromEuler(s).invert());const c=new Uo,h=new Ao,p=[];if(!u||!l)return new np(e+".quaternion",[0],[0]);for(let f=0;f<u.length;f+=3)h.set(u[f],u[f+1],u[f+2],o),c.setFromEuler(h),n!==void 0&&c.premultiply(n),s!==void 0&&c.multiply(s),f>2&&new Uo().fromArray(p,(f-3)/3*4).dot(c)<0&&c.set(-c.x,-c.y,-c.z,-c.w),c.toArray(p,f/3*4);return new np(e+".quaternion",l,p)}generateMorphTrack(e){const i=e.DeformPercent.curves.morph,n=i.values.map(function(o){return o/100}),s=yo.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new aA(e.modelName+".morphTargetInfluences["+s+"]",i.times,n)}getTimesForAllAxes(e){let i=[];if(e.x!==void 0&&(i=i.concat(e.x.times)),e.y!==void 0&&(i=i.concat(e.y.times)),e.z!==void 0&&(i=i.concat(e.z.times)),i=i.sort(function(n,s){return n-s}),i.length>1){let n=1,s=i[0];for(let o=1;o<i.length;o++){const l=i[o];l!==s&&(i[n]=l,s=l,n++)}i=i.slice(0,n)}return i}getKeyframeTrackValues(e,i,n){const s=n,o=[];let l=-1,u=-1,c=-1;return e.forEach(function(h){if(i.x&&(l=i.x.times.indexOf(h)),i.y&&(u=i.y.times.indexOf(h)),i.z&&(c=i.z.times.indexOf(h)),l!==-1){const p=i.x.values[l];o.push(p),s[0]=p}else o.push(s[0]);if(u!==-1){const p=i.y.values[u];o.push(p),s[1]=p}else o.push(s[1]);if(c!==-1){const p=i.z.values[c];o.push(p),s[2]=p}else o.push(s[2])}),o}interpolateRotations(e,i,n,s){const o=[],l=[];o.push(e.times[0]),l.push(go.degToRad(e.values[0])),l.push(go.degToRad(i.values[0])),l.push(go.degToRad(n.values[0]));for(let u=1;u<e.values.length;u++){const c=[e.values[u-1],i.values[u-1],n.values[u-1]];if(isNaN(c[0])||isNaN(c[1])||isNaN(c[2]))continue;const h=c.map(go.degToRad),p=[e.values[u],i.values[u],n.values[u]];if(isNaN(p[0])||isNaN(p[1])||isNaN(p[2]))continue;const f=p.map(go.degToRad),m=[p[0]-c[0],p[1]-c[1],p[2]-c[2]],g=[Math.abs(m[0]),Math.abs(m[1]),Math.abs(m[2])];if(g[0]>=180||g[1]>=180||g[2]>=180){const y=Math.max(...g)/180,x=new Ao(...h,s),v=new Ao(...f,s),_=new Uo().setFromEuler(x),T=new Uo().setFromEuler(v);_.dot(T)&&T.set(-T.x,-T.y,-T.z,-T.w);const w=e.times[u-1],S=e.times[u]-w,R=new Uo,B=new Ao;for(let I=0;I<1;I+=1/y)R.copy(_.clone().slerp(T.clone(),I)),o.push(w+I*S),B.setFromQuaternion(R,s),l.push(B.x),l.push(B.y),l.push(B.z)}else o.push(e.times[u]),l.push(go.degToRad(e.values[u])),l.push(go.degToRad(i.values[u])),l.push(go.degToRad(n.values[u]))}return[o,l]}}class YY{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(e){this.nodeStack.push(e),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(e,i){this.currentProp=e,this.currentPropName=i}parse(e){this.currentIndent=0,this.allNodes=new cP,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const i=this,n=e.split(/[\r\n]+/);return n.forEach(function(s,o){const l=s.match(/^[\s\t]*;/),u=s.match(/^[\s\t]*$/);if(l||u)return;const c=s.match("^\\t{"+i.currentIndent+"}(\\w+):(.*){",""),h=s.match("^\\t{"+i.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),p=s.match("^\\t{"+(i.currentIndent-1)+"}}");c?i.parseNodeBegin(s,c):h?i.parseNodeProperty(s,h,n[++o]):p?i.popStack():s.match(/^[^\s\t}]/)&&i.parseNodePropertyContinued(s)}),this.allNodes}parseNodeBegin(e,i){const n=i[1].trim().replace(/^"/,"").replace(/"$/,""),s=i[2].split(",").map(function(c){return c.trim().replace(/^"/,"").replace(/"$/,"")}),o={name:n},l=this.parseNodeAttr(s),u=this.getCurrentNode();this.currentIndent===0?this.allNodes.add(n,o):n in u?(n==="PoseNode"?u.PoseNode.push(o):u[n].id!==void 0&&(u[n]={},u[n][u[n].id]=u[n]),l.id!==""&&(u[n][l.id]=o)):typeof l.id=="number"?(u[n]={},u[n][l.id]=o):n!=="Properties70"&&(n==="PoseNode"?u[n]=[o]:u[n]=o),typeof l.id=="number"&&(o.id=l.id),l.name!==""&&(o.attrName=l.name),l.type!==""&&(o.attrType=l.type),this.pushStack(o)}parseNodeAttr(e){let i=e[0];e[0]!==""&&(i=parseInt(e[0]),isNaN(i)&&(i=e[0]));let n="",s="";return e.length>1&&(n=e[1].replace(/^(\w+)::/,""),s=e[2]),{id:i,name:n,type:s}}parseNodeProperty(e,i,n){let s=i[1].replace(/^"/,"").replace(/"$/,"").trim(),o=i[2].replace(/^"/,"").replace(/"$/,"").trim();s==="Content"&&o===","&&(o=n.replace(/"/g,"").replace(/,$/,"").trim());const l=this.getCurrentNode();if(l.name==="Properties70"){this.parseNodeSpecialProperty(e,s,o);return}if(s==="C"){const u=o.split(",").slice(1),c=parseInt(u[0]),h=parseInt(u[1]);let p=o.split(",").slice(3);p=p.map(function(f){return f.trim().replace(/^"/,"")}),s="connections",o=[c,h],tK(o,p),l[s]===void 0&&(l[s]=[])}s==="Node"&&(l.id=o),s in l&&Array.isArray(l[s])?l[s].push(o):s!=="a"?l[s]=o:l.a=o,this.setCurrentProp(l,s),s==="a"&&o.slice(-1)!==","&&(l.a=wC(o))}parseNodePropertyContinued(e){const i=this.getCurrentNode();i.a+=e,e.slice(-1)!==","&&(i.a=wC(i.a))}parseNodeSpecialProperty(e,i,n){const s=n.split('",').map(function(p){return p.trim().replace(/^\"/,"").replace(/\s/,"_")}),o=s[0],l=s[1],u=s[2],c=s[3];let h=s[4];switch(l){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":h=parseFloat(h);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":h=wC(h);break}this.getPrevNode()[o]={type:l,type2:u,flag:c,value:h},this.setCurrentProp(this.getPrevNode(),o)}}class KY{parse(e){const i=new lP(e);i.skip(23);const n=i.getUint32();if(n<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+n);const s=new cP;for(;!this.endOfContent(i);){const o=this.parseNode(i,n);o!==null&&s.add(o.name,o)}return s}endOfContent(e){return e.size()%16===0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()}parseNode(e,i){const n={},s=i>=7500?e.getUint64():e.getUint32(),o=i>=7500?e.getUint64():e.getUint32();i>=7500?e.getUint64():e.getUint32();const l=e.getUint8(),u=e.getString(l);if(s===0)return null;const c=[];for(let m=0;m<o;m++)c.push(this.parseProperty(e));const h=c.length>0?c[0]:"",p=c.length>1?c[1]:"",f=c.length>2?c[2]:"";for(n.singleProperty=o===1&&e.getOffset()===s;s>e.getOffset();){const m=this.parseNode(e,i);m!==null&&this.parseSubNode(u,n,m)}return n.propertyList=c,typeof h=="number"&&(n.id=h),p!==""&&(n.attrName=p),f!==""&&(n.attrType=f),u!==""&&(n.name=u),n}parseSubNode(e,i,n){if(n.singleProperty===!0){const s=n.propertyList[0];Array.isArray(s)?(i[n.name]=n,n.a=s):i[n.name]=s}else if(e==="Connections"&&n.name==="C"){const s=[];n.propertyList.forEach(function(o,l){l!==0&&s.push(o)}),i.connections===void 0&&(i.connections=[]),i.connections.push(s)}else if(n.name==="Properties70")Object.keys(n).forEach(function(s){i[s]=n[s]});else if(e==="Properties70"&&n.name==="P"){let s=n.propertyList[0],o=n.propertyList[1];const l=n.propertyList[2],u=n.propertyList[3];let c;s.indexOf("Lcl ")===0&&(s=s.replace("Lcl ","Lcl_")),o.indexOf("Lcl ")===0&&(o=o.replace("Lcl ","Lcl_")),o==="Color"||o==="ColorRGB"||o==="Vector"||o==="Vector3D"||o.indexOf("Lcl_")===0?c=[n.propertyList[4],n.propertyList[5],n.propertyList[6]]:c=n.propertyList[4],i[s]={type:o,type2:l,flag:u,value:c}}else i[n.name]===void 0?typeof n.id=="number"?(i[n.name]={},i[n.name][n.id]=n):i[n.name]=n:n.name==="PoseNode"?(Array.isArray(i[n.name])||(i[n.name]=[i[n.name]]),i[n.name].push(n)):i[n.name][n.id]===void 0&&(i[n.name][n.id]=n)}parseProperty(e){const i=e.getString(1);let n;switch(i){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":return n=e.getUint32(),e.getArrayBuffer(n);case"S":return n=e.getUint32(),e.getString(n);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const s=e.getUint32(),o=e.getUint32(),l=e.getUint32();if(o===0)switch(i){case"b":case"c":return e.getBooleanArray(s);case"d":return e.getFloat64Array(s);case"f":return e.getFloat32Array(s);case"i":return e.getInt32Array(s);case"l":return e.getInt64Array(s)}const u=DY(new Uint8Array(e.getArrayBuffer(l))),c=new lP(u.buffer);switch(i){case"b":case"c":return c.getBooleanArray(s);case"d":return c.getFloat64Array(s);case"f":return c.getFloat32Array(s);case"i":return c.getInt32Array(s);case"l":return c.getInt64Array(s)}break;default:throw new Error("THREE.FBXLoader: Unknown property type "+i)}}}class lP{constructor(e,i){this.dv=new DataView(e),this.offset=0,this.littleEndian=i!==void 0?i:!0,this._textDecoder=new TextDecoder}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(e){this.offset+=e}getBoolean(){return(this.getUint8()&1)===1}getBooleanArray(e){const i=[];for(let n=0;n<e;n++)i.push(this.getBoolean());return i}getUint8(){const e=this.dv.getUint8(this.offset);return this.offset+=1,e}getInt16(){const e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}getInt32(){const e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}getInt32Array(e){const i=[];for(let n=0;n<e;n++)i.push(this.getInt32());return i}getUint32(){const e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}getInt64(){let e,i;return this.littleEndian?(e=this.getUint32(),i=this.getUint32()):(i=this.getUint32(),e=this.getUint32()),i&2147483648?(i=~i&4294967295,e=~e&4294967295,e===4294967295&&(i=i+1&4294967295),e=e+1&4294967295,-(i*4294967296+e)):i*4294967296+e}getInt64Array(e){const i=[];for(let n=0;n<e;n++)i.push(this.getInt64());return i}getUint64(){let e,i;return this.littleEndian?(e=this.getUint32(),i=this.getUint32()):(i=this.getUint32(),e=this.getUint32()),i*4294967296+e}getFloat32(){const e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}getFloat32Array(e){const i=[];for(let n=0;n<e;n++)i.push(this.getFloat32());return i}getFloat64(){const e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}getFloat64Array(e){const i=[];for(let n=0;n<e;n++)i.push(this.getFloat64());return i}getArrayBuffer(e){const i=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,i}getString(e){const i=this.offset;let n=new Uint8Array(this.dv.buffer,i,e);this.skip(e);const s=n.indexOf(0);return s>=0&&(n=new Uint8Array(this.dv.buffer,i,s)),this._textDecoder.decode(n)}}class cP{add(e,i){this[e]=i}}function JY(r){const e="Kaydara FBX Binary  \0";return r.byteLength>=e.length&&e===pP(r,0,e.length)}function ZY(r){const e=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let i=0;function n(s){const o=r[s-1];return r=r.slice(i+s),i++,o}for(let s=0;s<e.length;++s)if(n(1)===e[s])return!1;return!0}function uP(r){const e=/FBXVersion: (\d+)/,i=r.match(e);if(i)return parseInt(i[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function $Y(r){return r/46186158e3}const eK=[];function Jx(r,e,i,n){let s;switch(n.mappingType){case"ByPolygonVertex":s=r;break;case"ByPolygon":s=e;break;case"ByVertice":s=i;break;case"AllSame":s=n.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+n.mappingType)}n.referenceType==="IndexToDirect"&&(s=n.indices[s]);const o=s*n.dataSize,l=o+n.dataSize;return iK(eK,n.buffer,o,l)}const EC=new Ao,um=new Lt;function hP(r){const e=new Qr,i=new Qr,n=new Qr,s=new Qr,o=new Qr,l=new Qr,u=new Qr,c=new Qr,h=new Qr,p=new Qr,f=new Qr,m=new Qr,g=r.inheritType?r.inheritType:0;if(r.translation&&e.setPosition(um.fromArray(r.translation)),r.preRotation){const O=r.preRotation.map(go.degToRad);O.push(r.eulerOrder||Ao.DEFAULT_ORDER),i.makeRotationFromEuler(EC.fromArray(O))}if(r.rotation){const O=r.rotation.map(go.degToRad);O.push(r.eulerOrder||Ao.DEFAULT_ORDER),n.makeRotationFromEuler(EC.fromArray(O))}if(r.postRotation){const O=r.postRotation.map(go.degToRad);O.push(r.eulerOrder||Ao.DEFAULT_ORDER),s.makeRotationFromEuler(EC.fromArray(O)),s.invert()}r.scale&&o.scale(um.fromArray(r.scale)),r.scalingOffset&&u.setPosition(um.fromArray(r.scalingOffset)),r.scalingPivot&&l.setPosition(um.fromArray(r.scalingPivot)),r.rotationOffset&&c.setPosition(um.fromArray(r.rotationOffset)),r.rotationPivot&&h.setPosition(um.fromArray(r.rotationPivot)),r.parentMatrixWorld&&(f.copy(r.parentMatrix),p.copy(r.parentMatrixWorld));const y=i.clone().multiply(n).multiply(s),x=new Qr;x.extractRotation(p);const v=new Qr;v.copyPosition(p);const _=v.clone().invert().multiply(p),T=x.clone().invert().multiply(_),w=o,S=new Qr;if(g===0)S.copy(x).multiply(y).multiply(T).multiply(w);else if(g===1)S.copy(x).multiply(T).multiply(y).multiply(w);else{const O=new Qr().scale(new Lt().setFromMatrixScale(f)).clone().invert(),U=T.clone().multiply(O);S.copy(x).multiply(y).multiply(U).multiply(w)}const R=h.clone().invert(),B=l.clone().invert();let I=e.clone().multiply(c).multiply(h).multiply(i).multiply(n).multiply(s).multiply(R).multiply(u).multiply(l).multiply(o).multiply(B);const D=new Qr().copyPosition(I),L=p.clone().multiply(D);return m.copyPosition(L),I=m.clone().multiply(S),I.premultiply(p.invert()),I}function dP(r){r=r||0;const e=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return r===6?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),e[0]):e[r]}function wC(r){return r.split(",").map(function(e){return parseFloat(e)})}function pP(r,e,i){return e===void 0&&(e=0),i===void 0&&(i=r.byteLength),new TextDecoder().decode(new Uint8Array(r,e,i))}function tK(r,e){for(let i=0,n=r.length,s=e.length;i<s;i++,n++)r[n]=e[i]}function iK(r,e,i,n){for(let s=i,o=0;s<n;s++,o++)r[o]=e[s];return r}THREE.FBXLoader=WY,AFRAME.registerComponent("fbx-model",{schema:{src:{type:"asset"},crossorigin:{default:""}},init:function(){this.model=null},update:function(){const r=this.data;if(!r.src)return;this.remove();const e=new THREE.FBXLoader;r.crossorigin&&e.setCrossOrigin(r.crossorigin),e.load(r.src,this.load.bind(this))},load:function(r){this.model=r,this.el.setObject3D("mesh",r),this.el.emit("model-loaded",{format:"fbx",model:r})},remove:function(){this.model&&this.el.removeObject3D("mesh")}});function rK(){return"script_"+Date.now()+"_"+Math.ceil(Math.random()*1e5)}function nK(r,e){var i=document.createElement("script");return i.type="text/javascript",i.async=!0,i.id=e,i.src=r,i}function CC(r){const e=document.getElementById(r),i=e.parentNode;try{i&&i.removeChild(e)}catch{}}function sK(r){const e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(r,e)}function aK(r,e,i){return new i(function(n,s){const o=e.timeout||5e3,l=rK(),u=nK(r,l),c=setTimeout(function(){s(new Error("Script request to "+r+" timed out")),CC(l)},o),h=function(p){clearTimeout(p)};u.addEventListener("load",function(p){n({ok:!0}),h(c),CC(l)}),u.addEventListener("error",function(p){s(new Error("Script request to "+r+" failed "+p)),h(c),CC(l)}),sK(u)})}function oK(r){return r=r||{},function(e,i){return i=i||{},aK(e,i,r.Promise||Promise)}}var lK=oK;const cK=lK(),uK="https://cdn.jsdelivr.net/gh/mrdoob/three.js@r86/examples/js/loaders/GLTFLoader.js",hK=function(){let r;return function(){return r=r||cK(uK),r}}();AFRAME.registerComponent("gltf-model-legacy",{schema:{type:"model"},init:function(){this.model=null,this.loader=null,this.loaderPromise=hK().then(()=>{this.loader=new THREE.GLTFLoader,this.loader.setCrossOrigin("Anonymous")})},update:function(){const r=this,e=this.el,i=this.data;i&&(this.remove(),this.loaderPromise.then(()=>{this.loader.load(i,function(n){r.model=n.scene,r.model.animations=n.animations,e.setObject3D("mesh",r.model),e.emit("model-loaded",{format:"gltf",model:r.model})})}))},remove:function(){this.model&&this.el.removeObject3D("mesh")}}),AFRAME.registerComponent("object-model",{schema:{src:{type:"asset"},crossorigin:{default:""}},init:function(){this.model=null},update:function(){let r;const e=this.data;e.src&&(this.remove(),r=new THREE.ObjectLoader,e.crossorigin&&r.setCrossOrigin(e.crossorigin),r.load(e.src,i=>{i.traverse(n=>{n instanceof THREE.SkinnedMesh&&n.material&&(n.material.skinning=!!(n.geometry&&n.geometry.bones||[]).length)}),this.load(i)}))},load:function(r){this.model=r,this.el.setObject3D("mesh",r),this.el.emit("model-loaded",{format:"json",model:r})},remove:function(){this.model&&this.el.removeObject3D("mesh")}}),AFRAME.registerComponent("checkpoint",{schema:{offset:{default:{x:0,y:0,z:0},type:"vec3"}},init:function(){this.active=!1,this.targetEl=null,this.fire=this.fire.bind(this),this.offset=new THREE.Vector3},update:function(){this.offset.copy(this.data.offset)},play:function(){this.el.addEventListener("click",this.fire)},pause:function(){this.el.removeEventListener("click",this.fire)},remove:function(){this.pause()},fire:function(){const r=this.el.sceneEl.querySelector("[checkpoint-controls]");if(!r)throw new Error("No `checkpoint-controls` component found.");r.components["checkpoint-controls"].setCheckpoint(this.el)},getOffset:function(){return this.offset.copy(this.data.offset)}});function dK(r){return r?Array.isArray(r)?r:r.materials?r.materials:[r]:[]}function dA(r,e,i,n){r&&(e=e||[],r.traverse(s=>{s.isMesh&&dK(s.material).forEach(o=>{o&&!("envMap"in o)||e.length&&e.indexOf(o.name)===-1||(o.envMap=i,o.reflectivity=n,o.needsUpdate=!0)})}))}AFRAME.registerComponent("cube-env-map",{multiple:!0,schema:{path:{default:""},extension:{default:"jpg",oneOf:["jpg","png"]},enableBackground:{default:!1},reflectivity:{default:1,min:0,max:1},materials:{default:[]}},init:function(){const r=this.data;this.texture=new THREE.CubeTextureLoader().load([r.path+"posx."+r.extension,r.path+"negx."+r.extension,r.path+"posy."+r.extension,r.path+"negy."+r.extension,r.path+"posz."+r.extension,r.path+"negz."+r.extension]),this.texture.format=THREE.RGBAFormat,this.object3dsetHandler=()=>{const e=this.el.getObject3D("mesh"),i=this.data;dA(e,i.materials,this.texture,i.reflectivity)},this.object3dsetHandler(),this.el.addEventListener("object3dset",this.object3dsetHandler)},update:function(r){const e=this.data,i=this.el.getObject3D("mesh");let n=[],s=[];if(e.materials.length&&(r.materials?(n=e.materials.filter(o=>!r.materials.includes(o)),s=r.materials.filter(o=>!e.materials.includes(o))):n=e.materials),n.length&&dA(i,n,this.texture,e.reflectivity),s.length&&dA(i,s,null,1),r.materials&&e.reflectivity!==r.reflectivity){const o=e.materials.filter(l=>r.materials.includes(l));o.length&&dA(i,o,this.texture,e.reflectivity)}this.data.enableBackground&&!r.enableBackground?this.setBackground(this.texture):!this.data.enableBackground&&r.enableBackground&&this.setBackground(null)},remove:function(){this.el.removeEventListener("object3dset",this.object3dsetHandler);const r=this.el.getObject3D("mesh"),e=this.data;dA(r,e.materials,null,1),e.enableBackground&&this.setBackground(null)},setBackground:function(r){this.el.sceneEl.object3D.background=r}}),AFRAME.registerComponent("grab",{init:function(){this.system=this.el.sceneEl.systems.physics,this.GRABBED_STATE="grabbed",this.grabbing=!1,this.hitEl=null,this.physics=this.el.sceneEl.systems.physics,this.constraint=null,this.onHit=this.onHit.bind(this),this.onGripOpen=this.onGripOpen.bind(this),this.onGripClose=this.onGripClose.bind(this)},play:function(){const r=this.el;r.addEventListener("hit",this.onHit),r.addEventListener("gripdown",this.onGripClose),r.addEventListener("gripup",this.onGripOpen),r.addEventListener("trackpaddown",this.onGripClose),r.addEventListener("trackpadup",this.onGripOpen),r.addEventListener("triggerdown",this.onGripClose),r.addEventListener("triggerup",this.onGripOpen)},pause:function(){const r=this.el;r.removeEventListener("hit",this.onHit),r.removeEventListener("gripdown",this.onGripClose),r.removeEventListener("gripup",this.onGripOpen),r.removeEventListener("trackpaddown",this.onGripClose),r.removeEventListener("trackpadup",this.onGripOpen),r.removeEventListener("triggerdown",this.onGripClose),r.removeEventListener("triggerup",this.onGripOpen)},onGripClose:function(){this.grabbing=!0},onGripOpen:function(){const r=this.hitEl;this.grabbing=!1,r&&(r.removeState(this.GRABBED_STATE),this.hitEl=void 0,this.system.removeConstraint(this.constraint),this.constraint=null)},onHit:function(r){const e=r.detail.el;e.is(this.GRABBED_STATE)||!this.grabbing||this.hitEl||(e.addState(this.GRABBED_STATE),this.hitEl=e,this.constraint=new CANNON.LockConstraint(this.el.body,e.body),this.system.addConstraint(this.constraint))}}),AFRAME.registerComponent("normal-material",{init:function(){this.material=new THREE.MeshNormalMaterial({flatShading:!0}),this.applyMaterial=this.applyMaterial.bind(this),this.el.addEventListener("object3dset",this.applyMaterial),this.applyMaterial()},remove:function(){this.el.removeEventListener("object3dset",this.applyMaterial)},applyMaterial:function(){this.el.object3D.traverse(r=>{r.isMesh&&(r.material=this.material)})}}),AFRAME.registerComponent("sphere-collider",{schema:{enabled:{default:!0},interval:{default:80},objects:{default:""},state:{default:"collided"},radius:{default:.05},watch:{default:!0}},init:function(){this.observer=null,this.els=[],this.collisions=[],this.prevCheckTime=void 0,this.eventDetail={},this.handleHit=this.handleHit.bind(this),this.handleHitEnd=this.handleHitEnd.bind(this)},play:function(){const r=this.el.sceneEl;this.data.watch&&(this.observer=new MutationObserver(this.update.bind(this,null)),this.observer.observe(r,{childList:!0,subtree:!0}))},pause:function(){this.observer&&(this.observer.disconnect(),this.observer=null)},update:function(){const r=this.data;let e;r.objects?e=this.el.sceneEl.querySelectorAll(r.objects):e=this.el.sceneEl.children,this.els=Array.prototype.slice.call(e)},tick:function(){const r=new THREE.Vector3,e=new THREE.Vector3,i=new THREE.Vector3,n=new THREE.Vector3,s=new THREE.Box3,o=[],l=new Map;return function(u){if(!this.data.enabled)return;const c=this.prevCheckTime;if(c&&u-c<this.data.interval)return;this.prevCheckTime=u;const h=this.el,p=this.data,f=h.getObject3D("mesh");let m;if(!f)return;o.length=0,l.clear(),h.object3D.getWorldPosition(r),h.object3D.getWorldScale(i),m=p.radius*y(i),this.els.forEach(g),o.sort((x,v)=>l.get(x)>l.get(v)?1:-1).forEach(this.handleHit),this.collisions.filter(x=>!l.has(x)).forEach(this.handleHitEnd),pK(this.collisions,o);function g(x){let v,_,T,w;x.isEntity&&(_=x.getObject3D("mesh"),_&&(s.setFromObject(_).getSize(n),w=Math.max(n.x,n.y,n.z)/2,v=Math.sqrt(2*w*w),s.getCenter(e),v&&(T=r.distanceTo(e),T<v+m&&(o.push(x),l.set(x,T)))))}function y(x){return Math.max(x.x,x.y,x.z)}}}(),handleHit:function(r){r.emit("hit"),r.addState(this.data.state),this.eventDetail.el=r,this.el.emit("hit",this.eventDetail)},handleHitEnd:function(r){r.emit("hitend"),r.removeState(this.data.state),this.eventDetail.el=r,this.el.emit("hitend",this.eventDetail)}});function pK(r,e){r.length=0;for(let i=0;i<e.length;i++)r[i]=e[i]}AFRAME.registerComponent("nav-mesh",{schema:{nodeName:{type:"string"}},init:function(){this.system=this.el.sceneEl.systems.nav,this.hasLoadedNavMesh=!1,this.nodeName=this.data.nodeName,this.el.addEventListener("object3dset",this.loadNavMesh.bind(this))},play:function(){this.hasLoadedNavMesh||this.loadNavMesh()},loadNavMesh:function(){var r=this;const e=this.el.getObject3D("mesh");if(this.el.sceneEl.object3D,!e)return;let i;if(e.traverse(s=>{s.isMesh&&(!r.nodeName||s.name===r.nodeName)&&(i=s)}),!i)return;const n=i.geometry.clone();i.updateWorldMatrix(!0,!1),n.applyMatrix4(i.matrixWorld),this.system.setNavMeshGeometry(n),this.hasLoadedNavMesh=!0}}),AFRAME.registerComponent("nav-agent",{schema:{destination:{type:"vec3"},active:{default:!1},speed:{default:2}},init:function(){this.system=this.el.sceneEl.systems.nav,this.system.addAgent(this),this.group=null,this.path=[],this.raycaster=new THREE.Raycaster},remove:function(){this.system.removeAgent(this)},update:function(){this.path.length=0},updateNavLocation:function(){this.group=null,this.path=[]},tick:function(){const r=new THREE.Vector3,e=new THREE.Vector3,i=new THREE.Vector3;return function(n,s){const o=this.el,l=this.data,u=this.raycaster,c=l.speed*s/1e3;if(!l.active)return;if(!this.path.length){const y=this.el.object3D.position;this.group=this.group||this.system.getGroup(y),this.path=this.system.getPath(y,r.copy(l.destination),this.group)||[],o.emit("navigation-start")}if(!this.path.length){console.warn("[nav] Unable to find path to %o.",l.destination),this.el.setAttribute("nav-agent",{active:!1}),o.emit("navigation-end");return}const h=o.object3D.position,p=this.path[0];e.subVectors(p,h);const f=e.length();let m;if(f<c){if(this.path.shift(),!this.path.length){this.el.setAttribute("nav-agent",{active:!1}),o.emit("navigation-end");return}i.copy(h),m=this.path[0]}else i.copy(e.setLength(c)).add(h),m=p;m.y=h.y,o.object3D.lookAt(m),u.ray.origin.copy(i),u.ray.origin.y+=1.5,u.ray.direction={x:0,y:-1,z:0};const g=u.intersectObject(this.system.getNavMesh());g.length?(e.subVectors(g[0].point,h),h.add(e.setLength(c))):h.copy(i)}}()});/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const Zx="170",Ua={ROTATE:0,DOLLY:1,PAN:2},yu={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},fK=0,fP=1,mK=2,mP=1,gK=2,vu=3,jh=0,vo=1,xu=2,bu=0,hm=1,gP=2,AP=3,yP=4,AK=5,ap=100,yK=101,vK=102,xK=103,bK=104,_K=200,EK=201,wK=202,CK=203,SC=204,TC=205,SK=206,TK=207,MK=208,RK=209,IK=210,BK=211,NK=212,LK=213,DK=214,MC=0,RC=1,IC=2,dm=3,BC=4,NC=5,LC=6,DC=7,OC=0,OK=1,PK=2,Vh=0,kK=1,FK=2,UK=3,zK=4,jK=5,VK=6,GK=7,vP=300,pm=301,fm=302,PC=303,kC=304,$x=306,FC=1e3,op=1001,UC=1002,tc=1003,HK=1004,eb=1005,Fc=1006,zC=1007,lp=1008,_u=1009,xP=1010,bP=1011,pA=1012,jC=1013,cp=1014,Eu=1015,mm=1016,VC=1017,GC=1018,gm=1020,_P=35902,EP=1021,wP=1022,ic=1023,CP=1024,SP=1025,Am=1026,ym=1027,TP=1028,HC=1029,MP=1030,WC=1031,QC=1033,tb=33776,ib=33777,rb=33778,nb=33779,qC=35840,XC=35841,YC=35842,KC=35843,JC=36196,ZC=37492,$C=37496,eS=37808,tS=37809,iS=37810,rS=37811,nS=37812,sS=37813,aS=37814,oS=37815,lS=37816,cS=37817,uS=37818,hS=37819,dS=37820,pS=37821,sb=36492,fS=36494,mS=36495,RP=36283,gS=36284,AS=36285,yS=36286,WK=3200,QK=3201,IP=0,qK=1,Gh="",zo="srgb",vm="srgb-linear",ab="linear",cs="srgb",xm=7680,BP=519,XK=512,YK=513,KK=514,NP=515,JK=516,ZK=517,$K=518,eJ=519,vS=35044,LP="300 es",wu=2e3,ob=2001;let up=class{addEventListener(r,e){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[r]===void 0&&(i[r]=[]),i[r].indexOf(e)===-1&&i[r].push(e)}hasEventListener(r,e){if(this._listeners===void 0)return!1;const i=this._listeners;return i[r]!==void 0&&i[r].indexOf(e)!==-1}removeEventListener(r,e){if(this._listeners===void 0)return;const i=this._listeners[r];if(i!==void 0){const n=i.indexOf(e);n!==-1&&i.splice(n,1)}}dispatchEvent(r){if(this._listeners===void 0)return;const e=this._listeners[r.type];if(e!==void 0){r.target=this;const i=e.slice(0);for(let n=0,s=i.length;n<s;n++)i[n].call(this,r);r.target=null}}};const eo=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let DP=1234567;const fA=Math.PI/180,mA=180/Math.PI;function Cu(){const r=Math.random()*4294967295|0,e=Math.random()*4294967295|0,i=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(eo[r&255]+eo[r>>8&255]+eo[r>>16&255]+eo[r>>24&255]+"-"+eo[e&255]+eo[e>>8&255]+"-"+eo[e>>16&15|64]+eo[e>>24&255]+"-"+eo[i&63|128]+eo[i>>8&255]+"-"+eo[i>>16&255]+eo[i>>24&255]+eo[n&255]+eo[n>>8&255]+eo[n>>16&255]+eo[n>>24&255]).toLowerCase()}function Ta(r,e,i){return Math.max(e,Math.min(i,r))}function xS(r,e){return(r%e+e)%e}function tJ(r,e,i,n,s){return n+(r-e)*(s-n)/(i-e)}function iJ(r,e,i){return r!==e?(i-r)/(e-r):0}function gA(r,e,i){return(1-i)*r+i*e}function rJ(r,e,i,n){return gA(r,e,1-Math.exp(-i*n))}function nJ(r,e=1){return e-Math.abs(xS(r,e*2)-e)}function sJ(r,e,i){return r<=e?0:r>=i?1:(r=(r-e)/(i-e),r*r*(3-2*r))}function aJ(r,e,i){return r<=e?0:r>=i?1:(r=(r-e)/(i-e),r*r*r*(r*(r*6-15)+10))}function oJ(r,e){return r+Math.floor(Math.random()*(e-r+1))}function lJ(r,e){return r+Math.random()*(e-r)}function cJ(r){return r*(.5-Math.random())}function uJ(r){r!==void 0&&(DP=r);let e=DP+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function hJ(r){return r*fA}function dJ(r){return r*mA}function pJ(r){return(r&r-1)===0&&r!==0}function fJ(r){return Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))}function mJ(r){return Math.pow(2,Math.floor(Math.log(r)/Math.LN2))}function gJ(r,e,i,n,s){const o=Math.cos,l=Math.sin,u=o(i/2),c=l(i/2),h=o((e+n)/2),p=l((e+n)/2),f=o((e-n)/2),m=l((e-n)/2),g=o((n-e)/2),y=l((n-e)/2);switch(s){case"XYX":r.set(u*p,c*f,c*m,u*h);break;case"YZY":r.set(c*m,u*p,c*f,u*h);break;case"ZXZ":r.set(c*f,c*m,u*p,u*h);break;case"XZX":r.set(u*p,c*y,c*g,u*h);break;case"YXY":r.set(c*g,u*p,c*y,u*h);break;case"ZYZ":r.set(c*y,c*g,u*p,u*h);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+s)}}function rc(r,e){switch(e.constructor){case Float32Array:return r;case Uint32Array:return r/4294967295;case Uint16Array:return r/65535;case Uint8Array:return r/255;case Int32Array:return Math.max(r/2147483647,-1);case Int16Array:return Math.max(r/32767,-1);case Int8Array:return Math.max(r/127,-1);default:throw new Error("Invalid component type.")}}function ss(r,e){switch(e.constructor){case Float32Array:return r;case Uint32Array:return Math.round(r*4294967295);case Uint16Array:return Math.round(r*65535);case Uint8Array:return Math.round(r*255);case Int32Array:return Math.round(r*2147483647);case Int16Array:return Math.round(r*32767);case Int8Array:return Math.round(r*127);default:throw new Error("Invalid component type.")}}const bS={DEG2RAD:fA,RAD2DEG:mA,generateUUID:Cu,clamp:Ta,euclideanModulo:xS,mapLinear:tJ,inverseLerp:iJ,lerp:gA,damp:rJ,pingpong:nJ,smoothstep:sJ,smootherstep:aJ,randInt:oJ,randFloat:lJ,randFloatSpread:cJ,seededRandom:uJ,degToRad:hJ,radToDeg:dJ,isPowerOfTwo:pJ,ceilPowerOfTwo:fJ,floorPowerOfTwo:mJ,setQuaternionFromProperEuler:gJ,normalize:ss,denormalize:rc};let ji=class lH{constructor(e=0,i=0){lH.prototype.isVector2=!0,this.x=e,this.y=i}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,i){return this.x=e,this.y=i,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const i=this.x,n=this.y,s=e.elements;return this.x=s[0]*i+s[3]*n+s[6],this.y=s[1]*i+s[4]*n+s[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,i){return this.x=Math.max(e.x,Math.min(i.x,this.x)),this.y=Math.max(e.y,Math.min(i.y,this.y)),this}clampScalar(e,i){return this.x=Math.max(e,Math.min(i,this.x)),this.y=Math.max(e,Math.min(i,this.y)),this}clampLength(e,i){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(i,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const i=Math.sqrt(this.lengthSq()*e.lengthSq());if(i===0)return Math.PI/2;const n=this.dot(e)/i;return Math.acos(Ta(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const i=this.x-e.x,n=this.y-e.y;return i*i+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this}lerpVectors(e,i,n){return this.x=e.x+(i.x-e.x)*n,this.y=e.y+(i.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e}fromBufferAttribute(e,i){return this.x=e.getX(i),this.y=e.getY(i),this}rotateAround(e,i){const n=Math.cos(i),s=Math.sin(i),o=this.x-e.x,l=this.y-e.y;return this.x=o*n-l*s+e.x,this.y=o*s+l*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},gn=class cH{constructor(e,i,n,s,o,l,u,c,h){cH.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,i,n,s,o,l,u,c,h)}set(e,i,n,s,o,l,u,c,h){const p=this.elements;return p[0]=e,p[1]=s,p[2]=u,p[3]=i,p[4]=o,p[5]=c,p[6]=n,p[7]=l,p[8]=h,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const i=this.elements,n=e.elements;return i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],this}extractBasis(e,i,n){return e.setFromMatrix3Column(this,0),i.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const i=e.elements;return this.set(i[0],i[4],i[8],i[1],i[5],i[9],i[2],i[6],i[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,i){const n=e.elements,s=i.elements,o=this.elements,l=n[0],u=n[3],c=n[6],h=n[1],p=n[4],f=n[7],m=n[2],g=n[5],y=n[8],x=s[0],v=s[3],_=s[6],T=s[1],w=s[4],S=s[7],R=s[2],B=s[5],I=s[8];return o[0]=l*x+u*T+c*R,o[3]=l*v+u*w+c*B,o[6]=l*_+u*S+c*I,o[1]=h*x+p*T+f*R,o[4]=h*v+p*w+f*B,o[7]=h*_+p*S+f*I,o[2]=m*x+g*T+y*R,o[5]=m*v+g*w+y*B,o[8]=m*_+g*S+y*I,this}multiplyScalar(e){const i=this.elements;return i[0]*=e,i[3]*=e,i[6]*=e,i[1]*=e,i[4]*=e,i[7]*=e,i[2]*=e,i[5]*=e,i[8]*=e,this}determinant(){const e=this.elements,i=e[0],n=e[1],s=e[2],o=e[3],l=e[4],u=e[5],c=e[6],h=e[7],p=e[8];return i*l*p-i*u*h-n*o*p+n*u*c+s*o*h-s*l*c}invert(){const e=this.elements,i=e[0],n=e[1],s=e[2],o=e[3],l=e[4],u=e[5],c=e[6],h=e[7],p=e[8],f=p*l-u*h,m=u*c-p*o,g=h*o-l*c,y=i*f+n*m+s*g;if(y===0)return this.set(0,0,0,0,0,0,0,0,0);const x=1/y;return e[0]=f*x,e[1]=(s*h-p*n)*x,e[2]=(u*n-s*l)*x,e[3]=m*x,e[4]=(p*i-s*c)*x,e[5]=(s*o-u*i)*x,e[6]=g*x,e[7]=(n*c-h*i)*x,e[8]=(l*i-n*o)*x,this}transpose(){let e;const i=this.elements;return e=i[1],i[1]=i[3],i[3]=e,e=i[2],i[2]=i[6],i[6]=e,e=i[5],i[5]=i[7],i[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const i=this.elements;return e[0]=i[0],e[1]=i[3],e[2]=i[6],e[3]=i[1],e[4]=i[4],e[5]=i[7],e[6]=i[2],e[7]=i[5],e[8]=i[8],this}setUvTransform(e,i,n,s,o,l,u){const c=Math.cos(o),h=Math.sin(o);return this.set(n*c,n*h,-n*(c*l+h*u)+l+e,-s*h,s*c,-s*(-h*l+c*u)+u+i,0,0,1),this}scale(e,i){return this.premultiply(_S.makeScale(e,i)),this}rotate(e){return this.premultiply(_S.makeRotation(-e)),this}translate(e,i){return this.premultiply(_S.makeTranslation(e,i)),this}makeTranslation(e,i){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,i,0,0,1),this}makeRotation(e){const i=Math.cos(e),n=Math.sin(e);return this.set(i,-n,0,n,i,0,0,0,1),this}makeScale(e,i){return this.set(e,0,0,0,i,0,0,0,1),this}equals(e){const i=this.elements,n=e.elements;for(let s=0;s<9;s++)if(i[s]!==n[s])return!1;return!0}fromArray(e,i=0){for(let n=0;n<9;n++)this.elements[n]=e[n+i];return this}toArray(e=[],i=0){const n=this.elements;return e[i]=n[0],e[i+1]=n[1],e[i+2]=n[2],e[i+3]=n[3],e[i+4]=n[4],e[i+5]=n[5],e[i+6]=n[6],e[i+7]=n[7],e[i+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}};const _S=new gn;function OP(r){for(let e=r.length-1;e>=0;--e)if(r[e]>=65535)return!0;return!1}function AA(r){return document.createElementNS("http://www.w3.org/1999/xhtml",r)}function AJ(){const r=AA("canvas");return r.style.display="block",r}const PP={};function yA(r){r in PP||(PP[r]=!0,console.warn(r))}function yJ(r,e,i){return new Promise(function(n,s){function o(){switch(r.clientWaitSync(e,r.SYNC_FLUSH_COMMANDS_BIT,0)){case r.WAIT_FAILED:s();break;case r.TIMEOUT_EXPIRED:setTimeout(o,i);break;default:n()}}setTimeout(o,i)})}function vJ(r){const e=r.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}function xJ(r){const e=r.elements;e[11]===-1?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=-e[14]+1)}const zn={enabled:!0,workingColorSpace:vm,spaces:{},convert:function(r,e,i){return this.enabled===!1||e===i||!e||!i||(this.spaces[e].transfer===cs&&(r.r=Su(r.r),r.g=Su(r.g),r.b=Su(r.b)),this.spaces[e].primaries!==this.spaces[i].primaries&&(r.applyMatrix3(this.spaces[e].toXYZ),r.applyMatrix3(this.spaces[i].fromXYZ)),this.spaces[i].transfer===cs&&(r.r=bm(r.r),r.g=bm(r.g),r.b=bm(r.b))),r},fromWorkingColorSpace:function(r,e){return this.convert(r,this.workingColorSpace,e)},toWorkingColorSpace:function(r,e){return this.convert(r,e,this.workingColorSpace)},getPrimaries:function(r){return this.spaces[r].primaries},getTransfer:function(r){return r===Gh?ab:this.spaces[r].transfer},getLuminanceCoefficients:function(r,e=this.workingColorSpace){return r.fromArray(this.spaces[e].luminanceCoefficients)},define:function(r){Object.assign(this.spaces,r)},_getMatrix:function(r,e,i){return r.copy(this.spaces[e].toXYZ).multiply(this.spaces[i].fromXYZ)},_getDrawingBufferColorSpace:function(r){return this.spaces[r].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(r=this.workingColorSpace){return this.spaces[r].workingColorSpaceConfig.unpackColorSpace}};function Su(r){return r<.04045?r*.0773993808:Math.pow(r*.9478672986+.0521327014,2.4)}function bm(r){return r<.0031308?r*12.92:1.055*Math.pow(r,.41666)-.055}const kP=[.64,.33,.3,.6,.15,.06],FP=[.2126,.7152,.0722],UP=[.3127,.329],zP=new gn().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),jP=new gn().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);zn.define({[vm]:{primaries:kP,whitePoint:UP,transfer:ab,toXYZ:zP,fromXYZ:jP,luminanceCoefficients:FP,workingColorSpaceConfig:{unpackColorSpace:zo},outputColorSpaceConfig:{drawingBufferColorSpace:zo}},[zo]:{primaries:kP,whitePoint:UP,transfer:cs,toXYZ:zP,fromXYZ:jP,luminanceCoefficients:FP,outputColorSpaceConfig:{drawingBufferColorSpace:zo}}});let _m,bJ=class{static getDataURL(r){if(/^data:/i.test(r.src)||typeof HTMLCanvasElement>"u")return r.src;let e;if(r instanceof HTMLCanvasElement)e=r;else{_m===void 0&&(_m=AA("canvas")),_m.width=r.width,_m.height=r.height;const i=_m.getContext("2d");r instanceof ImageData?i.putImageData(r,0,0):i.drawImage(r,0,0,r.width,r.height),e=_m}return e.width>2048||e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",r),e.toDataURL("image/jpeg",.6)):e.toDataURL("image/png")}static sRGBToLinear(r){if(typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&r instanceof ImageBitmap){const e=AA("canvas");e.width=r.width,e.height=r.height;const i=e.getContext("2d");i.drawImage(r,0,0,r.width,r.height);const n=i.getImageData(0,0,r.width,r.height),s=n.data;for(let o=0;o<s.length;o++)s[o]=Su(s[o]/255)*255;return i.putImageData(n,0,0),e}else if(r.data){const e=r.data.slice(0);for(let i=0;i<e.length;i++)e instanceof Uint8Array||e instanceof Uint8ClampedArray?e[i]=Math.floor(Su(e[i]/255)*255):e[i]=Su(e[i]);return{data:e,width:r.width,height:r.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),r}},_J=0,VP=class{constructor(r=null){this.isSource=!0,Object.defineProperty(this,"id",{value:_J++}),this.uuid=Cu(),this.data=r,this.dataReady=!0,this.version=0}set needsUpdate(r){r===!0&&this.version++}toJSON(r){const e=r===void 0||typeof r=="string";if(!e&&r.images[this.uuid]!==void 0)return r.images[this.uuid];const i={uuid:this.uuid,url:""},n=this.data;if(n!==null){let s;if(Array.isArray(n)){s=[];for(let o=0,l=n.length;o<l;o++)n[o].isDataTexture?s.push(ES(n[o].image)):s.push(ES(n[o]))}else s=ES(n);i.url=s}return e||(r.images[this.uuid]=i),i}};function ES(r){return typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&r instanceof ImageBitmap?bJ.getDataURL(r):r.data?{data:Array.from(r.data),width:r.width,height:r.height,type:r.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let EJ=0,Nl=class $w extends up{constructor(e=$w.DEFAULT_IMAGE,i=$w.DEFAULT_MAPPING,n=op,s=op,o=Fc,l=lp,u=ic,c=_u,h=$w.DEFAULT_ANISOTROPY,p=Gh){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:EJ++}),this.uuid=Cu(),this.name="",this.source=new VP(e),this.mipmaps=[],this.mapping=i,this.channel=0,this.wrapS=n,this.wrapT=s,this.magFilter=o,this.minFilter=l,this.anisotropy=h,this.format=u,this.internalFormat=null,this.type=c,this.offset=new ji(0,0),this.repeat=new ji(1,1),this.center=new ji(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new gn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=p,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const i=e===void 0||typeof e=="string";if(!i&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),i||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==vP)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case FC:e.x=e.x-Math.floor(e.x);break;case op:e.x=e.x<0?0:1;break;case UC:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case FC:e.y=e.y-Math.floor(e.y);break;case op:e.y=e.y<0?0:1;break;case UC:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}};Nl.DEFAULT_IMAGE=null,Nl.DEFAULT_MAPPING=vP,Nl.DEFAULT_ANISOTROPY=1;let Js=class uH{constructor(e=0,i=0,n=0,s=1){uH.prototype.isVector4=!0,this.x=e,this.y=i,this.z=n,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,i,n,s){return this.x=e,this.y=i,this.z=n,this.w=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;case 3:this.w=i;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this.z=e.z+i.z,this.w=e.w+i.w,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this.z+=e.z*i,this.w+=e.w*i,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this.z=e.z-i.z,this.w=e.w-i.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const i=this.x,n=this.y,s=this.z,o=this.w,l=e.elements;return this.x=l[0]*i+l[4]*n+l[8]*s+l[12]*o,this.y=l[1]*i+l[5]*n+l[9]*s+l[13]*o,this.z=l[2]*i+l[6]*n+l[10]*s+l[14]*o,this.w=l[3]*i+l[7]*n+l[11]*s+l[15]*o,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const i=Math.sqrt(1-e.w*e.w);return i<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/i,this.y=e.y/i,this.z=e.z/i),this}setAxisAngleFromRotationMatrix(e){let i,n,s,o;const l=e.elements,u=l[0],c=l[4],h=l[8],p=l[1],f=l[5],m=l[9],g=l[2],y=l[6],x=l[10];if(Math.abs(c-p)<.01&&Math.abs(h-g)<.01&&Math.abs(m-y)<.01){if(Math.abs(c+p)<.1&&Math.abs(h+g)<.1&&Math.abs(m+y)<.1&&Math.abs(u+f+x-3)<.1)return this.set(1,0,0,0),this;i=Math.PI;const _=(u+1)/2,T=(f+1)/2,w=(x+1)/2,S=(c+p)/4,R=(h+g)/4,B=(m+y)/4;return _>T&&_>w?_<.01?(n=0,s=.707106781,o=.707106781):(n=Math.sqrt(_),s=S/n,o=R/n):T>w?T<.01?(n=.707106781,s=0,o=.707106781):(s=Math.sqrt(T),n=S/s,o=B/s):w<.01?(n=.707106781,s=.707106781,o=0):(o=Math.sqrt(w),n=R/o,s=B/o),this.set(n,s,o,i),this}let v=Math.sqrt((y-m)*(y-m)+(h-g)*(h-g)+(p-c)*(p-c));return Math.abs(v)<.001&&(v=1),this.x=(y-m)/v,this.y=(h-g)/v,this.z=(p-c)/v,this.w=Math.acos((u+f+x-1)/2),this}setFromMatrixPosition(e){const i=e.elements;return this.x=i[12],this.y=i[13],this.z=i[14],this.w=i[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,i){return this.x=Math.max(e.x,Math.min(i.x,this.x)),this.y=Math.max(e.y,Math.min(i.y,this.y)),this.z=Math.max(e.z,Math.min(i.z,this.z)),this.w=Math.max(e.w,Math.min(i.w,this.w)),this}clampScalar(e,i){return this.x=Math.max(e,Math.min(i,this.x)),this.y=Math.max(e,Math.min(i,this.y)),this.z=Math.max(e,Math.min(i,this.z)),this.w=Math.max(e,Math.min(i,this.w)),this}clampLength(e,i){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(i,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this.z+=(e.z-this.z)*i,this.w+=(e.w-this.w)*i,this}lerpVectors(e,i,n){return this.x=e.x+(i.x-e.x)*n,this.y=e.y+(i.y-e.y)*n,this.z=e.z+(i.z-e.z)*n,this.w=e.w+(i.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this.z=e[i+2],this.w=e[i+3],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e[i+2]=this.z,e[i+3]=this.w,e}fromBufferAttribute(e,i){return this.x=e.getX(i),this.y=e.getY(i),this.z=e.getZ(i),this.w=e.getW(i),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},wJ=class extends up{constructor(r=1,e=1,i={}){super(),this.isRenderTarget=!0,this.width=r,this.height=e,this.depth=1,this.scissor=new Js(0,0,r,e),this.scissorTest=!1,this.viewport=new Js(0,0,r,e);const n={width:r,height:e,depth:1};i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Fc,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},i);const s=new Nl(n,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace);s.flipY=!1,s.generateMipmaps=i.generateMipmaps,s.internalFormat=i.internalFormat,this.textures=[];const o=i.count;for(let l=0;l<o;l++)this.textures[l]=s.clone(),this.textures[l].isRenderTargetTexture=!0;this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.resolveDepthBuffer=i.resolveDepthBuffer,this.resolveStencilBuffer=i.resolveStencilBuffer,this.depthTexture=i.depthTexture,this.samples=i.samples}get texture(){return this.textures[0]}set texture(r){this.textures[0]=r}setSize(r,e,i=1){if(this.width!==r||this.height!==e||this.depth!==i){this.width=r,this.height=e,this.depth=i;for(let n=0,s=this.textures.length;n<s;n++)this.textures[n].image.width=r,this.textures[n].image.height=e,this.textures[n].image.depth=i;this.dispose()}this.viewport.set(0,0,r,e),this.scissor.set(0,0,r,e)}clone(){return new this.constructor().copy(this)}copy(r){this.width=r.width,this.height=r.height,this.depth=r.depth,this.scissor.copy(r.scissor),this.scissorTest=r.scissorTest,this.viewport.copy(r.viewport),this.textures.length=0;for(let i=0,n=r.textures.length;i<n;i++)this.textures[i]=r.textures[i].clone(),this.textures[i].isRenderTargetTexture=!0;const e=Object.assign({},r.texture.image);return this.texture.source=new VP(e),this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.resolveDepthBuffer=r.resolveDepthBuffer,this.resolveStencilBuffer=r.resolveStencilBuffer,r.depthTexture!==null&&(this.depthTexture=r.depthTexture.clone()),this.samples=r.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},Hh=class extends wJ{constructor(r=1,e=1,i={}){super(r,e,i),this.isWebGLRenderTarget=!0}},GP=class extends Nl{constructor(r=null,e=1,i=1,n=1){super(null),this.isDataArrayTexture=!0,this.image={data:r,width:e,height:i,depth:n},this.magFilter=tc,this.minFilter=tc,this.wrapR=op,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(r){this.layerUpdates.add(r)}clearLayerUpdates(){this.layerUpdates.clear()}};class CJ extends Nl{constructor(e=null,i=1,n=1,s=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:i,height:n,depth:s},this.magFilter=tc,this.minFilter=tc,this.wrapR=op,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}let Uc=class{constructor(r=0,e=0,i=0,n=1){this.isQuaternion=!0,this._x=r,this._y=e,this._z=i,this._w=n}static slerpFlat(r,e,i,n,s,o,l){let u=i[n+0],c=i[n+1],h=i[n+2],p=i[n+3];const f=s[o+0],m=s[o+1],g=s[o+2],y=s[o+3];if(l===0){r[e+0]=u,r[e+1]=c,r[e+2]=h,r[e+3]=p;return}if(l===1){r[e+0]=f,r[e+1]=m,r[e+2]=g,r[e+3]=y;return}if(p!==y||u!==f||c!==m||h!==g){let x=1-l;const v=u*f+c*m+h*g+p*y,_=v>=0?1:-1,T=1-v*v;if(T>Number.EPSILON){const S=Math.sqrt(T),R=Math.atan2(S,v*_);x=Math.sin(x*R)/S,l=Math.sin(l*R)/S}const w=l*_;if(u=u*x+f*w,c=c*x+m*w,h=h*x+g*w,p=p*x+y*w,x===1-l){const S=1/Math.sqrt(u*u+c*c+h*h+p*p);u*=S,c*=S,h*=S,p*=S}}r[e]=u,r[e+1]=c,r[e+2]=h,r[e+3]=p}static multiplyQuaternionsFlat(r,e,i,n,s,o){const l=i[n],u=i[n+1],c=i[n+2],h=i[n+3],p=s[o],f=s[o+1],m=s[o+2],g=s[o+3];return r[e]=l*g+h*p+u*m-c*f,r[e+1]=u*g+h*f+c*p-l*m,r[e+2]=c*g+h*m+l*f-u*p,r[e+3]=h*g-l*p-u*f-c*m,r}get x(){return this._x}set x(r){this._x=r,this._onChangeCallback()}get y(){return this._y}set y(r){this._y=r,this._onChangeCallback()}get z(){return this._z}set z(r){this._z=r,this._onChangeCallback()}get w(){return this._w}set w(r){this._w=r,this._onChangeCallback()}set(r,e,i,n){return this._x=r,this._y=e,this._z=i,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(r){return this._x=r.x,this._y=r.y,this._z=r.z,this._w=r.w,this._onChangeCallback(),this}setFromEuler(r,e=!0){const i=r._x,n=r._y,s=r._z,o=r._order,l=Math.cos,u=Math.sin,c=l(i/2),h=l(n/2),p=l(s/2),f=u(i/2),m=u(n/2),g=u(s/2);switch(o){case"XYZ":this._x=f*h*p+c*m*g,this._y=c*m*p-f*h*g,this._z=c*h*g+f*m*p,this._w=c*h*p-f*m*g;break;case"YXZ":this._x=f*h*p+c*m*g,this._y=c*m*p-f*h*g,this._z=c*h*g-f*m*p,this._w=c*h*p+f*m*g;break;case"ZXY":this._x=f*h*p-c*m*g,this._y=c*m*p+f*h*g,this._z=c*h*g+f*m*p,this._w=c*h*p-f*m*g;break;case"ZYX":this._x=f*h*p-c*m*g,this._y=c*m*p+f*h*g,this._z=c*h*g-f*m*p,this._w=c*h*p+f*m*g;break;case"YZX":this._x=f*h*p+c*m*g,this._y=c*m*p+f*h*g,this._z=c*h*g-f*m*p,this._w=c*h*p-f*m*g;break;case"XZY":this._x=f*h*p-c*m*g,this._y=c*m*p-f*h*g,this._z=c*h*g+f*m*p,this._w=c*h*p+f*m*g;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return e===!0&&this._onChangeCallback(),this}setFromAxisAngle(r,e){const i=e/2,n=Math.sin(i);return this._x=r.x*n,this._y=r.y*n,this._z=r.z*n,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(r){const e=r.elements,i=e[0],n=e[4],s=e[8],o=e[1],l=e[5],u=e[9],c=e[2],h=e[6],p=e[10],f=i+l+p;if(f>0){const m=.5/Math.sqrt(f+1);this._w=.25/m,this._x=(h-u)*m,this._y=(s-c)*m,this._z=(o-n)*m}else if(i>l&&i>p){const m=2*Math.sqrt(1+i-l-p);this._w=(h-u)/m,this._x=.25*m,this._y=(n+o)/m,this._z=(s+c)/m}else if(l>p){const m=2*Math.sqrt(1+l-i-p);this._w=(s-c)/m,this._x=(n+o)/m,this._y=.25*m,this._z=(u+h)/m}else{const m=2*Math.sqrt(1+p-i-l);this._w=(o-n)/m,this._x=(s+c)/m,this._y=(u+h)/m,this._z=.25*m}return this._onChangeCallback(),this}setFromUnitVectors(r,e){let i=r.dot(e)+1;return i<Number.EPSILON?(i=0,Math.abs(r.x)>Math.abs(r.z)?(this._x=-r.y,this._y=r.x,this._z=0,this._w=i):(this._x=0,this._y=-r.z,this._z=r.y,this._w=i)):(this._x=r.y*e.z-r.z*e.y,this._y=r.z*e.x-r.x*e.z,this._z=r.x*e.y-r.y*e.x,this._w=i),this.normalize()}angleTo(r){return 2*Math.acos(Math.abs(Ta(this.dot(r),-1,1)))}rotateTowards(r,e){const i=this.angleTo(r);if(i===0)return this;const n=Math.min(1,e/i);return this.slerp(r,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(r){return this._x*r._x+this._y*r._y+this._z*r._z+this._w*r._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let r=this.length();return r===0?(this._x=0,this._y=0,this._z=0,this._w=1):(r=1/r,this._x=this._x*r,this._y=this._y*r,this._z=this._z*r,this._w=this._w*r),this._onChangeCallback(),this}multiply(r){return this.multiplyQuaternions(this,r)}premultiply(r){return this.multiplyQuaternions(r,this)}multiplyQuaternions(r,e){const i=r._x,n=r._y,s=r._z,o=r._w,l=e._x,u=e._y,c=e._z,h=e._w;return this._x=i*h+o*l+n*c-s*u,this._y=n*h+o*u+s*l-i*c,this._z=s*h+o*c+i*u-n*l,this._w=o*h-i*l-n*u-s*c,this._onChangeCallback(),this}slerp(r,e){if(e===0)return this;if(e===1)return this.copy(r);const i=this._x,n=this._y,s=this._z,o=this._w;let l=o*r._w+i*r._x+n*r._y+s*r._z;if(l<0?(this._w=-r._w,this._x=-r._x,this._y=-r._y,this._z=-r._z,l=-l):this.copy(r),l>=1)return this._w=o,this._x=i,this._y=n,this._z=s,this;const u=1-l*l;if(u<=Number.EPSILON){const m=1-e;return this._w=m*o+e*this._w,this._x=m*i+e*this._x,this._y=m*n+e*this._y,this._z=m*s+e*this._z,this.normalize(),this}const c=Math.sqrt(u),h=Math.atan2(c,l),p=Math.sin((1-e)*h)/c,f=Math.sin(e*h)/c;return this._w=o*p+this._w*f,this._x=i*p+this._x*f,this._y=n*p+this._y*f,this._z=s*p+this._z*f,this._onChangeCallback(),this}slerpQuaternions(r,e,i){return this.copy(r).slerp(e,i)}random(){const r=2*Math.PI*Math.random(),e=2*Math.PI*Math.random(),i=Math.random(),n=Math.sqrt(1-i),s=Math.sqrt(i);return this.set(n*Math.sin(r),n*Math.cos(r),s*Math.sin(e),s*Math.cos(e))}equals(r){return r._x===this._x&&r._y===this._y&&r._z===this._z&&r._w===this._w}fromArray(r,e=0){return this._x=r[e],this._y=r[e+1],this._z=r[e+2],this._w=r[e+3],this._onChangeCallback(),this}toArray(r=[],e=0){return r[e]=this._x,r[e+1]=this._y,r[e+2]=this._z,r[e+3]=this._w,r}fromBufferAttribute(r,e){return this._x=r.getX(e),this._y=r.getY(e),this._z=r.getZ(e),this._w=r.getW(e),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(r){return this._onChangeCallback=r,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},at=class hH{constructor(e=0,i=0,n=0){hH.prototype.isVector3=!0,this.x=e,this.y=i,this.z=n}set(e,i,n){return n===void 0&&(n=this.z),this.x=e,this.y=i,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this.z=e.z+i.z,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this.z+=e.z*i,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this.z=e.z-i.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,i){return this.x=e.x*i.x,this.y=e.y*i.y,this.z=e.z*i.z,this}applyEuler(e){return this.applyQuaternion(HP.setFromEuler(e))}applyAxisAngle(e,i){return this.applyQuaternion(HP.setFromAxisAngle(e,i))}applyMatrix3(e){const i=this.x,n=this.y,s=this.z,o=e.elements;return this.x=o[0]*i+o[3]*n+o[6]*s,this.y=o[1]*i+o[4]*n+o[7]*s,this.z=o[2]*i+o[5]*n+o[8]*s,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const i=this.x,n=this.y,s=this.z,o=e.elements,l=1/(o[3]*i+o[7]*n+o[11]*s+o[15]);return this.x=(o[0]*i+o[4]*n+o[8]*s+o[12])*l,this.y=(o[1]*i+o[5]*n+o[9]*s+o[13])*l,this.z=(o[2]*i+o[6]*n+o[10]*s+o[14])*l,this}applyQuaternion(e){const i=this.x,n=this.y,s=this.z,o=e.x,l=e.y,u=e.z,c=e.w,h=2*(l*s-u*n),p=2*(u*i-o*s),f=2*(o*n-l*i);return this.x=i+c*h+l*f-u*p,this.y=n+c*p+u*h-o*f,this.z=s+c*f+o*p-l*h,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const i=this.x,n=this.y,s=this.z,o=e.elements;return this.x=o[0]*i+o[4]*n+o[8]*s,this.y=o[1]*i+o[5]*n+o[9]*s,this.z=o[2]*i+o[6]*n+o[10]*s,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,i){return this.x=Math.max(e.x,Math.min(i.x,this.x)),this.y=Math.max(e.y,Math.min(i.y,this.y)),this.z=Math.max(e.z,Math.min(i.z,this.z)),this}clampScalar(e,i){return this.x=Math.max(e,Math.min(i,this.x)),this.y=Math.max(e,Math.min(i,this.y)),this.z=Math.max(e,Math.min(i,this.z)),this}clampLength(e,i){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(i,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this.z+=(e.z-this.z)*i,this}lerpVectors(e,i,n){return this.x=e.x+(i.x-e.x)*n,this.y=e.y+(i.y-e.y)*n,this.z=e.z+(i.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,i){const n=e.x,s=e.y,o=e.z,l=i.x,u=i.y,c=i.z;return this.x=s*c-o*u,this.y=o*l-n*c,this.z=n*u-s*l,this}projectOnVector(e){const i=e.lengthSq();if(i===0)return this.set(0,0,0);const n=e.dot(this)/i;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return wS.copy(this).projectOnVector(e),this.sub(wS)}reflect(e){return this.sub(wS.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const i=Math.sqrt(this.lengthSq()*e.lengthSq());if(i===0)return Math.PI/2;const n=this.dot(e)/i;return Math.acos(Ta(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const i=this.x-e.x,n=this.y-e.y,s=this.z-e.z;return i*i+n*n+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,i,n){const s=Math.sin(i)*e;return this.x=s*Math.sin(n),this.y=Math.cos(i)*e,this.z=s*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,i,n){return this.x=e*Math.sin(i),this.y=n,this.z=e*Math.cos(i),this}setFromMatrixPosition(e){const i=e.elements;return this.x=i[12],this.y=i[13],this.z=i[14],this}setFromMatrixScale(e){const i=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),s=this.setFromMatrixColumn(e,2).length();return this.x=i,this.y=n,this.z=s,this}setFromMatrixColumn(e,i){return this.fromArray(e.elements,i*4)}setFromMatrix3Column(e,i){return this.fromArray(e.elements,i*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this.z=e[i+2],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e[i+2]=this.z,e}fromBufferAttribute(e,i){return this.x=e.getX(i),this.y=e.getY(i),this.z=e.getZ(i),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,i=Math.random()*2-1,n=Math.sqrt(1-i*i);return this.x=n*Math.cos(e),this.y=i,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}};const wS=new at,HP=new Uc;let hp=class{constructor(r=new at(1/0,1/0,1/0),e=new at(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=r,this.max=e}set(r,e){return this.min.copy(r),this.max.copy(e),this}setFromArray(r){this.makeEmpty();for(let e=0,i=r.length;e<i;e+=3)this.expandByPoint(nc.fromArray(r,e));return this}setFromBufferAttribute(r){this.makeEmpty();for(let e=0,i=r.count;e<i;e++)this.expandByPoint(nc.fromBufferAttribute(r,e));return this}setFromPoints(r){this.makeEmpty();for(let e=0,i=r.length;e<i;e++)this.expandByPoint(r[e]);return this}setFromCenterAndSize(r,e){const i=nc.copy(e).multiplyScalar(.5);return this.min.copy(r).sub(i),this.max.copy(r).add(i),this}setFromObject(r,e=!1){return this.makeEmpty(),this.expandByObject(r,e)}clone(){return new this.constructor().copy(this)}copy(r){return this.min.copy(r.min),this.max.copy(r.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(r){return this.isEmpty()?r.set(0,0,0):r.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(r){return this.isEmpty()?r.set(0,0,0):r.subVectors(this.max,this.min)}expandByPoint(r){return this.min.min(r),this.max.max(r),this}expandByVector(r){return this.min.sub(r),this.max.add(r),this}expandByScalar(r){return this.min.addScalar(-r),this.max.addScalar(r),this}expandByObject(r,e=!1){r.updateWorldMatrix(!1,!1);const i=r.geometry;if(i!==void 0){const s=i.getAttribute("position");if(e===!0&&s!==void 0&&r.isInstancedMesh!==!0)for(let o=0,l=s.count;o<l;o++)r.isMesh===!0?r.getVertexPosition(o,nc):nc.fromBufferAttribute(s,o),nc.applyMatrix4(r.matrixWorld),this.expandByPoint(nc);else r.boundingBox!==void 0?(r.boundingBox===null&&r.computeBoundingBox(),lb.copy(r.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),lb.copy(i.boundingBox)),lb.applyMatrix4(r.matrixWorld),this.union(lb)}const n=r.children;for(let s=0,o=n.length;s<o;s++)this.expandByObject(n[s],e);return this}containsPoint(r){return r.x>=this.min.x&&r.x<=this.max.x&&r.y>=this.min.y&&r.y<=this.max.y&&r.z>=this.min.z&&r.z<=this.max.z}containsBox(r){return this.min.x<=r.min.x&&r.max.x<=this.max.x&&this.min.y<=r.min.y&&r.max.y<=this.max.y&&this.min.z<=r.min.z&&r.max.z<=this.max.z}getParameter(r,e){return e.set((r.x-this.min.x)/(this.max.x-this.min.x),(r.y-this.min.y)/(this.max.y-this.min.y),(r.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(r){return r.max.x>=this.min.x&&r.min.x<=this.max.x&&r.max.y>=this.min.y&&r.min.y<=this.max.y&&r.max.z>=this.min.z&&r.min.z<=this.max.z}intersectsSphere(r){return this.clampPoint(r.center,nc),nc.distanceToSquared(r.center)<=r.radius*r.radius}intersectsPlane(r){let e,i;return r.normal.x>0?(e=r.normal.x*this.min.x,i=r.normal.x*this.max.x):(e=r.normal.x*this.max.x,i=r.normal.x*this.min.x),r.normal.y>0?(e+=r.normal.y*this.min.y,i+=r.normal.y*this.max.y):(e+=r.normal.y*this.max.y,i+=r.normal.y*this.min.y),r.normal.z>0?(e+=r.normal.z*this.min.z,i+=r.normal.z*this.max.z):(e+=r.normal.z*this.max.z,i+=r.normal.z*this.min.z),e<=-r.constant&&i>=-r.constant}intersectsTriangle(r){if(this.isEmpty())return!1;this.getCenter(vA),cb.subVectors(this.max,vA),Em.subVectors(r.a,vA),wm.subVectors(r.b,vA),Cm.subVectors(r.c,vA),Wh.subVectors(wm,Em),Qh.subVectors(Cm,wm),dp.subVectors(Em,Cm);let e=[0,-Wh.z,Wh.y,0,-Qh.z,Qh.y,0,-dp.z,dp.y,Wh.z,0,-Wh.x,Qh.z,0,-Qh.x,dp.z,0,-dp.x,-Wh.y,Wh.x,0,-Qh.y,Qh.x,0,-dp.y,dp.x,0];return!CS(e,Em,wm,Cm,cb)||(e=[1,0,0,0,1,0,0,0,1],!CS(e,Em,wm,Cm,cb))?!1:(ub.crossVectors(Wh,Qh),e=[ub.x,ub.y,ub.z],CS(e,Em,wm,Cm,cb))}clampPoint(r,e){return e.copy(r).clamp(this.min,this.max)}distanceToPoint(r){return this.clampPoint(r,nc).distanceTo(r)}getBoundingSphere(r){return this.isEmpty()?r.makeEmpty():(this.getCenter(r.center),r.radius=this.getSize(nc).length()*.5),r}intersect(r){return this.min.max(r.min),this.max.min(r.max),this.isEmpty()&&this.makeEmpty(),this}union(r){return this.min.min(r.min),this.max.max(r.max),this}applyMatrix4(r){return this.isEmpty()?this:(Tu[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(r),Tu[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(r),Tu[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(r),Tu[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(r),Tu[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(r),Tu[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(r),Tu[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(r),Tu[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(r),this.setFromPoints(Tu),this)}translate(r){return this.min.add(r),this.max.add(r),this}equals(r){return r.min.equals(this.min)&&r.max.equals(this.max)}};const Tu=[new at,new at,new at,new at,new at,new at,new at,new at],nc=new at,lb=new hp,Em=new at,wm=new at,Cm=new at,Wh=new at,Qh=new at,dp=new at,vA=new at,cb=new at,ub=new at,pp=new at;function CS(r,e,i,n,s){for(let o=0,l=r.length-3;o<=l;o+=3){pp.fromArray(r,o);const u=s.x*Math.abs(pp.x)+s.y*Math.abs(pp.y)+s.z*Math.abs(pp.z),c=e.dot(pp),h=i.dot(pp),p=n.dot(pp);if(Math.max(-Math.max(c,h,p),Math.min(c,h,p))>u)return!1}return!0}const SJ=new hp,xA=new at,SS=new at;let hb=class{constructor(r=new at,e=-1){this.isSphere=!0,this.center=r,this.radius=e}set(r,e){return this.center.copy(r),this.radius=e,this}setFromPoints(r,e){const i=this.center;e!==void 0?i.copy(e):SJ.setFromPoints(r).getCenter(i);let n=0;for(let s=0,o=r.length;s<o;s++)n=Math.max(n,i.distanceToSquared(r[s]));return this.radius=Math.sqrt(n),this}copy(r){return this.center.copy(r.center),this.radius=r.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(r){return r.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(r){return r.distanceTo(this.center)-this.radius}intersectsSphere(r){const e=this.radius+r.radius;return r.center.distanceToSquared(this.center)<=e*e}intersectsBox(r){return r.intersectsSphere(this)}intersectsPlane(r){return Math.abs(r.distanceToPoint(this.center))<=this.radius}clampPoint(r,e){const i=this.center.distanceToSquared(r);return e.copy(r),i>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(r){return this.isEmpty()?(r.makeEmpty(),r):(r.set(this.center,this.center),r.expandByScalar(this.radius),r)}applyMatrix4(r){return this.center.applyMatrix4(r),this.radius=this.radius*r.getMaxScaleOnAxis(),this}translate(r){return this.center.add(r),this}expandByPoint(r){if(this.isEmpty())return this.center.copy(r),this.radius=0,this;xA.subVectors(r,this.center);const e=xA.lengthSq();if(e>this.radius*this.radius){const i=Math.sqrt(e),n=(i-this.radius)*.5;this.center.addScaledVector(xA,n/i),this.radius+=n}return this}union(r){return r.isEmpty()?this:this.isEmpty()?(this.copy(r),this):(this.center.equals(r.center)===!0?this.radius=Math.max(this.radius,r.radius):(SS.subVectors(r.center,this.center).setLength(r.radius),this.expandByPoint(xA.copy(r.center).add(SS)),this.expandByPoint(xA.copy(r.center).sub(SS))),this)}equals(r){return r.center.equals(this.center)&&r.radius===this.radius}clone(){return new this.constructor().copy(this)}};const Mu=new at,TS=new at,db=new at,qh=new at,MS=new at,pb=new at,RS=new at;let fb=class{constructor(r=new at,e=new at(0,0,-1)){this.origin=r,this.direction=e}set(r,e){return this.origin.copy(r),this.direction.copy(e),this}copy(r){return this.origin.copy(r.origin),this.direction.copy(r.direction),this}at(r,e){return e.copy(this.origin).addScaledVector(this.direction,r)}lookAt(r){return this.direction.copy(r).sub(this.origin).normalize(),this}recast(r){return this.origin.copy(this.at(r,Mu)),this}closestPointToPoint(r,e){e.subVectors(r,this.origin);const i=e.dot(this.direction);return i<0?e.copy(this.origin):e.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(r){return Math.sqrt(this.distanceSqToPoint(r))}distanceSqToPoint(r){const e=Mu.subVectors(r,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(r):(Mu.copy(this.origin).addScaledVector(this.direction,e),Mu.distanceToSquared(r))}distanceSqToSegment(r,e,i,n){TS.copy(r).add(e).multiplyScalar(.5),db.copy(e).sub(r).normalize(),qh.copy(this.origin).sub(TS);const s=r.distanceTo(e)*.5,o=-this.direction.dot(db),l=qh.dot(this.direction),u=-qh.dot(db),c=qh.lengthSq(),h=Math.abs(1-o*o);let p,f,m,g;if(h>0)if(p=o*u-l,f=o*l-u,g=s*h,p>=0)if(f>=-g)if(f<=g){const y=1/h;p*=y,f*=y,m=p*(p+o*f+2*l)+f*(o*p+f+2*u)+c}else f=s,p=Math.max(0,-(o*f+l)),m=-p*p+f*(f+2*u)+c;else f=-s,p=Math.max(0,-(o*f+l)),m=-p*p+f*(f+2*u)+c;else f<=-g?(p=Math.max(0,-(-o*s+l)),f=p>0?-s:Math.min(Math.max(-s,-u),s),m=-p*p+f*(f+2*u)+c):f<=g?(p=0,f=Math.min(Math.max(-s,-u),s),m=f*(f+2*u)+c):(p=Math.max(0,-(o*s+l)),f=p>0?s:Math.min(Math.max(-s,-u),s),m=-p*p+f*(f+2*u)+c);else f=o>0?-s:s,p=Math.max(0,-(o*f+l)),m=-p*p+f*(f+2*u)+c;return i&&i.copy(this.origin).addScaledVector(this.direction,p),n&&n.copy(TS).addScaledVector(db,f),m}intersectSphere(r,e){Mu.subVectors(r.center,this.origin);const i=Mu.dot(this.direction),n=Mu.dot(Mu)-i*i,s=r.radius*r.radius;if(n>s)return null;const o=Math.sqrt(s-n),l=i-o,u=i+o;return u<0?null:l<0?this.at(u,e):this.at(l,e)}intersectsSphere(r){return this.distanceSqToPoint(r.center)<=r.radius*r.radius}distanceToPlane(r){const e=r.normal.dot(this.direction);if(e===0)return r.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(r.normal)+r.constant)/e;return i>=0?i:null}intersectPlane(r,e){const i=this.distanceToPlane(r);return i===null?null:this.at(i,e)}intersectsPlane(r){const e=r.distanceToPoint(this.origin);return e===0||r.normal.dot(this.direction)*e<0}intersectBox(r,e){let i,n,s,o,l,u;const c=1/this.direction.x,h=1/this.direction.y,p=1/this.direction.z,f=this.origin;return c>=0?(i=(r.min.x-f.x)*c,n=(r.max.x-f.x)*c):(i=(r.max.x-f.x)*c,n=(r.min.x-f.x)*c),h>=0?(s=(r.min.y-f.y)*h,o=(r.max.y-f.y)*h):(s=(r.max.y-f.y)*h,o=(r.min.y-f.y)*h),i>o||s>n||((s>i||isNaN(i))&&(i=s),(o<n||isNaN(n))&&(n=o),p>=0?(l=(r.min.z-f.z)*p,u=(r.max.z-f.z)*p):(l=(r.max.z-f.z)*p,u=(r.min.z-f.z)*p),i>u||l>n)||((l>i||i!==i)&&(i=l),(u<n||n!==n)&&(n=u),n<0)?null:this.at(i>=0?i:n,e)}intersectsBox(r){return this.intersectBox(r,Mu)!==null}intersectTriangle(r,e,i,n,s){MS.subVectors(e,r),pb.subVectors(i,r),RS.crossVectors(MS,pb);let o=this.direction.dot(RS),l;if(o>0){if(n)return null;l=1}else if(o<0)l=-1,o=-o;else return null;qh.subVectors(this.origin,r);const u=l*this.direction.dot(pb.crossVectors(qh,pb));if(u<0)return null;const c=l*this.direction.dot(MS.cross(qh));if(c<0||u+c>o)return null;const h=-l*qh.dot(RS);return h<0?null:this.at(h/o,s)}applyMatrix4(r){return this.origin.applyMatrix4(r),this.direction.transformDirection(r),this}equals(r){return r.origin.equals(this.origin)&&r.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},As=class uL{constructor(e,i,n,s,o,l,u,c,h,p,f,m,g,y,x,v){uL.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,i,n,s,o,l,u,c,h,p,f,m,g,y,x,v)}set(e,i,n,s,o,l,u,c,h,p,f,m,g,y,x,v){const _=this.elements;return _[0]=e,_[4]=i,_[8]=n,_[12]=s,_[1]=o,_[5]=l,_[9]=u,_[13]=c,_[2]=h,_[6]=p,_[10]=f,_[14]=m,_[3]=g,_[7]=y,_[11]=x,_[15]=v,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new uL().fromArray(this.elements)}copy(e){const i=this.elements,n=e.elements;return i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],this}copyPosition(e){const i=this.elements,n=e.elements;return i[12]=n[12],i[13]=n[13],i[14]=n[14],this}setFromMatrix3(e){const i=e.elements;return this.set(i[0],i[3],i[6],0,i[1],i[4],i[7],0,i[2],i[5],i[8],0,0,0,0,1),this}extractBasis(e,i,n){return e.setFromMatrixColumn(this,0),i.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,i,n){return this.set(e.x,i.x,n.x,0,e.y,i.y,n.y,0,e.z,i.z,n.z,0,0,0,0,1),this}extractRotation(e){const i=this.elements,n=e.elements,s=1/Sm.setFromMatrixColumn(e,0).length(),o=1/Sm.setFromMatrixColumn(e,1).length(),l=1/Sm.setFromMatrixColumn(e,2).length();return i[0]=n[0]*s,i[1]=n[1]*s,i[2]=n[2]*s,i[3]=0,i[4]=n[4]*o,i[5]=n[5]*o,i[6]=n[6]*o,i[7]=0,i[8]=n[8]*l,i[9]=n[9]*l,i[10]=n[10]*l,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromEuler(e){const i=this.elements,n=e.x,s=e.y,o=e.z,l=Math.cos(n),u=Math.sin(n),c=Math.cos(s),h=Math.sin(s),p=Math.cos(o),f=Math.sin(o);if(e.order==="XYZ"){const m=l*p,g=l*f,y=u*p,x=u*f;i[0]=c*p,i[4]=-c*f,i[8]=h,i[1]=g+y*h,i[5]=m-x*h,i[9]=-u*c,i[2]=x-m*h,i[6]=y+g*h,i[10]=l*c}else if(e.order==="YXZ"){const m=c*p,g=c*f,y=h*p,x=h*f;i[0]=m+x*u,i[4]=y*u-g,i[8]=l*h,i[1]=l*f,i[5]=l*p,i[9]=-u,i[2]=g*u-y,i[6]=x+m*u,i[10]=l*c}else if(e.order==="ZXY"){const m=c*p,g=c*f,y=h*p,x=h*f;i[0]=m-x*u,i[4]=-l*f,i[8]=y+g*u,i[1]=g+y*u,i[5]=l*p,i[9]=x-m*u,i[2]=-l*h,i[6]=u,i[10]=l*c}else if(e.order==="ZYX"){const m=l*p,g=l*f,y=u*p,x=u*f;i[0]=c*p,i[4]=y*h-g,i[8]=m*h+x,i[1]=c*f,i[5]=x*h+m,i[9]=g*h-y,i[2]=-h,i[6]=u*c,i[10]=l*c}else if(e.order==="YZX"){const m=l*c,g=l*h,y=u*c,x=u*h;i[0]=c*p,i[4]=x-m*f,i[8]=y*f+g,i[1]=f,i[5]=l*p,i[9]=-u*p,i[2]=-h*p,i[6]=g*f+y,i[10]=m-x*f}else if(e.order==="XZY"){const m=l*c,g=l*h,y=u*c,x=u*h;i[0]=c*p,i[4]=-f,i[8]=h*p,i[1]=m*f+x,i[5]=l*p,i[9]=g*f-y,i[2]=y*f-g,i[6]=u*p,i[10]=x*f+m}return i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromQuaternion(e){return this.compose(TJ,e,MJ)}lookAt(e,i,n){const s=this.elements;return cl.subVectors(e,i),cl.lengthSq()===0&&(cl.z=1),cl.normalize(),Xh.crossVectors(n,cl),Xh.lengthSq()===0&&(Math.abs(n.z)===1?cl.x+=1e-4:cl.z+=1e-4,cl.normalize(),Xh.crossVectors(n,cl)),Xh.normalize(),mb.crossVectors(cl,Xh),s[0]=Xh.x,s[4]=mb.x,s[8]=cl.x,s[1]=Xh.y,s[5]=mb.y,s[9]=cl.y,s[2]=Xh.z,s[6]=mb.z,s[10]=cl.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,i){const n=e.elements,s=i.elements,o=this.elements,l=n[0],u=n[4],c=n[8],h=n[12],p=n[1],f=n[5],m=n[9],g=n[13],y=n[2],x=n[6],v=n[10],_=n[14],T=n[3],w=n[7],S=n[11],R=n[15],B=s[0],I=s[4],D=s[8],L=s[12],O=s[1],U=s[5],Z=s[9],G=s[13],z=s[2],$=s[6],Q=s[10],H=s[14],V=s[3],ne=s[7],Y=s[11],ae=s[15];return o[0]=l*B+u*O+c*z+h*V,o[4]=l*I+u*U+c*$+h*ne,o[8]=l*D+u*Z+c*Q+h*Y,o[12]=l*L+u*G+c*H+h*ae,o[1]=p*B+f*O+m*z+g*V,o[5]=p*I+f*U+m*$+g*ne,o[9]=p*D+f*Z+m*Q+g*Y,o[13]=p*L+f*G+m*H+g*ae,o[2]=y*B+x*O+v*z+_*V,o[6]=y*I+x*U+v*$+_*ne,o[10]=y*D+x*Z+v*Q+_*Y,o[14]=y*L+x*G+v*H+_*ae,o[3]=T*B+w*O+S*z+R*V,o[7]=T*I+w*U+S*$+R*ne,o[11]=T*D+w*Z+S*Q+R*Y,o[15]=T*L+w*G+S*H+R*ae,this}multiplyScalar(e){const i=this.elements;return i[0]*=e,i[4]*=e,i[8]*=e,i[12]*=e,i[1]*=e,i[5]*=e,i[9]*=e,i[13]*=e,i[2]*=e,i[6]*=e,i[10]*=e,i[14]*=e,i[3]*=e,i[7]*=e,i[11]*=e,i[15]*=e,this}determinant(){const e=this.elements,i=e[0],n=e[4],s=e[8],o=e[12],l=e[1],u=e[5],c=e[9],h=e[13],p=e[2],f=e[6],m=e[10],g=e[14],y=e[3],x=e[7],v=e[11],_=e[15];return y*(+o*c*f-s*h*f-o*u*m+n*h*m+s*u*g-n*c*g)+x*(+i*c*g-i*h*m+o*l*m-s*l*g+s*h*p-o*c*p)+v*(+i*h*f-i*u*g-o*l*f+n*l*g+o*u*p-n*h*p)+_*(-s*u*p-i*c*f+i*u*m+s*l*f-n*l*m+n*c*p)}transpose(){const e=this.elements;let i;return i=e[1],e[1]=e[4],e[4]=i,i=e[2],e[2]=e[8],e[8]=i,i=e[6],e[6]=e[9],e[9]=i,i=e[3],e[3]=e[12],e[12]=i,i=e[7],e[7]=e[13],e[13]=i,i=e[11],e[11]=e[14],e[14]=i,this}setPosition(e,i,n){const s=this.elements;return e.isVector3?(s[12]=e.x,s[13]=e.y,s[14]=e.z):(s[12]=e,s[13]=i,s[14]=n),this}invert(){const e=this.elements,i=e[0],n=e[1],s=e[2],o=e[3],l=e[4],u=e[5],c=e[6],h=e[7],p=e[8],f=e[9],m=e[10],g=e[11],y=e[12],x=e[13],v=e[14],_=e[15],T=f*v*h-x*m*h+x*c*g-u*v*g-f*c*_+u*m*_,w=y*m*h-p*v*h-y*c*g+l*v*g+p*c*_-l*m*_,S=p*x*h-y*f*h+y*u*g-l*x*g-p*u*_+l*f*_,R=y*f*c-p*x*c-y*u*m+l*x*m+p*u*v-l*f*v,B=i*T+n*w+s*S+o*R;if(B===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const I=1/B;return e[0]=T*I,e[1]=(x*m*o-f*v*o-x*s*g+n*v*g+f*s*_-n*m*_)*I,e[2]=(u*v*o-x*c*o+x*s*h-n*v*h-u*s*_+n*c*_)*I,e[3]=(f*c*o-u*m*o-f*s*h+n*m*h+u*s*g-n*c*g)*I,e[4]=w*I,e[5]=(p*v*o-y*m*o+y*s*g-i*v*g-p*s*_+i*m*_)*I,e[6]=(y*c*o-l*v*o-y*s*h+i*v*h+l*s*_-i*c*_)*I,e[7]=(l*m*o-p*c*o+p*s*h-i*m*h-l*s*g+i*c*g)*I,e[8]=S*I,e[9]=(y*f*o-p*x*o-y*n*g+i*x*g+p*n*_-i*f*_)*I,e[10]=(l*x*o-y*u*o+y*n*h-i*x*h-l*n*_+i*u*_)*I,e[11]=(p*u*o-l*f*o-p*n*h+i*f*h+l*n*g-i*u*g)*I,e[12]=R*I,e[13]=(p*x*s-y*f*s+y*n*m-i*x*m-p*n*v+i*f*v)*I,e[14]=(y*u*s-l*x*s-y*n*c+i*x*c+l*n*v-i*u*v)*I,e[15]=(l*f*s-p*u*s+p*n*c-i*f*c-l*n*m+i*u*m)*I,this}scale(e){const i=this.elements,n=e.x,s=e.y,o=e.z;return i[0]*=n,i[4]*=s,i[8]*=o,i[1]*=n,i[5]*=s,i[9]*=o,i[2]*=n,i[6]*=s,i[10]*=o,i[3]*=n,i[7]*=s,i[11]*=o,this}getMaxScaleOnAxis(){const e=this.elements,i=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],s=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(i,n,s))}makeTranslation(e,i,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,i,0,0,1,n,0,0,0,1),this}makeRotationX(e){const i=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,i,-n,0,0,n,i,0,0,0,0,1),this}makeRotationY(e){const i=Math.cos(e),n=Math.sin(e);return this.set(i,0,n,0,0,1,0,0,-n,0,i,0,0,0,0,1),this}makeRotationZ(e){const i=Math.cos(e),n=Math.sin(e);return this.set(i,-n,0,0,n,i,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,i){const n=Math.cos(i),s=Math.sin(i),o=1-n,l=e.x,u=e.y,c=e.z,h=o*l,p=o*u;return this.set(h*l+n,h*u-s*c,h*c+s*u,0,h*u+s*c,p*u+n,p*c-s*l,0,h*c-s*u,p*c+s*l,o*c*c+n,0,0,0,0,1),this}makeScale(e,i,n){return this.set(e,0,0,0,0,i,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,i,n,s,o,l){return this.set(1,n,o,0,e,1,l,0,i,s,1,0,0,0,0,1),this}compose(e,i,n){const s=this.elements,o=i._x,l=i._y,u=i._z,c=i._w,h=o+o,p=l+l,f=u+u,m=o*h,g=o*p,y=o*f,x=l*p,v=l*f,_=u*f,T=c*h,w=c*p,S=c*f,R=n.x,B=n.y,I=n.z;return s[0]=(1-(x+_))*R,s[1]=(g+S)*R,s[2]=(y-w)*R,s[3]=0,s[4]=(g-S)*B,s[5]=(1-(m+_))*B,s[6]=(v+T)*B,s[7]=0,s[8]=(y+w)*I,s[9]=(v-T)*I,s[10]=(1-(m+x))*I,s[11]=0,s[12]=e.x,s[13]=e.y,s[14]=e.z,s[15]=1,this}decompose(e,i,n){const s=this.elements;let o=Sm.set(s[0],s[1],s[2]).length();const l=Sm.set(s[4],s[5],s[6]).length(),u=Sm.set(s[8],s[9],s[10]).length();this.determinant()<0&&(o=-o),e.x=s[12],e.y=s[13],e.z=s[14],sc.copy(this);const c=1/o,h=1/l,p=1/u;return sc.elements[0]*=c,sc.elements[1]*=c,sc.elements[2]*=c,sc.elements[4]*=h,sc.elements[5]*=h,sc.elements[6]*=h,sc.elements[8]*=p,sc.elements[9]*=p,sc.elements[10]*=p,i.setFromRotationMatrix(sc),n.x=o,n.y=l,n.z=u,this}makePerspective(e,i,n,s,o,l,u=wu){const c=this.elements,h=2*o/(i-e),p=2*o/(n-s),f=(i+e)/(i-e),m=(n+s)/(n-s);let g,y;if(u===wu)g=-(l+o)/(l-o),y=-2*l*o/(l-o);else if(u===ob)g=-l/(l-o),y=-l*o/(l-o);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+u);return c[0]=h,c[4]=0,c[8]=f,c[12]=0,c[1]=0,c[5]=p,c[9]=m,c[13]=0,c[2]=0,c[6]=0,c[10]=g,c[14]=y,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}makeOrthographic(e,i,n,s,o,l,u=wu){const c=this.elements,h=1/(i-e),p=1/(n-s),f=1/(l-o),m=(i+e)*h,g=(n+s)*p;let y,x;if(u===wu)y=(l+o)*f,x=-2*f;else if(u===ob)y=o*f,x=-1*f;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+u);return c[0]=2*h,c[4]=0,c[8]=0,c[12]=-m,c[1]=0,c[5]=2*p,c[9]=0,c[13]=-g,c[2]=0,c[6]=0,c[10]=x,c[14]=-y,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}equals(e){const i=this.elements,n=e.elements;for(let s=0;s<16;s++)if(i[s]!==n[s])return!1;return!0}fromArray(e,i=0){for(let n=0;n<16;n++)this.elements[n]=e[n+i];return this}toArray(e=[],i=0){const n=this.elements;return e[i]=n[0],e[i+1]=n[1],e[i+2]=n[2],e[i+3]=n[3],e[i+4]=n[4],e[i+5]=n[5],e[i+6]=n[6],e[i+7]=n[7],e[i+8]=n[8],e[i+9]=n[9],e[i+10]=n[10],e[i+11]=n[11],e[i+12]=n[12],e[i+13]=n[13],e[i+14]=n[14],e[i+15]=n[15],e}};const Sm=new at,sc=new As,TJ=new at(0,0,0),MJ=new at(1,1,1),Xh=new at,mb=new at,cl=new at,WP=new As,QP=new Uc;let Yh=class dH{constructor(e=0,i=0,n=0,s=dH.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=i,this._z=n,this._order=s}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,i,n,s=this._order){return this._x=e,this._y=i,this._z=n,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,i=this._order,n=!0){const s=e.elements,o=s[0],l=s[4],u=s[8],c=s[1],h=s[5],p=s[9],f=s[2],m=s[6],g=s[10];switch(i){case"XYZ":this._y=Math.asin(Ta(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-p,g),this._z=Math.atan2(-l,o)):(this._x=Math.atan2(m,h),this._z=0);break;case"YXZ":this._x=Math.asin(-Ta(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(u,g),this._z=Math.atan2(c,h)):(this._y=Math.atan2(-f,o),this._z=0);break;case"ZXY":this._x=Math.asin(Ta(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(-f,g),this._z=Math.atan2(-l,h)):(this._y=0,this._z=Math.atan2(c,o));break;case"ZYX":this._y=Math.asin(-Ta(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(m,g),this._z=Math.atan2(c,o)):(this._x=0,this._z=Math.atan2(-l,h));break;case"YZX":this._z=Math.asin(Ta(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-p,h),this._y=Math.atan2(-f,o)):(this._x=0,this._y=Math.atan2(u,g));break;case"XZY":this._z=Math.asin(-Ta(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(m,h),this._y=Math.atan2(u,o)):(this._x=Math.atan2(-p,g),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,i,n){return WP.makeRotationFromQuaternion(e),this.setFromRotationMatrix(WP,i,n)}setFromVector3(e,i=this._order){return this.set(e.x,e.y,e.z,i)}reorder(e){return QP.setFromEuler(this),this.setFromQuaternion(QP,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],i=0){return e[i]=this._x,e[i+1]=this._y,e[i+2]=this._z,e[i+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};Yh.DEFAULT_ORDER="XYZ";let IS=class{constructor(){this.mask=1}set(r){this.mask=(1<<r|0)>>>0}enable(r){this.mask|=1<<r|0}enableAll(){this.mask=-1}toggle(r){this.mask^=1<<r|0}disable(r){this.mask&=~(1<<r|0)}disableAll(){this.mask=0}test(r){return(this.mask&r.mask)!==0}isEnabled(r){return(this.mask&(1<<r|0))!==0}},RJ=0;const qP=new at,Tm=new Uc,Ru=new As,gb=new at,bA=new at,IJ=new at,BJ=new Uc,XP=new at(1,0,0),YP=new at(0,1,0),KP=new at(0,0,1),JP={type:"added"},NJ={type:"removed"},Mm={type:"childadded",child:null},BS={type:"childremoved",child:null};let to=class e2 extends up{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:RJ++}),this.uuid=Cu(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=e2.DEFAULT_UP.clone();const e=new at,i=new Yh,n=new Uc,s=new at(1,1,1);function o(){n.setFromEuler(i,!1)}function l(){i.setFromQuaternion(n,void 0,!1)}i._onChange(o),n._onChange(l),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new As},normalMatrix:{value:new gn}}),this.matrix=new As,this.matrixWorld=new As,this.matrixAutoUpdate=e2.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=e2.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new IS,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,i){this.quaternion.setFromAxisAngle(e,i)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,i){return Tm.setFromAxisAngle(e,i),this.quaternion.multiply(Tm),this}rotateOnWorldAxis(e,i){return Tm.setFromAxisAngle(e,i),this.quaternion.premultiply(Tm),this}rotateX(e){return this.rotateOnAxis(XP,e)}rotateY(e){return this.rotateOnAxis(YP,e)}rotateZ(e){return this.rotateOnAxis(KP,e)}translateOnAxis(e,i){return qP.copy(e).applyQuaternion(this.quaternion),this.position.add(qP.multiplyScalar(i)),this}translateX(e){return this.translateOnAxis(XP,e)}translateY(e){return this.translateOnAxis(YP,e)}translateZ(e){return this.translateOnAxis(KP,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Ru.copy(this.matrixWorld).invert())}lookAt(e,i,n){e.isVector3?gb.copy(e):gb.set(e,i,n);const s=this.parent;this.updateWorldMatrix(!0,!1),bA.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ru.lookAt(bA,gb,this.up):Ru.lookAt(gb,bA,this.up),this.quaternion.setFromRotationMatrix(Ru),s&&(Ru.extractRotation(s.matrixWorld),Tm.setFromRotationMatrix(Ru),this.quaternion.premultiply(Tm.invert()))}add(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(JP),Mm.child=e,this.dispatchEvent(Mm),Mm.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const i=this.children.indexOf(e);return i!==-1&&(e.parent=null,this.children.splice(i,1),e.dispatchEvent(NJ),BS.child=e,this.dispatchEvent(BS),BS.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Ru.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Ru.multiply(e.parent.matrixWorld)),e.applyMatrix4(Ru),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(JP),Mm.child=e,this.dispatchEvent(Mm),Mm.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,i){if(this[e]===i)return this;for(let n=0,s=this.children.length;n<s;n++){const o=this.children[n].getObjectByProperty(e,i);if(o!==void 0)return o}}getObjectsByProperty(e,i,n=[]){this[e]===i&&n.push(this);const s=this.children;for(let o=0,l=s.length;o<l;o++)s[o].getObjectsByProperty(e,i,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(bA,e,IJ),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(bA,BJ,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return e.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(e){e(this);const i=this.children;for(let n=0,s=i.length;n<s;n++)i[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const i=this.children;for(let n=0,s=i.length;n<s;n++)i[n].traverseVisible(e)}traverseAncestors(e){const i=this.parent;i!==null&&(e(i),i.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const i=this.children;for(let n=0,s=i.length;n<s;n++)i[n].updateMatrixWorld(e)}updateWorldMatrix(e,i){const n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),i===!0){const s=this.children;for(let o=0,l=s.length;o<l;o++)s[o].updateWorldMatrix(!1,!0)}}toJSON(e){const i=e===void 0||typeof e=="string",n={};i&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const s={};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.castShadow===!0&&(s.castShadow=!0),this.receiveShadow===!0&&(s.receiveShadow=!0),this.visible===!1&&(s.visible=!1),this.frustumCulled===!1&&(s.frustumCulled=!1),this.renderOrder!==0&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(s.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(s.type="BatchedMesh",s.perObjectFrustumCulled=this.perObjectFrustumCulled,s.sortObjects=this.sortObjects,s.drawRanges=this._drawRanges,s.reservedRanges=this._reservedRanges,s.visibility=this._visibility,s.active=this._active,s.bounds=this._bounds.map(u=>({boxInitialized:u.boxInitialized,boxMin:u.box.min.toArray(),boxMax:u.box.max.toArray(),sphereInitialized:u.sphereInitialized,sphereRadius:u.sphere.radius,sphereCenter:u.sphere.center.toArray()})),s.maxInstanceCount=this._maxInstanceCount,s.maxVertexCount=this._maxVertexCount,s.maxIndexCount=this._maxIndexCount,s.geometryInitialized=this._geometryInitialized,s.geometryCount=this._geometryCount,s.matricesTexture=this._matricesTexture.toJSON(e),this._colorsTexture!==null&&(s.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(s.boundingSphere={center:s.boundingSphere.center.toArray(),radius:s.boundingSphere.radius}),this.boundingBox!==null&&(s.boundingBox={min:s.boundingBox.min.toArray(),max:s.boundingBox.max.toArray()}));function o(u,c){return u[c.uuid]===void 0&&(u[c.uuid]=c.toJSON(e)),c.uuid}if(this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(s.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(e.geometries,this.geometry);const u=this.geometry.parameters;if(u!==void 0&&u.shapes!==void 0){const c=u.shapes;if(Array.isArray(c))for(let h=0,p=c.length;h<p;h++){const f=c[h];o(e.shapes,f)}else o(e.shapes,c)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(o(e.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const u=[];for(let c=0,h=this.material.length;c<h;c++)u.push(o(e.materials,this.material[c]));s.material=u}else s.material=o(e.materials,this.material);if(this.children.length>0){s.children=[];for(let u=0;u<this.children.length;u++)s.children.push(this.children[u].toJSON(e).object)}if(this.animations.length>0){s.animations=[];for(let u=0;u<this.animations.length;u++){const c=this.animations[u];s.animations.push(o(e.animations,c))}}if(i){const u=l(e.geometries),c=l(e.materials),h=l(e.textures),p=l(e.images),f=l(e.shapes),m=l(e.skeletons),g=l(e.animations),y=l(e.nodes);u.length>0&&(n.geometries=u),c.length>0&&(n.materials=c),h.length>0&&(n.textures=h),p.length>0&&(n.images=p),f.length>0&&(n.shapes=f),m.length>0&&(n.skeletons=m),g.length>0&&(n.animations=g),y.length>0&&(n.nodes=y)}return n.object=s,n;function l(u){const c=[];for(const h in u){const p=u[h];delete p.metadata,c.push(p)}return c}}clone(e){return new this.constructor().copy(this,e)}copy(e,i=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),i===!0)for(let n=0;n<e.children.length;n++){const s=e.children[n];this.add(s.clone())}return this}};to.DEFAULT_UP=new at(0,1,0),to.DEFAULT_MATRIX_AUTO_UPDATE=!0,to.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const ac=new at,Iu=new at,NS=new at,Bu=new at,Rm=new at,Im=new at,ZP=new at,LS=new at,DS=new at,OS=new at,PS=new Js,kS=new Js,FS=new Js;let fp=class D0{constructor(e=new at,i=new at,n=new at){this.a=e,this.b=i,this.c=n}static getNormal(e,i,n,s){s.subVectors(n,i),ac.subVectors(e,i),s.cross(ac);const o=s.lengthSq();return o>0?s.multiplyScalar(1/Math.sqrt(o)):s.set(0,0,0)}static getBarycoord(e,i,n,s,o){ac.subVectors(s,i),Iu.subVectors(n,i),NS.subVectors(e,i);const l=ac.dot(ac),u=ac.dot(Iu),c=ac.dot(NS),h=Iu.dot(Iu),p=Iu.dot(NS),f=l*h-u*u;if(f===0)return o.set(0,0,0),null;const m=1/f,g=(h*c-u*p)*m,y=(l*p-u*c)*m;return o.set(1-g-y,y,g)}static containsPoint(e,i,n,s){return this.getBarycoord(e,i,n,s,Bu)===null?!1:Bu.x>=0&&Bu.y>=0&&Bu.x+Bu.y<=1}static getInterpolation(e,i,n,s,o,l,u,c){return this.getBarycoord(e,i,n,s,Bu)===null?(c.x=0,c.y=0,"z"in c&&(c.z=0),"w"in c&&(c.w=0),null):(c.setScalar(0),c.addScaledVector(o,Bu.x),c.addScaledVector(l,Bu.y),c.addScaledVector(u,Bu.z),c)}static getInterpolatedAttribute(e,i,n,s,o,l){return PS.setScalar(0),kS.setScalar(0),FS.setScalar(0),PS.fromBufferAttribute(e,i),kS.fromBufferAttribute(e,n),FS.fromBufferAttribute(e,s),l.setScalar(0),l.addScaledVector(PS,o.x),l.addScaledVector(kS,o.y),l.addScaledVector(FS,o.z),l}static isFrontFacing(e,i,n,s){return ac.subVectors(n,i),Iu.subVectors(e,i),ac.cross(Iu).dot(s)<0}set(e,i,n){return this.a.copy(e),this.b.copy(i),this.c.copy(n),this}setFromPointsAndIndices(e,i,n,s){return this.a.copy(e[i]),this.b.copy(e[n]),this.c.copy(e[s]),this}setFromAttributeAndIndices(e,i,n,s){return this.a.fromBufferAttribute(e,i),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,s),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return ac.subVectors(this.c,this.b),Iu.subVectors(this.a,this.b),ac.cross(Iu).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return D0.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,i){return D0.getBarycoord(e,this.a,this.b,this.c,i)}getInterpolation(e,i,n,s,o){return D0.getInterpolation(e,this.a,this.b,this.c,i,n,s,o)}containsPoint(e){return D0.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return D0.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,i){const n=this.a,s=this.b,o=this.c;let l,u;Rm.subVectors(s,n),Im.subVectors(o,n),LS.subVectors(e,n);const c=Rm.dot(LS),h=Im.dot(LS);if(c<=0&&h<=0)return i.copy(n);DS.subVectors(e,s);const p=Rm.dot(DS),f=Im.dot(DS);if(p>=0&&f<=p)return i.copy(s);const m=c*f-p*h;if(m<=0&&c>=0&&p<=0)return l=c/(c-p),i.copy(n).addScaledVector(Rm,l);OS.subVectors(e,o);const g=Rm.dot(OS),y=Im.dot(OS);if(y>=0&&g<=y)return i.copy(o);const x=g*h-c*y;if(x<=0&&h>=0&&y<=0)return u=h/(h-y),i.copy(n).addScaledVector(Im,u);const v=p*y-g*f;if(v<=0&&f-p>=0&&g-y>=0)return ZP.subVectors(o,s),u=(f-p)/(f-p+(g-y)),i.copy(s).addScaledVector(ZP,u);const _=1/(v+x+m);return l=x*_,u=m*_,i.copy(n).addScaledVector(Rm,l).addScaledVector(Im,u)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}};const $P={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Kh={h:0,s:0,l:0},Ab={h:0,s:0,l:0};function US(r,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?r+(e-r)*6*i:i<1/2?e:i<2/3?r+(e-r)*6*(2/3-i):r}let Tn=class{constructor(r,e,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(r,e,i)}set(r,e,i){if(e===void 0&&i===void 0){const n=r;n&&n.isColor?this.copy(n):typeof n=="number"?this.setHex(n):typeof n=="string"&&this.setStyle(n)}else this.setRGB(r,e,i);return this}setScalar(r){return this.r=r,this.g=r,this.b=r,this}setHex(r,e=zo){return r=Math.floor(r),this.r=(r>>16&255)/255,this.g=(r>>8&255)/255,this.b=(r&255)/255,zn.toWorkingColorSpace(this,e),this}setRGB(r,e,i,n=zn.workingColorSpace){return this.r=r,this.g=e,this.b=i,zn.toWorkingColorSpace(this,n),this}setHSL(r,e,i,n=zn.workingColorSpace){if(r=xS(r,1),e=Ta(e,0,1),i=Ta(i,0,1),e===0)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+e):i+e-i*e,o=2*i-s;this.r=US(o,s,r+1/3),this.g=US(o,s,r),this.b=US(o,s,r-1/3)}return zn.toWorkingColorSpace(this,n),this}setStyle(r,e=zo){function i(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+r+" will be ignored.")}let n;if(n=/^(\w+)\(([^\)]*)\)/.exec(r)){let s;const o=n[1],l=n[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,e);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,e);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,e);break;default:console.warn("THREE.Color: Unknown color model "+r)}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(r)){const s=n[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,e);if(o===6)return this.setHex(parseInt(s,16),e);console.warn("THREE.Color: Invalid hex color "+r)}else if(r&&r.length>0)return this.setColorName(r,e);return this}setColorName(r,e=zo){const i=$P[r.toLowerCase()];return i!==void 0?this.setHex(i,e):console.warn("THREE.Color: Unknown color "+r),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(r){return this.r=r.r,this.g=r.g,this.b=r.b,this}copySRGBToLinear(r){return this.r=Su(r.r),this.g=Su(r.g),this.b=Su(r.b),this}copyLinearToSRGB(r){return this.r=bm(r.r),this.g=bm(r.g),this.b=bm(r.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(r=zo){return zn.fromWorkingColorSpace(io.copy(this),r),Math.round(Ta(io.r*255,0,255))*65536+Math.round(Ta(io.g*255,0,255))*256+Math.round(Ta(io.b*255,0,255))}getHexString(r=zo){return("000000"+this.getHex(r).toString(16)).slice(-6)}getHSL(r,e=zn.workingColorSpace){zn.fromWorkingColorSpace(io.copy(this),e);const i=io.r,n=io.g,s=io.b,o=Math.max(i,n,s),l=Math.min(i,n,s);let u,c;const h=(l+o)/2;if(l===o)u=0,c=0;else{const p=o-l;switch(c=h<=.5?p/(o+l):p/(2-o-l),o){case i:u=(n-s)/p+(n<s?6:0);break;case n:u=(s-i)/p+2;break;case s:u=(i-n)/p+4;break}u/=6}return r.h=u,r.s=c,r.l=h,r}getRGB(r,e=zn.workingColorSpace){return zn.fromWorkingColorSpace(io.copy(this),e),r.r=io.r,r.g=io.g,r.b=io.b,r}getStyle(r=zo){zn.fromWorkingColorSpace(io.copy(this),r);const e=io.r,i=io.g,n=io.b;return r!==zo?`color(${r} ${e.toFixed(3)} ${i.toFixed(3)} ${n.toFixed(3)})`:`rgb(${Math.round(e*255)},${Math.round(i*255)},${Math.round(n*255)})`}offsetHSL(r,e,i){return this.getHSL(Kh),this.setHSL(Kh.h+r,Kh.s+e,Kh.l+i)}add(r){return this.r+=r.r,this.g+=r.g,this.b+=r.b,this}addColors(r,e){return this.r=r.r+e.r,this.g=r.g+e.g,this.b=r.b+e.b,this}addScalar(r){return this.r+=r,this.g+=r,this.b+=r,this}sub(r){return this.r=Math.max(0,this.r-r.r),this.g=Math.max(0,this.g-r.g),this.b=Math.max(0,this.b-r.b),this}multiply(r){return this.r*=r.r,this.g*=r.g,this.b*=r.b,this}multiplyScalar(r){return this.r*=r,this.g*=r,this.b*=r,this}lerp(r,e){return this.r+=(r.r-this.r)*e,this.g+=(r.g-this.g)*e,this.b+=(r.b-this.b)*e,this}lerpColors(r,e,i){return this.r=r.r+(e.r-r.r)*i,this.g=r.g+(e.g-r.g)*i,this.b=r.b+(e.b-r.b)*i,this}lerpHSL(r,e){this.getHSL(Kh),r.getHSL(Ab);const i=gA(Kh.h,Ab.h,e),n=gA(Kh.s,Ab.s,e),s=gA(Kh.l,Ab.l,e);return this.setHSL(i,n,s),this}setFromVector3(r){return this.r=r.x,this.g=r.y,this.b=r.z,this}applyMatrix3(r){const e=this.r,i=this.g,n=this.b,s=r.elements;return this.r=s[0]*e+s[3]*i+s[6]*n,this.g=s[1]*e+s[4]*i+s[7]*n,this.b=s[2]*e+s[5]*i+s[8]*n,this}equals(r){return r.r===this.r&&r.g===this.g&&r.b===this.b}fromArray(r,e=0){return this.r=r[e],this.g=r[e+1],this.b=r[e+2],this}toArray(r=[],e=0){return r[e]=this.r,r[e+1]=this.g,r[e+2]=this.b,r}fromBufferAttribute(r,e){return this.r=r.getX(e),this.g=r.getY(e),this.b=r.getZ(e),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const io=new Tn;Tn.NAMES=$P;let LJ=0,mp=class extends up{static get type(){return"Material"}get type(){return this.constructor.type}set type(r){}constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:LJ++}),this.uuid=Cu(),this.name="",this.blending=hm,this.side=jh,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=SC,this.blendDst=TC,this.blendEquation=ap,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Tn(0,0,0),this.blendAlpha=0,this.depthFunc=dm,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=BP,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=xm,this.stencilZFail=xm,this.stencilZPass=xm,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(r){this._alphaTest>0!=r>0&&this.version++,this._alphaTest=r}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(r){if(r!==void 0)for(const e in r){const i=r[e];if(i===void 0){console.warn(`THREE.Material: parameter '${e}' has value of undefined.`);continue}const n=this[e];if(n===void 0){console.warn(`THREE.Material: '${e}' is not a property of THREE.${this.type}.`);continue}n&&n.isColor?n.set(i):n&&n.isVector3&&i&&i.isVector3?n.copy(i):this[e]=i}}toJSON(r){const e=r===void 0||typeof r=="string";e&&(r={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(r).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(r).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(r).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(i.dispersion=this.dispersion),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(r).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(r).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(r).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(r).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(r).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(r).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(r).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(r).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(r).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(r).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(r).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(r).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(r).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(r).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(r).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(r).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(r).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(r).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapRotation!==void 0&&(i.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(r).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(r).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(r).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==hm&&(i.blending=this.blending),this.side!==jh&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==SC&&(i.blendSrc=this.blendSrc),this.blendDst!==TC&&(i.blendDst=this.blendDst),this.blendEquation!==ap&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==dm&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==BP&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==xm&&(i.stencilFail=this.stencilFail),this.stencilZFail!==xm&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==xm&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function n(s){const o=[];for(const l in s){const u=s[l];delete u.metadata,o.push(u)}return o}if(e){const s=n(r.textures),o=n(r.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return new this.constructor().copy(this)}copy(r){this.name=r.name,this.blending=r.blending,this.side=r.side,this.vertexColors=r.vertexColors,this.opacity=r.opacity,this.transparent=r.transparent,this.blendSrc=r.blendSrc,this.blendDst=r.blendDst,this.blendEquation=r.blendEquation,this.blendSrcAlpha=r.blendSrcAlpha,this.blendDstAlpha=r.blendDstAlpha,this.blendEquationAlpha=r.blendEquationAlpha,this.blendColor.copy(r.blendColor),this.blendAlpha=r.blendAlpha,this.depthFunc=r.depthFunc,this.depthTest=r.depthTest,this.depthWrite=r.depthWrite,this.stencilWriteMask=r.stencilWriteMask,this.stencilFunc=r.stencilFunc,this.stencilRef=r.stencilRef,this.stencilFuncMask=r.stencilFuncMask,this.stencilFail=r.stencilFail,this.stencilZFail=r.stencilZFail,this.stencilZPass=r.stencilZPass,this.stencilWrite=r.stencilWrite;const e=r.clippingPlanes;let i=null;if(e!==null){const n=e.length;i=new Array(n);for(let s=0;s!==n;++s)i[s]=e[s].clone()}return this.clippingPlanes=i,this.clipIntersection=r.clipIntersection,this.clipShadows=r.clipShadows,this.shadowSide=r.shadowSide,this.colorWrite=r.colorWrite,this.precision=r.precision,this.polygonOffset=r.polygonOffset,this.polygonOffsetFactor=r.polygonOffsetFactor,this.polygonOffsetUnits=r.polygonOffsetUnits,this.dithering=r.dithering,this.alphaTest=r.alphaTest,this.alphaHash=r.alphaHash,this.alphaToCoverage=r.alphaToCoverage,this.premultipliedAlpha=r.premultipliedAlpha,this.forceSinglePass=r.forceSinglePass,this.visible=r.visible,this.toneMapped=r.toneMapped,this.userData=JSON.parse(JSON.stringify(r.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(r){r===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}},Jh=class extends mp{static get type(){return"MeshBasicMaterial"}constructor(r){super(),this.isMeshBasicMaterial=!0,this.color=new Tn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Yh,this.combine=OC,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(r)}copy(r){return super.copy(r),this.color.copy(r.color),this.map=r.map,this.lightMap=r.lightMap,this.lightMapIntensity=r.lightMapIntensity,this.aoMap=r.aoMap,this.aoMapIntensity=r.aoMapIntensity,this.specularMap=r.specularMap,this.alphaMap=r.alphaMap,this.envMap=r.envMap,this.envMapRotation.copy(r.envMapRotation),this.combine=r.combine,this.reflectivity=r.reflectivity,this.refractionRatio=r.refractionRatio,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.wireframeLinecap=r.wireframeLinecap,this.wireframeLinejoin=r.wireframeLinejoin,this.fog=r.fog,this}};const Zs=new at,yb=new ji;let jo=class{constructor(r,e,i=!1){if(Array.isArray(r))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=r,this.itemSize=e,this.count=r!==void 0?r.length/e:0,this.normalized=i,this.usage=vS,this.updateRanges=[],this.gpuType=Eu,this.version=0}onUploadCallback(){}set needsUpdate(r){r===!0&&this.version++}setUsage(r){return this.usage=r,this}addUpdateRange(r,e){this.updateRanges.push({start:r,count:e})}clearUpdateRanges(){this.updateRanges.length=0}copy(r){return this.name=r.name,this.array=new r.array.constructor(r.array),this.itemSize=r.itemSize,this.count=r.count,this.normalized=r.normalized,this.usage=r.usage,this.gpuType=r.gpuType,this}copyAt(r,e,i){r*=this.itemSize,i*=e.itemSize;for(let n=0,s=this.itemSize;n<s;n++)this.array[r+n]=e.array[i+n];return this}copyArray(r){return this.array.set(r),this}applyMatrix3(r){if(this.itemSize===2)for(let e=0,i=this.count;e<i;e++)yb.fromBufferAttribute(this,e),yb.applyMatrix3(r),this.setXY(e,yb.x,yb.y);else if(this.itemSize===3)for(let e=0,i=this.count;e<i;e++)Zs.fromBufferAttribute(this,e),Zs.applyMatrix3(r),this.setXYZ(e,Zs.x,Zs.y,Zs.z);return this}applyMatrix4(r){for(let e=0,i=this.count;e<i;e++)Zs.fromBufferAttribute(this,e),Zs.applyMatrix4(r),this.setXYZ(e,Zs.x,Zs.y,Zs.z);return this}applyNormalMatrix(r){for(let e=0,i=this.count;e<i;e++)Zs.fromBufferAttribute(this,e),Zs.applyNormalMatrix(r),this.setXYZ(e,Zs.x,Zs.y,Zs.z);return this}transformDirection(r){for(let e=0,i=this.count;e<i;e++)Zs.fromBufferAttribute(this,e),Zs.transformDirection(r),this.setXYZ(e,Zs.x,Zs.y,Zs.z);return this}set(r,e=0){return this.array.set(r,e),this}getComponent(r,e){let i=this.array[r*this.itemSize+e];return this.normalized&&(i=rc(i,this.array)),i}setComponent(r,e,i){return this.normalized&&(i=ss(i,this.array)),this.array[r*this.itemSize+e]=i,this}getX(r){let e=this.array[r*this.itemSize];return this.normalized&&(e=rc(e,this.array)),e}setX(r,e){return this.normalized&&(e=ss(e,this.array)),this.array[r*this.itemSize]=e,this}getY(r){let e=this.array[r*this.itemSize+1];return this.normalized&&(e=rc(e,this.array)),e}setY(r,e){return this.normalized&&(e=ss(e,this.array)),this.array[r*this.itemSize+1]=e,this}getZ(r){let e=this.array[r*this.itemSize+2];return this.normalized&&(e=rc(e,this.array)),e}setZ(r,e){return this.normalized&&(e=ss(e,this.array)),this.array[r*this.itemSize+2]=e,this}getW(r){let e=this.array[r*this.itemSize+3];return this.normalized&&(e=rc(e,this.array)),e}setW(r,e){return this.normalized&&(e=ss(e,this.array)),this.array[r*this.itemSize+3]=e,this}setXY(r,e,i){return r*=this.itemSize,this.normalized&&(e=ss(e,this.array),i=ss(i,this.array)),this.array[r+0]=e,this.array[r+1]=i,this}setXYZ(r,e,i,n){return r*=this.itemSize,this.normalized&&(e=ss(e,this.array),i=ss(i,this.array),n=ss(n,this.array)),this.array[r+0]=e,this.array[r+1]=i,this.array[r+2]=n,this}setXYZW(r,e,i,n,s){return r*=this.itemSize,this.normalized&&(e=ss(e,this.array),i=ss(i,this.array),n=ss(n,this.array),s=ss(s,this.array)),this.array[r+0]=e,this.array[r+1]=i,this.array[r+2]=n,this.array[r+3]=s,this}onUpload(r){return this.onUploadCallback=r,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const r={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(r.name=this.name),this.usage!==vS&&(r.usage=this.usage),r}},ek=class extends jo{constructor(r,e,i){super(new Uint16Array(r),e,i)}},tk=class extends jo{constructor(r,e,i){super(new Uint32Array(r),e,i)}},fa=class extends jo{constructor(r,e,i){super(new Float32Array(r),e,i)}},DJ=0;const Ll=new As,zS=new to,Bm=new at,ul=new hp,_A=new hp,Ma=new at;let Vo=class pH extends up{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:DJ++}),this.uuid=Cu(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(OP(e)?tk:ek)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,i){return this.attributes[e]=i,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,i,n=0){this.groups.push({start:e,count:i,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,i){this.drawRange.start=e,this.drawRange.count=i}applyMatrix4(e){const i=this.attributes.position;i!==void 0&&(i.applyMatrix4(e),i.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const o=new gn().getNormalMatrix(e);n.applyNormalMatrix(o),n.needsUpdate=!0}const s=this.attributes.tangent;return s!==void 0&&(s.transformDirection(e),s.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Ll.makeRotationFromQuaternion(e),this.applyMatrix4(Ll),this}rotateX(e){return Ll.makeRotationX(e),this.applyMatrix4(Ll),this}rotateY(e){return Ll.makeRotationY(e),this.applyMatrix4(Ll),this}rotateZ(e){return Ll.makeRotationZ(e),this.applyMatrix4(Ll),this}translate(e,i,n){return Ll.makeTranslation(e,i,n),this.applyMatrix4(Ll),this}scale(e,i,n){return Ll.makeScale(e,i,n),this.applyMatrix4(Ll),this}lookAt(e){return zS.lookAt(e),zS.updateMatrix(),this.applyMatrix4(zS.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Bm).negate(),this.translate(Bm.x,Bm.y,Bm.z),this}setFromPoints(e){const i=this.getAttribute("position");if(i===void 0){const n=[];for(let s=0,o=e.length;s<o;s++){const l=e[s];n.push(l.x,l.y,l.z||0)}this.setAttribute("position",new fa(n,3))}else{for(let n=0,s=i.count;n<s;n++){const o=e[n];i.setXYZ(n,o.x,o.y,o.z||0)}e.length>i.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),i.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new hp);const e=this.attributes.position,i=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new at(-1/0,-1/0,-1/0),new at(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),i)for(let n=0,s=i.length;n<s;n++){const o=i[n];ul.setFromBufferAttribute(o),this.morphTargetsRelative?(Ma.addVectors(this.boundingBox.min,ul.min),this.boundingBox.expandByPoint(Ma),Ma.addVectors(this.boundingBox.max,ul.max),this.boundingBox.expandByPoint(Ma)):(this.boundingBox.expandByPoint(ul.min),this.boundingBox.expandByPoint(ul.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new hb);const e=this.attributes.position,i=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new at,1/0);return}if(e){const n=this.boundingSphere.center;if(ul.setFromBufferAttribute(e),i)for(let o=0,l=i.length;o<l;o++){const u=i[o];_A.setFromBufferAttribute(u),this.morphTargetsRelative?(Ma.addVectors(ul.min,_A.min),ul.expandByPoint(Ma),Ma.addVectors(ul.max,_A.max),ul.expandByPoint(Ma)):(ul.expandByPoint(_A.min),ul.expandByPoint(_A.max))}ul.getCenter(n);let s=0;for(let o=0,l=e.count;o<l;o++)Ma.fromBufferAttribute(e,o),s=Math.max(s,n.distanceToSquared(Ma));if(i)for(let o=0,l=i.length;o<l;o++){const u=i[o],c=this.morphTargetsRelative;for(let h=0,p=u.count;h<p;h++)Ma.fromBufferAttribute(u,h),c&&(Bm.fromBufferAttribute(e,h),Ma.add(Bm)),s=Math.max(s,n.distanceToSquared(Ma))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,i=this.attributes;if(e===null||i.position===void 0||i.normal===void 0||i.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=i.position,s=i.normal,o=i.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new jo(new Float32Array(4*n.count),4));const l=this.getAttribute("tangent"),u=[],c=[];for(let D=0;D<n.count;D++)u[D]=new at,c[D]=new at;const h=new at,p=new at,f=new at,m=new ji,g=new ji,y=new ji,x=new at,v=new at;function _(D,L,O){h.fromBufferAttribute(n,D),p.fromBufferAttribute(n,L),f.fromBufferAttribute(n,O),m.fromBufferAttribute(o,D),g.fromBufferAttribute(o,L),y.fromBufferAttribute(o,O),p.sub(h),f.sub(h),g.sub(m),y.sub(m);const U=1/(g.x*y.y-y.x*g.y);isFinite(U)&&(x.copy(p).multiplyScalar(y.y).addScaledVector(f,-g.y).multiplyScalar(U),v.copy(f).multiplyScalar(g.x).addScaledVector(p,-y.x).multiplyScalar(U),u[D].add(x),u[L].add(x),u[O].add(x),c[D].add(v),c[L].add(v),c[O].add(v))}let T=this.groups;T.length===0&&(T=[{start:0,count:e.count}]);for(let D=0,L=T.length;D<L;++D){const O=T[D],U=O.start,Z=O.count;for(let G=U,z=U+Z;G<z;G+=3)_(e.getX(G+0),e.getX(G+1),e.getX(G+2))}const w=new at,S=new at,R=new at,B=new at;function I(D){R.fromBufferAttribute(s,D),B.copy(R);const L=u[D];w.copy(L),w.sub(R.multiplyScalar(R.dot(L))).normalize(),S.crossVectors(B,L);const O=S.dot(c[D])<0?-1:1;l.setXYZW(D,w.x,w.y,w.z,O)}for(let D=0,L=T.length;D<L;++D){const O=T[D],U=O.start,Z=O.count;for(let G=U,z=U+Z;G<z;G+=3)I(e.getX(G+0)),I(e.getX(G+1)),I(e.getX(G+2))}}computeVertexNormals(){const e=this.index,i=this.getAttribute("position");if(i!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new jo(new Float32Array(i.count*3),3),this.setAttribute("normal",n);else for(let m=0,g=n.count;m<g;m++)n.setXYZ(m,0,0,0);const s=new at,o=new at,l=new at,u=new at,c=new at,h=new at,p=new at,f=new at;if(e)for(let m=0,g=e.count;m<g;m+=3){const y=e.getX(m+0),x=e.getX(m+1),v=e.getX(m+2);s.fromBufferAttribute(i,y),o.fromBufferAttribute(i,x),l.fromBufferAttribute(i,v),p.subVectors(l,o),f.subVectors(s,o),p.cross(f),u.fromBufferAttribute(n,y),c.fromBufferAttribute(n,x),h.fromBufferAttribute(n,v),u.add(p),c.add(p),h.add(p),n.setXYZ(y,u.x,u.y,u.z),n.setXYZ(x,c.x,c.y,c.z),n.setXYZ(v,h.x,h.y,h.z)}else for(let m=0,g=i.count;m<g;m+=3)s.fromBufferAttribute(i,m+0),o.fromBufferAttribute(i,m+1),l.fromBufferAttribute(i,m+2),p.subVectors(l,o),f.subVectors(s,o),p.cross(f),n.setXYZ(m+0,p.x,p.y,p.z),n.setXYZ(m+1,p.x,p.y,p.z),n.setXYZ(m+2,p.x,p.y,p.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let i=0,n=e.count;i<n;i++)Ma.fromBufferAttribute(e,i),Ma.normalize(),e.setXYZ(i,Ma.x,Ma.y,Ma.z)}toNonIndexed(){function e(u,c){const h=u.array,p=u.itemSize,f=u.normalized,m=new h.constructor(c.length*p);let g=0,y=0;for(let x=0,v=c.length;x<v;x++){u.isInterleavedBufferAttribute?g=c[x]*u.data.stride+u.offset:g=c[x]*p;for(let _=0;_<p;_++)m[y++]=h[g++]}return new jo(m,p,f)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const i=new pH,n=this.index.array,s=this.attributes;for(const u in s){const c=s[u],h=e(c,n);i.setAttribute(u,h)}const o=this.morphAttributes;for(const u in o){const c=[],h=o[u];for(let p=0,f=h.length;p<f;p++){const m=h[p],g=e(m,n);c.push(g)}i.morphAttributes[u]=c}i.morphTargetsRelative=this.morphTargetsRelative;const l=this.groups;for(let u=0,c=l.length;u<c;u++){const h=l[u];i.addGroup(h.start,h.count,h.materialIndex)}return i}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const c=this.parameters;for(const h in c)c[h]!==void 0&&(e[h]=c[h]);return e}e.data={attributes:{}};const i=this.index;i!==null&&(e.data.index={type:i.array.constructor.name,array:Array.prototype.slice.call(i.array)});const n=this.attributes;for(const c in n){const h=n[c];e.data.attributes[c]=h.toJSON(e.data)}const s={};let o=!1;for(const c in this.morphAttributes){const h=this.morphAttributes[c],p=[];for(let f=0,m=h.length;f<m;f++){const g=h[f];p.push(g.toJSON(e.data))}p.length>0&&(s[c]=p,o=!0)}o&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);const l=this.groups;l.length>0&&(e.data.groups=JSON.parse(JSON.stringify(l)));const u=this.boundingSphere;return u!==null&&(e.data.boundingSphere={center:u.center.toArray(),radius:u.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const i={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone(i));const s=e.attributes;for(const h in s){const p=s[h];this.setAttribute(h,p.clone(i))}const o=e.morphAttributes;for(const h in o){const p=[],f=o[h];for(let m=0,g=f.length;m<g;m++)p.push(f[m].clone(i));this.morphAttributes[h]=p}this.morphTargetsRelative=e.morphTargetsRelative;const l=e.groups;for(let h=0,p=l.length;h<p;h++){const f=l[h];this.addGroup(f.start,f.count,f.materialIndex)}const u=e.boundingBox;u!==null&&(this.boundingBox=u.clone());const c=e.boundingSphere;return c!==null&&(this.boundingSphere=c.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}};const ik=new As,gp=new fb,vb=new hb,rk=new at,xb=new at,bb=new at,_b=new at,jS=new at,Eb=new at,nk=new at,wb=new at;let za=class extends to{constructor(r=new Vo,e=new Jh){super(),this.isMesh=!0,this.type="Mesh",this.geometry=r,this.material=e,this.updateMorphTargets()}copy(r,e){return super.copy(r,e),r.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=r.morphTargetInfluences.slice()),r.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},r.morphTargetDictionary)),this.material=Array.isArray(r.material)?r.material.slice():r.material,this.geometry=r.geometry,this}updateMorphTargets(){const r=this.geometry.morphAttributes,e=Object.keys(r);if(e.length>0){const i=r[e[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let n=0,s=i.length;n<s;n++){const o=i[n].name||String(n);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=n}}}}getVertexPosition(r,e){const i=this.geometry,n=i.attributes.position,s=i.morphAttributes.position,o=i.morphTargetsRelative;e.fromBufferAttribute(n,r);const l=this.morphTargetInfluences;if(s&&l){Eb.set(0,0,0);for(let u=0,c=s.length;u<c;u++){const h=l[u],p=s[u];h!==0&&(jS.fromBufferAttribute(p,r),o?Eb.addScaledVector(jS,h):Eb.addScaledVector(jS.sub(e),h))}e.add(Eb)}return e}raycast(r,e){const i=this.geometry,n=this.material,s=this.matrixWorld;n!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),vb.copy(i.boundingSphere),vb.applyMatrix4(s),gp.copy(r.ray).recast(r.near),!(vb.containsPoint(gp.origin)===!1&&(gp.intersectSphere(vb,rk)===null||gp.origin.distanceToSquared(rk)>(r.far-r.near)**2))&&(ik.copy(s).invert(),gp.copy(r.ray).applyMatrix4(ik),!(i.boundingBox!==null&&gp.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(r,e,gp)))}_computeIntersections(r,e,i){let n;const s=this.geometry,o=this.material,l=s.index,u=s.attributes.position,c=s.attributes.uv,h=s.attributes.uv1,p=s.attributes.normal,f=s.groups,m=s.drawRange;if(l!==null)if(Array.isArray(o))for(let g=0,y=f.length;g<y;g++){const x=f[g],v=o[x.materialIndex],_=Math.max(x.start,m.start),T=Math.min(l.count,Math.min(x.start+x.count,m.start+m.count));for(let w=_,S=T;w<S;w+=3){const R=l.getX(w),B=l.getX(w+1),I=l.getX(w+2);n=Cb(this,v,r,i,c,h,p,R,B,I),n&&(n.faceIndex=Math.floor(w/3),n.face.materialIndex=x.materialIndex,e.push(n))}}else{const g=Math.max(0,m.start),y=Math.min(l.count,m.start+m.count);for(let x=g,v=y;x<v;x+=3){const _=l.getX(x),T=l.getX(x+1),w=l.getX(x+2);n=Cb(this,o,r,i,c,h,p,_,T,w),n&&(n.faceIndex=Math.floor(x/3),e.push(n))}}else if(u!==void 0)if(Array.isArray(o))for(let g=0,y=f.length;g<y;g++){const x=f[g],v=o[x.materialIndex],_=Math.max(x.start,m.start),T=Math.min(u.count,Math.min(x.start+x.count,m.start+m.count));for(let w=_,S=T;w<S;w+=3){const R=w,B=w+1,I=w+2;n=Cb(this,v,r,i,c,h,p,R,B,I),n&&(n.faceIndex=Math.floor(w/3),n.face.materialIndex=x.materialIndex,e.push(n))}}else{const g=Math.max(0,m.start),y=Math.min(u.count,m.start+m.count);for(let x=g,v=y;x<v;x+=3){const _=x,T=x+1,w=x+2;n=Cb(this,o,r,i,c,h,p,_,T,w),n&&(n.faceIndex=Math.floor(x/3),e.push(n))}}}};function OJ(r,e,i,n,s,o,l,u){let c;if(e.side===vo?c=n.intersectTriangle(l,o,s,!0,u):c=n.intersectTriangle(s,o,l,e.side===jh,u),c===null)return null;wb.copy(u),wb.applyMatrix4(r.matrixWorld);const h=i.ray.origin.distanceTo(wb);return h<i.near||h>i.far?null:{distance:h,point:wb.clone(),object:r}}function Cb(r,e,i,n,s,o,l,u,c,h){r.getVertexPosition(u,xb),r.getVertexPosition(c,bb),r.getVertexPosition(h,_b);const p=OJ(r,e,i,n,xb,bb,_b,nk);if(p){const f=new at;fp.getBarycoord(nk,xb,bb,_b,f),s&&(p.uv=fp.getInterpolatedAttribute(s,u,c,h,f,new ji)),o&&(p.uv1=fp.getInterpolatedAttribute(o,u,c,h,f,new ji)),l&&(p.normal=fp.getInterpolatedAttribute(l,u,c,h,f,new at),p.normal.dot(n.direction)>0&&p.normal.multiplyScalar(-1));const m={a:u,b:c,c:h,normal:new at,materialIndex:0};fp.getNormal(xb,bb,_b,m.normal),p.face=m,p.barycoord=f}return p}let Nm=class fH extends Vo{constructor(e=1,i=1,n=1,s=1,o=1,l=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:i,depth:n,widthSegments:s,heightSegments:o,depthSegments:l};const u=this;s=Math.floor(s),o=Math.floor(o),l=Math.floor(l);const c=[],h=[],p=[],f=[];let m=0,g=0;y("z","y","x",-1,-1,n,i,e,l,o,0),y("z","y","x",1,-1,n,i,-e,l,o,1),y("x","z","y",1,1,e,n,i,s,l,2),y("x","z","y",1,-1,e,n,-i,s,l,3),y("x","y","z",1,-1,e,i,n,s,o,4),y("x","y","z",-1,-1,e,i,-n,s,o,5),this.setIndex(c),this.setAttribute("position",new fa(h,3)),this.setAttribute("normal",new fa(p,3)),this.setAttribute("uv",new fa(f,2));function y(x,v,_,T,w,S,R,B,I,D,L){const O=S/I,U=R/D,Z=S/2,G=R/2,z=B/2,$=I+1,Q=D+1;let H=0,V=0;const ne=new at;for(let Y=0;Y<Q;Y++){const ae=Y*U-G;for(let xe=0;xe<$;xe++){const fe=xe*O-Z;ne[x]=fe*T,ne[v]=ae*w,ne[_]=z,h.push(ne.x,ne.y,ne.z),ne[x]=0,ne[v]=0,ne[_]=B>0?1:-1,p.push(ne.x,ne.y,ne.z),f.push(xe/I),f.push(1-Y/D),H+=1}}for(let Y=0;Y<D;Y++)for(let ae=0;ae<I;ae++){const xe=m+ae+$*Y,fe=m+ae+$*(Y+1),de=m+(ae+1)+$*(Y+1),Ie=m+(ae+1)+$*Y;c.push(xe,fe,Ie),c.push(fe,de,Ie),V+=6}u.addGroup(g,V,L),g+=V,m+=H}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new fH(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};function Lm(r){const e={};for(const i in r){e[i]={};for(const n in r[i]){const s=r[i][n];s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture||s.isQuaternion)?s.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[i][n]=null):e[i][n]=s.clone():Array.isArray(s)?e[i][n]=s.slice():e[i][n]=s}}return e}function xo(r){const e={};for(let i=0;i<r.length;i++){const n=Lm(r[i]);for(const s in n)e[s]=n[s]}return e}function PJ(r){const e=[];for(let i=0;i<r.length;i++)e.push(r[i].clone());return e}function sk(r){const e=r.getRenderTarget();return e===null?r.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:zn.workingColorSpace}const ak={clone:Lm,merge:xo};var kJ=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,FJ=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;let zc=class extends mp{static get type(){return"ShaderMaterial"}constructor(r){super(),this.isShaderMaterial=!0,this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=kJ,this.fragmentShader=FJ,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,r!==void 0&&this.setValues(r)}copy(r){return super.copy(r),this.fragmentShader=r.fragmentShader,this.vertexShader=r.vertexShader,this.uniforms=Lm(r.uniforms),this.uniformsGroups=PJ(r.uniformsGroups),this.defines=Object.assign({},r.defines),this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.fog=r.fog,this.lights=r.lights,this.clipping=r.clipping,this.extensions=Object.assign({},r.extensions),this.glslVersion=r.glslVersion,this}toJSON(r){const e=super.toJSON(r);e.glslVersion=this.glslVersion,e.uniforms={};for(const n in this.uniforms){const s=this.uniforms[n].value;s&&s.isTexture?e.uniforms[n]={type:"t",value:s.toJSON(r).uuid}:s&&s.isColor?e.uniforms[n]={type:"c",value:s.getHex()}:s&&s.isVector2?e.uniforms[n]={type:"v2",value:s.toArray()}:s&&s.isVector3?e.uniforms[n]={type:"v3",value:s.toArray()}:s&&s.isVector4?e.uniforms[n]={type:"v4",value:s.toArray()}:s&&s.isMatrix3?e.uniforms[n]={type:"m3",value:s.toArray()}:s&&s.isMatrix4?e.uniforms[n]={type:"m4",value:s.toArray()}:e.uniforms[n]={value:s}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e.lights=this.lights,e.clipping=this.clipping;const i={};for(const n in this.extensions)this.extensions[n]===!0&&(i[n]=!0);return Object.keys(i).length>0&&(e.extensions=i),e}},ok=class extends to{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new As,this.projectionMatrix=new As,this.projectionMatrixInverse=new As,this.coordinateSystem=wu}copy(r,e){return super.copy(r,e),this.matrixWorldInverse.copy(r.matrixWorldInverse),this.projectionMatrix.copy(r.projectionMatrix),this.projectionMatrixInverse.copy(r.projectionMatrixInverse),this.coordinateSystem=r.coordinateSystem,this}getWorldDirection(r){return super.getWorldDirection(r).negate()}updateMatrixWorld(r){super.updateMatrixWorld(r),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(r,e){super.updateWorldMatrix(r,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}};const Zh=new at,lk=new ji,ck=new ji;let Dl=class extends ok{constructor(r=50,e=1,i=.1,n=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=r,this.zoom=1,this.near=i,this.far=n,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(r,e){return super.copy(r,e),this.fov=r.fov,this.zoom=r.zoom,this.near=r.near,this.far=r.far,this.focus=r.focus,this.aspect=r.aspect,this.view=r.view===null?null:Object.assign({},r.view),this.filmGauge=r.filmGauge,this.filmOffset=r.filmOffset,this}setFocalLength(r){const e=.5*this.getFilmHeight()/r;this.fov=mA*2*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){const r=Math.tan(fA*.5*this.fov);return .5*this.getFilmHeight()/r}getEffectiveFOV(){return mA*2*Math.atan(Math.tan(fA*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(r,e,i){Zh.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),e.set(Zh.x,Zh.y).multiplyScalar(-r/Zh.z),Zh.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(Zh.x,Zh.y).multiplyScalar(-r/Zh.z)}getViewSize(r,e){return this.getViewBounds(r,lk,ck),e.subVectors(ck,lk)}setViewOffset(r,e,i,n,s,o){this.aspect=r/e,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=r,this.view.fullHeight=e,this.view.offsetX=i,this.view.offsetY=n,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const r=this.near;let e=r*Math.tan(fA*.5*this.fov)/this.zoom,i=2*e,n=this.aspect*i,s=-.5*n;const o=this.view;if(this.view!==null&&this.view.enabled){const u=o.fullWidth,c=o.fullHeight;s+=o.offsetX*n/u,e-=o.offsetY*i/c,n*=o.width/u,i*=o.height/c}const l=this.filmOffset;l!==0&&(s+=r*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+n,e,e-i,r,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(r){const e=super.toJSON(r);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,this.view!==null&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}};const Dm=-90,Om=1;let UJ=class extends to{constructor(r,e,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const n=new Dl(Dm,Om,r,e);n.layers=this.layers,this.add(n);const s=new Dl(Dm,Om,r,e);s.layers=this.layers,this.add(s);const o=new Dl(Dm,Om,r,e);o.layers=this.layers,this.add(o);const l=new Dl(Dm,Om,r,e);l.layers=this.layers,this.add(l);const u=new Dl(Dm,Om,r,e);u.layers=this.layers,this.add(u);const c=new Dl(Dm,Om,r,e);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){const r=this.coordinateSystem,e=this.children.concat(),[i,n,s,o,l,u]=e;for(const c of e)this.remove(c);if(r===wu)i.up.set(0,1,0),i.lookAt(1,0,0),n.up.set(0,1,0),n.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),l.up.set(0,1,0),l.lookAt(0,0,1),u.up.set(0,1,0),u.lookAt(0,0,-1);else if(r===ob)i.up.set(0,-1,0),i.lookAt(-1,0,0),n.up.set(0,-1,0),n.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),l.up.set(0,-1,0),l.lookAt(0,0,1),u.up.set(0,-1,0),u.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+r);for(const c of e)this.add(c),c.updateMatrixWorld()}update(r,e){this.parent===null&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:n}=this;this.coordinateSystem!==r.coordinateSystem&&(this.coordinateSystem=r.coordinateSystem,this.updateCoordinateSystem());const[s,o,l,u,c,h]=this.children,p=r.getRenderTarget(),f=r.getActiveCubeFace(),m=r.getActiveMipmapLevel(),g=r.xr.enabled;r.xr.enabled=!1;const y=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,r.setRenderTarget(i,0,n),r.render(e,s),r.setRenderTarget(i,1,n),r.render(e,o),r.setRenderTarget(i,2,n),r.render(e,l),r.setRenderTarget(i,3,n),r.render(e,u),r.setRenderTarget(i,4,n),r.render(e,c),i.texture.generateMipmaps=y,r.setRenderTarget(i,5,n),r.render(e,h),r.setRenderTarget(p,f,m),r.xr.enabled=g,i.texture.needsPMREMUpdate=!0}},uk=class extends Nl{constructor(r,e,i,n,s,o,l,u,c,h){r=r!==void 0?r:[],e=e!==void 0?e:pm,super(r,e,i,n,s,o,l,u,c,h),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(r){this.image=r}},zJ=class extends Hh{constructor(r=1,e={}){super(r,r,e),this.isWebGLCubeRenderTarget=!0;const i={width:r,height:r,depth:1},n=[i,i,i,i,i,i];this.texture=new uk(n,e.mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=e.generateMipmaps!==void 0?e.generateMipmaps:!1,this.texture.minFilter=e.minFilter!==void 0?e.minFilter:Fc}fromEquirectangularTexture(r,e){this.texture.type=e.type,this.texture.colorSpace=e.colorSpace,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},n=new Nm(5,5,5),s=new zc({name:"CubemapFromEquirect",uniforms:Lm(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:vo,blending:bu});s.uniforms.tEquirect.value=e;const o=new za(n,s),l=e.minFilter;return e.minFilter===lp&&(e.minFilter=Fc),new UJ(1,10,this).update(r,o),e.minFilter=l,o.geometry.dispose(),o.material.dispose(),this}clear(r,e,i,n){const s=r.getRenderTarget();for(let o=0;o<6;o++)r.setRenderTarget(this,o),r.clear(e,i,n);r.setRenderTarget(s)}};const VS=new at,jJ=new at,VJ=new gn;let oc=class{constructor(r=new at(1,0,0),e=0){this.isPlane=!0,this.normal=r,this.constant=e}set(r,e){return this.normal.copy(r),this.constant=e,this}setComponents(r,e,i,n){return this.normal.set(r,e,i),this.constant=n,this}setFromNormalAndCoplanarPoint(r,e){return this.normal.copy(r),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(r,e,i){const n=VS.subVectors(i,e).cross(jJ.subVectors(r,e)).normalize();return this.setFromNormalAndCoplanarPoint(n,r),this}copy(r){return this.normal.copy(r.normal),this.constant=r.constant,this}normalize(){const r=1/this.normal.length();return this.normal.multiplyScalar(r),this.constant*=r,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(r){return this.normal.dot(r)+this.constant}distanceToSphere(r){return this.distanceToPoint(r.center)-r.radius}projectPoint(r,e){return e.copy(r).addScaledVector(this.normal,-this.distanceToPoint(r))}intersectLine(r,e){const i=r.delta(VS),n=this.normal.dot(i);if(n===0)return this.distanceToPoint(r.start)===0?e.copy(r.start):null;const s=-(r.start.dot(this.normal)+this.constant)/n;return s<0||s>1?null:e.copy(r.start).addScaledVector(i,s)}intersectsLine(r){const e=this.distanceToPoint(r.start),i=this.distanceToPoint(r.end);return e<0&&i>0||i<0&&e>0}intersectsBox(r){return r.intersectsPlane(this)}intersectsSphere(r){return r.intersectsPlane(this)}coplanarPoint(r){return r.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(r,e){const i=e||VJ.getNormalMatrix(r),n=this.coplanarPoint(VS).applyMatrix4(r),s=this.normal.applyMatrix3(i).normalize();return this.constant=-n.dot(s),this}translate(r){return this.constant-=r.dot(this.normal),this}equals(r){return r.normal.equals(this.normal)&&r.constant===this.constant}clone(){return new this.constructor().copy(this)}};const Ap=new hb,Sb=new at;let GS=class{constructor(r=new oc,e=new oc,i=new oc,n=new oc,s=new oc,o=new oc){this.planes=[r,e,i,n,s,o]}set(r,e,i,n,s,o){const l=this.planes;return l[0].copy(r),l[1].copy(e),l[2].copy(i),l[3].copy(n),l[4].copy(s),l[5].copy(o),this}copy(r){const e=this.planes;for(let i=0;i<6;i++)e[i].copy(r.planes[i]);return this}setFromProjectionMatrix(r,e=wu){const i=this.planes,n=r.elements,s=n[0],o=n[1],l=n[2],u=n[3],c=n[4],h=n[5],p=n[6],f=n[7],m=n[8],g=n[9],y=n[10],x=n[11],v=n[12],_=n[13],T=n[14],w=n[15];if(i[0].setComponents(u-s,f-c,x-m,w-v).normalize(),i[1].setComponents(u+s,f+c,x+m,w+v).normalize(),i[2].setComponents(u+o,f+h,x+g,w+_).normalize(),i[3].setComponents(u-o,f-h,x-g,w-_).normalize(),i[4].setComponents(u-l,f-p,x-y,w-T).normalize(),e===wu)i[5].setComponents(u+l,f+p,x+y,w+T).normalize();else if(e===ob)i[5].setComponents(l,p,y,T).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+e);return this}intersectsObject(r){if(r.boundingSphere!==void 0)r.boundingSphere===null&&r.computeBoundingSphere(),Ap.copy(r.boundingSphere).applyMatrix4(r.matrixWorld);else{const e=r.geometry;e.boundingSphere===null&&e.computeBoundingSphere(),Ap.copy(e.boundingSphere).applyMatrix4(r.matrixWorld)}return this.intersectsSphere(Ap)}intersectsSprite(r){return Ap.center.set(0,0,0),Ap.radius=.7071067811865476,Ap.applyMatrix4(r.matrixWorld),this.intersectsSphere(Ap)}intersectsSphere(r){const e=this.planes,i=r.center,n=-r.radius;for(let s=0;s<6;s++)if(e[s].distanceToPoint(i)<n)return!1;return!0}intersectsBox(r){const e=this.planes;for(let i=0;i<6;i++){const n=e[i];if(Sb.x=n.normal.x>0?r.max.x:r.min.x,Sb.y=n.normal.y>0?r.max.y:r.min.y,Sb.z=n.normal.z>0?r.max.z:r.min.z,n.distanceToPoint(Sb)<0)return!1}return!0}containsPoint(r){const e=this.planes;for(let i=0;i<6;i++)if(e[i].distanceToPoint(r)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};function hk(){let r=null,e=!1,i=null,n=null;function s(o,l){i(o,l),n=r.requestAnimationFrame(s)}return{start:function(){e!==!0&&i!==null&&(n=r.requestAnimationFrame(s),e=!0)},stop:function(){r.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(o){i=o},setContext:function(o){r=o}}}function GJ(r){const e=new WeakMap;function i(u,c){const h=u.array,p=u.usage,f=h.byteLength,m=r.createBuffer();r.bindBuffer(c,m),r.bufferData(c,h,p),u.onUploadCallback();let g;if(h instanceof Float32Array)g=r.FLOAT;else if(h instanceof Uint16Array)u.isFloat16BufferAttribute?g=r.HALF_FLOAT:g=r.UNSIGNED_SHORT;else if(h instanceof Int16Array)g=r.SHORT;else if(h instanceof Uint32Array)g=r.UNSIGNED_INT;else if(h instanceof Int32Array)g=r.INT;else if(h instanceof Int8Array)g=r.BYTE;else if(h instanceof Uint8Array)g=r.UNSIGNED_BYTE;else if(h instanceof Uint8ClampedArray)g=r.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+h);return{buffer:m,type:g,bytesPerElement:h.BYTES_PER_ELEMENT,version:u.version,size:f}}function n(u,c,h){const p=c.array,f=c.updateRanges;if(r.bindBuffer(h,u),f.length===0)r.bufferSubData(h,0,p);else{f.sort((g,y)=>g.start-y.start);let m=0;for(let g=1;g<f.length;g++){const y=f[m],x=f[g];x.start<=y.start+y.count+1?y.count=Math.max(y.count,x.start+x.count-y.start):(++m,f[m]=x)}f.length=m+1;for(let g=0,y=f.length;g<y;g++){const x=f[g];r.bufferSubData(h,x.start*p.BYTES_PER_ELEMENT,p,x.start,x.count)}c.clearUpdateRanges()}c.onUploadCallback()}function s(u){return u.isInterleavedBufferAttribute&&(u=u.data),e.get(u)}function o(u){u.isInterleavedBufferAttribute&&(u=u.data);const c=e.get(u);c&&(r.deleteBuffer(c.buffer),e.delete(u))}function l(u,c){if(u.isInterleavedBufferAttribute&&(u=u.data),u.isGLBufferAttribute){const p=e.get(u);(!p||p.version<u.version)&&e.set(u,{buffer:u.buffer,type:u.type,bytesPerElement:u.elementSize,version:u.version});return}const h=e.get(u);if(h===void 0)e.set(u,i(u,c));else if(h.version<u.version){if(h.size!==u.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(h.buffer,u,c),h.version=u.version}}return{get:s,remove:o,update:l}}class Tb extends Vo{constructor(e=1,i=1,n=1,s=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:i,widthSegments:n,heightSegments:s};const o=e/2,l=i/2,u=Math.floor(n),c=Math.floor(s),h=u+1,p=c+1,f=e/u,m=i/c,g=[],y=[],x=[],v=[];for(let _=0;_<p;_++){const T=_*m-l;for(let w=0;w<h;w++){const S=w*f-o;y.push(S,-T,0),x.push(0,0,1),v.push(w/u),v.push(1-_/c)}}for(let _=0;_<c;_++)for(let T=0;T<u;T++){const w=T+h*_,S=T+h*(_+1),R=T+1+h*(_+1),B=T+1+h*_;g.push(w,S,B),g.push(S,R,B)}this.setIndex(g),this.setAttribute("position",new fa(y,3)),this.setAttribute("normal",new fa(x,3)),this.setAttribute("uv",new fa(v,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Tb(e.width,e.height,e.widthSegments,e.heightSegments)}}var HJ=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,WJ=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,QJ=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,qJ=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,XJ=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,YJ=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,KJ=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,JJ=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,ZJ=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,$J=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,eZ=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,tZ=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,iZ=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,rZ=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,nZ=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,sZ=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,aZ=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,oZ=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,lZ=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,cZ=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,uZ=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,hZ=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,dZ=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,pZ=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,fZ=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,mZ=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,gZ=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,AZ=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,yZ=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,vZ=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,xZ="gl_FragColor = linearToOutputTexel( gl_FragColor );",bZ=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,_Z=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,EZ=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,wZ=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,CZ=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,SZ=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,TZ=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,MZ=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,RZ=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,IZ=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,BZ=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,NZ=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,LZ=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,DZ=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,OZ=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,PZ=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,kZ=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,FZ=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,UZ=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,zZ=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,jZ=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,VZ=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,GZ=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,HZ=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,WZ=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,QZ=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,qZ=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,XZ=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,YZ=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,KZ=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,JZ=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,ZZ=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,$Z=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,e$=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,t$=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,i$=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,r$=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,n$=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,s$=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,a$=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,o$=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,l$=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,c$=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,u$=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,h$=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,d$=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,p$=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,f$=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,m$=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,g$=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,A$=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,y$=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,v$=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,x$=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,b$=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,_$=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,E$=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,w$=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,C$=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,S$=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,T$=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,M$=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,R$=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,I$=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,B$=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,N$=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,L$=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,D$=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,O$=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,P$=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,k$=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,F$=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
		
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
		
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		
		#else
		
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,U$=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,z$=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,j$=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,V$=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const G$=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,H$=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,W$=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Q$=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,q$=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,X$=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Y$=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,K$=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,J$=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,Z$=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,$$=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,eee=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,tee=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,iee=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,ree=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,nee=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,see=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,aee=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,oee=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,lee=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,cee=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,uee=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,hee=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,dee=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,pee=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,fee=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,mee=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,gee=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Aee=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,yee=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,vee=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,xee=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,bee=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,_ee=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,hn={alphahash_fragment:HJ,alphahash_pars_fragment:WJ,alphamap_fragment:QJ,alphamap_pars_fragment:qJ,alphatest_fragment:XJ,alphatest_pars_fragment:YJ,aomap_fragment:KJ,aomap_pars_fragment:JJ,batching_pars_vertex:ZJ,batching_vertex:$J,begin_vertex:eZ,beginnormal_vertex:tZ,bsdfs:iZ,iridescence_fragment:rZ,bumpmap_pars_fragment:nZ,clipping_planes_fragment:sZ,clipping_planes_pars_fragment:aZ,clipping_planes_pars_vertex:oZ,clipping_planes_vertex:lZ,color_fragment:cZ,color_pars_fragment:uZ,color_pars_vertex:hZ,color_vertex:dZ,common:pZ,cube_uv_reflection_fragment:fZ,defaultnormal_vertex:mZ,displacementmap_pars_vertex:gZ,displacementmap_vertex:AZ,emissivemap_fragment:yZ,emissivemap_pars_fragment:vZ,colorspace_fragment:xZ,colorspace_pars_fragment:bZ,envmap_fragment:_Z,envmap_common_pars_fragment:EZ,envmap_pars_fragment:wZ,envmap_pars_vertex:CZ,envmap_physical_pars_fragment:PZ,envmap_vertex:SZ,fog_vertex:TZ,fog_pars_vertex:MZ,fog_fragment:RZ,fog_pars_fragment:IZ,gradientmap_pars_fragment:BZ,lightmap_pars_fragment:NZ,lights_lambert_fragment:LZ,lights_lambert_pars_fragment:DZ,lights_pars_begin:OZ,lights_toon_fragment:kZ,lights_toon_pars_fragment:FZ,lights_phong_fragment:UZ,lights_phong_pars_fragment:zZ,lights_physical_fragment:jZ,lights_physical_pars_fragment:VZ,lights_fragment_begin:GZ,lights_fragment_maps:HZ,lights_fragment_end:WZ,logdepthbuf_fragment:QZ,logdepthbuf_pars_fragment:qZ,logdepthbuf_pars_vertex:XZ,logdepthbuf_vertex:YZ,map_fragment:KZ,map_pars_fragment:JZ,map_particle_fragment:ZZ,map_particle_pars_fragment:$Z,metalnessmap_fragment:e$,metalnessmap_pars_fragment:t$,morphinstance_vertex:i$,morphcolor_vertex:r$,morphnormal_vertex:n$,morphtarget_pars_vertex:s$,morphtarget_vertex:a$,normal_fragment_begin:o$,normal_fragment_maps:l$,normal_pars_fragment:c$,normal_pars_vertex:u$,normal_vertex:h$,normalmap_pars_fragment:d$,clearcoat_normal_fragment_begin:p$,clearcoat_normal_fragment_maps:f$,clearcoat_pars_fragment:m$,iridescence_pars_fragment:g$,opaque_fragment:A$,packing:y$,premultiplied_alpha_fragment:v$,project_vertex:x$,dithering_fragment:b$,dithering_pars_fragment:_$,roughnessmap_fragment:E$,roughnessmap_pars_fragment:w$,shadowmap_pars_fragment:C$,shadowmap_pars_vertex:S$,shadowmap_vertex:T$,shadowmask_pars_fragment:M$,skinbase_vertex:R$,skinning_pars_vertex:I$,skinning_vertex:B$,skinnormal_vertex:N$,specularmap_fragment:L$,specularmap_pars_fragment:D$,tonemapping_fragment:O$,tonemapping_pars_fragment:P$,transmission_fragment:k$,transmission_pars_fragment:F$,uv_pars_fragment:U$,uv_pars_vertex:z$,uv_vertex:j$,worldpos_vertex:V$,background_vert:G$,background_frag:H$,backgroundCube_vert:W$,backgroundCube_frag:Q$,cube_vert:q$,cube_frag:X$,depth_vert:Y$,depth_frag:K$,distanceRGBA_vert:J$,distanceRGBA_frag:Z$,equirect_vert:$$,equirect_frag:eee,linedashed_vert:tee,linedashed_frag:iee,meshbasic_vert:ree,meshbasic_frag:nee,meshlambert_vert:see,meshlambert_frag:aee,meshmatcap_vert:oee,meshmatcap_frag:lee,meshnormal_vert:cee,meshnormal_frag:uee,meshphong_vert:hee,meshphong_frag:dee,meshphysical_vert:pee,meshphysical_frag:fee,meshtoon_vert:mee,meshtoon_frag:gee,points_vert:Aee,points_frag:yee,shadow_vert:vee,shadow_frag:xee,sprite_vert:bee,sprite_frag:_ee},Xi={common:{diffuse:{value:new Tn(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new gn},alphaMap:{value:null},alphaMapTransform:{value:new gn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new gn}},envmap:{envMap:{value:null},envMapRotation:{value:new gn},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new gn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new gn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new gn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new gn},normalScale:{value:new ji(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new gn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new gn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new gn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new gn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Tn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Tn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new gn},alphaTest:{value:0},uvTransform:{value:new gn}},sprite:{diffuse:{value:new Tn(16777215)},opacity:{value:1},center:{value:new ji(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new gn},alphaMap:{value:null},alphaMapTransform:{value:new gn},alphaTest:{value:0}}},jc={basic:{uniforms:xo([Xi.common,Xi.specularmap,Xi.envmap,Xi.aomap,Xi.lightmap,Xi.fog]),vertexShader:hn.meshbasic_vert,fragmentShader:hn.meshbasic_frag},lambert:{uniforms:xo([Xi.common,Xi.specularmap,Xi.envmap,Xi.aomap,Xi.lightmap,Xi.emissivemap,Xi.bumpmap,Xi.normalmap,Xi.displacementmap,Xi.fog,Xi.lights,{emissive:{value:new Tn(0)}}]),vertexShader:hn.meshlambert_vert,fragmentShader:hn.meshlambert_frag},phong:{uniforms:xo([Xi.common,Xi.specularmap,Xi.envmap,Xi.aomap,Xi.lightmap,Xi.emissivemap,Xi.bumpmap,Xi.normalmap,Xi.displacementmap,Xi.fog,Xi.lights,{emissive:{value:new Tn(0)},specular:{value:new Tn(1118481)},shininess:{value:30}}]),vertexShader:hn.meshphong_vert,fragmentShader:hn.meshphong_frag},standard:{uniforms:xo([Xi.common,Xi.envmap,Xi.aomap,Xi.lightmap,Xi.emissivemap,Xi.bumpmap,Xi.normalmap,Xi.displacementmap,Xi.roughnessmap,Xi.metalnessmap,Xi.fog,Xi.lights,{emissive:{value:new Tn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:hn.meshphysical_vert,fragmentShader:hn.meshphysical_frag},toon:{uniforms:xo([Xi.common,Xi.aomap,Xi.lightmap,Xi.emissivemap,Xi.bumpmap,Xi.normalmap,Xi.displacementmap,Xi.gradientmap,Xi.fog,Xi.lights,{emissive:{value:new Tn(0)}}]),vertexShader:hn.meshtoon_vert,fragmentShader:hn.meshtoon_frag},matcap:{uniforms:xo([Xi.common,Xi.bumpmap,Xi.normalmap,Xi.displacementmap,Xi.fog,{matcap:{value:null}}]),vertexShader:hn.meshmatcap_vert,fragmentShader:hn.meshmatcap_frag},points:{uniforms:xo([Xi.points,Xi.fog]),vertexShader:hn.points_vert,fragmentShader:hn.points_frag},dashed:{uniforms:xo([Xi.common,Xi.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:hn.linedashed_vert,fragmentShader:hn.linedashed_frag},depth:{uniforms:xo([Xi.common,Xi.displacementmap]),vertexShader:hn.depth_vert,fragmentShader:hn.depth_frag},normal:{uniforms:xo([Xi.common,Xi.bumpmap,Xi.normalmap,Xi.displacementmap,{opacity:{value:1}}]),vertexShader:hn.meshnormal_vert,fragmentShader:hn.meshnormal_frag},sprite:{uniforms:xo([Xi.sprite,Xi.fog]),vertexShader:hn.sprite_vert,fragmentShader:hn.sprite_frag},background:{uniforms:{uvTransform:{value:new gn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:hn.background_vert,fragmentShader:hn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new gn}},vertexShader:hn.backgroundCube_vert,fragmentShader:hn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:hn.cube_vert,fragmentShader:hn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:hn.equirect_vert,fragmentShader:hn.equirect_frag},distanceRGBA:{uniforms:xo([Xi.common,Xi.displacementmap,{referencePosition:{value:new at},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:hn.distanceRGBA_vert,fragmentShader:hn.distanceRGBA_frag},shadow:{uniforms:xo([Xi.lights,Xi.fog,{color:{value:new Tn(0)},opacity:{value:1}}]),vertexShader:hn.shadow_vert,fragmentShader:hn.shadow_frag}};jc.physical={uniforms:xo([jc.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new gn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new gn},clearcoatNormalScale:{value:new ji(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new gn},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new gn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new gn},sheen:{value:0},sheenColor:{value:new Tn(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new gn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new gn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new gn},transmissionSamplerSize:{value:new ji},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new gn},attenuationDistance:{value:0},attenuationColor:{value:new Tn(0)},specularColor:{value:new Tn(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new gn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new gn},anisotropyVector:{value:new ji},anisotropyMap:{value:null},anisotropyMapTransform:{value:new gn}}]),vertexShader:hn.meshphysical_vert,fragmentShader:hn.meshphysical_frag};const Mb={r:0,b:0,g:0},yp=new Yh,Eee=new As;function wee(r,e,i,n,s,o,l){const u=new Tn(0);let c=o===!0?0:1,h,p,f=null,m=0,g=null;function y(T){let w=T.isScene===!0?T.background:null;return w&&w.isTexture&&(w=(T.backgroundBlurriness>0?i:e).get(w)),w}function x(T){let w=!1;const S=y(T);S===null?_(u,c):S&&S.isColor&&(_(S,1),w=!0);const R=r.xr.getEnvironmentBlendMode();R==="additive"?n.buffers.color.setClear(0,0,0,1,l):R==="alpha-blend"&&n.buffers.color.setClear(0,0,0,0,l),(r.autoClear||w)&&(n.buffers.depth.setTest(!0),n.buffers.depth.setMask(!0),n.buffers.color.setMask(!0),r.clear(r.autoClearColor,r.autoClearDepth,r.autoClearStencil))}function v(T,w){const S=y(w);S&&(S.isCubeTexture||S.mapping===$x)?(p===void 0&&(p=new za(new Nm(1,1,1),new zc({name:"BackgroundCubeMaterial",uniforms:Lm(jc.backgroundCube.uniforms),vertexShader:jc.backgroundCube.vertexShader,fragmentShader:jc.backgroundCube.fragmentShader,side:vo,depthTest:!1,depthWrite:!1,fog:!1})),p.geometry.deleteAttribute("normal"),p.geometry.deleteAttribute("uv"),p.onBeforeRender=function(R,B,I){this.matrixWorld.copyPosition(I.matrixWorld)},Object.defineProperty(p.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),s.update(p)),yp.copy(w.backgroundRotation),yp.x*=-1,yp.y*=-1,yp.z*=-1,S.isCubeTexture&&S.isRenderTargetTexture===!1&&(yp.y*=-1,yp.z*=-1),p.material.uniforms.envMap.value=S,p.material.uniforms.flipEnvMap.value=S.isCubeTexture&&S.isRenderTargetTexture===!1?-1:1,p.material.uniforms.backgroundBlurriness.value=w.backgroundBlurriness,p.material.uniforms.backgroundIntensity.value=w.backgroundIntensity,p.material.uniforms.backgroundRotation.value.setFromMatrix4(Eee.makeRotationFromEuler(yp)),p.material.toneMapped=zn.getTransfer(S.colorSpace)!==cs,(f!==S||m!==S.version||g!==r.toneMapping)&&(p.material.needsUpdate=!0,f=S,m=S.version,g=r.toneMapping),p.layers.enableAll(),T.unshift(p,p.geometry,p.material,0,0,null)):S&&S.isTexture&&(h===void 0&&(h=new za(new Tb(2,2),new zc({name:"BackgroundMaterial",uniforms:Lm(jc.background.uniforms),vertexShader:jc.background.vertexShader,fragmentShader:jc.background.fragmentShader,side:jh,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),Object.defineProperty(h.material,"map",{get:function(){return this.uniforms.t2D.value}}),s.update(h)),h.material.uniforms.t2D.value=S,h.material.uniforms.backgroundIntensity.value=w.backgroundIntensity,h.material.toneMapped=zn.getTransfer(S.colorSpace)!==cs,S.matrixAutoUpdate===!0&&S.updateMatrix(),h.material.uniforms.uvTransform.value.copy(S.matrix),(f!==S||m!==S.version||g!==r.toneMapping)&&(h.material.needsUpdate=!0,f=S,m=S.version,g=r.toneMapping),h.layers.enableAll(),T.unshift(h,h.geometry,h.material,0,0,null))}function _(T,w){T.getRGB(Mb,sk(r)),n.buffers.color.setClear(Mb.r,Mb.g,Mb.b,w,l)}return{getClearColor:function(){return u},setClearColor:function(T,w=1){u.set(T),c=w,_(u,c)},getClearAlpha:function(){return c},setClearAlpha:function(T){c=T,_(u,c)},render:x,addToRenderList:v}}function Cee(r,e){const i=r.getParameter(r.MAX_VERTEX_ATTRIBS),n={},s=m(null);let o=s,l=!1;function u(O,U,Z,G,z){let $=!1;const Q=f(G,Z,U);o!==Q&&(o=Q,h(o.object)),$=g(O,G,Z,z),$&&y(O,G,Z,z),z!==null&&e.update(z,r.ELEMENT_ARRAY_BUFFER),($||l)&&(l=!1,S(O,U,Z,G),z!==null&&r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e.get(z).buffer))}function c(){return r.createVertexArray()}function h(O){return r.bindVertexArray(O)}function p(O){return r.deleteVertexArray(O)}function f(O,U,Z){const G=Z.wireframe===!0;let z=n[O.id];z===void 0&&(z={},n[O.id]=z);let $=z[U.id];$===void 0&&($={},z[U.id]=$);let Q=$[G];return Q===void 0&&(Q=m(c()),$[G]=Q),Q}function m(O){const U=[],Z=[],G=[];for(let z=0;z<i;z++)U[z]=0,Z[z]=0,G[z]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:U,enabledAttributes:Z,attributeDivisors:G,object:O,attributes:{},index:null}}function g(O,U,Z,G){const z=o.attributes,$=U.attributes;let Q=0;const H=Z.getAttributes();for(const V in H)if(H[V].location>=0){const ne=z[V];let Y=$[V];if(Y===void 0&&(V==="instanceMatrix"&&O.instanceMatrix&&(Y=O.instanceMatrix),V==="instanceColor"&&O.instanceColor&&(Y=O.instanceColor)),ne===void 0||ne.attribute!==Y||Y&&ne.data!==Y.data)return!0;Q++}return o.attributesNum!==Q||o.index!==G}function y(O,U,Z,G){const z={},$=U.attributes;let Q=0;const H=Z.getAttributes();for(const V in H)if(H[V].location>=0){let ne=$[V];ne===void 0&&(V==="instanceMatrix"&&O.instanceMatrix&&(ne=O.instanceMatrix),V==="instanceColor"&&O.instanceColor&&(ne=O.instanceColor));const Y={};Y.attribute=ne,ne&&ne.data&&(Y.data=ne.data),z[V]=Y,Q++}o.attributes=z,o.attributesNum=Q,o.index=G}function x(){const O=o.newAttributes;for(let U=0,Z=O.length;U<Z;U++)O[U]=0}function v(O){_(O,0)}function _(O,U){const Z=o.newAttributes,G=o.enabledAttributes,z=o.attributeDivisors;Z[O]=1,G[O]===0&&(r.enableVertexAttribArray(O),G[O]=1),z[O]!==U&&(r.vertexAttribDivisor(O,U),z[O]=U)}function T(){const O=o.newAttributes,U=o.enabledAttributes;for(let Z=0,G=U.length;Z<G;Z++)U[Z]!==O[Z]&&(r.disableVertexAttribArray(Z),U[Z]=0)}function w(O,U,Z,G,z,$,Q){Q===!0?r.vertexAttribIPointer(O,U,Z,z,$):r.vertexAttribPointer(O,U,Z,G,z,$)}function S(O,U,Z,G){x();const z=G.attributes,$=Z.getAttributes(),Q=U.defaultAttributeValues;for(const H in $){const V=$[H];if(V.location>=0){let ne=z[H];if(ne===void 0&&(H==="instanceMatrix"&&O.instanceMatrix&&(ne=O.instanceMatrix),H==="instanceColor"&&O.instanceColor&&(ne=O.instanceColor)),ne!==void 0){const Y=ne.normalized,ae=ne.itemSize,xe=e.get(ne);if(xe===void 0)continue;const fe=xe.buffer,de=xe.type,Ie=xe.bytesPerElement,Ge=de===r.INT||de===r.UNSIGNED_INT||ne.gpuType===jC;if(ne.isInterleavedBufferAttribute){const Xe=ne.data,$e=Xe.stride,lt=ne.offset;if(Xe.isInstancedInterleavedBuffer){for(let At=0;At<V.locationSize;At++)_(V.location+At,Xe.meshPerAttribute);O.isInstancedMesh!==!0&&G._maxInstanceCount===void 0&&(G._maxInstanceCount=Xe.meshPerAttribute*Xe.count)}else for(let At=0;At<V.locationSize;At++)v(V.location+At);r.bindBuffer(r.ARRAY_BUFFER,fe);for(let At=0;At<V.locationSize;At++)w(V.location+At,ae/V.locationSize,de,Y,$e*Ie,(lt+ae/V.locationSize*At)*Ie,Ge)}else{if(ne.isInstancedBufferAttribute){for(let Xe=0;Xe<V.locationSize;Xe++)_(V.location+Xe,ne.meshPerAttribute);O.isInstancedMesh!==!0&&G._maxInstanceCount===void 0&&(G._maxInstanceCount=ne.meshPerAttribute*ne.count)}else for(let Xe=0;Xe<V.locationSize;Xe++)v(V.location+Xe);r.bindBuffer(r.ARRAY_BUFFER,fe);for(let Xe=0;Xe<V.locationSize;Xe++)w(V.location+Xe,ae/V.locationSize,de,Y,ae*Ie,ae/V.locationSize*Xe*Ie,Ge)}}else if(Q!==void 0){const Y=Q[H];if(Y!==void 0)switch(Y.length){case 2:r.vertexAttrib2fv(V.location,Y);break;case 3:r.vertexAttrib3fv(V.location,Y);break;case 4:r.vertexAttrib4fv(V.location,Y);break;default:r.vertexAttrib1fv(V.location,Y)}}}}T()}function R(){D();for(const O in n){const U=n[O];for(const Z in U){const G=U[Z];for(const z in G)p(G[z].object),delete G[z];delete U[Z]}delete n[O]}}function B(O){if(n[O.id]===void 0)return;const U=n[O.id];for(const Z in U){const G=U[Z];for(const z in G)p(G[z].object),delete G[z];delete U[Z]}delete n[O.id]}function I(O){for(const U in n){const Z=n[U];if(Z[O.id]===void 0)continue;const G=Z[O.id];for(const z in G)p(G[z].object),delete G[z];delete Z[O.id]}}function D(){L(),l=!0,o!==s&&(o=s,h(o.object))}function L(){s.geometry=null,s.program=null,s.wireframe=!1}return{setup:u,reset:D,resetDefaultState:L,dispose:R,releaseStatesOfGeometry:B,releaseStatesOfProgram:I,initAttributes:x,enableAttribute:v,disableUnusedAttributes:T}}function See(r,e,i){let n;function s(h){n=h}function o(h,p){r.drawArrays(n,h,p),i.update(p,n,1)}function l(h,p,f){f!==0&&(r.drawArraysInstanced(n,h,p,f),i.update(p,n,f))}function u(h,p,f){if(f===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(n,h,0,p,0,f);let m=0;for(let g=0;g<f;g++)m+=p[g];i.update(m,n,1)}function c(h,p,f,m){if(f===0)return;const g=e.get("WEBGL_multi_draw");if(g===null)for(let y=0;y<h.length;y++)l(h[y],p[y],m[y]);else{g.multiDrawArraysInstancedWEBGL(n,h,0,p,0,m,0,f);let y=0;for(let x=0;x<f;x++)y+=p[x]*m[x];i.update(y,n,1)}}this.setMode=s,this.render=o,this.renderInstances=l,this.renderMultiDraw=u,this.renderMultiDrawInstances=c}function Tee(r,e,i,n){let s;function o(){if(s!==void 0)return s;if(e.has("EXT_texture_filter_anisotropic")===!0){const I=e.get("EXT_texture_filter_anisotropic");s=r.getParameter(I.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else s=0;return s}function l(I){return!(I!==ic&&n.convert(I)!==r.getParameter(r.IMPLEMENTATION_COLOR_READ_FORMAT))}function u(I){const D=I===mm&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(I!==_u&&n.convert(I)!==r.getParameter(r.IMPLEMENTATION_COLOR_READ_TYPE)&&I!==Eu&&!D)}function c(I){if(I==="highp"){if(r.getShaderPrecisionFormat(r.VERTEX_SHADER,r.HIGH_FLOAT).precision>0&&r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.HIGH_FLOAT).precision>0)return"highp";I="mediump"}return I==="mediump"&&r.getShaderPrecisionFormat(r.VERTEX_SHADER,r.MEDIUM_FLOAT).precision>0&&r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let h=i.precision!==void 0?i.precision:"highp";const p=c(h);p!==h&&(console.warn("THREE.WebGLRenderer:",h,"not supported, using",p,"instead."),h=p);const f=i.logarithmicDepthBuffer===!0,m=i.reverseDepthBuffer===!0&&e.has("EXT_clip_control"),g=r.getParameter(r.MAX_TEXTURE_IMAGE_UNITS),y=r.getParameter(r.MAX_VERTEX_TEXTURE_IMAGE_UNITS),x=r.getParameter(r.MAX_TEXTURE_SIZE),v=r.getParameter(r.MAX_CUBE_MAP_TEXTURE_SIZE),_=r.getParameter(r.MAX_VERTEX_ATTRIBS),T=r.getParameter(r.MAX_VERTEX_UNIFORM_VECTORS),w=r.getParameter(r.MAX_VARYING_VECTORS),S=r.getParameter(r.MAX_FRAGMENT_UNIFORM_VECTORS),R=y>0,B=r.getParameter(r.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:o,getMaxPrecision:c,textureFormatReadable:l,textureTypeReadable:u,precision:h,logarithmicDepthBuffer:f,reverseDepthBuffer:m,maxTextures:g,maxVertexTextures:y,maxTextureSize:x,maxCubemapSize:v,maxAttributes:_,maxVertexUniforms:T,maxVaryings:w,maxFragmentUniforms:S,vertexTextures:R,maxSamples:B}}function Mee(r){const e=this;let i=null,n=0,s=!1,o=!1;const l=new oc,u=new gn,c={value:null,needsUpdate:!1};this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(f,m){const g=f.length!==0||m||n!==0||s;return s=m,n=f.length,g},this.beginShadows=function(){o=!0,p(null)},this.endShadows=function(){o=!1},this.setGlobalState=function(f,m){i=p(f,m,0)},this.setState=function(f,m,g){const y=f.clippingPlanes,x=f.clipIntersection,v=f.clipShadows,_=r.get(f);if(!s||y===null||y.length===0||o&&!v)o?p(null):h();else{const T=o?0:n,w=T*4;let S=_.clippingState||null;c.value=S,S=p(y,m,w,g);for(let R=0;R!==w;++R)S[R]=i[R];_.clippingState=S,this.numIntersection=x?this.numPlanes:0,this.numPlanes+=T}};function h(){c.value!==i&&(c.value=i,c.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function p(f,m,g,y){const x=f!==null?f.length:0;let v=null;if(x!==0){if(v=c.value,y!==!0||v===null){const _=g+x*4,T=m.matrixWorldInverse;u.getNormalMatrix(T),(v===null||v.length<_)&&(v=new Float32Array(_));for(let w=0,S=g;w!==x;++w,S+=4)l.copy(f[w]).applyMatrix4(T,u),l.normal.toArray(v,S),v[S+3]=l.constant}c.value=v,c.needsUpdate=!0}return e.numPlanes=x,e.numIntersection=0,v}}function Ree(r){let e=new WeakMap;function i(l,u){return u===PC?l.mapping=pm:u===kC&&(l.mapping=fm),l}function n(l){if(l&&l.isTexture){const u=l.mapping;if(u===PC||u===kC)if(e.has(l)){const c=e.get(l).texture;return i(c,l.mapping)}else{const c=l.image;if(c&&c.height>0){const h=new zJ(c.height);return h.fromEquirectangularTexture(r,l),e.set(l,h),l.addEventListener("dispose",s),i(h.texture,l.mapping)}else return null}}return l}function s(l){const u=l.target;u.removeEventListener("dispose",s);const c=e.get(u);c!==void 0&&(e.delete(u),c.dispose())}function o(){e=new WeakMap}return{get:n,dispose:o}}let HS=class extends ok{constructor(r=-1,e=1,i=1,n=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=r,this.right=e,this.top=i,this.bottom=n,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(r,e){return super.copy(r,e),this.left=r.left,this.right=r.right,this.top=r.top,this.bottom=r.bottom,this.near=r.near,this.far=r.far,this.zoom=r.zoom,this.view=r.view===null?null:Object.assign({},r.view),this}setViewOffset(r,e,i,n,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=r,this.view.fullHeight=e,this.view.offsetX=i,this.view.offsetY=n,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const r=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,n=(this.top+this.bottom)/2;let s=i-r,o=i+r,l=n+e,u=n-e;if(this.view!==null&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,h=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,l-=h*this.view.offsetY,u=l-h*this.view.height}this.projectionMatrix.makeOrthographic(s,o,l,u,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(r){const e=super.toJSON(r);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,this.view!==null&&(e.object.view=Object.assign({},this.view)),e}};const Pm=4,dk=[.125,.215,.35,.446,.526,.582],vp=20,WS=new HS,pk=new Tn;let QS=null,qS=0,XS=0,YS=!1;const xp=(1+Math.sqrt(5))/2,km=1/xp,fk=[new at(-xp,km,0),new at(xp,km,0),new at(-km,0,xp),new at(km,0,xp),new at(0,xp,-km),new at(0,xp,km),new at(-1,1,-1),new at(1,1,-1),new at(-1,1,1),new at(1,1,1)];let mk=class{constructor(r){this._renderer=r,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(r,e=0,i=.1,n=100){QS=this._renderer.getRenderTarget(),qS=this._renderer.getActiveCubeFace(),XS=this._renderer.getActiveMipmapLevel(),YS=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(r,i,n,s),e>0&&this._blur(s,0,0,e),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(r,e=null){return this._fromTexture(r,e)}fromCubemap(r,e=null){return this._fromTexture(r,e)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=yk(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=Ak(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(r){this._lodMax=Math.floor(Math.log2(r)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let r=0;r<this._lodPlanes.length;r++)this._lodPlanes[r].dispose()}_cleanup(r){this._renderer.setRenderTarget(QS,qS,XS),this._renderer.xr.enabled=YS,r.scissorTest=!1,Rb(r,0,0,r.width,r.height)}_fromTexture(r,e){r.mapping===pm||r.mapping===fm?this._setSize(r.image.length===0?16:r.image[0].width||r.image[0].image.width):this._setSize(r.image.width/4),QS=this._renderer.getRenderTarget(),qS=this._renderer.getActiveCubeFace(),XS=this._renderer.getActiveMipmapLevel(),YS=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const i=e||this._allocateTargets();return this._textureToCubeUV(r,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const r=3*Math.max(this._cubeSize,112),e=4*this._cubeSize,i={magFilter:Fc,minFilter:Fc,generateMipmaps:!1,type:mm,format:ic,colorSpace:vm,depthBuffer:!1},n=gk(r,e,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==r||this._pingPongRenderTarget.height!==e){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=gk(r,e,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=Iee(s)),this._blurMaterial=Bee(s,r,e)}return n}_compileMaterial(r){const e=new za(this._lodPlanes[0],r);this._renderer.compile(e,WS)}_sceneToCubeUV(r,e,i,n){const s=new Dl(90,1,e,i),o=[1,-1,1,1,1,1],l=[1,1,1,-1,-1,-1],u=this._renderer,c=u.autoClear,h=u.toneMapping;u.getClearColor(pk),u.toneMapping=Vh,u.autoClear=!1;const p=new Jh({name:"PMREM.Background",side:vo,depthWrite:!1,depthTest:!1}),f=new za(new Nm,p);let m=!1;const g=r.background;g?g.isColor&&(p.color.copy(g),r.background=null,m=!0):(p.color.copy(pk),m=!0);for(let y=0;y<6;y++){const x=y%3;x===0?(s.up.set(0,o[y],0),s.lookAt(l[y],0,0)):x===1?(s.up.set(0,0,o[y]),s.lookAt(0,l[y],0)):(s.up.set(0,o[y],0),s.lookAt(0,0,l[y]));const v=this._cubeSize;Rb(n,x*v,y>2?v:0,v,v),u.setRenderTarget(n),m&&u.render(f,s),u.render(r,s)}f.geometry.dispose(),f.material.dispose(),u.toneMapping=h,u.autoClear=c,r.background=g}_textureToCubeUV(r,e){const i=this._renderer,n=r.mapping===pm||r.mapping===fm;n?(this._cubemapMaterial===null&&(this._cubemapMaterial=yk()),this._cubemapMaterial.uniforms.flipEnvMap.value=r.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=Ak());const s=n?this._cubemapMaterial:this._equirectMaterial,o=new za(this._lodPlanes[0],s),l=s.uniforms;l.envMap.value=r;const u=this._cubeSize;Rb(e,0,0,3*u,2*u),i.setRenderTarget(e),i.render(o,WS)}_applyPMREM(r){const e=this._renderer,i=e.autoClear;e.autoClear=!1;const n=this._lodPlanes.length;for(let s=1;s<n;s++){const o=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]),l=fk[(n-s-1)%fk.length];this._blur(r,s-1,s,o,l)}e.autoClear=i}_blur(r,e,i,n,s){const o=this._pingPongRenderTarget;this._halfBlur(r,o,e,i,n,"latitudinal",s),this._halfBlur(o,r,i,i,n,"longitudinal",s)}_halfBlur(r,e,i,n,s,o,l){const u=this._renderer,c=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const h=3,p=new za(this._lodPlanes[n],c),f=c.uniforms,m=this._sizeLods[i]-1,g=isFinite(s)?Math.PI/(2*m):2*Math.PI/(2*vp-1),y=s/g,x=isFinite(s)?1+Math.floor(h*y):vp;x>vp&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${x} samples when the maximum is set to ${vp}`);const v=[];let _=0;for(let B=0;B<vp;++B){const I=B/y,D=Math.exp(-I*I/2);v.push(D),B===0?_+=D:B<x&&(_+=2*D)}for(let B=0;B<v.length;B++)v[B]=v[B]/_;f.envMap.value=r.texture,f.samples.value=x,f.weights.value=v,f.latitudinal.value=o==="latitudinal",l&&(f.poleAxis.value=l);const{_lodMax:T}=this;f.dTheta.value=g,f.mipInt.value=T-i;const w=this._sizeLods[n],S=3*w*(n>T-Pm?n-T+Pm:0),R=4*(this._cubeSize-w);Rb(e,S,R,3*w,2*w),u.setRenderTarget(e),u.render(p,WS)}};function Iee(r){const e=[],i=[],n=[];let s=r;const o=r-Pm+1+dk.length;for(let l=0;l<o;l++){const u=Math.pow(2,s);i.push(u);let c=1/u;l>r-Pm?c=dk[l-r+Pm-1]:l===0&&(c=0),n.push(c);const h=1/(u-2),p=-h,f=1+h,m=[p,p,f,p,f,f,p,p,f,f,p,f],g=6,y=6,x=3,v=2,_=1,T=new Float32Array(x*y*g),w=new Float32Array(v*y*g),S=new Float32Array(_*y*g);for(let B=0;B<g;B++){const I=B%3*2/3-1,D=B>2?0:-1,L=[I,D,0,I+2/3,D,0,I+2/3,D+1,0,I,D,0,I+2/3,D+1,0,I,D+1,0];T.set(L,x*y*B),w.set(m,v*y*B);const O=[B,B,B,B,B,B];S.set(O,_*y*B)}const R=new Vo;R.setAttribute("position",new jo(T,x)),R.setAttribute("uv",new jo(w,v)),R.setAttribute("faceIndex",new jo(S,_)),e.push(R),s>Pm&&s--}return{lodPlanes:e,sizeLods:i,sigmas:n}}function gk(r,e,i){const n=new Hh(r,e,i);return n.texture.mapping=$x,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function Rb(r,e,i,n,s){r.viewport.set(e,i,n,s),r.scissor.set(e,i,n,s)}function Bee(r,e,i){const n=new Float32Array(vp),s=new at(0,1,0);return new zc({name:"SphericalGaussianBlur",defines:{n:vp,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/i,CUBEUV_MAX_MIP:`${r}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:s}},vertexShader:KS(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:bu,depthTest:!1,depthWrite:!1})}function Ak(){return new zc({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:KS(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:bu,depthTest:!1,depthWrite:!1})}function yk(){return new zc({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:KS(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:bu,depthTest:!1,depthWrite:!1})}function KS(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function Nee(r){let e=new WeakMap,i=null;function n(u){if(u&&u.isTexture){const c=u.mapping,h=c===PC||c===kC,p=c===pm||c===fm;if(h||p){let f=e.get(u);const m=f!==void 0?f.texture.pmremVersion:0;if(u.isRenderTargetTexture&&u.pmremVersion!==m)return i===null&&(i=new mk(r)),f=h?i.fromEquirectangular(u,f):i.fromCubemap(u,f),f.texture.pmremVersion=u.pmremVersion,e.set(u,f),f.texture;if(f!==void 0)return f.texture;{const g=u.image;return h&&g&&g.height>0||p&&g&&s(g)?(i===null&&(i=new mk(r)),f=h?i.fromEquirectangular(u):i.fromCubemap(u),f.texture.pmremVersion=u.pmremVersion,e.set(u,f),u.addEventListener("dispose",o),f.texture):null}}}return u}function s(u){let c=0;const h=6;for(let p=0;p<h;p++)u[p]!==void 0&&c++;return c===h}function o(u){const c=u.target;c.removeEventListener("dispose",o);const h=e.get(c);h!==void 0&&(e.delete(c),h.dispose())}function l(){e=new WeakMap,i!==null&&(i.dispose(),i=null)}return{get:n,dispose:l}}function Lee(r){const e={};function i(n){if(e[n]!==void 0)return e[n];let s;switch(n){case"WEBGL_depth_texture":s=r.getExtension("WEBGL_depth_texture")||r.getExtension("MOZ_WEBGL_depth_texture")||r.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":s=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":s=r.getExtension("WEBGL_compressed_texture_s3tc")||r.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":s=r.getExtension("WEBGL_compressed_texture_pvrtc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:s=r.getExtension(n)}return e[n]=s,s}return{has:function(n){return i(n)!==null},init:function(){i("EXT_color_buffer_float"),i("WEBGL_clip_cull_distance"),i("OES_texture_float_linear"),i("EXT_color_buffer_half_float"),i("WEBGL_multisampled_render_to_texture"),i("WEBGL_render_shared_exponent")},get:function(n){const s=i(n);return s===null&&yA("THREE.WebGLRenderer: "+n+" extension not supported."),s}}}function Dee(r,e,i,n){const s={},o=new WeakMap;function l(f){const m=f.target;m.index!==null&&e.remove(m.index);for(const y in m.attributes)e.remove(m.attributes[y]);for(const y in m.morphAttributes){const x=m.morphAttributes[y];for(let v=0,_=x.length;v<_;v++)e.remove(x[v])}m.removeEventListener("dispose",l),delete s[m.id];const g=o.get(m);g&&(e.remove(g),o.delete(m)),n.releaseStatesOfGeometry(m),m.isInstancedBufferGeometry===!0&&delete m._maxInstanceCount,i.memory.geometries--}function u(f,m){return s[m.id]===!0||(m.addEventListener("dispose",l),s[m.id]=!0,i.memory.geometries++),m}function c(f){const m=f.attributes;for(const y in m)e.update(m[y],r.ARRAY_BUFFER);const g=f.morphAttributes;for(const y in g){const x=g[y];for(let v=0,_=x.length;v<_;v++)e.update(x[v],r.ARRAY_BUFFER)}}function h(f){const m=[],g=f.index,y=f.attributes.position;let x=0;if(g!==null){const T=g.array;x=g.version;for(let w=0,S=T.length;w<S;w+=3){const R=T[w+0],B=T[w+1],I=T[w+2];m.push(R,B,B,I,I,R)}}else if(y!==void 0){const T=y.array;x=y.version;for(let w=0,S=T.length/3-1;w<S;w+=3){const R=w+0,B=w+1,I=w+2;m.push(R,B,B,I,I,R)}}else return;const v=new(OP(m)?tk:ek)(m,1);v.version=x;const _=o.get(f);_&&e.remove(_),o.set(f,v)}function p(f){const m=o.get(f);if(m){const g=f.index;g!==null&&m.version<g.version&&h(f)}else h(f);return o.get(f)}return{get:u,update:c,getWireframeAttribute:p}}function Oee(r,e,i){let n;function s(m){n=m}let o,l;function u(m){o=m.type,l=m.bytesPerElement}function c(m,g){r.drawElements(n,g,o,m*l),i.update(g,n,1)}function h(m,g,y){y!==0&&(r.drawElementsInstanced(n,g,o,m*l,y),i.update(g,n,y))}function p(m,g,y){if(y===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(n,g,0,o,m,0,y);let x=0;for(let v=0;v<y;v++)x+=g[v];i.update(x,n,1)}function f(m,g,y,x){if(y===0)return;const v=e.get("WEBGL_multi_draw");if(v===null)for(let _=0;_<m.length;_++)h(m[_]/l,g[_],x[_]);else{v.multiDrawElementsInstancedWEBGL(n,g,0,o,m,0,x,0,y);let _=0;for(let T=0;T<y;T++)_+=g[T]*x[T];i.update(_,n,1)}}this.setMode=s,this.setIndex=u,this.render=c,this.renderInstances=h,this.renderMultiDraw=p,this.renderMultiDrawInstances=f}function Pee(r){const e={geometries:0,textures:0},i={frame:0,calls:0,triangles:0,points:0,lines:0};function n(o,l,u){switch(i.calls++,l){case r.TRIANGLES:i.triangles+=u*(o/3);break;case r.LINES:i.lines+=u*(o/2);break;case r.LINE_STRIP:i.lines+=u*(o-1);break;case r.LINE_LOOP:i.lines+=u*o;break;case r.POINTS:i.points+=u*o;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",l);break}}function s(){i.calls=0,i.triangles=0,i.points=0,i.lines=0}return{memory:e,render:i,programs:null,autoReset:!0,reset:s,update:n}}function kee(r,e,i){const n=new WeakMap,s=new Js;function o(l,u,c){const h=l.morphTargetInfluences,p=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,f=p!==void 0?p.length:0;let m=n.get(u);if(m===void 0||m.count!==f){let g=function(){D.dispose(),n.delete(u),u.removeEventListener("dispose",g)};m!==void 0&&m.texture.dispose();const y=u.morphAttributes.position!==void 0,x=u.morphAttributes.normal!==void 0,v=u.morphAttributes.color!==void 0,_=u.morphAttributes.position||[],T=u.morphAttributes.normal||[],w=u.morphAttributes.color||[];let S=0;y===!0&&(S=1),x===!0&&(S=2),v===!0&&(S=3);let R=u.attributes.position.count*S,B=1;R>e.maxTextureSize&&(B=Math.ceil(R/e.maxTextureSize),R=e.maxTextureSize);const I=new Float32Array(R*B*4*f),D=new GP(I,R,B,f);D.type=Eu,D.needsUpdate=!0;const L=S*4;for(let O=0;O<f;O++){const U=_[O],Z=T[O],G=w[O],z=R*B*4*O;for(let $=0;$<U.count;$++){const Q=$*L;y===!0&&(s.fromBufferAttribute(U,$),I[z+Q+0]=s.x,I[z+Q+1]=s.y,I[z+Q+2]=s.z,I[z+Q+3]=0),x===!0&&(s.fromBufferAttribute(Z,$),I[z+Q+4]=s.x,I[z+Q+5]=s.y,I[z+Q+6]=s.z,I[z+Q+7]=0),v===!0&&(s.fromBufferAttribute(G,$),I[z+Q+8]=s.x,I[z+Q+9]=s.y,I[z+Q+10]=s.z,I[z+Q+11]=G.itemSize===4?s.w:1)}}m={count:f,texture:D,size:new ji(R,B)},n.set(u,m),u.addEventListener("dispose",g)}if(l.isInstancedMesh===!0&&l.morphTexture!==null)c.getUniforms().setValue(r,"morphTexture",l.morphTexture,i);else{let g=0;for(let x=0;x<h.length;x++)g+=h[x];const y=u.morphTargetsRelative?1:1-g;c.getUniforms().setValue(r,"morphTargetBaseInfluence",y),c.getUniforms().setValue(r,"morphTargetInfluences",h)}c.getUniforms().setValue(r,"morphTargetsTexture",m.texture,i),c.getUniforms().setValue(r,"morphTargetsTextureSize",m.size)}return{update:o}}function Fee(r,e,i,n){let s=new WeakMap;function o(c){const h=n.render.frame,p=c.geometry,f=e.get(c,p);if(s.get(f)!==h&&(e.update(f),s.set(f,h)),c.isInstancedMesh&&(c.hasEventListener("dispose",u)===!1&&c.addEventListener("dispose",u),s.get(c)!==h&&(i.update(c.instanceMatrix,r.ARRAY_BUFFER),c.instanceColor!==null&&i.update(c.instanceColor,r.ARRAY_BUFFER),s.set(c,h))),c.isSkinnedMesh){const m=c.skeleton;s.get(m)!==h&&(m.update(),s.set(m,h))}return f}function l(){s=new WeakMap}function u(c){const h=c.target;h.removeEventListener("dispose",u),i.remove(h.instanceMatrix),h.instanceColor!==null&&i.remove(h.instanceColor)}return{update:o,dispose:l}}let vk=class extends Nl{constructor(r,e,i,n,s,o,l,u,c,h=Am){if(h!==Am&&h!==ym)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&h===Am&&(i=cp),i===void 0&&h===ym&&(i=gm),super(null,n,s,o,l,u,h,i,c),this.isDepthTexture=!0,this.image={width:r,height:e},this.magFilter=l!==void 0?l:tc,this.minFilter=u!==void 0?u:tc,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(r){return super.copy(r),this.compareFunction=r.compareFunction,this}toJSON(r){const e=super.toJSON(r);return this.compareFunction!==null&&(e.compareFunction=this.compareFunction),e}};const xk=new Nl,bk=new vk(1,1),_k=new GP,Ek=new CJ,wk=new uk,Ck=[],Sk=[],Tk=new Float32Array(16),Mk=new Float32Array(9),Rk=new Float32Array(4);function Fm(r,e,i){const n=r[0];if(n<=0||n>0)return r;const s=e*i;let o=Ck[s];if(o===void 0&&(o=new Float32Array(s),Ck[s]=o),e!==0){n.toArray(o,0);for(let l=1,u=0;l!==e;++l)u+=i,r[l].toArray(o,u)}return o}function ma(r,e){if(r.length!==e.length)return!1;for(let i=0,n=r.length;i<n;i++)if(r[i]!==e[i])return!1;return!0}function ga(r,e){for(let i=0,n=e.length;i<n;i++)r[i]=e[i]}function Ib(r,e){let i=Sk[e];i===void 0&&(i=new Int32Array(e),Sk[e]=i);for(let n=0;n!==e;++n)i[n]=r.allocateTextureUnit();return i}function Uee(r,e){const i=this.cache;i[0]!==e&&(r.uniform1f(this.addr,e),i[0]=e)}function zee(r,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y)&&(r.uniform2f(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(ma(i,e))return;r.uniform2fv(this.addr,e),ga(i,e)}}function jee(r,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z)&&(r.uniform3f(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else if(e.r!==void 0)(i[0]!==e.r||i[1]!==e.g||i[2]!==e.b)&&(r.uniform3f(this.addr,e.r,e.g,e.b),i[0]=e.r,i[1]=e.g,i[2]=e.b);else{if(ma(i,e))return;r.uniform3fv(this.addr,e),ga(i,e)}}function Vee(r,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z||i[3]!==e.w)&&(r.uniform4f(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(ma(i,e))return;r.uniform4fv(this.addr,e),ga(i,e)}}function Gee(r,e){const i=this.cache,n=e.elements;if(n===void 0){if(ma(i,e))return;r.uniformMatrix2fv(this.addr,!1,e),ga(i,e)}else{if(ma(i,n))return;Rk.set(n),r.uniformMatrix2fv(this.addr,!1,Rk),ga(i,n)}}function Hee(r,e){const i=this.cache,n=e.elements;if(n===void 0){if(ma(i,e))return;r.uniformMatrix3fv(this.addr,!1,e),ga(i,e)}else{if(ma(i,n))return;Mk.set(n),r.uniformMatrix3fv(this.addr,!1,Mk),ga(i,n)}}function Wee(r,e){const i=this.cache,n=e.elements;if(n===void 0){if(ma(i,e))return;r.uniformMatrix4fv(this.addr,!1,e),ga(i,e)}else{if(ma(i,n))return;Tk.set(n),r.uniformMatrix4fv(this.addr,!1,Tk),ga(i,n)}}function Qee(r,e){const i=this.cache;i[0]!==e&&(r.uniform1i(this.addr,e),i[0]=e)}function qee(r,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y)&&(r.uniform2i(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(ma(i,e))return;r.uniform2iv(this.addr,e),ga(i,e)}}function Xee(r,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z)&&(r.uniform3i(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else{if(ma(i,e))return;r.uniform3iv(this.addr,e),ga(i,e)}}function Yee(r,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z||i[3]!==e.w)&&(r.uniform4i(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(ma(i,e))return;r.uniform4iv(this.addr,e),ga(i,e)}}function Kee(r,e){const i=this.cache;i[0]!==e&&(r.uniform1ui(this.addr,e),i[0]=e)}function Jee(r,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y)&&(r.uniform2ui(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(ma(i,e))return;r.uniform2uiv(this.addr,e),ga(i,e)}}function Zee(r,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z)&&(r.uniform3ui(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else{if(ma(i,e))return;r.uniform3uiv(this.addr,e),ga(i,e)}}function $ee(r,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z||i[3]!==e.w)&&(r.uniform4ui(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(ma(i,e))return;r.uniform4uiv(this.addr,e),ga(i,e)}}function ete(r,e,i){const n=this.cache,s=i.allocateTextureUnit();n[0]!==s&&(r.uniform1i(this.addr,s),n[0]=s);let o;this.type===r.SAMPLER_2D_SHADOW?(bk.compareFunction=NP,o=bk):o=xk,i.setTexture2D(e||o,s)}function tte(r,e,i){const n=this.cache,s=i.allocateTextureUnit();n[0]!==s&&(r.uniform1i(this.addr,s),n[0]=s),i.setTexture3D(e||Ek,s)}function ite(r,e,i){const n=this.cache,s=i.allocateTextureUnit();n[0]!==s&&(r.uniform1i(this.addr,s),n[0]=s),i.setTextureCube(e||wk,s)}function rte(r,e,i){const n=this.cache,s=i.allocateTextureUnit();n[0]!==s&&(r.uniform1i(this.addr,s),n[0]=s),i.setTexture2DArray(e||_k,s)}function nte(r){switch(r){case 5126:return Uee;case 35664:return zee;case 35665:return jee;case 35666:return Vee;case 35674:return Gee;case 35675:return Hee;case 35676:return Wee;case 5124:case 35670:return Qee;case 35667:case 35671:return qee;case 35668:case 35672:return Xee;case 35669:case 35673:return Yee;case 5125:return Kee;case 36294:return Jee;case 36295:return Zee;case 36296:return $ee;case 35678:case 36198:case 36298:case 36306:case 35682:return ete;case 35679:case 36299:case 36307:return tte;case 35680:case 36300:case 36308:case 36293:return ite;case 36289:case 36303:case 36311:case 36292:return rte}}function ste(r,e){r.uniform1fv(this.addr,e)}function ate(r,e){const i=Fm(e,this.size,2);r.uniform2fv(this.addr,i)}function ote(r,e){const i=Fm(e,this.size,3);r.uniform3fv(this.addr,i)}function lte(r,e){const i=Fm(e,this.size,4);r.uniform4fv(this.addr,i)}function cte(r,e){const i=Fm(e,this.size,4);r.uniformMatrix2fv(this.addr,!1,i)}function ute(r,e){const i=Fm(e,this.size,9);r.uniformMatrix3fv(this.addr,!1,i)}function hte(r,e){const i=Fm(e,this.size,16);r.uniformMatrix4fv(this.addr,!1,i)}function dte(r,e){r.uniform1iv(this.addr,e)}function pte(r,e){r.uniform2iv(this.addr,e)}function fte(r,e){r.uniform3iv(this.addr,e)}function mte(r,e){r.uniform4iv(this.addr,e)}function gte(r,e){r.uniform1uiv(this.addr,e)}function Ate(r,e){r.uniform2uiv(this.addr,e)}function yte(r,e){r.uniform3uiv(this.addr,e)}function vte(r,e){r.uniform4uiv(this.addr,e)}function xte(r,e,i){const n=this.cache,s=e.length,o=Ib(i,s);ma(n,o)||(r.uniform1iv(this.addr,o),ga(n,o));for(let l=0;l!==s;++l)i.setTexture2D(e[l]||xk,o[l])}function bte(r,e,i){const n=this.cache,s=e.length,o=Ib(i,s);ma(n,o)||(r.uniform1iv(this.addr,o),ga(n,o));for(let l=0;l!==s;++l)i.setTexture3D(e[l]||Ek,o[l])}function _te(r,e,i){const n=this.cache,s=e.length,o=Ib(i,s);ma(n,o)||(r.uniform1iv(this.addr,o),ga(n,o));for(let l=0;l!==s;++l)i.setTextureCube(e[l]||wk,o[l])}function Ete(r,e,i){const n=this.cache,s=e.length,o=Ib(i,s);ma(n,o)||(r.uniform1iv(this.addr,o),ga(n,o));for(let l=0;l!==s;++l)i.setTexture2DArray(e[l]||_k,o[l])}function wte(r){switch(r){case 5126:return ste;case 35664:return ate;case 35665:return ote;case 35666:return lte;case 35674:return cte;case 35675:return ute;case 35676:return hte;case 5124:case 35670:return dte;case 35667:case 35671:return pte;case 35668:case 35672:return fte;case 35669:case 35673:return mte;case 5125:return gte;case 36294:return Ate;case 36295:return yte;case 36296:return vte;case 35678:case 36198:case 36298:case 36306:case 35682:return xte;case 35679:case 36299:case 36307:return bte;case 35680:case 36300:case 36308:case 36293:return _te;case 36289:case 36303:case 36311:case 36292:return Ete}}class Cte{constructor(e,i,n){this.id=e,this.addr=n,this.cache=[],this.type=i.type,this.setValue=nte(i.type)}}class Ste{constructor(e,i,n){this.id=e,this.addr=n,this.cache=[],this.type=i.type,this.size=i.size,this.setValue=wte(i.type)}}class Tte{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,i,n){const s=this.seq;for(let o=0,l=s.length;o!==l;++o){const u=s[o];u.setValue(e,i[u.id],n)}}}const JS=/(\w+)(\])?(\[|\.)?/g;function Ik(r,e){r.seq.push(e),r.map[e.id]=e}function Mte(r,e,i){const n=r.name,s=n.length;for(JS.lastIndex=0;;){const o=JS.exec(n),l=JS.lastIndex;let u=o[1];const c=o[2]==="]",h=o[3];if(c&&(u=u|0),h===void 0||h==="["&&l+2===s){Ik(i,h===void 0?new Cte(u,r,e):new Ste(u,r,e));break}else{let p=i.map[u];p===void 0&&(p=new Tte(u),Ik(i,p)),i=p}}}class Bb{constructor(e,i){this.seq=[],this.map={};const n=e.getProgramParameter(i,e.ACTIVE_UNIFORMS);for(let s=0;s<n;++s){const o=e.getActiveUniform(i,s),l=e.getUniformLocation(i,o.name);Mte(o,l,this)}}setValue(e,i,n,s){const o=this.map[i];o!==void 0&&o.setValue(e,n,s)}setOptional(e,i,n){const s=i[n];s!==void 0&&this.setValue(e,n,s)}static upload(e,i,n,s){for(let o=0,l=i.length;o!==l;++o){const u=i[o],c=n[u.id];c.needsUpdate!==!1&&u.setValue(e,c.value,s)}}static seqWithValue(e,i){const n=[];for(let s=0,o=e.length;s!==o;++s){const l=e[s];l.id in i&&n.push(l)}return n}}function Bk(r,e,i){const n=r.createShader(e);return r.shaderSource(n,i),r.compileShader(n),n}const Rte=37297;let Ite=0;function Bte(r,e){const i=r.split(`
`),n=[],s=Math.max(e-6,0),o=Math.min(e+6,i.length);for(let l=s;l<o;l++){const u=l+1;n.push(`${u===e?">":" "} ${u}: ${i[l]}`)}return n.join(`
`)}const Nk=new gn;function Nte(r){zn._getMatrix(Nk,zn.workingColorSpace,r);const e=`mat3( ${Nk.elements.map(i=>i.toFixed(4))} )`;switch(zn.getTransfer(r)){case ab:return[e,"LinearTransferOETF"];case cs:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",r),[e,"LinearTransferOETF"]}}function Lk(r,e,i){const n=r.getShaderParameter(e,r.COMPILE_STATUS),s=r.getShaderInfoLog(e).trim();if(n&&s==="")return"";const o=/ERROR: 0:(\d+)/.exec(s);if(o){const l=parseInt(o[1]);return i.toUpperCase()+`

`+s+`

`+Bte(r.getShaderSource(e),l)}else return s}function Lte(r,e){const i=Nte(e);return[`vec4 ${r}( vec4 value ) {`,`	return ${i[1]}( vec4( value.rgb * ${i[0]}, value.a ) );`,"}"].join(`
`)}function Dte(r,e){let i;switch(e){case kK:i="Linear";break;case FK:i="Reinhard";break;case UK:i="Cineon";break;case zK:i="ACESFilmic";break;case VK:i="AgX";break;case GK:i="Neutral";break;case jK:i="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),i="Linear"}return"vec3 "+r+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}const Nb=new at;function Ote(){zn.getLuminanceCoefficients(Nb);const r=Nb.x.toFixed(4),e=Nb.y.toFixed(4),i=Nb.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${r}, ${e}, ${i} );`,"	return dot( weights, rgb );","}"].join(`
`)}function Pte(r){return[r.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",r.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(EA).join(`
`)}function kte(r){const e=[];for(const i in r){const n=r[i];n!==!1&&e.push("#define "+i+" "+n)}return e.join(`
`)}function Fte(r,e){const i={},n=r.getProgramParameter(e,r.ACTIVE_ATTRIBUTES);for(let s=0;s<n;s++){const o=r.getActiveAttrib(e,s),l=o.name;let u=1;o.type===r.FLOAT_MAT2&&(u=2),o.type===r.FLOAT_MAT3&&(u=3),o.type===r.FLOAT_MAT4&&(u=4),i[l]={type:o.type,location:r.getAttribLocation(e,l),locationSize:u}}return i}function EA(r){return r!==""}function Dk(r,e){const i=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return r.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,i).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Ok(r,e){return r.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Ute=/^[ \t]*#include +<([\w\d./]+)>/gm;function ZS(r){return r.replace(Ute,jte)}const zte=new Map;function jte(r,e){let i=hn[e];if(i===void 0){const n=zte.get(e);if(n!==void 0)i=hn[n],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return ZS(i)}const Vte=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Pk(r){return r.replace(Vte,Gte)}function Gte(r,e,i,n){let s="";for(let o=parseInt(e);o<parseInt(i);o++)s+=n.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return s}function kk(r){let e=`precision ${r.precision} float;
	precision ${r.precision} int;
	precision ${r.precision} sampler2D;
	precision ${r.precision} samplerCube;
	precision ${r.precision} sampler3D;
	precision ${r.precision} sampler2DArray;
	precision ${r.precision} sampler2DShadow;
	precision ${r.precision} samplerCubeShadow;
	precision ${r.precision} sampler2DArrayShadow;
	precision ${r.precision} isampler2D;
	precision ${r.precision} isampler3D;
	precision ${r.precision} isamplerCube;
	precision ${r.precision} isampler2DArray;
	precision ${r.precision} usampler2D;
	precision ${r.precision} usampler3D;
	precision ${r.precision} usamplerCube;
	precision ${r.precision} usampler2DArray;
	`;return r.precision==="highp"?e+=`
#define HIGH_PRECISION`:r.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:r.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function Hte(r){let e="SHADOWMAP_TYPE_BASIC";return r.shadowMapType===mP?e="SHADOWMAP_TYPE_PCF":r.shadowMapType===gK?e="SHADOWMAP_TYPE_PCF_SOFT":r.shadowMapType===vu&&(e="SHADOWMAP_TYPE_VSM"),e}function Wte(r){let e="ENVMAP_TYPE_CUBE";if(r.envMap)switch(r.envMapMode){case pm:case fm:e="ENVMAP_TYPE_CUBE";break;case $x:e="ENVMAP_TYPE_CUBE_UV";break}return e}function Qte(r){let e="ENVMAP_MODE_REFLECTION";if(r.envMap)switch(r.envMapMode){case fm:e="ENVMAP_MODE_REFRACTION";break}return e}function qte(r){let e="ENVMAP_BLENDING_NONE";if(r.envMap)switch(r.combine){case OC:e="ENVMAP_BLENDING_MULTIPLY";break;case OK:e="ENVMAP_BLENDING_MIX";break;case PK:e="ENVMAP_BLENDING_ADD";break}return e}function Xte(r){const e=r.envMapCubeUVHeight;if(e===null)return null;const i=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,i),7*16)),texelHeight:n,maxMip:i}}function Yte(r,e,i,n){const s=r.getContext(),o=i.defines;let l=i.vertexShader,u=i.fragmentShader;const c=Hte(i),h=Wte(i),p=Qte(i),f=qte(i),m=Xte(i),g=Pte(i),y=kte(o),x=s.createProgram();let v,_,T=i.glslVersion?"#version "+i.glslVersion+`
`:"";i.isRawShaderMaterial?(v=["#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,y].filter(EA).join(`
`),v.length>0&&(v+=`
`),_=["#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,y].filter(EA).join(`
`),_.length>0&&(_+=`
`)):(v=[kk(i),"#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,y,i.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",i.batching?"#define USE_BATCHING":"",i.batchingColor?"#define USE_BATCHING_COLOR":"",i.instancing?"#define USE_INSTANCING":"",i.instancingColor?"#define USE_INSTANCING_COLOR":"",i.instancingMorph?"#define USE_INSTANCING_MORPH":"",i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+p:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",i.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",i.displacementMap?"#define USE_DISPLACEMENTMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.anisotropy?"#define USE_ANISOTROPY":"",i.anisotropyMap?"#define USE_ANISOTROPYMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",i.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.alphaHash?"#define USE_ALPHAHASH":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",i.mapUv?"#define MAP_UV "+i.mapUv:"",i.alphaMapUv?"#define ALPHAMAP_UV "+i.alphaMapUv:"",i.lightMapUv?"#define LIGHTMAP_UV "+i.lightMapUv:"",i.aoMapUv?"#define AOMAP_UV "+i.aoMapUv:"",i.emissiveMapUv?"#define EMISSIVEMAP_UV "+i.emissiveMapUv:"",i.bumpMapUv?"#define BUMPMAP_UV "+i.bumpMapUv:"",i.normalMapUv?"#define NORMALMAP_UV "+i.normalMapUv:"",i.displacementMapUv?"#define DISPLACEMENTMAP_UV "+i.displacementMapUv:"",i.metalnessMapUv?"#define METALNESSMAP_UV "+i.metalnessMapUv:"",i.roughnessMapUv?"#define ROUGHNESSMAP_UV "+i.roughnessMapUv:"",i.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+i.anisotropyMapUv:"",i.clearcoatMapUv?"#define CLEARCOATMAP_UV "+i.clearcoatMapUv:"",i.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+i.clearcoatNormalMapUv:"",i.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+i.clearcoatRoughnessMapUv:"",i.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+i.iridescenceMapUv:"",i.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+i.iridescenceThicknessMapUv:"",i.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+i.sheenColorMapUv:"",i.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+i.sheenRoughnessMapUv:"",i.specularMapUv?"#define SPECULARMAP_UV "+i.specularMapUv:"",i.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+i.specularColorMapUv:"",i.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+i.specularIntensityMapUv:"",i.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+i.transmissionMapUv:"",i.thicknessMapUv?"#define THICKNESSMAP_UV "+i.thicknessMapUv:"",i.vertexTangents&&i.flatShading===!1?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUv1s?"#define USE_UV1":"",i.vertexUv2s?"#define USE_UV2":"",i.vertexUv3s?"#define USE_UV3":"",i.pointsUvs?"#define USE_POINTS_UV":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&i.flatShading===!1?"#define USE_MORPHNORMALS":"",i.morphColors?"#define USE_MORPHCOLORS":"",i.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+i.morphTextureStride:"",i.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+i.morphTargetsCount:"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+c:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.numLightProbes>0?"#define USE_LIGHT_PROBES":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(EA).join(`
`),_=[kk(i),"#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,y,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",i.map?"#define USE_MAP":"",i.matcap?"#define USE_MATCAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+h:"",i.envMap?"#define "+p:"",i.envMap?"#define "+f:"",m?"#define CUBEUV_TEXEL_WIDTH "+m.texelWidth:"",m?"#define CUBEUV_TEXEL_HEIGHT "+m.texelHeight:"",m?"#define CUBEUV_MAX_MIP "+m.maxMip+".0":"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",i.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.anisotropy?"#define USE_ANISOTROPY":"",i.anisotropyMap?"#define USE_ANISOTROPYMAP":"",i.clearcoat?"#define USE_CLEARCOAT":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.dispersion?"#define USE_DISPERSION":"",i.iridescence?"#define USE_IRIDESCENCE":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",i.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.alphaTest?"#define USE_ALPHATEST":"",i.alphaHash?"#define USE_ALPHAHASH":"",i.sheen?"#define USE_SHEEN":"",i.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.vertexTangents&&i.flatShading===!1?"#define USE_TANGENT":"",i.vertexColors||i.instancingColor||i.batchingColor?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUv1s?"#define USE_UV1":"",i.vertexUv2s?"#define USE_UV2":"",i.vertexUv3s?"#define USE_UV3":"",i.pointsUvs?"#define USE_POINTS_UV":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+c:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.numLightProbes>0?"#define USE_LIGHT_PROBES":"",i.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",i.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",i.toneMapping!==Vh?"#define TONE_MAPPING":"",i.toneMapping!==Vh?hn.tonemapping_pars_fragment:"",i.toneMapping!==Vh?Dte("toneMapping",i.toneMapping):"",i.dithering?"#define DITHERING":"",i.opaque?"#define OPAQUE":"",hn.colorspace_pars_fragment,Lte("linearToOutputTexel",i.outputColorSpace),Ote(),i.useDepthPacking?"#define DEPTH_PACKING "+i.depthPacking:"",`
`].filter(EA).join(`
`)),l=ZS(l),l=Dk(l,i),l=Ok(l,i),u=ZS(u),u=Dk(u,i),u=Ok(u,i),l=Pk(l),u=Pk(u),i.isRawShaderMaterial!==!0&&(T=`#version 300 es
`,v=[g,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+v,_=["#define varying in",i.glslVersion===LP?"":"layout(location = 0) out highp vec4 pc_fragColor;",i.glslVersion===LP?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+_);const w=T+v+l,S=T+_+u,R=Bk(s,s.VERTEX_SHADER,w),B=Bk(s,s.FRAGMENT_SHADER,S);s.attachShader(x,R),s.attachShader(x,B),i.index0AttributeName!==void 0?s.bindAttribLocation(x,0,i.index0AttributeName):i.morphTargets===!0&&s.bindAttribLocation(x,0,"position"),s.linkProgram(x);function I(U){if(r.debug.checkShaderErrors){const Z=s.getProgramInfoLog(x).trim(),G=s.getShaderInfoLog(R).trim(),z=s.getShaderInfoLog(B).trim();let $=!0,Q=!0;if(s.getProgramParameter(x,s.LINK_STATUS)===!1)if($=!1,typeof r.debug.onShaderError=="function")r.debug.onShaderError(s,x,R,B);else{const H=Lk(s,R,"vertex"),V=Lk(s,B,"fragment");console.error("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(x,s.VALIDATE_STATUS)+`

Material Name: `+U.name+`
Material Type: `+U.type+`

Program Info Log: `+Z+`
`+H+`
`+V)}else Z!==""?console.warn("THREE.WebGLProgram: Program Info Log:",Z):(G===""||z==="")&&(Q=!1);Q&&(U.diagnostics={runnable:$,programLog:Z,vertexShader:{log:G,prefix:v},fragmentShader:{log:z,prefix:_}})}s.deleteShader(R),s.deleteShader(B),D=new Bb(s,x),L=Fte(s,x)}let D;this.getUniforms=function(){return D===void 0&&I(this),D};let L;this.getAttributes=function(){return L===void 0&&I(this),L};let O=i.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return O===!1&&(O=s.getProgramParameter(x,Rte)),O},this.destroy=function(){n.releaseStatesOfProgram(this),s.deleteProgram(x),this.program=void 0},this.type=i.shaderType,this.name=i.shaderName,this.id=Ite++,this.cacheKey=e,this.usedTimes=1,this.program=x,this.vertexShader=R,this.fragmentShader=B,this}let Kte=0;class Jte{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.vertexShader,n=e.fragmentShader,s=this._getShaderStage(i),o=this._getShaderStage(n),l=this._getShaderCacheForMaterial(e);return l.has(s)===!1&&(l.add(s),s.usedTimes++),l.has(o)===!1&&(l.add(o),o.usedTimes++),this}remove(e){const i=this.materialCache.get(e);for(const n of i)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const i=this.materialCache;let n=i.get(e);return n===void 0&&(n=new Set,i.set(e,n)),n}_getShaderStage(e){const i=this.shaderCache;let n=i.get(e);return n===void 0&&(n=new Zte(e),i.set(e,n)),n}}class Zte{constructor(e){this.id=Kte++,this.code=e,this.usedTimes=0}}function $te(r,e,i,n,s,o,l){const u=new IS,c=new Jte,h=new Set,p=[],f=s.logarithmicDepthBuffer,m=s.vertexTextures;let g=s.precision;const y={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function x(L){return h.add(L),L===0?"uv":`uv${L}`}function v(L,O,U,Z,G){const z=Z.fog,$=G.geometry,Q=L.isMeshStandardMaterial?Z.environment:null,H=(L.isMeshStandardMaterial?i:e).get(L.envMap||Q),V=H&&H.mapping===$x?H.image.height:null,ne=y[L.type];L.precision!==null&&(g=s.getMaxPrecision(L.precision),g!==L.precision&&console.warn("THREE.WebGLProgram.getParameters:",L.precision,"not supported, using",g,"instead."));const Y=$.morphAttributes.position||$.morphAttributes.normal||$.morphAttributes.color,ae=Y!==void 0?Y.length:0;let xe=0;$.morphAttributes.position!==void 0&&(xe=1),$.morphAttributes.normal!==void 0&&(xe=2),$.morphAttributes.color!==void 0&&(xe=3);let fe,de,Ie,Ge;if(ne){const ki=jc[ne];fe=ki.vertexShader,de=ki.fragmentShader}else fe=L.vertexShader,de=L.fragmentShader,c.update(L),Ie=c.getVertexShaderID(L),Ge=c.getFragmentShaderID(L);const Xe=r.getRenderTarget(),$e=r.state.buffers.depth.getReversed(),lt=G.isInstancedMesh===!0,At=G.isBatchedMesh===!0,Gt=!!L.map,gt=!!L.matcap,xi=!!H,Ze=!!L.aoMap,Ui=!!L.lightMap,di=!!L.bumpMap,Ii=!!L.normalMap,Ti=!!L.displacementMap,ir=!!L.emissiveMap,Gi=!!L.metalnessMap,Qe=!!L.roughnessMap,Ce=L.anisotropy>0,yt=L.clearcoat>0,Ot=L.dispersion>0,Jt=L.iridescence>0,zt=L.sheen>0,_i=L.transmission>0,vt=Ce&&!!L.anisotropyMap,ye=yt&&!!L.clearcoatMap,ve=yt&&!!L.clearcoatNormalMap,Le=yt&&!!L.clearcoatRoughnessMap,Te=Jt&&!!L.iridescenceMap,ke=Jt&&!!L.iridescenceThicknessMap,Pe=zt&&!!L.sheenColorMap,F=zt&&!!L.sheenRoughnessMap,J=!!L.specularMap,ie=!!L.specularColorMap,Re=!!L.specularIntensityMap,ce=_i&&!!L.transmissionMap,Ue=_i&&!!L.thicknessMap,je=!!L.gradientMap,dt=!!L.alphaMap,It=L.alphaTest>0,bt=!!L.alphaHash,Ut=!!L.extensions;let pi=Vh;L.toneMapped&&(Xe===null||Xe.isXRRenderTarget===!0)&&(pi=r.toneMapping);const Er={shaderID:ne,shaderType:L.type,shaderName:L.name,vertexShader:fe,fragmentShader:de,defines:L.defines,customVertexShaderID:Ie,customFragmentShaderID:Ge,isRawShaderMaterial:L.isRawShaderMaterial===!0,glslVersion:L.glslVersion,precision:g,batching:At,batchingColor:At&&G._colorsTexture!==null,instancing:lt,instancingColor:lt&&G.instanceColor!==null,instancingMorph:lt&&G.morphTexture!==null,supportsVertexTextures:m,outputColorSpace:Xe===null?r.outputColorSpace:Xe.isXRRenderTarget===!0?Xe.texture.colorSpace:vm,alphaToCoverage:!!L.alphaToCoverage,map:Gt,matcap:gt,envMap:xi,envMapMode:xi&&H.mapping,envMapCubeUVHeight:V,aoMap:Ze,lightMap:Ui,bumpMap:di,normalMap:Ii,displacementMap:m&&Ti,emissiveMap:ir,normalMapObjectSpace:Ii&&L.normalMapType===qK,normalMapTangentSpace:Ii&&L.normalMapType===IP,metalnessMap:Gi,roughnessMap:Qe,anisotropy:Ce,anisotropyMap:vt,clearcoat:yt,clearcoatMap:ye,clearcoatNormalMap:ve,clearcoatRoughnessMap:Le,dispersion:Ot,iridescence:Jt,iridescenceMap:Te,iridescenceThicknessMap:ke,sheen:zt,sheenColorMap:Pe,sheenRoughnessMap:F,specularMap:J,specularColorMap:ie,specularIntensityMap:Re,transmission:_i,transmissionMap:ce,thicknessMap:Ue,gradientMap:je,opaque:L.transparent===!1&&L.blending===hm&&L.alphaToCoverage===!1,alphaMap:dt,alphaTest:It,alphaHash:bt,combine:L.combine,mapUv:Gt&&x(L.map.channel),aoMapUv:Ze&&x(L.aoMap.channel),lightMapUv:Ui&&x(L.lightMap.channel),bumpMapUv:di&&x(L.bumpMap.channel),normalMapUv:Ii&&x(L.normalMap.channel),displacementMapUv:Ti&&x(L.displacementMap.channel),emissiveMapUv:ir&&x(L.emissiveMap.channel),metalnessMapUv:Gi&&x(L.metalnessMap.channel),roughnessMapUv:Qe&&x(L.roughnessMap.channel),anisotropyMapUv:vt&&x(L.anisotropyMap.channel),clearcoatMapUv:ye&&x(L.clearcoatMap.channel),clearcoatNormalMapUv:ve&&x(L.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Le&&x(L.clearcoatRoughnessMap.channel),iridescenceMapUv:Te&&x(L.iridescenceMap.channel),iridescenceThicknessMapUv:ke&&x(L.iridescenceThicknessMap.channel),sheenColorMapUv:Pe&&x(L.sheenColorMap.channel),sheenRoughnessMapUv:F&&x(L.sheenRoughnessMap.channel),specularMapUv:J&&x(L.specularMap.channel),specularColorMapUv:ie&&x(L.specularColorMap.channel),specularIntensityMapUv:Re&&x(L.specularIntensityMap.channel),transmissionMapUv:ce&&x(L.transmissionMap.channel),thicknessMapUv:Ue&&x(L.thicknessMap.channel),alphaMapUv:dt&&x(L.alphaMap.channel),vertexTangents:!!$.attributes.tangent&&(Ii||Ce),vertexColors:L.vertexColors,vertexAlphas:L.vertexColors===!0&&!!$.attributes.color&&$.attributes.color.itemSize===4,pointsUvs:G.isPoints===!0&&!!$.attributes.uv&&(Gt||dt),fog:!!z,useFog:L.fog===!0,fogExp2:!!z&&z.isFogExp2,flatShading:L.flatShading===!0,sizeAttenuation:L.sizeAttenuation===!0,logarithmicDepthBuffer:f,reverseDepthBuffer:$e,skinning:G.isSkinnedMesh===!0,morphTargets:$.morphAttributes.position!==void 0,morphNormals:$.morphAttributes.normal!==void 0,morphColors:$.morphAttributes.color!==void 0,morphTargetsCount:ae,morphTextureStride:xe,numDirLights:O.directional.length,numPointLights:O.point.length,numSpotLights:O.spot.length,numSpotLightMaps:O.spotLightMap.length,numRectAreaLights:O.rectArea.length,numHemiLights:O.hemi.length,numDirLightShadows:O.directionalShadowMap.length,numPointLightShadows:O.pointShadowMap.length,numSpotLightShadows:O.spotShadowMap.length,numSpotLightShadowsWithMaps:O.numSpotLightShadowsWithMaps,numLightProbes:O.numLightProbes,numClippingPlanes:l.numPlanes,numClipIntersection:l.numIntersection,dithering:L.dithering,shadowMapEnabled:r.shadowMap.enabled&&U.length>0,shadowMapType:r.shadowMap.type,toneMapping:pi,decodeVideoTexture:Gt&&L.map.isVideoTexture===!0&&zn.getTransfer(L.map.colorSpace)===cs,decodeVideoTextureEmissive:ir&&L.emissiveMap.isVideoTexture===!0&&zn.getTransfer(L.emissiveMap.colorSpace)===cs,premultipliedAlpha:L.premultipliedAlpha,doubleSided:L.side===xu,flipSided:L.side===vo,useDepthPacking:L.depthPacking>=0,depthPacking:L.depthPacking||0,index0AttributeName:L.index0AttributeName,extensionClipCullDistance:Ut&&L.extensions.clipCullDistance===!0&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Ut&&L.extensions.multiDraw===!0||At)&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:L.customProgramCacheKey()};return Er.vertexUv1s=h.has(1),Er.vertexUv2s=h.has(2),Er.vertexUv3s=h.has(3),h.clear(),Er}function _(L){const O=[];if(L.shaderID?O.push(L.shaderID):(O.push(L.customVertexShaderID),O.push(L.customFragmentShaderID)),L.defines!==void 0)for(const U in L.defines)O.push(U),O.push(L.defines[U]);return L.isRawShaderMaterial===!1&&(T(O,L),w(O,L),O.push(r.outputColorSpace)),O.push(L.customProgramCacheKey),O.join()}function T(L,O){L.push(O.precision),L.push(O.outputColorSpace),L.push(O.envMapMode),L.push(O.envMapCubeUVHeight),L.push(O.mapUv),L.push(O.alphaMapUv),L.push(O.lightMapUv),L.push(O.aoMapUv),L.push(O.bumpMapUv),L.push(O.normalMapUv),L.push(O.displacementMapUv),L.push(O.emissiveMapUv),L.push(O.metalnessMapUv),L.push(O.roughnessMapUv),L.push(O.anisotropyMapUv),L.push(O.clearcoatMapUv),L.push(O.clearcoatNormalMapUv),L.push(O.clearcoatRoughnessMapUv),L.push(O.iridescenceMapUv),L.push(O.iridescenceThicknessMapUv),L.push(O.sheenColorMapUv),L.push(O.sheenRoughnessMapUv),L.push(O.specularMapUv),L.push(O.specularColorMapUv),L.push(O.specularIntensityMapUv),L.push(O.transmissionMapUv),L.push(O.thicknessMapUv),L.push(O.combine),L.push(O.fogExp2),L.push(O.sizeAttenuation),L.push(O.morphTargetsCount),L.push(O.morphAttributeCount),L.push(O.numDirLights),L.push(O.numPointLights),L.push(O.numSpotLights),L.push(O.numSpotLightMaps),L.push(O.numHemiLights),L.push(O.numRectAreaLights),L.push(O.numDirLightShadows),L.push(O.numPointLightShadows),L.push(O.numSpotLightShadows),L.push(O.numSpotLightShadowsWithMaps),L.push(O.numLightProbes),L.push(O.shadowMapType),L.push(O.toneMapping),L.push(O.numClippingPlanes),L.push(O.numClipIntersection),L.push(O.depthPacking)}function w(L,O){u.disableAll(),O.supportsVertexTextures&&u.enable(0),O.instancing&&u.enable(1),O.instancingColor&&u.enable(2),O.instancingMorph&&u.enable(3),O.matcap&&u.enable(4),O.envMap&&u.enable(5),O.normalMapObjectSpace&&u.enable(6),O.normalMapTangentSpace&&u.enable(7),O.clearcoat&&u.enable(8),O.iridescence&&u.enable(9),O.alphaTest&&u.enable(10),O.vertexColors&&u.enable(11),O.vertexAlphas&&u.enable(12),O.vertexUv1s&&u.enable(13),O.vertexUv2s&&u.enable(14),O.vertexUv3s&&u.enable(15),O.vertexTangents&&u.enable(16),O.anisotropy&&u.enable(17),O.alphaHash&&u.enable(18),O.batching&&u.enable(19),O.dispersion&&u.enable(20),O.batchingColor&&u.enable(21),L.push(u.mask),u.disableAll(),O.fog&&u.enable(0),O.useFog&&u.enable(1),O.flatShading&&u.enable(2),O.logarithmicDepthBuffer&&u.enable(3),O.reverseDepthBuffer&&u.enable(4),O.skinning&&u.enable(5),O.morphTargets&&u.enable(6),O.morphNormals&&u.enable(7),O.morphColors&&u.enable(8),O.premultipliedAlpha&&u.enable(9),O.shadowMapEnabled&&u.enable(10),O.doubleSided&&u.enable(11),O.flipSided&&u.enable(12),O.useDepthPacking&&u.enable(13),O.dithering&&u.enable(14),O.transmission&&u.enable(15),O.sheen&&u.enable(16),O.opaque&&u.enable(17),O.pointsUvs&&u.enable(18),O.decodeVideoTexture&&u.enable(19),O.decodeVideoTextureEmissive&&u.enable(20),O.alphaToCoverage&&u.enable(21),L.push(u.mask)}function S(L){const O=y[L.type];let U;if(O){const Z=jc[O];U=ak.clone(Z.uniforms)}else U=L.uniforms;return U}function R(L,O){let U;for(let Z=0,G=p.length;Z<G;Z++){const z=p[Z];if(z.cacheKey===O){U=z,++U.usedTimes;break}}return U===void 0&&(U=new Yte(r,O,L,o),p.push(U)),U}function B(L){if(--L.usedTimes===0){const O=p.indexOf(L);p[O]=p[p.length-1],p.pop(),L.destroy()}}function I(L){c.remove(L)}function D(){c.dispose()}return{getParameters:v,getProgramCacheKey:_,getUniforms:S,acquireProgram:R,releaseProgram:B,releaseShaderCache:I,programs:p,dispose:D}}function eie(){let r=new WeakMap;function e(l){return r.has(l)}function i(l){let u=r.get(l);return u===void 0&&(u={},r.set(l,u)),u}function n(l){r.delete(l)}function s(l,u,c){r.get(l)[u]=c}function o(){r=new WeakMap}return{has:e,get:i,remove:n,update:s,dispose:o}}function tie(r,e){return r.groupOrder!==e.groupOrder?r.groupOrder-e.groupOrder:r.renderOrder!==e.renderOrder?r.renderOrder-e.renderOrder:r.material.id!==e.material.id?r.material.id-e.material.id:r.z!==e.z?r.z-e.z:r.id-e.id}function Fk(r,e){return r.groupOrder!==e.groupOrder?r.groupOrder-e.groupOrder:r.renderOrder!==e.renderOrder?r.renderOrder-e.renderOrder:r.z!==e.z?e.z-r.z:r.id-e.id}function Uk(){const r=[];let e=0;const i=[],n=[],s=[];function o(){e=0,i.length=0,n.length=0,s.length=0}function l(f,m,g,y,x,v){let _=r[e];return _===void 0?(_={id:f.id,object:f,geometry:m,material:g,groupOrder:y,renderOrder:f.renderOrder,z:x,group:v},r[e]=_):(_.id=f.id,_.object=f,_.geometry=m,_.material=g,_.groupOrder=y,_.renderOrder=f.renderOrder,_.z=x,_.group=v),e++,_}function u(f,m,g,y,x,v){const _=l(f,m,g,y,x,v);g.transmission>0?n.push(_):g.transparent===!0?s.push(_):i.push(_)}function c(f,m,g,y,x,v){const _=l(f,m,g,y,x,v);g.transmission>0?n.unshift(_):g.transparent===!0?s.unshift(_):i.unshift(_)}function h(f,m){i.length>1&&i.sort(f||tie),n.length>1&&n.sort(m||Fk),s.length>1&&s.sort(m||Fk)}function p(){for(let f=e,m=r.length;f<m;f++){const g=r[f];if(g.id===null)break;g.id=null,g.object=null,g.geometry=null,g.material=null,g.group=null}}return{opaque:i,transmissive:n,transparent:s,init:o,push:u,unshift:c,finish:p,sort:h}}function iie(){let r=new WeakMap;function e(n,s){const o=r.get(n);let l;return o===void 0?(l=new Uk,r.set(n,[l])):s>=o.length?(l=new Uk,o.push(l)):l=o[s],l}function i(){r=new WeakMap}return{get:e,dispose:i}}function rie(){const r={};return{get:function(e){if(r[e.id]!==void 0)return r[e.id];let i;switch(e.type){case"DirectionalLight":i={direction:new at,color:new Tn};break;case"SpotLight":i={position:new at,direction:new at,color:new Tn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":i={position:new at,color:new Tn,distance:0,decay:0};break;case"HemisphereLight":i={direction:new at,skyColor:new Tn,groundColor:new Tn};break;case"RectAreaLight":i={color:new Tn,position:new at,halfWidth:new at,halfHeight:new at};break}return r[e.id]=i,i}}}function nie(){const r={};return{get:function(e){if(r[e.id]!==void 0)return r[e.id];let i;switch(e.type){case"DirectionalLight":i={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ji};break;case"SpotLight":i={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ji};break;case"PointLight":i={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ji,shadowCameraNear:1,shadowCameraFar:1e3};break}return r[e.id]=i,i}}}let sie=0;function aie(r,e){return(e.castShadow?2:0)-(r.castShadow?2:0)+(e.map?1:0)-(r.map?1:0)}function oie(r){const e=new rie,i=nie(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let h=0;h<9;h++)n.probe.push(new at);const s=new at,o=new As,l=new As;function u(h){let p=0,f=0,m=0;for(let L=0;L<9;L++)n.probe[L].set(0,0,0);let g=0,y=0,x=0,v=0,_=0,T=0,w=0,S=0,R=0,B=0,I=0;h.sort(aie);for(let L=0,O=h.length;L<O;L++){const U=h[L],Z=U.color,G=U.intensity,z=U.distance,$=U.shadow&&U.shadow.map?U.shadow.map.texture:null;if(U.isAmbientLight)p+=Z.r*G,f+=Z.g*G,m+=Z.b*G;else if(U.isLightProbe){for(let Q=0;Q<9;Q++)n.probe[Q].addScaledVector(U.sh.coefficients[Q],G);I++}else if(U.isDirectionalLight){const Q=e.get(U);if(Q.color.copy(U.color).multiplyScalar(U.intensity),U.castShadow){const H=U.shadow,V=i.get(U);V.shadowIntensity=H.intensity,V.shadowBias=H.bias,V.shadowNormalBias=H.normalBias,V.shadowRadius=H.radius,V.shadowMapSize=H.mapSize,n.directionalShadow[g]=V,n.directionalShadowMap[g]=$,n.directionalShadowMatrix[g]=U.shadow.matrix,T++}n.directional[g]=Q,g++}else if(U.isSpotLight){const Q=e.get(U);Q.position.setFromMatrixPosition(U.matrixWorld),Q.color.copy(Z).multiplyScalar(G),Q.distance=z,Q.coneCos=Math.cos(U.angle),Q.penumbraCos=Math.cos(U.angle*(1-U.penumbra)),Q.decay=U.decay,n.spot[x]=Q;const H=U.shadow;if(U.map&&(n.spotLightMap[R]=U.map,R++,H.updateMatrices(U),U.castShadow&&B++),n.spotLightMatrix[x]=H.matrix,U.castShadow){const V=i.get(U);V.shadowIntensity=H.intensity,V.shadowBias=H.bias,V.shadowNormalBias=H.normalBias,V.shadowRadius=H.radius,V.shadowMapSize=H.mapSize,n.spotShadow[x]=V,n.spotShadowMap[x]=$,S++}x++}else if(U.isRectAreaLight){const Q=e.get(U);Q.color.copy(Z).multiplyScalar(G),Q.halfWidth.set(U.width*.5,0,0),Q.halfHeight.set(0,U.height*.5,0),n.rectArea[v]=Q,v++}else if(U.isPointLight){const Q=e.get(U);if(Q.color.copy(U.color).multiplyScalar(U.intensity),Q.distance=U.distance,Q.decay=U.decay,U.castShadow){const H=U.shadow,V=i.get(U);V.shadowIntensity=H.intensity,V.shadowBias=H.bias,V.shadowNormalBias=H.normalBias,V.shadowRadius=H.radius,V.shadowMapSize=H.mapSize,V.shadowCameraNear=H.camera.near,V.shadowCameraFar=H.camera.far,n.pointShadow[y]=V,n.pointShadowMap[y]=$,n.pointShadowMatrix[y]=U.shadow.matrix,w++}n.point[y]=Q,y++}else if(U.isHemisphereLight){const Q=e.get(U);Q.skyColor.copy(U.color).multiplyScalar(G),Q.groundColor.copy(U.groundColor).multiplyScalar(G),n.hemi[_]=Q,_++}}v>0&&(r.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=Xi.LTC_FLOAT_1,n.rectAreaLTC2=Xi.LTC_FLOAT_2):(n.rectAreaLTC1=Xi.LTC_HALF_1,n.rectAreaLTC2=Xi.LTC_HALF_2)),n.ambient[0]=p,n.ambient[1]=f,n.ambient[2]=m;const D=n.hash;(D.directionalLength!==g||D.pointLength!==y||D.spotLength!==x||D.rectAreaLength!==v||D.hemiLength!==_||D.numDirectionalShadows!==T||D.numPointShadows!==w||D.numSpotShadows!==S||D.numSpotMaps!==R||D.numLightProbes!==I)&&(n.directional.length=g,n.spot.length=x,n.rectArea.length=v,n.point.length=y,n.hemi.length=_,n.directionalShadow.length=T,n.directionalShadowMap.length=T,n.pointShadow.length=w,n.pointShadowMap.length=w,n.spotShadow.length=S,n.spotShadowMap.length=S,n.directionalShadowMatrix.length=T,n.pointShadowMatrix.length=w,n.spotLightMatrix.length=S+R-B,n.spotLightMap.length=R,n.numSpotLightShadowsWithMaps=B,n.numLightProbes=I,D.directionalLength=g,D.pointLength=y,D.spotLength=x,D.rectAreaLength=v,D.hemiLength=_,D.numDirectionalShadows=T,D.numPointShadows=w,D.numSpotShadows=S,D.numSpotMaps=R,D.numLightProbes=I,n.version=sie++)}function c(h,p){let f=0,m=0,g=0,y=0,x=0;const v=p.matrixWorldInverse;for(let _=0,T=h.length;_<T;_++){const w=h[_];if(w.isDirectionalLight){const S=n.directional[f];S.direction.setFromMatrixPosition(w.matrixWorld),s.setFromMatrixPosition(w.target.matrixWorld),S.direction.sub(s),S.direction.transformDirection(v),f++}else if(w.isSpotLight){const S=n.spot[g];S.position.setFromMatrixPosition(w.matrixWorld),S.position.applyMatrix4(v),S.direction.setFromMatrixPosition(w.matrixWorld),s.setFromMatrixPosition(w.target.matrixWorld),S.direction.sub(s),S.direction.transformDirection(v),g++}else if(w.isRectAreaLight){const S=n.rectArea[y];S.position.setFromMatrixPosition(w.matrixWorld),S.position.applyMatrix4(v),l.identity(),o.copy(w.matrixWorld),o.premultiply(v),l.extractRotation(o),S.halfWidth.set(w.width*.5,0,0),S.halfHeight.set(0,w.height*.5,0),S.halfWidth.applyMatrix4(l),S.halfHeight.applyMatrix4(l),y++}else if(w.isPointLight){const S=n.point[m];S.position.setFromMatrixPosition(w.matrixWorld),S.position.applyMatrix4(v),m++}else if(w.isHemisphereLight){const S=n.hemi[x];S.direction.setFromMatrixPosition(w.matrixWorld),S.direction.transformDirection(v),x++}}}return{setup:u,setupView:c,state:n}}function zk(r){const e=new oie(r),i=[],n=[];function s(p){h.camera=p,i.length=0,n.length=0}function o(p){i.push(p)}function l(p){n.push(p)}function u(){e.setup(i)}function c(p){e.setupView(i,p)}const h={lightsArray:i,shadowsArray:n,camera:null,lights:e,transmissionRenderTarget:{}};return{init:s,state:h,setupLights:u,setupLightsView:c,pushLight:o,pushShadow:l}}function lie(r){let e=new WeakMap;function i(s,o=0){const l=e.get(s);let u;return l===void 0?(u=new zk(r),e.set(s,[u])):o>=l.length?(u=new zk(r),l.push(u)):u=l[o],u}function n(){e=new WeakMap}return{get:i,dispose:n}}class cie extends mp{static get type(){return"MeshDepthMaterial"}constructor(e){super(),this.isMeshDepthMaterial=!0,this.depthPacking=WK,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class uie extends mp{static get type(){return"MeshDistanceMaterial"}constructor(e){super(),this.isMeshDistanceMaterial=!0,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const hie=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,die=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function pie(r,e,i){let n=new GS;const s=new ji,o=new ji,l=new Js,u=new cie({depthPacking:QK}),c=new uie,h={},p=i.maxTextureSize,f={[jh]:vo,[vo]:jh,[xu]:xu},m=new zc({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new ji},radius:{value:4}},vertexShader:hie,fragmentShader:die}),g=m.clone();g.defines.HORIZONTAL_PASS=1;const y=new Vo;y.setAttribute("position",new jo(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const x=new za(y,m),v=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=mP;let _=this.type;this.render=function(B,I,D){if(v.enabled===!1||v.autoUpdate===!1&&v.needsUpdate===!1||B.length===0)return;const L=r.getRenderTarget(),O=r.getActiveCubeFace(),U=r.getActiveMipmapLevel(),Z=r.state;Z.setBlending(bu),Z.buffers.color.setClear(1,1,1,1),Z.buffers.depth.setTest(!0),Z.setScissorTest(!1);const G=_!==vu&&this.type===vu,z=_===vu&&this.type!==vu;for(let $=0,Q=B.length;$<Q;$++){const H=B[$],V=H.shadow;if(V===void 0){console.warn("THREE.WebGLShadowMap:",H,"has no shadow.");continue}if(V.autoUpdate===!1&&V.needsUpdate===!1)continue;s.copy(V.mapSize);const ne=V.getFrameExtents();if(s.multiply(ne),o.copy(V.mapSize),(s.x>p||s.y>p)&&(s.x>p&&(o.x=Math.floor(p/ne.x),s.x=o.x*ne.x,V.mapSize.x=o.x),s.y>p&&(o.y=Math.floor(p/ne.y),s.y=o.y*ne.y,V.mapSize.y=o.y)),V.map===null||G===!0||z===!0){const ae=this.type!==vu?{minFilter:tc,magFilter:tc}:{};V.map!==null&&V.map.dispose(),V.map=new Hh(s.x,s.y,ae),V.map.texture.name=H.name+".shadowMap",V.camera.updateProjectionMatrix()}r.setRenderTarget(V.map),r.clear();const Y=V.getViewportCount();for(let ae=0;ae<Y;ae++){const xe=V.getViewport(ae);l.set(o.x*xe.x,o.y*xe.y,o.x*xe.z,o.y*xe.w),Z.viewport(l),V.updateMatrices(H,ae),n=V.getFrustum(),S(I,D,V.camera,H,this.type)}V.isPointLightShadow!==!0&&this.type===vu&&T(V,D),V.needsUpdate=!1}_=this.type,v.needsUpdate=!1,r.setRenderTarget(L,O,U)};function T(B,I){const D=e.update(x);m.defines.VSM_SAMPLES!==B.blurSamples&&(m.defines.VSM_SAMPLES=B.blurSamples,g.defines.VSM_SAMPLES=B.blurSamples,m.needsUpdate=!0,g.needsUpdate=!0),B.mapPass===null&&(B.mapPass=new Hh(s.x,s.y)),m.uniforms.shadow_pass.value=B.map.texture,m.uniforms.resolution.value=B.mapSize,m.uniforms.radius.value=B.radius,r.setRenderTarget(B.mapPass),r.clear(),r.renderBufferDirect(I,null,D,m,x,null),g.uniforms.shadow_pass.value=B.mapPass.texture,g.uniforms.resolution.value=B.mapSize,g.uniforms.radius.value=B.radius,r.setRenderTarget(B.map),r.clear(),r.renderBufferDirect(I,null,D,g,x,null)}function w(B,I,D,L){let O=null;const U=D.isPointLight===!0?B.customDistanceMaterial:B.customDepthMaterial;if(U!==void 0)O=U;else if(O=D.isPointLight===!0?c:u,r.localClippingEnabled&&I.clipShadows===!0&&Array.isArray(I.clippingPlanes)&&I.clippingPlanes.length!==0||I.displacementMap&&I.displacementScale!==0||I.alphaMap&&I.alphaTest>0||I.map&&I.alphaTest>0){const Z=O.uuid,G=I.uuid;let z=h[Z];z===void 0&&(z={},h[Z]=z);let $=z[G];$===void 0&&($=O.clone(),z[G]=$,I.addEventListener("dispose",R)),O=$}if(O.visible=I.visible,O.wireframe=I.wireframe,L===vu?O.side=I.shadowSide!==null?I.shadowSide:I.side:O.side=I.shadowSide!==null?I.shadowSide:f[I.side],O.alphaMap=I.alphaMap,O.alphaTest=I.alphaTest,O.map=I.map,O.clipShadows=I.clipShadows,O.clippingPlanes=I.clippingPlanes,O.clipIntersection=I.clipIntersection,O.displacementMap=I.displacementMap,O.displacementScale=I.displacementScale,O.displacementBias=I.displacementBias,O.wireframeLinewidth=I.wireframeLinewidth,O.linewidth=I.linewidth,D.isPointLight===!0&&O.isMeshDistanceMaterial===!0){const Z=r.properties.get(O);Z.light=D}return O}function S(B,I,D,L,O){if(B.visible===!1)return;if(B.layers.test(I.layers)&&(B.isMesh||B.isLine||B.isPoints)&&(B.castShadow||B.receiveShadow&&O===vu)&&(!B.frustumCulled||n.intersectsObject(B))){B.modelViewMatrix.multiplyMatrices(D.matrixWorldInverse,B.matrixWorld);const Z=e.update(B),G=B.material;if(Array.isArray(G)){const z=Z.groups;for(let $=0,Q=z.length;$<Q;$++){const H=z[$],V=G[H.materialIndex];if(V&&V.visible){const ne=w(B,V,L,O);B.onBeforeShadow(r,B,I,D,Z,ne,H),r.renderBufferDirect(D,null,Z,ne,B,H),B.onAfterShadow(r,B,I,D,Z,ne,H)}}}else if(G.visible){const z=w(B,G,L,O);B.onBeforeShadow(r,B,I,D,Z,z,null),r.renderBufferDirect(D,null,Z,z,B,null),B.onAfterShadow(r,B,I,D,Z,z,null)}}const U=B.children;for(let Z=0,G=U.length;Z<G;Z++)S(U[Z],I,D,L,O)}function R(B){B.target.removeEventListener("dispose",R);for(const I in h){const D=h[I],L=B.target.uuid;L in D&&(D[L].dispose(),delete D[L])}}}const fie={[MC]:RC,[IC]:LC,[BC]:DC,[dm]:NC,[RC]:MC,[LC]:IC,[DC]:BC,[NC]:dm};function mie(r,e){function i(){let ce=!1;const Ue=new Js;let je=null;const dt=new Js(0,0,0,0);return{setMask:function(It){je!==It&&!ce&&(r.colorMask(It,It,It,It),je=It)},setLocked:function(It){ce=It},setClear:function(It,bt,Ut,pi,Er){Er===!0&&(It*=pi,bt*=pi,Ut*=pi),Ue.set(It,bt,Ut,pi),dt.equals(Ue)===!1&&(r.clearColor(It,bt,Ut,pi),dt.copy(Ue))},reset:function(){ce=!1,je=null,dt.set(-1,0,0,0)}}}function n(){let ce=!1,Ue=!1,je=null,dt=null,It=null;return{setReversed:function(bt){if(Ue!==bt){const Ut=e.get("EXT_clip_control");Ue?Ut.clipControlEXT(Ut.LOWER_LEFT_EXT,Ut.ZERO_TO_ONE_EXT):Ut.clipControlEXT(Ut.LOWER_LEFT_EXT,Ut.NEGATIVE_ONE_TO_ONE_EXT);const pi=It;It=null,this.setClear(pi)}Ue=bt},getReversed:function(){return Ue},setTest:function(bt){bt?Xe(r.DEPTH_TEST):$e(r.DEPTH_TEST)},setMask:function(bt){je!==bt&&!ce&&(r.depthMask(bt),je=bt)},setFunc:function(bt){if(Ue&&(bt=fie[bt]),dt!==bt){switch(bt){case MC:r.depthFunc(r.NEVER);break;case RC:r.depthFunc(r.ALWAYS);break;case IC:r.depthFunc(r.LESS);break;case dm:r.depthFunc(r.LEQUAL);break;case BC:r.depthFunc(r.EQUAL);break;case NC:r.depthFunc(r.GEQUAL);break;case LC:r.depthFunc(r.GREATER);break;case DC:r.depthFunc(r.NOTEQUAL);break;default:r.depthFunc(r.LEQUAL)}dt=bt}},setLocked:function(bt){ce=bt},setClear:function(bt){It!==bt&&(Ue&&(bt=1-bt),r.clearDepth(bt),It=bt)},reset:function(){ce=!1,je=null,dt=null,It=null,Ue=!1}}}function s(){let ce=!1,Ue=null,je=null,dt=null,It=null,bt=null,Ut=null,pi=null,Er=null;return{setTest:function(ki){ce||(ki?Xe(r.STENCIL_TEST):$e(r.STENCIL_TEST))},setMask:function(ki){Ue!==ki&&!ce&&(r.stencilMask(ki),Ue=ki)},setFunc:function(ki,An,Ur){(je!==ki||dt!==An||It!==Ur)&&(r.stencilFunc(ki,An,Ur),je=ki,dt=An,It=Ur)},setOp:function(ki,An,Ur){(bt!==ki||Ut!==An||pi!==Ur)&&(r.stencilOp(ki,An,Ur),bt=ki,Ut=An,pi=Ur)},setLocked:function(ki){ce=ki},setClear:function(ki){Er!==ki&&(r.clearStencil(ki),Er=ki)},reset:function(){ce=!1,Ue=null,je=null,dt=null,It=null,bt=null,Ut=null,pi=null,Er=null}}}const o=new i,l=new n,u=new s,c=new WeakMap,h=new WeakMap;let p={},f={},m=new WeakMap,g=[],y=null,x=!1,v=null,_=null,T=null,w=null,S=null,R=null,B=null,I=new Tn(0,0,0),D=0,L=!1,O=null,U=null,Z=null,G=null,z=null;const $=r.getParameter(r.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Q=!1,H=0;const V=r.getParameter(r.VERSION);V.indexOf("WebGL")!==-1?(H=parseFloat(/^WebGL (\d)/.exec(V)[1]),Q=H>=1):V.indexOf("OpenGL ES")!==-1&&(H=parseFloat(/^OpenGL ES (\d)/.exec(V)[1]),Q=H>=2);let ne=null,Y={};const ae=r.getParameter(r.SCISSOR_BOX),xe=r.getParameter(r.VIEWPORT),fe=new Js().fromArray(ae),de=new Js().fromArray(xe);function Ie(ce,Ue,je,dt){const It=new Uint8Array(4),bt=r.createTexture();r.bindTexture(ce,bt),r.texParameteri(ce,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(ce,r.TEXTURE_MAG_FILTER,r.NEAREST);for(let Ut=0;Ut<je;Ut++)ce===r.TEXTURE_3D||ce===r.TEXTURE_2D_ARRAY?r.texImage3D(Ue,0,r.RGBA,1,1,dt,0,r.RGBA,r.UNSIGNED_BYTE,It):r.texImage2D(Ue+Ut,0,r.RGBA,1,1,0,r.RGBA,r.UNSIGNED_BYTE,It);return bt}const Ge={};Ge[r.TEXTURE_2D]=Ie(r.TEXTURE_2D,r.TEXTURE_2D,1),Ge[r.TEXTURE_CUBE_MAP]=Ie(r.TEXTURE_CUBE_MAP,r.TEXTURE_CUBE_MAP_POSITIVE_X,6),Ge[r.TEXTURE_2D_ARRAY]=Ie(r.TEXTURE_2D_ARRAY,r.TEXTURE_2D_ARRAY,1,1),Ge[r.TEXTURE_3D]=Ie(r.TEXTURE_3D,r.TEXTURE_3D,1,1),o.setClear(0,0,0,1),l.setClear(1),u.setClear(0),Xe(r.DEPTH_TEST),l.setFunc(dm),di(!1),Ii(fP),Xe(r.CULL_FACE),Ze(bu);function Xe(ce){p[ce]!==!0&&(r.enable(ce),p[ce]=!0)}function $e(ce){p[ce]!==!1&&(r.disable(ce),p[ce]=!1)}function lt(ce,Ue){return f[ce]!==Ue?(r.bindFramebuffer(ce,Ue),f[ce]=Ue,ce===r.DRAW_FRAMEBUFFER&&(f[r.FRAMEBUFFER]=Ue),ce===r.FRAMEBUFFER&&(f[r.DRAW_FRAMEBUFFER]=Ue),!0):!1}function At(ce,Ue){let je=g,dt=!1;if(ce){je=m.get(Ue),je===void 0&&(je=[],m.set(Ue,je));const It=ce.textures;if(je.length!==It.length||je[0]!==r.COLOR_ATTACHMENT0){for(let bt=0,Ut=It.length;bt<Ut;bt++)je[bt]=r.COLOR_ATTACHMENT0+bt;je.length=It.length,dt=!0}}else je[0]!==r.BACK&&(je[0]=r.BACK,dt=!0);dt&&r.drawBuffers(je)}function Gt(ce){return y!==ce?(r.useProgram(ce),y=ce,!0):!1}const gt={[ap]:r.FUNC_ADD,[yK]:r.FUNC_SUBTRACT,[vK]:r.FUNC_REVERSE_SUBTRACT};gt[xK]=r.MIN,gt[bK]=r.MAX;const xi={[_K]:r.ZERO,[EK]:r.ONE,[wK]:r.SRC_COLOR,[SC]:r.SRC_ALPHA,[IK]:r.SRC_ALPHA_SATURATE,[MK]:r.DST_COLOR,[SK]:r.DST_ALPHA,[CK]:r.ONE_MINUS_SRC_COLOR,[TC]:r.ONE_MINUS_SRC_ALPHA,[RK]:r.ONE_MINUS_DST_COLOR,[TK]:r.ONE_MINUS_DST_ALPHA,[BK]:r.CONSTANT_COLOR,[NK]:r.ONE_MINUS_CONSTANT_COLOR,[LK]:r.CONSTANT_ALPHA,[DK]:r.ONE_MINUS_CONSTANT_ALPHA};function Ze(ce,Ue,je,dt,It,bt,Ut,pi,Er,ki){if(ce===bu){x===!0&&($e(r.BLEND),x=!1);return}if(x===!1&&(Xe(r.BLEND),x=!0),ce!==AK){if(ce!==v||ki!==L){if((_!==ap||S!==ap)&&(r.blendEquation(r.FUNC_ADD),_=ap,S=ap),ki)switch(ce){case hm:r.blendFuncSeparate(r.ONE,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA);break;case gP:r.blendFunc(r.ONE,r.ONE);break;case AP:r.blendFuncSeparate(r.ZERO,r.ONE_MINUS_SRC_COLOR,r.ZERO,r.ONE);break;case yP:r.blendFuncSeparate(r.ZERO,r.SRC_COLOR,r.ZERO,r.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",ce);break}else switch(ce){case hm:r.blendFuncSeparate(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA);break;case gP:r.blendFunc(r.SRC_ALPHA,r.ONE);break;case AP:r.blendFuncSeparate(r.ZERO,r.ONE_MINUS_SRC_COLOR,r.ZERO,r.ONE);break;case yP:r.blendFunc(r.ZERO,r.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",ce);break}T=null,w=null,R=null,B=null,I.set(0,0,0),D=0,v=ce,L=ki}return}It=It||Ue,bt=bt||je,Ut=Ut||dt,(Ue!==_||It!==S)&&(r.blendEquationSeparate(gt[Ue],gt[It]),_=Ue,S=It),(je!==T||dt!==w||bt!==R||Ut!==B)&&(r.blendFuncSeparate(xi[je],xi[dt],xi[bt],xi[Ut]),T=je,w=dt,R=bt,B=Ut),(pi.equals(I)===!1||Er!==D)&&(r.blendColor(pi.r,pi.g,pi.b,Er),I.copy(pi),D=Er),v=ce,L=!1}function Ui(ce,Ue){ce.side===xu?$e(r.CULL_FACE):Xe(r.CULL_FACE);let je=ce.side===vo;Ue&&(je=!je),di(je),ce.blending===hm&&ce.transparent===!1?Ze(bu):Ze(ce.blending,ce.blendEquation,ce.blendSrc,ce.blendDst,ce.blendEquationAlpha,ce.blendSrcAlpha,ce.blendDstAlpha,ce.blendColor,ce.blendAlpha,ce.premultipliedAlpha),l.setFunc(ce.depthFunc),l.setTest(ce.depthTest),l.setMask(ce.depthWrite),o.setMask(ce.colorWrite);const dt=ce.stencilWrite;u.setTest(dt),dt&&(u.setMask(ce.stencilWriteMask),u.setFunc(ce.stencilFunc,ce.stencilRef,ce.stencilFuncMask),u.setOp(ce.stencilFail,ce.stencilZFail,ce.stencilZPass)),ir(ce.polygonOffset,ce.polygonOffsetFactor,ce.polygonOffsetUnits),ce.alphaToCoverage===!0?Xe(r.SAMPLE_ALPHA_TO_COVERAGE):$e(r.SAMPLE_ALPHA_TO_COVERAGE)}function di(ce){O!==ce&&(ce?r.frontFace(r.CW):r.frontFace(r.CCW),O=ce)}function Ii(ce){ce!==fK?(Xe(r.CULL_FACE),ce!==U&&(ce===fP?r.cullFace(r.BACK):ce===mK?r.cullFace(r.FRONT):r.cullFace(r.FRONT_AND_BACK))):$e(r.CULL_FACE),U=ce}function Ti(ce){ce!==Z&&(Q&&r.lineWidth(ce),Z=ce)}function ir(ce,Ue,je){ce?(Xe(r.POLYGON_OFFSET_FILL),(G!==Ue||z!==je)&&(r.polygonOffset(Ue,je),G=Ue,z=je)):$e(r.POLYGON_OFFSET_FILL)}function Gi(ce){ce?Xe(r.SCISSOR_TEST):$e(r.SCISSOR_TEST)}function Qe(ce){ce===void 0&&(ce=r.TEXTURE0+$-1),ne!==ce&&(r.activeTexture(ce),ne=ce)}function Ce(ce,Ue,je){je===void 0&&(ne===null?je=r.TEXTURE0+$-1:je=ne);let dt=Y[je];dt===void 0&&(dt={type:void 0,texture:void 0},Y[je]=dt),(dt.type!==ce||dt.texture!==Ue)&&(ne!==je&&(r.activeTexture(je),ne=je),r.bindTexture(ce,Ue||Ge[ce]),dt.type=ce,dt.texture=Ue)}function yt(){const ce=Y[ne];ce!==void 0&&ce.type!==void 0&&(r.bindTexture(ce.type,null),ce.type=void 0,ce.texture=void 0)}function Ot(){try{r.compressedTexImage2D.apply(r,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}function Jt(){try{r.compressedTexImage3D.apply(r,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}function zt(){try{r.texSubImage2D.apply(r,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}function _i(){try{r.texSubImage3D.apply(r,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}function vt(){try{r.compressedTexSubImage2D.apply(r,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}function ye(){try{r.compressedTexSubImage3D.apply(r,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}function ve(){try{r.texStorage2D.apply(r,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}function Le(){try{r.texStorage3D.apply(r,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}function Te(){try{r.texImage2D.apply(r,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}function ke(){try{r.texImage3D.apply(r,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}function Pe(ce){fe.equals(ce)===!1&&(r.scissor(ce.x,ce.y,ce.z,ce.w),fe.copy(ce))}function F(ce){de.equals(ce)===!1&&(r.viewport(ce.x,ce.y,ce.z,ce.w),de.copy(ce))}function J(ce,Ue){let je=h.get(Ue);je===void 0&&(je=new WeakMap,h.set(Ue,je));let dt=je.get(ce);dt===void 0&&(dt=r.getUniformBlockIndex(Ue,ce.name),je.set(ce,dt))}function ie(ce,Ue){const je=h.get(Ue).get(ce);c.get(Ue)!==je&&(r.uniformBlockBinding(Ue,je,ce.__bindingPointIndex),c.set(Ue,je))}function Re(){r.disable(r.BLEND),r.disable(r.CULL_FACE),r.disable(r.DEPTH_TEST),r.disable(r.POLYGON_OFFSET_FILL),r.disable(r.SCISSOR_TEST),r.disable(r.STENCIL_TEST),r.disable(r.SAMPLE_ALPHA_TO_COVERAGE),r.blendEquation(r.FUNC_ADD),r.blendFunc(r.ONE,r.ZERO),r.blendFuncSeparate(r.ONE,r.ZERO,r.ONE,r.ZERO),r.blendColor(0,0,0,0),r.colorMask(!0,!0,!0,!0),r.clearColor(0,0,0,0),r.depthMask(!0),r.depthFunc(r.LESS),l.setReversed(!1),r.clearDepth(1),r.stencilMask(4294967295),r.stencilFunc(r.ALWAYS,0,4294967295),r.stencilOp(r.KEEP,r.KEEP,r.KEEP),r.clearStencil(0),r.cullFace(r.BACK),r.frontFace(r.CCW),r.polygonOffset(0,0),r.activeTexture(r.TEXTURE0),r.bindFramebuffer(r.FRAMEBUFFER,null),r.bindFramebuffer(r.DRAW_FRAMEBUFFER,null),r.bindFramebuffer(r.READ_FRAMEBUFFER,null),r.useProgram(null),r.lineWidth(1),r.scissor(0,0,r.canvas.width,r.canvas.height),r.viewport(0,0,r.canvas.width,r.canvas.height),p={},ne=null,Y={},f={},m=new WeakMap,g=[],y=null,x=!1,v=null,_=null,T=null,w=null,S=null,R=null,B=null,I=new Tn(0,0,0),D=0,L=!1,O=null,U=null,Z=null,G=null,z=null,fe.set(0,0,r.canvas.width,r.canvas.height),de.set(0,0,r.canvas.width,r.canvas.height),o.reset(),l.reset(),u.reset()}return{buffers:{color:o,depth:l,stencil:u},enable:Xe,disable:$e,bindFramebuffer:lt,drawBuffers:At,useProgram:Gt,setBlending:Ze,setMaterial:Ui,setFlipSided:di,setCullFace:Ii,setLineWidth:Ti,setPolygonOffset:ir,setScissorTest:Gi,activeTexture:Qe,bindTexture:Ce,unbindTexture:yt,compressedTexImage2D:Ot,compressedTexImage3D:Jt,texImage2D:Te,texImage3D:ke,updateUBOMapping:J,uniformBlockBinding:ie,texStorage2D:ve,texStorage3D:Le,texSubImage2D:zt,texSubImage3D:_i,compressedTexSubImage2D:vt,compressedTexSubImage3D:ye,scissor:Pe,viewport:F,reset:Re}}function jk(r,e,i,n){const s=gie(n);switch(i){case EP:return r*e;case CP:return r*e;case SP:return r*e*2;case TP:return r*e/s.components*s.byteLength;case HC:return r*e/s.components*s.byteLength;case MP:return r*e*2/s.components*s.byteLength;case WC:return r*e*2/s.components*s.byteLength;case wP:return r*e*3/s.components*s.byteLength;case ic:return r*e*4/s.components*s.byteLength;case QC:return r*e*4/s.components*s.byteLength;case tb:case ib:return Math.floor((r+3)/4)*Math.floor((e+3)/4)*8;case rb:case nb:return Math.floor((r+3)/4)*Math.floor((e+3)/4)*16;case XC:case KC:return Math.max(r,16)*Math.max(e,8)/4;case qC:case YC:return Math.max(r,8)*Math.max(e,8)/2;case JC:case ZC:return Math.floor((r+3)/4)*Math.floor((e+3)/4)*8;case $C:return Math.floor((r+3)/4)*Math.floor((e+3)/4)*16;case eS:return Math.floor((r+3)/4)*Math.floor((e+3)/4)*16;case tS:return Math.floor((r+4)/5)*Math.floor((e+3)/4)*16;case iS:return Math.floor((r+4)/5)*Math.floor((e+4)/5)*16;case rS:return Math.floor((r+5)/6)*Math.floor((e+4)/5)*16;case nS:return Math.floor((r+5)/6)*Math.floor((e+5)/6)*16;case sS:return Math.floor((r+7)/8)*Math.floor((e+4)/5)*16;case aS:return Math.floor((r+7)/8)*Math.floor((e+5)/6)*16;case oS:return Math.floor((r+7)/8)*Math.floor((e+7)/8)*16;case lS:return Math.floor((r+9)/10)*Math.floor((e+4)/5)*16;case cS:return Math.floor((r+9)/10)*Math.floor((e+5)/6)*16;case uS:return Math.floor((r+9)/10)*Math.floor((e+7)/8)*16;case hS:return Math.floor((r+9)/10)*Math.floor((e+9)/10)*16;case dS:return Math.floor((r+11)/12)*Math.floor((e+9)/10)*16;case pS:return Math.floor((r+11)/12)*Math.floor((e+11)/12)*16;case sb:case fS:case mS:return Math.ceil(r/4)*Math.ceil(e/4)*16;case RP:case gS:return Math.ceil(r/4)*Math.ceil(e/4)*8;case AS:case yS:return Math.ceil(r/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${i} format.`)}function gie(r){switch(r){case _u:case xP:return{byteLength:1,components:1};case pA:case bP:case mm:return{byteLength:2,components:1};case VC:case GC:return{byteLength:2,components:4};case cp:case jC:case Eu:return{byteLength:4,components:1};case _P:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${r}.`)}function Aie(r,e,i,n,s,o,l){const u=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,c=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),h=new ji,p=new WeakMap;let f;const m=new WeakMap;let g=!1;try{g=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function y(Qe,Ce){return g?new OffscreenCanvas(Qe,Ce):AA("canvas")}function x(Qe,Ce,yt){let Ot=1;const Jt=Gi(Qe);if((Jt.width>yt||Jt.height>yt)&&(Ot=yt/Math.max(Jt.width,Jt.height)),Ot<1)if(typeof HTMLImageElement<"u"&&Qe instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Qe instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Qe instanceof ImageBitmap||typeof VideoFrame<"u"&&Qe instanceof VideoFrame){const zt=Math.floor(Ot*Jt.width),_i=Math.floor(Ot*Jt.height);f===void 0&&(f=y(zt,_i));const vt=Ce?y(zt,_i):f;return vt.width=zt,vt.height=_i,vt.getContext("2d").drawImage(Qe,0,0,zt,_i),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Jt.width+"x"+Jt.height+") to ("+zt+"x"+_i+")."),vt}else return"data"in Qe&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Jt.width+"x"+Jt.height+")."),Qe;return Qe}function v(Qe){return Qe.generateMipmaps}function _(Qe){r.generateMipmap(Qe)}function T(Qe){return Qe.isWebGLCubeRenderTarget?r.TEXTURE_CUBE_MAP:Qe.isWebGL3DRenderTarget?r.TEXTURE_3D:Qe.isWebGLArrayRenderTarget||Qe.isCompressedArrayTexture?r.TEXTURE_2D_ARRAY:r.TEXTURE_2D}function w(Qe,Ce,yt,Ot,Jt=!1){if(Qe!==null){if(r[Qe]!==void 0)return r[Qe];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Qe+"'")}let zt=Ce;if(Ce===r.RED&&(yt===r.FLOAT&&(zt=r.R32F),yt===r.HALF_FLOAT&&(zt=r.R16F),yt===r.UNSIGNED_BYTE&&(zt=r.R8)),Ce===r.RED_INTEGER&&(yt===r.UNSIGNED_BYTE&&(zt=r.R8UI),yt===r.UNSIGNED_SHORT&&(zt=r.R16UI),yt===r.UNSIGNED_INT&&(zt=r.R32UI),yt===r.BYTE&&(zt=r.R8I),yt===r.SHORT&&(zt=r.R16I),yt===r.INT&&(zt=r.R32I)),Ce===r.RG&&(yt===r.FLOAT&&(zt=r.RG32F),yt===r.HALF_FLOAT&&(zt=r.RG16F),yt===r.UNSIGNED_BYTE&&(zt=r.RG8)),Ce===r.RG_INTEGER&&(yt===r.UNSIGNED_BYTE&&(zt=r.RG8UI),yt===r.UNSIGNED_SHORT&&(zt=r.RG16UI),yt===r.UNSIGNED_INT&&(zt=r.RG32UI),yt===r.BYTE&&(zt=r.RG8I),yt===r.SHORT&&(zt=r.RG16I),yt===r.INT&&(zt=r.RG32I)),Ce===r.RGB_INTEGER&&(yt===r.UNSIGNED_BYTE&&(zt=r.RGB8UI),yt===r.UNSIGNED_SHORT&&(zt=r.RGB16UI),yt===r.UNSIGNED_INT&&(zt=r.RGB32UI),yt===r.BYTE&&(zt=r.RGB8I),yt===r.SHORT&&(zt=r.RGB16I),yt===r.INT&&(zt=r.RGB32I)),Ce===r.RGBA_INTEGER&&(yt===r.UNSIGNED_BYTE&&(zt=r.RGBA8UI),yt===r.UNSIGNED_SHORT&&(zt=r.RGBA16UI),yt===r.UNSIGNED_INT&&(zt=r.RGBA32UI),yt===r.BYTE&&(zt=r.RGBA8I),yt===r.SHORT&&(zt=r.RGBA16I),yt===r.INT&&(zt=r.RGBA32I)),Ce===r.RGB&&yt===r.UNSIGNED_INT_5_9_9_9_REV&&(zt=r.RGB9_E5),Ce===r.RGBA){const _i=Jt?ab:zn.getTransfer(Ot);yt===r.FLOAT&&(zt=r.RGBA32F),yt===r.HALF_FLOAT&&(zt=r.RGBA16F),yt===r.UNSIGNED_BYTE&&(zt=_i===cs?r.SRGB8_ALPHA8:r.RGBA8),yt===r.UNSIGNED_SHORT_4_4_4_4&&(zt=r.RGBA4),yt===r.UNSIGNED_SHORT_5_5_5_1&&(zt=r.RGB5_A1)}return(zt===r.R16F||zt===r.R32F||zt===r.RG16F||zt===r.RG32F||zt===r.RGBA16F||zt===r.RGBA32F)&&e.get("EXT_color_buffer_float"),zt}function S(Qe,Ce){let yt;return Qe?Ce===null||Ce===cp||Ce===gm?yt=r.DEPTH24_STENCIL8:Ce===Eu?yt=r.DEPTH32F_STENCIL8:Ce===pA&&(yt=r.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):Ce===null||Ce===cp||Ce===gm?yt=r.DEPTH_COMPONENT24:Ce===Eu?yt=r.DEPTH_COMPONENT32F:Ce===pA&&(yt=r.DEPTH_COMPONENT16),yt}function R(Qe,Ce){return v(Qe)===!0||Qe.isFramebufferTexture&&Qe.minFilter!==tc&&Qe.minFilter!==Fc?Math.log2(Math.max(Ce.width,Ce.height))+1:Qe.mipmaps!==void 0&&Qe.mipmaps.length>0?Qe.mipmaps.length:Qe.isCompressedTexture&&Array.isArray(Qe.image)?Ce.mipmaps.length:1}function B(Qe){const Ce=Qe.target;Ce.removeEventListener("dispose",B),D(Ce),Ce.isVideoTexture&&p.delete(Ce)}function I(Qe){const Ce=Qe.target;Ce.removeEventListener("dispose",I),O(Ce)}function D(Qe){const Ce=n.get(Qe);if(Ce.__webglInit===void 0)return;const yt=Qe.source,Ot=m.get(yt);if(Ot){const Jt=Ot[Ce.__cacheKey];Jt.usedTimes--,Jt.usedTimes===0&&L(Qe),Object.keys(Ot).length===0&&m.delete(yt)}n.remove(Qe)}function L(Qe){const Ce=n.get(Qe);r.deleteTexture(Ce.__webglTexture);const yt=Qe.source,Ot=m.get(yt);delete Ot[Ce.__cacheKey],l.memory.textures--}function O(Qe){const Ce=n.get(Qe);if(Qe.depthTexture&&(Qe.depthTexture.dispose(),n.remove(Qe.depthTexture)),Qe.isWebGLCubeRenderTarget)for(let Ot=0;Ot<6;Ot++){if(Array.isArray(Ce.__webglFramebuffer[Ot]))for(let Jt=0;Jt<Ce.__webglFramebuffer[Ot].length;Jt++)r.deleteFramebuffer(Ce.__webglFramebuffer[Ot][Jt]);else r.deleteFramebuffer(Ce.__webglFramebuffer[Ot]);Ce.__webglDepthbuffer&&r.deleteRenderbuffer(Ce.__webglDepthbuffer[Ot])}else{if(Array.isArray(Ce.__webglFramebuffer))for(let Ot=0;Ot<Ce.__webglFramebuffer.length;Ot++)r.deleteFramebuffer(Ce.__webglFramebuffer[Ot]);else r.deleteFramebuffer(Ce.__webglFramebuffer);if(Ce.__webglDepthbuffer&&r.deleteRenderbuffer(Ce.__webglDepthbuffer),Ce.__webglMultisampledFramebuffer&&r.deleteFramebuffer(Ce.__webglMultisampledFramebuffer),Ce.__webglColorRenderbuffer)for(let Ot=0;Ot<Ce.__webglColorRenderbuffer.length;Ot++)Ce.__webglColorRenderbuffer[Ot]&&r.deleteRenderbuffer(Ce.__webglColorRenderbuffer[Ot]);Ce.__webglDepthRenderbuffer&&r.deleteRenderbuffer(Ce.__webglDepthRenderbuffer)}const yt=Qe.textures;for(let Ot=0,Jt=yt.length;Ot<Jt;Ot++){const zt=n.get(yt[Ot]);zt.__webglTexture&&(r.deleteTexture(zt.__webglTexture),l.memory.textures--),n.remove(yt[Ot])}n.remove(Qe)}let U=0;function Z(){U=0}function G(){const Qe=U;return Qe>=s.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+Qe+" texture units while this GPU supports only "+s.maxTextures),U+=1,Qe}function z(Qe){const Ce=[];return Ce.push(Qe.wrapS),Ce.push(Qe.wrapT),Ce.push(Qe.wrapR||0),Ce.push(Qe.magFilter),Ce.push(Qe.minFilter),Ce.push(Qe.anisotropy),Ce.push(Qe.internalFormat),Ce.push(Qe.format),Ce.push(Qe.type),Ce.push(Qe.generateMipmaps),Ce.push(Qe.premultiplyAlpha),Ce.push(Qe.flipY),Ce.push(Qe.unpackAlignment),Ce.push(Qe.colorSpace),Ce.join()}function $(Qe,Ce){const yt=n.get(Qe);if(Qe.isVideoTexture&&Ti(Qe),Qe.isRenderTargetTexture===!1&&Qe.version>0&&yt.__version!==Qe.version){const Ot=Qe.image;if(Ot===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Ot.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{de(yt,Qe,Ce);return}}i.bindTexture(r.TEXTURE_2D,yt.__webglTexture,r.TEXTURE0+Ce)}function Q(Qe,Ce){const yt=n.get(Qe);if(Qe.version>0&&yt.__version!==Qe.version){de(yt,Qe,Ce);return}i.bindTexture(r.TEXTURE_2D_ARRAY,yt.__webglTexture,r.TEXTURE0+Ce)}function H(Qe,Ce){const yt=n.get(Qe);if(Qe.version>0&&yt.__version!==Qe.version){de(yt,Qe,Ce);return}i.bindTexture(r.TEXTURE_3D,yt.__webglTexture,r.TEXTURE0+Ce)}function V(Qe,Ce){const yt=n.get(Qe);if(Qe.version>0&&yt.__version!==Qe.version){Ie(yt,Qe,Ce);return}i.bindTexture(r.TEXTURE_CUBE_MAP,yt.__webglTexture,r.TEXTURE0+Ce)}const ne={[FC]:r.REPEAT,[op]:r.CLAMP_TO_EDGE,[UC]:r.MIRRORED_REPEAT},Y={[tc]:r.NEAREST,[HK]:r.NEAREST_MIPMAP_NEAREST,[eb]:r.NEAREST_MIPMAP_LINEAR,[Fc]:r.LINEAR,[zC]:r.LINEAR_MIPMAP_NEAREST,[lp]:r.LINEAR_MIPMAP_LINEAR},ae={[XK]:r.NEVER,[eJ]:r.ALWAYS,[YK]:r.LESS,[NP]:r.LEQUAL,[KK]:r.EQUAL,[$K]:r.GEQUAL,[JK]:r.GREATER,[ZK]:r.NOTEQUAL};function xe(Qe,Ce){if(Ce.type===Eu&&e.has("OES_texture_float_linear")===!1&&(Ce.magFilter===Fc||Ce.magFilter===zC||Ce.magFilter===eb||Ce.magFilter===lp||Ce.minFilter===Fc||Ce.minFilter===zC||Ce.minFilter===eb||Ce.minFilter===lp)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),r.texParameteri(Qe,r.TEXTURE_WRAP_S,ne[Ce.wrapS]),r.texParameteri(Qe,r.TEXTURE_WRAP_T,ne[Ce.wrapT]),(Qe===r.TEXTURE_3D||Qe===r.TEXTURE_2D_ARRAY)&&r.texParameteri(Qe,r.TEXTURE_WRAP_R,ne[Ce.wrapR]),r.texParameteri(Qe,r.TEXTURE_MAG_FILTER,Y[Ce.magFilter]),r.texParameteri(Qe,r.TEXTURE_MIN_FILTER,Y[Ce.minFilter]),Ce.compareFunction&&(r.texParameteri(Qe,r.TEXTURE_COMPARE_MODE,r.COMPARE_REF_TO_TEXTURE),r.texParameteri(Qe,r.TEXTURE_COMPARE_FUNC,ae[Ce.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(Ce.magFilter===tc||Ce.minFilter!==eb&&Ce.minFilter!==lp||Ce.type===Eu&&e.has("OES_texture_float_linear")===!1)return;if(Ce.anisotropy>1||n.get(Ce).__currentAnisotropy){const yt=e.get("EXT_texture_filter_anisotropic");r.texParameterf(Qe,yt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Ce.anisotropy,s.getMaxAnisotropy())),n.get(Ce).__currentAnisotropy=Ce.anisotropy}}}function fe(Qe,Ce){let yt=!1;Qe.__webglInit===void 0&&(Qe.__webglInit=!0,Ce.addEventListener("dispose",B));const Ot=Ce.source;let Jt=m.get(Ot);Jt===void 0&&(Jt={},m.set(Ot,Jt));const zt=z(Ce);if(zt!==Qe.__cacheKey){Jt[zt]===void 0&&(Jt[zt]={texture:r.createTexture(),usedTimes:0},l.memory.textures++,yt=!0),Jt[zt].usedTimes++;const _i=Jt[Qe.__cacheKey];_i!==void 0&&(Jt[Qe.__cacheKey].usedTimes--,_i.usedTimes===0&&L(Ce)),Qe.__cacheKey=zt,Qe.__webglTexture=Jt[zt].texture}return yt}function de(Qe,Ce,yt){let Ot=r.TEXTURE_2D;(Ce.isDataArrayTexture||Ce.isCompressedArrayTexture)&&(Ot=r.TEXTURE_2D_ARRAY),Ce.isData3DTexture&&(Ot=r.TEXTURE_3D);const Jt=fe(Qe,Ce),zt=Ce.source;i.bindTexture(Ot,Qe.__webglTexture,r.TEXTURE0+yt);const _i=n.get(zt);if(zt.version!==_i.__version||Jt===!0){i.activeTexture(r.TEXTURE0+yt);const vt=zn.getPrimaries(zn.workingColorSpace),ye=Ce.colorSpace===Gh?null:zn.getPrimaries(Ce.colorSpace),ve=Ce.colorSpace===Gh||vt===ye?r.NONE:r.BROWSER_DEFAULT_WEBGL;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,Ce.flipY),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Ce.premultiplyAlpha),r.pixelStorei(r.UNPACK_ALIGNMENT,Ce.unpackAlignment),r.pixelStorei(r.UNPACK_COLORSPACE_CONVERSION_WEBGL,ve);let Le=x(Ce.image,!1,s.maxTextureSize);Le=ir(Ce,Le);const Te=o.convert(Ce.format,Ce.colorSpace),ke=o.convert(Ce.type);let Pe=w(Ce.internalFormat,Te,ke,Ce.colorSpace,Ce.isVideoTexture);xe(Ot,Ce);let F;const J=Ce.mipmaps,ie=Ce.isVideoTexture!==!0,Re=_i.__version===void 0||Jt===!0,ce=zt.dataReady,Ue=R(Ce,Le);if(Ce.isDepthTexture)Pe=S(Ce.format===ym,Ce.type),Re&&(ie?i.texStorage2D(r.TEXTURE_2D,1,Pe,Le.width,Le.height):i.texImage2D(r.TEXTURE_2D,0,Pe,Le.width,Le.height,0,Te,ke,null));else if(Ce.isDataTexture)if(J.length>0){ie&&Re&&i.texStorage2D(r.TEXTURE_2D,Ue,Pe,J[0].width,J[0].height);for(let je=0,dt=J.length;je<dt;je++)F=J[je],ie?ce&&i.texSubImage2D(r.TEXTURE_2D,je,0,0,F.width,F.height,Te,ke,F.data):i.texImage2D(r.TEXTURE_2D,je,Pe,F.width,F.height,0,Te,ke,F.data);Ce.generateMipmaps=!1}else ie?(Re&&i.texStorage2D(r.TEXTURE_2D,Ue,Pe,Le.width,Le.height),ce&&i.texSubImage2D(r.TEXTURE_2D,0,0,0,Le.width,Le.height,Te,ke,Le.data)):i.texImage2D(r.TEXTURE_2D,0,Pe,Le.width,Le.height,0,Te,ke,Le.data);else if(Ce.isCompressedTexture)if(Ce.isCompressedArrayTexture){ie&&Re&&i.texStorage3D(r.TEXTURE_2D_ARRAY,Ue,Pe,J[0].width,J[0].height,Le.depth);for(let je=0,dt=J.length;je<dt;je++)if(F=J[je],Ce.format!==ic)if(Te!==null)if(ie){if(ce)if(Ce.layerUpdates.size>0){const It=jk(F.width,F.height,Ce.format,Ce.type);for(const bt of Ce.layerUpdates){const Ut=F.data.subarray(bt*It/F.data.BYTES_PER_ELEMENT,(bt+1)*It/F.data.BYTES_PER_ELEMENT);i.compressedTexSubImage3D(r.TEXTURE_2D_ARRAY,je,0,0,bt,F.width,F.height,1,Te,Ut)}Ce.clearLayerUpdates()}else i.compressedTexSubImage3D(r.TEXTURE_2D_ARRAY,je,0,0,0,F.width,F.height,Le.depth,Te,F.data)}else i.compressedTexImage3D(r.TEXTURE_2D_ARRAY,je,Pe,F.width,F.height,Le.depth,0,F.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else ie?ce&&i.texSubImage3D(r.TEXTURE_2D_ARRAY,je,0,0,0,F.width,F.height,Le.depth,Te,ke,F.data):i.texImage3D(r.TEXTURE_2D_ARRAY,je,Pe,F.width,F.height,Le.depth,0,Te,ke,F.data)}else{ie&&Re&&i.texStorage2D(r.TEXTURE_2D,Ue,Pe,J[0].width,J[0].height);for(let je=0,dt=J.length;je<dt;je++)F=J[je],Ce.format!==ic?Te!==null?ie?ce&&i.compressedTexSubImage2D(r.TEXTURE_2D,je,0,0,F.width,F.height,Te,F.data):i.compressedTexImage2D(r.TEXTURE_2D,je,Pe,F.width,F.height,0,F.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ie?ce&&i.texSubImage2D(r.TEXTURE_2D,je,0,0,F.width,F.height,Te,ke,F.data):i.texImage2D(r.TEXTURE_2D,je,Pe,F.width,F.height,0,Te,ke,F.data)}else if(Ce.isDataArrayTexture)if(ie){if(Re&&i.texStorage3D(r.TEXTURE_2D_ARRAY,Ue,Pe,Le.width,Le.height,Le.depth),ce)if(Ce.layerUpdates.size>0){const je=jk(Le.width,Le.height,Ce.format,Ce.type);for(const dt of Ce.layerUpdates){const It=Le.data.subarray(dt*je/Le.data.BYTES_PER_ELEMENT,(dt+1)*je/Le.data.BYTES_PER_ELEMENT);i.texSubImage3D(r.TEXTURE_2D_ARRAY,0,0,0,dt,Le.width,Le.height,1,Te,ke,It)}Ce.clearLayerUpdates()}else i.texSubImage3D(r.TEXTURE_2D_ARRAY,0,0,0,0,Le.width,Le.height,Le.depth,Te,ke,Le.data)}else i.texImage3D(r.TEXTURE_2D_ARRAY,0,Pe,Le.width,Le.height,Le.depth,0,Te,ke,Le.data);else if(Ce.isData3DTexture)ie?(Re&&i.texStorage3D(r.TEXTURE_3D,Ue,Pe,Le.width,Le.height,Le.depth),ce&&i.texSubImage3D(r.TEXTURE_3D,0,0,0,0,Le.width,Le.height,Le.depth,Te,ke,Le.data)):i.texImage3D(r.TEXTURE_3D,0,Pe,Le.width,Le.height,Le.depth,0,Te,ke,Le.data);else if(Ce.isFramebufferTexture){if(Re)if(ie)i.texStorage2D(r.TEXTURE_2D,Ue,Pe,Le.width,Le.height);else{let je=Le.width,dt=Le.height;for(let It=0;It<Ue;It++)i.texImage2D(r.TEXTURE_2D,It,Pe,je,dt,0,Te,ke,null),je>>=1,dt>>=1}}else if(J.length>0){if(ie&&Re){const je=Gi(J[0]);i.texStorage2D(r.TEXTURE_2D,Ue,Pe,je.width,je.height)}for(let je=0,dt=J.length;je<dt;je++)F=J[je],ie?ce&&i.texSubImage2D(r.TEXTURE_2D,je,0,0,Te,ke,F):i.texImage2D(r.TEXTURE_2D,je,Pe,Te,ke,F);Ce.generateMipmaps=!1}else if(ie){if(Re){const je=Gi(Le);i.texStorage2D(r.TEXTURE_2D,Ue,Pe,je.width,je.height)}ce&&i.texSubImage2D(r.TEXTURE_2D,0,0,0,Te,ke,Le)}else i.texImage2D(r.TEXTURE_2D,0,Pe,Te,ke,Le);v(Ce)&&_(Ot),_i.__version=zt.version,Ce.onUpdate&&Ce.onUpdate(Ce)}Qe.__version=Ce.version}function Ie(Qe,Ce,yt){if(Ce.image.length!==6)return;const Ot=fe(Qe,Ce),Jt=Ce.source;i.bindTexture(r.TEXTURE_CUBE_MAP,Qe.__webglTexture,r.TEXTURE0+yt);const zt=n.get(Jt);if(Jt.version!==zt.__version||Ot===!0){i.activeTexture(r.TEXTURE0+yt);const _i=zn.getPrimaries(zn.workingColorSpace),vt=Ce.colorSpace===Gh?null:zn.getPrimaries(Ce.colorSpace),ye=Ce.colorSpace===Gh||_i===vt?r.NONE:r.BROWSER_DEFAULT_WEBGL;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,Ce.flipY),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Ce.premultiplyAlpha),r.pixelStorei(r.UNPACK_ALIGNMENT,Ce.unpackAlignment),r.pixelStorei(r.UNPACK_COLORSPACE_CONVERSION_WEBGL,ye);const ve=Ce.isCompressedTexture||Ce.image[0].isCompressedTexture,Le=Ce.image[0]&&Ce.image[0].isDataTexture,Te=[];for(let dt=0;dt<6;dt++)!ve&&!Le?Te[dt]=x(Ce.image[dt],!0,s.maxCubemapSize):Te[dt]=Le?Ce.image[dt].image:Ce.image[dt],Te[dt]=ir(Ce,Te[dt]);const ke=Te[0],Pe=o.convert(Ce.format,Ce.colorSpace),F=o.convert(Ce.type),J=w(Ce.internalFormat,Pe,F,Ce.colorSpace),ie=Ce.isVideoTexture!==!0,Re=zt.__version===void 0||Ot===!0,ce=Jt.dataReady;let Ue=R(Ce,ke);xe(r.TEXTURE_CUBE_MAP,Ce);let je;if(ve){ie&&Re&&i.texStorage2D(r.TEXTURE_CUBE_MAP,Ue,J,ke.width,ke.height);for(let dt=0;dt<6;dt++){je=Te[dt].mipmaps;for(let It=0;It<je.length;It++){const bt=je[It];Ce.format!==ic?Pe!==null?ie?ce&&i.compressedTexSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+dt,It,0,0,bt.width,bt.height,Pe,bt.data):i.compressedTexImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+dt,It,J,bt.width,bt.height,0,bt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):ie?ce&&i.texSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+dt,It,0,0,bt.width,bt.height,Pe,F,bt.data):i.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+dt,It,J,bt.width,bt.height,0,Pe,F,bt.data)}}}else{if(je=Ce.mipmaps,ie&&Re){je.length>0&&Ue++;const dt=Gi(Te[0]);i.texStorage2D(r.TEXTURE_CUBE_MAP,Ue,J,dt.width,dt.height)}for(let dt=0;dt<6;dt++)if(Le){ie?ce&&i.texSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+dt,0,0,0,Te[dt].width,Te[dt].height,Pe,F,Te[dt].data):i.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+dt,0,J,Te[dt].width,Te[dt].height,0,Pe,F,Te[dt].data);for(let It=0;It<je.length;It++){const bt=je[It].image[dt].image;ie?ce&&i.texSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+dt,It+1,0,0,bt.width,bt.height,Pe,F,bt.data):i.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+dt,It+1,J,bt.width,bt.height,0,Pe,F,bt.data)}}else{ie?ce&&i.texSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+dt,0,0,0,Pe,F,Te[dt]):i.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+dt,0,J,Pe,F,Te[dt]);for(let It=0;It<je.length;It++){const bt=je[It];ie?ce&&i.texSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+dt,It+1,0,0,Pe,F,bt.image[dt]):i.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+dt,It+1,J,Pe,F,bt.image[dt])}}}v(Ce)&&_(r.TEXTURE_CUBE_MAP),zt.__version=Jt.version,Ce.onUpdate&&Ce.onUpdate(Ce)}Qe.__version=Ce.version}function Ge(Qe,Ce,yt,Ot,Jt,zt){const _i=o.convert(yt.format,yt.colorSpace),vt=o.convert(yt.type),ye=w(yt.internalFormat,_i,vt,yt.colorSpace),ve=n.get(Ce),Le=n.get(yt);if(Le.__renderTarget=Ce,!ve.__hasExternalTextures){const Te=Math.max(1,Ce.width>>zt),ke=Math.max(1,Ce.height>>zt);Jt===r.TEXTURE_3D||Jt===r.TEXTURE_2D_ARRAY?i.texImage3D(Jt,zt,ye,Te,ke,Ce.depth,0,_i,vt,null):i.texImage2D(Jt,zt,ye,Te,ke,0,_i,vt,null)}i.bindFramebuffer(r.FRAMEBUFFER,Qe),Ii(Ce)?u.framebufferTexture2DMultisampleEXT(r.FRAMEBUFFER,Ot,Jt,Le.__webglTexture,0,di(Ce)):(Jt===r.TEXTURE_2D||Jt>=r.TEXTURE_CUBE_MAP_POSITIVE_X&&Jt<=r.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&r.framebufferTexture2D(r.FRAMEBUFFER,Ot,Jt,Le.__webglTexture,zt),i.bindFramebuffer(r.FRAMEBUFFER,null)}function Xe(Qe,Ce,yt){if(r.bindRenderbuffer(r.RENDERBUFFER,Qe),Ce.depthBuffer){const Ot=Ce.depthTexture,Jt=Ot&&Ot.isDepthTexture?Ot.type:null,zt=S(Ce.stencilBuffer,Jt),_i=Ce.stencilBuffer?r.DEPTH_STENCIL_ATTACHMENT:r.DEPTH_ATTACHMENT,vt=di(Ce);Ii(Ce)?u.renderbufferStorageMultisampleEXT(r.RENDERBUFFER,vt,zt,Ce.width,Ce.height):yt?r.renderbufferStorageMultisample(r.RENDERBUFFER,vt,zt,Ce.width,Ce.height):r.renderbufferStorage(r.RENDERBUFFER,zt,Ce.width,Ce.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,_i,r.RENDERBUFFER,Qe)}else{const Ot=Ce.textures;for(let Jt=0;Jt<Ot.length;Jt++){const zt=Ot[Jt],_i=o.convert(zt.format,zt.colorSpace),vt=o.convert(zt.type),ye=w(zt.internalFormat,_i,vt,zt.colorSpace),ve=di(Ce);yt&&Ii(Ce)===!1?r.renderbufferStorageMultisample(r.RENDERBUFFER,ve,ye,Ce.width,Ce.height):Ii(Ce)?u.renderbufferStorageMultisampleEXT(r.RENDERBUFFER,ve,ye,Ce.width,Ce.height):r.renderbufferStorage(r.RENDERBUFFER,ye,Ce.width,Ce.height)}}r.bindRenderbuffer(r.RENDERBUFFER,null)}function $e(Qe,Ce){if(Ce&&Ce.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(i.bindFramebuffer(r.FRAMEBUFFER,Qe),!(Ce.depthTexture&&Ce.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const yt=n.get(Ce.depthTexture);yt.__renderTarget=Ce,(!yt.__webglTexture||Ce.depthTexture.image.width!==Ce.width||Ce.depthTexture.image.height!==Ce.height)&&(Ce.depthTexture.image.width=Ce.width,Ce.depthTexture.image.height=Ce.height,Ce.depthTexture.needsUpdate=!0),$(Ce.depthTexture,0);const Ot=yt.__webglTexture,Jt=di(Ce);if(Ce.depthTexture.format===Am)Ii(Ce)?u.framebufferTexture2DMultisampleEXT(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,Ot,0,Jt):r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,Ot,0);else if(Ce.depthTexture.format===ym)Ii(Ce)?u.framebufferTexture2DMultisampleEXT(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.TEXTURE_2D,Ot,0,Jt):r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.TEXTURE_2D,Ot,0);else throw new Error("Unknown depthTexture format")}function lt(Qe){const Ce=n.get(Qe),yt=Qe.isWebGLCubeRenderTarget===!0;if(Ce.__boundDepthTexture!==Qe.depthTexture){const Ot=Qe.depthTexture;if(Ce.__depthDisposeCallback&&Ce.__depthDisposeCallback(),Ot){const Jt=()=>{delete Ce.__boundDepthTexture,delete Ce.__depthDisposeCallback,Ot.removeEventListener("dispose",Jt)};Ot.addEventListener("dispose",Jt),Ce.__depthDisposeCallback=Jt}Ce.__boundDepthTexture=Ot}if(Qe.depthTexture&&!Ce.__autoAllocateDepthBuffer){if(yt)throw new Error("target.depthTexture not supported in Cube render targets");$e(Ce.__webglFramebuffer,Qe)}else if(yt){Ce.__webglDepthbuffer=[];for(let Ot=0;Ot<6;Ot++)if(i.bindFramebuffer(r.FRAMEBUFFER,Ce.__webglFramebuffer[Ot]),Ce.__webglDepthbuffer[Ot]===void 0)Ce.__webglDepthbuffer[Ot]=r.createRenderbuffer(),Xe(Ce.__webglDepthbuffer[Ot],Qe,!1);else{const Jt=Qe.stencilBuffer?r.DEPTH_STENCIL_ATTACHMENT:r.DEPTH_ATTACHMENT,zt=Ce.__webglDepthbuffer[Ot];r.bindRenderbuffer(r.RENDERBUFFER,zt),r.framebufferRenderbuffer(r.FRAMEBUFFER,Jt,r.RENDERBUFFER,zt)}}else if(i.bindFramebuffer(r.FRAMEBUFFER,Ce.__webglFramebuffer),Ce.__webglDepthbuffer===void 0)Ce.__webglDepthbuffer=r.createRenderbuffer(),Xe(Ce.__webglDepthbuffer,Qe,!1);else{const Ot=Qe.stencilBuffer?r.DEPTH_STENCIL_ATTACHMENT:r.DEPTH_ATTACHMENT,Jt=Ce.__webglDepthbuffer;r.bindRenderbuffer(r.RENDERBUFFER,Jt),r.framebufferRenderbuffer(r.FRAMEBUFFER,Ot,r.RENDERBUFFER,Jt)}i.bindFramebuffer(r.FRAMEBUFFER,null)}function At(Qe,Ce,yt){const Ot=n.get(Qe);Ce!==void 0&&Ge(Ot.__webglFramebuffer,Qe,Qe.texture,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,0),yt!==void 0&&lt(Qe)}function Gt(Qe){const Ce=Qe.texture,yt=n.get(Qe),Ot=n.get(Ce);Qe.addEventListener("dispose",I);const Jt=Qe.textures,zt=Qe.isWebGLCubeRenderTarget===!0,_i=Jt.length>1;if(_i||(Ot.__webglTexture===void 0&&(Ot.__webglTexture=r.createTexture()),Ot.__version=Ce.version,l.memory.textures++),zt){yt.__webglFramebuffer=[];for(let vt=0;vt<6;vt++)if(Ce.mipmaps&&Ce.mipmaps.length>0){yt.__webglFramebuffer[vt]=[];for(let ye=0;ye<Ce.mipmaps.length;ye++)yt.__webglFramebuffer[vt][ye]=r.createFramebuffer()}else yt.__webglFramebuffer[vt]=r.createFramebuffer()}else{if(Ce.mipmaps&&Ce.mipmaps.length>0){yt.__webglFramebuffer=[];for(let vt=0;vt<Ce.mipmaps.length;vt++)yt.__webglFramebuffer[vt]=r.createFramebuffer()}else yt.__webglFramebuffer=r.createFramebuffer();if(_i)for(let vt=0,ye=Jt.length;vt<ye;vt++){const ve=n.get(Jt[vt]);ve.__webglTexture===void 0&&(ve.__webglTexture=r.createTexture(),l.memory.textures++)}if(Qe.samples>0&&Ii(Qe)===!1){yt.__webglMultisampledFramebuffer=r.createFramebuffer(),yt.__webglColorRenderbuffer=[],i.bindFramebuffer(r.FRAMEBUFFER,yt.__webglMultisampledFramebuffer);for(let vt=0;vt<Jt.length;vt++){const ye=Jt[vt];yt.__webglColorRenderbuffer[vt]=r.createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,yt.__webglColorRenderbuffer[vt]);const ve=o.convert(ye.format,ye.colorSpace),Le=o.convert(ye.type),Te=w(ye.internalFormat,ve,Le,ye.colorSpace,Qe.isXRRenderTarget===!0),ke=di(Qe);r.renderbufferStorageMultisample(r.RENDERBUFFER,ke,Te,Qe.width,Qe.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0+vt,r.RENDERBUFFER,yt.__webglColorRenderbuffer[vt])}r.bindRenderbuffer(r.RENDERBUFFER,null),Qe.depthBuffer&&(yt.__webglDepthRenderbuffer=r.createRenderbuffer(),Xe(yt.__webglDepthRenderbuffer,Qe,!0)),i.bindFramebuffer(r.FRAMEBUFFER,null)}}if(zt){i.bindTexture(r.TEXTURE_CUBE_MAP,Ot.__webglTexture),xe(r.TEXTURE_CUBE_MAP,Ce);for(let vt=0;vt<6;vt++)if(Ce.mipmaps&&Ce.mipmaps.length>0)for(let ye=0;ye<Ce.mipmaps.length;ye++)Ge(yt.__webglFramebuffer[vt][ye],Qe,Ce,r.COLOR_ATTACHMENT0,r.TEXTURE_CUBE_MAP_POSITIVE_X+vt,ye);else Ge(yt.__webglFramebuffer[vt],Qe,Ce,r.COLOR_ATTACHMENT0,r.TEXTURE_CUBE_MAP_POSITIVE_X+vt,0);v(Ce)&&_(r.TEXTURE_CUBE_MAP),i.unbindTexture()}else if(_i){for(let vt=0,ye=Jt.length;vt<ye;vt++){const ve=Jt[vt],Le=n.get(ve);i.bindTexture(r.TEXTURE_2D,Le.__webglTexture),xe(r.TEXTURE_2D,ve),Ge(yt.__webglFramebuffer,Qe,ve,r.COLOR_ATTACHMENT0+vt,r.TEXTURE_2D,0),v(ve)&&_(r.TEXTURE_2D)}i.unbindTexture()}else{let vt=r.TEXTURE_2D;if((Qe.isWebGL3DRenderTarget||Qe.isWebGLArrayRenderTarget)&&(vt=Qe.isWebGL3DRenderTarget?r.TEXTURE_3D:r.TEXTURE_2D_ARRAY),i.bindTexture(vt,Ot.__webglTexture),xe(vt,Ce),Ce.mipmaps&&Ce.mipmaps.length>0)for(let ye=0;ye<Ce.mipmaps.length;ye++)Ge(yt.__webglFramebuffer[ye],Qe,Ce,r.COLOR_ATTACHMENT0,vt,ye);else Ge(yt.__webglFramebuffer,Qe,Ce,r.COLOR_ATTACHMENT0,vt,0);v(Ce)&&_(vt),i.unbindTexture()}Qe.depthBuffer&&lt(Qe)}function gt(Qe){const Ce=Qe.textures;for(let yt=0,Ot=Ce.length;yt<Ot;yt++){const Jt=Ce[yt];if(v(Jt)){const zt=T(Qe),_i=n.get(Jt).__webglTexture;i.bindTexture(zt,_i),_(zt),i.unbindTexture()}}}const xi=[],Ze=[];function Ui(Qe){if(Qe.samples>0){if(Ii(Qe)===!1){const Ce=Qe.textures,yt=Qe.width,Ot=Qe.height;let Jt=r.COLOR_BUFFER_BIT;const zt=Qe.stencilBuffer?r.DEPTH_STENCIL_ATTACHMENT:r.DEPTH_ATTACHMENT,_i=n.get(Qe),vt=Ce.length>1;if(vt)for(let ye=0;ye<Ce.length;ye++)i.bindFramebuffer(r.FRAMEBUFFER,_i.__webglMultisampledFramebuffer),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0+ye,r.RENDERBUFFER,null),i.bindFramebuffer(r.FRAMEBUFFER,_i.__webglFramebuffer),r.framebufferTexture2D(r.DRAW_FRAMEBUFFER,r.COLOR_ATTACHMENT0+ye,r.TEXTURE_2D,null,0);i.bindFramebuffer(r.READ_FRAMEBUFFER,_i.__webglMultisampledFramebuffer),i.bindFramebuffer(r.DRAW_FRAMEBUFFER,_i.__webglFramebuffer);for(let ye=0;ye<Ce.length;ye++){if(Qe.resolveDepthBuffer&&(Qe.depthBuffer&&(Jt|=r.DEPTH_BUFFER_BIT),Qe.stencilBuffer&&Qe.resolveStencilBuffer&&(Jt|=r.STENCIL_BUFFER_BIT)),vt){r.framebufferRenderbuffer(r.READ_FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.RENDERBUFFER,_i.__webglColorRenderbuffer[ye]);const ve=n.get(Ce[ye]).__webglTexture;r.framebufferTexture2D(r.DRAW_FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,ve,0)}r.blitFramebuffer(0,0,yt,Ot,0,0,yt,Ot,Jt,r.NEAREST),c===!0&&(xi.length=0,Ze.length=0,xi.push(r.COLOR_ATTACHMENT0+ye),Qe.depthBuffer&&Qe.resolveDepthBuffer===!1&&(xi.push(zt),Ze.push(zt),r.invalidateFramebuffer(r.DRAW_FRAMEBUFFER,Ze)),r.invalidateFramebuffer(r.READ_FRAMEBUFFER,xi))}if(i.bindFramebuffer(r.READ_FRAMEBUFFER,null),i.bindFramebuffer(r.DRAW_FRAMEBUFFER,null),vt)for(let ye=0;ye<Ce.length;ye++){i.bindFramebuffer(r.FRAMEBUFFER,_i.__webglMultisampledFramebuffer),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0+ye,r.RENDERBUFFER,_i.__webglColorRenderbuffer[ye]);const ve=n.get(Ce[ye]).__webglTexture;i.bindFramebuffer(r.FRAMEBUFFER,_i.__webglFramebuffer),r.framebufferTexture2D(r.DRAW_FRAMEBUFFER,r.COLOR_ATTACHMENT0+ye,r.TEXTURE_2D,ve,0)}i.bindFramebuffer(r.DRAW_FRAMEBUFFER,_i.__webglMultisampledFramebuffer)}else if(Qe.depthBuffer&&Qe.resolveDepthBuffer===!1&&c){const Ce=Qe.stencilBuffer?r.DEPTH_STENCIL_ATTACHMENT:r.DEPTH_ATTACHMENT;r.invalidateFramebuffer(r.DRAW_FRAMEBUFFER,[Ce])}}}function di(Qe){return Math.min(s.maxSamples,Qe.samples)}function Ii(Qe){const Ce=n.get(Qe);return Qe.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&Ce.__useRenderToTexture!==!1}function Ti(Qe){const Ce=l.render.frame;p.get(Qe)!==Ce&&(p.set(Qe,Ce),Qe.update())}function ir(Qe,Ce){const yt=Qe.colorSpace,Ot=Qe.format,Jt=Qe.type;return Qe.isCompressedTexture===!0||Qe.isVideoTexture===!0||yt!==vm&&yt!==Gh&&(zn.getTransfer(yt)===cs?(Ot!==ic||Jt!==_u)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",yt)),Ce}function Gi(Qe){return typeof HTMLImageElement<"u"&&Qe instanceof HTMLImageElement?(h.width=Qe.naturalWidth||Qe.width,h.height=Qe.naturalHeight||Qe.height):typeof VideoFrame<"u"&&Qe instanceof VideoFrame?(h.width=Qe.displayWidth,h.height=Qe.displayHeight):(h.width=Qe.width,h.height=Qe.height),h}this.allocateTextureUnit=G,this.resetTextureUnits=Z,this.setTexture2D=$,this.setTexture2DArray=Q,this.setTexture3D=H,this.setTextureCube=V,this.rebindTextures=At,this.setupRenderTarget=Gt,this.updateRenderTargetMipmap=gt,this.updateMultisampleRenderTarget=Ui,this.setupDepthRenderbuffer=lt,this.setupFrameBufferTexture=Ge,this.useMultisampledRTT=Ii}function yie(r,e){function i(n,s=Gh){let o;const l=zn.getTransfer(s);if(n===_u)return r.UNSIGNED_BYTE;if(n===VC)return r.UNSIGNED_SHORT_4_4_4_4;if(n===GC)return r.UNSIGNED_SHORT_5_5_5_1;if(n===_P)return r.UNSIGNED_INT_5_9_9_9_REV;if(n===xP)return r.BYTE;if(n===bP)return r.SHORT;if(n===pA)return r.UNSIGNED_SHORT;if(n===jC)return r.INT;if(n===cp)return r.UNSIGNED_INT;if(n===Eu)return r.FLOAT;if(n===mm)return r.HALF_FLOAT;if(n===EP)return r.ALPHA;if(n===wP)return r.RGB;if(n===ic)return r.RGBA;if(n===CP)return r.LUMINANCE;if(n===SP)return r.LUMINANCE_ALPHA;if(n===Am)return r.DEPTH_COMPONENT;if(n===ym)return r.DEPTH_STENCIL;if(n===TP)return r.RED;if(n===HC)return r.RED_INTEGER;if(n===MP)return r.RG;if(n===WC)return r.RG_INTEGER;if(n===QC)return r.RGBA_INTEGER;if(n===tb||n===ib||n===rb||n===nb)if(l===cs)if(o=e.get("WEBGL_compressed_texture_s3tc_srgb"),o!==null){if(n===tb)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===ib)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===rb)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===nb)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(o=e.get("WEBGL_compressed_texture_s3tc"),o!==null){if(n===tb)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===ib)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===rb)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===nb)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===qC||n===XC||n===YC||n===KC)if(o=e.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(n===qC)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===XC)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===YC)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===KC)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===JC||n===ZC||n===$C)if(o=e.get("WEBGL_compressed_texture_etc"),o!==null){if(n===JC||n===ZC)return l===cs?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(n===$C)return l===cs?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(n===eS||n===tS||n===iS||n===rS||n===nS||n===sS||n===aS||n===oS||n===lS||n===cS||n===uS||n===hS||n===dS||n===pS)if(o=e.get("WEBGL_compressed_texture_astc"),o!==null){if(n===eS)return l===cs?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===tS)return l===cs?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===iS)return l===cs?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===rS)return l===cs?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===nS)return l===cs?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===sS)return l===cs?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===aS)return l===cs?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===oS)return l===cs?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===lS)return l===cs?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===cS)return l===cs?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===uS)return l===cs?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===hS)return l===cs?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===dS)return l===cs?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===pS)return l===cs?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===sb||n===fS||n===mS)if(o=e.get("EXT_texture_compression_bptc"),o!==null){if(n===sb)return l===cs?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===fS)return o.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===mS)return o.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(n===RP||n===gS||n===AS||n===yS)if(o=e.get("EXT_texture_compression_rgtc"),o!==null){if(n===sb)return o.COMPRESSED_RED_RGTC1_EXT;if(n===gS)return o.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===AS)return o.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===yS)return o.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===gm?r.UNSIGNED_INT_24_8:r[n]!==void 0?r[n]:null}return{convert:i}}class vie extends Dl{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}let Um=class extends to{constructor(){super(),this.isGroup=!0,this.type="Group"}};const xie={type:"move"};class $S{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Um,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Um,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new at,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new at),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Um,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new at,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new at),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const i=this._hand;if(i)for(const n of e.hand.values())this._getHandJoint(i,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,i,n){let s=null,o=null,l=null;const u=this._targetRay,c=this._grip,h=this._hand;if(e&&i.session.visibilityState!=="visible-blurred"){if(h&&e.hand){l=!0;for(const x of e.hand.values()){const v=i.getJointPose(x,n),_=this._getHandJoint(h,x);v!==null&&(_.matrix.fromArray(v.transform.matrix),_.matrix.decompose(_.position,_.rotation,_.scale),_.matrixWorldNeedsUpdate=!0,_.jointRadius=v.radius),_.visible=v!==null}const p=h.joints["index-finger-tip"],f=h.joints["thumb-tip"],m=p.position.distanceTo(f.position),g=.02,y=.005;h.inputState.pinching&&m>g+y?(h.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!h.inputState.pinching&&m<=g-y&&(h.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else c!==null&&e.gripSpace&&(o=i.getPose(e.gripSpace,n),o!==null&&(c.matrix.fromArray(o.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),c.matrixWorldNeedsUpdate=!0,o.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(o.linearVelocity)):c.hasLinearVelocity=!1,o.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(o.angularVelocity)):c.hasAngularVelocity=!1));u!==null&&(s=i.getPose(e.targetRaySpace,n),s===null&&o!==null&&(s=o),s!==null&&(u.matrix.fromArray(s.transform.matrix),u.matrix.decompose(u.position,u.rotation,u.scale),u.matrixWorldNeedsUpdate=!0,s.linearVelocity?(u.hasLinearVelocity=!0,u.linearVelocity.copy(s.linearVelocity)):u.hasLinearVelocity=!1,s.angularVelocity?(u.hasAngularVelocity=!0,u.angularVelocity.copy(s.angularVelocity)):u.hasAngularVelocity=!1,this.dispatchEvent(xie)))}return u!==null&&(u.visible=s!==null),c!==null&&(c.visible=o!==null),h!==null&&(h.visible=l!==null),this}_getHandJoint(e,i){if(e.joints[i.jointName]===void 0){const n=new Um;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[i.jointName]=n,e.add(n)}return e.joints[i.jointName]}}const bie=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,_ie=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class Eie{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,i,n){if(this.texture===null){const s=new Nl,o=e.properties.get(s);o.__webglTexture=i.texture,(i.depthNear!=n.depthNear||i.depthFar!=n.depthFar)&&(this.depthNear=i.depthNear,this.depthFar=i.depthFar),this.texture=s}}getMesh(e){if(this.texture!==null&&this.mesh===null){const i=e.cameras[0].viewport,n=new zc({vertexShader:bie,fragmentShader:_ie,uniforms:{depthColor:{value:this.texture},depthWidth:{value:i.z},depthHeight:{value:i.w}}});this.mesh=new za(new Tb(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class wie extends up{constructor(e,i){super();const n=this;let s=null,o=1,l=null,u="local-floor",c=1,h=null,p=null,f=null,m=null,g=null,y=null;const x=new Eie,v=i.getContextAttributes();let _=null,T=null;const w=[],S=[],R=new ji;let B=null;const I=new Dl;I.viewport=new Js;const D=new Dl;D.viewport=new Js;const L=[I,D],O=new vie;let U=null,Z=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(de){let Ie=w[de];return Ie===void 0&&(Ie=new $S,w[de]=Ie),Ie.getTargetRaySpace()},this.getControllerGrip=function(de){let Ie=w[de];return Ie===void 0&&(Ie=new $S,w[de]=Ie),Ie.getGripSpace()},this.getHand=function(de){let Ie=w[de];return Ie===void 0&&(Ie=new $S,w[de]=Ie),Ie.getHandSpace()};function G(de){const Ie=S.indexOf(de.inputSource);if(Ie===-1)return;const Ge=w[Ie];Ge!==void 0&&(Ge.update(de.inputSource,de.frame,h||l),Ge.dispatchEvent({type:de.type,data:de.inputSource}))}function z(){s.removeEventListener("select",G),s.removeEventListener("selectstart",G),s.removeEventListener("selectend",G),s.removeEventListener("squeeze",G),s.removeEventListener("squeezestart",G),s.removeEventListener("squeezeend",G),s.removeEventListener("end",z),s.removeEventListener("inputsourceschange",$);for(let de=0;de<w.length;de++){const Ie=S[de];Ie!==null&&(S[de]=null,w[de].disconnect(Ie))}U=null,Z=null,x.reset(),e.setRenderTarget(_),g=null,m=null,f=null,s=null,T=null,fe.stop(),n.isPresenting=!1,e.setPixelRatio(B),e.setSize(R.width,R.height,!1),n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(de){o=de,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(de){u=de,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return h||l},this.setReferenceSpace=function(de){h=de},this.getBaseLayer=function(){return m!==null?m:g},this.getBinding=function(){return f},this.getFrame=function(){return y},this.getSession=function(){return s},this.setSession=async function(de){if(s=de,s!==null){if(_=e.getRenderTarget(),s.addEventListener("select",G),s.addEventListener("selectstart",G),s.addEventListener("selectend",G),s.addEventListener("squeeze",G),s.addEventListener("squeezestart",G),s.addEventListener("squeezeend",G),s.addEventListener("end",z),s.addEventListener("inputsourceschange",$),v.xrCompatible!==!0&&await i.makeXRCompatible(),B=e.getPixelRatio(),e.getSize(R),s.renderState.layers===void 0){const Ie={antialias:v.antialias,alpha:!0,depth:v.depth,stencil:v.stencil,framebufferScaleFactor:o};g=new XRWebGLLayer(s,i,Ie),s.updateRenderState({baseLayer:g}),e.setPixelRatio(1),e.setSize(g.framebufferWidth,g.framebufferHeight,!1),T=new Hh(g.framebufferWidth,g.framebufferHeight,{format:ic,type:_u,colorSpace:e.outputColorSpace,stencilBuffer:v.stencil})}else{let Ie=null,Ge=null,Xe=null;v.depth&&(Xe=v.stencil?i.DEPTH24_STENCIL8:i.DEPTH_COMPONENT24,Ie=v.stencil?ym:Am,Ge=v.stencil?gm:cp);const $e={colorFormat:i.RGBA8,depthFormat:Xe,scaleFactor:o};f=new XRWebGLBinding(s,i),m=f.createProjectionLayer($e),s.updateRenderState({layers:[m]}),e.setPixelRatio(1),e.setSize(m.textureWidth,m.textureHeight,!1),T=new Hh(m.textureWidth,m.textureHeight,{format:ic,type:_u,depthTexture:new vk(m.textureWidth,m.textureHeight,Ge,void 0,void 0,void 0,void 0,void 0,void 0,Ie),stencilBuffer:v.stencil,colorSpace:e.outputColorSpace,samples:v.antialias?4:0,resolveDepthBuffer:m.ignoreDepthValues===!1})}T.isXRRenderTarget=!0,this.setFoveation(c),h=null,l=await s.requestReferenceSpace(u),fe.setContext(s),fe.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(s!==null)return s.environmentBlendMode},this.getDepthTexture=function(){return x.getDepthTexture()};function $(de){for(let Ie=0;Ie<de.removed.length;Ie++){const Ge=de.removed[Ie],Xe=S.indexOf(Ge);Xe>=0&&(S[Xe]=null,w[Xe].disconnect(Ge))}for(let Ie=0;Ie<de.added.length;Ie++){const Ge=de.added[Ie];let Xe=S.indexOf(Ge);if(Xe===-1){for(let lt=0;lt<w.length;lt++)if(lt>=S.length){S.push(Ge),Xe=lt;break}else if(S[lt]===null){S[lt]=Ge,Xe=lt;break}if(Xe===-1)break}const $e=w[Xe];$e&&$e.connect(Ge)}}const Q=new at,H=new at;function V(de,Ie,Ge){Q.setFromMatrixPosition(Ie.matrixWorld),H.setFromMatrixPosition(Ge.matrixWorld);const Xe=Q.distanceTo(H),$e=Ie.projectionMatrix.elements,lt=Ge.projectionMatrix.elements,At=$e[14]/($e[10]-1),Gt=$e[14]/($e[10]+1),gt=($e[9]+1)/$e[5],xi=($e[9]-1)/$e[5],Ze=($e[8]-1)/$e[0],Ui=(lt[8]+1)/lt[0],di=At*Ze,Ii=At*Ui,Ti=Xe/(-Ze+Ui),ir=Ti*-Ze;if(Ie.matrixWorld.decompose(de.position,de.quaternion,de.scale),de.translateX(ir),de.translateZ(Ti),de.matrixWorld.compose(de.position,de.quaternion,de.scale),de.matrixWorldInverse.copy(de.matrixWorld).invert(),$e[10]===-1)de.projectionMatrix.copy(Ie.projectionMatrix),de.projectionMatrixInverse.copy(Ie.projectionMatrixInverse);else{const Gi=At+Ti,Qe=Gt+Ti,Ce=di-ir,yt=Ii+(Xe-ir),Ot=gt*Gt/Qe*Gi,Jt=xi*Gt/Qe*Gi;de.projectionMatrix.makePerspective(Ce,yt,Ot,Jt,Gi,Qe),de.projectionMatrixInverse.copy(de.projectionMatrix).invert()}}function ne(de,Ie){Ie===null?de.matrixWorld.copy(de.matrix):de.matrixWorld.multiplyMatrices(Ie.matrixWorld,de.matrix),de.matrixWorldInverse.copy(de.matrixWorld).invert()}this.updateCamera=function(de){if(s===null)return;let Ie=de.near,Ge=de.far;x.texture!==null&&(x.depthNear>0&&(Ie=x.depthNear),x.depthFar>0&&(Ge=x.depthFar)),O.near=D.near=I.near=Ie,O.far=D.far=I.far=Ge,(U!==O.near||Z!==O.far)&&(s.updateRenderState({depthNear:O.near,depthFar:O.far}),U=O.near,Z=O.far),I.layers.mask=de.layers.mask|2,D.layers.mask=de.layers.mask|4,O.layers.mask=I.layers.mask|D.layers.mask;const Xe=de.parent,$e=O.cameras;ne(O,Xe);for(let lt=0;lt<$e.length;lt++)ne($e[lt],Xe);$e.length===2?V(O,I,D):O.projectionMatrix.copy(I.projectionMatrix),Y(de,O,Xe)};function Y(de,Ie,Ge){Ge===null?de.matrix.copy(Ie.matrixWorld):(de.matrix.copy(Ge.matrixWorld),de.matrix.invert(),de.matrix.multiply(Ie.matrixWorld)),de.matrix.decompose(de.position,de.quaternion,de.scale),de.updateMatrixWorld(!0),de.projectionMatrix.copy(Ie.projectionMatrix),de.projectionMatrixInverse.copy(Ie.projectionMatrixInverse),de.isPerspectiveCamera&&(de.fov=mA*2*Math.atan(1/de.projectionMatrix.elements[5]),de.zoom=1)}this.getCamera=function(){return O},this.getFoveation=function(){if(!(m===null&&g===null))return c},this.setFoveation=function(de){c=de,m!==null&&(m.fixedFoveation=de),g!==null&&g.fixedFoveation!==void 0&&(g.fixedFoveation=de)},this.hasDepthSensing=function(){return x.texture!==null},this.getDepthSensingMesh=function(){return x.getMesh(O)};let ae=null;function xe(de,Ie){if(p=Ie.getViewerPose(h||l),y=Ie,p!==null){const Ge=p.views;g!==null&&(e.setRenderTargetFramebuffer(T,g.framebuffer),e.setRenderTarget(T));let Xe=!1;Ge.length!==O.cameras.length&&(O.cameras.length=0,Xe=!0);for(let lt=0;lt<Ge.length;lt++){const At=Ge[lt];let Gt=null;if(g!==null)Gt=g.getViewport(At);else{const xi=f.getViewSubImage(m,At);Gt=xi.viewport,lt===0&&(e.setRenderTargetTextures(T,xi.colorTexture,m.ignoreDepthValues?void 0:xi.depthStencilTexture),e.setRenderTarget(T))}let gt=L[lt];gt===void 0&&(gt=new Dl,gt.layers.enable(lt),gt.viewport=new Js,L[lt]=gt),gt.matrix.fromArray(At.transform.matrix),gt.matrix.decompose(gt.position,gt.quaternion,gt.scale),gt.projectionMatrix.fromArray(At.projectionMatrix),gt.projectionMatrixInverse.copy(gt.projectionMatrix).invert(),gt.viewport.set(Gt.x,Gt.y,Gt.width,Gt.height),lt===0&&(O.matrix.copy(gt.matrix),O.matrix.decompose(O.position,O.quaternion,O.scale)),Xe===!0&&O.cameras.push(gt)}const $e=s.enabledFeatures;if($e&&$e.includes("depth-sensing")){const lt=f.getDepthInformation(Ge[0]);lt&&lt.isValid&&lt.texture&&x.init(e,lt,s.renderState)}}for(let Ge=0;Ge<w.length;Ge++){const Xe=S[Ge],$e=w[Ge];Xe!==null&&$e!==void 0&&$e.update(Xe,Ie,h||l)}ae&&ae(de,Ie),Ie.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:Ie}),y=null}const fe=new hk;fe.setAnimationLoop(xe),this.setAnimationLoop=function(de){ae=de},this.dispose=function(){}}}const bp=new Yh,Cie=new As;function Sie(r,e){function i(v,_){v.matrixAutoUpdate===!0&&v.updateMatrix(),_.value.copy(v.matrix)}function n(v,_){_.color.getRGB(v.fogColor.value,sk(r)),_.isFog?(v.fogNear.value=_.near,v.fogFar.value=_.far):_.isFogExp2&&(v.fogDensity.value=_.density)}function s(v,_,T,w,S){_.isMeshBasicMaterial||_.isMeshLambertMaterial?o(v,_):_.isMeshToonMaterial?(o(v,_),f(v,_)):_.isMeshPhongMaterial?(o(v,_),p(v,_)):_.isMeshStandardMaterial?(o(v,_),m(v,_),_.isMeshPhysicalMaterial&&g(v,_,S)):_.isMeshMatcapMaterial?(o(v,_),y(v,_)):_.isMeshDepthMaterial?o(v,_):_.isMeshDistanceMaterial?(o(v,_),x(v,_)):_.isMeshNormalMaterial?o(v,_):_.isLineBasicMaterial?(l(v,_),_.isLineDashedMaterial&&u(v,_)):_.isPointsMaterial?c(v,_,T,w):_.isSpriteMaterial?h(v,_):_.isShadowMaterial?(v.color.value.copy(_.color),v.opacity.value=_.opacity):_.isShaderMaterial&&(_.uniformsNeedUpdate=!1)}function o(v,_){v.opacity.value=_.opacity,_.color&&v.diffuse.value.copy(_.color),_.emissive&&v.emissive.value.copy(_.emissive).multiplyScalar(_.emissiveIntensity),_.map&&(v.map.value=_.map,i(_.map,v.mapTransform)),_.alphaMap&&(v.alphaMap.value=_.alphaMap,i(_.alphaMap,v.alphaMapTransform)),_.bumpMap&&(v.bumpMap.value=_.bumpMap,i(_.bumpMap,v.bumpMapTransform),v.bumpScale.value=_.bumpScale,_.side===vo&&(v.bumpScale.value*=-1)),_.normalMap&&(v.normalMap.value=_.normalMap,i(_.normalMap,v.normalMapTransform),v.normalScale.value.copy(_.normalScale),_.side===vo&&v.normalScale.value.negate()),_.displacementMap&&(v.displacementMap.value=_.displacementMap,i(_.displacementMap,v.displacementMapTransform),v.displacementScale.value=_.displacementScale,v.displacementBias.value=_.displacementBias),_.emissiveMap&&(v.emissiveMap.value=_.emissiveMap,i(_.emissiveMap,v.emissiveMapTransform)),_.specularMap&&(v.specularMap.value=_.specularMap,i(_.specularMap,v.specularMapTransform)),_.alphaTest>0&&(v.alphaTest.value=_.alphaTest);const T=e.get(_),w=T.envMap,S=T.envMapRotation;w&&(v.envMap.value=w,bp.copy(S),bp.x*=-1,bp.y*=-1,bp.z*=-1,w.isCubeTexture&&w.isRenderTargetTexture===!1&&(bp.y*=-1,bp.z*=-1),v.envMapRotation.value.setFromMatrix4(Cie.makeRotationFromEuler(bp)),v.flipEnvMap.value=w.isCubeTexture&&w.isRenderTargetTexture===!1?-1:1,v.reflectivity.value=_.reflectivity,v.ior.value=_.ior,v.refractionRatio.value=_.refractionRatio),_.lightMap&&(v.lightMap.value=_.lightMap,v.lightMapIntensity.value=_.lightMapIntensity,i(_.lightMap,v.lightMapTransform)),_.aoMap&&(v.aoMap.value=_.aoMap,v.aoMapIntensity.value=_.aoMapIntensity,i(_.aoMap,v.aoMapTransform))}function l(v,_){v.diffuse.value.copy(_.color),v.opacity.value=_.opacity,_.map&&(v.map.value=_.map,i(_.map,v.mapTransform))}function u(v,_){v.dashSize.value=_.dashSize,v.totalSize.value=_.dashSize+_.gapSize,v.scale.value=_.scale}function c(v,_,T,w){v.diffuse.value.copy(_.color),v.opacity.value=_.opacity,v.size.value=_.size*T,v.scale.value=w*.5,_.map&&(v.map.value=_.map,i(_.map,v.uvTransform)),_.alphaMap&&(v.alphaMap.value=_.alphaMap,i(_.alphaMap,v.alphaMapTransform)),_.alphaTest>0&&(v.alphaTest.value=_.alphaTest)}function h(v,_){v.diffuse.value.copy(_.color),v.opacity.value=_.opacity,v.rotation.value=_.rotation,_.map&&(v.map.value=_.map,i(_.map,v.mapTransform)),_.alphaMap&&(v.alphaMap.value=_.alphaMap,i(_.alphaMap,v.alphaMapTransform)),_.alphaTest>0&&(v.alphaTest.value=_.alphaTest)}function p(v,_){v.specular.value.copy(_.specular),v.shininess.value=Math.max(_.shininess,1e-4)}function f(v,_){_.gradientMap&&(v.gradientMap.value=_.gradientMap)}function m(v,_){v.metalness.value=_.metalness,_.metalnessMap&&(v.metalnessMap.value=_.metalnessMap,i(_.metalnessMap,v.metalnessMapTransform)),v.roughness.value=_.roughness,_.roughnessMap&&(v.roughnessMap.value=_.roughnessMap,i(_.roughnessMap,v.roughnessMapTransform)),_.envMap&&(v.envMapIntensity.value=_.envMapIntensity)}function g(v,_,T){v.ior.value=_.ior,_.sheen>0&&(v.sheenColor.value.copy(_.sheenColor).multiplyScalar(_.sheen),v.sheenRoughness.value=_.sheenRoughness,_.sheenColorMap&&(v.sheenColorMap.value=_.sheenColorMap,i(_.sheenColorMap,v.sheenColorMapTransform)),_.sheenRoughnessMap&&(v.sheenRoughnessMap.value=_.sheenRoughnessMap,i(_.sheenRoughnessMap,v.sheenRoughnessMapTransform))),_.clearcoat>0&&(v.clearcoat.value=_.clearcoat,v.clearcoatRoughness.value=_.clearcoatRoughness,_.clearcoatMap&&(v.clearcoatMap.value=_.clearcoatMap,i(_.clearcoatMap,v.clearcoatMapTransform)),_.clearcoatRoughnessMap&&(v.clearcoatRoughnessMap.value=_.clearcoatRoughnessMap,i(_.clearcoatRoughnessMap,v.clearcoatRoughnessMapTransform)),_.clearcoatNormalMap&&(v.clearcoatNormalMap.value=_.clearcoatNormalMap,i(_.clearcoatNormalMap,v.clearcoatNormalMapTransform),v.clearcoatNormalScale.value.copy(_.clearcoatNormalScale),_.side===vo&&v.clearcoatNormalScale.value.negate())),_.dispersion>0&&(v.dispersion.value=_.dispersion),_.iridescence>0&&(v.iridescence.value=_.iridescence,v.iridescenceIOR.value=_.iridescenceIOR,v.iridescenceThicknessMinimum.value=_.iridescenceThicknessRange[0],v.iridescenceThicknessMaximum.value=_.iridescenceThicknessRange[1],_.iridescenceMap&&(v.iridescenceMap.value=_.iridescenceMap,i(_.iridescenceMap,v.iridescenceMapTransform)),_.iridescenceThicknessMap&&(v.iridescenceThicknessMap.value=_.iridescenceThicknessMap,i(_.iridescenceThicknessMap,v.iridescenceThicknessMapTransform))),_.transmission>0&&(v.transmission.value=_.transmission,v.transmissionSamplerMap.value=T.texture,v.transmissionSamplerSize.value.set(T.width,T.height),_.transmissionMap&&(v.transmissionMap.value=_.transmissionMap,i(_.transmissionMap,v.transmissionMapTransform)),v.thickness.value=_.thickness,_.thicknessMap&&(v.thicknessMap.value=_.thicknessMap,i(_.thicknessMap,v.thicknessMapTransform)),v.attenuationDistance.value=_.attenuationDistance,v.attenuationColor.value.copy(_.attenuationColor)),_.anisotropy>0&&(v.anisotropyVector.value.set(_.anisotropy*Math.cos(_.anisotropyRotation),_.anisotropy*Math.sin(_.anisotropyRotation)),_.anisotropyMap&&(v.anisotropyMap.value=_.anisotropyMap,i(_.anisotropyMap,v.anisotropyMapTransform))),v.specularIntensity.value=_.specularIntensity,v.specularColor.value.copy(_.specularColor),_.specularColorMap&&(v.specularColorMap.value=_.specularColorMap,i(_.specularColorMap,v.specularColorMapTransform)),_.specularIntensityMap&&(v.specularIntensityMap.value=_.specularIntensityMap,i(_.specularIntensityMap,v.specularIntensityMapTransform))}function y(v,_){_.matcap&&(v.matcap.value=_.matcap)}function x(v,_){const T=e.get(_).light;v.referencePosition.value.setFromMatrixPosition(T.matrixWorld),v.nearDistance.value=T.shadow.camera.near,v.farDistance.value=T.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:s}}function Tie(r,e,i,n){let s={},o={},l=[];const u=r.getParameter(r.MAX_UNIFORM_BUFFER_BINDINGS);function c(T,w){const S=w.program;n.uniformBlockBinding(T,S)}function h(T,w){let S=s[T.id];S===void 0&&(y(T),S=p(T),s[T.id]=S,T.addEventListener("dispose",v));const R=w.program;n.updateUBOMapping(T,R);const B=e.render.frame;o[T.id]!==B&&(m(T),o[T.id]=B)}function p(T){const w=f();T.__bindingPointIndex=w;const S=r.createBuffer(),R=T.__size,B=T.usage;return r.bindBuffer(r.UNIFORM_BUFFER,S),r.bufferData(r.UNIFORM_BUFFER,R,B),r.bindBuffer(r.UNIFORM_BUFFER,null),r.bindBufferBase(r.UNIFORM_BUFFER,w,S),S}function f(){for(let T=0;T<u;T++)if(l.indexOf(T)===-1)return l.push(T),T;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function m(T){const w=s[T.id],S=T.uniforms,R=T.__cache;r.bindBuffer(r.UNIFORM_BUFFER,w);for(let B=0,I=S.length;B<I;B++){const D=Array.isArray(S[B])?S[B]:[S[B]];for(let L=0,O=D.length;L<O;L++){const U=D[L];if(g(U,B,L,R)===!0){const Z=U.__offset,G=Array.isArray(U.value)?U.value:[U.value];let z=0;for(let $=0;$<G.length;$++){const Q=G[$],H=x(Q);typeof Q=="number"||typeof Q=="boolean"?(U.__data[0]=Q,r.bufferSubData(r.UNIFORM_BUFFER,Z+z,U.__data)):Q.isMatrix3?(U.__data[0]=Q.elements[0],U.__data[1]=Q.elements[1],U.__data[2]=Q.elements[2],U.__data[3]=0,U.__data[4]=Q.elements[3],U.__data[5]=Q.elements[4],U.__data[6]=Q.elements[5],U.__data[7]=0,U.__data[8]=Q.elements[6],U.__data[9]=Q.elements[7],U.__data[10]=Q.elements[8],U.__data[11]=0):(Q.toArray(U.__data,z),z+=H.storage/Float32Array.BYTES_PER_ELEMENT)}r.bufferSubData(r.UNIFORM_BUFFER,Z,U.__data)}}}r.bindBuffer(r.UNIFORM_BUFFER,null)}function g(T,w,S,R){const B=T.value,I=w+"_"+S;if(R[I]===void 0)return typeof B=="number"||typeof B=="boolean"?R[I]=B:R[I]=B.clone(),!0;{const D=R[I];if(typeof B=="number"||typeof B=="boolean"){if(D!==B)return R[I]=B,!0}else if(D.equals(B)===!1)return D.copy(B),!0}return!1}function y(T){const w=T.uniforms;let S=0;const R=16;for(let I=0,D=w.length;I<D;I++){const L=Array.isArray(w[I])?w[I]:[w[I]];for(let O=0,U=L.length;O<U;O++){const Z=L[O],G=Array.isArray(Z.value)?Z.value:[Z.value];for(let z=0,$=G.length;z<$;z++){const Q=G[z],H=x(Q),V=S%R,ne=V%H.boundary,Y=V+ne;S+=ne,Y!==0&&R-Y<H.storage&&(S+=R-Y),Z.__data=new Float32Array(H.storage/Float32Array.BYTES_PER_ELEMENT),Z.__offset=S,S+=H.storage}}}const B=S%R;return B>0&&(S+=R-B),T.__size=S,T.__cache={},this}function x(T){const w={boundary:0,storage:0};return typeof T=="number"||typeof T=="boolean"?(w.boundary=4,w.storage=4):T.isVector2?(w.boundary=8,w.storage=8):T.isVector3||T.isColor?(w.boundary=16,w.storage=12):T.isVector4?(w.boundary=16,w.storage=16):T.isMatrix3?(w.boundary=48,w.storage=48):T.isMatrix4?(w.boundary=64,w.storage=64):T.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",T),w}function v(T){const w=T.target;w.removeEventListener("dispose",v);const S=l.indexOf(w.__bindingPointIndex);l.splice(S,1),r.deleteBuffer(s[w.id]),delete s[w.id],delete o[w.id]}function _(){for(const T in s)r.deleteBuffer(s[T]);l=[],s={},o={}}return{bind:c,update:h,dispose:_}}class Mie{constructor(e={}){const{canvas:i=AJ(),context:n=null,depth:s=!0,stencil:o=!1,alpha:l=!1,antialias:u=!1,premultipliedAlpha:c=!0,preserveDrawingBuffer:h=!1,powerPreference:p="default",failIfMajorPerformanceCaveat:f=!1,reverseDepthBuffer:m=!1}=e;this.isWebGLRenderer=!0;let g;if(n!==null){if(typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");g=n.getContextAttributes().alpha}else g=l;const y=new Uint32Array(4),x=new Int32Array(4);let v=null,_=null;const T=[],w=[];this.domElement=i,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=zo,this.toneMapping=Vh,this.toneMappingExposure=1;const S=this;let R=!1,B=0,I=0,D=null,L=-1,O=null;const U=new Js,Z=new Js;let G=null;const z=new Tn(0);let $=0,Q=i.width,H=i.height,V=1,ne=null,Y=null;const ae=new Js(0,0,Q,H),xe=new Js(0,0,Q,H);let fe=!1;const de=new GS;let Ie=!1,Ge=!1;const Xe=new As,$e=new As,lt=new at,At=new Js,Gt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let gt=!1;function xi(){return D===null?V:1}let Ze=n;function Ui(Be,se){return i.getContext(Be,se)}try{const Be={alpha:!0,depth:s,stencil:o,antialias:u,premultipliedAlpha:c,preserveDrawingBuffer:h,powerPreference:p,failIfMajorPerformanceCaveat:f};if("setAttribute"in i&&i.setAttribute("data-engine",`three.js r${Zx}`),i.addEventListener("webglcontextlost",dt,!1),i.addEventListener("webglcontextrestored",It,!1),i.addEventListener("webglcontextcreationerror",bt,!1),Ze===null){const se="webgl2";if(Ze=Ui(se,Be),Ze===null)throw Ui(se)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(Be){throw console.error("THREE.WebGLRenderer: "+Be.message),Be}let di,Ii,Ti,ir,Gi,Qe,Ce,yt,Ot,Jt,zt,_i,vt,ye,ve,Le,Te,ke,Pe,F,J,ie,Re,ce;function Ue(){di=new Lee(Ze),di.init(),ie=new yie(Ze,di),Ii=new Tee(Ze,di,e,ie),Ti=new mie(Ze,di),Ii.reverseDepthBuffer&&m&&Ti.buffers.depth.setReversed(!0),ir=new Pee(Ze),Gi=new eie,Qe=new Aie(Ze,di,Ti,Gi,Ii,ie,ir),Ce=new Ree(S),yt=new Nee(S),Ot=new GJ(Ze),Re=new Cee(Ze,Ot),Jt=new Dee(Ze,Ot,ir,Re),zt=new Fee(Ze,Jt,Ot,ir),Pe=new kee(Ze,Ii,Qe),Le=new Mee(Gi),_i=new $te(S,Ce,yt,di,Ii,Re,Le),vt=new Sie(S,Gi),ye=new iie,ve=new lie(di),ke=new wee(S,Ce,yt,Ti,zt,g,c),Te=new pie(S,zt,Ii),ce=new Tie(Ze,ir,Ii,Ti),F=new See(Ze,di,ir),J=new Oee(Ze,di,ir),ir.programs=_i.programs,S.capabilities=Ii,S.extensions=di,S.properties=Gi,S.renderLists=ye,S.shadowMap=Te,S.state=Ti,S.info=ir}Ue();const je=new wie(S,Ze);this.xr=je,this.getContext=function(){return Ze},this.getContextAttributes=function(){return Ze.getContextAttributes()},this.forceContextLoss=function(){const Be=di.get("WEBGL_lose_context");Be&&Be.loseContext()},this.forceContextRestore=function(){const Be=di.get("WEBGL_lose_context");Be&&Be.restoreContext()},this.getPixelRatio=function(){return V},this.setPixelRatio=function(Be){Be!==void 0&&(V=Be,this.setSize(Q,H,!1))},this.getSize=function(Be){return Be.set(Q,H)},this.setSize=function(Be,se,ge=!0){if(je.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Q=Be,H=se,i.width=Math.floor(Be*V),i.height=Math.floor(se*V),ge===!0&&(i.style.width=Be+"px",i.style.height=se+"px"),this.setViewport(0,0,Be,se)},this.getDrawingBufferSize=function(Be){return Be.set(Q*V,H*V).floor()},this.setDrawingBufferSize=function(Be,se,ge){Q=Be,H=se,V=ge,i.width=Math.floor(Be*ge),i.height=Math.floor(se*ge),this.setViewport(0,0,Be,se)},this.getCurrentViewport=function(Be){return Be.copy(U)},this.getViewport=function(Be){return Be.copy(ae)},this.setViewport=function(Be,se,ge,Ne){Be.isVector4?ae.set(Be.x,Be.y,Be.z,Be.w):ae.set(Be,se,ge,Ne),Ti.viewport(U.copy(ae).multiplyScalar(V).round())},this.getScissor=function(Be){return Be.copy(xe)},this.setScissor=function(Be,se,ge,Ne){Be.isVector4?xe.set(Be.x,Be.y,Be.z,Be.w):xe.set(Be,se,ge,Ne),Ti.scissor(Z.copy(xe).multiplyScalar(V).round())},this.getScissorTest=function(){return fe},this.setScissorTest=function(Be){Ti.setScissorTest(fe=Be)},this.setOpaqueSort=function(Be){ne=Be},this.setTransparentSort=function(Be){Y=Be},this.getClearColor=function(Be){return Be.copy(ke.getClearColor())},this.setClearColor=function(){ke.setClearColor.apply(ke,arguments)},this.getClearAlpha=function(){return ke.getClearAlpha()},this.setClearAlpha=function(){ke.setClearAlpha.apply(ke,arguments)},this.clear=function(Be=!0,se=!0,ge=!0){let Ne=0;if(Be){let Fe=!1;if(D!==null){const Ke=D.texture.format;Fe=Ke===QC||Ke===WC||Ke===HC}if(Fe){const Ke=D.texture.type,ot=Ke===_u||Ke===cp||Ke===pA||Ke===gm||Ke===VC||Ke===GC,wt=ke.getClearColor(),qt=ke.getClearAlpha(),Kt=wt.r,Mt=wt.g,ti=wt.b;ot?(y[0]=Kt,y[1]=Mt,y[2]=ti,y[3]=qt,Ze.clearBufferuiv(Ze.COLOR,0,y)):(x[0]=Kt,x[1]=Mt,x[2]=ti,x[3]=qt,Ze.clearBufferiv(Ze.COLOR,0,x))}else Ne|=Ze.COLOR_BUFFER_BIT}se&&(Ne|=Ze.DEPTH_BUFFER_BIT),ge&&(Ne|=Ze.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Ze.clear(Ne)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){i.removeEventListener("webglcontextlost",dt,!1),i.removeEventListener("webglcontextrestored",It,!1),i.removeEventListener("webglcontextcreationerror",bt,!1),ye.dispose(),ve.dispose(),Gi.dispose(),Ce.dispose(),yt.dispose(),zt.dispose(),Re.dispose(),ce.dispose(),_i.dispose(),je.dispose(),je.removeEventListener("sessionstart",sn),je.removeEventListener("sessionend",xs),yn.stop()};function dt(Be){Be.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),R=!0}function It(){console.log("THREE.WebGLRenderer: Context Restored."),R=!1;const Be=ir.autoReset,se=Te.enabled,ge=Te.autoUpdate,Ne=Te.needsUpdate,Fe=Te.type;Ue(),ir.autoReset=Be,Te.enabled=se,Te.autoUpdate=ge,Te.needsUpdate=Ne,Te.type=Fe}function bt(Be){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",Be.statusMessage)}function Ut(Be){const se=Be.target;se.removeEventListener("dispose",Ut),pi(se)}function pi(Be){Er(Be),Gi.remove(Be)}function Er(Be){const se=Gi.get(Be).programs;se!==void 0&&(se.forEach(function(ge){_i.releaseProgram(ge)}),Be.isShaderMaterial&&_i.releaseShaderCache(Be))}this.renderBufferDirect=function(Be,se,ge,Ne,Fe,Ke){se===null&&(se=Gt);const ot=Fe.isMesh&&Fe.matrixWorld.determinant()<0,wt=ar(Be,se,ge,Ne,Fe);Ti.setMaterial(Ne,ot);let qt=ge.index,Kt=1;if(Ne.wireframe===!0){if(qt=Jt.getWireframeAttribute(ge),qt===void 0)return;Kt=2}const Mt=ge.drawRange,ti=ge.attributes.position;let Ei=Mt.start*Kt,Fi=(Mt.start+Mt.count)*Kt;Ke!==null&&(Ei=Math.max(Ei,Ke.start*Kt),Fi=Math.min(Fi,(Ke.start+Ke.count)*Kt)),qt!==null?(Ei=Math.max(Ei,0),Fi=Math.min(Fi,qt.count)):ti!=null&&(Ei=Math.max(Ei,0),Fi=Math.min(Fi,ti.count));const Tr=Fi-Ei;if(Tr<0||Tr===1/0)return;Re.setup(Fe,Ne,wt,ge,qt);let hr,Zi=F;if(qt!==null&&(hr=Ot.get(qt),Zi=J,Zi.setIndex(hr)),Fe.isMesh)Ne.wireframe===!0?(Ti.setLineWidth(Ne.wireframeLinewidth*xi()),Zi.setMode(Ze.LINES)):Zi.setMode(Ze.TRIANGLES);else if(Fe.isLine){let bi=Ne.linewidth;bi===void 0&&(bi=1),Ti.setLineWidth(bi*xi()),Fe.isLineSegments?Zi.setMode(Ze.LINES):Fe.isLineLoop?Zi.setMode(Ze.LINE_LOOP):Zi.setMode(Ze.LINE_STRIP)}else Fe.isPoints?Zi.setMode(Ze.POINTS):Fe.isSprite&&Zi.setMode(Ze.TRIANGLES);if(Fe.isBatchedMesh)if(Fe._multiDrawInstances!==null)Zi.renderMultiDrawInstances(Fe._multiDrawStarts,Fe._multiDrawCounts,Fe._multiDrawCount,Fe._multiDrawInstances);else if(di.get("WEBGL_multi_draw"))Zi.renderMultiDraw(Fe._multiDrawStarts,Fe._multiDrawCounts,Fe._multiDrawCount);else{const bi=Fe._multiDrawStarts,Bn=Fe._multiDrawCounts,Jn=Fe._multiDrawCount,Ri=qt?Ot.get(qt).bytesPerElement:1,or=Gi.get(Ne).currentProgram.getUniforms();for(let pn=0;pn<Jn;pn++)or.setValue(Ze,"_gl_DrawID",pn),Zi.render(bi[pn]/Ri,Bn[pn])}else if(Fe.isInstancedMesh)Zi.renderInstances(Ei,Tr,Fe.count);else if(ge.isInstancedBufferGeometry){const bi=ge._maxInstanceCount!==void 0?ge._maxInstanceCount:1/0,Bn=Math.min(ge.instanceCount,bi);Zi.renderInstances(Ei,Tr,Bn)}else Zi.render(Ei,Tr)};function ki(Be,se,ge){Be.transparent===!0&&Be.side===xu&&Be.forceSinglePass===!1?(Be.side=vo,Be.needsUpdate=!0,St(Be,se,ge),Be.side=jh,Be.needsUpdate=!0,St(Be,se,ge),Be.side=xu):St(Be,se,ge)}this.compile=function(Be,se,ge=null){ge===null&&(ge=Be),_=ve.get(ge),_.init(se),w.push(_),ge.traverseVisible(function(Fe){Fe.isLight&&Fe.layers.test(se.layers)&&(_.pushLight(Fe),Fe.castShadow&&_.pushShadow(Fe))}),Be!==ge&&Be.traverseVisible(function(Fe){Fe.isLight&&Fe.layers.test(se.layers)&&(_.pushLight(Fe),Fe.castShadow&&_.pushShadow(Fe))}),_.setupLights();const Ne=new Set;return Be.traverse(function(Fe){if(!(Fe.isMesh||Fe.isPoints||Fe.isLine||Fe.isSprite))return;const Ke=Fe.material;if(Ke)if(Array.isArray(Ke))for(let ot=0;ot<Ke.length;ot++){const wt=Ke[ot];ki(wt,ge,Fe),Ne.add(wt)}else ki(Ke,ge,Fe),Ne.add(Ke)}),w.pop(),_=null,Ne},this.compileAsync=function(Be,se,ge=null){const Ne=this.compile(Be,se,ge);return new Promise(Fe=>{function Ke(){if(Ne.forEach(function(ot){Gi.get(ot).currentProgram.isReady()&&Ne.delete(ot)}),Ne.size===0){Fe(Be);return}setTimeout(Ke,10)}di.get("KHR_parallel_shader_compile")!==null?Ke():setTimeout(Ke,10)})};let An=null;function Ur(Be){An&&An(Be)}function sn(){yn.stop()}function xs(){yn.start()}const yn=new hk;yn.setAnimationLoop(Ur),typeof self<"u"&&yn.setContext(self),this.setAnimationLoop=function(Be){An=Be,je.setAnimationLoop(Be),Be===null?yn.stop():yn.start()},je.addEventListener("sessionstart",sn),je.addEventListener("sessionend",xs),this.render=function(Be,se){if(se!==void 0&&se.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(R===!0)return;if(Be.matrixWorldAutoUpdate===!0&&Be.updateMatrixWorld(),se.parent===null&&se.matrixWorldAutoUpdate===!0&&se.updateMatrixWorld(),je.enabled===!0&&je.isPresenting===!0&&(je.cameraAutoUpdate===!0&&je.updateCamera(se),se=je.getCamera()),Be.isScene===!0&&Be.onBeforeRender(S,Be,se,D),_=ve.get(Be,w.length),_.init(se),w.push(_),$e.multiplyMatrices(se.projectionMatrix,se.matrixWorldInverse),de.setFromProjectionMatrix($e),Ge=this.localClippingEnabled,Ie=Le.init(this.clippingPlanes,Ge),v=ye.get(Be,T.length),v.init(),T.push(v),je.enabled===!0&&je.isPresenting===!0){const Ke=S.xr.getDepthSensingMesh();Ke!==null&&Ls(Ke,se,-1/0,S.sortObjects)}Ls(Be,se,0,S.sortObjects),v.finish(),S.sortObjects===!0&&v.sort(ne,Y),gt=je.enabled===!1||je.isPresenting===!1||je.hasDepthSensing()===!1,gt&&ke.addToRenderList(v,Be),this.info.render.frame++,Ie===!0&&Le.beginShadows();const ge=_.state.shadowsArray;Te.render(ge,Be,se),Ie===!0&&Le.endShadows(),this.info.autoReset===!0&&this.info.reset();const Ne=v.opaque,Fe=v.transmissive;if(_.setupLights(),se.isArrayCamera){const Ke=se.cameras;if(Fe.length>0)for(let ot=0,wt=Ke.length;ot<wt;ot++){const qt=Ke[ot];bs(Ne,Fe,Be,qt)}gt&&ke.render(Be);for(let ot=0,wt=Ke.length;ot<wt;ot++){const qt=Ke[ot];rs(v,Be,qt,qt.viewport)}}else Fe.length>0&&bs(Ne,Fe,Be,se),gt&&ke.render(Be),rs(v,Be,se);D!==null&&(Qe.updateMultisampleRenderTarget(D),Qe.updateRenderTargetMipmap(D)),Be.isScene===!0&&Be.onAfterRender(S,Be,se),Re.resetDefaultState(),L=-1,O=null,w.pop(),w.length>0?(_=w[w.length-1],Ie===!0&&Le.setGlobalState(S.clippingPlanes,_.state.camera)):_=null,T.pop(),T.length>0?v=T[T.length-1]:v=null};function Ls(Be,se,ge,Ne){if(Be.visible===!1)return;if(Be.layers.test(se.layers)){if(Be.isGroup)ge=Be.renderOrder;else if(Be.isLOD)Be.autoUpdate===!0&&Be.update(se);else if(Be.isLight)_.pushLight(Be),Be.castShadow&&_.pushShadow(Be);else if(Be.isSprite){if(!Be.frustumCulled||de.intersectsSprite(Be)){Ne&&At.setFromMatrixPosition(Be.matrixWorld).applyMatrix4($e);const Ke=zt.update(Be),ot=Be.material;ot.visible&&v.push(Be,Ke,ot,ge,At.z,null)}}else if((Be.isMesh||Be.isLine||Be.isPoints)&&(!Be.frustumCulled||de.intersectsObject(Be))){const Ke=zt.update(Be),ot=Be.material;if(Ne&&(Be.boundingSphere!==void 0?(Be.boundingSphere===null&&Be.computeBoundingSphere(),At.copy(Be.boundingSphere.center)):(Ke.boundingSphere===null&&Ke.computeBoundingSphere(),At.copy(Ke.boundingSphere.center)),At.applyMatrix4(Be.matrixWorld).applyMatrix4($e)),Array.isArray(ot)){const wt=Ke.groups;for(let qt=0,Kt=wt.length;qt<Kt;qt++){const Mt=wt[qt],ti=ot[Mt.materialIndex];ti&&ti.visible&&v.push(Be,Ke,ti,ge,At.z,Mt)}}else ot.visible&&v.push(Be,Ke,ot,ge,At.z,null)}}const Fe=Be.children;for(let Ke=0,ot=Fe.length;Ke<ot;Ke++)Ls(Fe[Ke],se,ge,Ne)}function rs(Be,se,ge,Ne){const Fe=Be.opaque,Ke=Be.transmissive,ot=Be.transparent;_.setupLightsView(ge),Ie===!0&&Le.setGlobalState(S.clippingPlanes,ge),Ne&&Ti.viewport(U.copy(Ne)),Fe.length>0&&me(Fe,se,ge),Ke.length>0&&me(Ke,se,ge),ot.length>0&&me(ot,se,ge),Ti.buffers.depth.setTest(!0),Ti.buffers.depth.setMask(!0),Ti.buffers.color.setMask(!0),Ti.setPolygonOffset(!1)}function bs(Be,se,ge,Ne){if((ge.isScene===!0?ge.overrideMaterial:null)!==null)return;_.state.transmissionRenderTarget[Ne.id]===void 0&&(_.state.transmissionRenderTarget[Ne.id]=new Hh(1,1,{generateMipmaps:!0,type:di.has("EXT_color_buffer_half_float")||di.has("EXT_color_buffer_float")?mm:_u,minFilter:lp,samples:4,stencilBuffer:o,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:zn.workingColorSpace}));const Fe=_.state.transmissionRenderTarget[Ne.id],Ke=Ne.viewport||U;Fe.setSize(Ke.z,Ke.w);const ot=S.getRenderTarget();S.setRenderTarget(Fe),S.getClearColor(z),$=S.getClearAlpha(),$<1&&S.setClearColor(16777215,.5),S.clear(),gt&&ke.render(ge);const wt=S.toneMapping;S.toneMapping=Vh;const qt=Ne.viewport;if(Ne.viewport!==void 0&&(Ne.viewport=void 0),_.setupLightsView(Ne),Ie===!0&&Le.setGlobalState(S.clippingPlanes,Ne),me(Be,ge,Ne),Qe.updateMultisampleRenderTarget(Fe),Qe.updateRenderTargetMipmap(Fe),di.has("WEBGL_multisampled_render_to_texture")===!1){let Kt=!1;for(let Mt=0,ti=se.length;Mt<ti;Mt++){const Ei=se[Mt],Fi=Ei.object,Tr=Ei.geometry,hr=Ei.material,Zi=Ei.group;if(hr.side===xu&&Fi.layers.test(Ne.layers)){const bi=hr.side;hr.side=vo,hr.needsUpdate=!0,ct(Fi,ge,Ne,Tr,hr,Zi),hr.side=bi,hr.needsUpdate=!0,Kt=!0}}Kt===!0&&(Qe.updateMultisampleRenderTarget(Fe),Qe.updateRenderTargetMipmap(Fe))}S.setRenderTarget(ot),S.setClearColor(z,$),qt!==void 0&&(Ne.viewport=qt),S.toneMapping=wt}function me(Be,se,ge){const Ne=se.isScene===!0?se.overrideMaterial:null;for(let Fe=0,Ke=Be.length;Fe<Ke;Fe++){const ot=Be[Fe],wt=ot.object,qt=ot.geometry,Kt=Ne===null?ot.material:Ne,Mt=ot.group;wt.layers.test(ge.layers)&&ct(wt,se,ge,qt,Kt,Mt)}}function ct(Be,se,ge,Ne,Fe,Ke){Be.onBeforeRender(S,se,ge,Ne,Fe,Ke),Be.modelViewMatrix.multiplyMatrices(ge.matrixWorldInverse,Be.matrixWorld),Be.normalMatrix.getNormalMatrix(Be.modelViewMatrix),Fe.onBeforeRender(S,se,ge,Ne,Be,Ke),Fe.transparent===!0&&Fe.side===xu&&Fe.forceSinglePass===!1?(Fe.side=vo,Fe.needsUpdate=!0,S.renderBufferDirect(ge,se,Ne,Fe,Be,Ke),Fe.side=jh,Fe.needsUpdate=!0,S.renderBufferDirect(ge,se,Ne,Fe,Be,Ke),Fe.side=xu):S.renderBufferDirect(ge,se,Ne,Fe,Be,Ke),Be.onAfterRender(S,se,ge,Ne,Fe,Ke)}function St(Be,se,ge){se.isScene!==!0&&(se=Gt);const Ne=Gi.get(Be),Fe=_.state.lights,Ke=_.state.shadowsArray,ot=Fe.state.version,wt=_i.getParameters(Be,Fe.state,Ke,se,ge),qt=_i.getProgramCacheKey(wt);let Kt=Ne.programs;Ne.environment=Be.isMeshStandardMaterial?se.environment:null,Ne.fog=se.fog,Ne.envMap=(Be.isMeshStandardMaterial?yt:Ce).get(Be.envMap||Ne.environment),Ne.envMapRotation=Ne.environment!==null&&Be.envMap===null?se.environmentRotation:Be.envMapRotation,Kt===void 0&&(Be.addEventListener("dispose",Ut),Kt=new Map,Ne.programs=Kt);let Mt=Kt.get(qt);if(Mt!==void 0){if(Ne.currentProgram===Mt&&Ne.lightsStateVersion===ot)return Bi(Be,wt),Mt}else wt.uniforms=_i.getUniforms(Be),Be.onBeforeCompile(wt,S),Mt=_i.acquireProgram(wt,qt),Kt.set(qt,Mt),Ne.uniforms=wt.uniforms;const ti=Ne.uniforms;return(!Be.isShaderMaterial&&!Be.isRawShaderMaterial||Be.clipping===!0)&&(ti.clippingPlanes=Le.uniform),Bi(Be,wt),Ne.needsLights=Pi(Be),Ne.lightsStateVersion=ot,Ne.needsLights&&(ti.ambientLightColor.value=Fe.state.ambient,ti.lightProbe.value=Fe.state.probe,ti.directionalLights.value=Fe.state.directional,ti.directionalLightShadows.value=Fe.state.directionalShadow,ti.spotLights.value=Fe.state.spot,ti.spotLightShadows.value=Fe.state.spotShadow,ti.rectAreaLights.value=Fe.state.rectArea,ti.ltc_1.value=Fe.state.rectAreaLTC1,ti.ltc_2.value=Fe.state.rectAreaLTC2,ti.pointLights.value=Fe.state.point,ti.pointLightShadows.value=Fe.state.pointShadow,ti.hemisphereLights.value=Fe.state.hemi,ti.directionalShadowMap.value=Fe.state.directionalShadowMap,ti.directionalShadowMatrix.value=Fe.state.directionalShadowMatrix,ti.spotShadowMap.value=Fe.state.spotShadowMap,ti.spotLightMatrix.value=Fe.state.spotLightMatrix,ti.spotLightMap.value=Fe.state.spotLightMap,ti.pointShadowMap.value=Fe.state.pointShadowMap,ti.pointShadowMatrix.value=Fe.state.pointShadowMatrix),Ne.currentProgram=Mt,Ne.uniformsList=null,Mt}function Xt(Be){if(Be.uniformsList===null){const se=Be.currentProgram.getUniforms();Be.uniformsList=Bb.seqWithValue(se.seq,Be.uniforms)}return Be.uniformsList}function Bi(Be,se){const ge=Gi.get(Be);ge.outputColorSpace=se.outputColorSpace,ge.batching=se.batching,ge.batchingColor=se.batchingColor,ge.instancing=se.instancing,ge.instancingColor=se.instancingColor,ge.instancingMorph=se.instancingMorph,ge.skinning=se.skinning,ge.morphTargets=se.morphTargets,ge.morphNormals=se.morphNormals,ge.morphColors=se.morphColors,ge.morphTargetsCount=se.morphTargetsCount,ge.numClippingPlanes=se.numClippingPlanes,ge.numIntersection=se.numClipIntersection,ge.vertexAlphas=se.vertexAlphas,ge.vertexTangents=se.vertexTangents,ge.toneMapping=se.toneMapping}function ar(Be,se,ge,Ne,Fe){se.isScene!==!0&&(se=Gt),Qe.resetTextureUnits();const Ke=se.fog,ot=Ne.isMeshStandardMaterial?se.environment:null,wt=D===null?S.outputColorSpace:D.isXRRenderTarget===!0?D.texture.colorSpace:vm,qt=(Ne.isMeshStandardMaterial?yt:Ce).get(Ne.envMap||ot),Kt=Ne.vertexColors===!0&&!!ge.attributes.color&&ge.attributes.color.itemSize===4,Mt=!!ge.attributes.tangent&&(!!Ne.normalMap||Ne.anisotropy>0),ti=!!ge.morphAttributes.position,Ei=!!ge.morphAttributes.normal,Fi=!!ge.morphAttributes.color;let Tr=Vh;Ne.toneMapped&&(D===null||D.isXRRenderTarget===!0)&&(Tr=S.toneMapping);const hr=ge.morphAttributes.position||ge.morphAttributes.normal||ge.morphAttributes.color,Zi=hr!==void 0?hr.length:0,bi=Gi.get(Ne),Bn=_.state.lights;if(Ie===!0&&(Ge===!0||Be!==O)){const Se=Be===O&&Ne.id===L;Le.setState(Ne,Be,Se)}let Jn=!1;Ne.version===bi.__version?(bi.needsLights&&bi.lightsStateVersion!==Bn.state.version||bi.outputColorSpace!==wt||Fe.isBatchedMesh&&bi.batching===!1||!Fe.isBatchedMesh&&bi.batching===!0||Fe.isBatchedMesh&&bi.batchingColor===!0&&Fe.colorTexture===null||Fe.isBatchedMesh&&bi.batchingColor===!1&&Fe.colorTexture!==null||Fe.isInstancedMesh&&bi.instancing===!1||!Fe.isInstancedMesh&&bi.instancing===!0||Fe.isSkinnedMesh&&bi.skinning===!1||!Fe.isSkinnedMesh&&bi.skinning===!0||Fe.isInstancedMesh&&bi.instancingColor===!0&&Fe.instanceColor===null||Fe.isInstancedMesh&&bi.instancingColor===!1&&Fe.instanceColor!==null||Fe.isInstancedMesh&&bi.instancingMorph===!0&&Fe.morphTexture===null||Fe.isInstancedMesh&&bi.instancingMorph===!1&&Fe.morphTexture!==null||bi.envMap!==qt||Ne.fog===!0&&bi.fog!==Ke||bi.numClippingPlanes!==void 0&&(bi.numClippingPlanes!==Le.numPlanes||bi.numIntersection!==Le.numIntersection)||bi.vertexAlphas!==Kt||bi.vertexTangents!==Mt||bi.morphTargets!==ti||bi.morphNormals!==Ei||bi.morphColors!==Fi||bi.toneMapping!==Tr||bi.morphTargetsCount!==Zi)&&(Jn=!0):(Jn=!0,bi.__version=Ne.version);let Ri=bi.currentProgram;Jn===!0&&(Ri=St(Ne,se,Fe));let or=!1,pn=!1,Yr=!1;const W=Ri.getUniforms(),ue=bi.uniforms;if(Ti.useProgram(Ri.program)&&(or=!0,pn=!0,Yr=!0),Ne.id!==L&&(L=Ne.id,pn=!0),or||O!==Be){Ti.buffers.depth.getReversed()?(Xe.copy(Be.projectionMatrix),vJ(Xe),xJ(Xe),W.setValue(Ze,"projectionMatrix",Xe)):W.setValue(Ze,"projectionMatrix",Be.projectionMatrix),W.setValue(Ze,"viewMatrix",Be.matrixWorldInverse);const Se=W.map.cameraPosition;Se!==void 0&&Se.setValue(Ze,lt.setFromMatrixPosition(Be.matrixWorld)),Ii.logarithmicDepthBuffer&&W.setValue(Ze,"logDepthBufFC",2/(Math.log(Be.far+1)/Math.LN2)),(Ne.isMeshPhongMaterial||Ne.isMeshToonMaterial||Ne.isMeshLambertMaterial||Ne.isMeshBasicMaterial||Ne.isMeshStandardMaterial||Ne.isShaderMaterial)&&W.setValue(Ze,"isOrthographic",Be.isOrthographicCamera===!0),O!==Be&&(O=Be,pn=!0,Yr=!0)}if(Fe.isSkinnedMesh){W.setOptional(Ze,Fe,"bindMatrix"),W.setOptional(Ze,Fe,"bindMatrixInverse");const Se=Fe.skeleton;Se&&(Se.boneTexture===null&&Se.computeBoneTexture(),W.setValue(Ze,"boneTexture",Se.boneTexture,Qe))}Fe.isBatchedMesh&&(W.setOptional(Ze,Fe,"batchingTexture"),W.setValue(Ze,"batchingTexture",Fe._matricesTexture,Qe),W.setOptional(Ze,Fe,"batchingIdTexture"),W.setValue(Ze,"batchingIdTexture",Fe._indirectTexture,Qe),W.setOptional(Ze,Fe,"batchingColorTexture"),Fe._colorsTexture!==null&&W.setValue(Ze,"batchingColorTexture",Fe._colorsTexture,Qe));const Ae=ge.morphAttributes;if((Ae.position!==void 0||Ae.normal!==void 0||Ae.color!==void 0)&&Pe.update(Fe,ge,Ri),(pn||bi.receiveShadow!==Fe.receiveShadow)&&(bi.receiveShadow=Fe.receiveShadow,W.setValue(Ze,"receiveShadow",Fe.receiveShadow)),Ne.isMeshGouraudMaterial&&Ne.envMap!==null&&(ue.envMap.value=qt,ue.flipEnvMap.value=qt.isCubeTexture&&qt.isRenderTargetTexture===!1?-1:1),Ne.isMeshStandardMaterial&&Ne.envMap===null&&se.environment!==null&&(ue.envMapIntensity.value=se.environmentIntensity),pn&&(W.setValue(Ze,"toneMappingExposure",S.toneMappingExposure),bi.needsLights&&Li(ue,Yr),Ke&&Ne.fog===!0&&vt.refreshFogUniforms(ue,Ke),vt.refreshMaterialUniforms(ue,Ne,V,H,_.state.transmissionRenderTarget[Be.id]),Bb.upload(Ze,Xt(bi),ue,Qe)),Ne.isShaderMaterial&&Ne.uniformsNeedUpdate===!0&&(Bb.upload(Ze,Xt(bi),ue,Qe),Ne.uniformsNeedUpdate=!1),Ne.isSpriteMaterial&&W.setValue(Ze,"center",Fe.center),W.setValue(Ze,"modelViewMatrix",Fe.modelViewMatrix),W.setValue(Ze,"normalMatrix",Fe.normalMatrix),W.setValue(Ze,"modelMatrix",Fe.matrixWorld),Ne.isShaderMaterial||Ne.isRawShaderMaterial){const Se=Ne.uniformsGroups;for(let We=0,Ye=Se.length;We<Ye;We++){const ft=Se[We];ce.update(ft,Ri),ce.bind(ft,Ri)}}return Ri}function Li(Be,se){Be.ambientLightColor.needsUpdate=se,Be.lightProbe.needsUpdate=se,Be.directionalLights.needsUpdate=se,Be.directionalLightShadows.needsUpdate=se,Be.pointLights.needsUpdate=se,Be.pointLightShadows.needsUpdate=se,Be.spotLights.needsUpdate=se,Be.spotLightShadows.needsUpdate=se,Be.rectAreaLights.needsUpdate=se,Be.hemisphereLights.needsUpdate=se}function Pi(Be){return Be.isMeshLambertMaterial||Be.isMeshToonMaterial||Be.isMeshPhongMaterial||Be.isMeshStandardMaterial||Be.isShadowMaterial||Be.isShaderMaterial&&Be.lights===!0}this.getActiveCubeFace=function(){return B},this.getActiveMipmapLevel=function(){return I},this.getRenderTarget=function(){return D},this.setRenderTargetTextures=function(Be,se,ge){Gi.get(Be.texture).__webglTexture=se,Gi.get(Be.depthTexture).__webglTexture=ge;const Ne=Gi.get(Be);Ne.__hasExternalTextures=!0,Ne.__autoAllocateDepthBuffer=ge===void 0,Ne.__autoAllocateDepthBuffer||di.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Ne.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(Be,se){const ge=Gi.get(Be);ge.__webglFramebuffer=se,ge.__useDefaultFramebuffer=se===void 0},this.setRenderTarget=function(Be,se=0,ge=0){D=Be,B=se,I=ge;let Ne=!0,Fe=null,Ke=!1,ot=!1;if(Be){const wt=Gi.get(Be);if(wt.__useDefaultFramebuffer!==void 0)Ti.bindFramebuffer(Ze.FRAMEBUFFER,null),Ne=!1;else if(wt.__webglFramebuffer===void 0)Qe.setupRenderTarget(Be);else if(wt.__hasExternalTextures)Qe.rebindTextures(Be,Gi.get(Be.texture).__webglTexture,Gi.get(Be.depthTexture).__webglTexture);else if(Be.depthBuffer){const Mt=Be.depthTexture;if(wt.__boundDepthTexture!==Mt){if(Mt!==null&&Gi.has(Mt)&&(Be.width!==Mt.image.width||Be.height!==Mt.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");Qe.setupDepthRenderbuffer(Be)}}const qt=Be.texture;(qt.isData3DTexture||qt.isDataArrayTexture||qt.isCompressedArrayTexture)&&(ot=!0);const Kt=Gi.get(Be).__webglFramebuffer;Be.isWebGLCubeRenderTarget?(Array.isArray(Kt[se])?Fe=Kt[se][ge]:Fe=Kt[se],Ke=!0):Be.samples>0&&Qe.useMultisampledRTT(Be)===!1?Fe=Gi.get(Be).__webglMultisampledFramebuffer:Array.isArray(Kt)?Fe=Kt[ge]:Fe=Kt,U.copy(Be.viewport),Z.copy(Be.scissor),G=Be.scissorTest}else U.copy(ae).multiplyScalar(V).floor(),Z.copy(xe).multiplyScalar(V).floor(),G=fe;if(Ti.bindFramebuffer(Ze.FRAMEBUFFER,Fe)&&Ne&&Ti.drawBuffers(Be,Fe),Ti.viewport(U),Ti.scissor(Z),Ti.setScissorTest(G),Ke){const wt=Gi.get(Be.texture);Ze.framebufferTexture2D(Ze.FRAMEBUFFER,Ze.COLOR_ATTACHMENT0,Ze.TEXTURE_CUBE_MAP_POSITIVE_X+se,wt.__webglTexture,ge)}else if(ot){const wt=Gi.get(Be.texture),qt=se||0;Ze.framebufferTextureLayer(Ze.FRAMEBUFFER,Ze.COLOR_ATTACHMENT0,wt.__webglTexture,ge||0,qt)}L=-1},this.readRenderTargetPixels=function(Be,se,ge,Ne,Fe,Ke,ot){if(!(Be&&Be.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let wt=Gi.get(Be).__webglFramebuffer;if(Be.isWebGLCubeRenderTarget&&ot!==void 0&&(wt=wt[ot]),wt){Ti.bindFramebuffer(Ze.FRAMEBUFFER,wt);try{const qt=Be.texture,Kt=qt.format,Mt=qt.type;if(!Ii.textureFormatReadable(Kt)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!Ii.textureTypeReadable(Mt)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}se>=0&&se<=Be.width-Ne&&ge>=0&&ge<=Be.height-Fe&&Ze.readPixels(se,ge,Ne,Fe,ie.convert(Kt),ie.convert(Mt),Ke)}finally{const qt=D!==null?Gi.get(D).__webglFramebuffer:null;Ti.bindFramebuffer(Ze.FRAMEBUFFER,qt)}}},this.readRenderTargetPixelsAsync=async function(Be,se,ge,Ne,Fe,Ke,ot){if(!(Be&&Be.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let wt=Gi.get(Be).__webglFramebuffer;if(Be.isWebGLCubeRenderTarget&&ot!==void 0&&(wt=wt[ot]),wt){const qt=Be.texture,Kt=qt.format,Mt=qt.type;if(!Ii.textureFormatReadable(Kt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Ii.textureTypeReadable(Mt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(se>=0&&se<=Be.width-Ne&&ge>=0&&ge<=Be.height-Fe){Ti.bindFramebuffer(Ze.FRAMEBUFFER,wt);const ti=Ze.createBuffer();Ze.bindBuffer(Ze.PIXEL_PACK_BUFFER,ti),Ze.bufferData(Ze.PIXEL_PACK_BUFFER,Ke.byteLength,Ze.STREAM_READ),Ze.readPixels(se,ge,Ne,Fe,ie.convert(Kt),ie.convert(Mt),0);const Ei=D!==null?Gi.get(D).__webglFramebuffer:null;Ti.bindFramebuffer(Ze.FRAMEBUFFER,Ei);const Fi=Ze.fenceSync(Ze.SYNC_GPU_COMMANDS_COMPLETE,0);return Ze.flush(),await yJ(Ze,Fi,4),Ze.bindBuffer(Ze.PIXEL_PACK_BUFFER,ti),Ze.getBufferSubData(Ze.PIXEL_PACK_BUFFER,0,Ke),Ze.deleteBuffer(ti),Ze.deleteSync(Fi),Ke}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}},this.copyFramebufferToTexture=function(Be,se=null,ge=0){Be.isTexture!==!0&&(yA("WebGLRenderer: copyFramebufferToTexture function signature has changed."),se=arguments[0]||null,Be=arguments[1]);const Ne=Math.pow(2,-ge),Fe=Math.floor(Be.image.width*Ne),Ke=Math.floor(Be.image.height*Ne),ot=se!==null?se.x:0,wt=se!==null?se.y:0;Qe.setTexture2D(Be,0),Ze.copyTexSubImage2D(Ze.TEXTURE_2D,ge,0,0,ot,wt,Fe,Ke),Ti.unbindTexture()},this.copyTextureToTexture=function(Be,se,ge=null,Ne=null,Fe=0){Be.isTexture!==!0&&(yA("WebGLRenderer: copyTextureToTexture function signature has changed."),Ne=arguments[0]||null,Be=arguments[1],se=arguments[2],Fe=arguments[3]||0,ge=null);let Ke,ot,wt,qt,Kt,Mt,ti,Ei,Fi;const Tr=Be.isCompressedTexture?Be.mipmaps[Fe]:Be.image;ge!==null?(Ke=ge.max.x-ge.min.x,ot=ge.max.y-ge.min.y,wt=ge.isBox3?ge.max.z-ge.min.z:1,qt=ge.min.x,Kt=ge.min.y,Mt=ge.isBox3?ge.min.z:0):(Ke=Tr.width,ot=Tr.height,wt=Tr.depth||1,qt=0,Kt=0,Mt=0),Ne!==null?(ti=Ne.x,Ei=Ne.y,Fi=Ne.z):(ti=0,Ei=0,Fi=0);const hr=ie.convert(se.format),Zi=ie.convert(se.type);let bi;se.isData3DTexture?(Qe.setTexture3D(se,0),bi=Ze.TEXTURE_3D):se.isDataArrayTexture||se.isCompressedArrayTexture?(Qe.setTexture2DArray(se,0),bi=Ze.TEXTURE_2D_ARRAY):(Qe.setTexture2D(se,0),bi=Ze.TEXTURE_2D),Ze.pixelStorei(Ze.UNPACK_FLIP_Y_WEBGL,se.flipY),Ze.pixelStorei(Ze.UNPACK_PREMULTIPLY_ALPHA_WEBGL,se.premultiplyAlpha),Ze.pixelStorei(Ze.UNPACK_ALIGNMENT,se.unpackAlignment);const Bn=Ze.getParameter(Ze.UNPACK_ROW_LENGTH),Jn=Ze.getParameter(Ze.UNPACK_IMAGE_HEIGHT),Ri=Ze.getParameter(Ze.UNPACK_SKIP_PIXELS),or=Ze.getParameter(Ze.UNPACK_SKIP_ROWS),pn=Ze.getParameter(Ze.UNPACK_SKIP_IMAGES);Ze.pixelStorei(Ze.UNPACK_ROW_LENGTH,Tr.width),Ze.pixelStorei(Ze.UNPACK_IMAGE_HEIGHT,Tr.height),Ze.pixelStorei(Ze.UNPACK_SKIP_PIXELS,qt),Ze.pixelStorei(Ze.UNPACK_SKIP_ROWS,Kt),Ze.pixelStorei(Ze.UNPACK_SKIP_IMAGES,Mt);const Yr=Be.isDataArrayTexture||Be.isData3DTexture,W=se.isDataArrayTexture||se.isData3DTexture;if(Be.isRenderTargetTexture||Be.isDepthTexture){const ue=Gi.get(Be),Ae=Gi.get(se),Se=Gi.get(ue.__renderTarget),We=Gi.get(Ae.__renderTarget);Ti.bindFramebuffer(Ze.READ_FRAMEBUFFER,Se.__webglFramebuffer),Ti.bindFramebuffer(Ze.DRAW_FRAMEBUFFER,We.__webglFramebuffer);for(let Ye=0;Ye<wt;Ye++)Yr&&Ze.framebufferTextureLayer(Ze.READ_FRAMEBUFFER,Ze.COLOR_ATTACHMENT0,Gi.get(Be).__webglTexture,Fe,Mt+Ye),Be.isDepthTexture?(W&&Ze.framebufferTextureLayer(Ze.DRAW_FRAMEBUFFER,Ze.COLOR_ATTACHMENT0,Gi.get(se).__webglTexture,Fe,Fi+Ye),Ze.blitFramebuffer(qt,Kt,Ke,ot,ti,Ei,Ke,ot,Ze.DEPTH_BUFFER_BIT,Ze.NEAREST)):W?Ze.copyTexSubImage3D(bi,Fe,ti,Ei,Fi+Ye,qt,Kt,Ke,ot):Ze.copyTexSubImage2D(bi,Fe,ti,Ei,Fi+Ye,qt,Kt,Ke,ot);Ti.bindFramebuffer(Ze.READ_FRAMEBUFFER,null),Ti.bindFramebuffer(Ze.DRAW_FRAMEBUFFER,null)}else W?Be.isDataTexture||Be.isData3DTexture?Ze.texSubImage3D(bi,Fe,ti,Ei,Fi,Ke,ot,wt,hr,Zi,Tr.data):se.isCompressedArrayTexture?Ze.compressedTexSubImage3D(bi,Fe,ti,Ei,Fi,Ke,ot,wt,hr,Tr.data):Ze.texSubImage3D(bi,Fe,ti,Ei,Fi,Ke,ot,wt,hr,Zi,Tr):Be.isDataTexture?Ze.texSubImage2D(Ze.TEXTURE_2D,Fe,ti,Ei,Ke,ot,hr,Zi,Tr.data):Be.isCompressedTexture?Ze.compressedTexSubImage2D(Ze.TEXTURE_2D,Fe,ti,Ei,Tr.width,Tr.height,hr,Tr.data):Ze.texSubImage2D(Ze.TEXTURE_2D,Fe,ti,Ei,Ke,ot,hr,Zi,Tr);Ze.pixelStorei(Ze.UNPACK_ROW_LENGTH,Bn),Ze.pixelStorei(Ze.UNPACK_IMAGE_HEIGHT,Jn),Ze.pixelStorei(Ze.UNPACK_SKIP_PIXELS,Ri),Ze.pixelStorei(Ze.UNPACK_SKIP_ROWS,or),Ze.pixelStorei(Ze.UNPACK_SKIP_IMAGES,pn),Fe===0&&se.generateMipmaps&&Ze.generateMipmap(bi),Ti.unbindTexture()},this.copyTextureToTexture3D=function(Be,se,ge=null,Ne=null,Fe=0){return Be.isTexture!==!0&&(yA("WebGLRenderer: copyTextureToTexture3D function signature has changed."),ge=arguments[0]||null,Ne=arguments[1]||null,Be=arguments[2],se=arguments[3],Fe=arguments[4]||0),yA('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(Be,se,ge,Ne,Fe)},this.initRenderTarget=function(Be){Gi.get(Be).__webglFramebuffer===void 0&&Qe.setupRenderTarget(Be)},this.initTexture=function(Be){Be.isCubeTexture?Qe.setTextureCube(Be,0):Be.isData3DTexture?Qe.setTexture3D(Be,0):Be.isDataArrayTexture||Be.isCompressedArrayTexture?Qe.setTexture2DArray(Be,0):Qe.setTexture2D(Be,0),Ti.unbindTexture()},this.resetState=function(){B=0,I=0,D=null,Ti.reset(),Re.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return wu}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const i=this.getContext();i.drawingBufferColorspace=zn._getDrawingBufferColorSpace(e),i.unpackColorSpace=zn._getUnpackColorSpace()}}let Rie=class extends to{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Yh,this.environmentIntensity=1,this.environmentRotation=new Yh,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(r,e){return super.copy(r,e),r.background!==null&&(this.background=r.background.clone()),r.environment!==null&&(this.environment=r.environment.clone()),r.fog!==null&&(this.fog=r.fog.clone()),this.backgroundBlurriness=r.backgroundBlurriness,this.backgroundIntensity=r.backgroundIntensity,this.backgroundRotation.copy(r.backgroundRotation),this.environmentIntensity=r.environmentIntensity,this.environmentRotation.copy(r.environmentRotation),r.overrideMaterial!==null&&(this.overrideMaterial=r.overrideMaterial.clone()),this.matrixAutoUpdate=r.matrixAutoUpdate,this}toJSON(r){const e=super.toJSON(r);return this.fog!==null&&(e.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(e.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(e.object.backgroundIntensity=this.backgroundIntensity),e.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(e.object.environmentIntensity=this.environmentIntensity),e.object.environmentRotation=this.environmentRotation.toArray(),e}},Iie=class{constructor(r,e){this.isInterleavedBuffer=!0,this.array=r,this.stride=e,this.count=r!==void 0?r.length/e:0,this.usage=vS,this.updateRanges=[],this.version=0,this.uuid=Cu()}onUploadCallback(){}set needsUpdate(r){r===!0&&this.version++}setUsage(r){return this.usage=r,this}addUpdateRange(r,e){this.updateRanges.push({start:r,count:e})}clearUpdateRanges(){this.updateRanges.length=0}copy(r){return this.array=new r.array.constructor(r.array),this.count=r.count,this.stride=r.stride,this.usage=r.usage,this}copyAt(r,e,i){r*=this.stride,i*=e.stride;for(let n=0,s=this.stride;n<s;n++)this.array[r+n]=e.array[i+n];return this}set(r,e=0){return this.array.set(r,e),this}clone(r){r.arrayBuffers===void 0&&(r.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Cu()),r.arrayBuffers[this.array.buffer._uuid]===void 0&&(r.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const e=new this.array.constructor(r.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(e,this.stride);return i.setUsage(this.usage),i}onUpload(r){return this.onUploadCallback=r,this}toJSON(r){return r.arrayBuffers===void 0&&(r.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Cu()),r.arrayBuffers[this.array.buffer._uuid]===void 0&&(r.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}};const bo=new at;let Vk=class mH{constructor(e,i,n,s=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=i,this.offset=n,this.normalized=s}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let i=0,n=this.data.count;i<n;i++)bo.fromBufferAttribute(this,i),bo.applyMatrix4(e),this.setXYZ(i,bo.x,bo.y,bo.z);return this}applyNormalMatrix(e){for(let i=0,n=this.count;i<n;i++)bo.fromBufferAttribute(this,i),bo.applyNormalMatrix(e),this.setXYZ(i,bo.x,bo.y,bo.z);return this}transformDirection(e){for(let i=0,n=this.count;i<n;i++)bo.fromBufferAttribute(this,i),bo.transformDirection(e),this.setXYZ(i,bo.x,bo.y,bo.z);return this}getComponent(e,i){let n=this.array[e*this.data.stride+this.offset+i];return this.normalized&&(n=rc(n,this.array)),n}setComponent(e,i,n){return this.normalized&&(n=ss(n,this.array)),this.data.array[e*this.data.stride+this.offset+i]=n,this}setX(e,i){return this.normalized&&(i=ss(i,this.array)),this.data.array[e*this.data.stride+this.offset]=i,this}setY(e,i){return this.normalized&&(i=ss(i,this.array)),this.data.array[e*this.data.stride+this.offset+1]=i,this}setZ(e,i){return this.normalized&&(i=ss(i,this.array)),this.data.array[e*this.data.stride+this.offset+2]=i,this}setW(e,i){return this.normalized&&(i=ss(i,this.array)),this.data.array[e*this.data.stride+this.offset+3]=i,this}getX(e){let i=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(i=rc(i,this.array)),i}getY(e){let i=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(i=rc(i,this.array)),i}getZ(e){let i=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(i=rc(i,this.array)),i}getW(e){let i=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(i=rc(i,this.array)),i}setXY(e,i,n){return e=e*this.data.stride+this.offset,this.normalized&&(i=ss(i,this.array),n=ss(n,this.array)),this.data.array[e+0]=i,this.data.array[e+1]=n,this}setXYZ(e,i,n,s){return e=e*this.data.stride+this.offset,this.normalized&&(i=ss(i,this.array),n=ss(n,this.array),s=ss(s,this.array)),this.data.array[e+0]=i,this.data.array[e+1]=n,this.data.array[e+2]=s,this}setXYZW(e,i,n,s,o){return e=e*this.data.stride+this.offset,this.normalized&&(i=ss(i,this.array),n=ss(n,this.array),s=ss(s,this.array),o=ss(o,this.array)),this.data.array[e+0]=i,this.data.array[e+1]=n,this.data.array[e+2]=s,this.data.array[e+3]=o,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const i=[];for(let n=0;n<this.count;n++){const s=n*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)i.push(this.data.array[s+o])}return new jo(new this.array.constructor(i),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new mH(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const i=[];for(let n=0;n<this.count;n++){const s=n*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)i.push(this.data.array[s+o])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:i,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}},Gk=class extends mp{static get type(){return"SpriteMaterial"}constructor(r){super(),this.isSpriteMaterial=!0,this.color=new Tn(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(r)}copy(r){return super.copy(r),this.color.copy(r.color),this.map=r.map,this.alphaMap=r.alphaMap,this.rotation=r.rotation,this.sizeAttenuation=r.sizeAttenuation,this.fog=r.fog,this}},zm;const wA=new at,jm=new at,Vm=new at,Gm=new ji,CA=new ji,Hk=new As,Lb=new at,SA=new at,Db=new at,Wk=new ji,eT=new ji,Qk=new ji;class Bie extends to{constructor(e=new Gk){if(super(),this.isSprite=!0,this.type="Sprite",zm===void 0){zm=new Vo;const i=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new Iie(i,5);zm.setIndex([0,1,2,0,2,3]),zm.setAttribute("position",new Vk(n,3,0,!1)),zm.setAttribute("uv",new Vk(n,2,3,!1))}this.geometry=zm,this.material=e,this.center=new ji(.5,.5)}raycast(e,i){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),jm.setFromMatrixScale(this.matrixWorld),Hk.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Vm.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&jm.multiplyScalar(-Vm.z);const n=this.material.rotation;let s,o;n!==0&&(o=Math.cos(n),s=Math.sin(n));const l=this.center;Ob(Lb.set(-.5,-.5,0),Vm,l,jm,s,o),Ob(SA.set(.5,-.5,0),Vm,l,jm,s,o),Ob(Db.set(.5,.5,0),Vm,l,jm,s,o),Wk.set(0,0),eT.set(1,0),Qk.set(1,1);let u=e.ray.intersectTriangle(Lb,SA,Db,!1,wA);if(u===null&&(Ob(SA.set(-.5,.5,0),Vm,l,jm,s,o),eT.set(0,1),u=e.ray.intersectTriangle(Lb,Db,SA,!1,wA),u===null))return;const c=e.ray.origin.distanceTo(wA);c<e.near||c>e.far||i.push({distance:c,point:wA.clone(),uv:fp.getInterpolation(wA,Lb,SA,Db,Wk,eT,Qk,new ji),face:null,object:this})}copy(e,i){return super.copy(e,i),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function Ob(r,e,i,n,s,o){Gm.subVectors(r,i).addScalar(.5).multiply(n),s!==void 0?(CA.x=o*Gm.x-s*Gm.y,CA.y=s*Gm.x+o*Gm.y):CA.copy(Gm),r.copy(e),r.x+=CA.x,r.y+=CA.y,r.applyMatrix4(Hk)}let tT=class extends mp{static get type(){return"LineBasicMaterial"}constructor(r){super(),this.isLineBasicMaterial=!0,this.color=new Tn(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(r)}copy(r){return super.copy(r),this.color.copy(r.color),this.map=r.map,this.linewidth=r.linewidth,this.linecap=r.linecap,this.linejoin=r.linejoin,this.fog=r.fog,this}};const Pb=new at,kb=new at,qk=new As,TA=new fb,Fb=new hb,iT=new at,Xk=new at;class Yk extends to{constructor(e=new Vo,i=new tT){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=i,this.updateMorphTargets()}copy(e,i){return super.copy(e,i),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const i=e.attributes.position,n=[0];for(let s=1,o=i.count;s<o;s++)Pb.fromBufferAttribute(i,s-1),kb.fromBufferAttribute(i,s),n[s]=n[s-1],n[s]+=Pb.distanceTo(kb);e.setAttribute("lineDistance",new fa(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,i){const n=this.geometry,s=this.matrixWorld,o=e.params.Line.threshold,l=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),Fb.copy(n.boundingSphere),Fb.applyMatrix4(s),Fb.radius+=o,e.ray.intersectsSphere(Fb)===!1)return;qk.copy(s).invert(),TA.copy(e.ray).applyMatrix4(qk);const u=o/((this.scale.x+this.scale.y+this.scale.z)/3),c=u*u,h=this.isLineSegments?2:1,p=n.index,f=n.attributes.position;if(p!==null){const m=Math.max(0,l.start),g=Math.min(p.count,l.start+l.count);for(let y=m,x=g-1;y<x;y+=h){const v=p.getX(y),_=p.getX(y+1),T=Ub(this,e,TA,c,v,_);T&&i.push(T)}if(this.isLineLoop){const y=p.getX(g-1),x=p.getX(m),v=Ub(this,e,TA,c,y,x);v&&i.push(v)}}else{const m=Math.max(0,l.start),g=Math.min(f.count,l.start+l.count);for(let y=m,x=g-1;y<x;y+=h){const v=Ub(this,e,TA,c,y,y+1);v&&i.push(v)}if(this.isLineLoop){const y=Ub(this,e,TA,c,g-1,m);y&&i.push(y)}}}updateMorphTargets(){const e=this.geometry.morphAttributes,i=Object.keys(e);if(i.length>0){const n=e[i[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=n.length;s<o;s++){const l=n[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=s}}}}}function Ub(r,e,i,n,s,o){const l=r.geometry.attributes.position;if(Pb.fromBufferAttribute(l,s),kb.fromBufferAttribute(l,o),i.distanceSqToSegment(Pb,kb,iT,Xk)>n)return;iT.applyMatrix4(r.matrixWorld);const u=e.ray.origin.distanceTo(iT);if(!(u<e.near||u>e.far))return{distance:u,point:Xk.clone().applyMatrix4(r.matrixWorld),index:s,face:null,faceIndex:null,barycoord:null,object:r}}class Nie extends Nl{constructor(e,i,n,s,o,l,u,c,h){super(e,i,n,s,o,l,u,c,h),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Nu{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,i){const n=this.getUtoTmapping(e);return this.getPoint(n,i)}getPoints(e=5){const i=[];for(let n=0;n<=e;n++)i.push(this.getPoint(n/e));return i}getSpacedPoints(e=5){const i=[];for(let n=0;n<=e;n++)i.push(this.getPointAt(n/e));return i}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const i=[];let n,s=this.getPoint(0),o=0;i.push(0);for(let l=1;l<=e;l++)n=this.getPoint(l/e),o+=n.distanceTo(s),i.push(o),s=n;return this.cacheArcLengths=i,i}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,i){const n=this.getLengths();let s=0;const o=n.length;let l;i?l=i:l=e*n[o-1];let u=0,c=o-1,h;for(;u<=c;)if(s=Math.floor(u+(c-u)/2),h=n[s]-l,h<0)u=s+1;else if(h>0)c=s-1;else{c=s;break}if(s=c,n[s]===l)return s/(o-1);const p=n[s],f=n[s+1]-p,m=(l-p)/f;return(s+m)/(o-1)}getTangent(e,i){let n=e-1e-4,s=e+1e-4;n<0&&(n=0),s>1&&(s=1);const o=this.getPoint(n),l=this.getPoint(s),u=i||(o.isVector2?new ji:new at);return u.copy(l).sub(o).normalize(),u}getTangentAt(e,i){const n=this.getUtoTmapping(e);return this.getTangent(n,i)}computeFrenetFrames(e,i){const n=new at,s=[],o=[],l=[],u=new at,c=new As;for(let g=0;g<=e;g++){const y=g/e;s[g]=this.getTangentAt(y,new at)}o[0]=new at,l[0]=new at;let h=Number.MAX_VALUE;const p=Math.abs(s[0].x),f=Math.abs(s[0].y),m=Math.abs(s[0].z);p<=h&&(h=p,n.set(1,0,0)),f<=h&&(h=f,n.set(0,1,0)),m<=h&&n.set(0,0,1),u.crossVectors(s[0],n).normalize(),o[0].crossVectors(s[0],u),l[0].crossVectors(s[0],o[0]);for(let g=1;g<=e;g++){if(o[g]=o[g-1].clone(),l[g]=l[g-1].clone(),u.crossVectors(s[g-1],s[g]),u.length()>Number.EPSILON){u.normalize();const y=Math.acos(Ta(s[g-1].dot(s[g]),-1,1));o[g].applyMatrix4(c.makeRotationAxis(u,y))}l[g].crossVectors(s[g],o[g])}if(i===!0){let g=Math.acos(Ta(o[0].dot(o[e]),-1,1));g/=e,s[0].dot(u.crossVectors(o[0],o[e]))>0&&(g=-g);for(let y=1;y<=e;y++)o[y].applyMatrix4(c.makeRotationAxis(s[y],g*y)),l[y].crossVectors(s[y],o[y])}return{tangents:s,normals:o,binormals:l}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class Kk extends Nu{constructor(e=0,i=0,n=1,s=1,o=0,l=Math.PI*2,u=!1,c=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=i,this.xRadius=n,this.yRadius=s,this.aStartAngle=o,this.aEndAngle=l,this.aClockwise=u,this.aRotation=c}getPoint(e,i=new ji){const n=i,s=Math.PI*2;let o=this.aEndAngle-this.aStartAngle;const l=Math.abs(o)<Number.EPSILON;for(;o<0;)o+=s;for(;o>s;)o-=s;o<Number.EPSILON&&(l?o=0:o=s),this.aClockwise===!0&&!l&&(o===s?o=-s:o=o-s);const u=this.aStartAngle+e*o;let c=this.aX+this.xRadius*Math.cos(u),h=this.aY+this.yRadius*Math.sin(u);if(this.aRotation!==0){const p=Math.cos(this.aRotation),f=Math.sin(this.aRotation),m=c-this.aX,g=h-this.aY;c=m*p-g*f+this.aX,h=m*f+g*p+this.aY}return n.set(c,h)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class Lie extends Kk{constructor(e,i,n,s,o,l){super(e,i,n,n,s,o,l),this.isArcCurve=!0,this.type="ArcCurve"}}function rT(){let r=0,e=0,i=0,n=0;function s(o,l,u,c){r=o,e=u,i=-3*o+3*l-2*u-c,n=2*o-2*l+u+c}return{initCatmullRom:function(o,l,u,c,h){s(l,u,h*(u-o),h*(c-l))},initNonuniformCatmullRom:function(o,l,u,c,h,p,f){let m=(l-o)/h-(u-o)/(h+p)+(u-l)/p,g=(u-l)/p-(c-l)/(p+f)+(c-u)/f;m*=p,g*=p,s(l,u,m,g)},calc:function(o){const l=o*o,u=l*o;return r+e*o+i*l+n*u}}}const zb=new at,nT=new rT,sT=new rT,aT=new rT;class Die extends Nu{constructor(e=[],i=!1,n="centripetal",s=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=i,this.curveType=n,this.tension=s}getPoint(e,i=new at){const n=i,s=this.points,o=s.length,l=(o-(this.closed?0:1))*e;let u=Math.floor(l),c=l-u;this.closed?u+=u>0?0:(Math.floor(Math.abs(u)/o)+1)*o:c===0&&u===o-1&&(u=o-2,c=1);let h,p;this.closed||u>0?h=s[(u-1)%o]:(zb.subVectors(s[0],s[1]).add(s[0]),h=zb);const f=s[u%o],m=s[(u+1)%o];if(this.closed||u+2<o?p=s[(u+2)%o]:(zb.subVectors(s[o-1],s[o-2]).add(s[o-1]),p=zb),this.curveType==="centripetal"||this.curveType==="chordal"){const g=this.curveType==="chordal"?.5:.25;let y=Math.pow(h.distanceToSquared(f),g),x=Math.pow(f.distanceToSquared(m),g),v=Math.pow(m.distanceToSquared(p),g);x<1e-4&&(x=1),y<1e-4&&(y=x),v<1e-4&&(v=x),nT.initNonuniformCatmullRom(h.x,f.x,m.x,p.x,y,x,v),sT.initNonuniformCatmullRom(h.y,f.y,m.y,p.y,y,x,v),aT.initNonuniformCatmullRom(h.z,f.z,m.z,p.z,y,x,v)}else this.curveType==="catmullrom"&&(nT.initCatmullRom(h.x,f.x,m.x,p.x,this.tension),sT.initCatmullRom(h.y,f.y,m.y,p.y,this.tension),aT.initCatmullRom(h.z,f.z,m.z,p.z,this.tension));return n.set(nT.calc(c),sT.calc(c),aT.calc(c)),n}copy(e){super.copy(e),this.points=[];for(let i=0,n=e.points.length;i<n;i++){const s=e.points[i];this.points.push(s.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let i=0,n=this.points.length;i<n;i++){const s=this.points[i];e.points.push(s.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let i=0,n=e.points.length;i<n;i++){const s=e.points[i];this.points.push(new at().fromArray(s))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function Jk(r,e,i,n,s){const o=(n-e)*.5,l=(s-i)*.5,u=r*r,c=r*u;return(2*i-2*n+o+l)*c+(-3*i+3*n-2*o-l)*u+o*r+i}function Oie(r,e){const i=1-r;return i*i*e}function Pie(r,e){return 2*(1-r)*r*e}function kie(r,e){return r*r*e}function MA(r,e,i,n){return Oie(r,e)+Pie(r,i)+kie(r,n)}function Fie(r,e){const i=1-r;return i*i*i*e}function Uie(r,e){const i=1-r;return 3*i*i*r*e}function zie(r,e){return 3*(1-r)*r*r*e}function jie(r,e){return r*r*r*e}function RA(r,e,i,n,s){return Fie(r,e)+Uie(r,i)+zie(r,n)+jie(r,s)}class Vie extends Nu{constructor(e=new ji,i=new ji,n=new ji,s=new ji){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=i,this.v2=n,this.v3=s}getPoint(e,i=new ji){const n=i,s=this.v0,o=this.v1,l=this.v2,u=this.v3;return n.set(RA(e,s.x,o.x,l.x,u.x),RA(e,s.y,o.y,l.y,u.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class Zk extends Nu{constructor(e=new at,i=new at,n=new at,s=new at){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=i,this.v2=n,this.v3=s}getPoint(e,i=new at){const n=i,s=this.v0,o=this.v1,l=this.v2,u=this.v3;return n.set(RA(e,s.x,o.x,l.x,u.x),RA(e,s.y,o.y,l.y,u.y),RA(e,s.z,o.z,l.z,u.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class Gie extends Nu{constructor(e=new ji,i=new ji){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=i}getPoint(e,i=new ji){const n=i;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,i){return this.getPoint(e,i)}getTangent(e,i=new ji){return i.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,i){return this.getTangent(e,i)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Hie extends Nu{constructor(e=new at,i=new at){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=i}getPoint(e,i=new at){const n=i;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,i){return this.getPoint(e,i)}getTangent(e,i=new at){return i.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,i){return this.getTangent(e,i)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Wie extends Nu{constructor(e=new ji,i=new ji,n=new ji){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=i,this.v2=n}getPoint(e,i=new ji){const n=i,s=this.v0,o=this.v1,l=this.v2;return n.set(MA(e,s.x,o.x,l.x),MA(e,s.y,o.y,l.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class oT extends Nu{constructor(e=new at,i=new at,n=new at){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=i,this.v2=n}getPoint(e,i=new at){const n=i,s=this.v0,o=this.v1,l=this.v2;return n.set(MA(e,s.x,o.x,l.x),MA(e,s.y,o.y,l.y),MA(e,s.z,o.z,l.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Qie extends Nu{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,i=new ji){const n=i,s=this.points,o=(s.length-1)*e,l=Math.floor(o),u=o-l,c=s[l===0?l:l-1],h=s[l],p=s[l>s.length-2?s.length-1:l+1],f=s[l>s.length-3?s.length-1:l+2];return n.set(Jk(u,c.x,h.x,p.x,f.x),Jk(u,c.y,h.y,p.y,f.y)),n}copy(e){super.copy(e),this.points=[];for(let i=0,n=e.points.length;i<n;i++){const s=e.points[i];this.points.push(s.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let i=0,n=this.points.length;i<n;i++){const s=this.points[i];e.points.push(s.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let i=0,n=e.points.length;i<n;i++){const s=e.points[i];this.points.push(new ji().fromArray(s))}return this}}var qie=Object.freeze({__proto__:null,ArcCurve:Lie,CatmullRomCurve3:Die,CubicBezierCurve:Vie,CubicBezierCurve3:Zk,EllipseCurve:Kk,LineCurve:Gie,LineCurve3:Hie,QuadraticBezierCurve:Wie,QuadraticBezierCurve3:oT,SplineCurve:Qie});class jb extends Vo{constructor(e=1,i=1,n=1,s=32,o=1,l=!1,u=0,c=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:i,height:n,radialSegments:s,heightSegments:o,openEnded:l,thetaStart:u,thetaLength:c};const h=this;s=Math.floor(s),o=Math.floor(o);const p=[],f=[],m=[],g=[];let y=0;const x=[],v=n/2;let _=0;T(),l===!1&&(e>0&&w(!0),i>0&&w(!1)),this.setIndex(p),this.setAttribute("position",new fa(f,3)),this.setAttribute("normal",new fa(m,3)),this.setAttribute("uv",new fa(g,2));function T(){const S=new at,R=new at;let B=0;const I=(i-e)/n;for(let D=0;D<=o;D++){const L=[],O=D/o,U=O*(i-e)+e;for(let Z=0;Z<=s;Z++){const G=Z/s,z=G*c+u,$=Math.sin(z),Q=Math.cos(z);R.x=U*$,R.y=-O*n+v,R.z=U*Q,f.push(R.x,R.y,R.z),S.set($,I,Q).normalize(),m.push(S.x,S.y,S.z),g.push(G,1-O),L.push(y++)}x.push(L)}for(let D=0;D<s;D++)for(let L=0;L<o;L++){const O=x[L][D],U=x[L+1][D],Z=x[L+1][D+1],G=x[L][D+1];(e>0||L!==0)&&(p.push(O,U,G),B+=3),(i>0||L!==o-1)&&(p.push(U,Z,G),B+=3)}h.addGroup(_,B,0),_+=B}function w(S){const R=y,B=new ji,I=new at;let D=0;const L=S===!0?e:i,O=S===!0?1:-1;for(let Z=1;Z<=s;Z++)f.push(0,v*O,0),m.push(0,O,0),g.push(.5,.5),y++;const U=y;for(let Z=0;Z<=s;Z++){const G=Z/s*c+u,z=Math.cos(G),$=Math.sin(G);I.x=L*$,I.y=v*O,I.z=L*z,f.push(I.x,I.y,I.z),m.push(0,O,0),B.x=z*.5+.5,B.y=$*.5*O+.5,g.push(B.x,B.y),y++}for(let Z=0;Z<s;Z++){const G=R+Z,z=U+Z;S===!0?p.push(z,z+1,G):p.push(z+1,z,G),D+=3}h.addGroup(_,D,S===!0?1:2),_+=D}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new jb(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class lT extends jb{constructor(e=1,i=1,n=32,s=1,o=!1,l=0,u=Math.PI*2){super(0,e,i,n,s,o,l,u),this.type="ConeGeometry",this.parameters={radius:e,height:i,radialSegments:n,heightSegments:s,openEnded:o,thetaStart:l,thetaLength:u}}static fromJSON(e){return new lT(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}let Vb=class gH extends Vo{constructor(e=1,i=32,n=16,s=0,o=Math.PI*2,l=0,u=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:i,heightSegments:n,phiStart:s,phiLength:o,thetaStart:l,thetaLength:u},i=Math.max(3,Math.floor(i)),n=Math.max(2,Math.floor(n));const c=Math.min(l+u,Math.PI);let h=0;const p=[],f=new at,m=new at,g=[],y=[],x=[],v=[];for(let _=0;_<=n;_++){const T=[],w=_/n;let S=0;_===0&&l===0?S=.5/i:_===n&&c===Math.PI&&(S=-.5/i);for(let R=0;R<=i;R++){const B=R/i;f.x=-e*Math.cos(s+B*o)*Math.sin(l+w*u),f.y=e*Math.cos(l+w*u),f.z=e*Math.sin(s+B*o)*Math.sin(l+w*u),y.push(f.x,f.y,f.z),m.copy(f).normalize(),x.push(m.x,m.y,m.z),v.push(B+S,1-w),T.push(h++)}p.push(T)}for(let _=0;_<n;_++)for(let T=0;T<i;T++){const w=p[_][T+1],S=p[_][T],R=p[_+1][T],B=p[_+1][T+1];(_!==0||l>0)&&g.push(w,S,B),(_!==n-1||c<Math.PI)&&g.push(S,R,B)}this.setIndex(g),this.setAttribute("position",new fa(y,3)),this.setAttribute("normal",new fa(x,3)),this.setAttribute("uv",new fa(v,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new gH(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}};class cT extends Vo{constructor(e=new oT(new at(-1,-1,0),new at(-1,1,0),new at(1,1,0)),i=64,n=1,s=8,o=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:i,radius:n,radialSegments:s,closed:o};const l=e.computeFrenetFrames(i,o);this.tangents=l.tangents,this.normals=l.normals,this.binormals=l.binormals;const u=new at,c=new at,h=new ji;let p=new at;const f=[],m=[],g=[],y=[];x(),this.setIndex(y),this.setAttribute("position",new fa(f,3)),this.setAttribute("normal",new fa(m,3)),this.setAttribute("uv",new fa(g,2));function x(){for(let w=0;w<i;w++)v(w);v(o===!1?i:0),T(),_()}function v(w){p=e.getPointAt(w/i,p);const S=l.normals[w],R=l.binormals[w];for(let B=0;B<=s;B++){const I=B/s*Math.PI*2,D=Math.sin(I),L=-Math.cos(I);c.x=L*S.x+D*R.x,c.y=L*S.y+D*R.y,c.z=L*S.z+D*R.z,c.normalize(),m.push(c.x,c.y,c.z),u.x=p.x+n*c.x,u.y=p.y+n*c.y,u.z=p.z+n*c.z,f.push(u.x,u.y,u.z)}}function _(){for(let w=1;w<=i;w++)for(let S=1;S<=s;S++){const R=(s+1)*(w-1)+(S-1),B=(s+1)*w+(S-1),I=(s+1)*w+S,D=(s+1)*(w-1)+S;y.push(R,B,D),y.push(B,I,D)}}function T(){for(let w=0;w<=i;w++)for(let S=0;S<=s;S++)h.x=w/i,h.y=S/s,g.push(h.x,h.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new cT(new qie[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}let Xie=class extends mp{static get type(){return"MeshLambertMaterial"}constructor(r){super(),this.isMeshLambertMaterial=!0,this.color=new Tn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Tn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=IP,this.normalScale=new ji(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Yh,this.combine=OC,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(r)}copy(r){return super.copy(r),this.color.copy(r.color),this.map=r.map,this.lightMap=r.lightMap,this.lightMapIntensity=r.lightMapIntensity,this.aoMap=r.aoMap,this.aoMapIntensity=r.aoMapIntensity,this.emissive.copy(r.emissive),this.emissiveMap=r.emissiveMap,this.emissiveIntensity=r.emissiveIntensity,this.bumpMap=r.bumpMap,this.bumpScale=r.bumpScale,this.normalMap=r.normalMap,this.normalMapType=r.normalMapType,this.normalScale.copy(r.normalScale),this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.specularMap=r.specularMap,this.alphaMap=r.alphaMap,this.envMap=r.envMap,this.envMapRotation.copy(r.envMapRotation),this.combine=r.combine,this.reflectivity=r.reflectivity,this.refractionRatio=r.refractionRatio,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.wireframeLinecap=r.wireframeLinecap,this.wireframeLinejoin=r.wireframeLinejoin,this.flatShading=r.flatShading,this.fog=r.fog,this}};const $k={enabled:!1,files:{},add:function(r,e){this.enabled!==!1&&(this.files[r]=e)},get:function(r){if(this.enabled!==!1)return this.files[r]},remove:function(r){delete this.files[r]},clear:function(){this.files={}}};class Yie{constructor(e,i,n){const s=this;let o=!1,l=0,u=0,c;const h=[];this.onStart=void 0,this.onLoad=e,this.onProgress=i,this.onError=n,this.itemStart=function(p){u++,o===!1&&s.onStart!==void 0&&s.onStart(p,l,u),o=!0},this.itemEnd=function(p){l++,s.onProgress!==void 0&&s.onProgress(p,l,u),l===u&&(o=!1,s.onLoad!==void 0&&s.onLoad())},this.itemError=function(p){s.onError!==void 0&&s.onError(p)},this.resolveURL=function(p){return c?c(p):p},this.setURLModifier=function(p){return c=p,this},this.addHandler=function(p,f){return h.push(p,f),this},this.removeHandler=function(p){const f=h.indexOf(p);return f!==-1&&h.splice(f,2),this},this.getHandler=function(p){for(let f=0,m=h.length;f<m;f+=2){const g=h[f],y=h[f+1];if(g.global&&(g.lastIndex=0),g.test(p))return y}return null}}}const Kie=new Yie;class uT{constructor(e){this.manager=e!==void 0?e:Kie,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,i){const n=this;return new Promise(function(s,o){n.load(e,s,i,o)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}uT.DEFAULT_MATERIAL_NAME="__DEFAULT";class Jie extends uT{constructor(e){super(e)}load(e,i,n,s){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const o=this,l=$k.get(e);if(l!==void 0)return o.manager.itemStart(e),setTimeout(function(){i&&i(l),o.manager.itemEnd(e)},0),l;const u=AA("img");function c(){p(),$k.add(e,this),i&&i(this),o.manager.itemEnd(e)}function h(f){p(),s&&s(f),o.manager.itemError(e),o.manager.itemEnd(e)}function p(){u.removeEventListener("load",c,!1),u.removeEventListener("error",h,!1)}return u.addEventListener("load",c,!1),u.addEventListener("error",h,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(u.crossOrigin=this.crossOrigin),o.manager.itemStart(e),u.src=e,u}}class Zie extends uT{constructor(e){super(e)}load(e,i,n,s){const o=new Nl,l=new Jie(this.manager);return l.setCrossOrigin(this.crossOrigin),l.setPath(this.path),l.load(e,function(u){o.image=u,o.needsUpdate=!0,i!==void 0&&i(o)},n,s),o}}let e4=class extends to{constructor(r,e=1){super(),this.isLight=!0,this.type="Light",this.color=new Tn(r),this.intensity=e}dispose(){}copy(r,e){return super.copy(r,e),this.color.copy(r.color),this.intensity=r.intensity,this}toJSON(r){const e=super.toJSON(r);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,this.groundColor!==void 0&&(e.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(e.object.distance=this.distance),this.angle!==void 0&&(e.object.angle=this.angle),this.decay!==void 0&&(e.object.decay=this.decay),this.penumbra!==void 0&&(e.object.penumbra=this.penumbra),this.shadow!==void 0&&(e.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(e.object.target=this.target.uuid),e}};const hT=new As,t4=new at,i4=new at;let $ie=class{constructor(r){this.camera=r,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new ji(512,512),this.map=null,this.mapPass=null,this.matrix=new As,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new GS,this._frameExtents=new ji(1,1),this._viewportCount=1,this._viewports=[new Js(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(r){const e=this.camera,i=this.matrix;t4.setFromMatrixPosition(r.matrixWorld),e.position.copy(t4),i4.setFromMatrixPosition(r.target.matrixWorld),e.lookAt(i4),e.updateMatrixWorld(),hT.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(hT),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(hT)}getViewport(r){return this._viewports[r]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(r){return this.camera=r.camera.clone(),this.intensity=r.intensity,this.bias=r.bias,this.radius=r.radius,this.mapSize.copy(r.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const r={};return this.intensity!==1&&(r.intensity=this.intensity),this.bias!==0&&(r.bias=this.bias),this.normalBias!==0&&(r.normalBias=this.normalBias),this.radius!==1&&(r.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(r.mapSize=this.mapSize.toArray()),r.camera=this.camera.toJSON(!1).object,delete r.camera.matrix,r}},ere=class extends $ie{constructor(){super(new HS(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},tre=class extends e4{constructor(r,e){super(r,e),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(to.DEFAULT_UP),this.updateMatrix(),this.target=new to,this.shadow=new ere}dispose(){this.shadow.dispose()}copy(r){return super.copy(r),this.target=r.target.clone(),this.shadow=r.shadow.clone(),this}},ire=class extends e4{constructor(r,e){super(r,e),this.isAmbientLight=!0,this.type="AmbientLight"}};class r4{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=n4(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const i=n4();e=(i-this.oldTime)/1e3,this.oldTime=i,this.elapsedTime+=e}return e}}function n4(){return performance.now()}const s4=new As;class a4{constructor(e,i,n=0,s=1/0){this.ray=new fb(e,i),this.near=n,this.far=s,this.camera=null,this.layers=new IS,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,i){this.ray.set(e,i)}setFromCamera(e,i){i.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(i.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(i).sub(this.ray.origin).normalize(),this.camera=i):i.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(i.near+i.far)/(i.near-i.far)).unproject(i),this.ray.direction.set(0,0,-1).transformDirection(i.matrixWorld),this.camera=i):console.error("THREE.Raycaster: Unsupported camera type: "+i.type)}setFromXRController(e){return s4.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(s4),this}intersectObject(e,i=!0,n=[]){return dT(e,this,n,i),n.sort(o4),n}intersectObjects(e,i=!0,n=[]){for(let s=0,o=e.length;s<o;s++)dT(e[s],this,n,i);return n.sort(o4),n}}function o4(r,e){return r.distance-e.distance}function dT(r,e,i,n){let s=!0;if(r.layers.test(e.layers)&&r.raycast(e,i)===!1&&(s=!1),s===!0&&n===!0){const o=r.children;for(let l=0,u=o.length;l<u;l++)dT(o[l],e,i,!0)}}class l4{constructor(e=1,i=0,n=0){return this.radius=e,this.phi=i,this.theta=n,this}set(e,i,n){return this.radius=e,this.phi=i,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,i,n){return this.radius=Math.sqrt(e*e+i*i+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Ta(i/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class Gb extends up{constructor(e,i=null){super(),this.object=e,this.domElement=i,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(){}disconnect(){}dispose(){}update(){}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Zx}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Zx);class Qs{static roundNumber(e,i){const n=Math.pow(10,i);return Math.round(e*n)/n}static sample(e){return e[Math.floor(Math.random()*e.length)]}static distanceToSquared(e,i){var n=e.x-i.x,s=e.y-i.y,o=e.z-i.z;return n*n+s*s+o*o}static isPointInPoly(e,i){for(var n=!1,s=-1,o=e.length,l=o-1;++s<o;l=s)(e[s].z<=i.z&&i.z<e[l].z||e[l].z<=i.z&&i.z<e[s].z)&&i.x<(e[l].x-e[s].x)*(i.z-e[s].z)/(e[l].z-e[s].z)+e[s].x&&(n=!n);return n}static isVectorInPolygon(e,i,n){var s=1e5,o=-1e5,l=[];return i.vertexIds.forEach(u=>{s=Math.min(n[u].y,s),o=Math.max(n[u].y,o),l.push(n[u])}),!!(e.y<o+.5&&e.y>s-.5&&this.isPointInPoly(l,e))}static triarea2(e,i,n){return(n.x-e.x)*(i.z-e.z)-(i.x-e.x)*(n.z-e.z)}static vequal(e,i){return this.distanceToSquared(e,i)<1e-5}static mergeVertices(e,i=1e-4){i=Math.max(i,Number.EPSILON);for(var n={},s=e.getIndex(),o=e.getAttribute("position"),l=s?s.count:o.count,u=0,c=[],h=[],p=Math.log10(1/i),f=Math.pow(10,p),m=0;m<l;m++){var g=s?s.getX(m):m,y="";y+=~~(o.getX(g)*f)+",",y+=~~(o.getY(g)*f)+",",(y+=~~(o.getZ(g)*f)+",")in n?c.push(n[y]):(h.push(o.getX(g)),h.push(o.getY(g)),h.push(o.getZ(g)),n[y]=u,c.push(u),u++)}const x=new jo(new Float32Array(h),o.itemSize,o.normalized),v=new Vo;return v.setAttribute("position",x),v.setIndex(c),v}}class rre{constructor(e){this.content=[],this.scoreFunction=e}push(e){this.content.push(e),this.sinkDown(this.content.length-1)}pop(){const e=this.content[0],i=this.content.pop();return this.content.length>0&&(this.content[0]=i,this.bubbleUp(0)),e}remove(e){const i=this.content.indexOf(e),n=this.content.pop();i!==this.content.length-1&&(this.content[i]=n,this.scoreFunction(n)<this.scoreFunction(e)?this.sinkDown(i):this.bubbleUp(i))}size(){return this.content.length}rescoreElement(e){this.sinkDown(this.content.indexOf(e))}sinkDown(e){const i=this.content[e];for(;e>0;){const n=(e+1>>1)-1,s=this.content[n];if(!(this.scoreFunction(i)<this.scoreFunction(s)))break;this.content[n]=i,this.content[e]=s,e=n}}bubbleUp(e){const i=this.content.length,n=this.content[e],s=this.scoreFunction(n);for(;;){const o=e+1<<1,l=o-1;let u,c=null;if(l<i&&(u=this.scoreFunction(this.content[l]),u<s&&(c=l)),o<i&&this.scoreFunction(this.content[o])<(c===null?s:u)&&(c=o),c===null)break;this.content[e]=this.content[c],this.content[c]=n,e=c}}}class nre{constructor(){this.portals=[]}push(e,i){i===void 0&&(i=e),this.portals.push({left:e,right:i})}stringPull(){const e=this.portals,i=[];let n,s,o,l=0,u=0,c=0;n=e[0].left,s=e[0].left,o=e[0].right,i.push(n);for(let h=1;h<e.length;h++){const p=e[h].left,f=e[h].right;if(Qs.triarea2(n,o,f)<=0){if(!(Qs.vequal(n,o)||Qs.triarea2(n,s,f)>0)){i.push(s),n=s,l=u,s=n,o=n,u=l,c=l,h=l;continue}o=f,c=h}if(Qs.triarea2(n,s,p)>=0){if(!(Qs.vequal(n,s)||Qs.triarea2(n,o,p)<0)){i.push(o),n=o,l=c,s=n,o=n,u=l,c=l,h=l;continue}s=p,u=h}}return i.length!==0&&Qs.vequal(i[i.length-1],e[e.length-1].left)||i.push(e[e.length-1].left),this.path=i,i}}class pT{constructor(){this.zones={}}static createZone(e,i=1e-4){return(class{static buildZone(n,s){const o=this._buildNavigationMesh(n,s),l={};o.vertices.forEach(c=>{c.x=Qs.roundNumber(c.x,2),c.y=Qs.roundNumber(c.y,2),c.z=Qs.roundNumber(c.z,2)}),l.vertices=o.vertices;const u=this._buildPolygonGroups(o);return l.groups=new Array(u.length),u.forEach((c,h)=>{const p=new Map;c.forEach((m,g)=>{p.set(m,g)});const f=new Array(c.length);c.forEach((m,g)=>{const y=[];m.neighbours.forEach(_=>y.push(p.get(_)));const x=[];m.neighbours.forEach(_=>x.push(this._getSharedVerticesInOrder(m,_)));const v=new at(0,0,0);v.add(l.vertices[m.vertexIds[0]]),v.add(l.vertices[m.vertexIds[1]]),v.add(l.vertices[m.vertexIds[2]]),v.divideScalar(3),v.x=Qs.roundNumber(v.x,2),v.y=Qs.roundNumber(v.y,2),v.z=Qs.roundNumber(v.z,2),f[g]={id:g,neighbours:y,vertexIds:m.vertexIds,centroid:v,portals:x}}),l.groups[h]=f}),l}static _buildNavigationMesh(n,s){return n=Qs.mergeVertices(n,s),this._buildPolygonsFromGeometry(n)}static _spreadGroupId(n){let s=new Set([n]);for(;s.size>0;){const o=s;s=new Set,o.forEach(l=>{l.group=n.group,l.neighbours.forEach(u=>{u.group===void 0&&s.add(u)})})}}static _buildPolygonGroups(n){const s=[];return n.polygons.forEach(o=>{o.group!==void 0?s[o.group].push(o):(o.group=s.length,this._spreadGroupId(o),s.push([o]))}),s}static _buildPolygonNeighbours(n,s){const o=new Set,l=s[n.vertexIds[1]],u=s[n.vertexIds[2]];return s[n.vertexIds[0]].forEach(c=>{c!==n&&(l.includes(c)||u.includes(c))&&o.add(c)}),l.forEach(c=>{c!==n&&u.includes(c)&&o.add(c)}),o}static _buildPolygonsFromGeometry(n){const s=[],o=[],l=n.attributes.position,u=n.index,c=[];for(let h=0;h<l.count;h++)o.push(new at().fromBufferAttribute(l,h)),c[h]=[];for(let h=0;h<n.index.count;h+=3){const p=u.getX(h),f=u.getX(h+1),m=u.getX(h+2),g={vertexIds:[p,f,m],neighbours:null};s.push(g),c[p].push(g),c[f].push(g),c[m].push(g)}return s.forEach(h=>{h.neighbours=this._buildPolygonNeighbours(h,c)}),{polygons:s,vertices:o}}static _getSharedVerticesInOrder(n,s){const o=n.vertexIds,l=o[0],u=o[1],c=o[2],h=s.vertexIds,p=h.includes(l),f=h.includes(u),m=h.includes(c);return p&&f&&m?Array.from(o):p&&f?[l,u]:f&&m?[u,c]:p&&m?[c,l]:(console.warn("Error processing navigation mesh neighbors; neighbors with <2 shared vertices found."),[])}}).buildZone(e,i)}setZoneData(e,i){this.zones[e]=i}getRandomNode(e,i,n,s){if(!this.zones[e])return new at;n=n||null,s=s||0;const o=[];return this.zones[e].groups[i].forEach(l=>{n&&s?Qs.distanceToSquared(n,l.centroid)<s*s&&o.push(l.centroid):o.push(l.centroid)}),Qs.sample(o)||new at}getClosestNode(e,i,n,s=!1){const o=this.zones[i].vertices;let l=null,u=1/0;return this.zones[i].groups[n].forEach(c=>{const h=Qs.distanceToSquared(c.centroid,e);h<u&&(!s||Qs.isVectorInPolygon(e,c,o))&&(l=c,u=h)}),l}findPath(e,i,n,s){const o=this.zones[n].groups[s],l=this.zones[n].vertices,u=this.getClosestNode(e,n,s,!0),c=this.getClosestNode(i,n,s,!0);if(!u||!c)return null;const h=(class{static init(g){for(let y=0;y<g.length;y++){const x=g[y];x.f=0,x.g=0,x.h=0,x.cost=1,x.visited=!1,x.closed=!1,x.parent=null}}static cleanUp(g){for(let y=0;y<g.length;y++){const x=g[y];delete x.f,delete x.g,delete x.h,delete x.cost,delete x.visited,delete x.closed,delete x.parent}}static heap(){return new rre(function(g){return g.f})}static search(g,y,x){this.init(g);const v=this.heap();for(v.push(y);v.size()>0;){const _=v.pop();if(_===x){let w=_;const S=[];for(;w.parent;)S.push(w),w=w.parent;return this.cleanUp(S),S.reverse()}_.closed=!0;const T=this.neighbours(g,_);for(let w=0,S=T.length;w<S;w++){const R=T[w];if(R.closed)continue;const B=_.g+R.cost,I=R.visited;if(!I||B<R.g){if(R.visited=!0,R.parent=_,!R.centroid||!x.centroid)throw new Error("Unexpected state");R.h=R.h||this.heuristic(R.centroid,x.centroid),R.g=B,R.f=R.g+R.h,I?v.rescoreElement(R):v.push(R)}}}return[]}static heuristic(g,y){return Qs.distanceToSquared(g,y)}static neighbours(g,y){const x=[];for(let v=0;v<y.neighbours.length;v++)x.push(g[y.neighbours[v]]);return x}}).search(o,u,c),p=function(g,y){for(var x=0;x<g.neighbours.length;x++)if(g.neighbours[x]===y.id)return g.portals[x]},f=new nre;f.push(e);for(let g=0;g<h.length;g++){const y=h[g],x=h[g+1];if(x){const v=p(y,x);f.push(l[v[0]],l[v[1]])}}f.push(i),f.stringPull();const m=f.path.map(g=>new at(g.x,g.y,g.z));return m.shift(),m}}pT.prototype.getGroup=function(){const r=new oc;return function(e,i,n=!1){if(!this.zones[e])return null;let s=null,o=Math.pow(50,2);const l=this.zones[e];for(let u=0;u<l.groups.length;u++){const c=l.groups[u];for(const h of c){if(n&&(r.setFromCoplanarPoints(l.vertices[h.vertexIds[0]],l.vertices[h.vertexIds[1]],l.vertices[h.vertexIds[2]]),Math.abs(r.distanceToPoint(i))<.01)&&Qs.isPointInPoly([l.vertices[h.vertexIds[0]],l.vertices[h.vertexIds[1]],l.vertices[h.vertexIds[2]]],i))return u;const p=Qs.distanceToSquared(h.centroid,i);p<o&&(s=u,o=p)}}return s}}(),pT.prototype.clampStep=function(){const r=new at,e=new oc,i=new fp,n=new at;let s,o,l=new at;return function(u,c,h,p,f,m){const g=this.zones[p].vertices,y=this.zones[p].groups[f],x=[h],v={};v[h.id]=0,s=void 0,l.set(0,0,0),o=1/0,e.setFromCoplanarPoints(g[h.vertexIds[0]],g[h.vertexIds[1]],g[h.vertexIds[2]]),e.projectPoint(c,r),n.copy(r);for(let _=x.pop();_;_=x.pop()){i.set(g[_.vertexIds[0]],g[_.vertexIds[1]],g[_.vertexIds[2]]),i.closestPointToPoint(n,r),r.distanceToSquared(n)<o&&(s=_,l.copy(r),o=r.distanceToSquared(n));const T=v[_.id];if(!(T>2))for(let w=0;w<_.neighbours.length;w++){const S=y[_.neighbours[w]];S.id in v||(x.push(S),v[S.id]=T+1)}}return m.copy(l),s}}();class sre extends to{constructor(){super(),this._playerMarker=new za(new Vb(.25,32,32),new Jh({color:15631215})),this._targetMarker=new za(new Nm(.3,.3,.3),new Jh({color:14469912})),this._nodeMarker=new za(new Nm(.1,.8,.1),new Jh({color:4417387})),this._stepMarker=new za(new Nm(.1,1,.1),new Jh({color:14472114})),this._pathMarker=new to,this._pathLineMaterial=new tT({color:41903,linewidth:2}),this._pathPointMaterial=new Jh({color:41903}),this._pathPointGeometry=new Vb(.08),this._markers=[this._playerMarker,this._targetMarker,this._nodeMarker,this._stepMarker,this._pathMarker],this._markers.forEach(e=>{e.visible=!1,this.add(e)})}setPath(e){for(;this._pathMarker.children.length;)this._pathMarker.children[0].visible=!1,this._pathMarker.remove(this._pathMarker.children[0]);e=[this._playerMarker.position].concat(e);const i=new Vo;i.setAttribute("position",new jo(new Float32Array(3*e.length),3));for(let n=0;n<e.length;n++)i.attributes.position.setXYZ(n,e[n].x,e[n].y+.2,e[n].z);this._pathMarker.add(new Yk(i,this._pathLineMaterial));for(let n=0;n<e.length-1;n++){const s=new za(this._pathPointGeometry,this._pathPointMaterial);s.position.copy(e[n]),s.position.y+=.2,this._pathMarker.add(s)}return this._pathMarker.visible=!0,this}setPlayerPosition(e){return this._playerMarker.position.copy(e),this._playerMarker.visible=!0,this}setTargetPosition(e){return this._targetMarker.position.copy(e),this._targetMarker.visible=!0,this}setNodePosition(e){return this._nodeMarker.position.copy(e),this._nodeMarker.visible=!0,this}setStepPosition(e){return this._stepMarker.position.copy(e),this._stepMarker.visible=!0,this}reset(){for(;this._pathMarker.children.length;)this._pathMarker.children[0].visible=!1,this._pathMarker.remove(this._pathMarker.children[0]);return this._markers.forEach(e=>{e.visible=!1}),this}}const are=Object.freeze(Object.defineProperty({__proto__:null,Pathfinding:pT,PathfindingHelper:sre},Symbol.toStringTag,{value:"Module"})),ore=x2(are),{Pathfinding:c4}=ore,IA=new c4,BA="level";AFRAME.registerSystem("nav",{init:function(){this.navMesh=null,this.agents=new Set},setNavMeshGeometry:function(r){this.navMesh=new THREE.Mesh(r),IA.setZoneData(BA,c4.createZone(r)),Array.from(this.agents).forEach(e=>e.updateNavLocation())},getNavMesh:function(){return this.navMesh},addAgent:function(r){this.agents.add(r)},removeAgent:function(r){this.agents.delete(r)},getPath:function(r,e,i){return this.navMesh?IA.findPath(r,e,BA,i):null},getGroup:function(r){return this.navMesh?IA.getGroup(BA,r):null},getNode:function(r,e){return this.navMesh?IA.getClosestNode(r,BA,e,!0):null},clampStep:function(r,e,i,n,s){if(this.navMesh){if(!n)return s.copy(e),this.getNode(e,i)}else return s.copy(e),null;return IA.clampStep(r,e,n,BA,i,s)}}),AFRAME.registerPrimitive("a-grid",{defaultComponents:{geometry:{primitive:"plane",width:75,height:75},rotation:{x:-90,y:0,z:0},material:{src:"url(https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v1.16.3/assets/grid.png)",repeat:"75 75"}},mappings:{width:"geometry.width",height:"geometry.height",src:"material.src"}}),AFRAME.registerPrimitive("a-ocean",{defaultComponents:{ocean:{},rotation:{x:-90,y:0,z:0}},mappings:{width:"ocean.width",depth:"ocean.depth",density:"ocean.density",amplitude:"ocean.amplitude",amplitudeVariance:"ocean.amplitudeVariance",speed:"ocean.speed",speedVariance:"ocean.speedVariance",color:"ocean.color",opacity:"ocean.opacity"}}),AFRAME.registerComponent("ocean",{schema:{width:{default:10,min:0},depth:{default:10,min:0},density:{default:10},amplitude:{default:.1},amplitudeVariance:{default:.3},speed:{default:1},speedVariance:{default:2},color:{default:"#7AD2F7",type:"color"},opacity:{default:.8}},play:function(){const r=this.el,e=this.data;let i=r.components.material;const n=new THREE.PlaneGeometry(e.width,e.depth,e.density,e.density);this.waves=[];const s=n.getAttribute("position");for(let o=0;o<s.count;o++)this.waves.push({z:s.getZ(o),ang:Math.random()*Math.PI*2,amp:e.amplitude+Math.random()*e.amplitudeVariance,speed:(e.speed+Math.random()*e.speedVariance)/1e3});i||(i={},i.material=new THREE.MeshPhongMaterial({color:e.color,transparent:e.opacity<1,opacity:e.opacity,flatShading:!0})),this.mesh=new THREE.Mesh(n,i.material),r.setObject3D("mesh",this.mesh)},remove:function(){this.el.removeObject3D("mesh")},tick:function(r,e){if(!e)return;const i=this.mesh.geometry.getAttribute("position");for(let n=0;n<i.count;n++){const s=this.waves[n],o=s.z+Math.sin(s.ang)*s.amp;i.setZ(n,o),s.ang+=s.speed*e}i.needsUpdate=!0}}),AFRAME.registerPrimitive("a-tube",{defaultComponents:{tube:{}},mappings:{path:"tube.path",segments:"tube.segments",radius:"tube.radius","radial-segments":"tube.radialSegments",closed:"tube.closed"}}),AFRAME.registerComponent("tube",{schema:{path:{default:[]},segments:{default:64},radius:{default:1},radialSegments:{default:8},closed:{default:!1}},init:function(){const r=this.el,e=this.data;let i=r.components.material;if(!e.path.length){console.error("[a-tube] `path` property expected but not found.");return}const n=new THREE.CatmullRomCurve3(e.path.map(function(o){return o=o.split(" "),new THREE.Vector3(Number(o[0]),Number(o[1]),Number(o[2]))})),s=new THREE.TubeGeometry(n,e.segments,e.radius,e.radialSegments,e.closed);i||(i={},i.material=new THREE.MeshPhongMaterial),this.mesh=new THREE.Mesh(s,i.material),this.el.setObject3D("mesh",this.mesh)},update:function(r){Object.keys(r).length&&(this.remove(),this.init())},remove:function(){this.mesh&&this.el.removeObject3D("mesh")}});var gr=function(r){return typeof r=="function"?r:typeof r=="string"?function(e){return e[r]}:function(e){return r}};const lre=Object.freeze(Object.defineProperty({__proto__:null,default:gr},Symbol.toStringTag,{value:"Module"})),cre=x2(lre);function u4(r,e,i){var n,s=1;r==null&&(r=0),e==null&&(e=0),i==null&&(i=0);function o(){var l,u=n.length,c,h=0,p=0,f=0;for(l=0;l<u;++l)c=n[l],h+=c.x||0,p+=c.y||0,f+=c.z||0;for(h=(h/u-r)*s,p=(p/u-e)*s,f=(f/u-i)*s,l=0;l<u;++l)c=n[l],h&&(c.x-=h),p&&(c.y-=p),f&&(c.z-=f)}return o.initialize=function(l){n=l},o.x=function(l){return arguments.length?(r=+l,o):r},o.y=function(l){return arguments.length?(e=+l,o):e},o.z=function(l){return arguments.length?(i=+l,o):i},o.strength=function(l){return arguments.length?(s=+l,o):s},o}function ure(r){const e=+this._x.call(null,r);return h4(this.cover(e),e,r)}function h4(r,e,i){if(isNaN(e))return r;var n,s=r._root,o={data:i},l=r._x0,u=r._x1,c,h,p,f,m;if(!s)return r._root=o,r;for(;s.length;)if((p=e>=(c=(l+u)/2))?l=c:u=c,n=s,!(s=s[f=+p]))return n[f]=o,r;if(h=+r._x.call(null,s.data),e===h)return o.next=s,n?n[f]=o:r._root=o,r;do n=n?n[f]=new Array(2):r._root=new Array(2),(p=e>=(c=(l+u)/2))?l=c:u=c;while((f=+p)==(m=+(h>=c)));return n[m]=s,n[f]=o,r}function hre(r){Array.isArray(r)||(r=Array.from(r));const e=r.length,i=new Float64Array(e);let n=1/0,s=-1/0;for(let o=0,l;o<e;++o)isNaN(l=+this._x.call(null,r[o]))||(i[o]=l,l<n&&(n=l),l>s&&(s=l));if(n>s)return this;this.cover(n).cover(s);for(let o=0;o<e;++o)h4(this,i[o],r[o]);return this}function dre(r){if(isNaN(r=+r))return this;var e=this._x0,i=this._x1;if(isNaN(e))i=(e=Math.floor(r))+1;else{for(var n=i-e||1,s=this._root,o,l;e>r||r>=i;)switch(l=+(r<e),o=new Array(2),o[l]=s,s=o,n*=2,l){case 0:i=e+n;break;case 1:e=i-n;break}this._root&&this._root.length&&(this._root=s)}return this._x0=e,this._x1=i,this}function pre(){var r=[];return this.visit(function(e){if(!e.length)do r.push(e.data);while(e=e.next)}),r}function fre(r){return arguments.length?this.cover(+r[0][0]).cover(+r[1][0]):isNaN(this._x0)?void 0:[[this._x0],[this._x1]]}function Lu(r,e,i){this.node=r,this.x0=e,this.x1=i}function mre(r,e){var i,n=this._x0,s,o,l=this._x1,u=[],c=this._root,h,p;for(c&&u.push(new Lu(c,n,l)),e==null?e=1/0:(n=r-e,l=r+e);h=u.pop();)if(!(!(c=h.node)||(s=h.x0)>l||(o=h.x1)<n))if(c.length){var f=(s+o)/2;u.push(new Lu(c[1],f,o),new Lu(c[0],s,f)),(p=+(r>=f))&&(h=u[u.length-1],u[u.length-1]=u[u.length-1-p],u[u.length-1-p]=h)}else{var m=Math.abs(r-+this._x.call(null,c.data));m<e&&(e=m,n=r-m,l=r+m,i=c.data)}return i}function gre(r){if(isNaN(c=+this._x.call(null,r)))return this;var e,i=this._root,n,s,o,l=this._x0,u=this._x1,c,h,p,f,m;if(!i)return this;if(i.length)for(;;){if((p=c>=(h=(l+u)/2))?l=h:u=h,e=i,!(i=i[f=+p]))return this;if(!i.length)break;e[f+1&1]&&(n=e,m=f)}for(;i.data!==r;)if(s=i,!(i=i.next))return this;return(o=i.next)&&delete i.next,s?(o?s.next=o:delete s.next,this):e?(o?e[f]=o:delete e[f],(i=e[0]||e[1])&&i===(e[1]||e[0])&&!i.length&&(n?n[m]=i:this._root=i),this):(this._root=o,this)}function Are(r){for(var e=0,i=r.length;e<i;++e)this.remove(r[e]);return this}function yre(){return this._root}function vre(){var r=0;return this.visit(function(e){if(!e.length)do++r;while(e=e.next)}),r}function xre(r){var e=[],i,n=this._root,s,o,l;for(n&&e.push(new Lu(n,this._x0,this._x1));i=e.pop();)if(!r(n=i.node,o=i.x0,l=i.x1)&&n.length){var u=(o+l)/2;(s=n[1])&&e.push(new Lu(s,u,l)),(s=n[0])&&e.push(new Lu(s,o,u))}return this}function bre(r){var e=[],i=[],n;for(this._root&&e.push(new Lu(this._root,this._x0,this._x1));n=e.pop();){var s=n.node;if(s.length){var o,l=n.x0,u=n.x1,c=(l+u)/2;(o=s[0])&&e.push(new Lu(o,l,c)),(o=s[1])&&e.push(new Lu(o,c,u))}i.push(n)}for(;n=i.pop();)r(n.node,n.x0,n.x1);return this}function _re(r){return r[0]}function Ere(r){return arguments.length?(this._x=r,this):this._x}function d4(r,e){var i=new fT(e??_re,NaN,NaN);return r==null?i:i.addAll(r)}function fT(r,e,i){this._x=r,this._x0=e,this._x1=i,this._root=void 0}function p4(r){for(var e={data:r.data},i=e;r=r.next;)i=i.next={data:r.data};return e}var Go=d4.prototype=fT.prototype;Go.copy=function(){var r=new fT(this._x,this._x0,this._x1),e=this._root,i,n;if(!e)return r;if(!e.length)return r._root=p4(e),r;for(i=[{source:e,target:r._root=new Array(2)}];e=i.pop();)for(var s=0;s<2;++s)(n=e.source[s])&&(n.length?i.push({source:n,target:e.target[s]=new Array(2)}):e.target[s]=p4(n));return r},Go.add=ure,Go.addAll=hre,Go.cover=dre,Go.data=pre,Go.extent=fre,Go.find=mre,Go.remove=gre,Go.removeAll=Are,Go.root=yre,Go.size=vre,Go.visit=xre,Go.visitAfter=bre,Go.x=Ere;function wre(r){const e=+this._x.call(null,r),i=+this._y.call(null,r);return f4(this.cover(e,i),e,i,r)}function f4(r,e,i,n){if(isNaN(e)||isNaN(i))return r;var s,o=r._root,l={data:n},u=r._x0,c=r._y0,h=r._x1,p=r._y1,f,m,g,y,x,v,_,T;if(!o)return r._root=l,r;for(;o.length;)if((x=e>=(f=(u+h)/2))?u=f:h=f,(v=i>=(m=(c+p)/2))?c=m:p=m,s=o,!(o=o[_=v<<1|x]))return s[_]=l,r;if(g=+r._x.call(null,o.data),y=+r._y.call(null,o.data),e===g&&i===y)return l.next=o,s?s[_]=l:r._root=l,r;do s=s?s[_]=new Array(4):r._root=new Array(4),(x=e>=(f=(u+h)/2))?u=f:h=f,(v=i>=(m=(c+p)/2))?c=m:p=m;while((_=v<<1|x)===(T=(y>=m)<<1|g>=f));return s[T]=o,s[_]=l,r}function Cre(r){var e,i,n=r.length,s,o,l=new Array(n),u=new Array(n),c=1/0,h=1/0,p=-1/0,f=-1/0;for(i=0;i<n;++i)isNaN(s=+this._x.call(null,e=r[i]))||isNaN(o=+this._y.call(null,e))||(l[i]=s,u[i]=o,s<c&&(c=s),s>p&&(p=s),o<h&&(h=o),o>f&&(f=o));if(c>p||h>f)return this;for(this.cover(c,h).cover(p,f),i=0;i<n;++i)f4(this,l[i],u[i],r[i]);return this}function Sre(r,e){if(isNaN(r=+r)||isNaN(e=+e))return this;var i=this._x0,n=this._y0,s=this._x1,o=this._y1;if(isNaN(i))s=(i=Math.floor(r))+1,o=(n=Math.floor(e))+1;else{for(var l=s-i||1,u=this._root,c,h;i>r||r>=s||n>e||e>=o;)switch(h=(e<n)<<1|r<i,c=new Array(4),c[h]=u,u=c,l*=2,h){case 0:s=i+l,o=n+l;break;case 1:i=s-l,o=n+l;break;case 2:s=i+l,n=o-l;break;case 3:i=s-l,n=o-l;break}this._root&&this._root.length&&(this._root=u)}return this._x0=i,this._y0=n,this._x1=s,this._y1=o,this}function Tre(){var r=[];return this.visit(function(e){if(!e.length)do r.push(e.data);while(e=e.next)}),r}function Mre(r){return arguments.length?this.cover(+r[0][0],+r[0][1]).cover(+r[1][0],+r[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function _o(r,e,i,n,s){this.node=r,this.x0=e,this.y0=i,this.x1=n,this.y1=s}function Rre(r,e,i){var n,s=this._x0,o=this._y0,l,u,c,h,p=this._x1,f=this._y1,m=[],g=this._root,y,x;for(g&&m.push(new _o(g,s,o,p,f)),i==null?i=1/0:(s=r-i,o=e-i,p=r+i,f=e+i,i*=i);y=m.pop();)if(!(!(g=y.node)||(l=y.x0)>p||(u=y.y0)>f||(c=y.x1)<s||(h=y.y1)<o))if(g.length){var v=(l+c)/2,_=(u+h)/2;m.push(new _o(g[3],v,_,c,h),new _o(g[2],l,_,v,h),new _o(g[1],v,u,c,_),new _o(g[0],l,u,v,_)),(x=(e>=_)<<1|r>=v)&&(y=m[m.length-1],m[m.length-1]=m[m.length-1-x],m[m.length-1-x]=y)}else{var T=r-+this._x.call(null,g.data),w=e-+this._y.call(null,g.data),S=T*T+w*w;if(S<i){var R=Math.sqrt(i=S);s=r-R,o=e-R,p=r+R,f=e+R,n=g.data}}return n}function Ire(r){if(isNaN(p=+this._x.call(null,r))||isNaN(f=+this._y.call(null,r)))return this;var e,i=this._root,n,s,o,l=this._x0,u=this._y0,c=this._x1,h=this._y1,p,f,m,g,y,x,v,_;if(!i)return this;if(i.length)for(;;){if((y=p>=(m=(l+c)/2))?l=m:c=m,(x=f>=(g=(u+h)/2))?u=g:h=g,e=i,!(i=i[v=x<<1|y]))return this;if(!i.length)break;(e[v+1&3]||e[v+2&3]||e[v+3&3])&&(n=e,_=v)}for(;i.data!==r;)if(s=i,!(i=i.next))return this;return(o=i.next)&&delete i.next,s?(o?s.next=o:delete s.next,this):e?(o?e[v]=o:delete e[v],(i=e[0]||e[1]||e[2]||e[3])&&i===(e[3]||e[2]||e[1]||e[0])&&!i.length&&(n?n[_]=i:this._root=i),this):(this._root=o,this)}function Bre(r){for(var e=0,i=r.length;e<i;++e)this.remove(r[e]);return this}function Nre(){return this._root}function Lre(){var r=0;return this.visit(function(e){if(!e.length)do++r;while(e=e.next)}),r}function Dre(r){var e=[],i,n=this._root,s,o,l,u,c;for(n&&e.push(new _o(n,this._x0,this._y0,this._x1,this._y1));i=e.pop();)if(!r(n=i.node,o=i.x0,l=i.y0,u=i.x1,c=i.y1)&&n.length){var h=(o+u)/2,p=(l+c)/2;(s=n[3])&&e.push(new _o(s,h,p,u,c)),(s=n[2])&&e.push(new _o(s,o,p,h,c)),(s=n[1])&&e.push(new _o(s,h,l,u,p)),(s=n[0])&&e.push(new _o(s,o,l,h,p))}return this}function Ore(r){var e=[],i=[],n;for(this._root&&e.push(new _o(this._root,this._x0,this._y0,this._x1,this._y1));n=e.pop();){var s=n.node;if(s.length){var o,l=n.x0,u=n.y0,c=n.x1,h=n.y1,p=(l+c)/2,f=(u+h)/2;(o=s[0])&&e.push(new _o(o,l,u,p,f)),(o=s[1])&&e.push(new _o(o,p,u,c,f)),(o=s[2])&&e.push(new _o(o,l,f,p,h)),(o=s[3])&&e.push(new _o(o,p,f,c,h))}i.push(n)}for(;n=i.pop();)r(n.node,n.x0,n.y0,n.x1,n.y1);return this}function Pre(r){return r[0]}function kre(r){return arguments.length?(this._x=r,this):this._x}function Fre(r){return r[1]}function Ure(r){return arguments.length?(this._y=r,this):this._y}function m4(r,e,i){var n=new mT(e??Pre,i??Fre,NaN,NaN,NaN,NaN);return r==null?n:n.addAll(r)}function mT(r,e,i,n,s,o){this._x=r,this._y=e,this._x0=i,this._y0=n,this._x1=s,this._y1=o,this._root=void 0}function g4(r){for(var e={data:r.data},i=e;r=r.next;)i=i.next={data:r.data};return e}var Eo=m4.prototype=mT.prototype;Eo.copy=function(){var r=new mT(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,i,n;if(!e)return r;if(!e.length)return r._root=g4(e),r;for(i=[{source:e,target:r._root=new Array(4)}];e=i.pop();)for(var s=0;s<4;++s)(n=e.source[s])&&(n.length?i.push({source:n,target:e.target[s]=new Array(4)}):e.target[s]=g4(n));return r},Eo.add=wre,Eo.addAll=Cre,Eo.cover=Sre,Eo.data=Tre,Eo.extent=Mre,Eo.find=Rre,Eo.remove=Ire,Eo.removeAll=Bre,Eo.root=Nre,Eo.size=Lre,Eo.visit=Dre,Eo.visitAfter=Ore,Eo.x=kre,Eo.y=Ure;function zre(r){const e=+this._x.call(null,r),i=+this._y.call(null,r),n=+this._z.call(null,r);return A4(this.cover(e,i,n),e,i,n,r)}function A4(r,e,i,n,s){if(isNaN(e)||isNaN(i)||isNaN(n))return r;var o,l=r._root,u={data:s},c=r._x0,h=r._y0,p=r._z0,f=r._x1,m=r._y1,g=r._z1,y,x,v,_,T,w,S,R,B,I,D;if(!l)return r._root=u,r;for(;l.length;)if((S=e>=(y=(c+f)/2))?c=y:f=y,(R=i>=(x=(h+m)/2))?h=x:m=x,(B=n>=(v=(p+g)/2))?p=v:g=v,o=l,!(l=l[I=B<<2|R<<1|S]))return o[I]=u,r;if(_=+r._x.call(null,l.data),T=+r._y.call(null,l.data),w=+r._z.call(null,l.data),e===_&&i===T&&n===w)return u.next=l,o?o[I]=u:r._root=u,r;do o=o?o[I]=new Array(8):r._root=new Array(8),(S=e>=(y=(c+f)/2))?c=y:f=y,(R=i>=(x=(h+m)/2))?h=x:m=x,(B=n>=(v=(p+g)/2))?p=v:g=v;while((I=B<<2|R<<1|S)===(D=(w>=v)<<2|(T>=x)<<1|_>=y));return o[D]=l,o[I]=u,r}function jre(r){Array.isArray(r)||(r=Array.from(r));const e=r.length,i=new Float64Array(e),n=new Float64Array(e),s=new Float64Array(e);let o=1/0,l=1/0,u=1/0,c=-1/0,h=-1/0,p=-1/0;for(let f=0,m,g,y,x;f<e;++f)isNaN(g=+this._x.call(null,m=r[f]))||isNaN(y=+this._y.call(null,m))||isNaN(x=+this._z.call(null,m))||(i[f]=g,n[f]=y,s[f]=x,g<o&&(o=g),g>c&&(c=g),y<l&&(l=y),y>h&&(h=y),x<u&&(u=x),x>p&&(p=x));if(o>c||l>h||u>p)return this;this.cover(o,l,u).cover(c,h,p);for(let f=0;f<e;++f)A4(this,i[f],n[f],s[f],r[f]);return this}function Vre(r,e,i){if(isNaN(r=+r)||isNaN(e=+e)||isNaN(i=+i))return this;var n=this._x0,s=this._y0,o=this._z0,l=this._x1,u=this._y1,c=this._z1;if(isNaN(n))l=(n=Math.floor(r))+1,u=(s=Math.floor(e))+1,c=(o=Math.floor(i))+1;else{for(var h=l-n||1,p=this._root,f,m;n>r||r>=l||s>e||e>=u||o>i||i>=c;)switch(m=(i<o)<<2|(e<s)<<1|r<n,f=new Array(8),f[m]=p,p=f,h*=2,m){case 0:l=n+h,u=s+h,c=o+h;break;case 1:n=l-h,u=s+h,c=o+h;break;case 2:l=n+h,s=u-h,c=o+h;break;case 3:n=l-h,s=u-h,c=o+h;break;case 4:l=n+h,u=s+h,o=c-h;break;case 5:n=l-h,u=s+h,o=c-h;break;case 6:l=n+h,s=u-h,o=c-h;break;case 7:n=l-h,s=u-h,o=c-h;break}this._root&&this._root.length&&(this._root=p)}return this._x0=n,this._y0=s,this._z0=o,this._x1=l,this._y1=u,this._z1=c,this}function Gre(){var r=[];return this.visit(function(e){if(!e.length)do r.push(e.data);while(e=e.next)}),r}function Hre(r){return arguments.length?this.cover(+r[0][0],+r[0][1],+r[0][2]).cover(+r[1][0],+r[1][1],+r[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]}function ds(r,e,i,n,s,o,l){this.node=r,this.x0=e,this.y0=i,this.z0=n,this.x1=s,this.y1=o,this.z1=l}function Wre(r,e,i,n){var s,o=this._x0,l=this._y0,u=this._z0,c,h,p,f,m,g,y=this._x1,x=this._y1,v=this._z1,_=[],T=this._root,w,S;for(T&&_.push(new ds(T,o,l,u,y,x,v)),n==null?n=1/0:(o=r-n,l=e-n,u=i-n,y=r+n,x=e+n,v=i+n,n*=n);w=_.pop();)if(!(!(T=w.node)||(c=w.x0)>y||(h=w.y0)>x||(p=w.z0)>v||(f=w.x1)<o||(m=w.y1)<l||(g=w.z1)<u))if(T.length){var R=(c+f)/2,B=(h+m)/2,I=(p+g)/2;_.push(new ds(T[7],R,B,I,f,m,g),new ds(T[6],c,B,I,R,m,g),new ds(T[5],R,h,I,f,B,g),new ds(T[4],c,h,I,R,B,g),new ds(T[3],R,B,p,f,m,I),new ds(T[2],c,B,p,R,m,I),new ds(T[1],R,h,p,f,B,I),new ds(T[0],c,h,p,R,B,I)),(S=(i>=I)<<2|(e>=B)<<1|r>=R)&&(w=_[_.length-1],_[_.length-1]=_[_.length-1-S],_[_.length-1-S]=w)}else{var D=r-+this._x.call(null,T.data),L=e-+this._y.call(null,T.data),O=i-+this._z.call(null,T.data),U=D*D+L*L+O*O;if(U<n){var Z=Math.sqrt(n=U);o=r-Z,l=e-Z,u=i-Z,y=r+Z,x=e+Z,v=i+Z,s=T.data}}return s}function Qre(r){if(isNaN(m=+this._x.call(null,r))||isNaN(g=+this._y.call(null,r))||isNaN(y=+this._z.call(null,r)))return this;var e,i=this._root,n,s,o,l=this._x0,u=this._y0,c=this._z0,h=this._x1,p=this._y1,f=this._z1,m,g,y,x,v,_,T,w,S,R,B;if(!i)return this;if(i.length)for(;;){if((T=m>=(x=(l+h)/2))?l=x:h=x,(w=g>=(v=(u+p)/2))?u=v:p=v,(S=y>=(_=(c+f)/2))?c=_:f=_,e=i,!(i=i[R=S<<2|w<<1|T]))return this;if(!i.length)break;(e[R+1&7]||e[R+2&7]||e[R+3&7]||e[R+4&7]||e[R+5&7]||e[R+6&7]||e[R+7&7])&&(n=e,B=R)}for(;i.data!==r;)if(s=i,!(i=i.next))return this;return(o=i.next)&&delete i.next,s?(o?s.next=o:delete s.next,this):e?(o?e[R]=o:delete e[R],(i=e[0]||e[1]||e[2]||e[3]||e[4]||e[5]||e[6]||e[7])&&i===(e[7]||e[6]||e[5]||e[4]||e[3]||e[2]||e[1]||e[0])&&!i.length&&(n?n[B]=i:this._root=i),this):(this._root=o,this)}function qre(r){for(var e=0,i=r.length;e<i;++e)this.remove(r[e]);return this}function Xre(){return this._root}function Yre(){var r=0;return this.visit(function(e){if(!e.length)do++r;while(e=e.next)}),r}function Kre(r){var e=[],i,n=this._root,s,o,l,u,c,h,p;for(n&&e.push(new ds(n,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));i=e.pop();)if(!r(n=i.node,o=i.x0,l=i.y0,u=i.z0,c=i.x1,h=i.y1,p=i.z1)&&n.length){var f=(o+c)/2,m=(l+h)/2,g=(u+p)/2;(s=n[7])&&e.push(new ds(s,f,m,g,c,h,p)),(s=n[6])&&e.push(new ds(s,o,m,g,f,h,p)),(s=n[5])&&e.push(new ds(s,f,l,g,c,m,p)),(s=n[4])&&e.push(new ds(s,o,l,g,f,m,p)),(s=n[3])&&e.push(new ds(s,f,m,u,c,h,g)),(s=n[2])&&e.push(new ds(s,o,m,u,f,h,g)),(s=n[1])&&e.push(new ds(s,f,l,u,c,m,g)),(s=n[0])&&e.push(new ds(s,o,l,u,f,m,g))}return this}function Jre(r){var e=[],i=[],n;for(this._root&&e.push(new ds(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));n=e.pop();){var s=n.node;if(s.length){var o,l=n.x0,u=n.y0,c=n.z0,h=n.x1,p=n.y1,f=n.z1,m=(l+h)/2,g=(u+p)/2,y=(c+f)/2;(o=s[0])&&e.push(new ds(o,l,u,c,m,g,y)),(o=s[1])&&e.push(new ds(o,m,u,c,h,g,y)),(o=s[2])&&e.push(new ds(o,l,g,c,m,p,y)),(o=s[3])&&e.push(new ds(o,m,g,c,h,p,y)),(o=s[4])&&e.push(new ds(o,l,u,y,m,g,f)),(o=s[5])&&e.push(new ds(o,m,u,y,h,g,f)),(o=s[6])&&e.push(new ds(o,l,g,y,m,p,f)),(o=s[7])&&e.push(new ds(o,m,g,y,h,p,f))}i.push(n)}for(;n=i.pop();)r(n.node,n.x0,n.y0,n.z0,n.x1,n.y1,n.z1);return this}function Zre(r){return r[0]}function $re(r){return arguments.length?(this._x=r,this):this._x}function ene(r){return r[1]}function tne(r){return arguments.length?(this._y=r,this):this._y}function ine(r){return r[2]}function rne(r){return arguments.length?(this._z=r,this):this._z}function y4(r,e,i,n){var s=new gT(e??Zre,i??ene,n??ine,NaN,NaN,NaN,NaN,NaN,NaN);return r==null?s:s.addAll(r)}function gT(r,e,i,n,s,o,l,u,c){this._x=r,this._y=e,this._z=i,this._x0=n,this._y0=s,this._z0=o,this._x1=l,this._y1=u,this._z1=c,this._root=void 0}function v4(r){for(var e={data:r.data},i=e;r=r.next;)i=i.next={data:r.data};return e}var ro=y4.prototype=gT.prototype;ro.copy=function(){var r=new gT(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),e=this._root,i,n;if(!e)return r;if(!e.length)return r._root=v4(e),r;for(i=[{source:e,target:r._root=new Array(8)}];e=i.pop();)for(var s=0;s<8;++s)(n=e.source[s])&&(n.length?i.push({source:n,target:e.target[s]=new Array(8)}):e.target[s]=v4(n));return r},ro.add=zre,ro.addAll=jre,ro.cover=Vre,ro.data=Gre,ro.extent=Hre,ro.find=Wre,ro.remove=Qre,ro.removeAll=qre,ro.root=Xre,ro.size=Yre,ro.visit=Kre,ro.visitAfter=Jre,ro.x=$re,ro.y=tne,ro.z=rne;function Du(r){return function(){return r}}function Ou(r){return(r()-.5)*1e-6}function nne(r){return r.index}function x4(r,e){var i=r.get(e);if(!i)throw new Error("node not found: "+e);return i}function b4(r){var e=nne,i=m,n,s=Du(30),o,l,u,c,h,p,f=1;r==null&&(r=[]);function m(_){return 1/Math.min(c[_.source.index],c[_.target.index])}function g(_){for(var T=0,w=r.length;T<f;++T)for(var S=0,R,B,I,D=0,L=0,O=0,U,Z;S<w;++S)R=r[S],B=R.source,I=R.target,D=I.x+I.vx-B.x-B.vx||Ou(p),u>1&&(L=I.y+I.vy-B.y-B.vy||Ou(p)),u>2&&(O=I.z+I.vz-B.z-B.vz||Ou(p)),U=Math.sqrt(D*D+L*L+O*O),U=(U-o[S])/U*_*n[S],D*=U,L*=U,O*=U,I.vx-=D*(Z=h[S]),u>1&&(I.vy-=L*Z),u>2&&(I.vz-=O*Z),B.vx+=D*(Z=1-Z),u>1&&(B.vy+=L*Z),u>2&&(B.vz+=O*Z)}function y(){if(l){var _,T=l.length,w=r.length,S=new Map(l.map((B,I)=>[e(B,I,l),B])),R;for(_=0,c=new Array(T);_<w;++_)R=r[_],R.index=_,typeof R.source!="object"&&(R.source=x4(S,R.source)),typeof R.target!="object"&&(R.target=x4(S,R.target)),c[R.source.index]=(c[R.source.index]||0)+1,c[R.target.index]=(c[R.target.index]||0)+1;for(_=0,h=new Array(w);_<w;++_)R=r[_],h[_]=c[R.source.index]/(c[R.source.index]+c[R.target.index]);n=new Array(w),x(),o=new Array(w),v()}}function x(){if(l)for(var _=0,T=r.length;_<T;++_)n[_]=+i(r[_],_,r)}function v(){if(l)for(var _=0,T=r.length;_<T;++_)o[_]=+s(r[_],_,r)}return g.initialize=function(_,...T){l=_,p=T.find(w=>typeof w=="function")||Math.random,u=T.find(w=>[1,2,3].includes(w))||2,y()},g.links=function(_){return arguments.length?(r=_,y(),g):r},g.id=function(_){return arguments.length?(e=_,g):e},g.iterations=function(_){return arguments.length?(f=+_,g):f},g.strength=function(_){return arguments.length?(i=typeof _=="function"?_:Du(+_),x(),g):i},g.distance=function(_){return arguments.length?(s=typeof _=="function"?_:Du(+_),v(),g):s},g}var sne={value:()=>{}};function NA(){for(var r=0,e=arguments.length,i={},n;r<e;++r){if(!(n=arguments[r]+"")||n in i||/[\s.]/.test(n))throw new Error("illegal type: "+n);i[n]=[]}return new Hb(i)}function Hb(r){this._=r}function ane(r,e){return r.trim().split(/^|\s+/).map(function(i){var n="",s=i.indexOf(".");if(s>=0&&(n=i.slice(s+1),i=i.slice(0,s)),i&&!e.hasOwnProperty(i))throw new Error("unknown type: "+i);return{type:i,name:n}})}Hb.prototype=NA.prototype={constructor:Hb,on:function(r,e){var i=this._,n=ane(r+"",i),s,o=-1,l=n.length;if(arguments.length<2){for(;++o<l;)if((s=(r=n[o]).type)&&(s=one(i[s],r.name)))return s;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++o<l;)if(s=(r=n[o]).type)i[s]=_4(i[s],r.name,e);else if(e==null)for(s in i)i[s]=_4(i[s],r.name,null);return this},copy:function(){var r={},e=this._;for(var i in e)r[i]=e[i].slice();return new Hb(r)},call:function(r,e){if((s=arguments.length-2)>0)for(var i=new Array(s),n=0,s,o;n<s;++n)i[n]=arguments[n+2];if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(o=this._[r],n=0,s=o.length;n<s;++n)o[n].value.apply(e,i)},apply:function(r,e,i){if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(var n=this._[r],s=0,o=n.length;s<o;++s)n[s].value.apply(e,i)}};function one(r,e){for(var i=0,n=r.length,s;i<n;++i)if((s=r[i]).name===e)return s.value}function _4(r,e,i){for(var n=0,s=r.length;n<s;++n)if(r[n].name===e){r[n]=sne,r=r.slice(0,n).concat(r.slice(n+1));break}return i!=null&&r.push({name:e,value:i}),r}var Hm=0,LA=0,DA=0,E4=1e3,Wb,OA,Qb=0,_p=0,qb=0,PA=typeof performance=="object"&&performance.now?performance:Date,w4=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(r){setTimeout(r,17)};function AT(){return _p||(w4(lne),_p=PA.now()+qb)}function lne(){_p=0}function Xb(){this._call=this._time=this._next=null}Xb.prototype=yT.prototype={constructor:Xb,restart:function(r,e,i){if(typeof r!="function")throw new TypeError("callback is not a function");i=(i==null?AT():+i)+(e==null?0:+e),!this._next&&OA!==this&&(OA?OA._next=this:Wb=this,OA=this),this._call=r,this._time=i,vT()},stop:function(){this._call&&(this._call=null,this._time=1/0,vT())}};function yT(r,e,i){var n=new Xb;return n.restart(r,e,i),n}function cne(){AT(),++Hm;for(var r=Wb,e;r;)(e=_p-r._time)>=0&&r._call.call(void 0,e),r=r._next;--Hm}function C4(){_p=(Qb=PA.now())+qb,Hm=LA=0;try{cne()}finally{Hm=0,hne(),_p=0}}function une(){var r=PA.now(),e=r-Qb;e>E4&&(qb-=e,Qb=r)}function hne(){for(var r,e=Wb,i,n=1/0;e;)e._call?(n>e._time&&(n=e._time),r=e,e=e._next):(i=e._next,e._next=null,e=r?r._next=i:Wb=i);OA=r,vT(n)}function vT(r){if(!Hm){LA&&(LA=clearTimeout(LA));var e=r-_p;e>24?(r<1/0&&(LA=setTimeout(C4,r-PA.now()-qb)),DA&&(DA=clearInterval(DA))):(DA||(Qb=PA.now(),DA=setInterval(une,E4)),Hm=1,w4(C4))}}function S4(r,e,i){var n=new Xb;return e=e==null?0:+e,n.restart(s=>{n.stop(),r(s+e)},e,i),n}const dne=1664525,pne=1013904223,T4=4294967296;function fne(){let r=1;return()=>(r=(dne*r+pne)%T4)/T4}var M4=3;function xT(r){return r.x}function R4(r){return r.y}function mne(r){return r.z}var gne=10,Ane=Math.PI*(3-Math.sqrt(5)),yne=Math.PI*20/(9+Math.sqrt(221));function I4(r,e){e=e||2;var i=Math.min(M4,Math.max(1,Math.round(e))),n,s=1,o=.001,l=1-Math.pow(o,1/300),u=0,c=.6,h=new Map,p=yT(g),f=NA("tick","end"),m=fne();r==null&&(r=[]);function g(){y(),f.call("tick",n),s<o&&(p.stop(),f.call("end",n))}function y(_){var T,w=r.length,S;_===void 0&&(_=1);for(var R=0;R<_;++R)for(s+=(u-s)*l,h.forEach(function(B){B(s)}),T=0;T<w;++T)S=r[T],S.fx==null?S.x+=S.vx*=c:(S.x=S.fx,S.vx=0),i>1&&(S.fy==null?S.y+=S.vy*=c:(S.y=S.fy,S.vy=0)),i>2&&(S.fz==null?S.z+=S.vz*=c:(S.z=S.fz,S.vz=0));return n}function x(){for(var _=0,T=r.length,w;_<T;++_){if(w=r[_],w.index=_,w.fx!=null&&(w.x=w.fx),w.fy!=null&&(w.y=w.fy),w.fz!=null&&(w.z=w.fz),isNaN(w.x)||i>1&&isNaN(w.y)||i>2&&isNaN(w.z)){var S=gne*(i>2?Math.cbrt(.5+_):i>1?Math.sqrt(.5+_):_),R=_*Ane,B=_*yne;i===1?w.x=S:i===2?(w.x=S*Math.cos(R),w.y=S*Math.sin(R)):(w.x=S*Math.sin(R)*Math.cos(B),w.y=S*Math.cos(R),w.z=S*Math.sin(R)*Math.sin(B))}(isNaN(w.vx)||i>1&&isNaN(w.vy)||i>2&&isNaN(w.vz))&&(w.vx=0,i>1&&(w.vy=0),i>2&&(w.vz=0))}}function v(_){return _.initialize&&_.initialize(r,m,i),_}return x(),n={tick:y,restart:function(){return p.restart(g),n},stop:function(){return p.stop(),n},numDimensions:function(_){return arguments.length?(i=Math.min(M4,Math.max(1,Math.round(_))),h.forEach(v),n):i},nodes:function(_){return arguments.length?(r=_,x(),h.forEach(v),n):r},alpha:function(_){return arguments.length?(s=+_,n):s},alphaMin:function(_){return arguments.length?(o=+_,n):o},alphaDecay:function(_){return arguments.length?(l=+_,n):+l},alphaTarget:function(_){return arguments.length?(u=+_,n):u},velocityDecay:function(_){return arguments.length?(c=1-_,n):1-c},randomSource:function(_){return arguments.length?(m=_,h.forEach(v),n):m},force:function(_,T){return arguments.length>1?(T==null?h.delete(_):h.set(_,v(T)),n):h.get(_)},find:function(){var _=Array.prototype.slice.call(arguments),T=_.shift()||0,w=(i>1?_.shift():null)||0,S=(i>2?_.shift():null)||0,R=_.shift()||1/0,B=0,I=r.length,D,L,O,U,Z,G;for(R*=R,B=0;B<I;++B)Z=r[B],D=T-Z.x,L=w-(Z.y||0),O=S-(Z.z||0),U=D*D+L*L+O*O,U<R&&(G=Z,R=U);return G},on:function(_,T){return arguments.length>1?(f.on(_,T),n):f.on(_)}}}function B4(){var r,e,i,n,s,o=Du(-30),l,u=1,c=1/0,h=.81;function p(y){var x,v=r.length,_=(e===1?d4(r,xT):e===2?m4(r,xT,R4):e===3?y4(r,xT,R4,mne):null).visitAfter(m);for(s=y,x=0;x<v;++x)i=r[x],_.visit(g)}function f(){if(r){var y,x=r.length,v;for(l=new Array(x),y=0;y<x;++y)v=r[y],l[v.index]=+o(v,y,r)}}function m(y){var x=0,v,_,T=0,w,S,R,B,I=y.length;if(I){for(w=S=R=B=0;B<I;++B)(v=y[B])&&(_=Math.abs(v.value))&&(x+=v.value,T+=_,w+=_*(v.x||0),S+=_*(v.y||0),R+=_*(v.z||0));x*=Math.sqrt(4/I),y.x=w/T,e>1&&(y.y=S/T),e>2&&(y.z=R/T)}else{v=y,v.x=v.data.x,e>1&&(v.y=v.data.y),e>2&&(v.z=v.data.z);do x+=l[v.data.index];while(v=v.next)}y.value=x}function g(y,x,v,_,T){if(!y.value)return!0;var w=[v,_,T][e-1],S=y.x-i.x,R=e>1?y.y-i.y:0,B=e>2?y.z-i.z:0,I=w-x,D=S*S+R*R+B*B;if(I*I/h<D)return D<c&&(S===0&&(S=Ou(n),D+=S*S),e>1&&R===0&&(R=Ou(n),D+=R*R),e>2&&B===0&&(B=Ou(n),D+=B*B),D<u&&(D=Math.sqrt(u*D)),i.vx+=S*y.value*s/D,e>1&&(i.vy+=R*y.value*s/D),e>2&&(i.vz+=B*y.value*s/D)),!0;if(!(y.length||D>=c)){(y.data!==i||y.next)&&(S===0&&(S=Ou(n),D+=S*S),e>1&&R===0&&(R=Ou(n),D+=R*R),e>2&&B===0&&(B=Ou(n),D+=B*B),D<u&&(D=Math.sqrt(u*D)));do y.data!==i&&(I=l[y.data.index]*s/D,i.vx+=S*I,e>1&&(i.vy+=R*I),e>2&&(i.vz+=B*I));while(y=y.next)}}return p.initialize=function(y,...x){r=y,n=x.find(v=>typeof v=="function")||Math.random,e=x.find(v=>[1,2,3].includes(v))||2,f()},p.strength=function(y){return arguments.length?(o=typeof y=="function"?y:Du(+y),f(),p):o},p.distanceMin=function(y){return arguments.length?(u=y*y,p):Math.sqrt(u)},p.distanceMax=function(y){return arguments.length?(c=y*y,p):Math.sqrt(c)},p.theta=function(y){return arguments.length?(h=y*y,p):Math.sqrt(h)},p}function N4(r,e,i,n){var s,o,l=Du(.1),u,c;typeof r!="function"&&(r=Du(+r)),e==null&&(e=0),i==null&&(i=0),n==null&&(n=0);function h(f){for(var m=0,g=s.length;m<g;++m){var y=s[m],x=y.x-e||1e-6,v=(y.y||0)-i||1e-6,_=(y.z||0)-n||1e-6,T=Math.sqrt(x*x+v*v+_*_),w=(c[m]-T)*u[m]*f/T;y.vx+=x*w,o>1&&(y.vy+=v*w),o>2&&(y.vz+=_*w)}}function p(){if(s){var f,m=s.length;for(u=new Array(m),c=new Array(m),f=0;f<m;++f)c[f]=+r(s[f],f,s),u[f]=isNaN(c[f])?0:+l(s[f],f,s)}}return h.initialize=function(f,...m){s=f,o=m.find(g=>[1,2,3].includes(g))||2,p()},h.strength=function(f){return arguments.length?(l=typeof f=="function"?f:Du(+f),p(),h):l},h.radius=function(f){return arguments.length?(r=typeof f=="function"?f:Du(+f),p(),h):r},h.x=function(f){return arguments.length?(e=+f,h):e},h.y=function(f){return arguments.length?(i=+f,h):i},h.z=function(f){return arguments.length?(n=+f,h):n},h}var bT=function(r){xne(r);var e=vne(r);return r.on=e.on,r.off=e.off,r.fire=e.fire,r};function vne(r){var e=Object.create(null);return{on:function(i,n,s){if(typeof n!="function")throw new Error("callback is expected to be a function");var o=e[i];return o||(o=e[i]=[]),o.push({callback:n,ctx:s}),r},off:function(i,n){var s=typeof i>"u";if(s)return e=Object.create(null),r;if(e[i]){var o=typeof n!="function";if(o)delete e[i];else for(var l=e[i],u=0;u<l.length;++u)l[u].callback===n&&l.splice(u,1)}return r},fire:function(i){var n=e[i];if(!n)return r;var s;arguments.length>1&&(s=Array.prototype.splice.call(arguments,1));for(var o=0;o<n.length;++o){var l=n[o];l.callback.apply(l.ctx,s)}return r}}}function xne(r){if(!r)throw new Error("Eventify cannot use falsy object as events subject");for(var e=["on","fire","off"],i=0;i<e.length;++i)if(r.hasOwnProperty(e[i]))throw new Error("Subject cannot be eventified, since it already has property '"+e[i]+"'")}var bne=Ene,_ne=bT;function Ene(r){if(r=r||{},"uniqueLinkId"in r&&(console.warn("ngraph.graph: Starting from version 0.14 `uniqueLinkId` is deprecated.\nUse `multigraph` option instead\n",`
`,`Note: there is also change in default behavior: From now on each graph
is considered to be not a multigraph by default (each edge is unique).`),r.multigraph=r.uniqueLinkId),r.multigraph===void 0&&(r.multigraph=!1),typeof Map!="function")throw new Error("ngraph.graph requires `Map` to be defined. Please polyfill it before using ngraph");var e=new Map,i=new Map,n={},s=0,o=r.multigraph?S:w,l=[],u=Q,c=Q,h=Q,p=Q,f={version:20,addNode:x,addLink:T,removeLink:D,removeNode:_,getNode:v,getNodeCount:R,getLinkCount:B,getEdgeCount:B,getLinksCount:B,getNodesCount:R,getLinks:I,forEachNode:ne,forEachLinkedNode:G,forEachLink:Z,beginUpdate:h,endUpdate:p,clear:U,hasLink:O,hasNode:v,getLink:O};return _ne(f),m(),f;function m(){var Y=f.on;f.on=ae;function ae(){return f.beginUpdate=h=H,f.endUpdate=p=V,u=g,c=y,f.on=Y,Y.apply(f,arguments)}}function g(Y,ae){l.push({link:Y,changeType:ae})}function y(Y,ae){l.push({node:Y,changeType:ae})}function x(Y,ae){if(Y===void 0)throw new Error("Invalid node identifier");h();var xe=v(Y);return xe?(xe.data=ae,c(xe,"update")):(xe=new wne(Y,ae),c(xe,"add")),e.set(Y,xe),p(),xe}function v(Y){return e.get(Y)}function _(Y){var ae=v(Y);if(!ae)return!1;h();var xe=ae.links;return xe&&(xe.forEach(L),ae.links=null),e.delete(Y),c(ae,"remove"),p(),!0}function T(Y,ae,xe){h();var fe=v(Y)||x(Y),de=v(ae)||x(ae),Ie=o(Y,ae,xe),Ge=i.has(Ie.id);return i.set(Ie.id,Ie),L4(fe,Ie),Y!==ae&&L4(de,Ie),u(Ie,Ge?"update":"add"),p(),Ie}function w(Y,ae,xe){var fe=Yb(Y,ae),de=i.get(fe);return de?(de.data=xe,de):new D4(Y,ae,xe,fe)}function S(Y,ae,xe){var fe=Yb(Y,ae),de=n.hasOwnProperty(fe);if(de||O(Y,ae)){de||(n[fe]=0);var Ie="@"+ ++n[fe];fe=Yb(Y+Ie,ae+Ie)}return new D4(Y,ae,xe,fe)}function R(){return e.size}function B(){return i.size}function I(Y){var ae=v(Y);return ae?ae.links:null}function D(Y,ae){return ae!==void 0&&(Y=O(Y,ae)),L(Y)}function L(Y){if(!Y||!i.get(Y.id))return!1;h(),i.delete(Y.id);var ae=v(Y.fromId),xe=v(Y.toId);return ae&&ae.links.delete(Y),xe&&xe.links.delete(Y),u(Y,"remove"),p(),!0}function O(Y,ae){if(!(Y===void 0||ae===void 0))return i.get(Yb(Y,ae))}function U(){h(),ne(function(Y){_(Y.id)}),p()}function Z(Y){if(typeof Y=="function")for(var ae=i.values(),xe=ae.next();!xe.done;){if(Y(xe.value))return!0;xe=ae.next()}}function G(Y,ae,xe){var fe=v(Y);if(fe&&fe.links&&typeof ae=="function")return xe?$(fe.links,Y,ae):z(fe.links,Y,ae)}function z(Y,ae,xe){for(var fe,de=Y.values(),Ie=de.next();!Ie.done;){var Ge=Ie.value,Xe=Ge.fromId===ae?Ge.toId:Ge.fromId;if(fe=xe(e.get(Xe),Ge),fe)return!0;Ie=de.next()}}function $(Y,ae,xe){for(var fe,de=Y.values(),Ie=de.next();!Ie.done;){var Ge=Ie.value;if(Ge.fromId===ae&&(fe=xe(e.get(Ge.toId),Ge),fe))return!0;Ie=de.next()}}function Q(){}function H(){s+=1}function V(){s-=1,s===0&&l.length>0&&(f.fire("changed",l),l.length=0)}function ne(Y){if(typeof Y!="function")throw new Error("Function is expected to iterate over graph nodes. You passed "+Y);for(var ae=e.values(),xe=ae.next();!xe.done;){if(Y(xe.value))return!0;xe=ae.next()}}}function wne(r,e){this.id=r,this.links=null,this.data=e}function L4(r,e){r.links?r.links.add(e):r.links=new Set([e])}function D4(r,e,i,n){this.fromId=r,this.toId=e,this.data=i,this.id=n}function Yb(r,e){return r.toString()+"👉 "+e.toString()}const Cne=v2(bne);var _T={exports:{}},kA={exports:{}},O4=function(r){return r===0?"x":r===1?"y":r===2?"z":"c"+(r+1)};const Sne=O4;var Wm=function(r){return e;function e(i,n){let s=n&&n.indent||0,o=n&&n.join!==void 0?n.join:`
`,l=Array(s+1).join(" "),u=[];for(let c=0;c<r;++c){let h=Sne(c),p=c===0?"":l;u.push(p+i.replace(/{var}/g,h))}return u.join(o)}};const P4=Wm;kA.exports=Tne,kA.exports.generateCreateBodyFunctionBody=k4,kA.exports.getVectorCode=U4,kA.exports.getBodyCode=F4;function Tne(r,e){let i=k4(r,e),{Body:n}=new Function(i)();return n}function k4(r,e){return`
${U4(r,e)}
${F4(r)}
return {Body: Body, Vector: Vector};
`}function F4(r){let e=P4(r),i=e("{var}",{join:", "});return`
function Body(${i}) {
  this.isPinned = false;
  this.pos = new Vector(${i});
  this.force = new Vector();
  this.velocity = new Vector();
  this.mass = 1;

  this.springCount = 0;
  this.springLength = 0;
}

Body.prototype.reset = function() {
  this.force.reset();
  this.springCount = 0;
  this.springLength = 0;
}

Body.prototype.setPosition = function (${i}) {
  ${e("this.pos.{var} = {var} || 0;",{indent:2})}
};`}function U4(r,e){let i=P4(r),n="";return e&&(n=`${i(`
   var v{var};
Object.defineProperty(this, '{var}', {
  set: function(v) { 
    if (!Number.isFinite(v)) throw new Error('Cannot set non-numbers to {var}');
    v{var} = v; 
  },
  get: function() { return v{var}; }
});`)}`),`function Vector(${i("{var}",{join:", "})}) {
  ${n}
    if (typeof arguments[0] === 'object') {
      // could be another vector
      let v = arguments[0];
      ${i('if (!Number.isFinite(v.{var})) throw new Error("Expected value is not a finite number at Vector constructor ({var})");',{indent:4})}
      ${i("this.{var} = v.{var};",{indent:4})}
    } else {
      ${i('this.{var} = typeof {var} === "number" ? {var} : 0;',{indent:4})}
    }
  }
  
  Vector.prototype.reset = function () {
    ${i("this.{var} = ",{join:""})}0;
  };`}var Mne=kA.exports,$h={exports:{}};const ET=Wm,ed=O4;$h.exports=Rne,$h.exports.generateQuadTreeFunctionBody=z4,$h.exports.getInsertStackCode=W4,$h.exports.getQuadNodeCode=H4,$h.exports.isSamePosition=j4,$h.exports.getChildBodyCode=G4,$h.exports.setChildBodyCode=V4;function Rne(r){let e=z4(r);return new Function(e)()}function z4(r){let e=ET(r),i=Math.pow(2,r);return`
${W4()}
${H4(r)}
${j4(r)}
${G4(r)}
${V4(r)}

function createQuadTree(options, random) {
  options = options || {};
  options.gravity = typeof options.gravity === 'number' ? options.gravity : -1;
  options.theta = typeof options.theta === 'number' ? options.theta : 0.8;

  var gravity = options.gravity;
  var updateQueue = [];
  var insertStack = new InsertStack();
  var theta = options.theta;

  var nodesCache = [];
  var currentInCache = 0;
  var root = newNode();

  return {
    insertBodies: insertBodies,

    /**
     * Gets root node if it is present
     */
    getRoot: function() {
      return root;
    },

    updateBodyForce: update,

    options: function(newOptions) {
      if (newOptions) {
        if (typeof newOptions.gravity === 'number') {
          gravity = newOptions.gravity;
        }
        if (typeof newOptions.theta === 'number') {
          theta = newOptions.theta;
        }

        return this;
      }

      return {
        gravity: gravity,
        theta: theta
      };
    }
  };

  function newNode() {
    // To avoid pressure on GC we reuse nodes.
    var node = nodesCache[currentInCache];
    if (node) {
${o("      node.")}
      node.body = null;
      node.mass = ${e("node.mass_{var} = ",{join:""})}0;
      ${e("node.min_{var} = node.max_{var} = ",{join:""})}0;
    } else {
      node = new QuadNode();
      nodesCache[currentInCache] = node;
    }

    ++currentInCache;
    return node;
  }

  function update(sourceBody) {
    var queue = updateQueue;
    var v;
    ${e("var d{var};",{indent:4})}
    var r; 
    ${e("var f{var} = 0;",{indent:4})}
    var queueLength = 1;
    var shiftIdx = 0;
    var pushIdx = 1;

    queue[0] = root;

    while (queueLength) {
      var node = queue[shiftIdx];
      var body = node.body;

      queueLength -= 1;
      shiftIdx += 1;
      var differentBody = (body !== sourceBody);
      if (body && differentBody) {
        // If the current node is a leaf node (and it is not source body),
        // calculate the force exerted by the current node on body, and add this
        // amount to body's net force.
        ${e("d{var} = body.pos.{var} - sourceBody.pos.{var};",{indent:8})}
        r = Math.sqrt(${e("d{var} * d{var}",{join:" + "})});

        if (r === 0) {
          // Poor man's protection against zero distance.
          ${e("d{var} = (random.nextDouble() - 0.5) / 50;",{indent:10})}
          r = Math.sqrt(${e("d{var} * d{var}",{join:" + "})});
        }

        // This is standard gravitation force calculation but we divide
        // by r^3 to save two operations when normalizing force vector.
        v = gravity * body.mass * sourceBody.mass / (r * r * r);
        ${e("f{var} += v * d{var};",{indent:8})}
      } else if (differentBody) {
        // Otherwise, calculate the ratio s / r,  where s is the width of the region
        // represented by the internal node, and r is the distance between the body
        // and the node's center-of-mass
        ${e("d{var} = node.mass_{var} / node.mass - sourceBody.pos.{var};",{indent:8})}
        r = Math.sqrt(${e("d{var} * d{var}",{join:" + "})});

        if (r === 0) {
          // Sorry about code duplication. I don't want to create many functions
          // right away. Just want to see performance first.
          ${e("d{var} = (random.nextDouble() - 0.5) / 50;",{indent:10})}
          r = Math.sqrt(${e("d{var} * d{var}",{join:" + "})});
        }
        // If s / r < θ, treat this internal node as a single body, and calculate the
        // force it exerts on sourceBody, and add this amount to sourceBody's net force.
        if ((node.max_${ed(0)} - node.min_${ed(0)}) / r < theta) {
          // in the if statement above we consider node's width only
          // because the region was made into square during tree creation.
          // Thus there is no difference between using width or height.
          v = gravity * node.mass * sourceBody.mass / (r * r * r);
          ${e("f{var} += v * d{var};",{indent:10})}
        } else {
          // Otherwise, run the procedure recursively on each of the current node's children.

          // I intentionally unfolded this loop, to save several CPU cycles.
${s()}
        }
      }
    }

    ${e("sourceBody.force.{var} += f{var};",{indent:4})}
  }

  function insertBodies(bodies) {
    ${e("var {var}min = Number.MAX_VALUE;",{indent:4})}
    ${e("var {var}max = Number.MIN_VALUE;",{indent:4})}
    var i = bodies.length;

    // To reduce quad tree depth we are looking for exact bounding box of all particles.
    while (i--) {
      var pos = bodies[i].pos;
      ${e("if (pos.{var} < {var}min) {var}min = pos.{var};",{indent:6})}
      ${e("if (pos.{var} > {var}max) {var}max = pos.{var};",{indent:6})}
    }

    // Makes the bounds square.
    var maxSideLength = -Infinity;
    ${e("if ({var}max - {var}min > maxSideLength) maxSideLength = {var}max - {var}min ;",{indent:4})}

    currentInCache = 0;
    root = newNode();
    ${e("root.min_{var} = {var}min;",{indent:4})}
    ${e("root.max_{var} = {var}min + maxSideLength;",{indent:4})}

    i = bodies.length - 1;
    if (i >= 0) {
      root.body = bodies[i];
    }
    while (i--) {
      insert(bodies[i], root);
    }
  }

  function insert(newBody) {
    insertStack.reset();
    insertStack.push(root, newBody);

    while (!insertStack.isEmpty()) {
      var stackItem = insertStack.pop();
      var node = stackItem.node;
      var body = stackItem.body;

      if (!node.body) {
        // This is internal node. Update the total mass of the node and center-of-mass.
        ${e("var {var} = body.pos.{var};",{indent:8})}
        node.mass += body.mass;
        ${e("node.mass_{var} += body.mass * {var};",{indent:8})}

        // Recursively insert the body in the appropriate quadrant.
        // But first find the appropriate quadrant.
        var quadIdx = 0; // Assume we are in the 0's quad.
        ${e("var min_{var} = node.min_{var};",{indent:8})}
        ${e("var max_{var} = (min_{var} + node.max_{var}) / 2;",{indent:8})}

${n(8)}

        var child = getChild(node, quadIdx);

        if (!child) {
          // The node is internal but this quadrant is not taken. Add
          // subnode to it.
          child = newNode();
          ${e("child.min_{var} = min_{var};",{indent:10})}
          ${e("child.max_{var} = max_{var};",{indent:10})}
          child.body = body;

          setChild(node, quadIdx, child);
        } else {
          // continue searching in this quadrant.
          insertStack.push(child, body);
        }
      } else {
        // We are trying to add to the leaf node.
        // We have to convert current leaf into internal node
        // and continue adding two nodes.
        var oldBody = node.body;
        node.body = null; // internal nodes do not cary bodies

        if (isSamePosition(oldBody.pos, body.pos)) {
          // Prevent infinite subdivision by bumping one node
          // anywhere in this quadrant
          var retriesCount = 3;
          do {
            var offset = random.nextDouble();
            ${e("var d{var} = (node.max_{var} - node.min_{var}) * offset;",{indent:12})}

            ${e("oldBody.pos.{var} = node.min_{var} + d{var};",{indent:12})}
            retriesCount -= 1;
            // Make sure we don't bump it out of the box. If we do, next iteration should fix it
          } while (retriesCount > 0 && isSamePosition(oldBody.pos, body.pos));

          if (retriesCount === 0 && isSamePosition(oldBody.pos, body.pos)) {
            // This is very bad, we ran out of precision.
            // if we do not return from the method we'll get into
            // infinite loop here. So we sacrifice correctness of layout, and keep the app running
            // Next layout iteration should get larger bounding box in the first step and fix this
            return;
          }
        }
        // Next iteration should subdivide node further.
        insertStack.push(node, oldBody);
        insertStack.push(node, body);
      }
    }
  }
}
return createQuadTree;

`;function n(l){let u=[],c=Array(l+1).join(" ");for(let h=0;h<r;++h)u.push(c+`if (${ed(h)} > max_${ed(h)}) {`),u.push(c+`  quadIdx = quadIdx + ${Math.pow(2,h)};`),u.push(c+`  min_${ed(h)} = max_${ed(h)};`),u.push(c+`  max_${ed(h)} = node.max_${ed(h)};`),u.push(c+"}");return u.join(`
`)}function s(){let l=Array(11).join(" "),u=[];for(let c=0;c<i;++c)u.push(l+`if (node.quad${c}) {`),u.push(l+`  queue[pushIdx] = node.quad${c};`),u.push(l+"  queueLength += 1;"),u.push(l+"  pushIdx += 1;"),u.push(l+"}");return u.join(`
`)}function o(l){let u=[];for(let c=0;c<i;++c)u.push(`${l}quad${c} = null;`);return u.join(`
`)}}function j4(r){let e=ET(r);return`
  function isSamePosition(point1, point2) {
    ${e("var d{var} = Math.abs(point1.{var} - point2.{var});",{indent:2})}
  
    return ${e("d{var} < 1e-8",{join:" && "})};
  }  
`}function V4(r){var e=Math.pow(2,r);return`
function setChild(node, idx, child) {
  ${i()}
}`;function i(){let n=[];for(let s=0;s<e;++s){let o=s===0?"  ":"  else ";n.push(`${o}if (idx === ${s}) node.quad${s} = child;`)}return n.join(`
`)}}function G4(r){return`function getChild(node, idx) {
${e()}
  return null;
}`;function e(){let i=[],n=Math.pow(2,r);for(let s=0;s<n;++s)i.push(`  if (idx === ${s}) return node.quad${s};`);return i.join(`
`)}}function H4(r){let e=ET(r),i=Math.pow(2,r);var n=`
function QuadNode() {
  // body stored inside this node. In quad tree only leaf nodes (by construction)
  // contain bodies:
  this.body = null;

  // Child nodes are stored in quads. Each quad is presented by number:
  // 0 | 1
  // -----
  // 2 | 3
${s("  this.")}

  // Total mass of current node
  this.mass = 0;

  // Center of mass coordinates
  ${e("this.mass_{var} = 0;",{indent:2})}

  // bounding box coordinates
  ${e("this.min_{var} = 0;",{indent:2})}
  ${e("this.max_{var} = 0;",{indent:2})}
}
`;return n;function s(o){let l=[];for(let u=0;u<i;++u)l.push(`${o}quad${u} = null;`);return l.join(`
`)}}function W4(){return`
/**
 * Our implementation of QuadTree is non-recursive to avoid GC hit
 * This data structure represent stack of elements
 * which we are trying to insert into quad tree.
 */
function InsertStack () {
    this.stack = [];
    this.popIdx = 0;
}

InsertStack.prototype = {
    isEmpty: function() {
        return this.popIdx === 0;
    },
    push: function (node, body) {
        var item = this.stack[this.popIdx];
        if (!item) {
            // we are trying to avoid memory pressure: create new element
            // only when absolutely necessary
            this.stack[this.popIdx] = new InsertStackElement(node, body);
        } else {
            item.node = node;
            item.body = body;
        }
        ++this.popIdx;
    },
    pop: function () {
        if (this.popIdx > 0) {
            return this.stack[--this.popIdx];
        }
    },
    reset: function () {
        this.popIdx = 0;
    }
};

function InsertStackElement(node, body) {
    this.node = node; // QuadTree node
    this.body = body; // physical body which needs to be inserted to node
}
`}var Ine=$h.exports,wT={exports:{}};wT.exports=Nne,wT.exports.generateFunctionBody=Q4;const Bne=Wm;function Nne(r){let e=Q4(r);return new Function("bodies","settings","random",e)}function Q4(r){let e=Bne(r);return`
  var boundingBox = {
    ${e("min_{var}: 0, max_{var}: 0,",{indent:4})}
  };

  return {
    box: boundingBox,

    update: updateBoundingBox,

    reset: resetBoundingBox,

    getBestNewPosition: function (neighbors) {
      var ${e("base_{var} = 0",{join:", "})};

      if (neighbors.length) {
        for (var i = 0; i < neighbors.length; ++i) {
          let neighborPos = neighbors[i].pos;
          ${e("base_{var} += neighborPos.{var};",{indent:10})}
        }

        ${e("base_{var} /= neighbors.length;",{indent:8})}
      } else {
        ${e("base_{var} = (boundingBox.min_{var} + boundingBox.max_{var}) / 2;",{indent:8})}
      }

      var springLength = settings.springLength;
      return {
        ${e("{var}: base_{var} + (random.nextDouble() - 0.5) * springLength,",{indent:8})}
      };
    }
  };

  function updateBoundingBox() {
    var i = bodies.length;
    if (i === 0) return; // No bodies - no borders.

    ${e("var max_{var} = -Infinity;",{indent:4})}
    ${e("var min_{var} = Infinity;",{indent:4})}

    while(i--) {
      // this is O(n), it could be done faster with quadtree, if we check the root node bounds
      var bodyPos = bodies[i].pos;
      ${e("if (bodyPos.{var} < min_{var}) min_{var} = bodyPos.{var};",{indent:6})}
      ${e("if (bodyPos.{var} > max_{var}) max_{var} = bodyPos.{var};",{indent:6})}
    }

    ${e("boundingBox.min_{var} = min_{var};",{indent:4})}
    ${e("boundingBox.max_{var} = max_{var};",{indent:4})}
  }

  function resetBoundingBox() {
    ${e("boundingBox.min_{var} = boundingBox.max_{var} = 0;",{indent:4})}
  }
`}var Lne=wT.exports,CT={exports:{}};const Dne=Wm;CT.exports=One,CT.exports.generateCreateDragForceFunctionBody=q4;function One(r){let e=q4(r);return new Function("options",e)}function q4(r){return`
  if (!Number.isFinite(options.dragCoefficient)) throw new Error('dragCoefficient is not a finite number');

  return {
    update: function(body) {
      ${Dne(r)("body.force.{var} -= options.dragCoefficient * body.velocity.{var};",{indent:6})}
    }
  };
`}var Pne=CT.exports,ST={exports:{}};const kne=Wm;ST.exports=Fne,ST.exports.generateCreateSpringForceFunctionBody=X4;function Fne(r){let e=X4(r);return new Function("options","random",e)}function X4(r){let e=kne(r);return`
  if (!Number.isFinite(options.springCoefficient)) throw new Error('Spring coefficient is not a number');
  if (!Number.isFinite(options.springLength)) throw new Error('Spring length is not a number');

  return {
    /**
     * Updates forces acting on a spring
     */
    update: function (spring) {
      var body1 = spring.from;
      var body2 = spring.to;
      var length = spring.length < 0 ? options.springLength : spring.length;
      ${e("var d{var} = body2.pos.{var} - body1.pos.{var};",{indent:6})}
      var r = Math.sqrt(${e("d{var} * d{var}",{join:" + "})});

      if (r === 0) {
        ${e("d{var} = (random.nextDouble() - 0.5) / 50;",{indent:8})}
        r = Math.sqrt(${e("d{var} * d{var}",{join:" + "})});
      }

      var d = r - length;
      var coefficient = ((spring.coefficient > 0) ? spring.coefficient : options.springCoefficient) * d / r;

      ${e("body1.force.{var} += coefficient * d{var}",{indent:6})};
      body1.springCount += 1;
      body1.springLength += r;

      ${e("body2.force.{var} -= coefficient * d{var}",{indent:6})};
      body2.springCount += 1;
      body2.springLength += r;
    }
  };
`}var Une=ST.exports,TT={exports:{}};const zne=Wm;TT.exports=jne,TT.exports.generateIntegratorFunctionBody=Y4;function jne(r){let e=Y4(r);return new Function("bodies","timeStep","adaptiveTimeStepWeight",e)}function Y4(r){let e=zne(r);return`
  var length = bodies.length;
  if (length === 0) return 0;

  ${e("var d{var} = 0, t{var} = 0;",{indent:2})}

  for (var i = 0; i < length; ++i) {
    var body = bodies[i];
    if (body.isPinned) continue;

    if (adaptiveTimeStepWeight && body.springCount) {
      timeStep = (adaptiveTimeStepWeight * body.springLength/body.springCount);
    }

    var coeff = timeStep / body.mass;

    ${e("body.velocity.{var} += coeff * body.force.{var};",{indent:4})}
    ${e("var v{var} = body.velocity.{var};",{indent:4})}
    var v = Math.sqrt(${e("v{var} * v{var}",{join:" + "})});

    if (v > 1) {
      // We normalize it so that we move within timeStep range. 
      // for the case when v <= 1 - we let velocity to fade out.
      ${e("body.velocity.{var} = v{var} / v;",{indent:6})}
    }

    ${e("d{var} = timeStep * body.velocity.{var};",{indent:4})}

    ${e("body.pos.{var} += d{var};",{indent:4})}

    ${e("t{var} += Math.abs(d{var});",{indent:4})}
  }

  return (${e("t{var} * t{var}",{join:" + "})})/length;
`}var Vne=TT.exports,MT,K4;function Gne(){if(K4)return MT;K4=1,MT=r;function r(e,i,n,s){this.from=e,this.to=i,this.length=n,this.coefficient=s}return MT}var RT,J4;function Hne(){if(J4)return RT;J4=1,RT=r;function r(e,i){var n;if(e||(e={}),i){for(n in i)if(i.hasOwnProperty(n)){var s=e.hasOwnProperty(n),o=typeof i[n],l=!s||typeof e[n]!==o;l?e[n]=i[n]:o==="object"&&(e[n]=r(e[n],i[n]))}}return e}return RT}var FA={exports:{}},Z4;function Wne(){if(Z4)return FA.exports;Z4=1,FA.exports=r,FA.exports.random=r,FA.exports.randomIterator=u;function r(c){var h=typeof c=="number"?c:+new Date;return new e(h)}function e(c){this.seed=c}e.prototype.next=l,e.prototype.nextDouble=o,e.prototype.uniform=o,e.prototype.gaussian=i;function i(){var c,h,p;do h=this.nextDouble()*2-1,p=this.nextDouble()*2-1,c=h*h+p*p;while(c>=1||c===0);return h*Math.sqrt(-2*Math.log(c)/c)}e.prototype.levy=n;function n(){var c=1.5,h=Math.pow(s(1+c)*Math.sin(Math.PI*c/2)/(s((1+c)/2)*c*Math.pow(2,(c-1)/2)),1/c);return this.gaussian()*h/Math.pow(Math.abs(this.gaussian()),1/c)}function s(c){return Math.sqrt(2*Math.PI/c)*Math.pow(1/Math.E*(c+1/(12*c-1/(10*c))),c)}function o(){var c=this.seed;return c=c+2127912214+(c<<12)&4294967295,c=(c^3345072700^c>>>19)&4294967295,c=c+374761393+(c<<5)&4294967295,c=(c+3550635116^c<<9)&4294967295,c=c+4251993797+(c<<3)&4294967295,c=(c^3042594569^c>>>16)&4294967295,this.seed=c,(c&268435455)/268435456}function l(c){return Math.floor(this.nextDouble()*c)}function u(c,h){var p=h||r();if(typeof p.next!="function")throw new Error("customRandom does not match expected API: next() function is missing");return{forEach:m,shuffle:f};function f(){var g,y,x;for(g=c.length-1;g>0;--g)y=p.next(g+1),x=c[y],c[y]=c[g],c[g]=x;return c}function m(g){var y,x,v;for(y=c.length-1;y>0;--y)x=p.next(y+1),v=c[x],c[x]=c[y],c[y]=v,g(v);c.length&&g(c[0])}}return FA.exports}var $4=Zne,Qne=Mne,qne=Ine,Xne=Lne,Yne=Pne,Kne=Une,Jne=Vne,eF={};function Zne(r){var e=Gne(),i=Hne(),n=bT;if(r){if(r.springCoeff!==void 0)throw new Error("springCoeff was renamed to springCoefficient");if(r.dragCoeff!==void 0)throw new Error("dragCoeff was renamed to dragCoefficient")}r=i(r,{springLength:10,springCoefficient:.8,gravity:-12,theta:.8,dragCoefficient:.9,timeStep:.5,adaptiveTimeStepWeight:0,dimensions:2,debug:!1});var s=eF[r.dimensions];if(!s){var o=r.dimensions;s={Body:Qne(o,r.debug),createQuadTree:qne(o),createBounds:Xne(o),createDragForce:Yne(o),createSpringForce:Kne(o),integrate:Jne(o)},eF[o]=s}var l=s.Body,u=s.createQuadTree,c=s.createBounds,h=s.createDragForce,p=s.createSpringForce,f=s.integrate,m=$=>new l($),g=Wne().random(42),y=[],x=[],v=u(r,g),_=c(y,r,g),T=p(r,g),w=h(r),S=0,R=[],B=new Map,I=0;O("nbody",G),O("spring",z);var D={bodies:y,quadTree:v,springs:x,settings:r,addForce:O,removeForce:U,getForces:Z,step:function(){for(var $=0;$<R.length;++$)R[$](I);var Q=f(y,r.timeStep,r.adaptiveTimeStepWeight);return I+=1,Q},addBody:function($){if(!$)throw new Error("Body is required");return y.push($),$},addBodyAt:function($){if(!$)throw new Error("Body position is required");var Q=m($);return y.push(Q),Q},removeBody:function($){if($){var Q=y.indexOf($);if(!(Q<0))return y.splice(Q,1),y.length===0&&_.reset(),!0}},addSpring:function($,Q,H,V){if(!$||!Q)throw new Error("Cannot add null spring to force simulator");typeof H!="number"&&(H=-1);var ne=new e($,Q,H,V>=0?V:-1);return x.push(ne),ne},getTotalMovement:function(){return S},removeSpring:function($){if($){var Q=x.indexOf($);if(Q>-1)return x.splice(Q,1),!0}},getBestNewBodyPosition:function($){return _.getBestNewPosition($)},getBBox:L,getBoundingBox:L,invalidateBBox:function(){console.warn("invalidateBBox() is deprecated, bounds always recomputed on `getBBox()` call")},gravity:function($){return $!==void 0?(r.gravity=$,v.options({gravity:$}),this):r.gravity},theta:function($){return $!==void 0?(r.theta=$,v.options({theta:$}),this):r.theta},random:g};return $ne(r,D),n(D),D;function L(){return _.update(),_.box}function O($,Q){if(B.has($))throw new Error("Force "+$+" is already added");B.set($,Q),R.push(Q)}function U($){var Q=R.indexOf(B.get($));Q<0||(R.splice(Q,1),B.delete($))}function Z(){return B}function G(){if(y.length!==0){v.insertBodies(y);for(var $=y.length;$--;){var Q=y[$];Q.isPinned||(Q.reset(),v.updateBodyForce(Q),w.update(Q))}}}function z(){for(var $=x.length;$--;)T.update(x[$])}}function $ne(r,e){for(var i in r)ese(r,e,i)}function ese(r,e,i){if(r.hasOwnProperty(i)&&typeof e[i]!="function"){var n=Number.isFinite(r[i]);n?e[i]=function(s){if(s!==void 0){if(!Number.isFinite(s))throw new Error("Value of "+i+" should be a valid number.");return r[i]=s,e}return r[i]}:e[i]=function(s){return s!==void 0?(r[i]=s,e):r[i]}}}_T.exports=ise,_T.exports.simulator=$4;var tse=bT;function ise(r,e){if(!r)throw new Error("Graph structure cannot be undefined");var i=e&&e.createSimulator||$4,n=i(e);if(Array.isArray(e))throw new Error("Physics settings is expected to be an object");var s=r.version>19?G:Z;e&&typeof e.nodeMass=="function"&&(s=e.nodeMass);var o=new Map,l={},u=0,c=n.settings.springTransform||rse;w(),v();var h=!1,p={step:function(){if(u===0)return f(!0),!0;var z=n.step();p.lastMove=z,p.fire("step");var $=z/u,Q=$<=.01;return f(Q),Q},getNodePosition:function(z){return U(z).pos},setNodePosition:function(z){var $=U(z);$.setPosition.apply($,Array.prototype.slice.call(arguments,1))},getLinkPosition:function(z){var $=l[z];if($)return{from:$.from.pos,to:$.to.pos}},getGraphRect:function(){return n.getBBox()},forEachBody:m,pinNode:function(z,$){var Q=U(z.id);Q.isPinned=!!$},isNodePinned:function(z){return U(z.id).isPinned},dispose:function(){r.off("changed",T),p.fire("disposed")},getBody:x,getSpring:y,getForceVectorLength:g,simulator:n,graph:r,lastMove:0};return tse(p),p;function f(z){h!==z&&(h=z,_(z))}function m(z){o.forEach(z)}function g(){var z=0,$=0;return m(function(Q){z+=Math.abs(Q.force.x),$+=Math.abs(Q.force.y)}),Math.sqrt(z*z+$*$)}function y(z,$){var Q;if($===void 0)typeof z!="object"?Q=z:Q=z.id;else{var H=r.hasLink(z,$);if(!H)return;Q=H.id}return l[Q]}function x(z){return o.get(z)}function v(){r.on("changed",T)}function _(z){p.fire("stable",z)}function T(z){for(var $=0;$<z.length;++$){var Q=z[$];Q.changeType==="add"?(Q.node&&S(Q.node.id),Q.link&&B(Q.link)):Q.changeType==="remove"&&(Q.node&&R(Q.node),Q.link&&I(Q.link))}u=r.getNodesCount()}function w(){u=0,r.forEachNode(function(z){S(z.id),u+=1}),r.forEachLink(B)}function S(z){var $=o.get(z);if(!$){var Q=r.getNode(z);if(!Q)throw new Error("initBody() was called with unknown node id");var H=Q.position;if(!H){var V=D(Q);H=n.getBestNewBodyPosition(V)}$=n.addBodyAt(H),$.id=z,o.set(z,$),L(z),O(Q)&&($.isPinned=!0)}}function R(z){var $=z.id,Q=o.get($);Q&&(o.delete($),n.removeBody(Q))}function B(z){L(z.fromId),L(z.toId);var $=o.get(z.fromId),Q=o.get(z.toId),H=n.addSpring($,Q,z.length);c(z,H),l[z.id]=H}function I(z){var $=l[z.id];if($){var Q=r.getNode(z.fromId),H=r.getNode(z.toId);Q&&L(Q.id),H&&L(H.id),delete l[z.id],n.removeSpring($)}}function D(z){var $=[];if(!z.links)return $;for(var Q=Math.min(z.links.length,2),H=0;H<Q;++H){var V=z.links[H],ne=V.fromId!==z.id?o.get(V.fromId):o.get(V.toId);ne&&ne.pos&&$.push(ne)}return $}function L(z){var $=o.get(z);if($.mass=s(z),Number.isNaN($.mass))throw new Error("Node mass should be a number")}function O(z){return z&&(z.isPinned||z.data&&z.data.isPinned)}function U(z){var $=o.get(z);return $||(S(z),$=o.get(z)),$}function Z(z){var $=r.getLinks(z);return $?1+$.length/3:1}function G(z){var $=r.getLinks(z);return $?1+$.size/3:1}}function rse(){}var nse=_T.exports;const sse=v2(nse);function Kb(r){var e=typeof r;return r!=null&&(e=="object"||e=="function")}var ase=typeof global=="object"&&global&&global.Object===Object&&global,ose=typeof self=="object"&&self&&self.Object===Object&&self,tF=ase||ose||Function("return this")(),IT=function(){return tF.Date.now()},lse=/\s/;function cse(r){for(var e=r.length;e--&&lse.test(r.charAt(e)););return e}var use=/^\s+/;function hse(r){return r&&r.slice(0,cse(r)+1).replace(use,"")}var Jb=tF.Symbol,iF=Object.prototype,dse=iF.hasOwnProperty,pse=iF.toString,UA=Jb?Jb.toStringTag:void 0;function fse(r){var e=dse.call(r,UA),i=r[UA];try{r[UA]=void 0;var n=!0}catch{}var s=pse.call(r);return n&&(e?r[UA]=i:delete r[UA]),s}var mse=Object.prototype,gse=mse.toString;function Ase(r){return gse.call(r)}var yse="[object Null]",vse="[object Undefined]",rF=Jb?Jb.toStringTag:void 0;function xse(r){return r==null?r===void 0?vse:yse:rF&&rF in Object(r)?fse(r):Ase(r)}function bse(r){return r!=null&&typeof r=="object"}var _se="[object Symbol]";function Ese(r){return typeof r=="symbol"||bse(r)&&xse(r)==_se}var nF=NaN,wse=/^[-+]0x[0-9a-f]+$/i,Cse=/^0b[01]+$/i,Sse=/^0o[0-7]+$/i,Tse=parseInt;function sF(r){if(typeof r=="number")return r;if(Ese(r))return nF;if(Kb(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=Kb(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=hse(r);var i=Cse.test(r);return i||Sse.test(r)?Tse(r.slice(2),i?2:8):wse.test(r)?nF:+r}var Mse="Expected a function",Rse=Math.max,Ise=Math.min;function aF(r,e,i){var n,s,o,l,u,c,h=0,p=!1,f=!1,m=!0;if(typeof r!="function")throw new TypeError(Mse);e=sF(e)||0,Kb(i)&&(p=!!i.leading,f="maxWait"in i,o=f?Rse(sF(i.maxWait)||0,e):o,m="trailing"in i?!!i.trailing:m);function g(B){var I=n,D=s;return n=s=void 0,h=B,l=r.apply(D,I),l}function y(B){return h=B,u=setTimeout(_,e),p?g(B):l}function x(B){var I=B-c,D=B-h,L=e-I;return f?Ise(L,o-D):L}function v(B){var I=B-c,D=B-h;return c===void 0||I>=e||I<0||f&&D>=o}function _(){var B=IT();if(v(B))return T(B);u=setTimeout(_,x(B))}function T(B){return u=void 0,m&&n?g(B):(n=s=void 0,l)}function w(){u!==void 0&&clearTimeout(u),h=0,n=c=s=u=void 0}function S(){return u===void 0?l:T(IT())}function R(){var B=IT(),I=v(B);if(n=arguments,s=this,c=B,I){if(u===void 0)return y(c);if(f)return clearTimeout(u),u=setTimeout(_,e),g(c)}return u===void 0&&(u=setTimeout(_,e)),l}return R.cancel=w,R.flush=S,R}function oF(r,e){(e==null||e>r.length)&&(e=r.length);for(var i=0,n=Array(e);i<e;i++)n[i]=r[i];return n}function Bse(r){if(Array.isArray(r))return r}function Nse(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function Lse(r,e,i){return Object.defineProperty(r,"prototype",{writable:!1}),r}function Dse(r,e){var i=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(i!=null){var n,s,o,l,u=[],c=!0,h=!1;try{if(o=(i=i.call(r)).next,e!==0)for(;!(c=(n=o.call(i)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(p){h=!0,s=p}finally{try{if(!c&&i.return!=null&&(l=i.return(),Object(l)!==l))return}finally{if(h)throw s}}return u}}function Ose(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pse(r,e){return Bse(r)||Dse(r,e)||kse(r,e)||Ose()}function kse(r,e){if(r){if(typeof r=="string")return oF(r,e);var i={}.toString.call(r).slice(8,-1);return i==="Object"&&r.constructor&&(i=r.constructor.name),i==="Map"||i==="Set"?Array.from(r):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?oF(r,e):void 0}}var Fse=Lse(function r(e,i){var n=i.default,s=n===void 0?null:n,o=i.triggerUpdate,l=o===void 0?!0:o,u=i.onChange,c=u===void 0?function(h,p){}:u;Nse(this,r),this.name=e,this.defaultVal=s,this.triggerUpdate=l,this.onChange=c});function Ep(r){var e=r.stateInit,i=e===void 0?function(){return{}}:e,n=r.props,s=n===void 0?{}:n,o=r.methods,l=o===void 0?{}:o,u=r.aliases,c=u===void 0?{}:u,h=r.init,p=h===void 0?function(){}:h,f=r.update,m=f===void 0?function(){}:f,g=Object.keys(s).map(function(y){return new Fse(y,s[y])});return function y(){for(var x=arguments.length,v=new Array(x),_=0;_<x;_++)v[_]=arguments[_];var T=!!(this instanceof y&&this.constructor),w=T?v.shift():void 0,S=v[0],R=S===void 0?{}:S,B=Object.assign({},i instanceof Function?i(R):i,{initialised:!1}),I={};function D(U){return L(U,R),O(),D}var L=function(U,Z){p.call(D,U,B,Z),B.initialised=!0},O=aF(function(){B.initialised&&(m.call(D,B,I),I={})},1);return g.forEach(function(U){D[U.name]=Z(U);function Z(G){var z=G.name,$=G.triggerUpdate,Q=$===void 0?!1:$,H=G.onChange,V=H===void 0?function(ae,xe){}:H,ne=G.defaultVal,Y=ne===void 0?null:ne;return function(ae){var xe=B[z];if(!arguments.length)return xe;var fe=ae===void 0?Y:ae;return B[z]=fe,V.call(D,fe,B,xe),!I.hasOwnProperty(z)&&(I[z]=xe),Q&&O(),D}}}),Object.keys(l).forEach(function(U){D[U]=function(){for(var Z,G=arguments.length,z=new Array(G),$=0;$<G;$++)z[$]=arguments[$];return(Z=l[U]).call.apply(Z,[D,B].concat(z))}}),Object.entries(c).forEach(function(U){var Z=Pse(U,2),G=Z[0],z=Z[1];return D[G]=D[z]}),D.resetProps=function(){return g.forEach(function(U){D[U.name](U.defaultVal)}),D},D.resetProps(),B._rerender=O,T&&w&&D(w),D}}class lF extends Map{constructor(e,i=jse){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:i}}),e!=null)for(const[n,s]of e)this.set(n,s)}get(e){return super.get(cF(this,e))}has(e){return super.has(cF(this,e))}set(e,i){return super.set(Use(this,e),i)}delete(e){return super.delete(zse(this,e))}}function cF({_intern:r,_key:e},i){const n=e(i);return r.has(n)?r.get(n):i}function Use({_intern:r,_key:e},i){const n=e(i);return r.has(n)?r.get(n):(r.set(n,i),i)}function zse({_intern:r,_key:e},i){const n=e(i);return r.has(n)&&(i=r.get(n),r.delete(n)),i}function jse(r){return r!==null&&typeof r=="object"?r.valueOf():r}function BT(r,e){let i;if(e===void 0)for(const n of r)n!=null&&(i<n||i===void 0&&n>=n)&&(i=n);else{let n=-1;for(let s of r)(s=e(s,++n,r))!=null&&(i<s||i===void 0&&s>=s)&&(i=s)}return i}function NT(r,e){let i;if(e===void 0)for(const n of r)n!=null&&(i>n||i===void 0&&n>=n)&&(i=n);else{let n=-1;for(let s of r)(s=e(s,++n,r))!=null&&(i>s||i===void 0&&s>=s)&&(i=s)}return i}function LT(r,e){(e==null||e>r.length)&&(e=r.length);for(var i=0,n=Array(e);i<e;i++)n[i]=r[i];return n}function Vse(r){if(Array.isArray(r))return r}function Gse(r){if(Array.isArray(r))return LT(r)}function Hse(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Wse(r,e){var i=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(i!=null){var n,s,o,l,u=[],c=!0,h=!1;try{if(o=(i=i.call(r)).next,e!==0)for(;!(c=(n=o.call(i)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(p){h=!0,s=p}finally{try{if(!c&&i.return!=null&&(l=i.return(),Object(l)!==l))return}finally{if(h)throw s}}return u}}function Qse(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qse(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xse(r,e){if(r==null)return{};var i,n,s=Yse(r,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);for(n=0;n<o.length;n++)i=o[n],e.includes(i)||{}.propertyIsEnumerable.call(r,i)&&(s[i]=r[i])}return s}function Yse(r,e){if(r==null)return{};var i={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(e.includes(n))continue;i[n]=r[n]}return i}function Kse(r,e){return Vse(r)||Wse(r,e)||uF(r,e)||Qse()}function Jse(r){return Gse(r)||Hse(r)||uF(r)||qse()}function Zse(r,e){if(typeof r!="object"||!r)return r;var i=r[Symbol.toPrimitive];if(i!==void 0){var n=i.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}function $se(r){var e=Zse(r,"string");return typeof e=="symbol"?e:e+""}function uF(r,e){if(r){if(typeof r=="string")return LT(r,e);var i={}.toString.call(r).slice(8,-1);return i==="Object"&&r.constructor&&(i=r.constructor.name),i==="Map"||i==="Set"?Array.from(r):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?LT(r,e):void 0}}var DT=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=(e instanceof Array?e.length?e:[void 0]:[e]).map(function(u){return{keyAccessor:u,isProp:!(u instanceof Function)}}),o=r.reduce(function(u,c){var h=u,p=c;return s.forEach(function(f,m){var g=f.keyAccessor,y=f.isProp,x;if(y){var v=p,_=v[g],T=Xse(v,[g].map($se));x=_,p=T}else x=g(p,m);m+1<s.length?(h.hasOwnProperty(x)||(h[x]={}),h=h[x]):i?(h.hasOwnProperty(x)||(h[x]=[]),h[x].push(p)):h[x]=p}),u},{});i instanceof Function&&function u(c){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;h===s.length?Object.keys(c).forEach(function(p){return c[p]=i(c[p])}):Object.values(c).forEach(function(p){return u(p,h+1)})}(o);var l=o;return n&&(l=[],function u(c){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];h.length===s.length?l.push({keys:h,vals:c}):Object.entries(c).forEach(function(p){var f=Kse(p,2),m=f[0],g=f[1];return u(g,[].concat(Jse(h),[m]))})}(o),e instanceof Array&&e.length===0&&l.length===1&&(l[0].keys=[])),l};function eae(r,e){var i=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(i!=null){var n,s,o,l,u=[],c=!0,h=!1;try{if(o=(i=i.call(r)).next,e!==0)for(;!(c=(n=o.call(i)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(p){h=!0,s=p}finally{try{if(!c&&i.return!=null&&(l=i.return(),Object(l)!==l))return}finally{if(h)throw s}}return u}}function hF(r,e){var i=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),i.push.apply(i,n)}return i}function tae(r){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?arguments[e]:{};e%2?hF(Object(i),!0).forEach(function(n){dF(r,n,i[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):hF(Object(i)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(i,n))})}return r}function dF(r,e,i){return e=uae(e),e in r?Object.defineProperty(r,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[e]=i,r}function iae(r,e){if(r==null)return{};var i={},n=Object.keys(r),s,o;for(o=0;o<n.length;o++)s=n[o],!(e.indexOf(s)>=0)&&(i[s]=r[s]);return i}function rae(r,e){if(r==null)return{};var i=iae(r,e),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);for(s=0;s<o.length;s++)n=o[s],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(r,n)&&(i[n]=r[n])}return i}function pF(r,e){return sae(r)||eae(r,e)||fF(r,e)||lae()}function Zb(r){return nae(r)||aae(r)||fF(r)||oae()}function nae(r){if(Array.isArray(r))return OT(r)}function sae(r){if(Array.isArray(r))return r}function aae(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function fF(r,e){if(r){if(typeof r=="string")return OT(r,e);var i=Object.prototype.toString.call(r).slice(8,-1);if(i==="Object"&&r.constructor&&(i=r.constructor.name),i==="Map"||i==="Set")return Array.from(r);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return OT(r,e)}}function OT(r,e){(e==null||e>r.length)&&(e=r.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=r[i];return n}function oae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lae(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cae(r,e){if(typeof r!="object"||r===null)return r;var i=r[Symbol.toPrimitive];if(i!==void 0){var n=i.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function uae(r){var e=cae(r,"string");return typeof e=="symbol"?e:String(e)}var hae=["createObj","updateObj","exitObj","objBindAttr","dataBindAttr"];function dae(r,e,i){var n={enter:[],update:[],exit:[]};if(i){var s=DT(r,i,!1),o=DT(e,i,!1),l=Object.assign({},s,o);Object.entries(l).forEach(function(h){var p=pF(h,2),f=p[0],m=p[1],g=s.hasOwnProperty(f)?o.hasOwnProperty(f)?"update":"exit":"enter";n[g].push(g==="update"?[s[f],o[f]]:m)})}else{var u=new Set(r),c=new Set(e);new Set([].concat(Zb(u),Zb(c))).forEach(function(h){var p=u.has(h)?c.has(h)?"update":"exit":"enter";n[p].push(p==="update"?[h,h]:h)})}return n}function pae(r,e,i){var n=i.objBindAttr,s=n===void 0?"__obj":n,o=i.dataBindAttr,l=o===void 0?"__data":o,u=i.idAccessor,c=i.purge,h=c===void 0?!1:c,p=function(x){return x.hasOwnProperty(l)},f=e.filter(function(x){return!p(x)}),m=e.filter(p).map(function(x){return x[l]}),g=r,y=h?{enter:g,exit:m,update:[]}:dae(m,g,u);return y.update=y.update.map(function(x){var v=pF(x,2),_=v[0],T=v[1];return _!==T&&(T[s]=_[s],T[s][l]=T),T}),y.exit=y.exit.concat(f.map(function(x){return dF({},s,x)})),y}function fae(r,e,i,n,s){var o=s.createObj,l=o===void 0?function(D){return{}}:o,u=s.updateObj,c=u===void 0?function(D,L){}:u,h=s.exitObj,p=h===void 0?function(D){}:h,f=s.objBindAttr,m=f===void 0?"__obj":f,g=s.dataBindAttr,y=g===void 0?"__data":g,x=rae(s,hae),v=pae(r,e,tae({objBindAttr:m,dataBindAttr:y},x)),_=v.enter,T=v.update,w=v.exit;w.forEach(function(D){var L=D[m];delete D[m],p(L),n(L)});var S=B(_),R=[].concat(Zb(_),Zb(T));I(R),S.forEach(i);function B(D){var L=[];return D.forEach(function(O){var U=l(O);U&&(U[y]=O,O[m]=U,L.push(U))}),L}function I(D){D.forEach(function(L){var O=L[m];O&&(O[y]=L,c(O,L))})}}function mae(r,e){switch(arguments.length){case 0:break;case 1:this.range(r);break;default:this.range(e).domain(r);break}return this}const mF=Symbol("implicit");function PT(){var r=new lF,e=[],i=[],n=mF;function s(o){let l=r.get(o);if(l===void 0){if(n!==mF)return n;r.set(o,l=e.push(o)-1)}return i[l%i.length]}return s.domain=function(o){if(!arguments.length)return e.slice();e=[],r=new lF;for(const l of o)r.has(l)||r.set(l,e.push(l)-1);return s},s.range=function(o){return arguments.length?(i=Array.from(o),s):i.slice()},s.unknown=function(o){return arguments.length?(n=o,s):n},s.copy=function(){return PT(e,i).unknown(n)},mae.apply(s,arguments),s}function kT(r,e,i){r.prototype=e.prototype=i,i.constructor=r}function gF(r,e){var i=Object.create(r.prototype);for(var n in e)i[n]=e[n];return i}function zA(){}var jA=.7,$b=1/jA,Qm="\\s*([+-]?\\d+)\\s*",VA="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Vc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",gae=/^#([0-9a-f]{3,8})$/,Aae=new RegExp(`^rgb\\(${Qm},${Qm},${Qm}\\)$`),yae=new RegExp(`^rgb\\(${Vc},${Vc},${Vc}\\)$`),vae=new RegExp(`^rgba\\(${Qm},${Qm},${Qm},${VA}\\)$`),xae=new RegExp(`^rgba\\(${Vc},${Vc},${Vc},${VA}\\)$`),bae=new RegExp(`^hsl\\(${VA},${Vc},${Vc}\\)$`),_ae=new RegExp(`^hsla\\(${VA},${Vc},${Vc},${VA}\\)$`),AF={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};kT(zA,GA,{copy(r){return Object.assign(new this.constructor,this,r)},displayable(){return this.rgb().displayable()},hex:yF,formatHex:yF,formatHex8:Eae,formatHsl:wae,formatRgb:vF,toString:vF});function yF(){return this.rgb().formatHex()}function Eae(){return this.rgb().formatHex8()}function wae(){return wF(this).formatHsl()}function vF(){return this.rgb().formatRgb()}function GA(r){var e,i;return r=(r+"").trim().toLowerCase(),(e=gae.exec(r))?(i=e[1].length,e=parseInt(e[1],16),i===6?xF(e):i===3?new Ho(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):i===8?e1(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):i===4?e1(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Aae.exec(r))?new Ho(e[1],e[2],e[3],1):(e=yae.exec(r))?new Ho(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=vae.exec(r))?e1(e[1],e[2],e[3],e[4]):(e=xae.exec(r))?e1(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=bae.exec(r))?EF(e[1],e[2]/100,e[3]/100,1):(e=_ae.exec(r))?EF(e[1],e[2]/100,e[3]/100,e[4]):AF.hasOwnProperty(r)?xF(AF[r]):r==="transparent"?new Ho(NaN,NaN,NaN,0):null}function xF(r){return new Ho(r>>16&255,r>>8&255,r&255,1)}function e1(r,e,i,n){return n<=0&&(r=e=i=NaN),new Ho(r,e,i,n)}function Cae(r){return r instanceof zA||(r=GA(r)),r?(r=r.rgb(),new Ho(r.r,r.g,r.b,r.opacity)):new Ho}function FT(r,e,i,n){return arguments.length===1?Cae(r):new Ho(r,e,i,n??1)}function Ho(r,e,i,n){this.r=+r,this.g=+e,this.b=+i,this.opacity=+n}kT(Ho,FT,gF(zA,{brighter(r){return r=r==null?$b:Math.pow($b,r),new Ho(this.r*r,this.g*r,this.b*r,this.opacity)},darker(r){return r=r==null?jA:Math.pow(jA,r),new Ho(this.r*r,this.g*r,this.b*r,this.opacity)},rgb(){return this},clamp(){return new Ho(wp(this.r),wp(this.g),wp(this.b),t1(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:bF,formatHex:bF,formatHex8:Sae,formatRgb:_F,toString:_F}));function bF(){return`#${Cp(this.r)}${Cp(this.g)}${Cp(this.b)}`}function Sae(){return`#${Cp(this.r)}${Cp(this.g)}${Cp(this.b)}${Cp((isNaN(this.opacity)?1:this.opacity)*255)}`}function _F(){const r=t1(this.opacity);return`${r===1?"rgb(":"rgba("}${wp(this.r)}, ${wp(this.g)}, ${wp(this.b)}${r===1?")":`, ${r})`}`}function t1(r){return isNaN(r)?1:Math.max(0,Math.min(1,r))}function wp(r){return Math.max(0,Math.min(255,Math.round(r)||0))}function Cp(r){return r=wp(r),(r<16?"0":"")+r.toString(16)}function EF(r,e,i,n){return n<=0?r=e=i=NaN:i<=0||i>=1?r=e=NaN:e<=0&&(r=NaN),new lc(r,e,i,n)}function wF(r){if(r instanceof lc)return new lc(r.h,r.s,r.l,r.opacity);if(r instanceof zA||(r=GA(r)),!r)return new lc;if(r instanceof lc)return r;r=r.rgb();var e=r.r/255,i=r.g/255,n=r.b/255,s=Math.min(e,i,n),o=Math.max(e,i,n),l=NaN,u=o-s,c=(o+s)/2;return u?(e===o?l=(i-n)/u+(i<n)*6:i===o?l=(n-e)/u+2:l=(e-i)/u+4,u/=c<.5?o+s:2-o-s,l*=60):u=c>0&&c<1?0:l,new lc(l,u,c,r.opacity)}function Tae(r,e,i,n){return arguments.length===1?wF(r):new lc(r,e,i,n??1)}function lc(r,e,i,n){this.h=+r,this.s=+e,this.l=+i,this.opacity=+n}kT(lc,Tae,gF(zA,{brighter(r){return r=r==null?$b:Math.pow($b,r),new lc(this.h,this.s,this.l*r,this.opacity)},darker(r){return r=r==null?jA:Math.pow(jA,r),new lc(this.h,this.s,this.l*r,this.opacity)},rgb(){var r=this.h%360+(this.h<0)*360,e=isNaN(r)||isNaN(this.s)?0:this.s,i=this.l,n=i+(i<.5?i:1-i)*e,s=2*i-n;return new Ho(UT(r>=240?r-240:r+120,s,n),UT(r,s,n),UT(r<120?r+240:r-120,s,n),this.opacity)},clamp(){return new lc(CF(this.h),i1(this.s),i1(this.l),t1(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const r=t1(this.opacity);return`${r===1?"hsl(":"hsla("}${CF(this.h)}, ${i1(this.s)*100}%, ${i1(this.l)*100}%${r===1?")":`, ${r})`}`}}));function CF(r){return r=(r||0)%360,r<0?r+360:r}function i1(r){return Math.max(0,Math.min(1,r||0))}function UT(r,e,i){return(r<60?e+(i-e)*r/60:r<180?i:r<240?e+(i-e)*(240-r)/60:e)*255}const SF=r=>()=>r;function Mae(r,e){return function(i){return r+i*e}}function Rae(r,e,i){return r=Math.pow(r,i),e=Math.pow(e,i)-r,i=1/i,function(n){return Math.pow(r+n*e,i)}}function Iae(r){return(r=+r)==1?TF:function(e,i){return i-e?Rae(e,i,r):SF(isNaN(e)?i:e)}}function TF(r,e){var i=e-r;return i?Mae(r,i):SF(isNaN(r)?e:r)}const MF=function r(e){var i=Iae(e);function n(s,o){var l=i((s=FT(s)).r,(o=FT(o)).r),u=i(s.g,o.g),c=i(s.b,o.b),h=TF(s.opacity,o.opacity);return function(p){return s.r=l(p),s.g=u(p),s.b=c(p),s.opacity=h(p),s+""}}return n.gamma=r,n}(1);function td(r,e){return r=+r,e=+e,function(i){return r*(1-i)+e*i}}var zT=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,jT=new RegExp(zT.source,"g");function Bae(r){return function(){return r}}function Nae(r){return function(e){return r(e)+""}}function Lae(r,e){var i=zT.lastIndex=jT.lastIndex=0,n,s,o,l=-1,u=[],c=[];for(r=r+"",e=e+"";(n=zT.exec(r))&&(s=jT.exec(e));)(o=s.index)>i&&(o=e.slice(i,o),u[l]?u[l]+=o:u[++l]=o),(n=n[0])===(s=s[0])?u[l]?u[l]+=s:u[++l]=s:(u[++l]=null,c.push({i:l,x:td(n,s)})),i=jT.lastIndex;return i<e.length&&(o=e.slice(i),u[l]?u[l]+=o:u[++l]=o),u.length<2?c[0]?Nae(c[0].x):Bae(e):(e=c.length,function(h){for(var p=0,f;p<e;++p)u[(f=c[p]).i]=f.x(h);return u.join("")})}var RF=180/Math.PI,IF={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function BF(r,e,i,n,s,o){var l,u,c;return(l=Math.sqrt(r*r+e*e))&&(r/=l,e/=l),(c=r*i+e*n)&&(i-=r*c,n-=e*c),(u=Math.sqrt(i*i+n*n))&&(i/=u,n/=u,c/=u),r*n<e*i&&(r=-r,e=-e,c=-c,l=-l),{translateX:s,translateY:o,rotate:Math.atan2(e,r)*RF,skewX:Math.atan(c)*RF,scaleX:l,scaleY:u}}var r1;function Dae(r){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(r+"");return e.isIdentity?IF:BF(e.a,e.b,e.c,e.d,e.e,e.f)}function Oae(r){return r==null||(r1||(r1=document.createElementNS("http://www.w3.org/2000/svg","g")),r1.setAttribute("transform",r),!(r=r1.transform.baseVal.consolidate()))?IF:(r=r.matrix,BF(r.a,r.b,r.c,r.d,r.e,r.f))}function NF(r,e,i,n){function s(h){return h.length?h.pop()+" ":""}function o(h,p,f,m,g,y){if(h!==f||p!==m){var x=g.push("translate(",null,e,null,i);y.push({i:x-4,x:td(h,f)},{i:x-2,x:td(p,m)})}else(f||m)&&g.push("translate("+f+e+m+i)}function l(h,p,f,m){h!==p?(h-p>180?p+=360:p-h>180&&(h+=360),m.push({i:f.push(s(f)+"rotate(",null,n)-2,x:td(h,p)})):p&&f.push(s(f)+"rotate("+p+n)}function u(h,p,f,m){h!==p?m.push({i:f.push(s(f)+"skewX(",null,n)-2,x:td(h,p)}):p&&f.push(s(f)+"skewX("+p+n)}function c(h,p,f,m,g,y){if(h!==f||p!==m){var x=g.push(s(g)+"scale(",null,",",null,")");y.push({i:x-4,x:td(h,f)},{i:x-2,x:td(p,m)})}else(f!==1||m!==1)&&g.push(s(g)+"scale("+f+","+m+")")}return function(h,p){var f=[],m=[];return h=r(h),p=r(p),o(h.translateX,h.translateY,p.translateX,p.translateY,f,m),l(h.rotate,p.rotate,f,m),u(h.skewX,p.skewX,f,m),c(h.scaleX,h.scaleY,p.scaleX,p.scaleY,f,m),h=p=null,function(g){for(var y=-1,x=m.length,v;++y<x;)f[(v=m[y]).i]=v.x(g);return f.join("")}}}var Pae=NF(Dae,"px, ","px)","deg)"),kae=NF(Oae,", ",")",")"),Fae=1e-12;function LF(r){return((r=Math.exp(r))+1/r)/2}function Uae(r){return((r=Math.exp(r))-1/r)/2}function zae(r){return((r=Math.exp(2*r))-1)/(r+1)}const jae=function r(e,i,n){function s(o,l){var u=o[0],c=o[1],h=o[2],p=l[0],f=l[1],m=l[2],g=p-u,y=f-c,x=g*g+y*y,v,_;if(x<Fae)_=Math.log(m/h)/e,v=function(I){return[u+I*g,c+I*y,h*Math.exp(e*I*_)]};else{var T=Math.sqrt(x),w=(m*m-h*h+n*x)/(2*h*i*T),S=(m*m-h*h-n*x)/(2*m*i*T),R=Math.log(Math.sqrt(w*w+1)-w),B=Math.log(Math.sqrt(S*S+1)-S);_=(B-R)/e,v=function(I){var D=I*_,L=LF(R),O=h/(i*T)*(L*zae(e*D+R)-Uae(R));return[u+O*g,c+O*y,h*L/LF(e*D+R)]}}return v.duration=_*1e3*e/Math.SQRT2,v}return s.rho=function(o){var l=Math.max(.001,+o),u=l*l,c=u*u;return r(l,u,c)},s}(Math.SQRT2,2,4);function Vae(r){for(var e=r.length/6|0,i=new Array(e),n=0;n<e;)i[n]="#"+r.slice(n*6,++n*6);return i}const DF=Vae("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928");function n1(r){"@babel/helpers - typeof";return n1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n1(r)}var Gae=/^\s+/,Hae=/\s+$/;function _r(r,e){if(r=r||"",e=e||{},r instanceof _r)return r;if(!(this instanceof _r))return new _r(r,e);var i=Wae(r);this._originalInput=r,this._r=i.r,this._g=i.g,this._b=i.b,this._a=i.a,this._roundA=Math.round(100*this._a)/100,this._format=e.format||i.format,this._gradientType=e.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=i.ok}_r.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var r=this.toRgb();return(r.r*299+r.g*587+r.b*114)/1e3},getLuminance:function(){var r=this.toRgb(),e,i,n,s,o,l;return e=r.r/255,i=r.g/255,n=r.b/255,e<=.03928?s=e/12.92:s=Math.pow((e+.055)/1.055,2.4),i<=.03928?o=i/12.92:o=Math.pow((i+.055)/1.055,2.4),n<=.03928?l=n/12.92:l=Math.pow((n+.055)/1.055,2.4),.2126*s+.7152*o+.0722*l},setAlpha:function(r){return this._a=zF(r),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var r=PF(this._r,this._g,this._b);return{h:r.h*360,s:r.s,v:r.v,a:this._a}},toHsvString:function(){var r=PF(this._r,this._g,this._b),e=Math.round(r.h*360),i=Math.round(r.s*100),n=Math.round(r.v*100);return this._a==1?"hsv("+e+", "+i+"%, "+n+"%)":"hsva("+e+", "+i+"%, "+n+"%, "+this._roundA+")"},toHsl:function(){var r=OF(this._r,this._g,this._b);return{h:r.h*360,s:r.s,l:r.l,a:this._a}},toHslString:function(){var r=OF(this._r,this._g,this._b),e=Math.round(r.h*360),i=Math.round(r.s*100),n=Math.round(r.l*100);return this._a==1?"hsl("+e+", "+i+"%, "+n+"%)":"hsla("+e+", "+i+"%, "+n+"%, "+this._roundA+")"},toHex:function(r){return kF(this._r,this._g,this._b,r)},toHexString:function(r){return"#"+this.toHex(r)},toHex8:function(r){return Yae(this._r,this._g,this._b,this._a,r)},toHex8String:function(r){return"#"+this.toHex8(r)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(ws(this._r,255)*100)+"%",g:Math.round(ws(this._g,255)*100)+"%",b:Math.round(ws(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(ws(this._r,255)*100)+"%, "+Math.round(ws(this._g,255)*100)+"%, "+Math.round(ws(this._b,255)*100)+"%)":"rgba("+Math.round(ws(this._r,255)*100)+"%, "+Math.round(ws(this._g,255)*100)+"%, "+Math.round(ws(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:ooe[kF(this._r,this._g,this._b,!0)]||!1},toFilter:function(r){var e="#"+FF(this._r,this._g,this._b,this._a),i=e,n=this._gradientType?"GradientType = 1, ":"";if(r){var s=_r(r);i="#"+FF(s._r,s._g,s._b,s._a)}return"progid:DXImageTransform.Microsoft.gradient("+n+"startColorstr="+e+",endColorstr="+i+")"},toString:function(r){var e=!!r;r=r||this._format;var i=!1,n=this._a<1&&this._a>=0,s=!e&&n&&(r==="hex"||r==="hex6"||r==="hex3"||r==="hex4"||r==="hex8"||r==="name");return s?r==="name"&&this._a===0?this.toName():this.toRgbString():(r==="rgb"&&(i=this.toRgbString()),r==="prgb"&&(i=this.toPercentageRgbString()),(r==="hex"||r==="hex6")&&(i=this.toHexString()),r==="hex3"&&(i=this.toHexString(!0)),r==="hex4"&&(i=this.toHex8String(!0)),r==="hex8"&&(i=this.toHex8String()),r==="name"&&(i=this.toName()),r==="hsl"&&(i=this.toHslString()),r==="hsv"&&(i=this.toHsvString()),i||this.toHexString())},clone:function(){return _r(this.toString())},_applyModification:function(r,e){var i=r.apply(null,[this].concat([].slice.call(e)));return this._r=i._r,this._g=i._g,this._b=i._b,this.setAlpha(i._a),this},lighten:function(){return this._applyModification($ae,arguments)},brighten:function(){return this._applyModification(eoe,arguments)},darken:function(){return this._applyModification(toe,arguments)},desaturate:function(){return this._applyModification(Kae,arguments)},saturate:function(){return this._applyModification(Jae,arguments)},greyscale:function(){return this._applyModification(Zae,arguments)},spin:function(){return this._applyModification(ioe,arguments)},_applyCombination:function(r,e){return r.apply(null,[this].concat([].slice.call(e)))},analogous:function(){return this._applyCombination(soe,arguments)},complement:function(){return this._applyCombination(roe,arguments)},monochromatic:function(){return this._applyCombination(aoe,arguments)},splitcomplement:function(){return this._applyCombination(noe,arguments)},triad:function(){return this._applyCombination(UF,[3])},tetrad:function(){return this._applyCombination(UF,[4])}},_r.fromRatio=function(r,e){if(n1(r)=="object"){var i={};for(var n in r)r.hasOwnProperty(n)&&(n==="a"?i[n]=r[n]:i[n]=HA(r[n]));r=i}return _r(r,e)};function Wae(r){var e={r:0,g:0,b:0},i=1,n=null,s=null,o=null,l=!1,u=!1;return typeof r=="string"&&(r=hoe(r)),n1(r)=="object"&&(Pu(r.r)&&Pu(r.g)&&Pu(r.b)?(e=Qae(r.r,r.g,r.b),l=!0,u=String(r.r).substr(-1)==="%"?"prgb":"rgb"):Pu(r.h)&&Pu(r.s)&&Pu(r.v)?(n=HA(r.s),s=HA(r.v),e=Xae(r.h,n,s),l=!0,u="hsv"):Pu(r.h)&&Pu(r.s)&&Pu(r.l)&&(n=HA(r.s),o=HA(r.l),e=qae(r.h,n,o),l=!0,u="hsl"),r.hasOwnProperty("a")&&(i=r.a)),i=zF(i),{ok:l,format:r.format||u,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:i}}function Qae(r,e,i){return{r:ws(r,255)*255,g:ws(e,255)*255,b:ws(i,255)*255}}function OF(r,e,i){r=ws(r,255),e=ws(e,255),i=ws(i,255);var n=Math.max(r,e,i),s=Math.min(r,e,i),o,l,u=(n+s)/2;if(n==s)o=l=0;else{var c=n-s;switch(l=u>.5?c/(2-n-s):c/(n+s),n){case r:o=(e-i)/c+(e<i?6:0);break;case e:o=(i-r)/c+2;break;case i:o=(r-e)/c+4;break}o/=6}return{h:o,s:l,l:u}}function qae(r,e,i){var n,s,o;r=ws(r,360),e=ws(e,100),i=ws(i,100);function l(h,p,f){return f<0&&(f+=1),f>1&&(f-=1),f<1/6?h+(p-h)*6*f:f<1/2?p:f<2/3?h+(p-h)*(2/3-f)*6:h}if(e===0)n=s=o=i;else{var u=i<.5?i*(1+e):i+e-i*e,c=2*i-u;n=l(c,u,r+1/3),s=l(c,u,r),o=l(c,u,r-1/3)}return{r:n*255,g:s*255,b:o*255}}function PF(r,e,i){r=ws(r,255),e=ws(e,255),i=ws(i,255);var n=Math.max(r,e,i),s=Math.min(r,e,i),o,l,u=n,c=n-s;if(l=n===0?0:c/n,n==s)o=0;else{switch(n){case r:o=(e-i)/c+(e<i?6:0);break;case e:o=(i-r)/c+2;break;case i:o=(r-e)/c+4;break}o/=6}return{h:o,s:l,v:u}}function Xae(r,e,i){r=ws(r,360)*6,e=ws(e,100),i=ws(i,100);var n=Math.floor(r),s=r-n,o=i*(1-e),l=i*(1-s*e),u=i*(1-(1-s)*e),c=n%6,h=[i,l,o,o,u,i][c],p=[u,i,i,l,o,o][c],f=[o,o,u,i,i,l][c];return{r:h*255,g:p*255,b:f*255}}function kF(r,e,i,n){var s=[cc(Math.round(r).toString(16)),cc(Math.round(e).toString(16)),cc(Math.round(i).toString(16))];return n&&s[0].charAt(0)==s[0].charAt(1)&&s[1].charAt(0)==s[1].charAt(1)&&s[2].charAt(0)==s[2].charAt(1)?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0):s.join("")}function Yae(r,e,i,n,s){var o=[cc(Math.round(r).toString(16)),cc(Math.round(e).toString(16)),cc(Math.round(i).toString(16)),cc(jF(n))];return s&&o[0].charAt(0)==o[0].charAt(1)&&o[1].charAt(0)==o[1].charAt(1)&&o[2].charAt(0)==o[2].charAt(1)&&o[3].charAt(0)==o[3].charAt(1)?o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0)+o[3].charAt(0):o.join("")}function FF(r,e,i,n){var s=[cc(jF(n)),cc(Math.round(r).toString(16)),cc(Math.round(e).toString(16)),cc(Math.round(i).toString(16))];return s.join("")}_r.equals=function(r,e){return!r||!e?!1:_r(r).toRgbString()==_r(e).toRgbString()},_r.random=function(){return _r.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function Kae(r,e){e=e===0?0:e||10;var i=_r(r).toHsl();return i.s-=e/100,i.s=s1(i.s),_r(i)}function Jae(r,e){e=e===0?0:e||10;var i=_r(r).toHsl();return i.s+=e/100,i.s=s1(i.s),_r(i)}function Zae(r){return _r(r).desaturate(100)}function $ae(r,e){e=e===0?0:e||10;var i=_r(r).toHsl();return i.l+=e/100,i.l=s1(i.l),_r(i)}function eoe(r,e){e=e===0?0:e||10;var i=_r(r).toRgb();return i.r=Math.max(0,Math.min(255,i.r-Math.round(255*-(e/100)))),i.g=Math.max(0,Math.min(255,i.g-Math.round(255*-(e/100)))),i.b=Math.max(0,Math.min(255,i.b-Math.round(255*-(e/100)))),_r(i)}function toe(r,e){e=e===0?0:e||10;var i=_r(r).toHsl();return i.l-=e/100,i.l=s1(i.l),_r(i)}function ioe(r,e){var i=_r(r).toHsl(),n=(i.h+e)%360;return i.h=n<0?360+n:n,_r(i)}function roe(r){var e=_r(r).toHsl();return e.h=(e.h+180)%360,_r(e)}function UF(r,e){if(isNaN(e)||e<=0)throw new Error("Argument to polyad must be a positive number");for(var i=_r(r).toHsl(),n=[_r(r)],s=360/e,o=1;o<e;o++)n.push(_r({h:(i.h+o*s)%360,s:i.s,l:i.l}));return n}function noe(r){var e=_r(r).toHsl(),i=e.h;return[_r(r),_r({h:(i+72)%360,s:e.s,l:e.l}),_r({h:(i+216)%360,s:e.s,l:e.l})]}function soe(r,e,i){e=e||6,i=i||30;var n=_r(r).toHsl(),s=360/i,o=[_r(r)];for(n.h=(n.h-(s*e>>1)+720)%360;--e;)n.h=(n.h+s)%360,o.push(_r(n));return o}function aoe(r,e){e=e||6;for(var i=_r(r).toHsv(),n=i.h,s=i.s,o=i.v,l=[],u=1/e;e--;)l.push(_r({h:n,s,v:o})),o=(o+u)%1;return l}_r.mix=function(r,e,i){i=i===0?0:i||50;var n=_r(r).toRgb(),s=_r(e).toRgb(),o=i/100,l={r:(s.r-n.r)*o+n.r,g:(s.g-n.g)*o+n.g,b:(s.b-n.b)*o+n.b,a:(s.a-n.a)*o+n.a};return _r(l)},_r.readability=function(r,e){var i=_r(r),n=_r(e);return(Math.max(i.getLuminance(),n.getLuminance())+.05)/(Math.min(i.getLuminance(),n.getLuminance())+.05)},_r.isReadable=function(r,e,i){var n=_r.readability(r,e),s,o;switch(o=!1,s=doe(i),s.level+s.size){case"AAsmall":case"AAAlarge":o=n>=4.5;break;case"AAlarge":o=n>=3;break;case"AAAsmall":o=n>=7;break}return o},_r.mostReadable=function(r,e,i){var n=null,s=0,o,l,u,c;i=i||{},l=i.includeFallbackColors,u=i.level,c=i.size;for(var h=0;h<e.length;h++)o=_r.readability(r,e[h]),o>s&&(s=o,n=_r(e[h]));return _r.isReadable(r,n,{level:u,size:c})||!l?n:(i.includeFallbackColors=!1,_r.mostReadable(r,["#fff","#000"],i))};var VT=_r.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},ooe=_r.hexNames=loe(VT);function loe(r){var e={};for(var i in r)r.hasOwnProperty(i)&&(e[r[i]]=i);return e}function zF(r){return r=parseFloat(r),(isNaN(r)||r<0||r>1)&&(r=1),r}function ws(r,e){coe(r)&&(r="100%");var i=uoe(r);return r=Math.min(e,Math.max(0,parseFloat(r))),i&&(r=parseInt(r*e,10)/100),Math.abs(r-e)<1e-6?1:r%e/parseFloat(e)}function s1(r){return Math.min(1,Math.max(0,r))}function hl(r){return parseInt(r,16)}function coe(r){return typeof r=="string"&&r.indexOf(".")!=-1&&parseFloat(r)===1}function uoe(r){return typeof r=="string"&&r.indexOf("%")!=-1}function cc(r){return r.length==1?"0"+r:""+r}function HA(r){return r<=1&&(r=r*100+"%"),r}function jF(r){return Math.round(parseFloat(r)*255).toString(16)}function VF(r){return hl(r)/255}var uc=function(){var r="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",i="(?:"+e+")|(?:"+r+")",n="[\\s|\\(]+("+i+")[,|\\s]+("+i+")[,|\\s]+("+i+")\\s*\\)?",s="[\\s|\\(]+("+i+")[,|\\s]+("+i+")[,|\\s]+("+i+")[,|\\s]+("+i+")\\s*\\)?";return{CSS_UNIT:new RegExp(i),rgb:new RegExp("rgb"+n),rgba:new RegExp("rgba"+s),hsl:new RegExp("hsl"+n),hsla:new RegExp("hsla"+s),hsv:new RegExp("hsv"+n),hsva:new RegExp("hsva"+s),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function Pu(r){return!!uc.CSS_UNIT.exec(r)}function hoe(r){r=r.replace(Gae,"").replace(Hae,"").toLowerCase();var e=!1;if(VT[r])r=VT[r],e=!0;else if(r=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var i;return(i=uc.rgb.exec(r))?{r:i[1],g:i[2],b:i[3]}:(i=uc.rgba.exec(r))?{r:i[1],g:i[2],b:i[3],a:i[4]}:(i=uc.hsl.exec(r))?{h:i[1],s:i[2],l:i[3]}:(i=uc.hsla.exec(r))?{h:i[1],s:i[2],l:i[3],a:i[4]}:(i=uc.hsv.exec(r))?{h:i[1],s:i[2],v:i[3]}:(i=uc.hsva.exec(r))?{h:i[1],s:i[2],v:i[3],a:i[4]}:(i=uc.hex8.exec(r))?{r:hl(i[1]),g:hl(i[2]),b:hl(i[3]),a:VF(i[4]),format:e?"name":"hex8"}:(i=uc.hex6.exec(r))?{r:hl(i[1]),g:hl(i[2]),b:hl(i[3]),format:e?"name":"hex"}:(i=uc.hex4.exec(r))?{r:hl(i[1]+""+i[1]),g:hl(i[2]+""+i[2]),b:hl(i[3]+""+i[3]),a:VF(i[4]+""+i[4]),format:e?"name":"hex8"}:(i=uc.hex3.exec(r))?{r:hl(i[1]+""+i[1]),g:hl(i[2]+""+i[2]),b:hl(i[3]+""+i[3]),format:e?"name":"hex"}:!1}function doe(r){var e,i;return r=r||{level:"AA",size:"small"},e=(r.level||"AA").toUpperCase(),i=(r.size||"small").toLowerCase(),e!=="AA"&&e!=="AAA"&&(e="AA"),i!=="small"&&i!=="large"&&(i="small"),{level:e,size:i}}function GT(r,e){(e==null||e>r.length)&&(e=r.length);for(var i=0,n=Array(e);i<e;i++)n[i]=r[i];return n}function poe(r){if(Array.isArray(r))return r}function foe(r){if(Array.isArray(r))return GT(r)}function moe(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function goe(r,e,i){return e=a1(e),Soe(r,WT()?Reflect.construct(e,i||[],a1(r).constructor):e.apply(r,i))}function Aoe(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function GF(r,e,i){if(WT())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var s=new(r.bind.apply(r,n));return s}function yoe(r,e,i){return Object.defineProperty(r,"prototype",{writable:!1}),r}function HT(r,e,i){return(e=Moe(e))in r?Object.defineProperty(r,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[e]=i,r}function a1(r){return a1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},a1(r)}function voe(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&QT(r,e)}function WT(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(WT=function(){return!!r})()}function xoe(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function boe(r,e){var i=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(i!=null){var n,s,o,l,u=[],c=!0,h=!1;try{if(o=(i=i.call(r)).next,e!==0)for(;!(c=(n=o.call(i)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(p){h=!0,s=p}finally{try{if(!c&&i.return!=null&&(l=i.return(),Object(l)!==l))return}finally{if(h)throw s}}return u}}function _oe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Eoe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HF(r,e){var i=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),i.push.apply(i,n)}return i}function WF(r){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?arguments[e]:{};e%2?HF(Object(i),!0).forEach(function(n){HT(r,n,i[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):HF(Object(i)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(i,n))})}return r}function woe(r,e){if(r==null)return{};var i,n,s=Coe(r,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);for(n=0;n<o.length;n++)i=o[n],e.includes(i)||{}.propertyIsEnumerable.call(r,i)&&(s[i]=r[i])}return s}function Coe(r,e){if(r==null)return{};var i={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(e.includes(n))continue;i[n]=r[n]}return i}function Soe(r,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return moe(r)}function QT(r,e){return QT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,n){return i.__proto__=n,i},QT(r,e)}function QF(r,e){return poe(r)||boe(r,e)||qF(r,e)||_oe()}function hc(r){return foe(r)||xoe(r)||qF(r)||Eoe()}function Toe(r,e){if(typeof r!="object"||!r)return r;var i=r[Symbol.toPrimitive];if(i!==void 0){var n=i.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function Moe(r){var e=Toe(r,"string");return typeof e=="symbol"?e:e+""}function qT(r){"@babel/helpers - typeof";return qT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qT(r)}function qF(r,e){if(r){if(typeof r=="string")return GT(r,e);var i={}.toString.call(r).slice(8,-1);return i==="Object"&&r.constructor&&(i=r.constructor.name),i==="Map"||i==="Set"?Array.from(r):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?GT(r,e):void 0}}var XF=function(r){r instanceof Array?r.forEach(XF):(r.map&&r.map.dispose(),r.dispose())},YF=function(r){r.geometry&&r.geometry.dispose(),r.material&&XF(r.material),r.texture&&r.texture.dispose(),r.children&&r.children.forEach(YF)},XT=function(r){for(;r.children.length;){var e=r.children[0];r.remove(e),YF(e)}},Roe=["objFilter"];function WA(r,e){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=i.objFilter,s=n===void 0?function(){return!0}:n,o=woe(i,Roe);return fae(r,e.children.filter(s),function(l){return e.add(l)},function(l){e.remove(l),XT(l)},WF({objBindAttr:"__threeObj"},o))}var QA=function(r){return isNaN(r)?parseInt(_r(r).toHex(),16):r},YT=function(r){return isNaN(r)?_r(r).getAlpha():1},Ioe=PT(DF);function KF(r,e,i){!e||typeof i!="string"||r.filter(function(n){return!n[i]}).forEach(function(n){n[i]=Ioe(e(n))})}function Boe(r,e){var i=r.nodes,n=r.links,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=s.nodeFilter,l=o===void 0?function(){return!0}:o,u=s.onLoopError,c=u===void 0?function(g){throw"Invalid DAG structure! Found cycle in node path: ".concat(g.join(" -> "),".")}:u,h={};i.forEach(function(g){return h[e(g)]={data:g,out:[],depth:-1,skip:!l(g)}}),n.forEach(function(g){var y=g.source,x=g.target,v=S(y),_=S(x);if(!h.hasOwnProperty(v))throw"Missing source node with id: ".concat(v);if(!h.hasOwnProperty(_))throw"Missing target node with id: ".concat(_);var T=h[v],w=h[_];T.out.push(w);function S(R){return qT(R)==="object"?e(R):R}});var p=[];m(Object.values(h));var f=Object.assign.apply(Object,[{}].concat(hc(Object.entries(h).filter(function(g){var y=QF(g,2),x=y[1];return!x.skip}).map(function(g){var y=QF(g,2),x=y[0],v=y[1];return HT({},x,v.depth)}))));return f;function m(g){for(var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],x=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,v=function(){var w=g[_];if(y.indexOf(w)!==-1){var S=[].concat(hc(y.slice(y.indexOf(w))),[w]).map(function(R){return e(R.data)});return p.some(function(R){return R.length===S.length&&R.every(function(B,I){return B===S[I]})})||(p.push(S),c(S)),1}x>w.depth&&(w.depth=x,m(w.out,[].concat(hc(y),[w]),x+(w.skip?0:1)))},_=0,T=g.length;_<T;_++)v()}}var Pr=window.THREE?window.THREE:{Group:Um,Mesh:za,MeshLambertMaterial:Xie,Color:Tn,BufferGeometry:Vo,BufferAttribute:jo,Matrix4:As,Vector3:at,SphereGeometry:Vb,CylinderGeometry:jb,TubeGeometry:cT,ConeGeometry:lT,Line:Yk,LineBasicMaterial:tT,QuadraticBezierCurve3:oT,CubicBezierCurve3:Zk,Box3:hp},JF={graph:Cne,forcelayout:sse},Noe=2,KT=new Pr.BufferGeometry().setAttribute?"setAttribute":"addAttribute",o1=new Pr.BufferGeometry().applyMatrix4?"applyMatrix4":"applyMatrix",Loe=Ep({props:{jsonUrl:{onChange:function(r,e){var i=this;r&&!e.fetchingJson&&(e.fetchingJson=!0,e.onLoading(),fetch(r).then(function(n){return n.json()}).then(function(n){e.fetchingJson=!1,e.onFinishLoading(n),i.graphData(n)}))},triggerUpdate:!1},graphData:{default:{nodes:[],links:[]},onChange:function(r,e){e.engineRunning=!1}},numDimensions:{default:3,onChange:function(r,e){var i=e.d3ForceLayout.force("charge");i&&i.strength(r>2?-60:-30),r<3&&n(e.graphData.nodes,"z"),r<2&&n(e.graphData.nodes,"y");function n(s,o){s.forEach(function(l){delete l[o],delete l["v".concat(o)]})}}},dagMode:{onChange:function(r,e){!r&&e.forceEngine==="d3"&&(e.graphData.nodes||[]).forEach(function(i){return i.fx=i.fy=i.fz=void 0})}},dagLevelDistance:{},dagNodeFilter:{default:function(r){return!0}},onDagError:{triggerUpdate:!1},nodeRelSize:{default:4},nodeId:{default:"id"},nodeVal:{default:"val"},nodeResolution:{default:8},nodeColor:{default:"color"},nodeAutoColorBy:{},nodeOpacity:{default:.75},nodeVisibility:{default:!0},nodeThreeObject:{},nodeThreeObjectExtend:{default:!1},nodePositionUpdate:{triggerUpdate:!1},linkSource:{default:"source"},linkTarget:{default:"target"},linkVisibility:{default:!0},linkColor:{default:"color"},linkAutoColorBy:{},linkOpacity:{default:.2},linkWidth:{},linkResolution:{default:6},linkCurvature:{default:0,triggerUpdate:!1},linkCurveRotation:{default:0,triggerUpdate:!1},linkMaterial:{},linkThreeObject:{},linkThreeObjectExtend:{default:!1},linkPositionUpdate:{triggerUpdate:!1},linkDirectionalArrowLength:{default:0},linkDirectionalArrowColor:{},linkDirectionalArrowRelPos:{default:.5,triggerUpdate:!1},linkDirectionalArrowResolution:{default:8},linkDirectionalParticles:{default:0},linkDirectionalParticleSpeed:{default:.01,triggerUpdate:!1},linkDirectionalParticleWidth:{default:.5},linkDirectionalParticleColor:{},linkDirectionalParticleResolution:{default:4},forceEngine:{default:"d3"},d3AlphaMin:{default:0},d3AlphaDecay:{default:.0228,triggerUpdate:!1,onChange:function(r,e){e.d3ForceLayout.alphaDecay(r)}},d3AlphaTarget:{default:0,triggerUpdate:!1,onChange:function(r,e){e.d3ForceLayout.alphaTarget(r)}},d3VelocityDecay:{default:.4,triggerUpdate:!1,onChange:function(r,e){e.d3ForceLayout.velocityDecay(r)}},ngraphPhysics:{default:{timeStep:20,gravity:-1.2,theta:.8,springLength:30,springCoefficient:8e-4,dragCoefficient:.02}},warmupTicks:{default:0,triggerUpdate:!1},cooldownTicks:{default:1/0,triggerUpdate:!1},cooldownTime:{default:15e3,triggerUpdate:!1},onLoading:{default:function(){},triggerUpdate:!1},onFinishLoading:{default:function(){},triggerUpdate:!1},onUpdate:{default:function(){},triggerUpdate:!1},onFinishUpdate:{default:function(){},triggerUpdate:!1},onEngineTick:{default:function(){},triggerUpdate:!1},onEngineStop:{default:function(){},triggerUpdate:!1}},methods:{refresh:function(r){return r._flushObjects=!0,r._rerender(),this},d3Force:function(r,e,i){return i===void 0?r.d3ForceLayout.force(e):(r.d3ForceLayout.force(e,i),this)},d3ReheatSimulation:function(r){return r.d3ForceLayout.alpha(1),this.resetCountdown(),this},resetCountdown:function(r){return r.cntTicks=0,r.startTickTime=new Date,r.engineRunning=!0,this},tickFrame:function(r){var e=r.forceEngine!=="ngraph";return r.engineRunning&&i(),n(),s(),this;function i(){++r.cntTicks>r.cooldownTicks||new Date-r.startTickTime>r.cooldownTime||e&&r.d3AlphaMin>0&&r.d3ForceLayout.alpha()<r.d3AlphaMin?(r.engineRunning=!1,r.onEngineStop()):(r.layout[e?"tick":"step"](),r.onEngineTick());var o=gr(r.nodeThreeObjectExtend);r.graphData.nodes.forEach(function(f){var m=f.__threeObj;if(m){var g=e?f:r.layout.getNodePosition(f[r.nodeId]),y=o(f);(!r.nodePositionUpdate||!r.nodePositionUpdate(y?m.children[0]:m,{x:g.x,y:g.y,z:g.z},f)||y)&&(m.position.x=g.x,m.position.y=g.y||0,m.position.z=g.z||0)}});var l=gr(r.linkWidth),u=gr(r.linkCurvature),c=gr(r.linkCurveRotation),h=gr(r.linkThreeObjectExtend);r.graphData.links.forEach(function(f){var m=f.__lineObj;if(m){var g=e?f:r.layout.getLinkPosition(r.layout.graph.getLink(f.source,f.target).id),y=g[e?"source":"from"],x=g[e?"target":"to"];if(!(!y||!x||!y.hasOwnProperty("x")||!x.hasOwnProperty("x"))){p(f);var v=h(f);if(!(r.linkPositionUpdate&&r.linkPositionUpdate(v?m.children[1]:m,{start:{x:y.x,y:y.y,z:y.z},end:{x:x.x,y:x.y,z:x.z}},f)&&!v)){var _=30,T=f.__curve,w=m.children.length?m.children[0]:m;if(w.type==="Line"){if(T){var S=T.getPoints(_);w.geometry.getAttribute("position").array.length!==S.length*3&&w.geometry[KT]("position",new Pr.BufferAttribute(new Float32Array(S.length*3),3)),w.geometry.setFromPoints(S)}else{var R=w.geometry.getAttribute("position");(!R||!R.array||R.array.length!==6)&&w.geometry[KT]("position",R=new Pr.BufferAttribute(new Float32Array(2*3),3)),R.array[0]=y.x,R.array[1]=y.y||0,R.array[2]=y.z||0,R.array[3]=x.x,R.array[4]=x.y||0,R.array[5]=x.z||0,R.needsUpdate=!0}w.geometry.computeBoundingSphere()}else if(w.type==="Mesh")if(T){w.geometry.type.match(/^Tube(Buffer)?Geometry$/)||(w.position.set(0,0,0),w.rotation.set(0,0,0),w.scale.set(1,1,1));var B=Math.ceil(l(f)*10)/10,I=B/2,D=new Pr.TubeGeometry(T,_,I,r.linkResolution,!1);w.geometry.dispose(),w.geometry=D}else{if(!w.geometry.type.match(/^Cylinder(Buffer)?Geometry$/)){var L=Math.ceil(l(f)*10)/10,O=L/2,U=new Pr.CylinderGeometry(O,O,1,r.linkResolution,1,!1);U[o1](new Pr.Matrix4().makeTranslation(0,1/2,0)),U[o1](new Pr.Matrix4().makeRotationX(Math.PI/2)),w.geometry.dispose(),w.geometry=U}var Z=new Pr.Vector3(y.x,y.y||0,y.z||0),G=new Pr.Vector3(x.x,x.y||0,x.z||0),z=Z.distanceTo(G);w.position.x=Z.x,w.position.y=Z.y,w.position.z=Z.z,w.scale.z=z,w.parent.localToWorld(G),w.lookAt(G)}}}}});function p(f){var m=e?f:r.layout.getLinkPosition(r.layout.graph.getLink(f.source,f.target).id),g=m[e?"source":"from"],y=m[e?"target":"to"];if(!(!g||!y||!g.hasOwnProperty("x")||!y.hasOwnProperty("x"))){var x=u(f);if(!x)f.__curve=null;else{var v=new Pr.Vector3(g.x,g.y||0,g.z||0),_=new Pr.Vector3(y.x,y.y||0,y.z||0),T=v.distanceTo(_),w,S=c(f);if(T>0){var R=y.x-g.x,B=y.y-g.y||0,I=new Pr.Vector3().subVectors(_,v),D=I.clone().multiplyScalar(x).cross(R!==0||B!==0?new Pr.Vector3(0,0,1):new Pr.Vector3(0,1,0)).applyAxisAngle(I.normalize(),S).add(new Pr.Vector3().addVectors(v,_).divideScalar(2));w=new Pr.QuadraticBezierCurve3(v,D,_)}else{var L=x*70,O=-S,U=O+Math.PI/2;w=new Pr.CubicBezierCurve3(v,new Pr.Vector3(L*Math.cos(U),L*Math.sin(U),0).add(v),new Pr.Vector3(L*Math.cos(O),L*Math.sin(O),0).add(v),_)}f.__curve=w}}}}function n(){var o=gr(r.linkDirectionalArrowRelPos),l=gr(r.linkDirectionalArrowLength),u=gr(r.nodeVal);r.graphData.links.forEach(function(c){var h=c.__arrowObj;if(h){var p=e?c:r.layout.getLinkPosition(r.layout.graph.getLink(c.source,c.target).id),f=p[e?"source":"from"],m=p[e?"target":"to"];if(!(!f||!m||!f.hasOwnProperty("x")||!m.hasOwnProperty("x"))){var g=Math.cbrt(Math.max(0,u(f)||1))*r.nodeRelSize,y=Math.cbrt(Math.max(0,u(m)||1))*r.nodeRelSize,x=l(c),v=o(c),_=c.__curve?function(I){return c.__curve.getPoint(I)}:function(I){var D=function(L,O,U,Z){return O[L]+(U[L]-O[L])*Z||0};return{x:D("x",f,m,I),y:D("y",f,m,I),z:D("z",f,m,I)}},T=c.__curve?c.__curve.getLength():Math.sqrt(["x","y","z"].map(function(I){return Math.pow((m[I]||0)-(f[I]||0),2)}).reduce(function(I,D){return I+D},0)),w=g+x+(T-g-y-x)*v,S=_(w/T),R=_((w-x)/T);["x","y","z"].forEach(function(I){return h.position[I]=R[I]});var B=GF(Pr.Vector3,hc(["x","y","z"].map(function(I){return S[I]})));h.parent.localToWorld(B),h.lookAt(B)}}})}function s(){var o=gr(r.linkDirectionalParticleSpeed);r.graphData.links.forEach(function(l){var u=l.__photonsObj&&l.__photonsObj.children,c=l.__singleHopPhotonsObj&&l.__singleHopPhotonsObj.children;if(!((!c||!c.length)&&(!u||!u.length))){var h=e?l:r.layout.getLinkPosition(r.layout.graph.getLink(l.source,l.target).id),p=h[e?"source":"from"],f=h[e?"target":"to"];if(!(!p||!f||!p.hasOwnProperty("x")||!f.hasOwnProperty("x"))){var m=o(l),g=l.__curve?function(x){return l.__curve.getPoint(x)}:function(x){var v=function(_,T,w,S){return T[_]+(w[_]-T[_])*S||0};return{x:v("x",p,f,x),y:v("y",p,f,x),z:v("z",p,f,x)}},y=[].concat(hc(u||[]),hc(c||[]));y.forEach(function(x,v){var _=x.parent.__linkThreeObjType==="singleHopPhotons";if(x.hasOwnProperty("__progressRatio")||(x.__progressRatio=_?0:v/u.length),x.__progressRatio+=m,x.__progressRatio>=1)if(!_)x.__progressRatio=x.__progressRatio%1;else{x.parent.remove(x),XT(x);return}var T=x.__progressRatio,w=g(T);["x","y","z"].forEach(function(S){return x.position[S]=w[S]})})}}})}},emitParticle:function(r,e){if(e&&r.graphData.links.includes(e)){if(!e.__singleHopPhotonsObj){var i=new Pr.Group;i.__linkThreeObjType="singleHopPhotons",e.__singleHopPhotonsObj=i,r.graphScene.add(i)}var n=gr(r.linkDirectionalParticleWidth),s=Math.ceil(n(e)*10)/10/2,o=r.linkDirectionalParticleResolution,l=new Pr.SphereGeometry(s,o,o),u=gr(r.linkColor),c=gr(r.linkDirectionalParticleColor),h=c(e)||u(e)||"#f0f0f0",p=new Pr.Color(QA(h)),f=r.linkOpacity*3,m=new Pr.MeshLambertMaterial({color:p,transparent:!0,opacity:f});e.__singleHopPhotonsObj.add(new Pr.Mesh(l,m))}return this},getGraphBbox:function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return!0};if(!r.initialised)return null;var i=function n(s){var o=[];if(s.geometry){s.geometry.computeBoundingBox();var l=new Pr.Box3;l.copy(s.geometry.boundingBox).applyMatrix4(s.matrixWorld),o.push(l)}return o.concat.apply(o,hc((s.children||[]).filter(function(u){return!u.hasOwnProperty("__graphObjType")||u.__graphObjType==="node"&&e(u.__data)}).map(n)))}(r.graphScene);return i.length?Object.assign.apply(Object,hc(["x","y","z"].map(function(n){return HT({},n,[NT(i,function(s){return s.min[n]}),BT(i,function(s){return s.max[n]})])}))):null}},stateInit:function(){return{d3ForceLayout:I4().force("link",b4()).force("charge",B4()).force("center",u4()).force("dagRadial",null).stop(),engineRunning:!1}},init:function(r,e){e.graphScene=r},update:function(r,e){var i=function(fe){return fe.some(function(de){return e.hasOwnProperty(de)})};if(r.engineRunning=!1,r.onUpdate(),r.nodeAutoColorBy!==null&&i(["nodeAutoColorBy","graphData","nodeColor"])&&KF(r.graphData.nodes,gr(r.nodeAutoColorBy),r.nodeColor),r.linkAutoColorBy!==null&&i(["linkAutoColorBy","graphData","linkColor"])&&KF(r.graphData.links,gr(r.linkAutoColorBy),r.linkColor),r._flushObjects||i(["graphData","nodeThreeObject","nodeThreeObjectExtend","nodeVal","nodeColor","nodeVisibility","nodeRelSize","nodeResolution","nodeOpacity"])){var n=gr(r.nodeThreeObject),s=gr(r.nodeThreeObjectExtend),o=gr(r.nodeVal),l=gr(r.nodeColor),u=gr(r.nodeVisibility),c={},h={};WA(r.graphData.nodes.filter(u),r.graphScene,{purge:r._flushObjects||i(["nodeThreeObject","nodeThreeObjectExtend"]),objFilter:function(fe){return fe.__graphObjType==="node"},createObj:function(fe){var de=n(fe),Ie=s(fe);de&&r.nodeThreeObject===de&&(de=de.clone());var Ge;return de&&!Ie?Ge=de:(Ge=new Pr.Mesh,Ge.__graphDefaultObj=!0,de&&Ie&&Ge.add(de)),Ge.__graphObjType="node",Ge},updateObj:function(fe,de){if(fe.__graphDefaultObj){var Ie=o(de)||1,Ge=Math.cbrt(Ie)*r.nodeRelSize,Xe=r.nodeResolution;(!fe.geometry.type.match(/^Sphere(Buffer)?Geometry$/)||fe.geometry.parameters.radius!==Ge||fe.geometry.parameters.widthSegments!==Xe)&&(c.hasOwnProperty(Ie)||(c[Ie]=new Pr.SphereGeometry(Ge,Xe,Xe)),fe.geometry.dispose(),fe.geometry=c[Ie]);var $e=l(de),lt=new Pr.Color(QA($e||"#ffffaa")),At=r.nodeOpacity*YT($e);(fe.material.type!=="MeshLambertMaterial"||!fe.material.color.equals(lt)||fe.material.opacity!==At)&&(h.hasOwnProperty($e)||(h[$e]=new Pr.MeshLambertMaterial({color:lt,transparent:!0,opacity:At})),fe.material.dispose(),fe.material=h[$e])}}})}if(r._flushObjects||i(["graphData","linkThreeObject","linkThreeObjectExtend","linkMaterial","linkColor","linkWidth","linkVisibility","linkResolution","linkOpacity","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowResolution","linkDirectionalParticles","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleResolution"])){var p=gr(r.linkThreeObject),f=gr(r.linkThreeObjectExtend),m=gr(r.linkMaterial),g=gr(r.linkVisibility),y=gr(r.linkColor),x=gr(r.linkWidth),v={},_={},T={},w=r.graphData.links.filter(g);if(WA(w,r.graphScene,{objBindAttr:"__lineObj",purge:r._flushObjects||i(["linkThreeObject","linkThreeObjectExtend","linkWidth"]),objFilter:function(fe){return fe.__graphObjType==="link"},exitObj:function(fe){var de=fe.__data&&fe.__data.__singleHopPhotonsObj;de&&(de.parent.remove(de),XT(de),delete fe.__data.__singleHopPhotonsObj)},createObj:function(fe){var de=p(fe),Ie=f(fe);de&&r.linkThreeObject===de&&(de=de.clone());var Ge;if(!de||Ie){var Xe=!!x(fe);if(Xe)Ge=new Pr.Mesh;else{var $e=new Pr.BufferGeometry;$e[KT]("position",new Pr.BufferAttribute(new Float32Array(2*3),3)),Ge=new Pr.Line($e)}}var lt;return de?Ie?(lt=new Pr.Group,lt.__graphDefaultObj=!0,lt.add(Ge),lt.add(de)):lt=de:(lt=Ge,lt.__graphDefaultObj=!0),lt.renderOrder=10,lt.__graphObjType="link",lt},updateObj:function(fe,de){if(fe.__graphDefaultObj){var Ie=fe.children.length?fe.children[0]:fe,Ge=Math.ceil(x(de)*10)/10,Xe=!!Ge;if(Xe){var $e=Ge/2,lt=r.linkResolution;if(!Ie.geometry.type.match(/^Cylinder(Buffer)?Geometry$/)||Ie.geometry.parameters.radiusTop!==$e||Ie.geometry.parameters.radialSegments!==lt){if(!v.hasOwnProperty(Ge)){var At=new Pr.CylinderGeometry($e,$e,1,lt,1,!1);At[o1](new Pr.Matrix4().makeTranslation(0,1/2,0)),At[o1](new Pr.Matrix4().makeRotationX(Math.PI/2)),v[Ge]=At}Ie.geometry.dispose(),Ie.geometry=v[Ge]}}var Gt=m(de);if(Gt)Ie.material=Gt;else{var gt=y(de),xi=new Pr.Color(QA(gt||"#f0f0f0")),Ze=r.linkOpacity*YT(gt),Ui=Xe?"MeshLambertMaterial":"LineBasicMaterial";if(Ie.material.type!==Ui||!Ie.material.color.equals(xi)||Ie.material.opacity!==Ze){var di=Xe?_:T;di.hasOwnProperty(gt)||(di[gt]=new Pr[Ui]({color:xi,transparent:Ze<1,opacity:Ze,depthWrite:Ze>=1})),Ie.material.dispose(),Ie.material=di[gt]}}}}}),r.linkDirectionalArrowLength||e.hasOwnProperty("linkDirectionalArrowLength")){var S=gr(r.linkDirectionalArrowLength),R=gr(r.linkDirectionalArrowColor);WA(w.filter(S),r.graphScene,{objBindAttr:"__arrowObj",objFilter:function(fe){return fe.__linkThreeObjType==="arrow"},createObj:function(){var fe=new Pr.Mesh(void 0,new Pr.MeshLambertMaterial({transparent:!0}));return fe.__linkThreeObjType="arrow",fe},updateObj:function(fe,de){var Ie=S(de),Ge=r.linkDirectionalArrowResolution;if(!fe.geometry.type.match(/^Cone(Buffer)?Geometry$/)||fe.geometry.parameters.height!==Ie||fe.geometry.parameters.radialSegments!==Ge){var Xe=new Pr.ConeGeometry(Ie*.25,Ie,Ge);Xe.translate(0,Ie/2,0),Xe.rotateX(Math.PI/2),fe.geometry.dispose(),fe.geometry=Xe}var $e=R(de)||y(de)||"#f0f0f0";fe.material.color=new Pr.Color(QA($e)),fe.material.opacity=r.linkOpacity*3*YT($e)}})}if(r.linkDirectionalParticles||e.hasOwnProperty("linkDirectionalParticles")){var B=gr(r.linkDirectionalParticles),I=gr(r.linkDirectionalParticleWidth),D=gr(r.linkDirectionalParticleColor),L={},O={};WA(w.filter(B),r.graphScene,{objBindAttr:"__photonsObj",objFilter:function(fe){return fe.__linkThreeObjType==="photons"},createObj:function(){var fe=new Pr.Group;return fe.__linkThreeObjType="photons",fe},updateObj:function(fe,de){var Ie=Math.round(Math.abs(B(de))),Ge=!!fe.children.length&&fe.children[0],Xe=Math.ceil(I(de)*10)/10/2,$e=r.linkDirectionalParticleResolution,lt;Ge&&Ge.geometry.parameters.radius===Xe&&Ge.geometry.parameters.widthSegments===$e?lt=Ge.geometry:(O.hasOwnProperty(Xe)||(O[Xe]=new Pr.SphereGeometry(Xe,$e,$e)),lt=O[Xe],Ge&&Ge.geometry.dispose());var At=D(de)||y(de)||"#f0f0f0",Gt=new Pr.Color(QA(At)),gt=r.linkOpacity*3,xi;Ge&&Ge.material.color.equals(Gt)&&Ge.material.opacity===gt?xi=Ge.material:(L.hasOwnProperty(At)||(L[At]=new Pr.MeshLambertMaterial({color:Gt,transparent:!0,opacity:gt})),xi=L[At],Ge&&Ge.material.dispose()),WA(hc(new Array(Ie)).map(function(Ze,Ui){return{idx:Ui}}),fe,{idAccessor:function(Ze){return Ze.idx},createObj:function(){return new Pr.Mesh(lt,xi)},updateObj:function(Ze){Ze.geometry=lt,Ze.material=xi}})}})}}if(r._flushObjects=!1,i(["graphData","nodeId","linkSource","linkTarget","numDimensions","forceEngine","dagMode","dagNodeFilter","dagLevelDistance"])){r.engineRunning=!1,r.graphData.links.forEach(function(fe){fe.source=fe[r.linkSource],fe.target=fe[r.linkTarget]});var U=r.forceEngine!=="ngraph",Z;if(U){(Z=r.d3ForceLayout).stop().alpha(1).numDimensions(r.numDimensions).nodes(r.graphData.nodes);var G=r.d3ForceLayout.force("link");G&&G.id(function(fe){return fe[r.nodeId]}).links(r.graphData.links);var z=r.dagMode&&Boe(r.graphData,function(fe){return fe[r.nodeId]},{nodeFilter:r.dagNodeFilter,onLoopError:r.onDagError||void 0}),$=Math.max.apply(Math,hc(Object.values(z||[]))),Q=r.dagLevelDistance||r.graphData.nodes.length/($||1)*Noe*(["radialin","radialout"].indexOf(r.dagMode)!==-1?.7:1);if(["lr","rl","td","bu","zin","zout"].includes(e.dagMode)){var H=["lr","rl"].includes(e.dagMode)?"fx":["td","bu"].includes(e.dagMode)?"fy":"fz";r.graphData.nodes.filter(r.dagNodeFilter).forEach(function(fe){return delete fe[H]})}if(["lr","rl","td","bu","zin","zout"].includes(r.dagMode)){var V=["rl","td","zout"].includes(r.dagMode),ne=function(fe){return(z[fe[r.nodeId]]-$/2)*Q*(V?-1:1)},Y=["lr","rl"].includes(r.dagMode)?"fx":["td","bu"].includes(r.dagMode)?"fy":"fz";r.graphData.nodes.filter(r.dagNodeFilter).forEach(function(fe){return fe[Y]=ne(fe)})}r.d3ForceLayout.force("dagRadial",["radialin","radialout"].indexOf(r.dagMode)!==-1?N4(function(fe){var de=z[fe[r.nodeId]]||-1;return(r.dagMode==="radialin"?$-de:de)*Q}).strength(function(fe){return r.dagNodeFilter(fe)?1:0}):null)}else{var ae=JF.graph();r.graphData.nodes.forEach(function(fe){ae.addNode(fe[r.nodeId])}),r.graphData.links.forEach(function(fe){ae.addLink(fe.source,fe.target)}),Z=JF.forcelayout(ae,WF({dimensions:r.numDimensions},r.ngraphPhysics)),Z.graph=ae}for(var xe=0;xe<r.warmupTicks&&!(U&&r.d3AlphaMin>0&&r.d3ForceLayout.alpha()<r.d3AlphaMin);xe++)Z[U?"tick":"step"]();r.layout=Z,this.resetCountdown()}r.engineRunning=!0,r.onFinishUpdate()}});function Doe(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Object,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=function(s){function o(){var l;Aoe(this,o);for(var u=arguments.length,c=new Array(u),h=0;h<u;h++)c[h]=arguments[h];return l=goe(this,o,[].concat(c)),l.__kapsuleInstance=GF(r,[].concat(hc(i?[l]:[]),c)),l}return voe(o,s),yoe(o)}(e);return Object.keys(r()).forEach(function(s){return n.prototype[s]=function(){var o,l=(o=this.__kapsuleInstance)[s].apply(o,arguments);return l===this.__kapsuleInstance?this:l}}),n}var Ooe=window.THREE?window.THREE:{Group:Um},JT=Doe(Loe,Ooe.Group,!0);const Poe=Object.freeze(Object.defineProperty({__proto__:null,default:JT},Symbol.toStringTag,{value:"Module"})),koe=x2(Poe);if(typeof AFRAME>"u")throw new Error("Component attempted to register before AFRAME was available.");let ZT=cre;"default"in ZT&&(ZT=ZT.default);let Sp=koe;"default"in Sp&&(Sp=Sp.default);const $T=function(r){return typeof r=="string"?JSON.parse(r):r},dc=function(r){if(typeof r=="function")return r;const e=eval;try{return e("("+r+")")}catch{}return null},Ps=function(r){return isNaN(parseFloat(r))?dc(r)?dc(r):r:parseFloat(r)};AFRAME.registerComponent("forcegraph",{schema:{jsonUrl:{type:"string",default:""},nodes:{parse:$T,default:[]},links:{parse:$T,default:[]},numDimensions:{type:"number",default:3},dagMode:{type:"string",default:""},dagLevelDistance:{type:"number",default:0},dagNodeFilter:{parse:dc,default:function(){return!0}},onDagError:{parse:dc,default:void 0},nodeRelSize:{type:"number",default:4},nodeId:{type:"string",default:"id"},nodeVal:{parse:Ps,default:"val"},nodeResolution:{type:"number",default:8},nodeVisibility:{parse:Ps,default:!0},nodeColor:{parse:Ps,default:"color"},nodeAutoColorBy:{parse:Ps,default:""},nodeOpacity:{type:"number",default:.75},nodeThreeObject:{parse:Ps,default:null},nodeThreeObjectExtend:{parse:Ps,default:!1},linkSource:{type:"string",default:"source"},linkTarget:{type:"string",default:"target"},linkVisibility:{parse:Ps,default:!0},linkColor:{parse:Ps,default:"color"},linkAutoColorBy:{parse:Ps,default:""},linkOpacity:{type:"number",default:.2},linkWidth:{parse:Ps,default:0},linkResolution:{type:"number",default:6},linkCurvature:{parse:Ps,default:0},linkCurveRotation:{parse:Ps,default:0},linkMaterial:{parse:Ps,default:null},linkThreeObject:{parse:Ps,default:null},linkThreeObjectExtend:{parse:Ps,default:!1},linkPositionUpdate:{parse:dc,default:null},linkDirectionalArrowLength:{parse:Ps,default:0},linkDirectionalArrowColor:{parse:Ps,default:null},linkDirectionalArrowRelPos:{parse:Ps,default:.5},linkDirectionalArrowResolution:{type:"number",default:8},linkDirectionalParticles:{parse:Ps,default:0},linkDirectionalParticleSpeed:{parse:Ps,default:.01},linkDirectionalParticleWidth:{parse:Ps,default:.5},linkDirectionalParticleColor:{parse:Ps,default:null},linkDirectionalParticleResolution:{type:"number",default:4},onNodeHover:{parse:dc,default:()=>{}},onLinkHover:{parse:dc,default:()=>{}},onNodeClick:{parse:dc,default:()=>{}},onLinkClick:{parse:dc,default:()=>{}},forceEngine:{type:"string",default:"d3"},d3AlphaMin:{type:"number",default:0},d3AlphaDecay:{type:"number",default:.0228},d3VelocityDecay:{type:"number",default:.4},ngraphPhysics:{parse:$T,default:null},warmupTicks:{type:"int",default:0},cooldownTicks:{type:"int",default:1e18},cooldownTime:{type:"int",default:15e3},onEngineTick:{parse:dc,default:function(){}},onEngineStop:{parse:dc,default:function(){}}},getGraphBbox:function(r){return this.forceGraph||(this.forceGraph=new Sp),this.forceGraph.getGraphBbox(r)},emitParticle:function(){this.forceGraph||(this.forceGraph=new Sp);const r=this.forceGraph,e=r.emitParticle.apply(r,arguments);return e===r?this:e},d3Force:function(){this.forceGraph||(this.forceGraph=new Sp);const r=this.forceGraph,e=r.d3Force.apply(r,arguments);return e===r?this:e},d3ReheatSimulation:function(){return this.forceGraph&&this.forceGraph.d3ReheatSimulation(),this},refresh:function(){return this.forceGraph&&this.forceGraph.refresh(),this},init:function(){const r=this.state={};r.infoEl=document.createElement("a-text"),r.infoEl.setAttribute("position","0 -0.1 -1"),r.infoEl.setAttribute("width",1),r.infoEl.setAttribute("align","center"),r.infoEl.setAttribute("color","lavender");const e=document.querySelector("a-entity[camera], a-camera");e.appendChild(r.infoEl),r.cameraObj=e.object3D.children.filter(function(i){return i.type==="PerspectiveCamera"})[0],this.el.sceneEl.addEventListener("camera-set-active",function(i){r.cameraObj=i.detail.cameraEl.components.camera.camera}),this.forceGraph||(this.forceGraph=new Sp),this.forceGraph.onFinishUpdate(()=>this.el.setObject3D("forcegraphGroup",this.forceGraph)).onLoading(()=>r.infoEl.setAttribute("value","Loading...")).onFinishLoading(()=>r.infoEl.setAttribute("value","")),this.el.addEventListener("raycaster-intersected",i=>r.hoverDetail=i.detail),this.el.addEventListener("raycaster-intersected-cleared",i=>r.hoverDetail=i.detail),this.el.addEventListener("click",()=>r.hoverObj&&this.data["on"+(r.hoverObj.__graphObjType==="node"?"Node":"Link")+"Click"](r.hoverObj.__data))},remove:function(){this.state.infoEl.remove(),this.el.removeObject3D("forcegraphGroup")},update:function(r){const e=this,i=this.data,n=AFRAME.utils.diff(i,r);["jsonUrl","numDimensions","dagMode","dagLevelDistance","dagNodeFilter","onDagError","nodeRelSize","nodeId","nodeVal","nodeResolution","nodeVisibility","nodeColor","nodeAutoColorBy","nodeOpacity","nodeThreeObject","nodeThreeObjectExtend","linkSource","linkTarget","linkVisibility","linkColor","linkAutoColorBy","linkOpacity","linkWidth","linkResolution","linkCurvature","linkCurveRotation","linkMaterial","linkThreeObject","linkThreeObjectExtend","linkPositionUpdate","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalArrowResolution","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleResolution","forceEngine","d3AlphaMin","d3AphaDecay","d3VelocityDecay","ngraphPhysics","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"].filter(function(s){return s in n}).forEach(function(s){e.forceGraph[s](i[s]!==""?i[s]:null)}),("nodes"in n||"links"in n)&&e.forceGraph.graphData({nodes:i.nodes,links:i.links})},tick:function(r,e){const i=this.state,n=this.data,s=i.hoverDetail?i.hoverDetail.getIntersection?i.hoverDetail.getIntersection(this.el):i.hoverDetail.intersection||void 0:void 0;let o=s?s.object:void 0;for(;o&&!o.hasOwnProperty("__graphObjType");)o=o.parent;if(o!==i.hoverObj){const l=i.hoverObj?i.hoverObj.__graphObjType:null,u=i.hoverObj?i.hoverObj.__data:null,c=o?o.__graphObjType:null,h=o?o.__data:null;l&&l!==c&&n["on"+(l==="node"?"Node":"Link")+"Hover"](null,u),c&&n["on"+(c==="node"?"Node":"Link")+"Hover"](h,l===c?u:null),i.hoverObj=o}this.forceGraph.tickFrame()}});function Wo(){return Wo=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)({}).hasOwnProperty.call(i,n)&&(r[n]=i[n])}return r},Wo.apply(null,arguments)}function Foe(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function qA(r,e){return qA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,n){return i.__proto__=n,i},qA(r,e)}function Uoe(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,qA(r,e)}function eM(r){return eM=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},eM(r)}function zoe(r){try{return Function.toString.call(r).indexOf("[native code]")!==-1}catch{return typeof r=="function"}}function ZF(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ZF=function(){return!!r})()}function joe(r,e,i){if(ZF())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var s=new(r.bind.apply(r,n));return i&&qA(s,i.prototype),s}function tM(r){var e=typeof Map=="function"?new Map:void 0;return tM=function(i){if(i===null||!zoe(i))return i;if(typeof i!="function")throw new TypeError("Super expression must either be null or a function");if(e!==void 0){if(e.has(i))return e.get(i);e.set(i,n)}function n(){return joe(i,arguments,eM(this).constructor)}return n.prototype=Object.create(i.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),qA(n,i)},tM(r)}var Voe={1:`Passed invalid arguments to hsl, please pass multiple numbers e.g. hsl(360, 0.75, 0.4) or an object e.g. rgb({ hue: 255, saturation: 0.4, lightness: 0.75 }).

`,2:`Passed invalid arguments to hsla, please pass multiple numbers e.g. hsla(360, 0.75, 0.4, 0.7) or an object e.g. rgb({ hue: 255, saturation: 0.4, lightness: 0.75, alpha: 0.7 }).

`,3:`Passed an incorrect argument to a color function, please pass a string representation of a color.

`,4:`Couldn't generate valid rgb string from %s, it returned %s.

`,5:`Couldn't parse the color string. Please provide the color as a string in hex, rgb, rgba, hsl or hsla notation.

`,6:`Passed invalid arguments to rgb, please pass multiple numbers e.g. rgb(255, 205, 100) or an object e.g. rgb({ red: 255, green: 205, blue: 100 }).

`,7:`Passed invalid arguments to rgba, please pass multiple numbers e.g. rgb(255, 205, 100, 0.75) or an object e.g. rgb({ red: 255, green: 205, blue: 100, alpha: 0.75 }).

`,8:`Passed invalid argument to toColorString, please pass a RgbColor, RgbaColor, HslColor or HslaColor object.

`,9:`Please provide a number of steps to the modularScale helper.

`,10:`Please pass a number or one of the predefined scales to the modularScale helper as the ratio.

`,11:`Invalid value passed as base to modularScale, expected number or em string but got "%s"

`,12:`Expected a string ending in "px" or a number passed as the first argument to %s(), got "%s" instead.

`,13:`Expected a string ending in "px" or a number passed as the second argument to %s(), got "%s" instead.

`,14:`Passed invalid pixel value ("%s") to %s(), please pass a value like "12px" or 12.

`,15:`Passed invalid base value ("%s") to %s(), please pass a value like "12px" or 12.

`,16:`You must provide a template to this method.

`,17:`You passed an unsupported selector state to this method.

`,18:`minScreen and maxScreen must be provided as stringified numbers with the same units.

`,19:`fromSize and toSize must be provided as stringified numbers with the same units.

`,20:`expects either an array of objects or a single object with the properties prop, fromSize, and toSize.

`,21:"expects the objects in the first argument array to have the properties `prop`, `fromSize`, and `toSize`.\n\n",22:"expects the first argument object to have the properties `prop`, `fromSize`, and `toSize`.\n\n",23:`fontFace expects a name of a font-family.

`,24:`fontFace expects either the path to the font file(s) or a name of a local copy.

`,25:`fontFace expects localFonts to be an array.

`,26:`fontFace expects fileFormats to be an array.

`,27:`radialGradient requries at least 2 color-stops to properly render.

`,28:`Please supply a filename to retinaImage() as the first argument.

`,29:`Passed invalid argument to triangle, please pass correct pointingDirection e.g. 'right'.

`,30:"Passed an invalid value to `height` or `width`. Please provide a pixel based unit.\n\n",31:`The animation shorthand only takes 8 arguments. See the specification for more information: http://mdn.io/animation

`,32:`To pass multiple animations please supply them in arrays, e.g. animation(['rotate', '2s'], ['move', '1s'])
To pass a single animation please supply them in simple values, e.g. animation('rotate', '2s')

`,33:`The animation shorthand arrays can only have 8 elements. See the specification for more information: http://mdn.io/animation

`,34:`borderRadius expects a radius value as a string or number as the second argument.

`,35:`borderRadius expects one of "top", "bottom", "left" or "right" as the first argument.

`,36:`Property must be a string value.

`,37:`Syntax Error at %s.

`,38:`Formula contains a function that needs parentheses at %s.

`,39:`Formula is missing closing parenthesis at %s.

`,40:`Formula has too many closing parentheses at %s.

`,41:`All values in a formula must have the same unit or be unitless.

`,42:`Please provide a number of steps to the modularScale helper.

`,43:`Please pass a number or one of the predefined scales to the modularScale helper as the ratio.

`,44:`Invalid value passed as base to modularScale, expected number or em/rem string but got %s.

`,45:`Passed invalid argument to hslToColorString, please pass a HslColor or HslaColor object.

`,46:`Passed invalid argument to rgbToColorString, please pass a RgbColor or RgbaColor object.

`,47:`minScreen and maxScreen must be provided as stringified numbers with the same units.

`,48:`fromSize and toSize must be provided as stringified numbers with the same units.

`,49:`Expects either an array of objects or a single object with the properties prop, fromSize, and toSize.

`,50:`Expects the objects in the first argument array to have the properties prop, fromSize, and toSize.

`,51:`Expects the first argument object to have the properties prop, fromSize, and toSize.

`,52:`fontFace expects either the path to the font file(s) or a name of a local copy.

`,53:`fontFace expects localFonts to be an array.

`,54:`fontFace expects fileFormats to be an array.

`,55:`fontFace expects a name of a font-family.

`,56:`linearGradient requries at least 2 color-stops to properly render.

`,57:`radialGradient requries at least 2 color-stops to properly render.

`,58:`Please supply a filename to retinaImage() as the first argument.

`,59:`Passed invalid argument to triangle, please pass correct pointingDirection e.g. 'right'.

`,60:"Passed an invalid value to `height` or `width`. Please provide a pixel based unit.\n\n",61:`Property must be a string value.

`,62:`borderRadius expects a radius value as a string or number as the second argument.

`,63:`borderRadius expects one of "top", "bottom", "left" or "right" as the first argument.

`,64:`The animation shorthand only takes 8 arguments. See the specification for more information: http://mdn.io/animation.

`,65:`To pass multiple animations please supply them in arrays, e.g. animation(['rotate', '2s'], ['move', '1s'])\\nTo pass a single animation please supply them in simple values, e.g. animation('rotate', '2s').

`,66:`The animation shorthand arrays can only have 8 elements. See the specification for more information: http://mdn.io/animation.

`,67:`You must provide a template to this method.

`,68:`You passed an unsupported selector state to this method.

`,69:`Expected a string ending in "px" or a number passed as the first argument to %s(), got %s instead.

`,70:`Expected a string ending in "px" or a number passed as the second argument to %s(), got %s instead.

`,71:`Passed invalid pixel value %s to %s(), please pass a value like "12px" or 12.

`,72:`Passed invalid base value %s to %s(), please pass a value like "12px" or 12.

`,73:`Please provide a valid CSS variable.

`,74:`CSS variable not found and no default was provided.

`,75:`important requires a valid style object, got a %s instead.

`,76:`fromSize and toSize must be provided as stringified numbers with the same units as minScreen and maxScreen.

`,77:`remToPx expects a value in "rem" but you provided it in "%s".

`,78:`base must be set in "px" or "%" but you set it in "%s".
`};function Goe(){for(var r=arguments.length,e=new Array(r),i=0;i<r;i++)e[i]=arguments[i];var n=e[0],s=[],o;for(o=1;o<e.length;o+=1)s.push(e[o]);return s.forEach(function(l){n=n.replace(/%[a-z]/,l)}),n}var Gc=function(r){Uoe(e,r);function e(i){var n;if(process.env.NODE_ENV==="production")n=r.call(this,"An error occurred. See https://github.com/styled-components/polished/blob/main/src/internalHelpers/errors.md#"+i+" for more information.")||this;else{for(var s=arguments.length,o=new Array(s>1?s-1:0),l=1;l<s;l++)o[l-1]=arguments[l];n=r.call(this,Goe.apply(void 0,[Voe[i]].concat(o)))||this}return Foe(n)}return e}(tM(Error));function iM(r){return Math.round(r*255)}function Hoe(r,e,i){return iM(r)+","+iM(e)+","+iM(i)}function l1(r,e,i,n){if(n===void 0&&(n=Hoe),e===0)return n(i,i,i);var s=(r%360+360)%360/60,o=(1-Math.abs(2*i-1))*e,l=o*(1-Math.abs(s%2-1)),u=0,c=0,h=0;s>=0&&s<1?(u=o,c=l):s>=1&&s<2?(u=l,c=o):s>=2&&s<3?(c=o,h=l):s>=3&&s<4?(c=l,h=o):s>=4&&s<5?(u=l,h=o):s>=5&&s<6&&(u=o,h=l);var p=i-o/2,f=u+p,m=c+p,g=h+p;return n(f,m,g)}var $F={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"639",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"};function Woe(r){if(typeof r!="string")return r;var e=r.toLowerCase();return $F[e]?"#"+$F[e]:r}var Qoe=/^#[a-fA-F0-9]{6}$/,qoe=/^#[a-fA-F0-9]{8}$/,Xoe=/^#[a-fA-F0-9]{3}$/,Yoe=/^#[a-fA-F0-9]{4}$/,rM=/^rgb\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*\)$/i,Koe=/^rgb(?:a)?\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i,Joe=/^hsl\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*\)$/i,Zoe=/^hsl(?:a)?\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i;function Tp(r){if(typeof r!="string")throw new Gc(3);var e=Woe(r);if(e.match(Qoe))return{red:parseInt(""+e[1]+e[2],16),green:parseInt(""+e[3]+e[4],16),blue:parseInt(""+e[5]+e[6],16)};if(e.match(qoe)){var i=parseFloat((parseInt(""+e[7]+e[8],16)/255).toFixed(2));return{red:parseInt(""+e[1]+e[2],16),green:parseInt(""+e[3]+e[4],16),blue:parseInt(""+e[5]+e[6],16),alpha:i}}if(e.match(Xoe))return{red:parseInt(""+e[1]+e[1],16),green:parseInt(""+e[2]+e[2],16),blue:parseInt(""+e[3]+e[3],16)};if(e.match(Yoe)){var n=parseFloat((parseInt(""+e[4]+e[4],16)/255).toFixed(2));return{red:parseInt(""+e[1]+e[1],16),green:parseInt(""+e[2]+e[2],16),blue:parseInt(""+e[3]+e[3],16),alpha:n}}var s=rM.exec(e);if(s)return{red:parseInt(""+s[1],10),green:parseInt(""+s[2],10),blue:parseInt(""+s[3],10)};var o=Koe.exec(e.substring(0,50));if(o)return{red:parseInt(""+o[1],10),green:parseInt(""+o[2],10),blue:parseInt(""+o[3],10),alpha:parseFloat(""+o[4])>1?parseFloat(""+o[4])/100:parseFloat(""+o[4])};var l=Joe.exec(e);if(l){var u=parseInt(""+l[1],10),c=parseInt(""+l[2],10)/100,h=parseInt(""+l[3],10)/100,p="rgb("+l1(u,c,h)+")",f=rM.exec(p);if(!f)throw new Gc(4,e,p);return{red:parseInt(""+f[1],10),green:parseInt(""+f[2],10),blue:parseInt(""+f[3],10)}}var m=Zoe.exec(e.substring(0,50));if(m){var g=parseInt(""+m[1],10),y=parseInt(""+m[2],10)/100,x=parseInt(""+m[3],10)/100,v="rgb("+l1(g,y,x)+")",_=rM.exec(v);if(!_)throw new Gc(4,e,v);return{red:parseInt(""+_[1],10),green:parseInt(""+_[2],10),blue:parseInt(""+_[3],10),alpha:parseFloat(""+m[4])>1?parseFloat(""+m[4])/100:parseFloat(""+m[4])}}throw new Gc(5)}function $oe(r){var e=r.red/255,i=r.green/255,n=r.blue/255,s=Math.max(e,i,n),o=Math.min(e,i,n),l=(s+o)/2;if(s===o)return r.alpha!==void 0?{hue:0,saturation:0,lightness:l,alpha:r.alpha}:{hue:0,saturation:0,lightness:l};var u,c=s-o,h=l>.5?c/(2-s-o):c/(s+o);switch(s){case e:u=(i-n)/c+(i<n?6:0);break;case i:u=(n-e)/c+2;break;default:u=(e-i)/c+4;break}return u*=60,r.alpha!==void 0?{hue:u,saturation:h,lightness:l,alpha:r.alpha}:{hue:u,saturation:h,lightness:l}}function id(r){return $oe(Tp(r))}var ele=function(r){return r.length===7&&r[1]===r[2]&&r[3]===r[4]&&r[5]===r[6]?"#"+r[1]+r[3]+r[5]:r},nM=ele;function Mp(r){var e=r.toString(16);return e.length===1?"0"+e:e}function sM(r){return Mp(Math.round(r*255))}function tle(r,e,i){return nM("#"+sM(r)+sM(e)+sM(i))}function eU(r,e,i){return l1(r,e,i,tle)}function ile(r,e,i){if(typeof r=="object"&&e===void 0&&i===void 0)return eU(r.hue,r.saturation,r.lightness);throw new Gc(1)}function rle(r,e,i,n){if(typeof r=="object"&&e===void 0&&i===void 0&&n===void 0)return r.alpha>=1?eU(r.hue,r.saturation,r.lightness):"rgba("+l1(r.hue,r.saturation,r.lightness)+","+r.alpha+")";throw new Gc(2)}function tU(r,e,i){if(typeof r=="number"&&typeof e=="number"&&typeof i=="number")return nM("#"+Mp(r)+Mp(e)+Mp(i));if(typeof r=="object"&&e===void 0&&i===void 0)return nM("#"+Mp(r.red)+Mp(r.green)+Mp(r.blue));throw new Gc(6)}function c1(r,e,i,n){if(typeof r=="object"&&e===void 0&&i===void 0&&n===void 0)return r.alpha>=1?tU(r.red,r.green,r.blue):"rgba("+r.red+","+r.green+","+r.blue+","+r.alpha+")";throw new Gc(7)}var nle=function(r){return typeof r.red=="number"&&typeof r.green=="number"&&typeof r.blue=="number"&&(typeof r.alpha!="number"||typeof r.alpha>"u")},sle=function(r){return typeof r.red=="number"&&typeof r.green=="number"&&typeof r.blue=="number"&&typeof r.alpha=="number"},ale=function(r){return typeof r.hue=="number"&&typeof r.saturation=="number"&&typeof r.lightness=="number"&&(typeof r.alpha!="number"||typeof r.alpha>"u")},ole=function(r){return typeof r.hue=="number"&&typeof r.saturation=="number"&&typeof r.lightness=="number"&&typeof r.alpha=="number"};function rd(r){if(typeof r!="object")throw new Gc(8);if(sle(r))return c1(r);if(nle(r))return tU(r);if(ole(r))return rle(r);if(ale(r))return ile(r);throw new Gc(8)}function iU(r,e,i){return function(){var n=i.concat(Array.prototype.slice.call(arguments));return n.length>=e?r.apply(this,n):iU(r,e,n)}}function dl(r){return iU(r,r.length,[])}function lle(r,e){if(e==="transparent")return e;var i=id(e);return rd(Wo({},i,{hue:i.hue+parseFloat(r)}))}dl(lle);function qm(r,e,i){return Math.max(r,Math.min(e,i))}function cle(r,e){if(e==="transparent")return e;var i=id(e);return rd(Wo({},i,{lightness:qm(0,1,i.lightness-parseFloat(r))}))}dl(cle);function ule(r,e){if(e==="transparent")return e;var i=id(e);return rd(Wo({},i,{saturation:qm(0,1,i.saturation-parseFloat(r))}))}dl(ule);function hle(r,e){if(e==="transparent")return e;var i=id(e);return rd(Wo({},i,{lightness:qm(0,1,i.lightness+parseFloat(r))}))}dl(hle);function dle(r,e,i){if(e==="transparent")return i;if(i==="transparent")return e;if(r===0)return i;var n=Tp(e),s=Wo({},n,{alpha:typeof n.alpha=="number"?n.alpha:1}),o=Tp(i),l=Wo({},o,{alpha:typeof o.alpha=="number"?o.alpha:1}),u=s.alpha-l.alpha,c=parseFloat(r)*2-1,h=c*u===-1?c:c+u,p=1+c*u,f=(h/p+1)/2,m=1-f,g={red:Math.floor(s.red*f+l.red*m),green:Math.floor(s.green*f+l.green*m),blue:Math.floor(s.blue*f+l.blue*m),alpha:s.alpha*parseFloat(r)+l.alpha*(1-parseFloat(r))};return c1(g)}var ple=dl(dle),rU=ple;function fle(r,e){if(e==="transparent")return e;var i=Tp(e),n=typeof i.alpha=="number"?i.alpha:1,s=Wo({},i,{alpha:qm(0,1,(n*100+parseFloat(r)*100)/100)});return c1(s)}var mle=dl(fle),nU=mle;function gle(r,e){if(e==="transparent")return e;var i=id(e);return rd(Wo({},i,{saturation:qm(0,1,i.saturation+parseFloat(r))}))}dl(gle);function Ale(r,e){return e==="transparent"?e:rd(Wo({},id(e),{hue:parseFloat(r)}))}dl(Ale);function yle(r,e){return e==="transparent"?e:rd(Wo({},id(e),{lightness:parseFloat(r)}))}dl(yle);function vle(r,e){return e==="transparent"?e:rd(Wo({},id(e),{saturation:parseFloat(r)}))}dl(vle);function xle(r,e){return e==="transparent"?e:rU(parseFloat(r),"rgb(0, 0, 0)",e)}dl(xle);function ble(r,e){return e==="transparent"?e:rU(parseFloat(r),"rgb(255, 255, 255)",e)}dl(ble);function _le(r,e){if(e==="transparent")return e;var i=Tp(e),n=typeof i.alpha=="number"?i.alpha:1,s=Wo({},i,{alpha:qm(0,1,+(n*100-parseFloat(r)*100).toFixed(2)/100)});return c1(s)}dl(_le);function Ele(r,e){e===void 0&&(e={});var i=e.insertAt;if(!(typeof document>"u")){var n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",i==="top"&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=r:s.appendChild(document.createTextNode(r))}}var wle=`.graph-nav-info {
  position: absolute;
  bottom: 5px;
  width: 100%;
  text-align: center;
  color: slategrey;
  opacity: 0.7;
  font-size: 10px;
  font-family: Sans-serif;
  z-index: 1000;
}`;Ele(wle);function aM(r,e){(e==null||e>r.length)&&(e=r.length);for(var i=0,n=Array(e);i<e;i++)n[i]=r[i];return n}function Cle(r){if(Array.isArray(r))return r}function Sle(r){if(Array.isArray(r))return aM(r)}function XA(r,e,i){return(e=Nle(e))in r?Object.defineProperty(r,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[e]=i,r}function Tle(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Mle(r,e){var i=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(i!=null){var n,s,o,l,u=[],c=!0,h=!1;try{if(o=(i=i.call(r)).next,e!==0)for(;!(c=(n=o.call(i)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(p){h=!0,s=p}finally{try{if(!c&&i.return!=null&&(l=i.return(),Object(l)!==l))return}finally{if(h)throw s}}return u}}function Rle(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ile(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sU(r,e){var i=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),i.push.apply(i,n)}return i}function aU(r){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?arguments[e]:{};e%2?sU(Object(i),!0).forEach(function(n){XA(r,n,i[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):sU(Object(i)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(i,n))})}return r}function oM(r,e){return Cle(r)||Mle(r,e)||oU(r,e)||Rle()}function u1(r){return Sle(r)||Tle(r)||oU(r)||Ile()}function Ble(r,e){if(typeof r!="object"||!r)return r;var i=r[Symbol.toPrimitive];if(i!==void 0){var n=i.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function Nle(r){var e=Ble(r,"string");return typeof e=="symbol"?e:e+""}function oU(r,e){if(r){if(typeof r=="string")return aM(r,e);var i={}.toString.call(r).slice(8,-1);return i==="Object"&&r.constructor&&(i=r.constructor.name),i==="Map"||i==="Set"?Array.from(r):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?aM(r,e):void 0}}var lU=Ep({props:{width:{default:window.innerWidth,triggerUpdate:!1,onChange:function(r,e){e.container&&(e.container.style.width="".concat(r,"px"))}},height:{default:window.innerHeight,triggerUpdate:!1,onChange:function(r,e){e.container&&(e.container.style.height="".concat(r,"px"))}},jsonUrl:{},graphData:{default:{nodes:[],links:[]}},numDimensions:{default:3},dagMode:{},dagLevelDistance:{},dagNodeFilter:{default:function(){return!0}},onDagError:{default:void 0},backgroundColor:{default:"#002"},showNavInfo:{default:!0},nodeRelSize:{default:4},nodeId:{default:"id"},nodeLabel:{default:"name"},nodeDesc:{default:"desc"},onNodeHover:{},onNodeClick:{},nodeVal:{default:"val"},nodeResolution:{default:8},nodeVisibility:{default:!0},nodeColor:{default:"color"},nodeAutoColorBy:{},nodeOpacity:{default:.75},nodeThreeObject:{},nodeThreeObjectExtend:{default:!1},linkSource:{default:"source"},linkTarget:{default:"target"},linkLabel:{default:"name"},linkDesc:{default:"desc"},onLinkHover:{},onLinkClick:{},linkVisibility:{default:!0},linkColor:{default:"color"},linkAutoColorBy:{},linkOpacity:{default:.2},linkWidth:{default:0},linkResolution:{default:6},linkCurvature:{default:0},linkCurveRotation:{default:0},linkMaterial:{},linkThreeObject:{},linkThreeObjectExtend:{default:!1},linkPositionUpdate:{},linkDirectionalArrowLength:{default:0},linkDirectionalArrowColor:{},linkDirectionalArrowRelPos:{default:.5},linkDirectionalArrowResolution:{default:8},linkDirectionalParticles:{default:0},linkDirectionalParticleSpeed:{default:.01},linkDirectionalParticleWidth:{default:.5},linkDirectionalParticleColor:{},linkDirectionalParticleResolution:{default:4},forceEngine:{default:"d3"},d3AlphaMin:{default:0},d3AlphaDecay:{default:.0228},d3VelocityDecay:{default:.4},ngraphPhysics:{},warmupTicks:{default:0},cooldownTicks:{},cooldownTime:{default:15e3},onEngineTick:{},onEngineStop:{}},methods:aU(aU({},Object.assign.apply(Object,[{}].concat(u1(["getGraphBbox","emitParticle","d3Force","d3ReheatSimulation","refresh"].map(function(r){return XA({},r,function(e){for(var i=e.forcegraph.components.forcegraph,n=arguments.length,s=new Array(n>1?n-1:0),o=1;o<n;o++)s[o-1]=arguments[o];var l=i[r].apply(i,s);return l===i?this:l})}))))),{},{_destructor:function(){this.graphData({nodes:[],links:[]})}}),init:function(r,e){r.innerHTML="",e.container=document.createElement("div"),r.appendChild(e.container),e.container.style.position="relative",e.container.style.width="".concat(e.width,"px"),e.container.style.height="".concat(e.height,"px"),e.container.appendChild(e.navInfo=document.createElement("div")),e.navInfo.className="graph-nav-info",e.navInfo.textContent="Mouse drag: look, gamepad/arrow/wasd keys: move";var i=document.createElement("a-scene");i.setAttribute("embedded",""),i.appendChild(e.sky=document.createElement("a-sky")),e.sky.setAttribute("radius",3e3);var n;i.appendChild(n=document.createElement("a-entity")),n.setAttribute("position","0 0 300"),n.setAttribute("movement-controls","controls: gamepad, touch; fly: true; speed: 7");var s;n.appendChild(s=document.createElement("a-entity")),s.setAttribute("camera",""),s.setAttribute("position","0 0 0"),s.setAttribute("look-controls","pointerLockEnabled: false"),s.setAttribute("wasd-controls","fly: true; acceleration: 700");var o;s.appendChild(o=document.createElement("a-text")),o.setAttribute("position","0 -0.3 -1"),o.setAttribute("width",2),o.setAttribute("align","center"),o.setAttribute("color","lavender"),o.setAttribute("value","");var l;s.appendChild(l=document.createElement("a-text")),l.setAttribute("position","0 -0.4 -1"),l.setAttribute("width",1.3),l.setAttribute("align","center"),l.setAttribute("color","lavender"),l.setAttribute("value",""),e.raycasterEls=[];var u;i.appendChild(u=document.createElement("a-entity")),u.setAttribute("cursor","rayOrigin: mouse; mouseCursorStylesEnabled: true"),u.setAttribute("raycaster","objects: [forcegraph]; interval: 100"),e.raycasterEls.push(u),["left","right"].forEach(function(c){var h;n.appendChild(h=document.createElement("a-entity")),h.setAttribute("laser-controls","hand: ".concat(c,"; model: false;")),h.setAttribute("raycaster","objects: [forcegraph]; interval: 100; lineColor: steelblue; lineOpacity: 0.85"),e.raycasterEls.push(h)}),i.appendChild(e.forcegraph=document.createElement("a-entity")),e.forcegraph.setAttribute("forcegraph",null),e.container.appendChild(i),e.forcegraph.setAttribute("forcegraph",Object.assign.apply(Object,u1(["node","link"].map(function(c){var h={node:"Node",link:"Link"}[c];return XA({},"on".concat(h,"Hover"),function(p,f){var m=p&&gr(e["".concat(c,"Label")])(p)||"",g=p&&gr(e["".concat(c,"Desc")])(p)||"";o.setAttribute("value",m),l.setAttribute("value",g),e["on".concat(h,"Hover")]&&e["on".concat(h,"Hover")](p,f)})}))))},update:function(r,e){if(e.hasOwnProperty("backgroundColor")){var i=Tp(r.backgroundColor).alpha;i===void 0&&(i=1),r.sky.setAttribute("color",nU(1,r.backgroundColor)),r.sky.setAttribute("opacity",i)}e.hasOwnProperty("showNavInfo")&&(r.navInfo.style.display=r.showNavInfo?null:"none");var n=["onNodeHover","onLinkHover","onNodeClick","onLinkClick"].some(function(l){return r[l]})||["nodeLabel","linkLabel"].some(function(l){return r[l]!=="name"})||["nodeDesc","linkDesc"].some(function(l){return r[l]!=="desc"});r.raycasterEls.forEach(function(l){return l.setAttribute("raycaster",n?"objects: [forcegraph]; interval: 100":"objects: __none__")});var s=["jsonUrl","numDimensions","dagMode","dagLevelDistance","dagNodeFilter","onDagError","nodeRelSize","nodeId","onNodeClick","nodeVal","nodeResolution","nodeVisibility","nodeColor","nodeAutoColorBy","nodeOpacity","nodeThreeObject","nodeThreeObjectExtend","linkSource","linkTarget","onLinkClick","linkVisibility","linkColor","linkAutoColorBy","linkOpacity","linkWidth","linkResolution","linkCurvature","linkCurveRotation","linkMaterial","linkThreeObject","linkThreeObjectExtend","linkPositionUpdate","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalArrowResolution","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleResolution","forceEngine","d3AlphaMin","d3AlphaDecay","d3VelocityDecay","ngraphPhysics","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"],o=Object.assign.apply(Object,[{}].concat(u1(Object.entries(r).filter(function(l){var u=oM(l,2),c=u[0],h=u[1];return e.hasOwnProperty(c)&&s.indexOf(c)!==-1&&h!==void 0&&h!==null}).map(function(l){var u=oM(l,2),c=u[0],h=u[1];return XA({},c,h)})),u1(Object.entries(r.graphData).map(function(l){var u=oM(l,2),c=u[0],h=u[1];return XA({},c,h)}))));r.forcegraph.setAttribute("forcegraph",o)}}),lM={exports:{}},cM={exports:{}},$n={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cU;function Lle(){if(cU)return $n;cU=1;var r=typeof Symbol=="function"&&Symbol.for,e=r?Symbol.for("react.element"):60103,i=r?Symbol.for("react.portal"):60106,n=r?Symbol.for("react.fragment"):60107,s=r?Symbol.for("react.strict_mode"):60108,o=r?Symbol.for("react.profiler"):60114,l=r?Symbol.for("react.provider"):60109,u=r?Symbol.for("react.context"):60110,c=r?Symbol.for("react.async_mode"):60111,h=r?Symbol.for("react.concurrent_mode"):60111,p=r?Symbol.for("react.forward_ref"):60112,f=r?Symbol.for("react.suspense"):60113,m=r?Symbol.for("react.suspense_list"):60120,g=r?Symbol.for("react.memo"):60115,y=r?Symbol.for("react.lazy"):60116,x=r?Symbol.for("react.block"):60121,v=r?Symbol.for("react.fundamental"):60117,_=r?Symbol.for("react.responder"):60118,T=r?Symbol.for("react.scope"):60119;function w(R){if(typeof R=="object"&&R!==null){var B=R.$$typeof;switch(B){case e:switch(R=R.type,R){case c:case h:case n:case o:case s:case f:return R;default:switch(R=R&&R.$$typeof,R){case u:case p:case y:case g:case l:return R;default:return B}}case i:return B}}}function S(R){return w(R)===h}return $n.AsyncMode=c,$n.ConcurrentMode=h,$n.ContextConsumer=u,$n.ContextProvider=l,$n.Element=e,$n.ForwardRef=p,$n.Fragment=n,$n.Lazy=y,$n.Memo=g,$n.Portal=i,$n.Profiler=o,$n.StrictMode=s,$n.Suspense=f,$n.isAsyncMode=function(R){return S(R)||w(R)===c},$n.isConcurrentMode=S,$n.isContextConsumer=function(R){return w(R)===u},$n.isContextProvider=function(R){return w(R)===l},$n.isElement=function(R){return typeof R=="object"&&R!==null&&R.$$typeof===e},$n.isForwardRef=function(R){return w(R)===p},$n.isFragment=function(R){return w(R)===n},$n.isLazy=function(R){return w(R)===y},$n.isMemo=function(R){return w(R)===g},$n.isPortal=function(R){return w(R)===i},$n.isProfiler=function(R){return w(R)===o},$n.isStrictMode=function(R){return w(R)===s},$n.isSuspense=function(R){return w(R)===f},$n.isValidElementType=function(R){return typeof R=="string"||typeof R=="function"||R===n||R===h||R===o||R===s||R===f||R===m||typeof R=="object"&&R!==null&&(R.$$typeof===y||R.$$typeof===g||R.$$typeof===l||R.$$typeof===u||R.$$typeof===p||R.$$typeof===v||R.$$typeof===_||R.$$typeof===T||R.$$typeof===x)},$n.typeOf=w,$n}var as={};/** @license React v16.13.1
 * react-is.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uU;function Dle(){return uU||(uU=1,process.env.NODE_ENV!=="production"&&function(){var r=typeof Symbol=="function"&&Symbol.for,e=r?Symbol.for("react.element"):60103,i=r?Symbol.for("react.portal"):60106,n=r?Symbol.for("react.fragment"):60107,s=r?Symbol.for("react.strict_mode"):60108,o=r?Symbol.for("react.profiler"):60114,l=r?Symbol.for("react.provider"):60109,u=r?Symbol.for("react.context"):60110,c=r?Symbol.for("react.async_mode"):60111,h=r?Symbol.for("react.concurrent_mode"):60111,p=r?Symbol.for("react.forward_ref"):60112,f=r?Symbol.for("react.suspense"):60113,m=r?Symbol.for("react.suspense_list"):60120,g=r?Symbol.for("react.memo"):60115,y=r?Symbol.for("react.lazy"):60116,x=r?Symbol.for("react.block"):60121,v=r?Symbol.for("react.fundamental"):60117,_=r?Symbol.for("react.responder"):60118,T=r?Symbol.for("react.scope"):60119;function w(gt){return typeof gt=="string"||typeof gt=="function"||gt===n||gt===h||gt===o||gt===s||gt===f||gt===m||typeof gt=="object"&&gt!==null&&(gt.$$typeof===y||gt.$$typeof===g||gt.$$typeof===l||gt.$$typeof===u||gt.$$typeof===p||gt.$$typeof===v||gt.$$typeof===_||gt.$$typeof===T||gt.$$typeof===x)}function S(gt){if(typeof gt=="object"&&gt!==null){var xi=gt.$$typeof;switch(xi){case e:var Ze=gt.type;switch(Ze){case c:case h:case n:case o:case s:case f:return Ze;default:var Ui=Ze&&Ze.$$typeof;switch(Ui){case u:case p:case y:case g:case l:return Ui;default:return xi}}case i:return xi}}}var R=c,B=h,I=u,D=l,L=e,O=p,U=n,Z=y,G=g,z=i,$=o,Q=s,H=f,V=!1;function ne(gt){return V||(V=!0,console.warn("The ReactIs.isAsyncMode() alias has been deprecated, and will be removed in React 17+. Update your code to use ReactIs.isConcurrentMode() instead. It has the exact same API.")),Y(gt)||S(gt)===c}function Y(gt){return S(gt)===h}function ae(gt){return S(gt)===u}function xe(gt){return S(gt)===l}function fe(gt){return typeof gt=="object"&&gt!==null&&gt.$$typeof===e}function de(gt){return S(gt)===p}function Ie(gt){return S(gt)===n}function Ge(gt){return S(gt)===y}function Xe(gt){return S(gt)===g}function $e(gt){return S(gt)===i}function lt(gt){return S(gt)===o}function At(gt){return S(gt)===s}function Gt(gt){return S(gt)===f}as.AsyncMode=R,as.ConcurrentMode=B,as.ContextConsumer=I,as.ContextProvider=D,as.Element=L,as.ForwardRef=O,as.Fragment=U,as.Lazy=Z,as.Memo=G,as.Portal=z,as.Profiler=$,as.StrictMode=Q,as.Suspense=H,as.isAsyncMode=ne,as.isConcurrentMode=Y,as.isContextConsumer=ae,as.isContextProvider=xe,as.isElement=fe,as.isForwardRef=de,as.isFragment=Ie,as.isLazy=Ge,as.isMemo=Xe,as.isPortal=$e,as.isProfiler=lt,as.isStrictMode=At,as.isSuspense=Gt,as.isValidElementType=w,as.typeOf=S}()),as}var hU;function dU(){return hU||(hU=1,process.env.NODE_ENV==="production"?cM.exports=Lle():cM.exports=Dle()),cM.exports}/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var uM,pU;function Ole(){if(pU)return uM;pU=1;var r=Object.getOwnPropertySymbols,e=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;function n(o){if(o==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(o)}function s(){try{if(!Object.assign)return!1;var o=new String("abc");if(o[5]="de",Object.getOwnPropertyNames(o)[0]==="5")return!1;for(var l={},u=0;u<10;u++)l["_"+String.fromCharCode(u)]=u;var c=Object.getOwnPropertyNames(l).map(function(p){return l[p]});if(c.join("")!=="0123456789")return!1;var h={};return"abcdefghijklmnopqrst".split("").forEach(function(p){h[p]=p}),Object.keys(Object.assign({},h)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}return uM=s()?Object.assign:function(o,l){for(var u,c=n(o),h,p=1;p<arguments.length;p++){u=Object(arguments[p]);for(var f in u)e.call(u,f)&&(c[f]=u[f]);if(r){h=r(u);for(var m=0;m<h.length;m++)i.call(u,h[m])&&(c[h[m]]=u[h[m]])}}return c},uM}var hM,fU;function dM(){if(fU)return hM;fU=1;var r="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return hM=r,hM}var mU,gU;function AU(){return gU||(gU=1,mU=Function.call.bind(Object.prototype.hasOwnProperty)),mU}var pM,yU;function Ple(){if(yU)return pM;yU=1;var r=function(){};if(process.env.NODE_ENV!=="production"){var e=dM(),i={},n=AU();r=function(o){var l="Warning: "+o;typeof console<"u"&&console.error(l);try{throw new Error(l)}catch{}}}function s(o,l,u,c,h){if(process.env.NODE_ENV!=="production"){for(var p in o)if(n(o,p)){var f;try{if(typeof o[p]!="function"){var m=Error((c||"React class")+": "+u+" type `"+p+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof o[p]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw m.name="Invariant Violation",m}f=o[p](l,p,c,u,null,e)}catch(y){f=y}if(f&&!(f instanceof Error)&&r((c||"React class")+": type specification of "+u+" `"+p+"` is invalid; the type checker function must return `null` or an `Error` but returned a "+typeof f+". You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument)."),f instanceof Error&&!(f.message in i)){i[f.message]=!0;var g=h?h():"";r("Failed "+u+" type: "+f.message+(g??""))}}}}return s.resetWarningCache=function(){process.env.NODE_ENV!=="production"&&(i={})},pM=s,pM}var fM,vU;function kle(){if(vU)return fM;vU=1;var r=dU(),e=Ole(),i=dM(),n=AU(),s=Ple(),o=function(){};process.env.NODE_ENV!=="production"&&(o=function(u){var c="Warning: "+u;typeof console<"u"&&console.error(c);try{throw new Error(c)}catch{}});function l(){return null}return fM=function(u,c){var h=typeof Symbol=="function"&&Symbol.iterator,p="@@iterator";function f(Y){var ae=Y&&(h&&Y[h]||Y[p]);if(typeof ae=="function")return ae}var m="<<anonymous>>",g={array:_("array"),bigint:_("bigint"),bool:_("boolean"),func:_("function"),number:_("number"),object:_("object"),string:_("string"),symbol:_("symbol"),any:T(),arrayOf:w,element:S(),elementType:R(),instanceOf:B,node:O(),objectOf:D,oneOf:I,oneOfType:L,shape:Z,exact:G};function y(Y,ae){return Y===ae?Y!==0||1/Y===1/ae:Y!==Y&&ae!==ae}function x(Y,ae){this.message=Y,this.data=ae&&typeof ae=="object"?ae:{},this.stack=""}x.prototype=Error.prototype;function v(Y){if(process.env.NODE_ENV!=="production")var ae={},xe=0;function fe(Ie,Ge,Xe,$e,lt,At,Gt){if($e=$e||m,At=At||Xe,Gt!==i){if(c){var gt=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");throw gt.name="Invariant Violation",gt}else if(process.env.NODE_ENV!=="production"&&typeof console<"u"){var xi=$e+":"+Xe;!ae[xi]&&xe<3&&(o("You are manually calling a React.PropTypes validation function for the `"+At+"` prop on `"+$e+"`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details."),ae[xi]=!0,xe++)}}return Ge[Xe]==null?Ie?Ge[Xe]===null?new x("The "+lt+" `"+At+"` is marked as required "+("in `"+$e+"`, but its value is `null`.")):new x("The "+lt+" `"+At+"` is marked as required in "+("`"+$e+"`, but its value is `undefined`.")):null:Y(Ge,Xe,$e,lt,At)}var de=fe.bind(null,!1);return de.isRequired=fe.bind(null,!0),de}function _(Y){function ae(xe,fe,de,Ie,Ge,Xe){var $e=xe[fe],lt=Q($e);if(lt!==Y){var At=H($e);return new x("Invalid "+Ie+" `"+Ge+"` of type "+("`"+At+"` supplied to `"+de+"`, expected ")+("`"+Y+"`."),{expectedType:Y})}return null}return v(ae)}function T(){return v(l)}function w(Y){function ae(xe,fe,de,Ie,Ge){if(typeof Y!="function")return new x("Property `"+Ge+"` of component `"+de+"` has invalid PropType notation inside arrayOf.");var Xe=xe[fe];if(!Array.isArray(Xe)){var $e=Q(Xe);return new x("Invalid "+Ie+" `"+Ge+"` of type "+("`"+$e+"` supplied to `"+de+"`, expected an array."))}for(var lt=0;lt<Xe.length;lt++){var At=Y(Xe,lt,de,Ie,Ge+"["+lt+"]",i);if(At instanceof Error)return At}return null}return v(ae)}function S(){function Y(ae,xe,fe,de,Ie){var Ge=ae[xe];if(!u(Ge)){var Xe=Q(Ge);return new x("Invalid "+de+" `"+Ie+"` of type "+("`"+Xe+"` supplied to `"+fe+"`, expected a single ReactElement."))}return null}return v(Y)}function R(){function Y(ae,xe,fe,de,Ie){var Ge=ae[xe];if(!r.isValidElementType(Ge)){var Xe=Q(Ge);return new x("Invalid "+de+" `"+Ie+"` of type "+("`"+Xe+"` supplied to `"+fe+"`, expected a single ReactElement type."))}return null}return v(Y)}function B(Y){function ae(xe,fe,de,Ie,Ge){if(!(xe[fe]instanceof Y)){var Xe=Y.name||m,$e=ne(xe[fe]);return new x("Invalid "+Ie+" `"+Ge+"` of type "+("`"+$e+"` supplied to `"+de+"`, expected ")+("instance of `"+Xe+"`."))}return null}return v(ae)}function I(Y){if(!Array.isArray(Y))return process.env.NODE_ENV!=="production"&&(arguments.length>1?o("Invalid arguments supplied to oneOf, expected an array, got "+arguments.length+" arguments. A common mistake is to write oneOf(x, y, z) instead of oneOf([x, y, z])."):o("Invalid argument supplied to oneOf, expected an array.")),l;function ae(xe,fe,de,Ie,Ge){for(var Xe=xe[fe],$e=0;$e<Y.length;$e++)if(y(Xe,Y[$e]))return null;var lt=JSON.stringify(Y,function(At,Gt){var gt=H(Gt);return gt==="symbol"?String(Gt):Gt});return new x("Invalid "+Ie+" `"+Ge+"` of value `"+String(Xe)+"` "+("supplied to `"+de+"`, expected one of "+lt+"."))}return v(ae)}function D(Y){function ae(xe,fe,de,Ie,Ge){if(typeof Y!="function")return new x("Property `"+Ge+"` of component `"+de+"` has invalid PropType notation inside objectOf.");var Xe=xe[fe],$e=Q(Xe);if($e!=="object")return new x("Invalid "+Ie+" `"+Ge+"` of type "+("`"+$e+"` supplied to `"+de+"`, expected an object."));for(var lt in Xe)if(n(Xe,lt)){var At=Y(Xe,lt,de,Ie,Ge+"."+lt,i);if(At instanceof Error)return At}return null}return v(ae)}function L(Y){if(!Array.isArray(Y))return process.env.NODE_ENV!=="production"&&o("Invalid argument supplied to oneOfType, expected an instance of array."),l;for(var ae=0;ae<Y.length;ae++){var xe=Y[ae];if(typeof xe!="function")return o("Invalid argument supplied to oneOfType. Expected an array of check functions, but received "+V(xe)+" at index "+ae+"."),l}function fe(de,Ie,Ge,Xe,$e){for(var lt=[],At=0;At<Y.length;At++){var Gt=Y[At],gt=Gt(de,Ie,Ge,Xe,$e,i);if(gt==null)return null;gt.data&&n(gt.data,"expectedType")&&lt.push(gt.data.expectedType)}var xi=lt.length>0?", expected one of type ["+lt.join(", ")+"]":"";return new x("Invalid "+Xe+" `"+$e+"` supplied to "+("`"+Ge+"`"+xi+"."))}return v(fe)}function O(){function Y(ae,xe,fe,de,Ie){return z(ae[xe])?null:new x("Invalid "+de+" `"+Ie+"` supplied to "+("`"+fe+"`, expected a ReactNode."))}return v(Y)}function U(Y,ae,xe,fe,de){return new x((Y||"React class")+": "+ae+" type `"+xe+"."+fe+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+de+"`.")}function Z(Y){function ae(xe,fe,de,Ie,Ge){var Xe=xe[fe],$e=Q(Xe);if($e!=="object")return new x("Invalid "+Ie+" `"+Ge+"` of type `"+$e+"` "+("supplied to `"+de+"`, expected `object`."));for(var lt in Y){var At=Y[lt];if(typeof At!="function")return U(de,Ie,Ge,lt,H(At));var Gt=At(Xe,lt,de,Ie,Ge+"."+lt,i);if(Gt)return Gt}return null}return v(ae)}function G(Y){function ae(xe,fe,de,Ie,Ge){var Xe=xe[fe],$e=Q(Xe);if($e!=="object")return new x("Invalid "+Ie+" `"+Ge+"` of type `"+$e+"` "+("supplied to `"+de+"`, expected `object`."));var lt=e({},xe[fe],Y);for(var At in lt){var Gt=Y[At];if(n(Y,At)&&typeof Gt!="function")return U(de,Ie,Ge,At,H(Gt));if(!Gt)return new x("Invalid "+Ie+" `"+Ge+"` key `"+At+"` supplied to `"+de+"`.\nBad object: "+JSON.stringify(xe[fe],null,"  ")+`
Valid keys: `+JSON.stringify(Object.keys(Y),null,"  "));var gt=Gt(Xe,At,de,Ie,Ge+"."+At,i);if(gt)return gt}return null}return v(ae)}function z(Y){switch(typeof Y){case"number":case"string":case"undefined":return!0;case"boolean":return!Y;case"object":if(Array.isArray(Y))return Y.every(z);if(Y===null||u(Y))return!0;var ae=f(Y);if(ae){var xe=ae.call(Y),fe;if(ae!==Y.entries){for(;!(fe=xe.next()).done;)if(!z(fe.value))return!1}else for(;!(fe=xe.next()).done;){var de=fe.value;if(de&&!z(de[1]))return!1}}else return!1;return!0;default:return!1}}function $(Y,ae){return Y==="symbol"?!0:ae?ae["@@toStringTag"]==="Symbol"||typeof Symbol=="function"&&ae instanceof Symbol:!1}function Q(Y){var ae=typeof Y;return Array.isArray(Y)?"array":Y instanceof RegExp?"object":$(ae,Y)?"symbol":ae}function H(Y){if(typeof Y>"u"||Y===null)return""+Y;var ae=Q(Y);if(ae==="object"){if(Y instanceof Date)return"date";if(Y instanceof RegExp)return"regexp"}return ae}function V(Y){var ae=H(Y);switch(ae){case"array":case"object":return"an "+ae;case"boolean":case"date":case"regexp":return"a "+ae;default:return ae}}function ne(Y){return!Y.constructor||!Y.constructor.name?m:Y.constructor.name}return g.checkPropTypes=s,g.resetWarningCache=s.resetWarningCache,g.PropTypes=g,g},fM}var mM,xU;function Fle(){if(xU)return mM;xU=1;var r=dM();function e(){}function i(){}return i.resetWarningCache=e,mM=function(){function n(l,u,c,h,p,f){if(f!==r){var m=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw m.name="Invariant Violation",m}}n.isRequired=n;function s(){return n}var o={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:s,element:n,elementType:n,instanceOf:s,node:n,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:i,resetWarningCache:e};return o.PropTypes=o,o},mM}if(process.env.NODE_ENV!=="production"){var Ule=dU(),zle=!0;lM.exports=kle()(Ule.isElement,zle)}else lM.exports=Fle()();var jle=lM.exports;const xt=v2(jle);function gM(r,e){(e==null||e>r.length)&&(e=r.length);for(var i=0,n=Array(e);i<e;i++)n[i]=r[i];return n}function Vle(r){if(Array.isArray(r))return r}function Gle(r){if(Array.isArray(r))return gM(r)}function h1(r,e,i){return(e=Yle(e))in r?Object.defineProperty(r,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[e]=i,r}function Hle(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Wle(r,e){var i=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(i!=null){var n,s,o,l,u=[],c=!0,h=!1;try{if(o=(i=i.call(r)).next,e!==0)for(;!(c=(n=o.call(i)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(p){h=!0,s=p}finally{try{if(!c&&i.return!=null&&(l=i.return(),Object(l)!==l))return}finally{if(h)throw s}}return u}}function Qle(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qle(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bU(r,e){var i=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),i.push.apply(i,n)}return i}function _U(r){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?arguments[e]:{};e%2?bU(Object(i),!0).forEach(function(n){h1(r,n,i[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):bU(Object(i)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(i,n))})}return r}function d1(r,e){return Vle(r)||Wle(r,e)||EU(r,e)||Qle()}function p1(r){return Gle(r)||Hle(r)||EU(r)||qle()}function Xle(r,e){if(typeof r!="object"||!r)return r;var i=r[Symbol.toPrimitive];if(i!==void 0){var n=i.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function Yle(r){var e=Xle(r,"string");return typeof e=="symbol"?e:e+""}function EU(r,e){if(r){if(typeof r=="string")return gM(r,e);var i={}.toString.call(r).slice(8,-1);return i==="Object"&&r.constructor&&(i=r.constructor.name),i==="Map"||i==="Set"?Array.from(r):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?gM(r,e):void 0}}var Kle=Ep({props:{width:{},height:{},yOffset:{default:1.5},glScale:{default:200},jsonUrl:{},graphData:{default:{nodes:[],links:[]}},numDimensions:{default:3},dagMode:{},dagLevelDistance:{},dagNodeFilter:{default:function(){return!0}},onDagError:{default:void 0},nodeRelSize:{default:4},nodeId:{default:"id"},nodeVal:{default:"val"},nodeResolution:{default:8},nodeVisibility:{default:!0},nodeColor:{default:"color"},nodeAutoColorBy:{},nodeOpacity:{default:.75},nodeThreeObject:{},nodeThreeObjectExtend:{default:!1},linkSource:{default:"source"},linkTarget:{default:"target"},linkVisibility:{default:!0},linkColor:{default:"color"},linkAutoColorBy:{},linkOpacity:{default:.2},linkWidth:{default:0},linkResolution:{default:6},linkCurvature:{default:0},linkCurveRotation:{default:0},linkMaterial:{},linkThreeObject:{},linkThreeObjectExtend:{default:!1},linkPositionUpdate:{},linkDirectionalArrowLength:{default:0},linkDirectionalArrowColor:{},linkDirectionalArrowRelPos:{default:.5},linkDirectionalArrowResolution:{default:8},linkDirectionalParticles:{default:0},linkDirectionalParticleSpeed:{default:.01},linkDirectionalParticleWidth:{default:.5},linkDirectionalParticleColor:{},linkDirectionalParticleResolution:{default:4},onNodeHover:{},onNodeClick:{},onLinkHover:{},onLinkClick:{},forceEngine:{default:"d3"},d3AlphaMin:{default:0},d3AlphaDecay:{default:.0228},d3VelocityDecay:{default:.4},ngraphPhysics:{},warmupTicks:{default:0},cooldownTicks:{},cooldownTime:{default:15e3},onEngineTick:{},onEngineStop:{}},methods:_U(_U({},Object.assign.apply(Object,[{}].concat(p1(["getGraphBbox","emitParticle","d3Force","d3ReheatSimulation","refresh"].map(function(r){return h1({},r,function(e){for(var i=e.forcegraph.components.forcegraph,n=arguments.length,s=new Array(n>1?n-1:0),o=1;o<n;o++)s[o-1]=arguments[o];var l=i[r].apply(i,s);return l===i?this:l})}))))),{},{_destructor:function(){this.graphData({nodes:[],links:[]})}}),init:function(r,e){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=i.markerAttrs,s=n===void 0?{preset:"hiro"}:n;r.innerHTML="",e.container=document.createElement("div"),r.appendChild(e.container);var o=document.createElement("a-scene");o.setAttribute("embedded",""),o.setAttribute("vr-mode-ui","enabled: false"),o.setAttribute("arjs","debugUIEnabled: false;");var l=document.createElement("a-marker");Object.entries(s).forEach(function(h){var p=d1(h,2),f=p[0],m=p[1];return l.setAttribute(f,m)}),o.appendChild(l);var u;o.appendChild(u=document.createElement("a-entity")),u.setAttribute("cursor"),u.setAttribute("raycaster","objects: [forcegraph]"),e.forcegraph=document.createElement("a-entity"),e.forcegraph.setAttribute("forcegraph",null),l.appendChild(e.forcegraph);var c=document.createElement("a-entity");c.setAttribute("camera",""),o.appendChild(c),e.container.appendChild(o)},update:function(r,e){e.hasOwnProperty("width")&&r.width&&(r.container.style.width="".concat(r.width,"px")),e.hasOwnProperty("height")&&r.height&&(r.container.style.height="".concat(r.height,"px")),e.hasOwnProperty("glScale")&&r.forcegraph.setAttribute("scale",p1(new Array(3)).map(function(){return 1/r.glScale}).join(" ")),e.hasOwnProperty("yOffset")&&r.forcegraph.setAttribute("position","0 ".concat(r.yOffset," 0"));var i=["jsonUrl","numDimensions","dagMode","dagLevelDistance","dagNodeFilter","onDagError","nodeRelSize","nodeId","nodeVal","nodeResolution","nodeVisibility","nodeColor","nodeAutoColorBy","nodeOpacity","nodeThreeObject","nodeThreeObjectExtend","linkSource","linkTarget","linkVisibility","linkColor","linkAutoColorBy","linkOpacity","linkWidth","linkResolution","linkCurvature","linkCurveRotation","linkMaterial","linkThreeObject","linkThreeObjectExtend","linkPositionUpdate","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalArrowResolution","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleResolution","onNodeHover","onNodeClick","onLinkHover","onLinkClick","forceEngine","d3AlphaMin","d3AlphaDecay","d3VelocityDecay","ngraphPhysics","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"],n=Object.assign.apply(Object,[{}].concat(p1(Object.entries(r).filter(function(s){var o=d1(s,2),l=o[0],u=o[1];return e.hasOwnProperty(l)&&i.indexOf(l)!==-1&&u!==void 0&&u!==null}).map(function(s){var o=d1(s,2),l=o[0],u=o[1];return h1({},l,u)})),p1(Object.entries(r.graphData).map(function(s){var o=d1(s,2),l=o[0],u=o[1];return h1({},l,u)}))));r.forcegraph.setAttribute("forcegraph",n)}});const Xm=new oc,ku=new ji,wU=new at,AM=new ji,f1=new ji,m1=new at,yM=new at,CU=new As,SU=new at,TU=new at;let Qo=null,Hc=null;const Fu=[],nd={NONE:-1,PAN:0,ROTATE:1};class Jle extends Gb{constructor(e,i,n=null){super(i,n),this.objects=e,this.recursive=!0,this.transformGroup=!1,this.rotateSpeed=1,this.raycaster=new a4,this.mouseButtons={LEFT:Ua.PAN,MIDDLE:Ua.PAN,RIGHT:Ua.ROTATE},this.touches={ONE:yu.PAN},this._onPointerMove=Zle.bind(this),this._onPointerDown=$le.bind(this),this._onPointerCancel=ece.bind(this),this._onContextMenu=tce.bind(this),n!==null&&this.connect()}connect(){this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointerup",this._onPointerCancel),this.domElement.addEventListener("pointerleave",this._onPointerCancel),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointerup",this._onPointerCancel),this.domElement.removeEventListener("pointerleave",this._onPointerCancel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="auto",this.domElement.style.cursor=""}dispose(){this.disconnect()}_updatePointer(e){const i=this.domElement.getBoundingClientRect();ku.x=(e.clientX-i.left)/i.width*2-1,ku.y=-(e.clientY-i.top)/i.height*2+1}_updateState(e){let i;if(e.pointerType==="touch")i=this.touches.ONE;else switch(e.button){case 0:i=this.mouseButtons.LEFT;break;case 1:i=this.mouseButtons.MIDDLE;break;case 2:i=this.mouseButtons.RIGHT;break;default:i=null}switch(i){case Ua.PAN:case yu.PAN:this.state=nd.PAN;break;case Ua.ROTATE:case yu.ROTATE:this.state=nd.ROTATE;break;default:this.state=nd.NONE}}getRaycaster(){return console.warn("THREE.DragControls: getRaycaster() has been deprecated. Use controls.raycaster instead."),this.raycaster}setObjects(e){console.warn("THREE.DragControls: setObjects() has been deprecated. Use controls.objects instead."),this.objects=e}getObjects(){return console.warn("THREE.DragControls: getObjects() has been deprecated. Use controls.objects instead."),this.objects}activate(){console.warn("THREE.DragControls: activate() has been renamed to connect()."),this.connect()}deactivate(){console.warn("THREE.DragControls: deactivate() has been renamed to disconnect()."),this.disconnect()}set mode(e){console.warn("THREE.DragControls: The .mode property has been removed. Define the type of transformation via the .mouseButtons or .touches properties.")}get mode(){console.warn("THREE.DragControls: The .mode property has been removed. Define the type of transformation via the .mouseButtons or .touches properties.")}}function Zle(r){const e=this.object,i=this.domElement,n=this.raycaster;if(this.enabled!==!1){if(this._updatePointer(r),n.setFromCamera(ku,e),Qo)this.state===nd.PAN?n.ray.intersectPlane(Xm,m1)&&Qo.position.copy(m1.sub(wU).applyMatrix4(CU)):this.state===nd.ROTATE&&(AM.subVectors(ku,f1).multiplyScalar(this.rotateSpeed),Qo.rotateOnWorldAxis(SU,AM.x),Qo.rotateOnWorldAxis(TU.normalize(),-AM.y)),this.dispatchEvent({type:"drag",object:Qo}),f1.copy(ku);else if(r.pointerType==="mouse"||r.pointerType==="pen")if(Fu.length=0,n.setFromCamera(ku,e),n.intersectObjects(this.objects,this.recursive,Fu),Fu.length>0){const s=Fu[0].object;Xm.setFromNormalAndCoplanarPoint(e.getWorldDirection(Xm.normal),yM.setFromMatrixPosition(s.matrixWorld)),Hc!==s&&Hc!==null&&(this.dispatchEvent({type:"hoveroff",object:Hc}),i.style.cursor="auto",Hc=null),Hc!==s&&(this.dispatchEvent({type:"hoveron",object:s}),i.style.cursor="pointer",Hc=s)}else Hc!==null&&(this.dispatchEvent({type:"hoveroff",object:Hc}),i.style.cursor="auto",Hc=null);f1.copy(ku)}}function $le(r){const e=this.object,i=this.domElement,n=this.raycaster;this.enabled!==!1&&(this._updatePointer(r),this._updateState(r),Fu.length=0,n.setFromCamera(ku,e),n.intersectObjects(this.objects,this.recursive,Fu),Fu.length>0&&(this.transformGroup===!0?Qo=MU(Fu[0].object):Qo=Fu[0].object,Xm.setFromNormalAndCoplanarPoint(e.getWorldDirection(Xm.normal),yM.setFromMatrixPosition(Qo.matrixWorld)),n.ray.intersectPlane(Xm,m1)&&(this.state===nd.PAN?(CU.copy(Qo.parent.matrixWorld).invert(),wU.copy(m1).sub(yM.setFromMatrixPosition(Qo.matrixWorld))):this.state===nd.ROTATE&&(SU.set(0,1,0).applyQuaternion(e.quaternion).normalize(),TU.set(1,0,0).applyQuaternion(e.quaternion).normalize())),i.style.cursor="move",this.dispatchEvent({type:"dragstart",object:Qo})),f1.copy(ku))}function ece(){this.enabled!==!1&&(Qo&&(this.dispatchEvent({type:"dragend",object:Qo}),Qo=null),this.domElement.style.cursor=Hc?"pointer":"auto",this.state=nd.NONE)}function tce(r){this.enabled!==!1&&r.preventDefault()}function MU(r,e=null){return r.isGroup&&(e=r),r.parent===null?e:MU(r.parent,e)}/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const g1="170",ice=0,rce=1,nce=2,sce=1,A1=3,Ym=0,pc=1,Km=2,Jm=0,sd=1,y1=2,v1=3,x1=4,RU=5,ad=100,IU=101,BU=102,ace=103,oce=104,NU=200,LU=201,DU=202,OU=203,b1=204,_1=205,PU=206,kU=207,FU=208,UU=209,zU=210,jU=0,VU=1,GU=2,E1=3,HU=4,WU=5,QU=6,qU=7,w1=0,lce=1,cce=2,Zm=0,uce=1,hce=2,dce=3,pce=4,fce=6,mce=7,vM=300,Rp=301,$m=302,YA=303,KA=304,xM=306,C1=1e3,eg=1001,S1=1002,no=1003,bM=1004,tg=1005,pl=1006,_M=1007,Uu=1008,od=1009,JA=1010,ZA=1011,ig=1012,wo=1013,ja=1014,fl=1015,zu=1016,gce=1017,Ace=1018,$A=1020,XU=35902,yce=1021,EM=1022,rg=1023,vce=1024,xce=1025,Ip=1026,ng=1027,wM=1028,CM=1029,ey=1030,SM=1031,bce=1032,TM=1033,MM=33776,T1=33777,M1=33778,R1=33779,YU=35840,KU=35841,JU=35842,ZU=35843,$U=36196,RM=37492,IM=37496,BM=37808,NM=37809,LM=37810,DM=37811,OM=37812,PM=37813,kM=37814,FM=37815,UM=37816,zM=37817,jM=37818,VM=37819,GM=37820,HM=37821,WM=36492,_ce=36283,e5=36284,t5=36285,i5=36286,ld=0,Ece=1,Bp="",Dr="srgb",cd="srgb-linear",r5="linear",ty="srgb",wce=0,Np=7680,Cce=7681,Sce=7682,Tce=7683,Mce=34055,Rce=34056,Ice=5386,Bce=512,Nce=513,Lce=514,Dce=515,Oce=516,Pce=517,kce=518,QM=519,n5=512,qM=513,s5=514,a5=515,o5=516,l5=517,c5=518,u5=519,I1=35044,sg=35048,fc=2e3,Lp=2001;class ag{addEventListener(e,i){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(i)===-1&&n[e].push(i)}hasEventListener(e,i){if(this._listeners===void 0)return!1;const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(i)!==-1}removeEventListener(e,i){if(this._listeners===void 0)return;const n=this._listeners[e];if(n!==void 0){const s=n.indexOf(i);s!==-1&&n.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const i=this._listeners[e.type];if(i!==void 0){e.target=this;const n=i.slice(0);for(let s=0,o=n.length;s<o;s++)n[s].call(this,e);e.target=null}}}const so=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let h5=1234567;const iy=Math.PI/180,ry=180/Math.PI;function ju(){const r=Math.random()*4294967295|0,e=Math.random()*4294967295|0,i=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(so[r&255]+so[r>>8&255]+so[r>>16&255]+so[r>>24&255]+"-"+so[e&255]+so[e>>8&255]+"-"+so[e>>16&15|64]+so[e>>24&255]+"-"+so[i&63|128]+so[i>>8&255]+"-"+so[i>>16&255]+so[i>>24&255]+so[n&255]+so[n>>8&255]+so[n>>16&255]+so[n>>24&255]).toLowerCase()}function Va(r,e,i){return Math.max(e,Math.min(i,r))}function XM(r,e){return(r%e+e)%e}function Fce(r,e,i,n,s){return n+(r-e)*(s-n)/(i-e)}function Uce(r,e,i){return r!==e?(i-r)/(e-r):0}function ny(r,e,i){return(1-i)*r+i*e}function zce(r,e,i,n){return ny(r,e,1-Math.exp(-i*n))}function jce(r,e=1){return e-Math.abs(XM(r,e*2)-e)}function Vce(r,e,i){return r<=e?0:r>=i?1:(r=(r-e)/(i-e),r*r*(3-2*r))}function Gce(r,e,i){return r<=e?0:r>=i?1:(r=(r-e)/(i-e),r*r*r*(r*(r*6-15)+10))}function Hce(r,e){return r+Math.floor(Math.random()*(e-r+1))}function Wce(r,e){return r+Math.random()*(e-r)}function Qce(r){return r*(.5-Math.random())}function qce(r){r!==void 0&&(h5=r);let e=h5+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function Xce(r){return r*iy}function Yce(r){return r*ry}function Kce(r){return(r&r-1)===0&&r!==0}function Jce(r){return Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))}function Zce(r){return Math.pow(2,Math.floor(Math.log(r)/Math.LN2))}function $ce(r,e,i,n,s){const o=Math.cos,l=Math.sin,u=o(i/2),c=l(i/2),h=o((e+n)/2),p=l((e+n)/2),f=o((e-n)/2),m=l((e-n)/2),g=o((n-e)/2),y=l((n-e)/2);switch(s){case"XYX":r.set(u*p,c*f,c*m,u*h);break;case"YZY":r.set(c*m,u*p,c*f,u*h);break;case"ZXZ":r.set(c*f,c*m,u*p,u*h);break;case"XZX":r.set(u*p,c*y,c*g,u*h);break;case"YXY":r.set(c*g,u*p,c*y,u*h);break;case"ZYZ":r.set(c*y,c*g,u*p,u*h);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+s)}}function Co(r,e){switch(e.constructor){case Float32Array:return r;case Uint32Array:return r/4294967295;case Uint16Array:return r/65535;case Uint8Array:return r/255;case Int32Array:return Math.max(r/2147483647,-1);case Int16Array:return Math.max(r/32767,-1);case Int8Array:return Math.max(r/127,-1);default:throw new Error("Invalid component type.")}}function rn(r,e){switch(e.constructor){case Float32Array:return r;case Uint32Array:return Math.round(r*4294967295);case Uint16Array:return Math.round(r*65535);case Uint8Array:return Math.round(r*255);case Int32Array:return Math.round(r*2147483647);case Int16Array:return Math.round(r*32767);case Int8Array:return Math.round(r*127);default:throw new Error("Invalid component type.")}}const eue={DEG2RAD:iy,RAD2DEG:ry,generateUUID:ju,clamp:Va,euclideanModulo:XM,mapLinear:Fce,inverseLerp:Uce,lerp:ny,damp:zce,pingpong:jce,smoothstep:Vce,smootherstep:Gce,randInt:Hce,randFloat:Wce,randFloatSpread:Qce,seededRandom:qce,degToRad:Xce,radToDeg:Yce,isPowerOfTwo:Kce,ceilPowerOfTwo:Jce,floorPowerOfTwo:Zce,setQuaternionFromProperEuler:$ce,normalize:rn,denormalize:Co};class Pn{constructor(e=0,i=0){Pn.prototype.isVector2=!0,this.x=e,this.y=i}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,i){return this.x=e,this.y=i,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const i=this.x,n=this.y,s=e.elements;return this.x=s[0]*i+s[3]*n+s[6],this.y=s[1]*i+s[4]*n+s[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,i){return this.x=Math.max(e.x,Math.min(i.x,this.x)),this.y=Math.max(e.y,Math.min(i.y,this.y)),this}clampScalar(e,i){return this.x=Math.max(e,Math.min(i,this.x)),this.y=Math.max(e,Math.min(i,this.y)),this}clampLength(e,i){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(i,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const i=Math.sqrt(this.lengthSq()*e.lengthSq());if(i===0)return Math.PI/2;const n=this.dot(e)/i;return Math.acos(Va(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const i=this.x-e.x,n=this.y-e.y;return i*i+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this}lerpVectors(e,i,n){return this.x=e.x+(i.x-e.x)*n,this.y=e.y+(i.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e}fromBufferAttribute(e,i){return this.x=e.getX(i),this.y=e.getY(i),this}rotateAround(e,i){const n=Math.cos(i),s=Math.sin(i),o=this.x-e.x,l=this.y-e.y;return this.x=o*n-l*s+e.x,this.y=o*s+l*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class qo{constructor(e,i,n,s,o,l,u,c,h){qo.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,i,n,s,o,l,u,c,h)}set(e,i,n,s,o,l,u,c,h){const p=this.elements;return p[0]=e,p[1]=s,p[2]=u,p[3]=i,p[4]=o,p[5]=c,p[6]=n,p[7]=l,p[8]=h,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const i=this.elements,n=e.elements;return i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],this}extractBasis(e,i,n){return e.setFromMatrix3Column(this,0),i.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const i=e.elements;return this.set(i[0],i[4],i[8],i[1],i[5],i[9],i[2],i[6],i[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,i){const n=e.elements,s=i.elements,o=this.elements,l=n[0],u=n[3],c=n[6],h=n[1],p=n[4],f=n[7],m=n[2],g=n[5],y=n[8],x=s[0],v=s[3],_=s[6],T=s[1],w=s[4],S=s[7],R=s[2],B=s[5],I=s[8];return o[0]=l*x+u*T+c*R,o[3]=l*v+u*w+c*B,o[6]=l*_+u*S+c*I,o[1]=h*x+p*T+f*R,o[4]=h*v+p*w+f*B,o[7]=h*_+p*S+f*I,o[2]=m*x+g*T+y*R,o[5]=m*v+g*w+y*B,o[8]=m*_+g*S+y*I,this}multiplyScalar(e){const i=this.elements;return i[0]*=e,i[3]*=e,i[6]*=e,i[1]*=e,i[4]*=e,i[7]*=e,i[2]*=e,i[5]*=e,i[8]*=e,this}determinant(){const e=this.elements,i=e[0],n=e[1],s=e[2],o=e[3],l=e[4],u=e[5],c=e[6],h=e[7],p=e[8];return i*l*p-i*u*h-n*o*p+n*u*c+s*o*h-s*l*c}invert(){const e=this.elements,i=e[0],n=e[1],s=e[2],o=e[3],l=e[4],u=e[5],c=e[6],h=e[7],p=e[8],f=p*l-u*h,m=u*c-p*o,g=h*o-l*c,y=i*f+n*m+s*g;if(y===0)return this.set(0,0,0,0,0,0,0,0,0);const x=1/y;return e[0]=f*x,e[1]=(s*h-p*n)*x,e[2]=(u*n-s*l)*x,e[3]=m*x,e[4]=(p*i-s*c)*x,e[5]=(s*o-u*i)*x,e[6]=g*x,e[7]=(n*c-h*i)*x,e[8]=(l*i-n*o)*x,this}transpose(){let e;const i=this.elements;return e=i[1],i[1]=i[3],i[3]=e,e=i[2],i[2]=i[6],i[6]=e,e=i[5],i[5]=i[7],i[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const i=this.elements;return e[0]=i[0],e[1]=i[3],e[2]=i[6],e[3]=i[1],e[4]=i[4],e[5]=i[7],e[6]=i[2],e[7]=i[5],e[8]=i[8],this}setUvTransform(e,i,n,s,o,l,u){const c=Math.cos(o),h=Math.sin(o);return this.set(n*c,n*h,-n*(c*l+h*u)+l+e,-s*h,s*c,-s*(-h*l+c*u)+u+i,0,0,1),this}scale(e,i){return this.premultiply(YM.makeScale(e,i)),this}rotate(e){return this.premultiply(YM.makeRotation(-e)),this}translate(e,i){return this.premultiply(YM.makeTranslation(e,i)),this}makeTranslation(e,i){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,i,0,0,1),this}makeRotation(e){const i=Math.cos(e),n=Math.sin(e);return this.set(i,-n,0,n,i,0,0,0,1),this}makeScale(e,i){return this.set(e,0,0,0,i,0,0,0,1),this}equals(e){const i=this.elements,n=e.elements;for(let s=0;s<9;s++)if(i[s]!==n[s])return!1;return!0}fromArray(e,i=0){for(let n=0;n<9;n++)this.elements[n]=e[n+i];return this}toArray(e=[],i=0){const n=this.elements;return e[i]=n[0],e[i+1]=n[1],e[i+2]=n[2],e[i+3]=n[3],e[i+4]=n[4],e[i+5]=n[5],e[i+6]=n[6],e[i+7]=n[7],e[i+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const YM=new qo;function tue(r){for(let e=r.length-1;e>=0;--e)if(r[e]>=65535)return!0;return!1}function KM(r){return document.createElementNS("http://www.w3.org/1999/xhtml",r)}function iue(){const r=KM("canvas");return r.style.display="block",r}const d5={};function rue(r){r in d5||(d5[r]=!0,console.warn(r))}const $s={enabled:!0,workingColorSpace:cd,spaces:{},convert:function(r,e,i){return this.enabled===!1||e===i||!e||!i||(this.spaces[e].transfer===ty&&(r.r=Vu(r.r),r.g=Vu(r.g),r.b=Vu(r.b)),this.spaces[e].primaries!==this.spaces[i].primaries&&(r.applyMatrix3(this.spaces[e].toXYZ),r.applyMatrix3(this.spaces[i].fromXYZ)),this.spaces[i].transfer===ty&&(r.r=og(r.r),r.g=og(r.g),r.b=og(r.b))),r},fromWorkingColorSpace:function(r,e){return this.convert(r,this.workingColorSpace,e)},toWorkingColorSpace:function(r,e){return this.convert(r,e,this.workingColorSpace)},getPrimaries:function(r){return this.spaces[r].primaries},getTransfer:function(r){return r===Bp?r5:this.spaces[r].transfer},getLuminanceCoefficients:function(r,e=this.workingColorSpace){return r.fromArray(this.spaces[e].luminanceCoefficients)},define:function(r){Object.assign(this.spaces,r)},_getMatrix:function(r,e,i){return r.copy(this.spaces[e].toXYZ).multiply(this.spaces[i].fromXYZ)},_getDrawingBufferColorSpace:function(r){return this.spaces[r].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(r=this.workingColorSpace){return this.spaces[r].workingColorSpaceConfig.unpackColorSpace}};function Vu(r){return r<.04045?r*.0773993808:Math.pow(r*.9478672986+.0521327014,2.4)}function og(r){return r<.0031308?r*12.92:1.055*Math.pow(r,.41666)-.055}const p5=[.64,.33,.3,.6,.15,.06],f5=[.2126,.7152,.0722],m5=[.3127,.329],g5=new qo().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),A5=new qo().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);$s.define({[cd]:{primaries:p5,whitePoint:m5,transfer:r5,toXYZ:g5,fromXYZ:A5,luminanceCoefficients:f5,workingColorSpaceConfig:{unpackColorSpace:Dr},outputColorSpaceConfig:{drawingBufferColorSpace:Dr}},[Dr]:{primaries:p5,whitePoint:m5,transfer:ty,toXYZ:g5,fromXYZ:A5,luminanceCoefficients:f5,outputColorSpaceConfig:{drawingBufferColorSpace:Dr}}});let lg;class nue{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let i;if(e instanceof HTMLCanvasElement)i=e;else{lg===void 0&&(lg=KM("canvas")),lg.width=e.width,lg.height=e.height;const n=lg.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),i=lg}return i.width>2048||i.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),i.toDataURL("image/jpeg",.6)):i.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const i=KM("canvas");i.width=e.width,i.height=e.height;const n=i.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const s=n.getImageData(0,0,e.width,e.height),o=s.data;for(let l=0;l<o.length;l++)o[l]=Vu(o[l]/255)*255;return n.putImageData(s,0,0),i}else if(e.data){const i=e.data.slice(0);for(let n=0;n<i.length;n++)i instanceof Uint8Array||i instanceof Uint8ClampedArray?i[n]=Math.floor(Vu(i[n]/255)*255):i[n]=Vu(i[n]);return{data:i,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let sue=0,y5=class{constructor(r=null){this.isSource=!0,Object.defineProperty(this,"id",{value:sue++}),this.uuid=ju(),this.data=r,this.dataReady=!0,this.version=0}set needsUpdate(r){r===!0&&this.version++}toJSON(r){const e=r===void 0||typeof r=="string";if(!e&&r.images[this.uuid]!==void 0)return r.images[this.uuid];const i={uuid:this.uuid,url:""},n=this.data;if(n!==null){let s;if(Array.isArray(n)){s=[];for(let o=0,l=n.length;o<l;o++)n[o].isDataTexture?s.push(JM(n[o].image)):s.push(JM(n[o]))}else s=JM(n);i.url=s}return e||(r.images[this.uuid]=i),i}};function JM(r){return typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&r instanceof ImageBitmap?nue.getDataURL(r):r.data?{data:Array.from(r.data),width:r.width,height:r.height,type:r.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let aue=0;class So extends ag{constructor(e=So.DEFAULT_IMAGE,i=So.DEFAULT_MAPPING,n=eg,s=eg,o=pl,l=Uu,u=rg,c=od,h=So.DEFAULT_ANISOTROPY,p=Bp){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:aue++}),this.uuid=ju(),this.name="",this.source=new y5(e),this.mipmaps=[],this.mapping=i,this.channel=0,this.wrapS=n,this.wrapT=s,this.magFilter=o,this.minFilter=l,this.anisotropy=h,this.format=u,this.internalFormat=null,this.type=c,this.offset=new Pn(0,0),this.repeat=new Pn(1,1),this.center=new Pn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new qo,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=p,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const i=e===void 0||typeof e=="string";if(!i&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),i||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==vM)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case C1:e.x=e.x-Math.floor(e.x);break;case eg:e.x=e.x<0?0:1;break;case S1:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case C1:e.y=e.y-Math.floor(e.y);break;case eg:e.y=e.y<0?0:1;break;case S1:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}So.DEFAULT_IMAGE=null,So.DEFAULT_MAPPING=vM,So.DEFAULT_ANISOTROPY=1;class es{constructor(e=0,i=0,n=0,s=1){es.prototype.isVector4=!0,this.x=e,this.y=i,this.z=n,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,i,n,s){return this.x=e,this.y=i,this.z=n,this.w=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;case 3:this.w=i;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this.z=e.z+i.z,this.w=e.w+i.w,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this.z+=e.z*i,this.w+=e.w*i,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this.z=e.z-i.z,this.w=e.w-i.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const i=this.x,n=this.y,s=this.z,o=this.w,l=e.elements;return this.x=l[0]*i+l[4]*n+l[8]*s+l[12]*o,this.y=l[1]*i+l[5]*n+l[9]*s+l[13]*o,this.z=l[2]*i+l[6]*n+l[10]*s+l[14]*o,this.w=l[3]*i+l[7]*n+l[11]*s+l[15]*o,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const i=Math.sqrt(1-e.w*e.w);return i<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/i,this.y=e.y/i,this.z=e.z/i),this}setAxisAngleFromRotationMatrix(e){let i,n,s,o;const l=e.elements,u=l[0],c=l[4],h=l[8],p=l[1],f=l[5],m=l[9],g=l[2],y=l[6],x=l[10];if(Math.abs(c-p)<.01&&Math.abs(h-g)<.01&&Math.abs(m-y)<.01){if(Math.abs(c+p)<.1&&Math.abs(h+g)<.1&&Math.abs(m+y)<.1&&Math.abs(u+f+x-3)<.1)return this.set(1,0,0,0),this;i=Math.PI;const _=(u+1)/2,T=(f+1)/2,w=(x+1)/2,S=(c+p)/4,R=(h+g)/4,B=(m+y)/4;return _>T&&_>w?_<.01?(n=0,s=.707106781,o=.707106781):(n=Math.sqrt(_),s=S/n,o=R/n):T>w?T<.01?(n=.707106781,s=0,o=.707106781):(s=Math.sqrt(T),n=S/s,o=B/s):w<.01?(n=.707106781,s=.707106781,o=0):(o=Math.sqrt(w),n=R/o,s=B/o),this.set(n,s,o,i),this}let v=Math.sqrt((y-m)*(y-m)+(h-g)*(h-g)+(p-c)*(p-c));return Math.abs(v)<.001&&(v=1),this.x=(y-m)/v,this.y=(h-g)/v,this.z=(p-c)/v,this.w=Math.acos((u+f+x-1)/2),this}setFromMatrixPosition(e){const i=e.elements;return this.x=i[12],this.y=i[13],this.z=i[14],this.w=i[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,i){return this.x=Math.max(e.x,Math.min(i.x,this.x)),this.y=Math.max(e.y,Math.min(i.y,this.y)),this.z=Math.max(e.z,Math.min(i.z,this.z)),this.w=Math.max(e.w,Math.min(i.w,this.w)),this}clampScalar(e,i){return this.x=Math.max(e,Math.min(i,this.x)),this.y=Math.max(e,Math.min(i,this.y)),this.z=Math.max(e,Math.min(i,this.z)),this.w=Math.max(e,Math.min(i,this.w)),this}clampLength(e,i){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(i,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this.z+=(e.z-this.z)*i,this.w+=(e.w-this.w)*i,this}lerpVectors(e,i,n){return this.x=e.x+(i.x-e.x)*n,this.y=e.y+(i.y-e.y)*n,this.z=e.z+(i.z-e.z)*n,this.w=e.w+(i.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this.z=e[i+2],this.w=e[i+3],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e[i+2]=this.z,e[i+3]=this.w,e}fromBufferAttribute(e,i){return this.x=e.getX(i),this.y=e.getY(i),this.z=e.getZ(i),this.w=e.getW(i),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class cg extends ag{constructor(e=1,i=1,n={}){super(),this.isRenderTarget=!0,this.width=e,this.height=i,this.depth=1,this.scissor=new es(0,0,e,i),this.scissorTest=!1,this.viewport=new es(0,0,e,i);const s={width:e,height:i,depth:1};n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:pl,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},n);const o=new So(s,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace);o.flipY=!1,o.generateMipmaps=n.generateMipmaps,o.internalFormat=n.internalFormat,this.textures=[];const l=n.count;for(let u=0;u<l;u++)this.textures[u]=o.clone(),this.textures[u].isRenderTargetTexture=!0;this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this.depthTexture=n.depthTexture,this.samples=n.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,i,n=1){if(this.width!==e||this.height!==i||this.depth!==n){this.width=e,this.height=i,this.depth=n;for(let s=0,o=this.textures.length;s<o;s++)this.textures[s].image.width=e,this.textures[s].image.height=i,this.textures[s].image.depth=n;this.dispose()}this.viewport.set(0,0,e,i),this.scissor.set(0,0,e,i)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let n=0,s=e.textures.length;n<s;n++)this.textures[n]=e.textures[n].clone(),this.textures[n].isRenderTargetTexture=!0;const i=Object.assign({},e.texture.image);return this.texture.source=new y5(i),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class oue extends cg{constructor(e=1,i=1,n={}){super(e,i,n),this.isWebGLRenderTarget=!0}}class lue extends So{constructor(e=null,i=1,n=1,s=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:i,height:n,depth:s},this.magFilter=no,this.minFilter=no,this.wrapR=eg,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class sy{constructor(e=0,i=0,n=0,s=1){this.isQuaternion=!0,this._x=e,this._y=i,this._z=n,this._w=s}static slerpFlat(e,i,n,s,o,l,u){let c=n[s+0],h=n[s+1],p=n[s+2],f=n[s+3];const m=o[l+0],g=o[l+1],y=o[l+2],x=o[l+3];if(u===0){e[i+0]=c,e[i+1]=h,e[i+2]=p,e[i+3]=f;return}if(u===1){e[i+0]=m,e[i+1]=g,e[i+2]=y,e[i+3]=x;return}if(f!==x||c!==m||h!==g||p!==y){let v=1-u;const _=c*m+h*g+p*y+f*x,T=_>=0?1:-1,w=1-_*_;if(w>Number.EPSILON){const R=Math.sqrt(w),B=Math.atan2(R,_*T);v=Math.sin(v*B)/R,u=Math.sin(u*B)/R}const S=u*T;if(c=c*v+m*S,h=h*v+g*S,p=p*v+y*S,f=f*v+x*S,v===1-u){const R=1/Math.sqrt(c*c+h*h+p*p+f*f);c*=R,h*=R,p*=R,f*=R}}e[i]=c,e[i+1]=h,e[i+2]=p,e[i+3]=f}static multiplyQuaternionsFlat(e,i,n,s,o,l){const u=n[s],c=n[s+1],h=n[s+2],p=n[s+3],f=o[l],m=o[l+1],g=o[l+2],y=o[l+3];return e[i]=u*y+p*f+c*g-h*m,e[i+1]=c*y+p*m+h*f-u*g,e[i+2]=h*y+p*g+u*m-c*f,e[i+3]=p*y-u*f-c*m-h*g,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,i,n,s){return this._x=e,this._y=i,this._z=n,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,i=!0){const n=e._x,s=e._y,o=e._z,l=e._order,u=Math.cos,c=Math.sin,h=u(n/2),p=u(s/2),f=u(o/2),m=c(n/2),g=c(s/2),y=c(o/2);switch(l){case"XYZ":this._x=m*p*f+h*g*y,this._y=h*g*f-m*p*y,this._z=h*p*y+m*g*f,this._w=h*p*f-m*g*y;break;case"YXZ":this._x=m*p*f+h*g*y,this._y=h*g*f-m*p*y,this._z=h*p*y-m*g*f,this._w=h*p*f+m*g*y;break;case"ZXY":this._x=m*p*f-h*g*y,this._y=h*g*f+m*p*y,this._z=h*p*y+m*g*f,this._w=h*p*f-m*g*y;break;case"ZYX":this._x=m*p*f-h*g*y,this._y=h*g*f+m*p*y,this._z=h*p*y-m*g*f,this._w=h*p*f+m*g*y;break;case"YZX":this._x=m*p*f+h*g*y,this._y=h*g*f+m*p*y,this._z=h*p*y-m*g*f,this._w=h*p*f-m*g*y;break;case"XZY":this._x=m*p*f-h*g*y,this._y=h*g*f-m*p*y,this._z=h*p*y+m*g*f,this._w=h*p*f+m*g*y;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+l)}return i===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,i){const n=i/2,s=Math.sin(n);return this._x=e.x*s,this._y=e.y*s,this._z=e.z*s,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const i=e.elements,n=i[0],s=i[4],o=i[8],l=i[1],u=i[5],c=i[9],h=i[2],p=i[6],f=i[10],m=n+u+f;if(m>0){const g=.5/Math.sqrt(m+1);this._w=.25/g,this._x=(p-c)*g,this._y=(o-h)*g,this._z=(l-s)*g}else if(n>u&&n>f){const g=2*Math.sqrt(1+n-u-f);this._w=(p-c)/g,this._x=.25*g,this._y=(s+l)/g,this._z=(o+h)/g}else if(u>f){const g=2*Math.sqrt(1+u-n-f);this._w=(o-h)/g,this._x=(s+l)/g,this._y=.25*g,this._z=(c+p)/g}else{const g=2*Math.sqrt(1+f-n-u);this._w=(l-s)/g,this._x=(o+h)/g,this._y=(c+p)/g,this._z=.25*g}return this._onChangeCallback(),this}setFromUnitVectors(e,i){let n=e.dot(i)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*i.z-e.z*i.y,this._y=e.z*i.x-e.x*i.z,this._z=e.x*i.y-e.y*i.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Va(this.dot(e),-1,1)))}rotateTowards(e,i){const n=this.angleTo(e);if(n===0)return this;const s=Math.min(1,i/n);return this.slerp(e,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,i){const n=e._x,s=e._y,o=e._z,l=e._w,u=i._x,c=i._y,h=i._z,p=i._w;return this._x=n*p+l*u+s*h-o*c,this._y=s*p+l*c+o*u-n*h,this._z=o*p+l*h+n*c-s*u,this._w=l*p-n*u-s*c-o*h,this._onChangeCallback(),this}slerp(e,i){if(i===0)return this;if(i===1)return this.copy(e);const n=this._x,s=this._y,o=this._z,l=this._w;let u=l*e._w+n*e._x+s*e._y+o*e._z;if(u<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,u=-u):this.copy(e),u>=1)return this._w=l,this._x=n,this._y=s,this._z=o,this;const c=1-u*u;if(c<=Number.EPSILON){const g=1-i;return this._w=g*l+i*this._w,this._x=g*n+i*this._x,this._y=g*s+i*this._y,this._z=g*o+i*this._z,this.normalize(),this}const h=Math.sqrt(c),p=Math.atan2(h,u),f=Math.sin((1-i)*p)/h,m=Math.sin(i*p)/h;return this._w=l*f+this._w*m,this._x=n*f+this._x*m,this._y=s*f+this._y*m,this._z=o*f+this._z*m,this._onChangeCallback(),this}slerpQuaternions(e,i,n){return this.copy(e).slerp(i,n)}random(){const e=2*Math.PI*Math.random(),i=2*Math.PI*Math.random(),n=Math.random(),s=Math.sqrt(1-n),o=Math.sqrt(n);return this.set(s*Math.sin(e),s*Math.cos(e),o*Math.sin(i),o*Math.cos(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,i=0){return this._x=e[i],this._y=e[i+1],this._z=e[i+2],this._w=e[i+3],this._onChangeCallback(),this}toArray(e=[],i=0){return e[i]=this._x,e[i+1]=this._y,e[i+2]=this._z,e[i+3]=this._w,e}fromBufferAttribute(e,i){return this._x=e.getX(i),this._y=e.getY(i),this._z=e.getZ(i),this._w=e.getW(i),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Rt{constructor(e=0,i=0,n=0){Rt.prototype.isVector3=!0,this.x=e,this.y=i,this.z=n}set(e,i,n){return n===void 0&&(n=this.z),this.x=e,this.y=i,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this.z=e.z+i.z,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this.z+=e.z*i,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this.z=e.z-i.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,i){return this.x=e.x*i.x,this.y=e.y*i.y,this.z=e.z*i.z,this}applyEuler(e){return this.applyQuaternion(v5.setFromEuler(e))}applyAxisAngle(e,i){return this.applyQuaternion(v5.setFromAxisAngle(e,i))}applyMatrix3(e){const i=this.x,n=this.y,s=this.z,o=e.elements;return this.x=o[0]*i+o[3]*n+o[6]*s,this.y=o[1]*i+o[4]*n+o[7]*s,this.z=o[2]*i+o[5]*n+o[8]*s,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const i=this.x,n=this.y,s=this.z,o=e.elements,l=1/(o[3]*i+o[7]*n+o[11]*s+o[15]);return this.x=(o[0]*i+o[4]*n+o[8]*s+o[12])*l,this.y=(o[1]*i+o[5]*n+o[9]*s+o[13])*l,this.z=(o[2]*i+o[6]*n+o[10]*s+o[14])*l,this}applyQuaternion(e){const i=this.x,n=this.y,s=this.z,o=e.x,l=e.y,u=e.z,c=e.w,h=2*(l*s-u*n),p=2*(u*i-o*s),f=2*(o*n-l*i);return this.x=i+c*h+l*f-u*p,this.y=n+c*p+u*h-o*f,this.z=s+c*f+o*p-l*h,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const i=this.x,n=this.y,s=this.z,o=e.elements;return this.x=o[0]*i+o[4]*n+o[8]*s,this.y=o[1]*i+o[5]*n+o[9]*s,this.z=o[2]*i+o[6]*n+o[10]*s,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,i){return this.x=Math.max(e.x,Math.min(i.x,this.x)),this.y=Math.max(e.y,Math.min(i.y,this.y)),this.z=Math.max(e.z,Math.min(i.z,this.z)),this}clampScalar(e,i){return this.x=Math.max(e,Math.min(i,this.x)),this.y=Math.max(e,Math.min(i,this.y)),this.z=Math.max(e,Math.min(i,this.z)),this}clampLength(e,i){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(i,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this.z+=(e.z-this.z)*i,this}lerpVectors(e,i,n){return this.x=e.x+(i.x-e.x)*n,this.y=e.y+(i.y-e.y)*n,this.z=e.z+(i.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,i){const n=e.x,s=e.y,o=e.z,l=i.x,u=i.y,c=i.z;return this.x=s*c-o*u,this.y=o*l-n*c,this.z=n*u-s*l,this}projectOnVector(e){const i=e.lengthSq();if(i===0)return this.set(0,0,0);const n=e.dot(this)/i;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return ZM.copy(this).projectOnVector(e),this.sub(ZM)}reflect(e){return this.sub(ZM.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const i=Math.sqrt(this.lengthSq()*e.lengthSq());if(i===0)return Math.PI/2;const n=this.dot(e)/i;return Math.acos(Va(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const i=this.x-e.x,n=this.y-e.y,s=this.z-e.z;return i*i+n*n+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,i,n){const s=Math.sin(i)*e;return this.x=s*Math.sin(n),this.y=Math.cos(i)*e,this.z=s*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,i,n){return this.x=e*Math.sin(i),this.y=n,this.z=e*Math.cos(i),this}setFromMatrixPosition(e){const i=e.elements;return this.x=i[12],this.y=i[13],this.z=i[14],this}setFromMatrixScale(e){const i=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),s=this.setFromMatrixColumn(e,2).length();return this.x=i,this.y=n,this.z=s,this}setFromMatrixColumn(e,i){return this.fromArray(e.elements,i*4)}setFromMatrix3Column(e,i){return this.fromArray(e.elements,i*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this.z=e[i+2],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e[i+2]=this.z,e}fromBufferAttribute(e,i){return this.x=e.getX(i),this.y=e.getY(i),this.z=e.getZ(i),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,i=Math.random()*2-1,n=Math.sqrt(1-i*i);return this.x=n*Math.cos(e),this.y=i,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const ZM=new Rt,v5=new sy;class ay{constructor(e=new Rt(1/0,1/0,1/0),i=new Rt(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=i}set(e,i){return this.min.copy(e),this.max.copy(i),this}setFromArray(e){this.makeEmpty();for(let i=0,n=e.length;i<n;i+=3)this.expandByPoint(mc.fromArray(e,i));return this}setFromBufferAttribute(e){this.makeEmpty();for(let i=0,n=e.count;i<n;i++)this.expandByPoint(mc.fromBufferAttribute(e,i));return this}setFromPoints(e){this.makeEmpty();for(let i=0,n=e.length;i<n;i++)this.expandByPoint(e[i]);return this}setFromCenterAndSize(e,i){const n=mc.copy(i).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,i=!1){return this.makeEmpty(),this.expandByObject(e,i)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,i=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0){const o=n.getAttribute("position");if(i===!0&&o!==void 0&&e.isInstancedMesh!==!0)for(let l=0,u=o.count;l<u;l++)e.isMesh===!0?e.getVertexPosition(l,mc):mc.fromBufferAttribute(o,l),mc.applyMatrix4(e.matrixWorld),this.expandByPoint(mc);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),B1.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),B1.copy(n.boundingBox)),B1.applyMatrix4(e.matrixWorld),this.union(B1)}const s=e.children;for(let o=0,l=s.length;o<l;o++)this.expandByObject(s[o],i);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,i){return i.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,mc),mc.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let i,n;return e.normal.x>0?(i=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(i=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(i+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(i+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(i+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(i+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),i<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(oy),N1.subVectors(this.max,oy),ug.subVectors(e.a,oy),hg.subVectors(e.b,oy),dg.subVectors(e.c,oy),ud.subVectors(hg,ug),hd.subVectors(dg,hg),Dp.subVectors(ug,dg);let i=[0,-ud.z,ud.y,0,-hd.z,hd.y,0,-Dp.z,Dp.y,ud.z,0,-ud.x,hd.z,0,-hd.x,Dp.z,0,-Dp.x,-ud.y,ud.x,0,-hd.y,hd.x,0,-Dp.y,Dp.x,0];return!$M(i,ug,hg,dg,N1)||(i=[1,0,0,0,1,0,0,0,1],!$M(i,ug,hg,dg,N1))?!1:(L1.crossVectors(ud,hd),i=[L1.x,L1.y,L1.z],$M(i,ug,hg,dg,N1))}clampPoint(e,i){return i.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,mc).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(mc).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Gu[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Gu[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Gu[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Gu[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Gu[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Gu[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Gu[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Gu[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Gu),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Gu=[new Rt,new Rt,new Rt,new Rt,new Rt,new Rt,new Rt,new Rt],mc=new Rt,B1=new ay,ug=new Rt,hg=new Rt,dg=new Rt,ud=new Rt,hd=new Rt,Dp=new Rt,oy=new Rt,N1=new Rt,L1=new Rt,Op=new Rt;function $M(r,e,i,n,s){for(let o=0,l=r.length-3;o<=l;o+=3){Op.fromArray(r,o);const u=s.x*Math.abs(Op.x)+s.y*Math.abs(Op.y)+s.z*Math.abs(Op.z),c=e.dot(Op),h=i.dot(Op),p=n.dot(Op);if(Math.max(-Math.max(c,h,p),Math.min(c,h,p))>u)return!1}return!0}const cue=new ay,ly=new Rt,e3=new Rt;class t3{constructor(e=new Rt,i=-1){this.isSphere=!0,this.center=e,this.radius=i}set(e,i){return this.center.copy(e),this.radius=i,this}setFromPoints(e,i){const n=this.center;i!==void 0?n.copy(i):cue.setFromPoints(e).getCenter(n);let s=0;for(let o=0,l=e.length;o<l;o++)s=Math.max(s,n.distanceToSquared(e[o]));return this.radius=Math.sqrt(s),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const i=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=i*i}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,i){const n=this.center.distanceToSquared(e);return i.copy(e),n>this.radius*this.radius&&(i.sub(this.center).normalize(),i.multiplyScalar(this.radius).add(this.center)),i}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;ly.subVectors(e,this.center);const i=ly.lengthSq();if(i>this.radius*this.radius){const n=Math.sqrt(i),s=(n-this.radius)*.5;this.center.addScaledVector(ly,s/n),this.radius+=s}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(e3.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(ly.copy(e.center).add(e3)),this.expandByPoint(ly.copy(e.center).sub(e3))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Hu=new Rt,i3=new Rt,D1=new Rt,dd=new Rt,r3=new Rt,O1=new Rt,n3=new Rt;class uue{constructor(e=new Rt,i=new Rt(0,0,-1)){this.origin=e,this.direction=i}set(e,i){return this.origin.copy(e),this.direction.copy(i),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,i){return i.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Hu)),this}closestPointToPoint(e,i){i.subVectors(e,this.origin);const n=i.dot(this.direction);return n<0?i.copy(this.origin):i.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const i=Hu.subVectors(e,this.origin).dot(this.direction);return i<0?this.origin.distanceToSquared(e):(Hu.copy(this.origin).addScaledVector(this.direction,i),Hu.distanceToSquared(e))}distanceSqToSegment(e,i,n,s){i3.copy(e).add(i).multiplyScalar(.5),D1.copy(i).sub(e).normalize(),dd.copy(this.origin).sub(i3);const o=e.distanceTo(i)*.5,l=-this.direction.dot(D1),u=dd.dot(this.direction),c=-dd.dot(D1),h=dd.lengthSq(),p=Math.abs(1-l*l);let f,m,g,y;if(p>0)if(f=l*c-u,m=l*u-c,y=o*p,f>=0)if(m>=-y)if(m<=y){const x=1/p;f*=x,m*=x,g=f*(f+l*m+2*u)+m*(l*f+m+2*c)+h}else m=o,f=Math.max(0,-(l*m+u)),g=-f*f+m*(m+2*c)+h;else m=-o,f=Math.max(0,-(l*m+u)),g=-f*f+m*(m+2*c)+h;else m<=-y?(f=Math.max(0,-(-l*o+u)),m=f>0?-o:Math.min(Math.max(-o,-c),o),g=-f*f+m*(m+2*c)+h):m<=y?(f=0,m=Math.min(Math.max(-o,-c),o),g=m*(m+2*c)+h):(f=Math.max(0,-(l*o+u)),m=f>0?o:Math.min(Math.max(-o,-c),o),g=-f*f+m*(m+2*c)+h);else m=l>0?-o:o,f=Math.max(0,-(l*m+u)),g=-f*f+m*(m+2*c)+h;return n&&n.copy(this.origin).addScaledVector(this.direction,f),s&&s.copy(i3).addScaledVector(D1,m),g}intersectSphere(e,i){Hu.subVectors(e.center,this.origin);const n=Hu.dot(this.direction),s=Hu.dot(Hu)-n*n,o=e.radius*e.radius;if(s>o)return null;const l=Math.sqrt(o-s),u=n-l,c=n+l;return c<0?null:u<0?this.at(c,i):this.at(u,i)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const i=e.normal.dot(this.direction);if(i===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/i;return n>=0?n:null}intersectPlane(e,i){const n=this.distanceToPlane(e);return n===null?null:this.at(n,i)}intersectsPlane(e){const i=e.distanceToPoint(this.origin);return i===0||e.normal.dot(this.direction)*i<0}intersectBox(e,i){let n,s,o,l,u,c;const h=1/this.direction.x,p=1/this.direction.y,f=1/this.direction.z,m=this.origin;return h>=0?(n=(e.min.x-m.x)*h,s=(e.max.x-m.x)*h):(n=(e.max.x-m.x)*h,s=(e.min.x-m.x)*h),p>=0?(o=(e.min.y-m.y)*p,l=(e.max.y-m.y)*p):(o=(e.max.y-m.y)*p,l=(e.min.y-m.y)*p),n>l||o>s||((o>n||isNaN(n))&&(n=o),(l<s||isNaN(s))&&(s=l),f>=0?(u=(e.min.z-m.z)*f,c=(e.max.z-m.z)*f):(u=(e.max.z-m.z)*f,c=(e.min.z-m.z)*f),n>c||u>s)||((u>n||n!==n)&&(n=u),(c<s||s!==s)&&(s=c),s<0)?null:this.at(n>=0?n:s,i)}intersectsBox(e){return this.intersectBox(e,Hu)!==null}intersectTriangle(e,i,n,s,o){r3.subVectors(i,e),O1.subVectors(n,e),n3.crossVectors(r3,O1);let l=this.direction.dot(n3),u;if(l>0){if(s)return null;u=1}else if(l<0)u=-1,l=-l;else return null;dd.subVectors(this.origin,e);const c=u*this.direction.dot(O1.crossVectors(dd,O1));if(c<0)return null;const h=u*this.direction.dot(r3.cross(dd));if(h<0||c+h>l)return null;const p=-u*dd.dot(n3);return p<0?null:this.at(p/l,o)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Cs{constructor(e,i,n,s,o,l,u,c,h,p,f,m,g,y,x,v){Cs.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,i,n,s,o,l,u,c,h,p,f,m,g,y,x,v)}set(e,i,n,s,o,l,u,c,h,p,f,m,g,y,x,v){const _=this.elements;return _[0]=e,_[4]=i,_[8]=n,_[12]=s,_[1]=o,_[5]=l,_[9]=u,_[13]=c,_[2]=h,_[6]=p,_[10]=f,_[14]=m,_[3]=g,_[7]=y,_[11]=x,_[15]=v,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Cs().fromArray(this.elements)}copy(e){const i=this.elements,n=e.elements;return i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],this}copyPosition(e){const i=this.elements,n=e.elements;return i[12]=n[12],i[13]=n[13],i[14]=n[14],this}setFromMatrix3(e){const i=e.elements;return this.set(i[0],i[3],i[6],0,i[1],i[4],i[7],0,i[2],i[5],i[8],0,0,0,0,1),this}extractBasis(e,i,n){return e.setFromMatrixColumn(this,0),i.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,i,n){return this.set(e.x,i.x,n.x,0,e.y,i.y,n.y,0,e.z,i.z,n.z,0,0,0,0,1),this}extractRotation(e){const i=this.elements,n=e.elements,s=1/pg.setFromMatrixColumn(e,0).length(),o=1/pg.setFromMatrixColumn(e,1).length(),l=1/pg.setFromMatrixColumn(e,2).length();return i[0]=n[0]*s,i[1]=n[1]*s,i[2]=n[2]*s,i[3]=0,i[4]=n[4]*o,i[5]=n[5]*o,i[6]=n[6]*o,i[7]=0,i[8]=n[8]*l,i[9]=n[9]*l,i[10]=n[10]*l,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromEuler(e){const i=this.elements,n=e.x,s=e.y,o=e.z,l=Math.cos(n),u=Math.sin(n),c=Math.cos(s),h=Math.sin(s),p=Math.cos(o),f=Math.sin(o);if(e.order==="XYZ"){const m=l*p,g=l*f,y=u*p,x=u*f;i[0]=c*p,i[4]=-c*f,i[8]=h,i[1]=g+y*h,i[5]=m-x*h,i[9]=-u*c,i[2]=x-m*h,i[6]=y+g*h,i[10]=l*c}else if(e.order==="YXZ"){const m=c*p,g=c*f,y=h*p,x=h*f;i[0]=m+x*u,i[4]=y*u-g,i[8]=l*h,i[1]=l*f,i[5]=l*p,i[9]=-u,i[2]=g*u-y,i[6]=x+m*u,i[10]=l*c}else if(e.order==="ZXY"){const m=c*p,g=c*f,y=h*p,x=h*f;i[0]=m-x*u,i[4]=-l*f,i[8]=y+g*u,i[1]=g+y*u,i[5]=l*p,i[9]=x-m*u,i[2]=-l*h,i[6]=u,i[10]=l*c}else if(e.order==="ZYX"){const m=l*p,g=l*f,y=u*p,x=u*f;i[0]=c*p,i[4]=y*h-g,i[8]=m*h+x,i[1]=c*f,i[5]=x*h+m,i[9]=g*h-y,i[2]=-h,i[6]=u*c,i[10]=l*c}else if(e.order==="YZX"){const m=l*c,g=l*h,y=u*c,x=u*h;i[0]=c*p,i[4]=x-m*f,i[8]=y*f+g,i[1]=f,i[5]=l*p,i[9]=-u*p,i[2]=-h*p,i[6]=g*f+y,i[10]=m-x*f}else if(e.order==="XZY"){const m=l*c,g=l*h,y=u*c,x=u*h;i[0]=c*p,i[4]=-f,i[8]=h*p,i[1]=m*f+x,i[5]=l*p,i[9]=g*f-y,i[2]=y*f-g,i[6]=u*p,i[10]=x*f+m}return i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromQuaternion(e){return this.compose(hue,e,due)}lookAt(e,i,n){const s=this.elements;return ml.subVectors(e,i),ml.lengthSq()===0&&(ml.z=1),ml.normalize(),pd.crossVectors(n,ml),pd.lengthSq()===0&&(Math.abs(n.z)===1?ml.x+=1e-4:ml.z+=1e-4,ml.normalize(),pd.crossVectors(n,ml)),pd.normalize(),P1.crossVectors(ml,pd),s[0]=pd.x,s[4]=P1.x,s[8]=ml.x,s[1]=pd.y,s[5]=P1.y,s[9]=ml.y,s[2]=pd.z,s[6]=P1.z,s[10]=ml.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,i){const n=e.elements,s=i.elements,o=this.elements,l=n[0],u=n[4],c=n[8],h=n[12],p=n[1],f=n[5],m=n[9],g=n[13],y=n[2],x=n[6],v=n[10],_=n[14],T=n[3],w=n[7],S=n[11],R=n[15],B=s[0],I=s[4],D=s[8],L=s[12],O=s[1],U=s[5],Z=s[9],G=s[13],z=s[2],$=s[6],Q=s[10],H=s[14],V=s[3],ne=s[7],Y=s[11],ae=s[15];return o[0]=l*B+u*O+c*z+h*V,o[4]=l*I+u*U+c*$+h*ne,o[8]=l*D+u*Z+c*Q+h*Y,o[12]=l*L+u*G+c*H+h*ae,o[1]=p*B+f*O+m*z+g*V,o[5]=p*I+f*U+m*$+g*ne,o[9]=p*D+f*Z+m*Q+g*Y,o[13]=p*L+f*G+m*H+g*ae,o[2]=y*B+x*O+v*z+_*V,o[6]=y*I+x*U+v*$+_*ne,o[10]=y*D+x*Z+v*Q+_*Y,o[14]=y*L+x*G+v*H+_*ae,o[3]=T*B+w*O+S*z+R*V,o[7]=T*I+w*U+S*$+R*ne,o[11]=T*D+w*Z+S*Q+R*Y,o[15]=T*L+w*G+S*H+R*ae,this}multiplyScalar(e){const i=this.elements;return i[0]*=e,i[4]*=e,i[8]*=e,i[12]*=e,i[1]*=e,i[5]*=e,i[9]*=e,i[13]*=e,i[2]*=e,i[6]*=e,i[10]*=e,i[14]*=e,i[3]*=e,i[7]*=e,i[11]*=e,i[15]*=e,this}determinant(){const e=this.elements,i=e[0],n=e[4],s=e[8],o=e[12],l=e[1],u=e[5],c=e[9],h=e[13],p=e[2],f=e[6],m=e[10],g=e[14],y=e[3],x=e[7],v=e[11],_=e[15];return y*(+o*c*f-s*h*f-o*u*m+n*h*m+s*u*g-n*c*g)+x*(+i*c*g-i*h*m+o*l*m-s*l*g+s*h*p-o*c*p)+v*(+i*h*f-i*u*g-o*l*f+n*l*g+o*u*p-n*h*p)+_*(-s*u*p-i*c*f+i*u*m+s*l*f-n*l*m+n*c*p)}transpose(){const e=this.elements;let i;return i=e[1],e[1]=e[4],e[4]=i,i=e[2],e[2]=e[8],e[8]=i,i=e[6],e[6]=e[9],e[9]=i,i=e[3],e[3]=e[12],e[12]=i,i=e[7],e[7]=e[13],e[13]=i,i=e[11],e[11]=e[14],e[14]=i,this}setPosition(e,i,n){const s=this.elements;return e.isVector3?(s[12]=e.x,s[13]=e.y,s[14]=e.z):(s[12]=e,s[13]=i,s[14]=n),this}invert(){const e=this.elements,i=e[0],n=e[1],s=e[2],o=e[3],l=e[4],u=e[5],c=e[6],h=e[7],p=e[8],f=e[9],m=e[10],g=e[11],y=e[12],x=e[13],v=e[14],_=e[15],T=f*v*h-x*m*h+x*c*g-u*v*g-f*c*_+u*m*_,w=y*m*h-p*v*h-y*c*g+l*v*g+p*c*_-l*m*_,S=p*x*h-y*f*h+y*u*g-l*x*g-p*u*_+l*f*_,R=y*f*c-p*x*c-y*u*m+l*x*m+p*u*v-l*f*v,B=i*T+n*w+s*S+o*R;if(B===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const I=1/B;return e[0]=T*I,e[1]=(x*m*o-f*v*o-x*s*g+n*v*g+f*s*_-n*m*_)*I,e[2]=(u*v*o-x*c*o+x*s*h-n*v*h-u*s*_+n*c*_)*I,e[3]=(f*c*o-u*m*o-f*s*h+n*m*h+u*s*g-n*c*g)*I,e[4]=w*I,e[5]=(p*v*o-y*m*o+y*s*g-i*v*g-p*s*_+i*m*_)*I,e[6]=(y*c*o-l*v*o-y*s*h+i*v*h+l*s*_-i*c*_)*I,e[7]=(l*m*o-p*c*o+p*s*h-i*m*h-l*s*g+i*c*g)*I,e[8]=S*I,e[9]=(y*f*o-p*x*o-y*n*g+i*x*g+p*n*_-i*f*_)*I,e[10]=(l*x*o-y*u*o+y*n*h-i*x*h-l*n*_+i*u*_)*I,e[11]=(p*u*o-l*f*o-p*n*h+i*f*h+l*n*g-i*u*g)*I,e[12]=R*I,e[13]=(p*x*s-y*f*s+y*n*m-i*x*m-p*n*v+i*f*v)*I,e[14]=(y*u*s-l*x*s-y*n*c+i*x*c+l*n*v-i*u*v)*I,e[15]=(l*f*s-p*u*s+p*n*c-i*f*c-l*n*m+i*u*m)*I,this}scale(e){const i=this.elements,n=e.x,s=e.y,o=e.z;return i[0]*=n,i[4]*=s,i[8]*=o,i[1]*=n,i[5]*=s,i[9]*=o,i[2]*=n,i[6]*=s,i[10]*=o,i[3]*=n,i[7]*=s,i[11]*=o,this}getMaxScaleOnAxis(){const e=this.elements,i=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],s=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(i,n,s))}makeTranslation(e,i,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,i,0,0,1,n,0,0,0,1),this}makeRotationX(e){const i=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,i,-n,0,0,n,i,0,0,0,0,1),this}makeRotationY(e){const i=Math.cos(e),n=Math.sin(e);return this.set(i,0,n,0,0,1,0,0,-n,0,i,0,0,0,0,1),this}makeRotationZ(e){const i=Math.cos(e),n=Math.sin(e);return this.set(i,-n,0,0,n,i,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,i){const n=Math.cos(i),s=Math.sin(i),o=1-n,l=e.x,u=e.y,c=e.z,h=o*l,p=o*u;return this.set(h*l+n,h*u-s*c,h*c+s*u,0,h*u+s*c,p*u+n,p*c-s*l,0,h*c-s*u,p*c+s*l,o*c*c+n,0,0,0,0,1),this}makeScale(e,i,n){return this.set(e,0,0,0,0,i,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,i,n,s,o,l){return this.set(1,n,o,0,e,1,l,0,i,s,1,0,0,0,0,1),this}compose(e,i,n){const s=this.elements,o=i._x,l=i._y,u=i._z,c=i._w,h=o+o,p=l+l,f=u+u,m=o*h,g=o*p,y=o*f,x=l*p,v=l*f,_=u*f,T=c*h,w=c*p,S=c*f,R=n.x,B=n.y,I=n.z;return s[0]=(1-(x+_))*R,s[1]=(g+S)*R,s[2]=(y-w)*R,s[3]=0,s[4]=(g-S)*B,s[5]=(1-(m+_))*B,s[6]=(v+T)*B,s[7]=0,s[8]=(y+w)*I,s[9]=(v-T)*I,s[10]=(1-(m+x))*I,s[11]=0,s[12]=e.x,s[13]=e.y,s[14]=e.z,s[15]=1,this}decompose(e,i,n){const s=this.elements;let o=pg.set(s[0],s[1],s[2]).length();const l=pg.set(s[4],s[5],s[6]).length(),u=pg.set(s[8],s[9],s[10]).length();this.determinant()<0&&(o=-o),e.x=s[12],e.y=s[13],e.z=s[14],gc.copy(this);const c=1/o,h=1/l,p=1/u;return gc.elements[0]*=c,gc.elements[1]*=c,gc.elements[2]*=c,gc.elements[4]*=h,gc.elements[5]*=h,gc.elements[6]*=h,gc.elements[8]*=p,gc.elements[9]*=p,gc.elements[10]*=p,i.setFromRotationMatrix(gc),n.x=o,n.y=l,n.z=u,this}makePerspective(e,i,n,s,o,l,u=fc){const c=this.elements,h=2*o/(i-e),p=2*o/(n-s),f=(i+e)/(i-e),m=(n+s)/(n-s);let g,y;if(u===fc)g=-(l+o)/(l-o),y=-2*l*o/(l-o);else if(u===Lp)g=-l/(l-o),y=-l*o/(l-o);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+u);return c[0]=h,c[4]=0,c[8]=f,c[12]=0,c[1]=0,c[5]=p,c[9]=m,c[13]=0,c[2]=0,c[6]=0,c[10]=g,c[14]=y,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}makeOrthographic(e,i,n,s,o,l,u=fc){const c=this.elements,h=1/(i-e),p=1/(n-s),f=1/(l-o),m=(i+e)*h,g=(n+s)*p;let y,x;if(u===fc)y=(l+o)*f,x=-2*f;else if(u===Lp)y=o*f,x=-1*f;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+u);return c[0]=2*h,c[4]=0,c[8]=0,c[12]=-m,c[1]=0,c[5]=2*p,c[9]=0,c[13]=-g,c[2]=0,c[6]=0,c[10]=x,c[14]=-y,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}equals(e){const i=this.elements,n=e.elements;for(let s=0;s<16;s++)if(i[s]!==n[s])return!1;return!0}fromArray(e,i=0){for(let n=0;n<16;n++)this.elements[n]=e[n+i];return this}toArray(e=[],i=0){const n=this.elements;return e[i]=n[0],e[i+1]=n[1],e[i+2]=n[2],e[i+3]=n[3],e[i+4]=n[4],e[i+5]=n[5],e[i+6]=n[6],e[i+7]=n[7],e[i+8]=n[8],e[i+9]=n[9],e[i+10]=n[10],e[i+11]=n[11],e[i+12]=n[12],e[i+13]=n[13],e[i+14]=n[14],e[i+15]=n[15],e}}const pg=new Rt,gc=new Cs,hue=new Rt(0,0,0),due=new Rt(1,1,1),pd=new Rt,P1=new Rt,ml=new Rt,x5=new Cs,b5=new sy;class Ac{constructor(e=0,i=0,n=0,s=Ac.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=i,this._z=n,this._order=s}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,i,n,s=this._order){return this._x=e,this._y=i,this._z=n,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,i=this._order,n=!0){const s=e.elements,o=s[0],l=s[4],u=s[8],c=s[1],h=s[5],p=s[9],f=s[2],m=s[6],g=s[10];switch(i){case"XYZ":this._y=Math.asin(Va(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-p,g),this._z=Math.atan2(-l,o)):(this._x=Math.atan2(m,h),this._z=0);break;case"YXZ":this._x=Math.asin(-Va(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(u,g),this._z=Math.atan2(c,h)):(this._y=Math.atan2(-f,o),this._z=0);break;case"ZXY":this._x=Math.asin(Va(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(-f,g),this._z=Math.atan2(-l,h)):(this._y=0,this._z=Math.atan2(c,o));break;case"ZYX":this._y=Math.asin(-Va(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(m,g),this._z=Math.atan2(c,o)):(this._x=0,this._z=Math.atan2(-l,h));break;case"YZX":this._z=Math.asin(Va(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-p,h),this._y=Math.atan2(-f,o)):(this._x=0,this._y=Math.atan2(u,g));break;case"XZY":this._z=Math.asin(-Va(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(m,h),this._y=Math.atan2(u,o)):(this._x=Math.atan2(-p,g),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,i,n){return x5.makeRotationFromQuaternion(e),this.setFromRotationMatrix(x5,i,n)}setFromVector3(e,i=this._order){return this.set(e.x,e.y,e.z,i)}reorder(e){return b5.setFromEuler(this),this.setFromQuaternion(b5,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],i=0){return e[i]=this._x,e[i+1]=this._y,e[i+2]=this._z,e[i+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Ac.DEFAULT_ORDER="XYZ";class pue{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let fue=0;const _5=new Rt,fg=new sy,Wu=new Cs,k1=new Rt,cy=new Rt,mue=new Rt,gue=new sy,E5=new Rt(1,0,0),w5=new Rt(0,1,0),C5=new Rt(0,0,1),S5={type:"added"},Aue={type:"removed"},mg={type:"childadded",child:null},s3={type:"childremoved",child:null};class Ra extends ag{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:fue++}),this.uuid=ju(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Ra.DEFAULT_UP.clone();const e=new Rt,i=new Ac,n=new sy,s=new Rt(1,1,1);function o(){n.setFromEuler(i,!1)}function l(){i.setFromQuaternion(n,void 0,!1)}i._onChange(o),n._onChange(l),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new Cs},normalMatrix:{value:new qo}}),this.matrix=new Cs,this.matrixWorld=new Cs,this.matrixAutoUpdate=Ra.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Ra.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new pue,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,i){this.quaternion.setFromAxisAngle(e,i)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,i){return fg.setFromAxisAngle(e,i),this.quaternion.multiply(fg),this}rotateOnWorldAxis(e,i){return fg.setFromAxisAngle(e,i),this.quaternion.premultiply(fg),this}rotateX(e){return this.rotateOnAxis(E5,e)}rotateY(e){return this.rotateOnAxis(w5,e)}rotateZ(e){return this.rotateOnAxis(C5,e)}translateOnAxis(e,i){return _5.copy(e).applyQuaternion(this.quaternion),this.position.add(_5.multiplyScalar(i)),this}translateX(e){return this.translateOnAxis(E5,e)}translateY(e){return this.translateOnAxis(w5,e)}translateZ(e){return this.translateOnAxis(C5,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Wu.copy(this.matrixWorld).invert())}lookAt(e,i,n){e.isVector3?k1.copy(e):k1.set(e,i,n);const s=this.parent;this.updateWorldMatrix(!0,!1),cy.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Wu.lookAt(cy,k1,this.up):Wu.lookAt(k1,cy,this.up),this.quaternion.setFromRotationMatrix(Wu),s&&(Wu.extractRotation(s.matrixWorld),fg.setFromRotationMatrix(Wu),this.quaternion.premultiply(fg.invert()))}add(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(S5),mg.child=e,this.dispatchEvent(mg),mg.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const i=this.children.indexOf(e);return i!==-1&&(e.parent=null,this.children.splice(i,1),e.dispatchEvent(Aue),s3.child=e,this.dispatchEvent(s3),s3.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Wu.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Wu.multiply(e.parent.matrixWorld)),e.applyMatrix4(Wu),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(S5),mg.child=e,this.dispatchEvent(mg),mg.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,i){if(this[e]===i)return this;for(let n=0,s=this.children.length;n<s;n++){const o=this.children[n].getObjectByProperty(e,i);if(o!==void 0)return o}}getObjectsByProperty(e,i,n=[]){this[e]===i&&n.push(this);const s=this.children;for(let o=0,l=s.length;o<l;o++)s[o].getObjectsByProperty(e,i,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(cy,e,mue),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(cy,gue,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return e.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(e){e(this);const i=this.children;for(let n=0,s=i.length;n<s;n++)i[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const i=this.children;for(let n=0,s=i.length;n<s;n++)i[n].traverseVisible(e)}traverseAncestors(e){const i=this.parent;i!==null&&(e(i),i.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const i=this.children;for(let n=0,s=i.length;n<s;n++)i[n].updateMatrixWorld(e)}updateWorldMatrix(e,i){const n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),i===!0){const s=this.children;for(let o=0,l=s.length;o<l;o++)s[o].updateWorldMatrix(!1,!0)}}toJSON(e){const i=e===void 0||typeof e=="string",n={};i&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const s={};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.castShadow===!0&&(s.castShadow=!0),this.receiveShadow===!0&&(s.receiveShadow=!0),this.visible===!1&&(s.visible=!1),this.frustumCulled===!1&&(s.frustumCulled=!1),this.renderOrder!==0&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(s.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(s.type="BatchedMesh",s.perObjectFrustumCulled=this.perObjectFrustumCulled,s.sortObjects=this.sortObjects,s.drawRanges=this._drawRanges,s.reservedRanges=this._reservedRanges,s.visibility=this._visibility,s.active=this._active,s.bounds=this._bounds.map(u=>({boxInitialized:u.boxInitialized,boxMin:u.box.min.toArray(),boxMax:u.box.max.toArray(),sphereInitialized:u.sphereInitialized,sphereRadius:u.sphere.radius,sphereCenter:u.sphere.center.toArray()})),s.maxInstanceCount=this._maxInstanceCount,s.maxVertexCount=this._maxVertexCount,s.maxIndexCount=this._maxIndexCount,s.geometryInitialized=this._geometryInitialized,s.geometryCount=this._geometryCount,s.matricesTexture=this._matricesTexture.toJSON(e),this._colorsTexture!==null&&(s.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(s.boundingSphere={center:s.boundingSphere.center.toArray(),radius:s.boundingSphere.radius}),this.boundingBox!==null&&(s.boundingBox={min:s.boundingBox.min.toArray(),max:s.boundingBox.max.toArray()}));function o(u,c){return u[c.uuid]===void 0&&(u[c.uuid]=c.toJSON(e)),c.uuid}if(this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(s.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(e.geometries,this.geometry);const u=this.geometry.parameters;if(u!==void 0&&u.shapes!==void 0){const c=u.shapes;if(Array.isArray(c))for(let h=0,p=c.length;h<p;h++){const f=c[h];o(e.shapes,f)}else o(e.shapes,c)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(o(e.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const u=[];for(let c=0,h=this.material.length;c<h;c++)u.push(o(e.materials,this.material[c]));s.material=u}else s.material=o(e.materials,this.material);if(this.children.length>0){s.children=[];for(let u=0;u<this.children.length;u++)s.children.push(this.children[u].toJSON(e).object)}if(this.animations.length>0){s.animations=[];for(let u=0;u<this.animations.length;u++){const c=this.animations[u];s.animations.push(o(e.animations,c))}}if(i){const u=l(e.geometries),c=l(e.materials),h=l(e.textures),p=l(e.images),f=l(e.shapes),m=l(e.skeletons),g=l(e.animations),y=l(e.nodes);u.length>0&&(n.geometries=u),c.length>0&&(n.materials=c),h.length>0&&(n.textures=h),p.length>0&&(n.images=p),f.length>0&&(n.shapes=f),m.length>0&&(n.skeletons=m),g.length>0&&(n.animations=g),y.length>0&&(n.nodes=y)}return n.object=s,n;function l(u){const c=[];for(const h in u){const p=u[h];delete p.metadata,c.push(p)}return c}}clone(e){return new this.constructor().copy(this,e)}copy(e,i=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),i===!0)for(let n=0;n<e.children.length;n++){const s=e.children[n];this.add(s.clone())}return this}}Ra.DEFAULT_UP=new Rt(0,1,0),Ra.DEFAULT_MATRIX_AUTO_UPDATE=!0,Ra.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const yc=new Rt,Qu=new Rt,a3=new Rt,qu=new Rt,gg=new Rt,Ag=new Rt,T5=new Rt,o3=new Rt,l3=new Rt,c3=new Rt,u3=new es,h3=new es,d3=new es;class vc{constructor(e=new Rt,i=new Rt,n=new Rt){this.a=e,this.b=i,this.c=n}static getNormal(e,i,n,s){s.subVectors(n,i),yc.subVectors(e,i),s.cross(yc);const o=s.lengthSq();return o>0?s.multiplyScalar(1/Math.sqrt(o)):s.set(0,0,0)}static getBarycoord(e,i,n,s,o){yc.subVectors(s,i),Qu.subVectors(n,i),a3.subVectors(e,i);const l=yc.dot(yc),u=yc.dot(Qu),c=yc.dot(a3),h=Qu.dot(Qu),p=Qu.dot(a3),f=l*h-u*u;if(f===0)return o.set(0,0,0),null;const m=1/f,g=(h*c-u*p)*m,y=(l*p-u*c)*m;return o.set(1-g-y,y,g)}static containsPoint(e,i,n,s){return this.getBarycoord(e,i,n,s,qu)===null?!1:qu.x>=0&&qu.y>=0&&qu.x+qu.y<=1}static getInterpolation(e,i,n,s,o,l,u,c){return this.getBarycoord(e,i,n,s,qu)===null?(c.x=0,c.y=0,"z"in c&&(c.z=0),"w"in c&&(c.w=0),null):(c.setScalar(0),c.addScaledVector(o,qu.x),c.addScaledVector(l,qu.y),c.addScaledVector(u,qu.z),c)}static getInterpolatedAttribute(e,i,n,s,o,l){return u3.setScalar(0),h3.setScalar(0),d3.setScalar(0),u3.fromBufferAttribute(e,i),h3.fromBufferAttribute(e,n),d3.fromBufferAttribute(e,s),l.setScalar(0),l.addScaledVector(u3,o.x),l.addScaledVector(h3,o.y),l.addScaledVector(d3,o.z),l}static isFrontFacing(e,i,n,s){return yc.subVectors(n,i),Qu.subVectors(e,i),yc.cross(Qu).dot(s)<0}set(e,i,n){return this.a.copy(e),this.b.copy(i),this.c.copy(n),this}setFromPointsAndIndices(e,i,n,s){return this.a.copy(e[i]),this.b.copy(e[n]),this.c.copy(e[s]),this}setFromAttributeAndIndices(e,i,n,s){return this.a.fromBufferAttribute(e,i),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,s),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return yc.subVectors(this.c,this.b),Qu.subVectors(this.a,this.b),yc.cross(Qu).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return vc.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,i){return vc.getBarycoord(e,this.a,this.b,this.c,i)}getInterpolation(e,i,n,s,o){return vc.getInterpolation(e,this.a,this.b,this.c,i,n,s,o)}containsPoint(e){return vc.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return vc.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,i){const n=this.a,s=this.b,o=this.c;let l,u;gg.subVectors(s,n),Ag.subVectors(o,n),o3.subVectors(e,n);const c=gg.dot(o3),h=Ag.dot(o3);if(c<=0&&h<=0)return i.copy(n);l3.subVectors(e,s);const p=gg.dot(l3),f=Ag.dot(l3);if(p>=0&&f<=p)return i.copy(s);const m=c*f-p*h;if(m<=0&&c>=0&&p<=0)return l=c/(c-p),i.copy(n).addScaledVector(gg,l);c3.subVectors(e,o);const g=gg.dot(c3),y=Ag.dot(c3);if(y>=0&&g<=y)return i.copy(o);const x=g*h-c*y;if(x<=0&&h>=0&&y<=0)return u=h/(h-y),i.copy(n).addScaledVector(Ag,u);const v=p*y-g*f;if(v<=0&&f-p>=0&&g-y>=0)return T5.subVectors(o,s),u=(f-p)/(f-p+(g-y)),i.copy(s).addScaledVector(T5,u);const _=1/(v+x+m);return l=x*_,u=m*_,i.copy(n).addScaledVector(gg,l).addScaledVector(Ag,u)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const M5={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},fd={h:0,s:0,l:0},F1={h:0,s:0,l:0};function p3(r,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?r+(e-r)*6*i:i<1/2?e:i<2/3?r+(e-r)*6*(2/3-i):r}class ts{constructor(e,i,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,i,n)}set(e,i,n){if(i===void 0&&n===void 0){const s=e;s&&s.isColor?this.copy(s):typeof s=="number"?this.setHex(s):typeof s=="string"&&this.setStyle(s)}else this.setRGB(e,i,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,i=Dr){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,$s.toWorkingColorSpace(this,i),this}setRGB(e,i,n,s=$s.workingColorSpace){return this.r=e,this.g=i,this.b=n,$s.toWorkingColorSpace(this,s),this}setHSL(e,i,n,s=$s.workingColorSpace){if(e=XM(e,1),i=Va(i,0,1),n=Va(n,0,1),i===0)this.r=this.g=this.b=n;else{const o=n<=.5?n*(1+i):n+i-n*i,l=2*n-o;this.r=p3(l,o,e+1/3),this.g=p3(l,o,e),this.b=p3(l,o,e-1/3)}return $s.toWorkingColorSpace(this,s),this}setStyle(e,i=Dr){function n(o){o!==void 0&&parseFloat(o)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let s;if(s=/^(\w+)\(([^\)]*)\)/.exec(e)){let o;const l=s[1],u=s[2];switch(l){case"rgb":case"rgba":if(o=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return n(o[4]),this.setRGB(Math.min(255,parseInt(o[1],10))/255,Math.min(255,parseInt(o[2],10))/255,Math.min(255,parseInt(o[3],10))/255,i);if(o=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return n(o[4]),this.setRGB(Math.min(100,parseInt(o[1],10))/100,Math.min(100,parseInt(o[2],10))/100,Math.min(100,parseInt(o[3],10))/100,i);break;case"hsl":case"hsla":if(o=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return n(o[4]),this.setHSL(parseFloat(o[1])/360,parseFloat(o[2])/100,parseFloat(o[3])/100,i);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(e)){const o=s[1],l=o.length;if(l===3)return this.setRGB(parseInt(o.charAt(0),16)/15,parseInt(o.charAt(1),16)/15,parseInt(o.charAt(2),16)/15,i);if(l===6)return this.setHex(parseInt(o,16),i);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,i);return this}setColorName(e,i=Dr){const n=M5[e.toLowerCase()];return n!==void 0?this.setHex(n,i):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Vu(e.r),this.g=Vu(e.g),this.b=Vu(e.b),this}copyLinearToSRGB(e){return this.r=og(e.r),this.g=og(e.g),this.b=og(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Dr){return $s.fromWorkingColorSpace(ao.copy(this),e),Math.round(Va(ao.r*255,0,255))*65536+Math.round(Va(ao.g*255,0,255))*256+Math.round(Va(ao.b*255,0,255))}getHexString(e=Dr){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,i=$s.workingColorSpace){$s.fromWorkingColorSpace(ao.copy(this),i);const n=ao.r,s=ao.g,o=ao.b,l=Math.max(n,s,o),u=Math.min(n,s,o);let c,h;const p=(u+l)/2;if(u===l)c=0,h=0;else{const f=l-u;switch(h=p<=.5?f/(l+u):f/(2-l-u),l){case n:c=(s-o)/f+(s<o?6:0);break;case s:c=(o-n)/f+2;break;case o:c=(n-s)/f+4;break}c/=6}return e.h=c,e.s=h,e.l=p,e}getRGB(e,i=$s.workingColorSpace){return $s.fromWorkingColorSpace(ao.copy(this),i),e.r=ao.r,e.g=ao.g,e.b=ao.b,e}getStyle(e=Dr){$s.fromWorkingColorSpace(ao.copy(this),e);const i=ao.r,n=ao.g,s=ao.b;return e!==Dr?`color(${e} ${i.toFixed(3)} ${n.toFixed(3)} ${s.toFixed(3)})`:`rgb(${Math.round(i*255)},${Math.round(n*255)},${Math.round(s*255)})`}offsetHSL(e,i,n){return this.getHSL(fd),this.setHSL(fd.h+e,fd.s+i,fd.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,i){return this.r=e.r+i.r,this.g=e.g+i.g,this.b=e.b+i.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,i){return this.r+=(e.r-this.r)*i,this.g+=(e.g-this.g)*i,this.b+=(e.b-this.b)*i,this}lerpColors(e,i,n){return this.r=e.r+(i.r-e.r)*n,this.g=e.g+(i.g-e.g)*n,this.b=e.b+(i.b-e.b)*n,this}lerpHSL(e,i){this.getHSL(fd),e.getHSL(F1);const n=ny(fd.h,F1.h,i),s=ny(fd.s,F1.s,i),o=ny(fd.l,F1.l,i);return this.setHSL(n,s,o),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const i=this.r,n=this.g,s=this.b,o=e.elements;return this.r=o[0]*i+o[3]*n+o[6]*s,this.g=o[1]*i+o[4]*n+o[7]*s,this.b=o[2]*i+o[5]*n+o[8]*s,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,i=0){return this.r=e[i],this.g=e[i+1],this.b=e[i+2],this}toArray(e=[],i=0){return e[i]=this.r,e[i+1]=this.g,e[i+2]=this.b,e}fromBufferAttribute(e,i){return this.r=e.getX(i),this.g=e.getY(i),this.b=e.getZ(i),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const ao=new ts;ts.NAMES=M5;let yue=0;class Xo extends ag{static get type(){return"Material"}get type(){return this.constructor.type}set type(e){}constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:yue++}),this.uuid=ju(),this.name="",this.blending=sd,this.side=Ym,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=b1,this.blendDst=_1,this.blendEquation=ad,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new ts(0,0,0),this.blendAlpha=0,this.depthFunc=E1,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=QM,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Np,this.stencilZFail=Np,this.stencilZPass=Np,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const i in e){const n=e[i];if(n===void 0){console.warn(`THREE.Material: parameter '${i}' has value of undefined.`);continue}const s=this[i];if(s===void 0){console.warn(`THREE.Material: '${i}' is not a property of THREE.${this.type}.`);continue}s&&s.isColor?s.set(n):s&&s.isVector3&&n&&n.isVector3?s.copy(n):this[i]=n}}toJSON(e){const i=e===void 0||typeof e=="string";i&&(e={textures:{},images:{}});const n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==sd&&(n.blending=this.blending),this.side!==Ym&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==b1&&(n.blendSrc=this.blendSrc),this.blendDst!==_1&&(n.blendDst=this.blendDst),this.blendEquation!==ad&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==E1&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==QM&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Np&&(n.stencilFail=this.stencilFail),this.stencilZFail!==Np&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==Np&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function s(o){const l=[];for(const u in o){const c=o[u];delete c.metadata,l.push(c)}return l}if(i){const o=s(e.textures),l=s(e.images);o.length>0&&(n.textures=o),l.length>0&&(n.images=l)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const i=e.clippingPlanes;let n=null;if(i!==null){const s=i.length;n=new Array(s);for(let o=0;o!==s;++o)n[o]=i[o].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}}class U1 extends Xo{static get type(){return"MeshBasicMaterial"}constructor(e){super(),this.isMeshBasicMaterial=!0,this.color=new ts(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Ac,this.combine=w1,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Xu=vue();function vue(){const r=new ArrayBuffer(4),e=new Float32Array(r),i=new Uint32Array(r),n=new Uint32Array(512),s=new Uint32Array(512);for(let c=0;c<256;++c){const h=c-127;h<-27?(n[c]=0,n[c|256]=32768,s[c]=24,s[c|256]=24):h<-14?(n[c]=1024>>-h-14,n[c|256]=1024>>-h-14|32768,s[c]=-h-1,s[c|256]=-h-1):h<=15?(n[c]=h+15<<10,n[c|256]=h+15<<10|32768,s[c]=13,s[c|256]=13):h<128?(n[c]=31744,n[c|256]=64512,s[c]=24,s[c|256]=24):(n[c]=31744,n[c|256]=64512,s[c]=13,s[c|256]=13)}const o=new Uint32Array(2048),l=new Uint32Array(64),u=new Uint32Array(64);for(let c=1;c<1024;++c){let h=c<<13,p=0;for(;!(h&8388608);)h<<=1,p-=8388608;h&=-8388609,p+=947912704,o[c]=h|p}for(let c=1024;c<2048;++c)o[c]=939524096+(c-1024<<13);for(let c=1;c<31;++c)l[c]=c<<23;l[31]=1199570944,l[32]=2147483648;for(let c=33;c<63;++c)l[c]=2147483648+(c-32<<23);l[63]=3347054592;for(let c=1;c<64;++c)c!==32&&(u[c]=1024);return{floatView:e,uint32View:i,baseTable:n,shiftTable:s,mantissaTable:o,exponentTable:l,offsetTable:u}}function gl(r){Math.abs(r)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),r=Va(r,-65504,65504),Xu.floatView[0]=r;const e=Xu.uint32View[0],i=e>>23&511;return Xu.baseTable[i]+((e&8388607)>>Xu.shiftTable[i])}function z1(r){const e=r>>10;return Xu.uint32View[0]=Xu.mantissaTable[Xu.offsetTable[e]+(r&1023)]+Xu.exponentTable[e],Xu.floatView[0]}const ea=new Rt,j1=new Pn;class Ol{constructor(e,i,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=i,this.count=e!==void 0?e.length/i:0,this.normalized=n,this.usage=I1,this.updateRanges=[],this.gpuType=fl,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,i){this.updateRanges.push({start:e,count:i})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,i,n){e*=this.itemSize,n*=i.itemSize;for(let s=0,o=this.itemSize;s<o;s++)this.array[e+s]=i.array[n+s];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let i=0,n=this.count;i<n;i++)j1.fromBufferAttribute(this,i),j1.applyMatrix3(e),this.setXY(i,j1.x,j1.y);else if(this.itemSize===3)for(let i=0,n=this.count;i<n;i++)ea.fromBufferAttribute(this,i),ea.applyMatrix3(e),this.setXYZ(i,ea.x,ea.y,ea.z);return this}applyMatrix4(e){for(let i=0,n=this.count;i<n;i++)ea.fromBufferAttribute(this,i),ea.applyMatrix4(e),this.setXYZ(i,ea.x,ea.y,ea.z);return this}applyNormalMatrix(e){for(let i=0,n=this.count;i<n;i++)ea.fromBufferAttribute(this,i),ea.applyNormalMatrix(e),this.setXYZ(i,ea.x,ea.y,ea.z);return this}transformDirection(e){for(let i=0,n=this.count;i<n;i++)ea.fromBufferAttribute(this,i),ea.transformDirection(e),this.setXYZ(i,ea.x,ea.y,ea.z);return this}set(e,i=0){return this.array.set(e,i),this}getComponent(e,i){let n=this.array[e*this.itemSize+i];return this.normalized&&(n=Co(n,this.array)),n}setComponent(e,i,n){return this.normalized&&(n=rn(n,this.array)),this.array[e*this.itemSize+i]=n,this}getX(e){let i=this.array[e*this.itemSize];return this.normalized&&(i=Co(i,this.array)),i}setX(e,i){return this.normalized&&(i=rn(i,this.array)),this.array[e*this.itemSize]=i,this}getY(e){let i=this.array[e*this.itemSize+1];return this.normalized&&(i=Co(i,this.array)),i}setY(e,i){return this.normalized&&(i=rn(i,this.array)),this.array[e*this.itemSize+1]=i,this}getZ(e){let i=this.array[e*this.itemSize+2];return this.normalized&&(i=Co(i,this.array)),i}setZ(e,i){return this.normalized&&(i=rn(i,this.array)),this.array[e*this.itemSize+2]=i,this}getW(e){let i=this.array[e*this.itemSize+3];return this.normalized&&(i=Co(i,this.array)),i}setW(e,i){return this.normalized&&(i=rn(i,this.array)),this.array[e*this.itemSize+3]=i,this}setXY(e,i,n){return e*=this.itemSize,this.normalized&&(i=rn(i,this.array),n=rn(n,this.array)),this.array[e+0]=i,this.array[e+1]=n,this}setXYZ(e,i,n,s){return e*=this.itemSize,this.normalized&&(i=rn(i,this.array),n=rn(n,this.array),s=rn(s,this.array)),this.array[e+0]=i,this.array[e+1]=n,this.array[e+2]=s,this}setXYZW(e,i,n,s,o){return e*=this.itemSize,this.normalized&&(i=rn(i,this.array),n=rn(n,this.array),s=rn(s,this.array),o=rn(o,this.array)),this.array[e+0]=i,this.array[e+1]=n,this.array[e+2]=s,this.array[e+3]=o,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==I1&&(e.usage=this.usage),e}}class R5 extends Ol{constructor(e,i,n){super(new Uint16Array(e),i,n)}}class I5 extends Ol{constructor(e,i,n){super(new Uint32Array(e),i,n)}}class B5 extends Ol{constructor(e,i,n){super(new Uint16Array(e),i,n),this.isFloat16BufferAttribute=!0}getX(e){let i=z1(this.array[e*this.itemSize]);return this.normalized&&(i=Co(i,this.array)),i}setX(e,i){return this.normalized&&(i=rn(i,this.array)),this.array[e*this.itemSize]=gl(i),this}getY(e){let i=z1(this.array[e*this.itemSize+1]);return this.normalized&&(i=Co(i,this.array)),i}setY(e,i){return this.normalized&&(i=rn(i,this.array)),this.array[e*this.itemSize+1]=gl(i),this}getZ(e){let i=z1(this.array[e*this.itemSize+2]);return this.normalized&&(i=Co(i,this.array)),i}setZ(e,i){return this.normalized&&(i=rn(i,this.array)),this.array[e*this.itemSize+2]=gl(i),this}getW(e){let i=z1(this.array[e*this.itemSize+3]);return this.normalized&&(i=Co(i,this.array)),i}setW(e,i){return this.normalized&&(i=rn(i,this.array)),this.array[e*this.itemSize+3]=gl(i),this}setXY(e,i,n){return e*=this.itemSize,this.normalized&&(i=rn(i,this.array),n=rn(n,this.array)),this.array[e+0]=gl(i),this.array[e+1]=gl(n),this}setXYZ(e,i,n,s){return e*=this.itemSize,this.normalized&&(i=rn(i,this.array),n=rn(n,this.array),s=rn(s,this.array)),this.array[e+0]=gl(i),this.array[e+1]=gl(n),this.array[e+2]=gl(s),this}setXYZW(e,i,n,s,o){return e*=this.itemSize,this.normalized&&(i=rn(i,this.array),n=rn(n,this.array),s=rn(s,this.array),o=rn(o,this.array)),this.array[e+0]=gl(i),this.array[e+1]=gl(n),this.array[e+2]=gl(s),this.array[e+3]=gl(o),this}}class Yu extends Ol{constructor(e,i,n){super(new Float32Array(e),i,n)}}let xue=0;const Pl=new Cs,f3=new Ra,yg=new Rt,Al=new ay,uy=new ay,Ia=new Rt;class Pp extends ag{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:xue++}),this.uuid=ju(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(tue(e)?I5:R5)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,i){return this.attributes[e]=i,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,i,n=0){this.groups.push({start:e,count:i,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,i){this.drawRange.start=e,this.drawRange.count=i}applyMatrix4(e){const i=this.attributes.position;i!==void 0&&(i.applyMatrix4(e),i.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const o=new qo().getNormalMatrix(e);n.applyNormalMatrix(o),n.needsUpdate=!0}const s=this.attributes.tangent;return s!==void 0&&(s.transformDirection(e),s.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Pl.makeRotationFromQuaternion(e),this.applyMatrix4(Pl),this}rotateX(e){return Pl.makeRotationX(e),this.applyMatrix4(Pl),this}rotateY(e){return Pl.makeRotationY(e),this.applyMatrix4(Pl),this}rotateZ(e){return Pl.makeRotationZ(e),this.applyMatrix4(Pl),this}translate(e,i,n){return Pl.makeTranslation(e,i,n),this.applyMatrix4(Pl),this}scale(e,i,n){return Pl.makeScale(e,i,n),this.applyMatrix4(Pl),this}lookAt(e){return f3.lookAt(e),f3.updateMatrix(),this.applyMatrix4(f3.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(yg).negate(),this.translate(yg.x,yg.y,yg.z),this}setFromPoints(e){const i=this.getAttribute("position");if(i===void 0){const n=[];for(let s=0,o=e.length;s<o;s++){const l=e[s];n.push(l.x,l.y,l.z||0)}this.setAttribute("position",new Yu(n,3))}else{for(let n=0,s=i.count;n<s;n++){const o=e[n];i.setXYZ(n,o.x,o.y,o.z||0)}e.length>i.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),i.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new ay);const e=this.attributes.position,i=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new Rt(-1/0,-1/0,-1/0),new Rt(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),i)for(let n=0,s=i.length;n<s;n++){const o=i[n];Al.setFromBufferAttribute(o),this.morphTargetsRelative?(Ia.addVectors(this.boundingBox.min,Al.min),this.boundingBox.expandByPoint(Ia),Ia.addVectors(this.boundingBox.max,Al.max),this.boundingBox.expandByPoint(Ia)):(this.boundingBox.expandByPoint(Al.min),this.boundingBox.expandByPoint(Al.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new t3);const e=this.attributes.position,i=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new Rt,1/0);return}if(e){const n=this.boundingSphere.center;if(Al.setFromBufferAttribute(e),i)for(let o=0,l=i.length;o<l;o++){const u=i[o];uy.setFromBufferAttribute(u),this.morphTargetsRelative?(Ia.addVectors(Al.min,uy.min),Al.expandByPoint(Ia),Ia.addVectors(Al.max,uy.max),Al.expandByPoint(Ia)):(Al.expandByPoint(uy.min),Al.expandByPoint(uy.max))}Al.getCenter(n);let s=0;for(let o=0,l=e.count;o<l;o++)Ia.fromBufferAttribute(e,o),s=Math.max(s,n.distanceToSquared(Ia));if(i)for(let o=0,l=i.length;o<l;o++){const u=i[o],c=this.morphTargetsRelative;for(let h=0,p=u.count;h<p;h++)Ia.fromBufferAttribute(u,h),c&&(yg.fromBufferAttribute(e,h),Ia.add(yg)),s=Math.max(s,n.distanceToSquared(Ia))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,i=this.attributes;if(e===null||i.position===void 0||i.normal===void 0||i.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=i.position,s=i.normal,o=i.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Ol(new Float32Array(4*n.count),4));const l=this.getAttribute("tangent"),u=[],c=[];for(let D=0;D<n.count;D++)u[D]=new Rt,c[D]=new Rt;const h=new Rt,p=new Rt,f=new Rt,m=new Pn,g=new Pn,y=new Pn,x=new Rt,v=new Rt;function _(D,L,O){h.fromBufferAttribute(n,D),p.fromBufferAttribute(n,L),f.fromBufferAttribute(n,O),m.fromBufferAttribute(o,D),g.fromBufferAttribute(o,L),y.fromBufferAttribute(o,O),p.sub(h),f.sub(h),g.sub(m),y.sub(m);const U=1/(g.x*y.y-y.x*g.y);isFinite(U)&&(x.copy(p).multiplyScalar(y.y).addScaledVector(f,-g.y).multiplyScalar(U),v.copy(f).multiplyScalar(g.x).addScaledVector(p,-y.x).multiplyScalar(U),u[D].add(x),u[L].add(x),u[O].add(x),c[D].add(v),c[L].add(v),c[O].add(v))}let T=this.groups;T.length===0&&(T=[{start:0,count:e.count}]);for(let D=0,L=T.length;D<L;++D){const O=T[D],U=O.start,Z=O.count;for(let G=U,z=U+Z;G<z;G+=3)_(e.getX(G+0),e.getX(G+1),e.getX(G+2))}const w=new Rt,S=new Rt,R=new Rt,B=new Rt;function I(D){R.fromBufferAttribute(s,D),B.copy(R);const L=u[D];w.copy(L),w.sub(R.multiplyScalar(R.dot(L))).normalize(),S.crossVectors(B,L);const O=S.dot(c[D])<0?-1:1;l.setXYZW(D,w.x,w.y,w.z,O)}for(let D=0,L=T.length;D<L;++D){const O=T[D],U=O.start,Z=O.count;for(let G=U,z=U+Z;G<z;G+=3)I(e.getX(G+0)),I(e.getX(G+1)),I(e.getX(G+2))}}computeVertexNormals(){const e=this.index,i=this.getAttribute("position");if(i!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new Ol(new Float32Array(i.count*3),3),this.setAttribute("normal",n);else for(let m=0,g=n.count;m<g;m++)n.setXYZ(m,0,0,0);const s=new Rt,o=new Rt,l=new Rt,u=new Rt,c=new Rt,h=new Rt,p=new Rt,f=new Rt;if(e)for(let m=0,g=e.count;m<g;m+=3){const y=e.getX(m+0),x=e.getX(m+1),v=e.getX(m+2);s.fromBufferAttribute(i,y),o.fromBufferAttribute(i,x),l.fromBufferAttribute(i,v),p.subVectors(l,o),f.subVectors(s,o),p.cross(f),u.fromBufferAttribute(n,y),c.fromBufferAttribute(n,x),h.fromBufferAttribute(n,v),u.add(p),c.add(p),h.add(p),n.setXYZ(y,u.x,u.y,u.z),n.setXYZ(x,c.x,c.y,c.z),n.setXYZ(v,h.x,h.y,h.z)}else for(let m=0,g=i.count;m<g;m+=3)s.fromBufferAttribute(i,m+0),o.fromBufferAttribute(i,m+1),l.fromBufferAttribute(i,m+2),p.subVectors(l,o),f.subVectors(s,o),p.cross(f),n.setXYZ(m+0,p.x,p.y,p.z),n.setXYZ(m+1,p.x,p.y,p.z),n.setXYZ(m+2,p.x,p.y,p.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let i=0,n=e.count;i<n;i++)Ia.fromBufferAttribute(e,i),Ia.normalize(),e.setXYZ(i,Ia.x,Ia.y,Ia.z)}toNonIndexed(){function e(u,c){const h=u.array,p=u.itemSize,f=u.normalized,m=new h.constructor(c.length*p);let g=0,y=0;for(let x=0,v=c.length;x<v;x++){u.isInterleavedBufferAttribute?g=c[x]*u.data.stride+u.offset:g=c[x]*p;for(let _=0;_<p;_++)m[y++]=h[g++]}return new Ol(m,p,f)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const i=new Pp,n=this.index.array,s=this.attributes;for(const u in s){const c=s[u],h=e(c,n);i.setAttribute(u,h)}const o=this.morphAttributes;for(const u in o){const c=[],h=o[u];for(let p=0,f=h.length;p<f;p++){const m=h[p],g=e(m,n);c.push(g)}i.morphAttributes[u]=c}i.morphTargetsRelative=this.morphTargetsRelative;const l=this.groups;for(let u=0,c=l.length;u<c;u++){const h=l[u];i.addGroup(h.start,h.count,h.materialIndex)}return i}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const c=this.parameters;for(const h in c)c[h]!==void 0&&(e[h]=c[h]);return e}e.data={attributes:{}};const i=this.index;i!==null&&(e.data.index={type:i.array.constructor.name,array:Array.prototype.slice.call(i.array)});const n=this.attributes;for(const c in n){const h=n[c];e.data.attributes[c]=h.toJSON(e.data)}const s={};let o=!1;for(const c in this.morphAttributes){const h=this.morphAttributes[c],p=[];for(let f=0,m=h.length;f<m;f++){const g=h[f];p.push(g.toJSON(e.data))}p.length>0&&(s[c]=p,o=!0)}o&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);const l=this.groups;l.length>0&&(e.data.groups=JSON.parse(JSON.stringify(l)));const u=this.boundingSphere;return u!==null&&(e.data.boundingSphere={center:u.center.toArray(),radius:u.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const i={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone(i));const s=e.attributes;for(const h in s){const p=s[h];this.setAttribute(h,p.clone(i))}const o=e.morphAttributes;for(const h in o){const p=[],f=o[h];for(let m=0,g=f.length;m<g;m++)p.push(f[m].clone(i));this.morphAttributes[h]=p}this.morphTargetsRelative=e.morphTargetsRelative;const l=e.groups;for(let h=0,p=l.length;h<p;h++){const f=l[h];this.addGroup(f.start,f.count,f.materialIndex)}const u=e.boundingBox;u!==null&&(this.boundingBox=u.clone());const c=e.boundingSphere;return c!==null&&(this.boundingSphere=c.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const N5=new Cs,kp=new uue,V1=new t3,L5=new Rt,G1=new Rt,H1=new Rt,W1=new Rt,m3=new Rt,Q1=new Rt,D5=new Rt,q1=new Rt;class Fp extends Ra{constructor(e=new Pp,i=new U1){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=i,this.updateMorphTargets()}copy(e,i){return super.copy(e,i),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,i=Object.keys(e);if(i.length>0){const n=e[i[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=n.length;s<o;s++){const l=n[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=s}}}}getVertexPosition(e,i){const n=this.geometry,s=n.attributes.position,o=n.morphAttributes.position,l=n.morphTargetsRelative;i.fromBufferAttribute(s,e);const u=this.morphTargetInfluences;if(o&&u){Q1.set(0,0,0);for(let c=0,h=o.length;c<h;c++){const p=u[c],f=o[c];p!==0&&(m3.fromBufferAttribute(f,e),l?Q1.addScaledVector(m3,p):Q1.addScaledVector(m3.sub(i),p))}i.add(Q1)}return i}raycast(e,i){const n=this.geometry,s=this.material,o=this.matrixWorld;s!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),V1.copy(n.boundingSphere),V1.applyMatrix4(o),kp.copy(e.ray).recast(e.near),!(V1.containsPoint(kp.origin)===!1&&(kp.intersectSphere(V1,L5)===null||kp.origin.distanceToSquared(L5)>(e.far-e.near)**2))&&(N5.copy(o).invert(),kp.copy(e.ray).applyMatrix4(N5),!(n.boundingBox!==null&&kp.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,i,kp)))}_computeIntersections(e,i,n){let s;const o=this.geometry,l=this.material,u=o.index,c=o.attributes.position,h=o.attributes.uv,p=o.attributes.uv1,f=o.attributes.normal,m=o.groups,g=o.drawRange;if(u!==null)if(Array.isArray(l))for(let y=0,x=m.length;y<x;y++){const v=m[y],_=l[v.materialIndex],T=Math.max(v.start,g.start),w=Math.min(u.count,Math.min(v.start+v.count,g.start+g.count));for(let S=T,R=w;S<R;S+=3){const B=u.getX(S),I=u.getX(S+1),D=u.getX(S+2);s=X1(this,_,e,n,h,p,f,B,I,D),s&&(s.faceIndex=Math.floor(S/3),s.face.materialIndex=v.materialIndex,i.push(s))}}else{const y=Math.max(0,g.start),x=Math.min(u.count,g.start+g.count);for(let v=y,_=x;v<_;v+=3){const T=u.getX(v),w=u.getX(v+1),S=u.getX(v+2);s=X1(this,l,e,n,h,p,f,T,w,S),s&&(s.faceIndex=Math.floor(v/3),i.push(s))}}else if(c!==void 0)if(Array.isArray(l))for(let y=0,x=m.length;y<x;y++){const v=m[y],_=l[v.materialIndex],T=Math.max(v.start,g.start),w=Math.min(c.count,Math.min(v.start+v.count,g.start+g.count));for(let S=T,R=w;S<R;S+=3){const B=S,I=S+1,D=S+2;s=X1(this,_,e,n,h,p,f,B,I,D),s&&(s.faceIndex=Math.floor(S/3),s.face.materialIndex=v.materialIndex,i.push(s))}}else{const y=Math.max(0,g.start),x=Math.min(c.count,g.start+g.count);for(let v=y,_=x;v<_;v+=3){const T=v,w=v+1,S=v+2;s=X1(this,l,e,n,h,p,f,T,w,S),s&&(s.faceIndex=Math.floor(v/3),i.push(s))}}}}function bue(r,e,i,n,s,o,l,u){let c;if(e.side===pc?c=n.intersectTriangle(l,o,s,!0,u):c=n.intersectTriangle(s,o,l,e.side===Ym,u),c===null)return null;q1.copy(u),q1.applyMatrix4(r.matrixWorld);const h=i.ray.origin.distanceTo(q1);return h<i.near||h>i.far?null:{distance:h,point:q1.clone(),object:r}}function X1(r,e,i,n,s,o,l,u,c,h){r.getVertexPosition(u,G1),r.getVertexPosition(c,H1),r.getVertexPosition(h,W1);const p=bue(r,e,i,n,G1,H1,W1,D5);if(p){const f=new Rt;vc.getBarycoord(D5,G1,H1,W1,f),s&&(p.uv=vc.getInterpolatedAttribute(s,u,c,h,f,new Pn)),o&&(p.uv1=vc.getInterpolatedAttribute(o,u,c,h,f,new Pn)),l&&(p.normal=vc.getInterpolatedAttribute(l,u,c,h,f,new Rt),p.normal.dot(n.direction)>0&&p.normal.multiplyScalar(-1));const m={a:u,b:c,c:h,normal:new Rt,materialIndex:0};vc.getNormal(G1,H1,W1,m.normal),p.face=m,p.barycoord=f}return p}class hy extends Pp{constructor(e=1,i=1,n=1,s=1,o=1,l=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:i,depth:n,widthSegments:s,heightSegments:o,depthSegments:l};const u=this;s=Math.floor(s),o=Math.floor(o),l=Math.floor(l);const c=[],h=[],p=[],f=[];let m=0,g=0;y("z","y","x",-1,-1,n,i,e,l,o,0),y("z","y","x",1,-1,n,i,-e,l,o,1),y("x","z","y",1,1,e,n,i,s,l,2),y("x","z","y",1,-1,e,n,-i,s,l,3),y("x","y","z",1,-1,e,i,n,s,o,4),y("x","y","z",-1,-1,e,i,-n,s,o,5),this.setIndex(c),this.setAttribute("position",new Yu(h,3)),this.setAttribute("normal",new Yu(p,3)),this.setAttribute("uv",new Yu(f,2));function y(x,v,_,T,w,S,R,B,I,D,L){const O=S/I,U=R/D,Z=S/2,G=R/2,z=B/2,$=I+1,Q=D+1;let H=0,V=0;const ne=new Rt;for(let Y=0;Y<Q;Y++){const ae=Y*U-G;for(let xe=0;xe<$;xe++){const fe=xe*O-Z;ne[x]=fe*T,ne[v]=ae*w,ne[_]=z,h.push(ne.x,ne.y,ne.z),ne[x]=0,ne[v]=0,ne[_]=B>0?1:-1,p.push(ne.x,ne.y,ne.z),f.push(xe/I),f.push(1-Y/D),H+=1}}for(let Y=0;Y<D;Y++)for(let ae=0;ae<I;ae++){const xe=m+ae+$*Y,fe=m+ae+$*(Y+1),de=m+(ae+1)+$*(Y+1),Ie=m+(ae+1)+$*Y;c.push(xe,fe,Ie),c.push(fe,de,Ie),V+=6}u.addGroup(g,V,L),g+=V,m+=H}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new hy(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function O5(r){const e={};for(const i in r){e[i]={};for(const n in r[i]){const s=r[i][n];s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture||s.isQuaternion)?s.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[i][n]=null):e[i][n]=s.clone():Array.isArray(s)?e[i][n]=s.slice():e[i][n]=s}}return e}function _ue(r){const e=[];for(let i=0;i<r.length;i++)e.push(r[i].clone());return e}var Eue=`
void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}
`,wue=`
void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}
`;class Cue extends Xo{static get type(){return"ShaderMaterial"}constructor(e){super(),this.isShaderMaterial=!0,this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=Eue,this.fragmentShader=wue,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=O5(e.uniforms),this.uniformsGroups=_ue(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const i=super.toJSON(e);i.glslVersion=this.glslVersion,i.uniforms={};for(const s in this.uniforms){const o=this.uniforms[s].value;o&&o.isTexture?i.uniforms[s]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?i.uniforms[s]={type:"c",value:o.getHex()}:o&&o.isVector2?i.uniforms[s]={type:"v2",value:o.toArray()}:o&&o.isVector3?i.uniforms[s]={type:"v3",value:o.toArray()}:o&&o.isVector4?i.uniforms[s]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?i.uniforms[s]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?i.uniforms[s]={type:"m4",value:o.toArray()}:i.uniforms[s]={value:o}}Object.keys(this.defines).length>0&&(i.defines=this.defines),i.vertexShader=this.vertexShader,i.fragmentShader=this.fragmentShader,i.lights=this.lights,i.clipping=this.clipping;const n={};for(const s in this.extensions)this.extensions[s]===!0&&(n[s]=!0);return Object.keys(n).length>0&&(i.extensions=n),i}}class P5 extends Ra{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Cs,this.projectionMatrix=new Cs,this.projectionMatrixInverse=new Cs,this.coordinateSystem=fc}copy(e,i){return super.copy(e,i),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,i){super.updateWorldMatrix(e,i),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const md=new Rt,k5=new Pn,F5=new Pn;class Ku extends P5{constructor(e=50,i=1,n=.1,s=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=s,this.focus=10,this.aspect=i,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,i){return super.copy(e,i),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const i=.5*this.getFilmHeight()/e;this.fov=ry*2*Math.atan(i),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(iy*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return ry*2*Math.atan(Math.tan(iy*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,i,n){md.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(md.x,md.y).multiplyScalar(-e/md.z),md.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(md.x,md.y).multiplyScalar(-e/md.z)}getViewSize(e,i){return this.getViewBounds(e,k5,F5),i.subVectors(F5,k5)}setViewOffset(e,i,n,s,o,l){this.aspect=e/i,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=i,this.view.offsetX=n,this.view.offsetY=s,this.view.width=o,this.view.height=l,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let i=e*Math.tan(iy*.5*this.fov)/this.zoom,n=2*i,s=this.aspect*n,o=-.5*s;const l=this.view;if(this.view!==null&&this.view.enabled){const c=l.fullWidth,h=l.fullHeight;o+=l.offsetX*s/c,i-=l.offsetY*n/h,s*=l.width/c,n*=l.height/h}const u=this.filmOffset;u!==0&&(o+=e*u/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+s,i,i-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const i=super.toJSON(e);return i.object.fov=this.fov,i.object.zoom=this.zoom,i.object.near=this.near,i.object.far=this.far,i.object.focus=this.focus,i.object.aspect=this.aspect,this.view!==null&&(i.object.view=Object.assign({},this.view)),i.object.filmGauge=this.filmGauge,i.object.filmOffset=this.filmOffset,i}}const vg=-90,xg=1;class U5 extends Ra{constructor(e,i,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const s=new Ku(vg,xg,e,i);s.layers=this.layers,this.add(s);const o=new Ku(vg,xg,e,i);o.layers=this.layers,this.add(o);const l=new Ku(vg,xg,e,i);l.layers=this.layers,this.add(l);const u=new Ku(vg,xg,e,i);u.layers=this.layers,this.add(u);const c=new Ku(vg,xg,e,i);c.layers=this.layers,this.add(c);const h=new Ku(vg,xg,e,i);h.layers=this.layers,this.add(h)}updateCoordinateSystem(){const e=this.coordinateSystem,i=this.children.concat(),[n,s,o,l,u,c]=i;for(const h of i)this.remove(h);if(e===fc)n.up.set(0,1,0),n.lookAt(1,0,0),s.up.set(0,1,0),s.lookAt(-1,0,0),o.up.set(0,0,-1),o.lookAt(0,1,0),l.up.set(0,0,1),l.lookAt(0,-1,0),u.up.set(0,1,0),u.lookAt(0,0,1),c.up.set(0,1,0),c.lookAt(0,0,-1);else if(e===Lp)n.up.set(0,-1,0),n.lookAt(-1,0,0),s.up.set(0,-1,0),s.lookAt(1,0,0),o.up.set(0,0,1),o.lookAt(0,1,0),l.up.set(0,0,-1),l.lookAt(0,-1,0),u.up.set(0,-1,0),u.lookAt(0,0,1),c.up.set(0,-1,0),c.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const h of i)this.add(h),h.updateMatrixWorld()}update(e,i){this.parent===null&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:s}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[o,l,u,c,h,p]=this.children,f=e.getRenderTarget(),m=e.getActiveCubeFace(),g=e.getActiveMipmapLevel(),y=e.xr.enabled;e.xr.enabled=!1;const x=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,s),e.render(i,o),e.setRenderTarget(n,1,s),e.render(i,l),e.setRenderTarget(n,2,s),e.render(i,u),e.setRenderTarget(n,3,s),e.render(i,c),e.setRenderTarget(n,4,s),e.render(i,h),n.texture.generateMipmaps=x,e.setRenderTarget(n,5,s),e.render(i,p),e.setRenderTarget(f,m,g),e.xr.enabled=y,n.texture.needsPMREMUpdate=!0}}class g3 extends So{constructor(e,i,n,s,o,l,u,c,h,p){e=e!==void 0?e:[],i=i!==void 0?i:Rp,super(e,i,n,s,o,l,u,c,h,p),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class Sue extends oue{constructor(e=1,i={}){super(e,e,i),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},s=[n,n,n,n,n,n];this.texture=new g3(s,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=i.generateMipmaps!==void 0?i.generateMipmaps:!1,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:pl}fromEquirectangularTexture(e,i){this.texture.type=i.type,this.texture.colorSpace=i.colorSpace,this.texture.generateMipmaps=i.generateMipmaps,this.texture.minFilter=i.minFilter,this.texture.magFilter=i.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},s=new hy(5,5,5),o=new Cue({name:"CubemapFromEquirect",uniforms:O5(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:pc,blending:Jm});o.uniforms.tEquirect.value=i;const l=new Fp(s,o),u=i.minFilter;return i.minFilter===Uu&&(i.minFilter=pl),new U5(1,10,this).update(e,l),i.minFilter=u,l.geometry.dispose(),l.material.dispose(),this}clear(e,i,n,s){const o=e.getRenderTarget();for(let l=0;l<6;l++)e.setRenderTarget(this,l),e.clear(i,n,s);e.setRenderTarget(o)}}class z5 extends Ra{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Ac,this.environmentIntensity=1,this.environmentRotation=new Ac,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,i){return super.copy(e,i),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const i=super.toJSON(e);return this.fog!==null&&(i.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(i.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(i.object.backgroundIntensity=this.backgroundIntensity),i.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(i.object.environmentIntensity=this.environmentIntensity),i.object.environmentRotation=this.environmentRotation.toArray(),i}}class j5{constructor(e,i){this.isInterleavedBuffer=!0,this.array=e,this.stride=i,this.count=e!==void 0?e.length/i:0,this.usage=I1,this.updateRanges=[],this.version=0,this.uuid=ju()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,i){this.updateRanges.push({start:e,count:i})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,i,n){e*=this.stride,n*=i.stride;for(let s=0,o=this.stride;s<o;s++)this.array[e+s]=i.array[n+s];return this}set(e,i=0){return this.array.set(e,i),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ju()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const i=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(i,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ju()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const To=new Rt;class A3{constructor(e,i,n,s=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=i,this.offset=n,this.normalized=s}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let i=0,n=this.data.count;i<n;i++)To.fromBufferAttribute(this,i),To.applyMatrix4(e),this.setXYZ(i,To.x,To.y,To.z);return this}applyNormalMatrix(e){for(let i=0,n=this.count;i<n;i++)To.fromBufferAttribute(this,i),To.applyNormalMatrix(e),this.setXYZ(i,To.x,To.y,To.z);return this}transformDirection(e){for(let i=0,n=this.count;i<n;i++)To.fromBufferAttribute(this,i),To.transformDirection(e),this.setXYZ(i,To.x,To.y,To.z);return this}getComponent(e,i){let n=this.array[e*this.data.stride+this.offset+i];return this.normalized&&(n=Co(n,this.array)),n}setComponent(e,i,n){return this.normalized&&(n=rn(n,this.array)),this.data.array[e*this.data.stride+this.offset+i]=n,this}setX(e,i){return this.normalized&&(i=rn(i,this.array)),this.data.array[e*this.data.stride+this.offset]=i,this}setY(e,i){return this.normalized&&(i=rn(i,this.array)),this.data.array[e*this.data.stride+this.offset+1]=i,this}setZ(e,i){return this.normalized&&(i=rn(i,this.array)),this.data.array[e*this.data.stride+this.offset+2]=i,this}setW(e,i){return this.normalized&&(i=rn(i,this.array)),this.data.array[e*this.data.stride+this.offset+3]=i,this}getX(e){let i=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(i=Co(i,this.array)),i}getY(e){let i=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(i=Co(i,this.array)),i}getZ(e){let i=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(i=Co(i,this.array)),i}getW(e){let i=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(i=Co(i,this.array)),i}setXY(e,i,n){return e=e*this.data.stride+this.offset,this.normalized&&(i=rn(i,this.array),n=rn(n,this.array)),this.data.array[e+0]=i,this.data.array[e+1]=n,this}setXYZ(e,i,n,s){return e=e*this.data.stride+this.offset,this.normalized&&(i=rn(i,this.array),n=rn(n,this.array),s=rn(s,this.array)),this.data.array[e+0]=i,this.data.array[e+1]=n,this.data.array[e+2]=s,this}setXYZW(e,i,n,s,o){return e=e*this.data.stride+this.offset,this.normalized&&(i=rn(i,this.array),n=rn(n,this.array),s=rn(s,this.array),o=rn(o,this.array)),this.data.array[e+0]=i,this.data.array[e+1]=n,this.data.array[e+2]=s,this.data.array[e+3]=o,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const i=[];for(let n=0;n<this.count;n++){const s=n*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)i.push(this.data.array[s+o])}return new Ol(new this.array.constructor(i),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new A3(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const i=[];for(let n=0;n<this.count;n++){const s=n*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)i.push(this.data.array[s+o])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:i,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class V5 extends Xo{static get type(){return"SpriteMaterial"}constructor(e){super(),this.isSpriteMaterial=!0,this.color=new ts(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}class Tue extends So{constructor(e=null,i=1,n=1,s,o,l,u,c,h=no,p=no,f,m){super(null,l,u,c,h,p,s,o,f,m),this.isDataTexture=!0,this.image={data:e,width:i,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Mue extends Ol{constructor(e,i,n,s=1){super(e,i,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=s}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const y3=new Rt,Rue=new Rt,Iue=new qo;class gd{constructor(e=new Rt(1,0,0),i=0){this.isPlane=!0,this.normal=e,this.constant=i}set(e,i){return this.normal.copy(e),this.constant=i,this}setComponents(e,i,n,s){return this.normal.set(e,i,n),this.constant=s,this}setFromNormalAndCoplanarPoint(e,i){return this.normal.copy(e),this.constant=-i.dot(this.normal),this}setFromCoplanarPoints(e,i,n){const s=y3.subVectors(n,i).cross(Rue.subVectors(e,i)).normalize();return this.setFromNormalAndCoplanarPoint(s,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,i){return i.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,i){const n=e.delta(y3),s=this.normal.dot(n);if(s===0)return this.distanceToPoint(e.start)===0?i.copy(e.start):null;const o=-(e.start.dot(this.normal)+this.constant)/s;return o<0||o>1?null:i.copy(e.start).addScaledVector(n,o)}intersectsLine(e){const i=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return i<0&&n>0||n<0&&i>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,i){const n=i||Iue.getNormalMatrix(e),s=this.coplanarPoint(y3).applyMatrix4(e),o=this.normal.applyMatrix3(n).normalize();return this.constant=-s.dot(o),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Up=new t3,Y1=new Rt;class G5{constructor(e=new gd,i=new gd,n=new gd,s=new gd,o=new gd,l=new gd){this.planes=[e,i,n,s,o,l]}set(e,i,n,s,o,l){const u=this.planes;return u[0].copy(e),u[1].copy(i),u[2].copy(n),u[3].copy(s),u[4].copy(o),u[5].copy(l),this}copy(e){const i=this.planes;for(let n=0;n<6;n++)i[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,i=fc){const n=this.planes,s=e.elements,o=s[0],l=s[1],u=s[2],c=s[3],h=s[4],p=s[5],f=s[6],m=s[7],g=s[8],y=s[9],x=s[10],v=s[11],_=s[12],T=s[13],w=s[14],S=s[15];if(n[0].setComponents(c-o,m-h,v-g,S-_).normalize(),n[1].setComponents(c+o,m+h,v+g,S+_).normalize(),n[2].setComponents(c+l,m+p,v+y,S+T).normalize(),n[3].setComponents(c-l,m-p,v-y,S-T).normalize(),n[4].setComponents(c-u,m-f,v-x,S-w).normalize(),i===fc)n[5].setComponents(c+u,m+f,v+x,S+w).normalize();else if(i===Lp)n[5].setComponents(u,f,x,w).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+i);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Up.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const i=e.geometry;i.boundingSphere===null&&i.computeBoundingSphere(),Up.copy(i.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Up)}intersectsSprite(e){return Up.center.set(0,0,0),Up.radius=.7071067811865476,Up.applyMatrix4(e.matrixWorld),this.intersectsSphere(Up)}intersectsSphere(e){const i=this.planes,n=e.center,s=-e.radius;for(let o=0;o<6;o++)if(i[o].distanceToPoint(n)<s)return!1;return!0}intersectsBox(e){const i=this.planes;for(let n=0;n<6;n++){const s=i[n];if(Y1.x=s.normal.x>0?e.max.x:e.min.x,Y1.y=s.normal.y>0?e.max.y:e.min.y,Y1.z=s.normal.z>0?e.max.z:e.min.z,s.distanceToPoint(Y1)<0)return!1}return!0}containsPoint(e){const i=this.planes;for(let n=0;n<6;n++)if(i[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}class v3 extends Xo{static get type(){return"LineBasicMaterial"}constructor(e){super(),this.isLineBasicMaterial=!0,this.color=new ts(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}class H5 extends Xo{static get type(){return"PointsMaterial"}constructor(e){super(),this.isPointsMaterial=!0,this.color=new ts(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}class Bue extends So{constructor(e,i){super({width:e,height:i}),this.isFramebufferTexture=!0,this.magFilter=no,this.minFilter=no,this.generateMipmaps=!1,this.needsUpdate=!0}}class bg extends So{constructor(e,i,n,s,o,l,u,c,h,p=Ip){if(p!==Ip&&p!==ng)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&p===Ip&&(n=ja),n===void 0&&p===ng&&(n=$A),super(null,s,o,l,u,c,p,n,h),this.isDepthTexture=!0,this.image={width:e,height:i},this.magFilter=u!==void 0?u:no,this.minFilter=c!==void 0?c:no,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const i=super.toJSON(e);return this.compareFunction!==null&&(i.compareFunction=this.compareFunction),i}}class x3 extends Pp{constructor(e=1,i=32,n=16,s=0,o=Math.PI*2,l=0,u=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:i,heightSegments:n,phiStart:s,phiLength:o,thetaStart:l,thetaLength:u},i=Math.max(3,Math.floor(i)),n=Math.max(2,Math.floor(n));const c=Math.min(l+u,Math.PI);let h=0;const p=[],f=new Rt,m=new Rt,g=[],y=[],x=[],v=[];for(let _=0;_<=n;_++){const T=[],w=_/n;let S=0;_===0&&l===0?S=.5/i:_===n&&c===Math.PI&&(S=-.5/i);for(let R=0;R<=i;R++){const B=R/i;f.x=-e*Math.cos(s+B*o)*Math.sin(l+w*u),f.y=e*Math.cos(l+w*u),f.z=e*Math.sin(s+B*o)*Math.sin(l+w*u),y.push(f.x,f.y,f.z),m.copy(f).normalize(),x.push(m.x,m.y,m.z),v.push(B+S,1-w),T.push(h++)}p.push(T)}for(let _=0;_<n;_++)for(let T=0;T<i;T++){const w=p[_][T+1],S=p[_][T],R=p[_+1][T],B=p[_+1][T+1];(_!==0||l>0)&&g.push(w,S,B),(_!==n-1||c<Math.PI)&&g.push(S,R,B)}this.setIndex(g),this.setAttribute("position",new Yu(y,3)),this.setAttribute("normal",new Yu(x,3)),this.setAttribute("uv",new Yu(v,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new x3(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class W5 extends Xo{static get type(){return"ShadowMaterial"}constructor(e){super(),this.isShadowMaterial=!0,this.color=new ts(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class b3 extends Xo{static get type(){return"MeshStandardMaterial"}constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.color=new ts(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ts(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ld,this.normalScale=new Pn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Ac,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Q5 extends b3{static get type(){return"MeshPhysicalMaterial"}constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Pn(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Va(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(i){this.ior=(1+.4*i)/(1-.4*i)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new ts(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new ts(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new ts(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class q5 extends Xo{static get type(){return"MeshPhongMaterial"}constructor(e){super(),this.isMeshPhongMaterial=!0,this.color=new ts(16777215),this.specular=new ts(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ts(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ld,this.normalScale=new Pn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Ac,this.combine=w1,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class X5 extends Xo{static get type(){return"MeshToonMaterial"}constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.color=new ts(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ts(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ld,this.normalScale=new Pn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class Y5 extends Xo{static get type(){return"MeshNormalMaterial"}constructor(e){super(),this.isMeshNormalMaterial=!0,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ld,this.normalScale=new Pn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class K5 extends Xo{static get type(){return"MeshLambertMaterial"}constructor(e){super(),this.isMeshLambertMaterial=!0,this.color=new ts(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ts(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ld,this.normalScale=new Pn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Ac,this.combine=w1,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class J5 extends Xo{static get type(){return"MeshMatcapMaterial"}constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.color=new ts(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ld,this.normalScale=new Pn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Z5 extends v3{static get type(){return"LineDashedMaterial"}constructor(e){super(),this.isLineDashedMaterial=!0,this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}class zp extends Ra{constructor(e,i=1){super(),this.isLight=!0,this.type="Light",this.color=new ts(e),this.intensity=i}dispose(){}copy(e,i){return super.copy(e,i),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const i=super.toJSON(e);return i.object.color=this.color.getHex(),i.object.intensity=this.intensity,this.groundColor!==void 0&&(i.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(i.object.distance=this.distance),this.angle!==void 0&&(i.object.angle=this.angle),this.decay!==void 0&&(i.object.decay=this.decay),this.penumbra!==void 0&&(i.object.penumbra=this.penumbra),this.shadow!==void 0&&(i.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(i.object.target=this.target.uuid),i}}class Nue extends zp{constructor(e,i,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Ra.DEFAULT_UP),this.updateMatrix(),this.groundColor=new ts(i)}copy(e,i){return super.copy(e,i),this.groundColor.copy(e.groundColor),this}}const _3=new Cs,$5=new Rt,e6=new Rt;class E3{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Pn(512,512),this.map=null,this.mapPass=null,this.matrix=new Cs,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new G5,this._frameExtents=new Pn(1,1),this._viewportCount=1,this._viewports=[new es(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const i=this.camera,n=this.matrix;$5.setFromMatrixPosition(e.matrixWorld),i.position.copy($5),e6.setFromMatrixPosition(e.target.matrixWorld),i.lookAt(e6),i.updateMatrixWorld(),_3.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_3),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(_3)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Lue extends E3{constructor(){super(new Ku(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const i=this.camera,n=ry*2*e.angle*this.focus,s=this.mapSize.width/this.mapSize.height,o=e.distance||i.far;(n!==i.fov||s!==i.aspect||o!==i.far)&&(i.fov=n,i.aspect=s,i.far=o,i.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class t6 extends zp{constructor(e,i,n=0,s=Math.PI/3,o=0,l=2){super(e,i),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Ra.DEFAULT_UP),this.updateMatrix(),this.target=new Ra,this.distance=n,this.angle=s,this.penumbra=o,this.decay=l,this.map=null,this.shadow=new Lue}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,i){return super.copy(e,i),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const i6=new Cs,dy=new Rt,w3=new Rt;class Due extends E3{constructor(){super(new Ku(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Pn(4,2),this._viewportCount=6,this._viewports=[new es(2,1,1,1),new es(0,1,1,1),new es(3,1,1,1),new es(1,1,1,1),new es(3,0,1,1),new es(1,0,1,1)],this._cubeDirections=[new Rt(1,0,0),new Rt(-1,0,0),new Rt(0,0,1),new Rt(0,0,-1),new Rt(0,1,0),new Rt(0,-1,0)],this._cubeUps=[new Rt(0,1,0),new Rt(0,1,0),new Rt(0,1,0),new Rt(0,1,0),new Rt(0,0,1),new Rt(0,0,-1)]}updateMatrices(e,i=0){const n=this.camera,s=this.matrix,o=e.distance||n.far;o!==n.far&&(n.far=o,n.updateProjectionMatrix()),dy.setFromMatrixPosition(e.matrixWorld),n.position.copy(dy),w3.copy(n.position),w3.add(this._cubeDirections[i]),n.up.copy(this._cubeUps[i]),n.lookAt(w3),n.updateMatrixWorld(),s.makeTranslation(-dy.x,-dy.y,-dy.z),i6.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(i6)}}class Oue extends zp{constructor(e,i,n=0,s=2){super(e,i),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=s,this.shadow=new Due}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,i){return super.copy(e,i),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class C3 extends P5{constructor(e=-1,i=1,n=1,s=-1,o=.1,l=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=i,this.top=n,this.bottom=s,this.near=o,this.far=l,this.updateProjectionMatrix()}copy(e,i){return super.copy(e,i),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,i,n,s,o,l){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=i,this.view.offsetX=n,this.view.offsetY=s,this.view.width=o,this.view.height=l,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),i=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,s=(this.top+this.bottom)/2;let o=n-e,l=n+e,u=s+i,c=s-i;if(this.view!==null&&this.view.enabled){const h=(this.right-this.left)/this.view.fullWidth/this.zoom,p=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o+=h*this.view.offsetX,l=o+h*this.view.width,u-=p*this.view.offsetY,c=u-p*this.view.height}this.projectionMatrix.makeOrthographic(o,l,u,c,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const i=super.toJSON(e);return i.object.zoom=this.zoom,i.object.left=this.left,i.object.right=this.right,i.object.top=this.top,i.object.bottom=this.bottom,i.object.near=this.near,i.object.far=this.far,this.view!==null&&(i.object.view=Object.assign({},this.view)),i}}class Pue extends E3{constructor(){super(new C3(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class kue extends zp{constructor(e,i){super(e,i),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Ra.DEFAULT_UP),this.updateMatrix(),this.target=new Ra,this.shadow=new Pue}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class Fue extends zp{constructor(e,i){super(e,i),this.isAmbientLight=!0,this.type="AmbientLight"}}class Uue extends zp{constructor(e,i,n=10,s=10){super(e,i),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=s}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const i=super.toJSON(e);return i.object.width=this.width,i.object.height=this.height,i}}class zue{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Rt)}set(e){for(let i=0;i<9;i++)this.coefficients[i].copy(e[i]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,i){const n=e.x,s=e.y,o=e.z,l=this.coefficients;return i.copy(l[0]).multiplyScalar(.282095),i.addScaledVector(l[1],.488603*s),i.addScaledVector(l[2],.488603*o),i.addScaledVector(l[3],.488603*n),i.addScaledVector(l[4],1.092548*(n*s)),i.addScaledVector(l[5],1.092548*(s*o)),i.addScaledVector(l[6],.315392*(3*o*o-1)),i.addScaledVector(l[7],1.092548*(n*o)),i.addScaledVector(l[8],.546274*(n*n-s*s)),i}getIrradianceAt(e,i){const n=e.x,s=e.y,o=e.z,l=this.coefficients;return i.copy(l[0]).multiplyScalar(.886227),i.addScaledVector(l[1],2*.511664*s),i.addScaledVector(l[2],2*.511664*o),i.addScaledVector(l[3],2*.511664*n),i.addScaledVector(l[4],2*.429043*n*s),i.addScaledVector(l[5],2*.429043*s*o),i.addScaledVector(l[6],.743125*o*o-.247708),i.addScaledVector(l[7],2*.429043*n*o),i.addScaledVector(l[8],.429043*(n*n-s*s)),i}add(e){for(let i=0;i<9;i++)this.coefficients[i].add(e.coefficients[i]);return this}addScaledSH(e,i){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],i);return this}scale(e){for(let i=0;i<9;i++)this.coefficients[i].multiplyScalar(e);return this}lerp(e,i){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],i);return this}equals(e){for(let i=0;i<9;i++)if(!this.coefficients[i].equals(e.coefficients[i]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,i=0){const n=this.coefficients;for(let s=0;s<9;s++)n[s].fromArray(e,i+s*3);return this}toArray(e=[],i=0){const n=this.coefficients;for(let s=0;s<9;s++)n[s].toArray(e,i+s*3);return e}static getBasisAt(e,i){const n=e.x,s=e.y,o=e.z;i[0]=.282095,i[1]=.488603*s,i[2]=.488603*o,i[3]=.488603*n,i[4]=1.092548*n*s,i[5]=1.092548*s*o,i[6]=.315392*(3*o*o-1),i[7]=1.092548*n*o,i[8]=.546274*(n*n-s*s)}}class jue extends zp{constructor(e=new zue,i=1){super(void 0,i),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const i=super.toJSON(e);return i.object.sh=this.sh.toArray(),i}}class Vue extends j5{constructor(e,i,n=1){super(e,i),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const i=super.clone(e);return i.meshPerAttribute=this.meshPerAttribute,i}toJSON(e){const i=super.toJSON(e);return i.isInstancedInterleavedBuffer=!0,i.meshPerAttribute=this.meshPerAttribute,i}}const Gue=["alphaMap","alphaTest","anisotropy","anisotropyMap","anisotropyRotation","aoMap","attenuationColor","attenuationDistance","bumpMap","clearcoat","clearcoatMap","clearcoatNormalMap","clearcoatNormalScale","clearcoatRoughness","color","dispersion","displacementMap","emissive","emissiveMap","envMap","gradientMap","ior","iridescence","iridescenceIOR","iridescenceMap","iridescenceThicknessMap","lightMap","map","matcap","metalness","metalnessMap","normalMap","normalScale","opacity","roughness","roughnessMap","sheen","sheenColor","sheenColorMap","sheenRoughnessMap","shininess","specular","specularColor","specularColorMap","specularIntensity","specularIntensityMap","specularMap","thickness","transmission","transmissionMap"];class Hue{constructor(e){this.renderObjects=new WeakMap,this.hasNode=this.containsNode(e),this.hasAnimation=e.object.isSkinnedMesh===!0,this.refreshUniforms=Gue,this.renderId=0}firstInitialization(e){return this.renderObjects.has(e)===!1?(this.getRenderObjectData(e),!0):!1}getRenderObjectData(e){let i=this.renderObjects.get(e);if(i===void 0){const{geometry:n,material:s}=e;if(i={material:this.getMaterialData(s),geometry:{attributes:this.getAttributesData(n.attributes),indexVersion:n.index?n.index.version:null,drawRange:{start:n.drawRange.start,count:n.drawRange.count}},worldMatrix:e.object.matrixWorld.clone()},e.object.center&&(i.center=e.object.center.clone()),e.object.morphTargetInfluences&&(i.morphTargetInfluences=e.object.morphTargetInfluences.slice()),e.bundle!==null&&(i.version=e.bundle.version),i.material.transmission>0){const{width:o,height:l}=e.context;i.bufferWidth=o,i.bufferHeight=l}this.renderObjects.set(e,i)}return i}getAttributesData(e){const i={};for(const n in e){const s=e[n];i[n]={version:s.version}}return i}containsNode(e){const i=e.material;for(const n in i)if(i[n]&&i[n].isNode)return!0;return e.renderer.nodes.modelViewMatrix!==null||e.renderer.nodes.modelNormalViewMatrix!==null}getMaterialData(e){const i={};for(const n of this.refreshUniforms){const s=e[n];s!=null&&(typeof s=="object"&&s.clone!==void 0?s.isTexture===!0?i[n]={id:s.id,version:s.version}:i[n]=s.clone():i[n]=s)}return i}equals(e){const{object:i,material:n,geometry:s}=e,o=this.getRenderObjectData(e);if(o.worldMatrix.equals(i.matrixWorld)!==!0)return o.worldMatrix.copy(i.matrixWorld),!1;const l=o.material;for(const x in l){const v=l[x],_=n[x];if(v.equals!==void 0){if(v.equals(_)===!1)return v.copy(_),!1}else if(_.isTexture===!0){if(v.id!==_.id||v.version!==_.version)return v.id=_.id,v.version=_.version,!1}else if(v!==_)return l[x]=_,!1}if(l.transmission>0){const{width:x,height:v}=e.context;if(o.bufferWidth!==x||o.bufferHeight!==v)return o.bufferWidth=x,o.bufferHeight=v,!1}const u=o.geometry,c=s.attributes,h=u.attributes,p=Object.keys(h),f=Object.keys(c);if(p.length!==f.length)return o.geometry.attributes=this.getAttributesData(c),!1;for(const x of p){const v=h[x],_=c[x];if(_===void 0)return delete h[x],!1;if(v.version!==_.version)return v.version=_.version,!1}const m=s.index,g=u.indexVersion,y=m?m.version:null;if(g!==y)return u.indexVersion=y,!1;if(u.drawRange.start!==s.drawRange.start||u.drawRange.count!==s.drawRange.count)return u.drawRange.start=s.drawRange.start,u.drawRange.count=s.drawRange.count,!1;if(o.morphTargetInfluences){let x=!1;for(let v=0;v<o.morphTargetInfluences.length;v++)o.morphTargetInfluences[v]!==i.morphTargetInfluences[v]&&(x=!0);if(x)return!0}return o.center&&o.center.equals(i.center)===!1?(o.center.copy(i.center),!0):(e.bundle!==null&&(o.version=e.bundle.version),!0)}needsRefresh(e,i){if(this.hasNode||this.hasAnimation||this.firstInitialization(e))return!0;const{renderId:n}=i;if(this.renderId!==n)return this.renderId=n,!0;const s=e.object.static===!0,o=e.bundle!==null&&e.bundle.static===!0&&this.getRenderObjectData(e).version===e.bundle.version;return s||o?!1:this.equals(e)!==!0}}function py(r,e=0){let i=3735928559^e,n=1103547991^e;if(r instanceof Array)for(let s=0,o;s<r.length;s++)o=r[s],i=Math.imul(i^o,2654435761),n=Math.imul(n^o,1597334677);else for(let s=0,o;s<r.length;s++)o=r.charCodeAt(s),i=Math.imul(i^o,2654435761),n=Math.imul(n^o,1597334677);return i=Math.imul(i^i>>>16,2246822507),i^=Math.imul(n^n>>>13,3266489909),n=Math.imul(n^n>>>16,2246822507),n^=Math.imul(i^i>>>13,3266489909),4294967296*(2097151&n)+(i>>>0)}const Wue=r=>py(r),r6=r=>py(r),K1=(...r)=>py(r);function n6(r,e=!1){const i=[];r.isNode===!0&&(i.push(r.id),r=r.getSelf());for(const{property:n,childNode:s}of J1(r))i.push(i,py(n.slice(0,-4)),s.getCacheKey(e));return py(i)}function*J1(r,e=!1){for(const i in r){if(i.startsWith("_")===!0)continue;const n=r[i];if(Array.isArray(n)===!0)for(let s=0;s<n.length;s++){const o=n[s];o&&(o.isNode===!0||e&&typeof o.toJSON=="function")&&(yield{property:i,index:s,childNode:o})}else if(n&&n.isNode===!0)yield{property:i,childNode:n};else if(typeof n=="object")for(const s in n){const o=n[s];o&&(o.isNode===!0||e&&typeof o.toJSON=="function")&&(yield{property:i,index:s,childNode:o})}}}function Z1(r){if(r==null)return null;const e=typeof r;return r.isNode===!0?"node":e==="number"?"float":e==="boolean"?"bool":e==="string"?"string":e==="function"?"shader":r.isVector2===!0?"vec2":r.isVector3===!0?"vec3":r.isVector4===!0?"vec4":r.isMatrix3===!0?"mat3":r.isMatrix4===!0?"mat4":r.isColor===!0?"color":r instanceof ArrayBuffer?"ArrayBuffer":null}function s6(r,...e){const i=r?r.slice(-4):void 0;return e.length===1&&(i==="vec2"?e=[e[0],e[0]]:i==="vec3"?e=[e[0],e[0],e[0]]:i==="vec4"&&(e=[e[0],e[0],e[0],e[0]])),r==="color"?new ts(...e):i==="vec2"?new Pn(...e):i==="vec3"?new Rt(...e):i==="vec4"?new es(...e):i==="mat3"?new qo(...e):i==="mat4"?new Cs(...e):r==="bool"?e[0]||!1:r==="float"||r==="int"||r==="uint"?e[0]||0:r==="string"?e[0]||"":r==="ArrayBuffer"?que(e[0]):null}function Que(r){let e="";const i=new Uint8Array(r);for(let n=0;n<i.length;n++)e+=String.fromCharCode(i[n]);return btoa(e)}function que(r){return Uint8Array.from(atob(r),e=>e.charCodeAt(0)).buffer}const a6={VERTEX:"vertex"},dn={NONE:"none",FRAME:"frame",RENDER:"render",OBJECT:"object"},Xue=["fragment","vertex"],o6=["setup","analyze","generate"],l6=[...Xue,"compute"],_g=["x","y","z","w"];let Yue=0,nn=class extends ag{static get type(){return"Node"}constructor(r=null){super(),this.nodeType=r,this.updateType=dn.NONE,this.updateBeforeType=dn.NONE,this.updateAfterType=dn.NONE,this.uuid=eue.generateUUID(),this.version=0,this._cacheKey=null,this._cacheKeyVersion=0,this.global=!1,this.isNode=!0,Object.defineProperty(this,"id",{value:Yue++})}set needsUpdate(r){r===!0&&this.version++}get type(){return this.constructor.type}onUpdate(r,e){return this.updateType=e,this.update=r.bind(this.getSelf()),this}onFrameUpdate(r){return this.onUpdate(r,dn.FRAME)}onRenderUpdate(r){return this.onUpdate(r,dn.RENDER)}onObjectUpdate(r){return this.onUpdate(r,dn.OBJECT)}onReference(r){return this.updateReference=r.bind(this.getSelf()),this}getSelf(){return this.self||this}updateReference(){return this}isGlobal(){return this.global}*getChildren(){for(const{childNode:r}of J1(this))yield r}dispose(){this.dispatchEvent({type:"dispose"})}traverse(r){r(this);for(const e of this.getChildren())e.traverse(r)}getCacheKey(r=!1){return r=r||this.version!==this._cacheKeyVersion,(r===!0||this._cacheKey===null)&&(this._cacheKey=n6(this,r),this._cacheKeyVersion=this.version),this._cacheKey}getScope(){return this}getHash(){return this.uuid}getUpdateType(){return this.updateType}getUpdateBeforeType(){return this.updateBeforeType}getUpdateAfterType(){return this.updateAfterType}getElementType(r){const e=this.getNodeType(r);return r.getElementType(e)}getNodeType(r){const e=r.getNodeProperties(this);return e.outputNode?e.outputNode.getNodeType(r):this.nodeType}getShared(r){const e=this.getHash(r);return r.getNodeFromHash(e)||this}setup(r){const e=r.getNodeProperties(this);let i=0;for(const n of this.getChildren())e["node"+i++]=n;return null}analyze(r){if(r.increaseUsage(this)===1){const e=r.getNodeProperties(this);for(const i of Object.values(e))i&&i.isNode===!0&&i.build(r)}}generate(r,e){const{outputNode:i}=r.getNodeProperties(this);if(i&&i.isNode===!0)return i.build(r,e)}updateBefore(){console.warn("Abstract function.")}updateAfter(){console.warn("Abstract function.")}update(){console.warn("Abstract function.")}build(r,e=null){const i=this.getShared(r);if(this!==i)return i.build(r,e);r.addNode(this),r.addChain(this);let n=null;const s=r.getBuildStage();if(s==="setup"){this.updateReference(r);const o=r.getNodeProperties(this);if(o.initialized!==!0){r.stack.nodes.length,o.initialized=!0,o.outputNode=this.setup(r),o.outputNode!==null&&r.stack.nodes.length;for(const l of Object.values(o))l&&l.isNode===!0&&l.build(r)}}else if(s==="analyze")this.analyze(r);else if(s==="generate")if(this.generate.length===1){const o=this.getNodeType(r),l=r.getDataFromNode(this);n=l.snippet,n===void 0?(n=this.generate(r)||"",l.snippet=n):l.flowCodes!==void 0&&r.context.nodeBlock!==void 0&&r.addFlowCodeHierarchy(this,r.context.nodeBlock),n=r.format(n,o,e)}else n=this.generate(r,e)||"";return r.removeChain(this),r.addSequentialNode(this),n}getSerializeChildren(){return J1(this)}serialize(r){const e=this.getSerializeChildren(),i={};for(const{property:n,index:s,childNode:o}of e)s!==void 0?(i[n]===void 0&&(i[n]=Number.isInteger(s)?[]:{}),i[n][s]=o.toJSON(r.meta).uuid):i[n]=o.toJSON(r.meta).uuid;Object.keys(i).length>0&&(r.inputNodes=i)}deserialize(r){if(r.inputNodes!==void 0){const e=r.meta.nodes;for(const i in r.inputNodes)if(Array.isArray(r.inputNodes[i])){const n=[];for(const s of r.inputNodes[i])n.push(e[s]);this[i]=n}else if(typeof r.inputNodes[i]=="object"){const n={};for(const s in r.inputNodes[i]){const o=r.inputNodes[i][s];n[s]=e[o]}this[i]=n}else{const n=r.inputNodes[i];this[i]=e[n]}}}toJSON(r){const{uuid:e,type:i}=this,n=r===void 0||typeof r=="string";n&&(r={textures:{},images:{},nodes:{}});let s=r.nodes[e];s===void 0&&(s={uuid:e,type:i,meta:r,metadata:{version:4.6,type:"Node",generator:"Node.toJSON"}},n!==!0&&(r.nodes[s.uuid]=s),this.serialize(s),delete s.meta);function o(l){const u=[];for(const c in l){const h=l[c];delete h.metadata,u.push(h)}return u}if(n){const l=o(r.textures),u=o(r.images),c=o(r.nodes);l.length>0&&(s.textures=l),u.length>0&&(s.images=u),c.length>0&&(s.nodes=c)}return s}};class fy extends nn{static get type(){return"ArrayElementNode"}constructor(e,i){super(),this.node=e,this.indexNode=i,this.isArrayElementNode=!0}getNodeType(e){return this.node.getElementType(e)}generate(e){const i=this.node.build(e),n=this.indexNode.build(e,"uint");return`${i}[ ${n} ]`}}class c6 extends nn{static get type(){return"ConvertNode"}constructor(e,i){super(),this.node=e,this.convertTo=i}getNodeType(e){const i=this.node.getNodeType(e);let n=null;for(const s of this.convertTo.split("|"))(n===null||e.getTypeLength(i)===e.getTypeLength(s))&&(n=s);return n}serialize(e){super.serialize(e),e.convertTo=this.convertTo}deserialize(e){super.deserialize(e),this.convertTo=e.convertTo}generate(e,i){const n=this.node,s=this.getNodeType(e),o=n.build(e,s);return e.format(o,s,i)}}class ta extends nn{static get type(){return"TempNode"}constructor(e){super(e),this.isTempNode=!0}hasDependencies(e){return e.getDataFromNode(this).usageCount>1}build(e,i){if(e.getBuildStage()==="generate"){const n=e.getVectorType(this.getNodeType(e,i)),s=e.getDataFromNode(this);if(s.propertyName!==void 0)return e.format(s.propertyName,n,i);if(n!=="void"&&i!=="void"&&this.hasDependencies(e)){const o=super.build(e,n),l=e.getVarFromNode(this,null,n),u=e.getPropertyName(l);return e.addLineFlowCode(`${u} = ${o}`,this),s.snippet=o,s.propertyName=u,e.format(s.propertyName,n,i)}}return super.build(e,i)}}class Kue extends ta{static get type(){return"JoinNode"}constructor(e=[],i=null){super(i),this.nodes=e}getNodeType(e){return this.nodeType!==null?e.getVectorType(this.nodeType):e.getTypeFromLength(this.nodes.reduce((i,n)=>i+e.getTypeLength(n.getNodeType(e)),0))}generate(e,i){const n=this.getNodeType(e),s=this.nodes,o=e.getComponentType(n),l=[];for(const c of s){let h=c.build(e);const p=e.getComponentType(c.getNodeType(e));p!==o&&(h=e.format(h,p,o)),l.push(h)}const u=`${e.getType(n)}( ${l.join(", ")} )`;return e.format(u,n,i)}}const Jue=_g.join("");class u6 extends nn{static get type(){return"SplitNode"}constructor(e,i="x"){super(),this.node=e,this.components=i,this.isSplitNode=!0}getVectorLength(){let e=this.components.length;for(const i of this.components)e=Math.max(_g.indexOf(i)+1,e);return e}getComponentType(e){return e.getComponentType(this.node.getNodeType(e))}getNodeType(e){return e.getTypeFromLength(this.components.length,this.getComponentType(e))}generate(e,i){const n=this.node,s=e.getTypeLength(n.getNodeType(e));let o=null;if(s>1){let l=null;this.getVectorLength()>=s&&(l=e.getTypeFromLength(this.getVectorLength(),this.getComponentType(e)));const u=n.build(e,l);this.components.length===s&&this.components===Jue.slice(0,this.components.length)?o=e.format(u,l,i):o=e.format(`${u}.${this.components}`,this.getNodeType(e),i)}else o=n.build(e,i);return o}serialize(e){super.serialize(e),e.components=this.components}deserialize(e){super.deserialize(e),this.components=e.components}}class Zue extends ta{static get type(){return"SetNode"}constructor(e,i,n){super(),this.sourceNode=e,this.components=i,this.targetNode=n}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{sourceNode:i,components:n,targetNode:s}=this,o=this.getNodeType(e),l=e.getTypeFromLength(n.length,s.getNodeType(e)),u=s.build(e,l),c=i.build(e,o),h=e.getTypeLength(o),p=[];for(let f=0;f<h;f++){const m=_g[f];m===n[0]?(p.push(u),f+=n.length-1):p.push(c+"."+m)}return`${e.getType(o)}( ${p.join(", ")} )`}}class $ue extends ta{static get type(){return"FlipNode"}constructor(e,i){super(),this.sourceNode=e,this.components=i}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{components:i,sourceNode:n}=this,s=this.getNodeType(e),o=n.build(e),l=e.getVarFromNode(this),u=e.getPropertyName(l);e.addLineFlowCode(u+" = "+o,this);const c=e.getTypeLength(s),h=[];let p=0;for(let f=0;f<c;f++){const m=_g[f];m===i[p]?(h.push("1.0 - "+(u+"."+m)),p++):h.push(u+"."+m)}return`${e.getType(s)}( ${h.join(", ")} )`}}class S3 extends nn{static get type(){return"InputNode"}constructor(e,i=null){super(i),this.isInputNode=!0,this.value=e,this.precision=null}getNodeType(){return this.nodeType===null?Z1(this.value):this.nodeType}getInputType(e){return this.getNodeType(e)}setPrecision(e){return this.precision=e,this}serialize(e){super.serialize(e),e.value=this.value,this.value&&this.value.toArray&&(e.value=this.value.toArray()),e.valueType=Z1(this.value),e.nodeType=this.nodeType,e.valueType==="ArrayBuffer"&&(e.value=Que(e.value)),e.precision=this.precision}deserialize(e){super.deserialize(e),this.nodeType=e.nodeType,this.value=Array.isArray(e.value)?s6(e.valueType,...e.value):e.value,this.precision=e.precision||null,this.value&&this.value.fromArray&&(this.value=this.value.fromArray(e.value))}generate(){console.warn("Abstract function.")}}class Ju extends S3{static get type(){return"ConstNode"}constructor(e,i=null){super(e,i),this.isConstNode=!0}generateConst(e){return e.generateConst(this.getNodeType(e),this.value)}generate(e,i){const n=this.getNodeType(e);return e.format(this.generateConst(e),n,i)}}let Eg=null;const wg=new Map;function Yt(r,e){if(wg.has(r)){console.warn(`Redefinition of method chaining ${r}`);return}if(typeof e!="function")throw new Error(`Node element ${r} is not a function`);wg.set(r,e)}const h6=r=>r.replace(/r|s/g,"x").replace(/g|t/g,"y").replace(/b|p/g,"z").replace(/a|q/g,"w"),d6=r=>h6(r).split("").sort().join(""),p6={setup(r,e){const i=e.shift();return r(i_(i),...e)},get(r,e,i){if(typeof e=="string"&&r[e]===void 0){if(r.isStackNode!==!0&&e==="assign")return(...n)=>(Eg.assign(i,...n),i);if(wg.has(e)){const n=wg.get(e);return r.isStackNode?(...s)=>i.add(n(...s)):(...s)=>n(i,...s)}else{if(e==="self")return r;if(e.endsWith("Assign")&&wg.has(e.slice(0,e.length-6))){const n=wg.get(e.slice(0,e.length-6));return r.isStackNode?(...s)=>i.assign(s[0],n(...s)):(...s)=>i.assign(n(i,...s))}else{if(/^[xyzwrgbastpq]{1,4}$/.test(e)===!0)return e=h6(e),Ci(new u6(i,e));if(/^set[XYZWRGBASTPQ]{1,4}$/.test(e)===!0)return e=d6(e.slice(3).toLowerCase()),n=>Ci(new Zue(r,e,n));if(/^flip[XYZWRGBASTPQ]{1,4}$/.test(e)===!0)return e=d6(e.slice(4).toLowerCase()),()=>Ci(new $ue(Ci(r),e));if(e==="width"||e==="height"||e==="depth")return e==="width"?e="x":e==="height"?e="y":e==="depth"&&(e="z"),Ci(new u6(r,e));if(/^\d+$/.test(e)===!0)return Ci(new fy(i,new Ju(Number(e),"uint")))}}}return Reflect.get(r,e,i)},set(r,e,i,n){return typeof e=="string"&&r[e]===void 0&&(/^[xyzwrgbastpq]{1,4}$/.test(e)===!0||e==="width"||e==="height"||e==="depth"||/^\d+$/.test(e)===!0)?(n[e].assign(i),!0):Reflect.set(r,e,i,n)}},T3=new WeakMap,f6=new WeakMap,ehe=function(r,e=null){const i=Z1(r);if(i==="node"){let n=T3.get(r);return n===void 0&&(n=new Proxy(r,p6),T3.set(r,n),T3.set(n,n)),n}else{if(e===null&&(i==="float"||i==="boolean")||i&&i!=="shader"&&i!=="string")return Ci(B3(r,e));if(i==="shader")return Vi(r)}return r},the=function(r,e=null){for(const i in r)r[i]=Ci(r[i],e);return r},ihe=function(r,e=null){const i=r.length;for(let n=0;n<i;n++)r[n]=Ci(r[n],e);return r},rhe=function(r,e=null,i=null,n=null){const s=o=>Ci(n!==null?Object.assign(o,n):o);return e===null?(...o)=>s(new r(...Cg(o))):i!==null?(i=Ci(i),(...o)=>s(new r(e,...Cg(o),i))):(...o)=>s(new r(e,...Cg(o)))},nhe=function(r,...e){return Ci(new r(...Cg(e)))};class she extends nn{constructor(e,i){super(),this.shaderNode=e,this.inputNodes=i}getNodeType(e){return this.shaderNode.nodeType||this.getOutputNode(e).getNodeType(e)}call(e){const{shaderNode:i,inputNodes:n}=this,s=e.getNodeProperties(i);if(s.onceOutput)return s.onceOutput;let o=null;if(i.layout){let l=f6.get(e.constructor);l===void 0&&(l=new WeakMap,f6.set(e.constructor,l));let u=l.get(i);u===void 0&&(u=Ci(e.buildFunctionNode(i)),l.set(i,u)),e.currentFunctionNode!==null&&e.currentFunctionNode.includes.push(u),o=Ci(u.call(n))}else{const l=i.jsFunc,u=n!==null?l(n,e):l(e);o=Ci(u)}return i.once&&(s.onceOutput=o),o}getOutputNode(e){const i=e.getNodeProperties(this);return i.outputNode===null&&(i.outputNode=this.setupOutput(e)),i.outputNode}setup(e){return this.getOutputNode(e)}setupOutput(e){return e.addStack(),e.stack.outputNode=this.call(e),e.removeStack()}generate(e,i){return this.getOutputNode(e).build(e,i)}}class ahe extends nn{constructor(e,i){super(i),this.jsFunc=e,this.layout=null,this.global=!0,this.once=!1}setLayout(e){return this.layout=e,this}call(e=null){return i_(e),Ci(new she(this,e))}setup(){return this.call()}}const ohe=[!1,!0],lhe=[0,1,2,3],che=[-1,-2],m6=[.5,1.5,1/3,1e-6,1e6,Math.PI,Math.PI*2,1/Math.PI,2/Math.PI,1/(Math.PI*2),Math.PI/2],M3=new Map;for(const r of ohe)M3.set(r,new Ju(r));const R3=new Map;for(const r of lhe)R3.set(r,new Ju(r,"uint"));const I3=new Map([...R3].map(r=>new Ju(r.value,"int")));for(const r of che)I3.set(r,new Ju(r,"int"));const $1=new Map([...I3].map(r=>new Ju(r.value)));for(const r of m6)$1.set(r,new Ju(r));for(const r of m6)$1.set(-r,new Ju(-r));const e_={bool:M3,uint:R3,ints:I3,float:$1},g6=new Map([...M3,...$1]),B3=(r,e)=>g6.has(r)?g6.get(r):r.isNode===!0?r:new Ju(r,e),uhe=r=>{try{return r.getNodeType()}catch{return}},ia=function(r,e=null){return(...i)=>{if((i.length===0||!["bool","float","int","uint"].includes(r)&&i.every(s=>typeof s!="object"))&&(i=[s6(r,...i)]),i.length===1&&e!==null&&e.has(i[0]))return Ci(e.get(i[0]));if(i.length===1){const s=B3(i[0],r);return uhe(s)===r?Ci(s):Ci(new c6(s,r))}const n=i.map(s=>B3(s));return Ci(new Kue(n,r))}},A6=r=>typeof r=="object"&&r!==null?r.value:r,hhe=r=>r!=null?r.nodeType||r.convertTo||(typeof r=="string"?r:null):null;function t_(r,e){return new Proxy(new ahe(r,e),p6)}const Ci=(r,e=null)=>ehe(r,e),i_=(r,e=null)=>new the(r,e),Cg=(r,e=null)=>new ihe(r,e),li=(...r)=>new rhe(...r),Yi=(...r)=>new nhe(...r),Vi=(r,e)=>{const i=new t_(r,e),n=(...s)=>{let o;return i_(s),s[0]&&s[0].isNode?o=[...s]:o=s[0],i.call(o)};return n.shaderNode=i,n.setLayout=s=>(i.setLayout(s),n),n.once=()=>(i.once=!0,n),n};Yt("toGlobal",r=>(r.global=!0,r));const r_=r=>{Eg=r},y6=()=>Eg,Ga=(...r)=>Eg.If(...r);function dhe(r){return Eg&&Eg.add(r),r}Yt("append",dhe);const phe=new ia("color"),ei=new ia("float",e_.float),ks=new ia("int",e_.ints),fhe=new ia("uint",e_.uint),mhe=new ia("bool",e_.bool),Ki=new ia("vec2"),Zu=new ia("ivec2"),ghe=new ia("uvec2"),Ahe=new ia("bvec2"),Zt=new ia("vec3"),yhe=new ia("ivec3"),vhe=new ia("uvec3"),xhe=new ia("bvec3"),$r=new ia("vec4"),bhe=new ia("ivec4"),_he=new ia("uvec4"),Ehe=new ia("bvec4"),N3=new ia("mat2"),Mo=new ia("mat3"),Sg=new ia("mat4");Yt("toColor",phe),Yt("toFloat",ei),Yt("toInt",ks),Yt("toUint",fhe),Yt("toBool",mhe),Yt("toVec2",Ki),Yt("toIVec2",Zu),Yt("toUVec2",ghe),Yt("toBVec2",Ahe),Yt("toVec3",Zt),Yt("toIVec3",yhe),Yt("toUVec3",vhe),Yt("toBVec3",xhe),Yt("toVec4",$r),Yt("toIVec4",bhe),Yt("toUVec4",_he),Yt("toBVec4",Ehe),Yt("toMat2",N3),Yt("toMat3",Mo),Yt("toMat4",Sg);const whe=li(fy),Che=(r,e)=>Ci(new c6(Ci(r),e));Yt("element",whe),Yt("convert",Che);class v6 extends nn{static get type(){return"UniformGroupNode"}constructor(e,i=!1,n=1){super("string"),this.name=e,this.version=0,this.shared=i,this.order=n,this.isUniformGroup=!0}set needsUpdate(e){e===!0&&this.version++}serialize(e){super.serialize(e),e.name=this.name,e.version=this.version,e.shared=this.shared}deserialize(e){super.deserialize(e),this.name=e.name,this.version=e.version,this.shared=e.shared}}const She=r=>new v6(r),x6=(r,e=0)=>new v6(r,!0,e),The=x6("frame"),Mn=x6("render"),b6=She("object");class my extends S3{static get type(){return"UniformNode"}constructor(e,i=null){super(e,i),this.isUniformNode=!0,this.name="",this.groupNode=b6}label(e){return this.name=e,this}setGroup(e){return this.groupNode=e,this}getGroup(){return this.groupNode}getUniformHash(e){return this.getHash(e)}onUpdate(e,i){const n=this.getSelf();return e=e.bind(n),super.onUpdate(s=>{const o=e(s,n);o!==void 0&&(this.value=o)},i)}generate(e,i){const n=this.getNodeType(e),s=this.getUniformHash(e);let o=e.getNodeFromHash(s);o===void 0&&(e.setHashNode(this,s),o=this);const l=o.getInputType(e),u=e.getUniformFromNode(o,l,e.shaderStage,this.name||e.context.label),c=e.getPropertyName(u);return e.context.label!==void 0&&delete e.context.label,e.format(c,n,i)}}const en=(r,e)=>{const i=hhe(e||r),n=r&&r.isNode===!0?r.node&&r.node.value||r.value:r;return Ci(new my(n,i))};class is extends nn{static get type(){return"PropertyNode"}constructor(e,i=null,n=!1){super(e),this.name=i,this.varying=n,this.isPropertyNode=!0}getHash(e){return this.name||super.getHash(e)}isGlobal(){return!0}generate(e){let i;return this.varying===!0?(i=e.getVaryingFromNode(this,this.name),i.needsInterpolation=!0):i=e.getVarFromNode(this,this.name),e.getPropertyName(i)}}const Tg=(r,e)=>Ci(new is(r,e)),n_=(r,e)=>Ci(new is(r,e,!0)),Yn=Yi(is,"vec4","DiffuseColor"),_6=Yi(is,"vec3","EmissiveColor"),$u=Yi(is,"float","Roughness"),s_=Yi(is,"float","Metalness"),L3=Yi(is,"float","Clearcoat"),a_=Yi(is,"float","ClearcoatRoughness"),Mg=Yi(is,"vec3","Sheen"),D3=Yi(is,"float","SheenRoughness"),O3=Yi(is,"float","Iridescence"),E6=Yi(is,"float","IridescenceIOR"),w6=Yi(is,"float","IridescenceThickness"),P3=Yi(is,"float","AlphaT"),jp=Yi(is,"float","Anisotropy"),o_=Yi(is,"vec3","AnisotropyT"),Rg=Yi(is,"vec3","AnisotropyB"),yl=Yi(is,"color","SpecularColor"),l_=Yi(is,"float","SpecularF90"),k3=Yi(is,"float","Shininess"),Mhe=Yi(is,"vec4","Output"),F3=Yi(is,"float","dashSize"),C6=Yi(is,"float","gapSize"),c_=Yi(is,"float","IOR"),U3=Yi(is,"float","Transmission"),S6=Yi(is,"float","Thickness"),T6=Yi(is,"float","AttenuationDistance"),M6=Yi(is,"color","AttenuationColor"),R6=Yi(is,"float","Dispersion");class Rhe extends ta{static get type(){return"AssignNode"}constructor(e,i){super(),this.targetNode=e,this.sourceNode=i}hasDependencies(){return!1}getNodeType(e,i){return i!=="void"?this.targetNode.getNodeType(e):"void"}needsSplitAssign(e){const{targetNode:i}=this;if(e.isAvailable("swizzleAssign")===!1&&i.isSplitNode&&i.components.length>1){const n=e.getTypeLength(i.node.getNodeType(e));return _g.join("").slice(0,n)!==i.components}return!1}generate(e,i){const{targetNode:n,sourceNode:s}=this,o=this.needsSplitAssign(e),l=n.getNodeType(e),u=n.context({assign:!0}).build(e),c=s.build(e,l),h=s.getNodeType(e),p=e.getDataFromNode(this);let f;if(p.initialized===!0)i!=="void"&&(f=u);else if(o){const m=e.getVarFromNode(this,null,l),g=e.getPropertyName(m);e.addLineFlowCode(`${g} = ${c}`,this);const y=n.node.context({assign:!0}).build(e);for(let x=0;x<n.components.length;x++){const v=n.components[x];e.addLineFlowCode(`${y}.${v} = ${g}[ ${x} ]`,this)}i!=="void"&&(f=u)}else f=`${u} = ${c}`,(i==="void"||h==="void")&&(e.addLineFlowCode(f,this),i!=="void"&&(f=u));return p.initialized=!0,e.format(f,l,i)}}Yt("assign",li(Rhe));class Ihe extends ta{static get type(){return"FunctionCallNode"}constructor(e=null,i={}){super(),this.functionNode=e,this.parameters=i}setParameters(e){return this.parameters=e,this}getParameters(){return this.parameters}getNodeType(e){return this.functionNode.getNodeType(e)}generate(e){const i=[],n=this.functionNode,s=n.getInputs(e),o=this.parameters,l=(u,c)=>{const h=c.type,p=h==="pointer";let f;return p?f="&"+u.build(e):f=u.build(e,h),f};if(Array.isArray(o))for(let u=0;u<o.length;u++)i.push(l(o[u],s[u]));else for(const u of s){const c=o[u.name];if(c!==void 0)i.push(l(c,u));else throw new Error(`FunctionCallNode: Input '${u.name}' not found in FunctionNode.`)}return`${n.build(e,"property")}( ${i.join(", ")} )`}}Yt("call",(r,...e)=>(e=e.length>1||e[0]&&e[0].isNode===!0?Cg(e):i_(e[0]),Ci(new Ihe(Ci(r),e))));class Ss extends ta{static get type(){return"OperatorNode"}constructor(e,i,n,...s){if(super(),s.length>0){let o=new Ss(e,i,n);for(let l=0;l<s.length-1;l++)o=new Ss(e,o,s[l]);i=o,n=s[s.length-1]}this.op=e,this.aNode=i,this.bNode=n}getNodeType(e,i){const n=this.op,s=this.aNode,o=this.bNode,l=s.getNodeType(e),u=typeof o<"u"?o.getNodeType(e):null;if(l==="void"||u==="void")return"void";if(n==="%")return l;if(n==="~"||n==="&"||n==="|"||n==="^"||n===">>"||n==="<<")return e.getIntegerType(l);if(n==="!"||n==="=="||n==="&&"||n==="||"||n==="^^")return"bool";if(n==="<"||n===">"||n==="<="||n===">="){const c=i?e.getTypeLength(i):Math.max(e.getTypeLength(l),e.getTypeLength(u));return c>1?`bvec${c}`:"bool"}else return l==="float"&&e.isMatrix(u)?u:e.isMatrix(l)&&e.isVector(u)?e.getVectorFromMatrix(l):e.isVector(l)&&e.isMatrix(u)?e.getVectorFromMatrix(u):e.getTypeLength(u)>e.getTypeLength(l)?u:l}generate(e,i){const n=this.op,s=this.aNode,o=this.bNode,l=this.getNodeType(e,i);let u=null,c=null;l!=="void"?(u=s.getNodeType(e),c=typeof o<"u"?o.getNodeType(e):null,n==="<"||n===">"||n==="<="||n===">="||n==="=="?e.isVector(u)?c=u:u!==c&&(u=c="float"):n===">>"||n==="<<"?(u=l,c=e.changeComponentType(c,"uint")):e.isMatrix(u)&&e.isVector(c)?c=e.getVectorFromMatrix(u):e.isVector(u)&&e.isMatrix(c)?u=e.getVectorFromMatrix(c):u=c=l):u=c=l;const h=s.build(e,u),p=typeof o<"u"?o.build(e,c):null,f=e.getTypeLength(i),m=e.getFunctionOperator(n);if(i!=="void")return n==="<"&&f>1?e.useComparisonMethod?e.format(`${e.getMethod("lessThan",i)}( ${h}, ${p} )`,l,i):e.format(`( ${h} < ${p} )`,l,i):n==="<="&&f>1?e.useComparisonMethod?e.format(`${e.getMethod("lessThanEqual",i)}( ${h}, ${p} )`,l,i):e.format(`( ${h} <= ${p} )`,l,i):n===">"&&f>1?e.useComparisonMethod?e.format(`${e.getMethod("greaterThan",i)}( ${h}, ${p} )`,l,i):e.format(`( ${h} > ${p} )`,l,i):n===">="&&f>1?e.useComparisonMethod?e.format(`${e.getMethod("greaterThanEqual",i)}( ${h}, ${p} )`,l,i):e.format(`( ${h} >= ${p} )`,l,i):n==="!"||n==="~"?e.format(`(${n}${h})`,u,i):m?e.format(`${m}( ${h}, ${p} )`,l,i):e.format(`( ${h} ${n} ${p} )`,l,i);if(u!=="void")return m?e.format(`${m}( ${h}, ${p} )`,l,i):e.format(`${h} ${n} ${p}`,l,i)}serialize(e){super.serialize(e),e.op=this.op}deserialize(e){super.deserialize(e),this.op=e.op}}const Ro=li(Ss,"+"),vl=li(Ss,"-"),bn=li(Ss,"*"),Ad=li(Ss,"/"),I6=li(Ss,"%"),Bhe=li(Ss,"=="),Nhe=li(Ss,"!="),Lhe=li(Ss,"<"),Dhe=li(Ss,">"),Ohe=li(Ss,"<="),Phe=li(Ss,">="),khe=li(Ss,"&&"),Fhe=li(Ss,"||"),Uhe=li(Ss,"!"),zhe=li(Ss,"^^"),jhe=li(Ss,"&"),Vhe=li(Ss,"~"),Ghe=li(Ss,"|"),Hhe=li(Ss,"^"),Whe=li(Ss,"<<"),Qhe=li(Ss,">>");Yt("add",Ro),Yt("sub",vl),Yt("mul",bn),Yt("div",Ad),Yt("modInt",I6),Yt("equal",Bhe),Yt("notEqual",Nhe),Yt("lessThan",Lhe),Yt("greaterThan",Dhe),Yt("lessThanEqual",Ohe),Yt("greaterThanEqual",Phe),Yt("and",khe),Yt("or",Fhe),Yt("not",Uhe),Yt("xor",zhe),Yt("bitAnd",jhe),Yt("bitNot",Vhe),Yt("bitOr",Ghe),Yt("bitXor",Hhe),Yt("shiftLeft",Whe),Yt("shiftRight",Qhe),Yt("remainder",(...r)=>(console.warn("TSL.OperatorNode: .remainder() has been renamed to .modInt()."),I6(...r)));class _t extends ta{static get type(){return"MathNode"}constructor(e,i,n=null,s=null){super(),this.method=e,this.aNode=i,this.bNode=n,this.cNode=s}getInputType(e){const i=this.aNode.getNodeType(e),n=this.bNode?this.bNode.getNodeType(e):null,s=this.cNode?this.cNode.getNodeType(e):null,o=e.isMatrix(i)?0:e.getTypeLength(i),l=e.isMatrix(n)?0:e.getTypeLength(n),u=e.isMatrix(s)?0:e.getTypeLength(s);return o>l&&o>u?i:l>u?n:u>o?s:i}getNodeType(e){const i=this.method;return i===_t.LENGTH||i===_t.DISTANCE||i===_t.DOT?"float":i===_t.CROSS?"vec3":i===_t.ALL?"bool":i===_t.EQUALS?e.changeComponentType(this.aNode.getNodeType(e),"bool"):i===_t.MOD?this.aNode.getNodeType(e):this.getInputType(e)}generate(e,i){const n=this.method,s=this.getNodeType(e),o=this.getInputType(e),l=this.aNode,u=this.bNode,c=this.cNode,h=e.renderer.isWebGLRenderer===!0;if(n===_t.TRANSFORM_DIRECTION){let p=l,f=u;e.isMatrix(p.getNodeType(e))?f=$r(Zt(f),0):p=$r(Zt(p),0);const m=bn(p,f).xyz;return Ay(m).build(e,i)}else{if(n===_t.NEGATE)return e.format("( - "+l.build(e,o)+" )",s,i);if(n===_t.ONE_MINUS)return vl(1,l).build(e,i);if(n===_t.RECIPROCAL)return Ad(1,l).build(e,i);if(n===_t.DIFFERENCE)return bc(vl(l,u)).build(e,i);{const p=[];return n===_t.CROSS||n===_t.MOD?p.push(l.build(e,s),u.build(e,s)):h&&n===_t.STEP?p.push(l.build(e,e.getTypeLength(l.getNodeType(e))===1?"float":o),u.build(e,o)):h&&(n===_t.MIN||n===_t.MAX)||n===_t.MOD?p.push(l.build(e,o),u.build(e,e.getTypeLength(u.getNodeType(e))===1?"float":o)):n===_t.REFRACT?p.push(l.build(e,o),u.build(e,o),c.build(e,"float")):n===_t.MIX?p.push(l.build(e,o),u.build(e,o),c.build(e,e.getTypeLength(c.getNodeType(e))===1?"float":o)):(p.push(l.build(e,o)),u!==null&&p.push(u.build(e,o)),c!==null&&p.push(c.build(e,o))),e.format(`${e.getMethod(n,s)}( ${p.join(", ")} )`,s,i)}}}serialize(e){super.serialize(e),e.method=this.method}deserialize(e){super.deserialize(e),this.method=e.method}}_t.ALL="all",_t.ANY="any",_t.EQUALS="equals",_t.RADIANS="radians",_t.DEGREES="degrees",_t.EXP="exp",_t.EXP2="exp2",_t.LOG="log",_t.LOG2="log2",_t.SQRT="sqrt",_t.INVERSE_SQRT="inversesqrt",_t.FLOOR="floor",_t.CEIL="ceil",_t.NORMALIZE="normalize",_t.FRACT="fract",_t.SIN="sin",_t.COS="cos",_t.TAN="tan",_t.ASIN="asin",_t.ACOS="acos",_t.ATAN="atan",_t.ABS="abs",_t.SIGN="sign",_t.LENGTH="length",_t.NEGATE="negate",_t.ONE_MINUS="oneMinus",_t.DFDX="dFdx",_t.DFDY="dFdy",_t.ROUND="round",_t.RECIPROCAL="reciprocal",_t.TRUNC="trunc",_t.FWIDTH="fwidth",_t.BITCAST="bitcast",_t.TRANSPOSE="transpose",_t.ATAN2="atan2",_t.MIN="min",_t.MAX="max",_t.MOD="mod",_t.STEP="step",_t.REFLECT="reflect",_t.DISTANCE="distance",_t.DIFFERENCE="difference",_t.DOT="dot",_t.CROSS="cross",_t.POW="pow",_t.TRANSFORM_DIRECTION="transformDirection",_t.MIX="mix",_t.CLAMP="clamp",_t.REFRACT="refract",_t.SMOOTHSTEP="smoothstep",_t.FACEFORWARD="faceforward";const qhe=ei(1e-6),Xhe=ei(Math.PI),B6=li(_t,_t.ALL),Yhe=li(_t,_t.ANY),Khe=li(_t,_t.EQUALS),Jhe=li(_t,_t.RADIANS),Zhe=li(_t,_t.DEGREES),N6=li(_t,_t.EXP),gy=li(_t,_t.EXP2),L6=li(_t,_t.LOG),eh=li(_t,_t.LOG2),z3=li(_t,_t.SQRT),$he=li(_t,_t.INVERSE_SQRT),Vp=li(_t,_t.FLOOR),j3=li(_t,_t.CEIL),Ay=li(_t,_t.NORMALIZE),yd=li(_t,_t.FRACT),xc=li(_t,_t.SIN),vd=li(_t,_t.COS),ede=li(_t,_t.TAN),tde=li(_t,_t.ASIN),ide=li(_t,_t.ACOS),rde=li(_t,_t.ATAN),bc=li(_t,_t.ABS),D6=li(_t,_t.SIGN),xd=li(_t,_t.LENGTH),nde=li(_t,_t.NEGATE),sde=li(_t,_t.ONE_MINUS),O6=li(_t,_t.DFDX),P6=li(_t,_t.DFDY),ade=li(_t,_t.ROUND),ode=li(_t,_t.RECIPROCAL),lde=li(_t,_t.TRUNC),cde=li(_t,_t.FWIDTH);_t.BITCAST;const ude=li(_t,_t.TRANSPOSE),hde=li(_t,_t.ATAN2),yy=li(_t,_t.MIN),kl=li(_t,_t.MAX),k6=li(_t,_t.MOD),F6=li(_t,_t.STEP),dde=li(_t,_t.REFLECT),pde=li(_t,_t.DISTANCE),fde=li(_t,_t.DIFFERENCE),V3=li(_t,_t.DOT),U6=li(_t,_t.CROSS),u_=li(_t,_t.POW),z6=li(_t,_t.POW,2),mde=li(_t,_t.POW,3),gde=li(_t,_t.POW,4),Ade=li(_t,_t.TRANSFORM_DIRECTION),yde=r=>bn(D6(r),u_(bc(r),1/3)),vde=r=>V3(r,r),ys=li(_t,_t.MIX),th=(r,e=0,i=1)=>Ci(new _t(_t.CLAMP,Ci(r),Ci(e),Ci(i))),xde=r=>th(r),j6=li(_t,_t.REFRACT),Gp=li(_t,_t.SMOOTHSTEP),bde=li(_t,_t.FACEFORWARD),_de=Vi(([r])=>{const e=43758.5453,i=V3(r.xy,Ki(12.9898,78.233)),n=k6(i,Xhe);return yd(xc(n).mul(e))}),Ede=(r,e,i)=>ys(e,i,r),wde=(r,e,i)=>Gp(e,i,r);Yt("all",B6),Yt("any",Yhe),Yt("equals",Khe),Yt("radians",Jhe),Yt("degrees",Zhe),Yt("exp",N6),Yt("exp2",gy),Yt("log",L6),Yt("log2",eh),Yt("sqrt",z3),Yt("inverseSqrt",$he),Yt("floor",Vp),Yt("ceil",j3),Yt("normalize",Ay),Yt("fract",yd),Yt("sin",xc),Yt("cos",vd),Yt("tan",ede),Yt("asin",tde),Yt("acos",ide),Yt("atan",rde),Yt("abs",bc),Yt("sign",D6),Yt("length",xd),Yt("lengthSq",vde),Yt("negate",nde),Yt("oneMinus",sde),Yt("dFdx",O6),Yt("dFdy",P6),Yt("round",ade),Yt("reciprocal",ode),Yt("trunc",lde),Yt("fwidth",cde),Yt("atan2",hde),Yt("min",yy),Yt("max",kl),Yt("mod",k6),Yt("step",F6),Yt("reflect",dde),Yt("distance",pde),Yt("dot",V3),Yt("cross",U6),Yt("pow",u_),Yt("pow2",z6),Yt("pow3",mde),Yt("pow4",gde),Yt("transformDirection",Ade),Yt("mix",Ede),Yt("clamp",th),Yt("refract",j6),Yt("smoothstep",wde),Yt("faceForward",bde),Yt("difference",fde),Yt("saturate",xde),Yt("cbrt",yde),Yt("transpose",ude),Yt("rand",_de);class Cde extends nn{static get type(){return"ConditionalNode"}constructor(e,i,n=null){super(),this.condNode=e,this.ifNode=i,this.elseNode=n}getNodeType(e){const i=this.ifNode.getNodeType(e);if(this.elseNode!==null){const n=this.elseNode.getNodeType(e);if(e.getTypeLength(n)>e.getTypeLength(i))return n}return i}setup(e){const i=this.condNode.cache(),n=this.ifNode.cache(),s=this.elseNode?this.elseNode.cache():null,o=e.context.nodeBlock;e.getDataFromNode(n).parentNodeBlock=o,s!==null&&(e.getDataFromNode(s).parentNodeBlock=o);const l=e.getNodeProperties(this);l.condNode=i,l.ifNode=n.context({nodeBlock:n}),l.elseNode=s?s.context({nodeBlock:s}):null}generate(e,i){const n=this.getNodeType(e),s=e.getDataFromNode(this);if(s.nodeProperty!==void 0)return s.nodeProperty;const{condNode:o,ifNode:l,elseNode:u}=e.getNodeProperties(this),c=i!=="void",h=c?Tg(n).build(e):"";s.nodeProperty=h;const p=o.build(e,"bool");e.addFlowCode(`
${e.tab}if ( ${p} ) {

`).addFlowTab();let f=l.build(e,n);if(f&&(c?f=h+" = "+f+";":f="return "+f+";"),e.removeFlowTab().addFlowCode(e.tab+"	"+f+`

`+e.tab+"}"),u!==null){e.addFlowCode(` else {

`).addFlowTab();let m=u.build(e,n);m&&(c?m=h+" = "+m+";":m="return "+m+";"),e.removeFlowTab().addFlowCode(e.tab+"	"+m+`

`+e.tab+`}

`)}else e.addFlowCode(`

`);return e.format(h,n,i)}}const Yo=li(Cde);Yt("select",Yo),Yt("cond",(...r)=>(console.warn("TSL.ConditionalNode: cond() has been renamed to select()."),Yo(...r)));class V6 extends nn{static get type(){return"ContextNode"}constructor(e,i={}){super(),this.isContextNode=!0,this.node=e,this.value=i}getScope(){return this.node.getScope()}getNodeType(e){return this.node.getNodeType(e)}analyze(e){this.node.build(e)}setup(e){const i=e.getContext();e.setContext({...e.context,...this.value});const n=this.node.build(e);return e.setContext(i),n}generate(e,i){const n=e.getContext();e.setContext({...e.context,...this.value});const s=this.node.build(e,i);return e.setContext(n),s}}const G3=li(V6),Sde=(r,e)=>G3(r,{label:e});Yt("context",G3),Yt("label",Sde);class Tde extends nn{static get type(){return"VarNode"}constructor(e,i=null){super(),this.node=e,this.name=i,this.global=!0,this.isVarNode=!0}getHash(e){return this.name||super.getHash(e)}getNodeType(e){return this.node.getNodeType(e)}generate(e){const{node:i,name:n}=this,s=e.getVarFromNode(this,n,e.getVectorType(this.getNodeType(e))),o=e.getPropertyName(s),l=i.build(e,s.type);return e.addLineFlowCode(`${o} = ${l}`,this),o}}const G6=li(Tde);Yt("toVar",(...r)=>G6(...r).append()),Yt("temp",r=>(console.warn('TSL: "temp" is deprecated. Use ".toVar()" instead.'),G6(r)));class Mde extends nn{static get type(){return"VaryingNode"}constructor(e,i=null){super(),this.node=e,this.name=i,this.isVaryingNode=!0}isGlobal(){return!0}getHash(e){return this.name||super.getHash(e)}getNodeType(e){return this.node.getNodeType(e)}setupVarying(e){const i=e.getNodeProperties(this);let n=i.varying;if(n===void 0){const s=this.name,o=this.getNodeType(e);i.varying=n=e.getVaryingFromNode(this,s,o),i.node=this.node}return n.needsInterpolation||(n.needsInterpolation=e.shaderStage==="fragment"),n}setup(e){this.setupVarying(e)}analyze(e){return this.setupVarying(e),this.node.analyze(e)}generate(e){const i=e.getNodeProperties(this),n=this.setupVarying(e);if(i.propertyName===void 0){const s=this.getNodeType(e),o=e.getPropertyName(n,a6.VERTEX);e.flowNodeFromShaderStage(a6.VERTEX,this.node,s,o),i.propertyName=o}return e.getPropertyName(n)}}const ih=li(Mde);Yt("varying",ih);const Rde=Vi(([r])=>{const e=r.mul(.9478672986).add(.0521327014).pow(2.4),i=r.mul(.0773993808),n=r.lessThanEqual(.04045);return ys(e,i,n)}).setLayout({name:"sRGBTransferEOTF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),Ide=Vi(([r])=>{const e=r.pow(.41666).mul(1.055).sub(.055),i=r.mul(12.92),n=r.lessThanEqual(.0031308);return ys(e,i,n)}).setLayout({name:"sRGBTransferOETF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),vy="WorkingColorSpace",H3="OutputColorSpace";class h_ extends ta{static get type(){return"ColorSpaceNode"}constructor(e,i,n){super("vec4"),this.colorNode=e,this.source=i,this.target=n}resolveColorSpace(e,i){return i===vy?$s.workingColorSpace:i===H3?e.context.outputColorSpace||e.renderer.outputColorSpace:i}setup(e){const{colorNode:i}=this,n=this.resolveColorSpace(e,this.source),s=this.resolveColorSpace(e,this.target);let o=i;return $s.enabled===!1||n===s||!n||!s||($s.getTransfer(n)===ty&&(o=$r(Rde(o.rgb),o.a)),$s.getPrimaries(n)!==$s.getPrimaries(s)&&(o=$r(Mo($s._getMatrix(new qo,n,s)).mul(o.rgb),o.a)),$s.getTransfer(s)===ty&&(o=$r(Ide(o.rgb),o.a))),o}}const Bde=r=>Ci(new h_(Ci(r),vy,H3)),Nde=r=>Ci(new h_(Ci(r),H3,vy)),Lde=(r,e)=>Ci(new h_(Ci(r),vy,e)),H6=(r,e)=>Ci(new h_(Ci(r),e,vy));Yt("toOutputColorSpace",Bde),Yt("toWorkingColorSpace",Nde),Yt("workingToColorSpace",Lde),Yt("colorSpaceToWorking",H6);let Dde=class extends fy{static get type(){return"ReferenceElementNode"}constructor(r,e){super(r,e),this.referenceNode=r,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(r){const e=super.generate(r),i=this.referenceNode.getNodeType(),n=this.getNodeType();return r.format(e,i,n)}};class W6 extends nn{static get type(){return"ReferenceBaseNode"}constructor(e,i,n=null,s=null){super(),this.property=e,this.uniformType=i,this.object=n,this.count=s,this.properties=e.split("."),this.reference=n,this.node=null,this.group=null,this.updateType=dn.OBJECT}setGroup(e){return this.group=e,this}element(e){return Ci(new Dde(this,Ci(e)))}setNodeType(e){const i=en(null,e).getSelf();this.group!==null&&i.setGroup(this.group),this.node=i}getNodeType(e){return this.node===null&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}getValueFromReference(e=this.reference){const{properties:i}=this;let n=e[i[0]];for(let s=1;s<i.length;s++)n=n[i[s]];return n}updateReference(e){return this.reference=this.object!==null?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){this.node===null&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}const Ode=(r,e,i)=>Ci(new W6(r,e,i));class Pde extends W6{static get type(){return"RendererReferenceNode"}constructor(e,i,n=null){super(e,i,n),this.renderer=n,this.setGroup(Mn)}updateReference(e){return this.reference=this.renderer!==null?this.renderer:e.renderer,this.reference}}const kde=(r,e,i)=>Ci(new Pde(r,e,i));class Fde extends ta{static get type(){return"ToneMappingNode"}constructor(e,i=zde,n=null){super("vec3"),this.toneMapping=e,this.exposureNode=i,this.colorNode=n}getCacheKey(){return K1(super.getCacheKey(),this.toneMapping)}setup(e){const i=this.colorNode||e.context.color,n=this.toneMapping;if(n===Zm)return i;let s=null;const o=e.renderer.library.getToneMappingFunction(n);return o!==null?s=$r(o(i.rgb,this.exposureNode),i.a):(console.error("ToneMappingNode: Unsupported Tone Mapping configuration.",n),s=i),s}}const Ude=(r,e,i)=>Ci(new Fde(r,Ci(e),Ci(i))),zde=kde("toneMappingExposure","float");Yt("toneMapping",(r,e,i)=>Ude(e,i,r));class jde extends S3{static get type(){return"BufferAttributeNode"}constructor(e,i=null,n=0,s=0){super(e,i),this.isBufferNode=!0,this.bufferType=i,this.bufferStride=n,this.bufferOffset=s,this.usage=I1,this.instanced=!1,this.attribute=null,this.global=!0,e&&e.isBufferAttribute===!0&&(this.attribute=e,this.usage=e.usage,this.instanced=e.isInstancedBufferAttribute)}getHash(e){if(this.bufferStride===0&&this.bufferOffset===0){let i=e.globalCache.getData(this.value);return i===void 0&&(i={node:this},e.globalCache.setData(this.value,i)),i.node.uuid}return this.uuid}getNodeType(e){return this.bufferType===null&&(this.bufferType=e.getTypeFromAttribute(this.attribute)),this.bufferType}setup(e){if(this.attribute!==null)return;const i=this.getNodeType(e),n=this.value,s=e.getTypeLength(i),o=this.bufferStride||s,l=this.bufferOffset,u=n.isInterleavedBuffer===!0?n:new j5(n,o),c=new A3(u,s,l);u.setUsage(this.usage),this.attribute=c,this.attribute.isInstancedBufferAttribute=this.instanced}generate(e){const i=this.getNodeType(e),n=e.getBufferAttributeFromNode(this,i),s=e.getPropertyName(n);let o=null;return e.shaderStage==="vertex"||e.shaderStage==="compute"?(this.name=s,o=s):o=ih(this).build(e,i),o}getInputType(){return"bufferAttribute"}setUsage(e){return this.usage=e,this.attribute&&this.attribute.isBufferAttribute===!0&&(this.attribute.usage=e),this}setInstanced(e){return this.instanced=e,this}}const W3=(r,e,i,n)=>Ci(new jde(r,e,i,n)),Vde=(r,e,i,n)=>W3(r,e,i,n).setUsage(sg),Q6=(r,e,i,n)=>W3(r,e,i,n).setInstanced(!0),q6=(r,e,i,n)=>Vde(r,e,i,n).setInstanced(!0);Yt("toAttribute",r=>W3(r.value));class Gde extends nn{static get type(){return"ComputeNode"}constructor(e,i,n=[64]){super("void"),this.isComputeNode=!0,this.computeNode=e,this.count=i,this.workgroupSize=n,this.dispatchCount=0,this.version=1,this.updateBeforeType=dn.OBJECT,this.onInitFunction=null,this.updateDispatchCount()}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}updateDispatchCount(){const{count:e,workgroupSize:i}=this;let n=i[0];for(let s=1;s<i.length;s++)n*=i[s];this.dispatchCount=Math.ceil(e/n)}onInit(e){return this.onInitFunction=e,this}updateBefore({renderer:e}){e.compute(this)}generate(e){const{shaderStage:i}=e;if(i==="compute"){const n=this.computeNode.build(e,"void");n!==""&&e.addLineFlowCode(n,this)}}}Yt("compute",(r,e,i)=>Ci(new Gde(Ci(r),e,i)));class Hde extends nn{static get type(){return"CacheNode"}constructor(e,i=!0){super(),this.node=e,this.parent=i,this.isCacheNode=!0}getNodeType(e){return this.node.getNodeType(e)}build(e,...i){const n=e.getCache(),s=e.getCacheFromNode(this,this.parent);e.setCache(s);const o=this.node.build(e,...i);return e.setCache(n),o}}const d_=(r,...e)=>Ci(new Hde(Ci(r),...e));Yt("cache",d_);class Wde extends nn{static get type(){return"BypassNode"}constructor(e,i){super(),this.isBypassNode=!0,this.outputNode=e,this.callNode=i}getNodeType(e){return this.outputNode.getNodeType(e)}generate(e){const i=this.callNode.build(e,"void");return i!==""&&e.addLineFlowCode(i,this),this.outputNode.build(e)}}Yt("bypass",li(Wde));class X6 extends nn{static get type(){return"RemapNode"}constructor(e,i,n,s=ei(0),o=ei(1)){super(),this.node=e,this.inLowNode=i,this.inHighNode=n,this.outLowNode=s,this.outHighNode=o,this.doClamp=!0}setup(){const{node:e,inLowNode:i,inHighNode:n,outLowNode:s,outHighNode:o,doClamp:l}=this;let u=e.sub(i).div(n.sub(i));return l===!0&&(u=u.clamp()),u.mul(o.sub(s)).add(s)}}const Qde=li(X6,null,null,{doClamp:!1}),qde=li(X6);Yt("remap",Qde),Yt("remapClamp",qde);class Xde extends nn{static get type(){return"ExpressionNode"}constructor(e="",i="void"){super(i),this.snippet=e}generate(e,i){const n=this.getNodeType(e),s=this.snippet;if(n==="void")e.addLineFlowCode(s,this);else return e.format(`( ${s} )`,n,i)}}const xy=li(Xde);Yt("discard",r=>(r?Yo(r,xy("discard")):xy("discard")).append());class Yde extends ta{static get type(){return"RenderOutputNode"}constructor(e,i,n){super("vec4"),this.colorNode=e,this.toneMapping=i,this.outputColorSpace=n,this.isRenderOutput=!0}setup({context:e}){let i=this.colorNode||e.color;const n=(this.toneMapping!==null?this.toneMapping:e.toneMapping)||Zm,s=(this.outputColorSpace!==null?this.outputColorSpace:e.outputColorSpace)||Bp;return n!==Zm&&(i=i.toneMapping(n)),s!==Bp&&s!==$s.workingColorSpace&&(i=i.workingToColorSpace(s)),i}}Yt("renderOutput",(r,e=null,i=null)=>Ci(new Yde(Ci(r),e,i)));class Kde extends nn{static get type(){return"AttributeNode"}constructor(e,i=null){super(i),this.global=!0,this._attributeName=e}getHash(e){return this.getAttributeName(e)}getNodeType(e){let i=this.nodeType;if(i===null){const n=this.getAttributeName(e);if(e.hasGeometryAttribute(n)){const s=e.geometry.getAttribute(n);i=e.getTypeFromAttribute(s)}else i="float"}return i}setAttributeName(e){return this._attributeName=e,this}getAttributeName(){return this._attributeName}generate(e){const i=this.getAttributeName(e),n=this.getNodeType(e);if(e.hasGeometryAttribute(i)===!0){const s=e.geometry.getAttribute(i),o=e.getTypeFromAttribute(s),l=e.getAttribute(i,o);return e.shaderStage==="vertex"?e.format(l.name,o,n):ih(this).build(e,n)}else return console.warn(`AttributeNode: Vertex attribute "${i}" not found on geometry.`),e.generateConst(n)}serialize(e){super.serialize(e),e.global=this.global,e._attributeName=this._attributeName}deserialize(e){super.deserialize(e),this.global=e.global,this._attributeName=e._attributeName}}const rh=(r,e)=>Ci(new Kde(r,e)),p_=r=>rh("uv"+(r>0?r:""),"vec2");class Jde extends nn{static get type(){return"TextureSizeNode"}constructor(e,i=null){super("uvec2"),this.isTextureSizeNode=!0,this.textureNode=e,this.levelNode=i}generate(e,i){const n=this.textureNode.build(e,"property"),s=this.levelNode===null?"0":this.levelNode.build(e,"int");return e.format(`${e.getMethod("textureDimensions")}( ${n}, ${s} )`,this.getNodeType(e),i)}}const by=li(Jde);class Zde extends my{static get type(){return"MaxMipLevelNode"}constructor(e){super(0),this._textureNode=e,this.updateType=dn.FRAME}get textureNode(){return this._textureNode}get texture(){return this._textureNode.value}update(){const e=this.texture,i=e.images,n=i&&i.length>0?i[0]&&i[0].image||i[0]:e.image;if(n&&n.width!==void 0){const{width:s,height:o}=n;this.value=Math.log2(Math.max(s,o))}}}const $de=li(Zde);class _y extends my{static get type(){return"TextureNode"}constructor(e,i=null,n=null,s=null){super(e),this.isTextureNode=!0,this.uvNode=i,this.levelNode=n,this.biasNode=s,this.compareNode=null,this.depthNode=null,this.gradNode=null,this.sampler=!0,this.updateMatrix=!1,this.updateType=dn.NONE,this.referenceNode=null,this._value=e,this._matrixUniform=null,this.setUpdateMatrix(i===null)}set value(e){this.referenceNode?this.referenceNode.value=e:this._value=e}get value(){return this.referenceNode?this.referenceNode.value:this._value}getUniformHash(){return this.value.uuid}getNodeType(){return this.value.isDepthTexture===!0?"float":this.value.type===ja?"uvec4":this.value.type===wo?"ivec4":"vec4"}getInputType(){return"texture"}getDefaultUV(){return p_(this.value.channel)}updateReference(){return this.value}getTransformedUV(e){return this._matrixUniform===null&&(this._matrixUniform=en(this.value.matrix)),this._matrixUniform.mul(Zt(e,1)).xy}setUpdateMatrix(e){return this.updateMatrix=e,this.updateType=e?dn.FRAME:dn.NONE,this}setupUV(e,i){const n=this.value;return e.isFlipY()&&(n.isRenderTargetTexture===!0||n.isFramebufferTexture===!0||n.isDepthTexture===!0)&&(this.sampler?i=i.flipY():i=i.setY(ks(by(this,this.levelNode).y).sub(i.y).sub(1))),i}setup(e){const i=e.getNodeProperties(this);i.referenceNode=this.referenceNode;let n=this.uvNode;(n===null||e.context.forceUVContext===!0)&&e.context.getUV&&(n=e.context.getUV(this)),n||(n=this.getDefaultUV()),this.updateMatrix===!0&&(n=this.getTransformedUV(n)),n=this.setupUV(e,n);let s=this.levelNode;s===null&&e.context.getTextureLevel&&(s=e.context.getTextureLevel(this)),i.uvNode=n,i.levelNode=s,i.biasNode=this.biasNode,i.compareNode=this.compareNode,i.gradNode=this.gradNode,i.depthNode=this.depthNode}generateUV(e,i){return i.build(e,this.sampler===!0?"vec2":"ivec2")}generateSnippet(e,i,n,s,o,l,u,c){const h=this.value;let p;return s?p=e.generateTextureLevel(h,i,n,s,l):o?p=e.generateTextureBias(h,i,n,o,l):c?p=e.generateTextureGrad(h,i,n,c,l):u?p=e.generateTextureCompare(h,i,n,u,l):this.sampler===!1?p=e.generateTextureLoad(h,i,n,l):p=e.generateTexture(h,i,n,l),p}generate(e,i){const n=e.getNodeProperties(this),s=this.value;if(!s||s.isTexture!==!0)throw new Error("TextureNode: Need a three.js texture.");const o=super.generate(e,"property");if(i==="sampler")return o+"_sampler";if(e.isReference(i))return o;{const l=e.getDataFromNode(this);let u=l.propertyName;if(u===void 0){const{uvNode:p,levelNode:f,biasNode:m,compareNode:g,depthNode:y,gradNode:x}=n,v=this.generateUV(e,p),_=f?f.build(e,"float"):null,T=m?m.build(e,"float"):null,w=y?y.build(e,"int"):null,S=g?g.build(e,"float"):null,R=x?[x[0].build(e,"vec2"),x[1].build(e,"vec2")]:null,B=e.getVarFromNode(this);u=e.getPropertyName(B);const I=this.generateSnippet(e,o,v,_,T,w,S,R);e.addLineFlowCode(`${u} = ${I}`,this),l.snippet=I,l.propertyName=u}let c=u;const h=this.getNodeType(e);return e.needsToWorkingColorSpace(s)&&(c=H6(xy(c,h),s.colorSpace).setup(e).build(e,h)),e.format(c,h,i)}}setSampler(e){return this.sampler=e,this}getSampler(){return this.sampler}uv(e){const i=this.clone();return i.uvNode=Ci(e),i.referenceNode=this.getSelf(),Ci(i)}blur(e){const i=this.clone();return i.biasNode=Ci(e).mul($de(i)),i.referenceNode=this.getSelf(),Ci(i)}level(e){const i=this.clone();return i.levelNode=Ci(e),i.referenceNode=this.getSelf(),Ci(i)}size(e){return by(this,e)}bias(e){const i=this.clone();return i.biasNode=Ci(e),i.referenceNode=this.getSelf(),Ci(i)}compare(e){const i=this.clone();return i.compareNode=Ci(e),i.referenceNode=this.getSelf(),Ci(i)}grad(e,i){const n=this.clone();return n.gradNode=[Ci(e),Ci(i)],n.referenceNode=this.getSelf(),Ci(n)}depth(e){const i=this.clone();return i.depthNode=Ci(e),i.referenceNode=this.getSelf(),Ci(i)}serialize(e){super.serialize(e),e.value=this.value.toJSON(e.meta).uuid,e.sampler=this.sampler,e.updateMatrix=this.updateMatrix,e.updateType=this.updateType}deserialize(e){super.deserialize(e),this.value=e.meta.textures[e.value],this.sampler=e.sampler,this.updateMatrix=e.updateMatrix,this.updateType=e.updateType}update(){const e=this.value,i=this._matrixUniform;i!==null&&(i.value=e.matrix),e.matrixAutoUpdate===!0&&e.updateMatrix()}clone(){const e=new this.constructor(this.value,this.uvNode,this.levelNode,this.biasNode);return e.sampler=this.sampler,e}}const Fs=li(_y),_c=(...r)=>Fs(...r).setSampler(!1),Hp=en("float").label("cameraNear").setGroup(Mn).onRenderUpdate(({camera:r})=>r.near),Wp=en("float").label("cameraFar").setGroup(Mn).onRenderUpdate(({camera:r})=>r.far),f_=en("mat4").label("cameraProjectionMatrix").setGroup(Mn).onRenderUpdate(({camera:r})=>r.projectionMatrix),nh=en("mat4").label("cameraViewMatrix").setGroup(Mn).onRenderUpdate(({camera:r})=>r.matrixWorldInverse),epe=en(new Rt).label("cameraPosition").setGroup(Mn).onRenderUpdate(({camera:r},e)=>e.value.setFromMatrixPosition(r.matrixWorld));class Us extends nn{static get type(){return"Object3DNode"}constructor(e,i=null){super(),this.scope=e,this.object3d=i,this.updateType=dn.OBJECT,this._uniformNode=new my(null)}getNodeType(){const e=this.scope;if(e===Us.WORLD_MATRIX)return"mat4";if(e===Us.POSITION||e===Us.VIEW_POSITION||e===Us.DIRECTION||e===Us.SCALE)return"vec3"}update(e){const i=this.object3d,n=this._uniformNode,s=this.scope;if(s===Us.WORLD_MATRIX)n.value=i.matrixWorld;else if(s===Us.POSITION)n.value=n.value||new Rt,n.value.setFromMatrixPosition(i.matrixWorld);else if(s===Us.SCALE)n.value=n.value||new Rt,n.value.setFromMatrixScale(i.matrixWorld);else if(s===Us.DIRECTION)n.value=n.value||new Rt,i.getWorldDirection(n.value);else if(s===Us.VIEW_POSITION){const o=e.camera;n.value=n.value||new Rt,n.value.setFromMatrixPosition(i.matrixWorld),n.value.applyMatrix4(o.matrixWorldInverse)}}generate(e){const i=this.scope;return i===Us.WORLD_MATRIX?this._uniformNode.nodeType="mat4":(i===Us.POSITION||i===Us.VIEW_POSITION||i===Us.DIRECTION||i===Us.SCALE)&&(this._uniformNode.nodeType="vec3"),this._uniformNode.build(e)}serialize(e){super.serialize(e),e.scope=this.scope}deserialize(e){super.deserialize(e),this.scope=e.scope}}Us.WORLD_MATRIX="worldMatrix",Us.POSITION="position",Us.SCALE="scale",Us.VIEW_POSITION="viewPosition",Us.DIRECTION="direction";class Ig extends Us{static get type(){return"ModelNode"}constructor(e){super(e)}update(e){this.object3d=e.object,super.update(e)}}Ig.DIRECTION;const Qp=Yi(Ig,Ig.WORLD_MATRIX);Ig.POSITION,Ig.SCALE,Ig.VIEW_POSITION;const tpe=en(new qo).onObjectUpdate(({object:r},e)=>e.value.getNormalMatrix(r.matrixWorld)),m_=nh.mul(Qp).toVar("modelViewMatrix"),Y6=rh("position","vec3"),Ha=Y6.varying("positionLocal"),K6=Y6.varying("positionPrevious"),Q3=Qp.mul(Ha).xyz.varying("v_positionWorld"),J6=Ha.transformDirection(Qp).varying("v_positionWorldDirection").normalize().toVar("positionWorldDirection"),Wa=m_.mul(Ha).xyz.varying("v_positionView"),Bs=Wa.negate().varying("v_positionViewDirection").normalize().toVar("positionViewDirection");class ipe extends nn{static get type(){return"FrontFacingNode"}constructor(){super("bool"),this.isFrontFacingNode=!0}generate(e){const{renderer:i,material:n}=e;return i.coordinateSystem===fc&&n.side===pc?"false":e.getFrontFacing()}}const rpe=Yi(ipe),g_=ei(rpe).mul(2).sub(1),Z6=rh("normal","vec3"),Wc=Vi(r=>r.geometry.hasAttribute("normal")===!1?(console.warn('TSL.NormalNode: Vertex attribute "normal" not found on geometry.'),Zt(0,1,0)):Z6,"vec3").once()().toVar("normalLocal"),npe=Wa.dFdx().cross(Wa.dFdy()).normalize().toVar("normalFlat"),Ec=Vi(r=>{let e;return r.material.flatShading===!0?e=npe:e=ih(e8(Wc),"v_normalView").normalize(),e},"vec3").once()().toVar("normalView"),$6=ih(Ec.transformDirection(nh),"v_normalWorld").normalize().toVar("normalWorld"),ra=Vi(r=>r.context.setupNormal(),"vec3").once()().mul(g_).toVar("transformedNormalView"),q3=ra.transformDirection(nh).toVar("transformedNormalWorld"),Ey=Vi(r=>r.context.setupClearcoatNormal(),"vec3").once()().mul(g_).toVar("transformedClearcoatNormalView"),spe=Vi(([r,e=Qp])=>{const i=Mo(e),n=r.div(Zt(i[0].dot(i[0]),i[1].dot(i[1]),i[2].dot(i[2])));return i.mul(n).xyz}),e8=Vi(([r],e)=>{const i=e.renderer.nodes.modelNormalViewMatrix;if(i!==null)return i.transformDirection(r);const n=tpe.mul(r);return nh.transformDirection(n)}),ape=en(0).onReference(({material:r})=>r).onRenderUpdate(({material:r})=>r.refractionRatio),ope=Bs.negate().reflect(ra),lpe=Bs.negate().refract(ra,ape),cpe=ope.transformDirection(nh).toVar("reflectVector"),upe=lpe.transformDirection(nh).toVar("reflectVector");class hpe extends _y{static get type(){return"CubeTextureNode"}constructor(e,i=null,n=null,s=null){super(e,i,n,s),this.isCubeTextureNode=!0}getInputType(){return"cubeTexture"}getDefaultUV(){const e=this.value;return e.mapping===Rp?cpe:e.mapping===$m?upe:(console.error('THREE.CubeTextureNode: Mapping "%s" not supported.',e.mapping),Zt(0,0,0))}setUpdateMatrix(){}setupUV(e,i){const n=this.value;return e.renderer.coordinateSystem===Lp||!n.isRenderTargetTexture?Zt(i.x.negate(),i.yz):i}generateUV(e,i){return i.build(e,"vec3")}}const wy=li(hpe);class t8 extends my{static get type(){return"BufferNode"}constructor(e,i,n=0){super(e,i),this.isBufferNode=!0,this.bufferType=i,this.bufferCount=n}getElementType(e){return this.getNodeType(e)}getInputType(){return"buffer"}}const X3=(r,e,i)=>Ci(new t8(r,e,i));class dpe extends fy{static get type(){return"UniformArrayElementNode"}constructor(e,i){super(e,i),this.isArrayBufferElementNode=!0}generate(e){const i=super.generate(e),n=this.getNodeType();return e.format(i,"vec4",n)}}class ppe extends t8{static get type(){return"UniformArrayNode"}constructor(e,i=null){super(null,"vec4"),this.array=e,this.elementType=i,this._elementType=null,this._elementLength=0,this.updateType=dn.RENDER,this.isArrayBufferNode=!0}getElementType(){return this.elementType||this._elementType}getElementLength(){return this._elementLength}update(){const{array:e,value:i}=this,n=this.getElementLength(),s=this.getElementType();if(n===1)for(let o=0;o<e.length;o++){const l=o*4;i[l]=e[o]}else if(s==="color")for(let o=0;o<e.length;o++){const l=o*4,u=e[o];i[l]=u.r,i[l+1]=u.g,i[l+2]=u.b||0}else for(let o=0;o<e.length;o++){const l=o*4,u=e[o];i[l]=u.x,i[l+1]=u.y,i[l+2]=u.z||0,i[l+3]=u.w||0}}setup(e){const i=this.array.length;this._elementType=this.elementType===null?Z1(this.array[0]):this.elementType,this._elementLength=e.getTypeLength(this._elementType);let n=Float32Array;return this._elementType.charAt(0)==="i"?n=Int32Array:this._elementType.charAt(0)==="u"&&(n=Uint32Array),this.value=new n(i*4),this.bufferCount=i,this.bufferType=e.changeComponentType("vec4",e.getComponentType(this._elementType)),super.setup(e)}element(e){return Ci(new dpe(this,Ci(e)))}}const Cy=(r,e)=>Ci(new ppe(r,e));class fpe extends fy{static get type(){return"ReferenceElementNode"}constructor(e,i){super(e,i),this.referenceNode=e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(e){const i=super.generate(e),n=this.referenceNode.getNodeType(),s=this.getNodeType();return e.format(i,n,s)}}class Y3 extends nn{static get type(){return"ReferenceNode"}constructor(e,i,n=null,s=null){super(),this.property=e,this.uniformType=i,this.object=n,this.count=s,this.properties=e.split("."),this.reference=n,this.node=null,this.group=null,this.name=null,this.updateType=dn.OBJECT}element(e){return Ci(new fpe(this,Ci(e)))}setGroup(e){return this.group=e,this}label(e){return this.name=e,this}setNodeType(e){let i=null;this.count!==null?i=X3(null,e,this.count):Array.isArray(this.getValueFromReference())?i=Cy(null,e):e==="texture"?i=Fs(null):e==="cubeTexture"?i=wy(null):i=en(null,e),this.group!==null&&i.setGroup(this.group),this.name!==null&&i.label(this.name),this.node=i.getSelf()}getNodeType(e){return this.node===null&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}getValueFromReference(e=this.reference){const{properties:i}=this;let n=e[i[0]];for(let s=1;s<i.length;s++)n=n[i[s]];return n}updateReference(e){return this.reference=this.object!==null?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){this.node===null&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}const Ns=(r,e,i)=>Ci(new Y3(r,e,i)),i8=(r,e,i,n)=>Ci(new Y3(r,e,n,i));class mpe extends Y3{static get type(){return"MaterialReferenceNode"}constructor(e,i,n=null){super(e,i,n),this.material=n,this.isMaterialReferenceNode=!0}updateReference(e){return this.reference=this.material!==null?this.material:e.material,this.reference}}const bd=(r,e,i)=>Ci(new mpe(r,e,i)),r8=Vi(r=>(r.geometry.hasAttribute("tangent")===!1&&r.geometry.computeTangents(),rh("tangent","vec4")))(),K3=r8.xyz.toVar("tangentLocal"),n8=m_.mul($r(K3,0)).xyz.varying("v_tangentView").normalize().toVar("tangentView"),gpe=r=>r.mul(r8.w).xyz,Ape=ih(gpe(Ec.cross(n8)),"v_bitangentView").normalize().toVar("bitangentView"),Sy=Mo(n8,Ape,Ec),ype=(()=>{let r=Rg.cross(Bs);return r=r.cross(Rg).normalize(),r=ys(r,ra,jp.mul($u.oneMinus()).oneMinus().pow2().pow2()).normalize(),r})(),vpe=Vi(r=>{const{eye_pos:e,surf_norm:i,mapN:n,uv:s}=r,o=e.dFdx(),l=e.dFdy(),u=s.dFdx(),c=s.dFdy(),h=i,p=l.cross(h),f=h.cross(o),m=p.mul(u.x).add(f.mul(c.x)),g=p.mul(u.y).add(f.mul(c.y)),y=m.dot(m).max(g.dot(g)),x=g_.mul(y.inverseSqrt());return Ro(m.mul(n.x,x),g.mul(n.y,x),h.mul(n.z)).normalize()});class xpe extends ta{static get type(){return"NormalMapNode"}constructor(e,i=null){super("vec3"),this.node=e,this.scaleNode=i,this.normalMapType=ld}setup(e){const{normalMapType:i,scaleNode:n}=this;let s=this.node.mul(2).sub(1);n!==null&&(s=Zt(s.xy.mul(n),s.z));let o=null;return i===Ece?o=e8(s):i===ld&&(e.hasGeometryAttribute("tangent")===!0?o=Sy.mul(s).normalize():o=vpe({eye_pos:Wa,surf_norm:Ec,mapN:s,uv:p_()})),o}}const s8=li(xpe),bpe=Vi(({textureNode:r,bumpScale:e})=>{const i=s=>r.cache().context({getUV:o=>s(o.uvNode||p_()),forceUVContext:!0}),n=ei(i(s=>s));return Ki(ei(i(s=>s.add(s.dFdx()))).sub(n),ei(i(s=>s.add(s.dFdy()))).sub(n)).mul(e)}),_pe=Vi(r=>{const{surf_pos:e,surf_norm:i,dHdxy:n}=r,s=e.dFdx().normalize(),o=e.dFdy().normalize(),l=i,u=o.cross(l),c=l.cross(s),h=s.dot(u).mul(g_),p=h.sign().mul(n.x.mul(u).add(n.y.mul(c)));return h.abs().mul(i).sub(p).normalize()});class Epe extends ta{static get type(){return"BumpMapNode"}constructor(e,i=null){super("vec3"),this.textureNode=e,this.scaleNode=i}setup(){const e=this.scaleNode!==null?this.scaleNode:1,i=bpe({textureNode:this.textureNode,bumpScale:e});return _pe({surf_pos:Wa,surf_norm:Ec,dHdxy:i})}}const wpe=li(Epe),a8=new Map;class Qt extends nn{static get type(){return"MaterialNode"}constructor(e){super(),this.scope=e}getCache(e,i){let n=a8.get(e);return n===void 0&&(n=bd(e,i),a8.set(e,n)),n}getFloat(e){return this.getCache(e,"float")}getColor(e){return this.getCache(e,"color")}getTexture(e){return this.getCache(e==="map"?"map":e+"Map","texture")}setup(e){const i=e.context.material,n=this.scope;let s=null;if(n===Qt.COLOR){const o=i.color!==void 0?this.getColor(n):Zt();i.map&&i.map.isTexture===!0?s=o.mul(this.getTexture("map")):s=o}else if(n===Qt.OPACITY){const o=this.getFloat(n);i.alphaMap&&i.alphaMap.isTexture===!0?s=o.mul(this.getTexture("alpha")):s=o}else if(n===Qt.SPECULAR_STRENGTH)i.specularMap&&i.specularMap.isTexture===!0?s=this.getTexture("specular").r:s=ei(1);else if(n===Qt.SPECULAR_INTENSITY){const o=this.getFloat(n);i.specularMap?s=o.mul(this.getTexture(n).a):s=o}else if(n===Qt.SPECULAR_COLOR){const o=this.getColor(n);i.specularColorMap&&i.specularColorMap.isTexture===!0?s=o.mul(this.getTexture(n).rgb):s=o}else if(n===Qt.ROUGHNESS){const o=this.getFloat(n);i.roughnessMap&&i.roughnessMap.isTexture===!0?s=o.mul(this.getTexture(n).g):s=o}else if(n===Qt.METALNESS){const o=this.getFloat(n);i.metalnessMap&&i.metalnessMap.isTexture===!0?s=o.mul(this.getTexture(n).b):s=o}else if(n===Qt.EMISSIVE){const o=this.getFloat("emissiveIntensity"),l=this.getColor(n).mul(o);i.emissiveMap&&i.emissiveMap.isTexture===!0?s=l.mul(this.getTexture(n)):s=l}else if(n===Qt.NORMAL)i.normalMap?(s=s8(this.getTexture("normal"),this.getCache("normalScale","vec2")),s.normalMapType=i.normalMapType):i.bumpMap?s=wpe(this.getTexture("bump").r,this.getFloat("bumpScale")):s=Ec;else if(n===Qt.CLEARCOAT){const o=this.getFloat(n);i.clearcoatMap&&i.clearcoatMap.isTexture===!0?s=o.mul(this.getTexture(n).r):s=o}else if(n===Qt.CLEARCOAT_ROUGHNESS){const o=this.getFloat(n);i.clearcoatRoughnessMap&&i.clearcoatRoughnessMap.isTexture===!0?s=o.mul(this.getTexture(n).r):s=o}else if(n===Qt.CLEARCOAT_NORMAL)i.clearcoatNormalMap?s=s8(this.getTexture(n),this.getCache(n+"Scale","vec2")):s=Ec;else if(n===Qt.SHEEN){const o=this.getColor("sheenColor").mul(this.getFloat("sheen"));i.sheenColorMap&&i.sheenColorMap.isTexture===!0?s=o.mul(this.getTexture("sheenColor").rgb):s=o}else if(n===Qt.SHEEN_ROUGHNESS){const o=this.getFloat(n);i.sheenRoughnessMap&&i.sheenRoughnessMap.isTexture===!0?s=o.mul(this.getTexture(n).a):s=o,s=s.clamp(.07,1)}else if(n===Qt.ANISOTROPY)if(i.anisotropyMap&&i.anisotropyMap.isTexture===!0){const o=this.getTexture(n);s=N3(Ty.x,Ty.y,Ty.y.negate(),Ty.x).mul(o.rg.mul(2).sub(Ki(1)).normalize().mul(o.b))}else s=Ty;else if(n===Qt.IRIDESCENCE_THICKNESS){const o=Ns("1","float",i.iridescenceThicknessRange);if(i.iridescenceThicknessMap){const l=Ns("0","float",i.iridescenceThicknessRange);s=o.sub(l).mul(this.getTexture(n).g).add(l)}else s=o}else if(n===Qt.TRANSMISSION){const o=this.getFloat(n);i.transmissionMap?s=o.mul(this.getTexture(n).r):s=o}else if(n===Qt.THICKNESS){const o=this.getFloat(n);i.thicknessMap?s=o.mul(this.getTexture(n).g):s=o}else if(n===Qt.IOR)s=this.getFloat(n);else if(n===Qt.LIGHT_MAP)s=this.getTexture(n).rgb.mul(this.getFloat("lightMapIntensity"));else if(n===Qt.AO_MAP)s=this.getTexture(n).r.sub(1).mul(this.getFloat("aoMapIntensity")).add(1);else{const o=this.getNodeType(e);s=this.getCache(n,o)}return s}}Qt.ALPHA_TEST="alphaTest",Qt.COLOR="color",Qt.OPACITY="opacity",Qt.SHININESS="shininess",Qt.SPECULAR="specular",Qt.SPECULAR_STRENGTH="specularStrength",Qt.SPECULAR_INTENSITY="specularIntensity",Qt.SPECULAR_COLOR="specularColor",Qt.REFLECTIVITY="reflectivity",Qt.ROUGHNESS="roughness",Qt.METALNESS="metalness",Qt.NORMAL="normal",Qt.CLEARCOAT="clearcoat",Qt.CLEARCOAT_ROUGHNESS="clearcoatRoughness",Qt.CLEARCOAT_NORMAL="clearcoatNormal",Qt.EMISSIVE="emissive",Qt.ROTATION="rotation",Qt.SHEEN="sheen",Qt.SHEEN_ROUGHNESS="sheenRoughness",Qt.ANISOTROPY="anisotropy",Qt.IRIDESCENCE="iridescence",Qt.IRIDESCENCE_IOR="iridescenceIOR",Qt.IRIDESCENCE_THICKNESS="iridescenceThickness",Qt.IOR="ior",Qt.TRANSMISSION="transmission",Qt.THICKNESS="thickness",Qt.ATTENUATION_DISTANCE="attenuationDistance",Qt.ATTENUATION_COLOR="attenuationColor",Qt.LINE_SCALE="scale",Qt.LINE_DASH_SIZE="dashSize",Qt.LINE_GAP_SIZE="gapSize",Qt.LINE_WIDTH="linewidth",Qt.LINE_DASH_OFFSET="dashOffset",Qt.POINT_WIDTH="pointWidth",Qt.DISPERSION="dispersion",Qt.LIGHT_MAP="light",Qt.AO_MAP="ao";const Cpe=Yi(Qt,Qt.ALPHA_TEST),Spe=Yi(Qt,Qt.COLOR),Tpe=Yi(Qt,Qt.SHININESS),Mpe=Yi(Qt,Qt.EMISSIVE),o8=Yi(Qt,Qt.OPACITY),Rpe=Yi(Qt,Qt.SPECULAR),l8=Yi(Qt,Qt.SPECULAR_INTENSITY),Ipe=Yi(Qt,Qt.SPECULAR_COLOR),A_=Yi(Qt,Qt.SPECULAR_STRENGTH),J3=Yi(Qt,Qt.REFLECTIVITY),Bpe=Yi(Qt,Qt.ROUGHNESS),Npe=Yi(Qt,Qt.METALNESS),Lpe=Yi(Qt,Qt.NORMAL).context({getUV:null}),Dpe=Yi(Qt,Qt.CLEARCOAT),Ope=Yi(Qt,Qt.CLEARCOAT_ROUGHNESS),Ppe=Yi(Qt,Qt.CLEARCOAT_NORMAL).context({getUV:null}),kpe=Yi(Qt,Qt.ROTATION),Fpe=Yi(Qt,Qt.SHEEN),Upe=Yi(Qt,Qt.SHEEN_ROUGHNESS),zpe=Yi(Qt,Qt.ANISOTROPY),jpe=Yi(Qt,Qt.IRIDESCENCE),Vpe=Yi(Qt,Qt.IRIDESCENCE_IOR),Gpe=Yi(Qt,Qt.IRIDESCENCE_THICKNESS),Hpe=Yi(Qt,Qt.TRANSMISSION),Wpe=Yi(Qt,Qt.THICKNESS),Qpe=Yi(Qt,Qt.IOR),qpe=Yi(Qt,Qt.ATTENUATION_DISTANCE),Xpe=Yi(Qt,Qt.ATTENUATION_COLOR),Ype=Yi(Qt,Qt.LINE_SCALE),Kpe=Yi(Qt,Qt.LINE_DASH_SIZE),Jpe=Yi(Qt,Qt.LINE_GAP_SIZE);Qt.LINE_WIDTH,Qt.LINE_DASH_OFFSET,Qt.POINT_WIDTH;const Zpe=Yi(Qt,Qt.DISPERSION),c8=Yi(Qt,Qt.LIGHT_MAP),$pe=Yi(Qt,Qt.AO_MAP),Ty=en(new Pn).onReference(function(r){return r.material}).onRenderUpdate(function({material:r}){this.value.set(r.anisotropy*Math.cos(r.anisotropyRotation),r.anisotropy*Math.sin(r.anisotropyRotation))});class efe extends ta{static get type(){return"ModelViewProjectionNode"}constructor(e=null){super("vec4"),this.positionNode=e}setup(e){if(e.shaderStage==="fragment")return ih(e.context.mvp);const i=this.positionNode||Ha,n=e.renderer.nodes.modelViewMatrix||m_;return f_.mul(n).mul(i)}}const Z3=li(efe);class zs extends nn{static get type(){return"IndexNode"}constructor(e){super("uint"),this.scope=e,this.isInstanceIndexNode=!0}generate(e){const i=this.getNodeType(e),n=this.scope;let s;if(n===zs.VERTEX)s=e.getVertexIndex();else if(n===zs.INSTANCE)s=e.getInstanceIndex();else if(n===zs.DRAW)s=e.getDrawIndex();else if(n===zs.INVOCATION_LOCAL)s=e.getInvocationLocalIndex();else if(n===zs.INVOCATION_SUBGROUP)s=e.getInvocationSubgroupIndex();else if(n===zs.SUBGROUP)s=e.getSubgroupIndex();else throw new Error("THREE.IndexNode: Unknown scope: "+n);let o;return e.shaderStage==="vertex"||e.shaderStage==="compute"?o=s:o=ih(this).build(e,i),o}}zs.VERTEX="vertex",zs.INSTANCE="instance",zs.SUBGROUP="subgroup",zs.INVOCATION_LOCAL="invocationLocal",zs.INVOCATION_SUBGROUP="invocationSubgroup",zs.DRAW="draw";const tfe=Yi(zs,zs.VERTEX),$3=Yi(zs,zs.INSTANCE);zs.SUBGROUP,zs.INVOCATION_SUBGROUP,zs.INVOCATION_LOCAL;const ife=Yi(zs,zs.DRAW);class rfe extends nn{static get type(){return"InstanceNode"}constructor(e){super("void"),this.instanceMesh=e,this.instanceMatrixNode=null,this.instanceColorNode=null,this.updateType=dn.FRAME,this.buffer=null,this.bufferColor=null}setup(e){let i=this.instanceMatrixNode,n=this.instanceColorNode;const s=this.instanceMesh;if(i===null){const u=s.instanceMatrix;if(s.count<=1e3)i=X3(u.array,"mat4",Math.max(s.count,1)).element($3);else{const c=new Vue(u.array,16,1);this.buffer=c;const h=u.usage===sg?q6:Q6,p=[h(c,"vec4",16,0),h(c,"vec4",16,4),h(c,"vec4",16,8),h(c,"vec4",16,12)];i=Sg(...p)}this.instanceMatrixNode=i}const o=s.instanceColor;if(o&&n===null){const u=new Mue(o.array,3),c=o.usage===sg?q6:Q6;this.bufferColor=u,n=Zt(c(u,"vec3",3,0)),this.instanceColorNode=n}const l=i.mul(Ha).xyz;if(Ha.assign(l),e.hasGeometryAttribute("normal")){const u=spe(Wc,i);Wc.assign(u)}this.instanceColorNode!==null&&n_("vec3","vInstanceColor").assign(this.instanceColorNode)}update(){this.instanceMesh.instanceMatrix.usage!==sg&&this.buffer!=null&&this.instanceMesh.instanceMatrix.version!==this.buffer.version&&(this.buffer.version=this.instanceMesh.instanceMatrix.version),this.instanceMesh.instanceColor&&this.instanceMesh.instanceColor.usage!==sg&&this.bufferColor!=null&&this.instanceMesh.instanceColor.version!==this.bufferColor.version&&(this.bufferColor.version=this.instanceMesh.instanceColor.version)}}const nfe=li(rfe);class sfe extends nn{static get type(){return"BatchNode"}constructor(e){super("void"),this.batchMesh=e,this.batchingIdNode=null}setup(e){this.batchingIdNode===null&&(e.getDrawIndex()===null?this.batchingIdNode=$3:this.batchingIdNode=ife);const i=Vi(([g])=>{const y=by(_c(this.batchMesh._indirectTexture),0),x=ks(g).modInt(ks(y)),v=ks(g).div(ks(y));return _c(this.batchMesh._indirectTexture,Zu(x,v)).x}).setLayout({name:"getIndirectIndex",type:"uint",inputs:[{name:"id",type:"int"}]})(ks(this.batchingIdNode)),n=this.batchMesh._matricesTexture,s=by(_c(n),0),o=ei(i).mul(4).toInt().toVar(),l=o.modInt(s),u=o.div(ks(s)),c=Sg(_c(n,Zu(l,u)),_c(n,Zu(l.add(1),u)),_c(n,Zu(l.add(2),u)),_c(n,Zu(l.add(3),u))),h=this.batchMesh._colorsTexture;if(h!==null){const g=Vi(([y])=>{const x=by(_c(h),0).x,v=y,_=v.modInt(x),T=v.div(x);return _c(h,Zu(_,T)).rgb}).setLayout({name:"getBatchingColor",type:"vec3",inputs:[{name:"id",type:"int"}]})(i);n_("vec3","vBatchColor").assign(g)}const p=Mo(c);Ha.assign(c.mul(Ha));const f=Wc.div(Zt(p[0].dot(p[0]),p[1].dot(p[1]),p[2].dot(p[2]))),m=p.mul(f).xyz;Wc.assign(m),e.hasGeometryAttribute("tangent")&&K3.mulAssign(p)}}const afe=li(sfe),u8=new WeakMap;class ofe extends nn{static get type(){return"SkinningNode"}constructor(e,i=!1){super("void"),this.skinnedMesh=e,this.useReference=i,this.updateType=dn.OBJECT,this.skinIndexNode=rh("skinIndex","uvec4"),this.skinWeightNode=rh("skinWeight","vec4");let n,s,o;i?(n=Ns("bindMatrix","mat4"),s=Ns("bindMatrixInverse","mat4"),o=i8("skeleton.boneMatrices","mat4",e.skeleton.bones.length)):(n=en(e.bindMatrix,"mat4"),s=en(e.bindMatrixInverse,"mat4"),o=X3(e.skeleton.boneMatrices,"mat4",e.skeleton.bones.length)),this.bindMatrixNode=n,this.bindMatrixInverseNode=s,this.boneMatricesNode=o,this.previousBoneMatricesNode=null}getSkinnedPosition(e=this.boneMatricesNode,i=Ha){const{skinIndexNode:n,skinWeightNode:s,bindMatrixNode:o,bindMatrixInverseNode:l}=this,u=e.element(n.x),c=e.element(n.y),h=e.element(n.z),p=e.element(n.w),f=o.mul(i),m=Ro(u.mul(s.x).mul(f),c.mul(s.y).mul(f),h.mul(s.z).mul(f),p.mul(s.w).mul(f));return l.mul(m).xyz}getSkinnedNormal(e=this.boneMatricesNode,i=Wc){const{skinIndexNode:n,skinWeightNode:s,bindMatrixNode:o,bindMatrixInverseNode:l}=this,u=e.element(n.x),c=e.element(n.y),h=e.element(n.z),p=e.element(n.w);let f=Ro(s.x.mul(u),s.y.mul(c),s.z.mul(h),s.w.mul(p));return f=l.mul(f).mul(o),f.transformDirection(i).xyz}getPreviousSkinnedPosition(e){const i=e.object;return this.previousBoneMatricesNode===null&&(i.skeleton.previousBoneMatrices=new Float32Array(i.skeleton.boneMatrices),this.previousBoneMatricesNode=i8("skeleton.previousBoneMatrices","mat4",i.skeleton.bones.length)),this.getSkinnedPosition(this.previousBoneMatricesNode,K6)}needsPreviousBoneMatrices(e){const i=e.renderer.getMRT();return i&&i.has("velocity")}setup(e){this.needsPreviousBoneMatrices(e)&&K6.assign(this.getPreviousSkinnedPosition(e));const i=this.getSkinnedPosition();if(Ha.assign(i),e.hasGeometryAttribute("normal")){const n=this.getSkinnedNormal();Wc.assign(n),e.hasGeometryAttribute("tangent")&&K3.assign(n)}}generate(e,i){if(i!=="void")return Ha.build(e,i)}update(e){const i=(this.useReference?e.object:this.skinnedMesh).skeleton;u8.get(i)!==e.frameId&&(u8.set(i,e.frameId),this.previousBoneMatricesNode!==null&&i.previousBoneMatrices.set(i.boneMatrices),i.update())}}const lfe=r=>Ci(new ofe(r,!0));class cfe extends nn{static get type(){return"LoopNode"}constructor(e=[]){super(),this.params=e}getVarName(e){return String.fromCharCode(105+e)}getProperties(e){const i=e.getNodeProperties(this);if(i.stackNode!==void 0)return i;const n={};for(let o=0,l=this.params.length-1;o<l;o++){const u=this.params[o],c=u.isNode!==!0&&u.name||this.getVarName(o),h=u.isNode!==!0&&u.type||"int";n[c]=xy(c,h)}const s=e.addStack();return i.returnsNode=this.params[this.params.length-1](n,s,e),i.stackNode=s,e.removeStack(),i}getNodeType(e){const{returnsNode:i}=this.getProperties(e);return i?i.getNodeType(e):"void"}setup(e){this.getProperties(e)}generate(e){const i=this.getProperties(e),n=this.params,s=i.stackNode;for(let u=0,c=n.length-1;u<c;u++){const h=n[u];let p=null,f=null,m=null,g=null,y=null,x=null;h.isNode?(g="int",m=this.getVarName(u),p="0",f=h.build(e,g),y="<"):(g=h.type||"int",m=h.name||this.getVarName(u),p=h.start,f=h.end,y=h.condition,x=h.update,typeof p=="number"?p=e.generateConst(g,p):p&&p.isNode&&(p=p.build(e,g)),typeof f=="number"?f=e.generateConst(g,f):f&&f.isNode&&(f=f.build(e,g)),p!==void 0&&f===void 0?(p=p+" - 1",f="0",y=">="):f!==void 0&&p===void 0&&(p="0",y="<"),y===void 0&&(Number(p)>Number(f)?y=">=":y="<"));const v={start:p,end:f},_=v.start,T=v.end;let w="",S="",R="";x||(g==="int"||g==="uint"?y.includes("<")?x="++":x="--":y.includes("<")?x="+= 1.":x="-= 1."),w+=e.getVar(g,m)+" = "+_,S+=m+" "+y+" "+T,R+=m+" "+x;const B=`for ( ${w}; ${S}; ${R} )`;e.addFlowCode((u===0?`
`:"")+e.tab+B+` {

`).addFlowTab()}const o=s.build(e,"void"),l=i.returnsNode?i.returnsNode.build(e):"";e.removeFlowTab().addFlowCode(`
`+e.tab+o);for(let u=0,c=this.params.length-1;u<c;u++)e.addFlowCode((u===0?"":e.tab)+`}

`).removeFlowTab();return e.addFlowTab(),l}}const Qc=(...r)=>Ci(new cfe(Cg(r,"int"))).append(),ufe=()=>xy("break").append(),eR=new WeakMap,xl=new es,h8=Vi(({bufferMap:r,influence:e,stride:i,width:n,depth:s,offset:o})=>{const l=ks(tfe).mul(i).add(o),u=l.div(n),c=l.sub(u.mul(n));return _c(r,Zu(c,u)).depth(s).mul(e)});function hfe(r){const e=r.morphAttributes.position!==void 0,i=r.morphAttributes.normal!==void 0,n=r.morphAttributes.color!==void 0,s=r.morphAttributes.position||r.morphAttributes.normal||r.morphAttributes.color,o=s!==void 0?s.length:0;let l=eR.get(r);if(l===void 0||l.count!==o){let u=function(){v.dispose(),eR.delete(r),r.removeEventListener("dispose",u)};l!==void 0&&l.texture.dispose();const c=r.morphAttributes.position||[],h=r.morphAttributes.normal||[],p=r.morphAttributes.color||[];let f=0;e===!0&&(f=1),i===!0&&(f=2),n===!0&&(f=3);let m=r.attributes.position.count*f,g=1;const y=4096;m>y&&(g=Math.ceil(m/y),m=y);const x=new Float32Array(m*g*4*o),v=new lue(x,m,g,o);v.type=fl,v.needsUpdate=!0;const _=f*4;for(let T=0;T<o;T++){const w=c[T],S=h[T],R=p[T],B=m*g*4*T;for(let I=0;I<w.count;I++){const D=I*_;e===!0&&(xl.fromBufferAttribute(w,I),x[B+D+0]=xl.x,x[B+D+1]=xl.y,x[B+D+2]=xl.z,x[B+D+3]=0),i===!0&&(xl.fromBufferAttribute(S,I),x[B+D+4]=xl.x,x[B+D+5]=xl.y,x[B+D+6]=xl.z,x[B+D+7]=0),n===!0&&(xl.fromBufferAttribute(R,I),x[B+D+8]=xl.x,x[B+D+9]=xl.y,x[B+D+10]=xl.z,x[B+D+11]=R.itemSize===4?xl.w:1)}}l={count:o,texture:v,stride:f,size:new Pn(m,g)},eR.set(r,l),r.addEventListener("dispose",u)}return l}class dfe extends nn{static get type(){return"MorphNode"}constructor(e){super("void"),this.mesh=e,this.morphBaseInfluence=en(1),this.updateType=dn.OBJECT}setup(e){const{geometry:i}=e,n=i.morphAttributes.position!==void 0,s=i.hasAttribute("normal")&&i.morphAttributes.normal!==void 0,o=i.morphAttributes.position||i.morphAttributes.normal||i.morphAttributes.color,l=o!==void 0?o.length:0,{texture:u,stride:c,size:h}=hfe(i);n===!0&&Ha.mulAssign(this.morphBaseInfluence),s===!0&&Wc.mulAssign(this.morphBaseInfluence);const p=ks(h.width);Qc(l,({i:f})=>{const m=ei(0).toVar();this.mesh.count>1&&this.mesh.morphTexture!==null&&this.mesh.morphTexture!==void 0?m.assign(_c(this.mesh.morphTexture,Zu(ks(f).add(1),ks($3))).r):m.assign(Ns("morphTargetInfluences","float").element(f).toVar()),n===!0&&Ha.addAssign(h8({bufferMap:u,influence:m,stride:c,width:p,depth:f,offset:ks(0)})),s===!0&&Wc.addAssign(h8({bufferMap:u,influence:m,stride:c,width:p,depth:f,offset:ks(1)}))})}update(){const e=this.morphBaseInfluence;this.mesh.geometry.morphTargetsRelative?e.value=1:e.value=1-this.mesh.morphTargetInfluences.reduce((i,n)=>i+n,0)}}const pfe=li(dfe);class Bg extends nn{static get type(){return"LightingNode"}constructor(){super("vec3"),this.isLightingNode=!0}generate(){console.warn("Abstract function.")}}class ffe extends Bg{static get type(){return"AONode"}constructor(e=null){super(),this.aoNode=e}setup(e){e.context.ambientOcclusion.mulAssign(this.aoNode)}}class mfe extends V6{static get type(){return"LightingContextNode"}constructor(e,i=null,n=null,s=null){super(e),this.lightingModel=i,this.backdropNode=n,this.backdropAlphaNode=s,this._value=null}getContext(){const{backdropNode:e,backdropAlphaNode:i}=this,n=Zt().toVar("directDiffuse"),s=Zt().toVar("directSpecular"),o=Zt().toVar("indirectDiffuse"),l=Zt().toVar("indirectSpecular"),u={directDiffuse:n,directSpecular:s,indirectDiffuse:o,indirectSpecular:l};return{radiance:Zt().toVar("radiance"),irradiance:Zt().toVar("irradiance"),iblIrradiance:Zt().toVar("iblIrradiance"),ambientOcclusion:ei(1).toVar("ambientOcclusion"),reflectedLight:u,backdrop:e,backdropAlpha:i}}setup(e){return this.value=this._value||(this._value=this.getContext()),this.value.lightingModel=this.lightingModel||e.context.lightingModel,super.setup(e)}}const gfe=li(mfe);class Afe extends Bg{static get type(){return"IrradianceNode"}constructor(e){super(),this.node=e}setup(e){e.context.irradiance.addAssign(this.node)}}let My,Ry;class na extends nn{static get type(){return"ScreenNode"}constructor(e){super(),this.scope=e,this.isViewportNode=!0}getNodeType(){return this.scope===na.VIEWPORT?"vec4":"vec2"}getUpdateType(){let e=dn.NONE;return(this.scope===na.SIZE||this.scope===na.VIEWPORT)&&(e=dn.RENDER),this.updateType=e,e}update({renderer:e}){const i=e.getRenderTarget();this.scope===na.VIEWPORT?i!==null?Ry.copy(i.viewport):(e.getViewport(Ry),Ry.multiplyScalar(e.getPixelRatio())):i!==null?(My.width=i.width,My.height=i.height):e.getDrawingBufferSize(My)}setup(){const e=this.scope;let i=null;return e===na.SIZE?i=en(My||(My=new Pn)):e===na.VIEWPORT?i=en(Ry||(Ry=new es)):i=Ki(iR.div(tR)),i}generate(e){if(this.scope===na.COORDINATE){let i=e.getFragCoord();if(e.isFlipY()){const n=e.getNodeProperties(tR).outputNode.build(e);i=`${e.getType("vec2")}( ${i}.x, ${n}.y - ${i}.y )`}return i}return super.generate(e)}}na.COORDINATE="coordinate",na.VIEWPORT="viewport",na.SIZE="size",na.UV="uv";const Iy=Yi(na,na.UV),tR=Yi(na,na.SIZE),iR=Yi(na,na.COORDINATE),d8=Yi(na,na.VIEWPORT);d8.zw,d8.xy;const By=new Pn;class p8 extends _y{static get type(){return"ViewportTextureNode"}constructor(e=Iy,i=null,n=null){n===null&&(n=new Bue,n.minFilter=Uu),super(n,e,i),this.generateMipmaps=!1,this.isOutputTextureNode=!0,this.updateBeforeType=dn.FRAME}updateBefore(e){const i=e.renderer;i.getDrawingBufferSize(By);const n=this.value;(n.image.width!==By.width||n.image.height!==By.height)&&(n.image.width=By.width,n.image.height=By.height,n.needsUpdate=!0);const s=n.generateMipmaps;n.generateMipmaps=this.generateMipmaps,i.copyFramebufferToTexture(n),n.generateMipmaps=s}clone(){const e=new this.constructor(this.uvNode,this.levelNode,this.value);return e.generateMipmaps=this.generateMipmaps,e}}const f8=li(p8,null,null,{generateMipmaps:!0});let rR=null;class yfe extends p8{static get type(){return"ViewportDepthTextureNode"}constructor(e=Iy,i=null){rR===null&&(rR=new bg),super(e,i,rR)}}const vfe=li(yfe);class Ko extends nn{static get type(){return"ViewportDepthNode"}constructor(e,i=null){super("float"),this.scope=e,this.valueNode=i,this.isViewportDepthNode=!0}generate(e){const{scope:i}=this;return i===Ko.DEPTH_BASE?e.getFragDepth():super.generate(e)}setup({camera:e}){const{scope:i}=this,n=this.valueNode;let s=null;if(i===Ko.DEPTH_BASE)n!==null&&(s=A8().assign(n));else if(i===Ko.DEPTH)e.isPerspectiveCamera?s=xfe(Wa.z,Hp,Wp):s=Ny(Wa.z,Hp,Wp);else if(i===Ko.LINEAR_DEPTH)if(n!==null)if(e.isPerspectiveCamera){const o=m8(n,Hp,Wp);s=Ny(o,Hp,Wp)}else s=n;else s=Ny(Wa.z,Hp,Wp);return s}}Ko.DEPTH_BASE="depthBase",Ko.DEPTH="depth",Ko.LINEAR_DEPTH="linearDepth";const Ny=(r,e,i)=>r.add(e).div(e.sub(i)),xfe=(r,e,i)=>e.add(r).mul(i).div(i.sub(e).mul(r)),m8=(r,e,i)=>e.mul(i).div(i.sub(e).mul(r).sub(i)),g8=(r,e,i)=>{e=e.max(1e-6).toVar();const n=eh(r.div(e).add(1)),s=eh(i.div(e).add(1));return n.div(s)},A8=li(Ko,Ko.DEPTH_BASE),y8=Yi(Ko,Ko.DEPTH);Ko.LINEAR_DEPTH,vfe(),y8.assign=r=>A8(r);class _d extends nn{static get type(){return"ClippingNode"}constructor(e=_d.DEFAULT){super(),this.scope=e}setup(e){super.setup(e);const i=e.clippingContext,{localClipIntersection:n,localClippingCount:s,globalClippingCount:o}=i,l=o+s,u=n?l-s:l;return this.scope===_d.ALPHA_TO_COVERAGE?this.setupAlphaToCoverage(i.planes,l,u):this.setupDefault(i.planes,l,u)}setupAlphaToCoverage(e,i,n){return Vi(()=>{const s=Cy(e),o=Tg("float","distanceToPlane"),l=Tg("float","distanceToGradient"),u=Tg("float","clipOpacity");u.assign(1);let c;if(Qc(n,({i:h})=>{c=s.element(h),o.assign(Wa.dot(c.xyz).negate().add(c.w)),l.assign(o.fwidth().div(2)),u.mulAssign(Gp(l.negate(),l,o)),u.equal(0).discard()}),n<i){const h=Tg("float","unionclipOpacity");h.assign(1),Qc({start:n,end:i},({i:p})=>{c=s.element(p),o.assign(Wa.dot(c.xyz).negate().add(c.w)),l.assign(o.fwidth().div(2)),h.mulAssign(Gp(l.negate(),l,o).oneMinus())}),u.mulAssign(h.oneMinus())}Yn.a.mulAssign(u),Yn.a.equal(0).discard()})()}setupDefault(e,i,n){return Vi(()=>{const s=Cy(e);let o;if(Qc(n,({i:l})=>{o=s.element(l),Wa.dot(o.xyz).greaterThan(o.w).discard()}),n<i){const l=Tg("bool","clipped");l.assign(!0),Qc({start:n,end:i},({i:u})=>{o=s.element(u),l.assign(Wa.dot(o.xyz).greaterThan(o.w).and(l))}),l.discard()}})()}}_d.ALPHA_TO_COVERAGE="alphaToCoverage",_d.DEFAULT="default";const bfe=()=>Ci(new _d),_fe=()=>Ci(new _d(_d.ALPHA_TO_COVERAGE)),Efe=.05,v8=Vi(([r])=>yd(bn(1e4,xc(bn(17,r.x).add(bn(.1,r.y)))).mul(Ro(.1,bc(xc(bn(13,r.y).add(r.x))))))),x8=Vi(([r])=>v8(Ki(v8(r.xy),r.z))),wfe=Vi(([r])=>{const e=kl(xd(O6(r.xyz)),xd(P6(r.xyz))).toVar("maxDeriv"),i=ei(1).div(ei(Efe).mul(e)).toVar("pixScale"),n=Ki(gy(Vp(eh(i))),gy(j3(eh(i)))).toVar("pixScales"),s=Ki(x8(Vp(n.x.mul(r.xyz))),x8(Vp(n.y.mul(r.xyz)))).toVar("alpha"),o=yd(eh(i)).toVar("lerpFactor"),l=Ro(bn(o.oneMinus(),s.x),bn(o,s.y)).toVar("x"),u=yy(o,o.oneMinus()).toVar("a"),c=Zt(l.mul(l).div(bn(2,u).mul(vl(1,u))),l.sub(bn(.5,u)).div(vl(1,u)),vl(1,vl(1,l).mul(vl(1,l)).div(bn(2,u).mul(vl(1,u))))).toVar("cases"),h=l.lessThan(u.oneMinus()).select(l.lessThan(u).select(c.x,c.y),c.z);return th(h,1e-6,1)});class sa extends Xo{static get type(){return"NodeMaterial"}constructor(){super(),this.isNodeMaterial=!0,this.type=this.constructor.type,this.forceSinglePass=!1,this.fog=!0,this.lights=!1,this.lightsNode=null,this.envNode=null,this.aoNode=null,this.colorNode=null,this.normalNode=null,this.opacityNode=null,this.backdropNode=null,this.backdropAlphaNode=null,this.alphaTestNode=null,this.positionNode=null,this.geometryNode=null,this.depthNode=null,this.shadowNode=null,this.shadowPositionNode=null,this.outputNode=null,this.mrtNode=null,this.fragmentNode=null,this.vertexNode=null}customProgramCacheKey(){return this.type+n6(this)}build(e){this.setup(e)}setupObserver(e){return new Hue(e)}setup(e){e.context.setupNormal=()=>this.setupNormal(e),e.addStack(),e.stack.outputNode=this.vertexNode||this.setupPosition(e),this.geometryNode!==null&&(e.stack.outputNode=e.stack.outputNode.bypass(this.geometryNode)),e.addFlow("vertex",e.removeStack()),e.addStack();let i;const n=this.setupClipping(e);if(this.depthWrite===!0&&this.setupDepth(e),this.fragmentNode===null){this.setupDiffuseColor(e),this.setupVariants(e);const s=this.setupLighting(e);n!==null&&e.stack.add(n);const o=$r(s,Yn.a).max(0);if(i=this.setupOutput(e,o),Mhe.assign(i),this.outputNode!==null&&(i=this.outputNode),e.renderer.getRenderTarget()!==null){const l=e.renderer.getMRT(),u=this.mrtNode;l!==null?(i=l,u!==null&&(i=l.merge(u))):u!==null&&(i=u)}}else{let s=this.fragmentNode;s.isOutputStructNode!==!0&&(s=$r(s)),i=this.setupOutput(e,s)}e.stack.outputNode=i,e.addFlow("fragment",e.removeStack()),e.monitor=this.setupObserver(e)}setupClipping(e){if(e.clippingContext===null)return null;const{globalClippingCount:i,localClippingCount:n}=e.clippingContext;let s=null;if(i||n){const o=e.renderer.samples;this.alphaToCoverage&&o>1?s=_fe():e.stack.add(bfe())}return s}setupDepth(e){const{renderer:i,camera:n}=e;let s=this.depthNode;if(s===null){const o=i.getMRT();o&&o.has("depth")?s=o.get("depth"):i.logarithmicDepthBuffer===!0&&(n.isPerspectiveCamera?s=g8(Z3().w,Hp,Wp):s=Ny(Wa.z,Hp,Wp))}s!==null&&y8.assign(s).append()}setupPosition(e){const{object:i}=e,n=i.geometry;if(e.addStack(),(n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color)&&pfe(i).append(),i.isSkinnedMesh===!0&&lfe(i).append(),this.displacementMap){const o=bd("displacementMap","texture"),l=bd("displacementScale","float"),u=bd("displacementBias","float");Ha.addAssign(Wc.normalize().mul(o.x.mul(l).add(u)))}i.isBatchedMesh&&afe(i).append(),i.instanceMatrix&&i.instanceMatrix.isInstancedBufferAttribute===!0&&nfe(i).append(),this.positionNode!==null&&Ha.assign(this.positionNode);const s=Z3();return e.context.vertex=e.removeStack(),e.context.mvp=s,s}setupDiffuseColor({object:e,geometry:i}){let n=this.colorNode?$r(this.colorNode):Spe;this.vertexColors===!0&&i.hasAttribute("color")&&(n=$r(n.xyz.mul(rh("color","vec3")),n.a)),e.instanceColor&&(n=n_("vec3","vInstanceColor").mul(n)),e.isBatchedMesh&&e._colorsTexture&&(n=n_("vec3","vBatchColor").mul(n)),Yn.assign(n);const s=this.opacityNode?ei(this.opacityNode):o8;if(Yn.a.assign(Yn.a.mul(s)),this.alphaTestNode!==null||this.alphaTest>0){const o=this.alphaTestNode!==null?ei(this.alphaTestNode):Cpe;Yn.a.lessThanEqual(o).discard()}this.alphaHash===!0&&Yn.a.lessThan(wfe(Ha)).discard(),this.transparent===!1&&this.blending===sd&&this.alphaToCoverage===!1&&Yn.a.assign(1)}setupVariants(){}setupOutgoingLight(){return this.lights===!0?Zt(0):Yn.rgb}setupNormal(){return this.normalNode?Zt(this.normalNode):Lpe}setupEnvironment(){let e=null;return this.envNode?e=this.envNode:this.envMap&&(e=this.envMap.isCubeTexture?bd("envMap","cubeTexture"):bd("envMap","texture")),e}setupLightMap(e){let i=null;return e.material.lightMap&&(i=new Afe(c8)),i}setupLights(e){const i=[],n=this.setupEnvironment(e);n&&n.isLightingNode&&i.push(n);const s=this.setupLightMap(e);if(s&&s.isLightingNode&&i.push(s),this.aoNode!==null||e.material.aoMap){const l=this.aoNode!==null?this.aoNode:$pe;i.push(new ffe(l))}let o=this.lightsNode||e.lightsNode;return i.length>0&&(o=e.renderer.lighting.createNode([...o.getLights(),...i])),o}setupLightingModel(){}setupLighting(e){const{material:i}=e,{backdropNode:n,backdropAlphaNode:s,emissiveNode:o}=this,l=this.lights===!0||this.lightsNode!==null?this.setupLights(e):null;let u=this.setupOutgoingLight(e);if(l&&l.getScope().hasLights){const c=this.setupLightingModel(e);u=gfe(l,c,n,s)}else n!==null&&(u=Zt(s!==null?ys(u,n,s):n));return(o&&o.isNode===!0||i.emissive&&i.emissive.isColor===!0)&&(_6.assign(Zt(o||Mpe)),u=u.add(_6)),u}setupOutput(e,i){if(this.fog===!0){const n=e.fogNode;n&&(i=$r(n.mix(i.rgb,n.colorNode),i.a))}return i}setDefaultValues(e){for(const n in e){const s=e[n];this[n]===void 0&&(this[n]=s,s&&s.clone&&(this[n]=s.clone()))}const i=Object.getOwnPropertyDescriptors(e.constructor.prototype);for(const n in i)Object.getOwnPropertyDescriptor(this.constructor.prototype,n)===void 0&&i[n].get!==void 0&&Object.defineProperty(this.constructor.prototype,n,i[n])}toJSON(e){const i=e===void 0||typeof e=="string";i&&(e={textures:{},images:{},nodes:{}});const n=Xo.prototype.toJSON.call(this,e),s=J1(this);n.inputNodes={};for(const{property:l,childNode:u}of s)n.inputNodes[l]=u.toJSON(e).uuid;function o(l){const u=[];for(const c in l){const h=l[c];delete h.metadata,u.push(h)}return u}if(i){const l=o(e.textures),u=o(e.images),c=o(e.nodes);l.length>0&&(n.textures=l),u.length>0&&(n.images=u),c.length>0&&(n.nodes=c)}return n}copy(e){return this.lightsNode=e.lightsNode,this.envNode=e.envNode,this.colorNode=e.colorNode,this.normalNode=e.normalNode,this.opacityNode=e.opacityNode,this.backdropNode=e.backdropNode,this.backdropAlphaNode=e.backdropAlphaNode,this.alphaTestNode=e.alphaTestNode,this.positionNode=e.positionNode,this.geometryNode=e.geometryNode,this.depthNode=e.depthNode,this.shadowNode=e.shadowNode,this.shadowPositionNode=e.shadowPositionNode,this.outputNode=e.outputNode,this.mrtNode=e.mrtNode,this.fragmentNode=e.fragmentNode,this.vertexNode=e.vertexNode,super.copy(e)}}const Cfe=new v3;class Sfe extends sa{static get type(){return"LineBasicNodeMaterial"}constructor(e){super(),this.isLineBasicNodeMaterial=!0,this.lights=!1,this.setDefaultValues(Cfe),this.setValues(e)}}const Tfe=new Z5;class Mfe extends sa{static get type(){return"LineDashedNodeMaterial"}constructor(e){super(),this.isLineDashedNodeMaterial=!0,this.lights=!1,this.setDefaultValues(Tfe),this.offsetNode=null,this.dashScaleNode=null,this.dashSizeNode=null,this.gapSizeNode=null,this.setValues(e)}setupVariants(){const e=this.offsetNode,i=this.dashScaleNode?ei(this.dashScaleNode):Ype,n=this.dashSizeNode?ei(this.dashSizeNode):Kpe,s=this.dashSizeNode?ei(this.dashGapNode):Jpe;F3.assign(n),C6.assign(s);const o=ih(rh("lineDistance").mul(i));(e?o.add(e):o).mod(F3.add(C6)).greaterThan(F3).discard()}}const Rfe=r=>Ci(r).mul(.5).add(.5),Ife=new Y5;class Bfe extends sa{static get type(){return"MeshNormalNodeMaterial"}constructor(e){super(),this.lights=!1,this.isMeshNormalNodeMaterial=!0,this.setDefaultValues(Ife),this.setValues(e)}setupDiffuseColor(){const e=this.opacityNode?ei(this.opacityNode):o8;Yn.assign($r(Rfe(ra),e))}}class Nfe extends ta{static get type(){return"EquirectUVNode"}constructor(e=J6){super("vec2"),this.dirNode=e}setup(){const e=this.dirNode,i=e.z.atan2(e.x).mul(1/(Math.PI*2)).add(.5),n=e.y.clamp(-1,1).asin().mul(1/Math.PI).add(.5);return Ki(i,n)}}const b8=li(Nfe);class _8 extends Sue{constructor(e=1,i={}){super(e,i),this.isCubeRenderTarget=!0}fromEquirectangularTexture(e,i){const n=i.minFilter,s=i.generateMipmaps;i.generateMipmaps=!0,this.texture.type=i.type,this.texture.colorSpace=i.colorSpace,this.texture.generateMipmaps=i.generateMipmaps,this.texture.minFilter=i.minFilter,this.texture.magFilter=i.magFilter;const o=new hy(5,5,5),l=b8(J6),u=new sa;u.colorNode=Fs(i,l,0),u.side=pc,u.blending=Jm;const c=new Fp(o,u),h=new z5;h.add(c),i.minFilter===Uu&&(i.minFilter=pl);const p=new U5(1,10,this),f=e.getMRT();return e.setMRT(null),p.update(e,h),e.setMRT(f),i.minFilter=n,i.currentGenerateMipmaps=s,c.geometry.dispose(),c.material.dispose(),this}}const Ly=new WeakMap;class Lfe extends ta{static get type(){return"CubeMapNode"}constructor(e){super("vec3"),this.envNode=e,this._cubeTexture=null,this._cubeTextureNode=wy();const i=new g3;i.isRenderTargetTexture=!0,this._defaultTexture=i,this.updateBeforeType=dn.RENDER}updateBefore(e){const{renderer:i,material:n}=e,s=this.envNode;if(s.isTextureNode||s.isMaterialReferenceNode){const o=s.isTextureNode?s.value:n[s.property];if(o&&o.isTexture){const l=o.mapping;if(l===YA||l===KA){if(Ly.has(o)){const u=Ly.get(o);w8(u,o.mapping),this._cubeTexture=u}else{const u=o.image;if(Dfe(u)){const c=new _8(u.height);c.fromEquirectangularTexture(i,o),w8(c.texture,o.mapping),this._cubeTexture=c.texture,Ly.set(o,c.texture),o.addEventListener("dispose",E8)}else this._cubeTexture=this._defaultTexture}this._cubeTextureNode.value=this._cubeTexture}else this._cubeTextureNode=this.envNode}}}setup(e){return this.updateBefore(e),this._cubeTextureNode}}function Dfe(r){return r==null?!1:r.height>0}function E8(r){const e=r.target;e.removeEventListener("dispose",E8);const i=Ly.get(e);i!==void 0&&(Ly.delete(e),i.dispose())}function w8(r,e){e===YA?r.mapping=Rp:e===KA&&(r.mapping=$m)}const C8=li(Lfe);class nR extends Bg{static get type(){return"BasicEnvironmentNode"}constructor(e=null){super(),this.envNode=e}setup(e){e.context.environment=C8(this.envNode)}}class Ofe extends Bg{static get type(){return"BasicLightMapNode"}constructor(e=null){super(),this.lightMapNode=e}setup(e){const i=ei(1/Math.PI);e.context.irradianceLightMap=this.lightMapNode.mul(i)}}class y_{start(){}finish(){}direct(){}directRectArea(){}indirect(){}ambientOcclusion(){}}class S8 extends y_{constructor(){super()}indirect(e,i,n){const s=e.ambientOcclusion,o=e.reflectedLight,l=n.context.irradianceLightMap;o.indirectDiffuse.assign($r(0)),l?o.indirectDiffuse.addAssign(l):o.indirectDiffuse.addAssign($r(1,1,1,0)),o.indirectDiffuse.mulAssign(s),o.indirectDiffuse.mulAssign(Yn.rgb)}finish(e,i,n){const s=n.material,o=e.outgoingLight,l=n.context.environment;if(l)switch(s.combine){case w1:o.rgb.assign(ys(o.rgb,o.rgb.mul(l.rgb),A_.mul(J3)));break;case lce:o.rgb.assign(ys(o.rgb,l.rgb,A_.mul(J3)));break;case cce:o.rgb.addAssign(l.rgb.mul(A_.mul(J3)));break;default:console.warn("THREE.BasicLightingModel: Unsupported .combine value:",s.combine);break}}}const Pfe=new U1;class kfe extends sa{static get type(){return"MeshBasicNodeMaterial"}constructor(e){super(),this.isMeshBasicNodeMaterial=!0,this.lights=!0,this.setDefaultValues(Pfe),this.setValues(e)}setupNormal(){return Ec}setupEnvironment(e){const i=super.setupEnvironment(e);return i?new nR(i):null}setupLightMap(e){let i=null;return e.material.lightMap&&(i=new Ofe(c8)),i}setupOutgoingLight(){return Yn.rgb}setupLightingModel(){return new S8}}const Dy=Vi(({f0:r,f90:e,dotVH:i})=>{const n=i.mul(-5.55473).sub(6.98316).mul(i).exp2();return r.mul(n.oneMinus()).add(e.mul(n))}),Ng=Vi(r=>r.diffuseColor.mul(1/Math.PI)),Ffe=()=>ei(.25),Ufe=Vi(({dotNH:r})=>k3.mul(ei(.5)).add(1).mul(ei(1/Math.PI)).mul(r.pow(k3))),zfe=Vi(({lightDirection:r})=>{const e=r.add(Bs).normalize(),i=ra.dot(e).clamp(),n=Bs.dot(e).clamp(),s=Dy({f0:yl,f90:1,dotVH:n}),o=Ffe(),l=Ufe({dotNH:i});return s.mul(o).mul(l)});class T8 extends S8{constructor(e=!0){super(),this.specular=e}direct({lightDirection:e,lightColor:i,reflectedLight:n}){const s=ra.dot(e).clamp().mul(i);n.directDiffuse.addAssign(s.mul(Ng({diffuseColor:Yn.rgb}))),this.specular===!0&&n.directSpecular.addAssign(s.mul(zfe({lightDirection:e})).mul(A_))}indirect({ambientOcclusion:e,irradiance:i,reflectedLight:n}){n.indirectDiffuse.addAssign(i.mul(Ng({diffuseColor:Yn}))),n.indirectDiffuse.mulAssign(e)}}const jfe=new K5;class Vfe extends sa{static get type(){return"MeshLambertNodeMaterial"}constructor(e){super(),this.isMeshLambertNodeMaterial=!0,this.lights=!0,this.setDefaultValues(jfe),this.setValues(e)}setupEnvironment(e){const i=super.setupEnvironment(e);return i?new nR(i):null}setupLightingModel(){return new T8(!1)}}const Gfe=new q5;class Hfe extends sa{static get type(){return"MeshPhongNodeMaterial"}constructor(e){super(),this.isMeshPhongNodeMaterial=!0,this.lights=!0,this.shininessNode=null,this.specularNode=null,this.setDefaultValues(Gfe),this.setValues(e)}setupEnvironment(e){const i=super.setupEnvironment(e);return i?new nR(i):null}setupLightingModel(){return new T8}setupVariants(){const e=(this.shininessNode?ei(this.shininessNode):Tpe).max(1e-4);k3.assign(e);const i=this.specularNode||Rpe;yl.assign(i)}copy(e){return this.shininessNode=e.shininessNode,this.specularNode=e.specularNode,super.copy(e)}}const Wfe=Vi(r=>{if(r.geometry.hasAttribute("normal")===!1)return ei(0);const e=Ec.dFdx().abs().max(Ec.dFdy().abs());return e.x.max(e.y).max(e.z)}),M8=Vi(r=>{const{roughness:e}=r,i=Wfe();let n=e.max(.0525);return n=n.add(i),n=n.min(1),n}),Qfe=Vi(({alpha:r,dotNL:e,dotNV:i})=>{const n=r.pow2(),s=e.mul(n.add(n.oneMinus().mul(i.pow2())).sqrt()),o=i.mul(n.add(n.oneMinus().mul(e.pow2())).sqrt());return Ad(.5,s.add(o).max(qhe))}).setLayout({name:"V_GGX_SmithCorrelated",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNL",type:"float"},{name:"dotNV",type:"float"}]}),qfe=Vi(({alphaT:r,alphaB:e,dotTV:i,dotBV:n,dotTL:s,dotBL:o,dotNV:l,dotNL:u})=>{const c=u.mul(Zt(r.mul(i),e.mul(n),l).length()),h=l.mul(Zt(r.mul(s),e.mul(o),u).length());return Ad(.5,c.add(h)).saturate()}).setLayout({name:"V_GGX_SmithCorrelated_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotTV",type:"float",qualifier:"in"},{name:"dotBV",type:"float",qualifier:"in"},{name:"dotTL",type:"float",qualifier:"in"},{name:"dotBL",type:"float",qualifier:"in"},{name:"dotNV",type:"float",qualifier:"in"},{name:"dotNL",type:"float",qualifier:"in"}]}),Xfe=Vi(({alpha:r,dotNH:e})=>{const i=r.pow2(),n=e.pow2().mul(i.oneMinus()).oneMinus();return i.div(n.pow2()).mul(1/Math.PI)}).setLayout({name:"D_GGX",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNH",type:"float"}]}),Yfe=ei(1/Math.PI),Kfe=Vi(({alphaT:r,alphaB:e,dotNH:i,dotTH:n,dotBH:s})=>{const o=r.mul(e),l=Zt(e.mul(n),r.mul(s),o.mul(i)),u=l.dot(l),c=o.div(u);return Yfe.mul(o.mul(c.pow2()))}).setLayout({name:"D_GGX_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotNH",type:"float",qualifier:"in"},{name:"dotTH",type:"float",qualifier:"in"},{name:"dotBH",type:"float",qualifier:"in"}]}),R8=Vi(r=>{const{lightDirection:e,f0:i,f90:n,roughness:s,f:o,USE_IRIDESCENCE:l,USE_ANISOTROPY:u}=r,c=r.normalView||ra,h=s.pow2(),p=e.add(Bs).normalize(),f=c.dot(e).clamp(),m=c.dot(Bs).clamp(),g=c.dot(p).clamp(),y=Bs.dot(p).clamp();let x=Dy({f0:i,f90:n,dotVH:y}),v,_;if(A6(l)&&(x=O3.mix(x,o)),A6(u)){const T=o_.dot(e),w=o_.dot(Bs),S=o_.dot(p),R=Rg.dot(e),B=Rg.dot(Bs),I=Rg.dot(p);v=qfe({alphaT:P3,alphaB:h,dotTV:w,dotBV:B,dotTL:T,dotBL:R,dotNV:m,dotNL:f}),_=Kfe({alphaT:P3,alphaB:h,dotNH:g,dotTH:S,dotBH:I})}else v=Qfe({alpha:h,dotNL:f,dotNV:m}),_=Xfe({alpha:h,dotNH:g});return x.mul(v).mul(_)}),I8=Vi(({roughness:r,dotNV:e})=>{const i=$r(-1,-.0275,-.572,.022),n=$r(1,.0425,1.04,-.04),s=r.mul(i).add(n),o=s.x.mul(s.x).min(e.mul(-9.28).exp2()).mul(s.x).add(s.y);return Ki(-1.04,1.04).mul(o).add(s.zw)}).setLayout({name:"DFGApprox",type:"vec2",inputs:[{name:"roughness",type:"float"},{name:"dotNV",type:"vec3"}]}),B8=Vi(r=>{const{dotNV:e,specularColor:i,specularF90:n,roughness:s}=r,o=I8({dotNV:e,roughness:s});return i.mul(o.x).add(n.mul(o.y))}),Jfe=Vi(({f:r,f90:e,dotVH:i})=>{const n=i.oneMinus().saturate(),s=n.mul(n),o=n.mul(s,s).clamp(0,.9999);return r.sub(Zt(e).mul(o)).div(o.oneMinus())}).setLayout({name:"Schlick_to_F0",type:"vec3",inputs:[{name:"f",type:"vec3"},{name:"f90",type:"float"},{name:"dotVH",type:"float"}]}),Zfe=Vi(({roughness:r,dotNH:e})=>{const i=r.pow2(),n=ei(1).div(i),s=e.pow2().oneMinus().max(.0078125);return ei(2).add(n).mul(s.pow(n.mul(.5))).div(2*Math.PI)}).setLayout({name:"D_Charlie",type:"float",inputs:[{name:"roughness",type:"float"},{name:"dotNH",type:"float"}]}),$fe=Vi(({dotNV:r,dotNL:e})=>ei(1).div(ei(4).mul(e.add(r).sub(e.mul(r))))).setLayout({name:"V_Neubelt",type:"float",inputs:[{name:"dotNV",type:"float"},{name:"dotNL",type:"float"}]}),eme=Vi(({lightDirection:r})=>{const e=r.add(Bs).normalize(),i=ra.dot(r).clamp(),n=ra.dot(Bs).clamp(),s=ra.dot(e).clamp(),o=Zfe({roughness:D3,dotNH:s}),l=$fe({dotNV:n,dotNL:i});return Mg.mul(o).mul(l)}),tme=Vi(({N:r,V:e,roughness:i})=>{const n=.0078125,s=r.dot(e).saturate(),o=Ki(i,s.oneMinus().sqrt());return o.assign(o.mul(.984375).add(n)),o}).setLayout({name:"LTC_Uv",type:"vec2",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"roughness",type:"float"}]}),ime=Vi(({f:r})=>{const e=r.length();return kl(e.mul(e).add(r.z).div(e.add(1)),0)}).setLayout({name:"LTC_ClippedSphereFormFactor",type:"float",inputs:[{name:"f",type:"vec3"}]}),v_=Vi(({v1:r,v2:e})=>{const i=r.dot(e),n=i.abs().toVar(),s=n.mul(.0145206).add(.4965155).mul(n).add(.8543985).toVar(),o=n.add(4.1616724).mul(n).add(3.417594).toVar(),l=s.div(o),u=i.greaterThan(0).select(l,kl(i.mul(i).oneMinus(),1e-7).inverseSqrt().mul(.5).sub(l));return r.cross(e).mul(u)}).setLayout({name:"LTC_EdgeVectorFormFactor",type:"vec3",inputs:[{name:"v1",type:"vec3"},{name:"v2",type:"vec3"}]}),N8=Vi(({N:r,V:e,P:i,mInv:n,p0:s,p1:o,p2:l,p3:u})=>{const c=o.sub(s).toVar(),h=u.sub(s).toVar(),p=c.cross(h),f=Zt().toVar();return Ga(p.dot(i.sub(s)).greaterThanEqual(0),()=>{const m=e.sub(r.mul(e.dot(r))).normalize(),g=r.cross(m).negate(),y=n.mul(Mo(m,g,r).transpose()).toVar(),x=y.mul(s.sub(i)).normalize().toVar(),v=y.mul(o.sub(i)).normalize().toVar(),_=y.mul(l.sub(i)).normalize().toVar(),T=y.mul(u.sub(i)).normalize().toVar(),w=Zt(0).toVar();w.addAssign(v_({v1:x,v2:v})),w.addAssign(v_({v1:v,v2:_})),w.addAssign(v_({v1:_,v2:T})),w.addAssign(v_({v1:T,v2:x})),f.assign(Zt(ime({f:w})))}),f}).setLayout({name:"LTC_Evaluate",type:"vec3",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"P",type:"vec3"},{name:"mInv",type:"mat3"},{name:"p0",type:"vec3"},{name:"p1",type:"vec3"},{name:"p2",type:"vec3"},{name:"p3",type:"vec3"}]}),x_=1/6,L8=r=>bn(x_,bn(r,bn(r,r.negate().add(3)).sub(3)).add(1)),sR=r=>bn(x_,bn(r,bn(r,bn(3,r).sub(6))).add(4)),D8=r=>bn(x_,bn(r,bn(r,bn(-3,r).add(3)).add(3)).add(1)),aR=r=>bn(x_,u_(r,3)),O8=r=>L8(r).add(sR(r)),P8=r=>D8(r).add(aR(r)),k8=r=>Ro(-1,sR(r).div(L8(r).add(sR(r)))),F8=r=>Ro(1,aR(r).div(D8(r).add(aR(r)))),U8=(r,e,i)=>{const n=r.uvNode,s=bn(n,e.zw).add(.5),o=Vp(s),l=yd(s),u=O8(l.x),c=P8(l.x),h=k8(l.x),p=F8(l.x),f=k8(l.y),m=F8(l.y),g=Ki(o.x.add(h),o.y.add(f)).sub(.5).mul(e.xy),y=Ki(o.x.add(p),o.y.add(f)).sub(.5).mul(e.xy),x=Ki(o.x.add(h),o.y.add(m)).sub(.5).mul(e.xy),v=Ki(o.x.add(p),o.y.add(m)).sub(.5).mul(e.xy),_=O8(l.y).mul(Ro(u.mul(r.uv(g).level(i)),c.mul(r.uv(y).level(i)))),T=P8(l.y).mul(Ro(u.mul(r.uv(x).level(i)),c.mul(r.uv(v).level(i))));return _.add(T)},rme=Vi(([r,e=ei(3)])=>{const i=Ki(r.size(ks(e))),n=Ki(r.size(ks(e.add(1)))),s=Ad(1,i),o=Ad(1,n),l=U8(r,$r(s,i),Vp(e)),u=U8(r,$r(o,n),j3(e));return yd(e).mix(l,u)}),z8=Vi(([r,e,i,n,s])=>{const o=Zt(j6(e.negate(),Ay(r),Ad(1,n))),l=Zt(xd(s[0].xyz),xd(s[1].xyz),xd(s[2].xyz));return Ay(o).mul(i.mul(l))}).setLayout({name:"getVolumeTransmissionRay",type:"vec3",inputs:[{name:"n",type:"vec3"},{name:"v",type:"vec3"},{name:"thickness",type:"float"},{name:"ior",type:"float"},{name:"modelMatrix",type:"mat4"}]}),nme=Vi(([r,e])=>r.mul(th(e.mul(2).sub(2),0,1))).setLayout({name:"applyIorToRoughness",type:"float",inputs:[{name:"roughness",type:"float"},{name:"ior",type:"float"}]}),sme=f8(),ame=f8(),j8=Vi(([r,e,i],{material:n})=>{const s=(n.side==pc?sme:ame).uv(r),o=eh(tR.x).mul(nme(e,i));return rme(s,o)}),V8=Vi(([r,e,i])=>(Ga(i.notEqual(0),()=>{const n=L6(e).negate().div(i);return N6(n.negate().mul(r))}),Zt(1))).setLayout({name:"volumeAttenuation",type:"vec3",inputs:[{name:"transmissionDistance",type:"float"},{name:"attenuationColor",type:"vec3"},{name:"attenuationDistance",type:"float"}]}),ome=Vi(([r,e,i,n,s,o,l,u,c,h,p,f,m,g,y])=>{let x,v;if(y){x=$r().toVar(),v=Zt().toVar();const R=p.sub(1).mul(y.mul(.025)),B=Zt(p.sub(R),p,p.add(R));Qc({start:0,end:3},({i:I})=>{const D=B.element(I),L=z8(r,e,f,D,u),O=l.add(L),U=h.mul(c.mul($r(O,1))),Z=Ki(U.xy.div(U.w)).toVar();Z.addAssign(1),Z.divAssign(2),Z.assign(Ki(Z.x,Z.y.oneMinus()));const G=j8(Z,i,D);x.element(I).assign(G.element(I)),x.a.addAssign(G.a),v.element(I).assign(n.element(I).mul(V8(xd(L),m,g).element(I)))}),x.a.divAssign(3)}else{const R=z8(r,e,f,p,u),B=l.add(R),I=h.mul(c.mul($r(B,1))),D=Ki(I.xy.div(I.w)).toVar();D.addAssign(1),D.divAssign(2),D.assign(Ki(D.x,D.y.oneMinus())),x=j8(D,i,p),v=n.mul(V8(xd(R),m,g))}const _=v.rgb.mul(x.rgb),T=r.dot(e).clamp(),w=Zt(B8({dotNV:T,specularColor:s,specularF90:o,roughness:i})),S=v.r.add(v.g,v.b).div(3);return $r(w.oneMinus().mul(_),x.a.oneMinus().mul(S).oneMinus())}),lme=Mo(3.2404542,-.969266,.0556434,-1.5371385,1.8760108,-.2040259,-.4985314,.041556,1.0572252),cme=r=>{const e=r.sqrt();return Zt(1).add(e).div(Zt(1).sub(e))},G8=(r,e)=>r.sub(e).div(r.add(e)).pow2(),ume=(r,e)=>{const i=r.mul(2*Math.PI*1e-9),n=Zt(54856e-17,44201e-17,52481e-17),s=Zt(1681e3,1795300,2208400),o=Zt(43278e5,93046e5,66121e5),l=ei(9747e-17*Math.sqrt(2*Math.PI*45282e5)).mul(i.mul(2239900).add(e.x).cos()).mul(i.pow2().mul(-45282e5).exp());let u=n.mul(o.mul(2*Math.PI).sqrt()).mul(s.mul(i).add(e).cos()).mul(i.pow2().negate().mul(o).exp());return u=Zt(u.x.add(l),u.y,u.z).div(10685e-11),lme.mul(u)},hme=Vi(({outsideIOR:r,eta2:e,cosTheta1:i,thinFilmThickness:n,baseF0:s})=>{const o=ys(r,e,Gp(0,.03,n)),l=r.div(o).pow2().mul(i.pow2().oneMinus()).oneMinus();Ga(l.lessThan(0),()=>Zt(1));const u=l.sqrt(),c=G8(o,r),h=Dy({f0:c,f90:1,dotVH:i}),p=h.oneMinus(),f=o.lessThan(r).select(Math.PI,0),m=ei(Math.PI).sub(f),g=cme(s.clamp(0,.9999)),y=G8(g,o.toVec3()),x=Dy({f0:y,f90:1,dotVH:u}),v=Zt(g.x.lessThan(o).select(Math.PI,0),g.y.lessThan(o).select(Math.PI,0),g.z.lessThan(o).select(Math.PI,0)),_=o.mul(n,u,2),T=Zt(m).add(v),w=h.mul(x).clamp(1e-5,.9999),S=w.sqrt(),R=p.pow2().mul(x).div(Zt(1).sub(w)),B=h.add(R).toVar(),I=R.sub(p).toVar();return Qc({start:1,end:2,condition:"<=",name:"m"},({m:D})=>{I.mulAssign(S);const L=ume(ei(D).mul(_),ei(D).mul(T)).mul(2);B.addAssign(I.mul(L))}),B.max(Zt(0))}).setLayout({name:"evalIridescence",type:"vec3",inputs:[{name:"outsideIOR",type:"float"},{name:"eta2",type:"float"},{name:"cosTheta1",type:"float"},{name:"thinFilmThickness",type:"float"},{name:"baseF0",type:"vec3"}]}),dme=Vi(({normal:r,viewDir:e,roughness:i})=>{const n=r.dot(e).saturate(),s=i.pow2(),o=Yo(i.lessThan(.25),ei(-339.2).mul(s).add(ei(161.4).mul(i)).sub(25.9),ei(-8.48).mul(s).add(ei(14.3).mul(i)).sub(9.95)),l=Yo(i.lessThan(.25),ei(44).mul(s).sub(ei(23.7).mul(i)).add(3.26),ei(1.97).mul(s).sub(ei(3.27).mul(i)).add(.72));return Yo(i.lessThan(.25),0,ei(.1).mul(i).sub(.025)).add(o.mul(n).add(l).exp()).mul(1/Math.PI).saturate()}),oR=Zt(.04),lR=ei(1);class H8 extends y_{constructor(e=!1,i=!1,n=!1,s=!1,o=!1,l=!1){super(),this.clearcoat=e,this.sheen=i,this.iridescence=n,this.anisotropy=s,this.transmission=o,this.dispersion=l,this.clearcoatRadiance=null,this.clearcoatSpecularDirect=null,this.clearcoatSpecularIndirect=null,this.sheenSpecularDirect=null,this.sheenSpecularIndirect=null,this.iridescenceFresnel=null,this.iridescenceF0=null}start(e){if(this.clearcoat===!0&&(this.clearcoatRadiance=Zt().toVar("clearcoatRadiance"),this.clearcoatSpecularDirect=Zt().toVar("clearcoatSpecularDirect"),this.clearcoatSpecularIndirect=Zt().toVar("clearcoatSpecularIndirect")),this.sheen===!0&&(this.sheenSpecularDirect=Zt().toVar("sheenSpecularDirect"),this.sheenSpecularIndirect=Zt().toVar("sheenSpecularIndirect")),this.iridescence===!0){const i=ra.dot(Bs).clamp();this.iridescenceFresnel=hme({outsideIOR:ei(1),eta2:E6,cosTheta1:i,thinFilmThickness:w6,baseF0:yl}),this.iridescenceF0=Jfe({f:this.iridescenceFresnel,f90:1,dotVH:i})}if(this.transmission===!0){const i=Q3,n=epe.sub(Q3).normalize(),s=q3;e.backdrop=ome(s,n,$u,Yn,yl,l_,i,Qp,nh,f_,c_,S6,M6,T6,this.dispersion?R6:null),e.backdropAlpha=U3,Yn.a.mulAssign(ys(1,e.backdrop.a,U3))}}computeMultiscattering(e,i,n){const s=ra.dot(Bs).clamp(),o=I8({roughness:$u,dotNV:s}),l=(this.iridescenceF0?O3.mix(yl,this.iridescenceF0):yl).mul(o.x).add(n.mul(o.y)),u=o.x.add(o.y).oneMinus(),c=yl.add(yl.oneMinus().mul(.047619)),h=l.mul(c).div(u.mul(c).oneMinus());e.addAssign(l),i.addAssign(h.mul(u))}direct({lightDirection:e,lightColor:i,reflectedLight:n}){const s=ra.dot(e).clamp().mul(i);if(this.sheen===!0&&this.sheenSpecularDirect.addAssign(s.mul(eme({lightDirection:e}))),this.clearcoat===!0){const o=Ey.dot(e).clamp().mul(i);this.clearcoatSpecularDirect.addAssign(o.mul(R8({lightDirection:e,f0:oR,f90:lR,roughness:a_,normalView:Ey})))}n.directDiffuse.addAssign(s.mul(Ng({diffuseColor:Yn.rgb}))),n.directSpecular.addAssign(s.mul(R8({lightDirection:e,f0:yl,f90:1,roughness:$u,iridescence:this.iridescence,f:this.iridescenceFresnel,USE_IRIDESCENCE:this.iridescence,USE_ANISOTROPY:this.anisotropy})))}directRectArea({lightColor:e,lightPosition:i,halfWidth:n,halfHeight:s,reflectedLight:o,ltc_1:l,ltc_2:u}){const c=i.add(n).sub(s),h=i.sub(n).sub(s),p=i.sub(n).add(s),f=i.add(n).add(s),m=ra,g=Bs,y=Wa.toVar(),x=tme({N:m,V:g,roughness:$u}),v=l.uv(x).toVar(),_=u.uv(x).toVar(),T=Mo(Zt(v.x,0,v.y),Zt(0,1,0),Zt(v.z,0,v.w)).toVar(),w=yl.mul(_.x).add(yl.oneMinus().mul(_.y)).toVar();o.directSpecular.addAssign(e.mul(w).mul(N8({N:m,V:g,P:y,mInv:T,p0:c,p1:h,p2:p,p3:f}))),o.directDiffuse.addAssign(e.mul(Yn).mul(N8({N:m,V:g,P:y,mInv:Mo(1,0,0,0,1,0,0,0,1),p0:c,p1:h,p2:p,p3:f})))}indirect(e,i,n){this.indirectDiffuse(e,i,n),this.indirectSpecular(e,i,n),this.ambientOcclusion(e,i,n)}indirectDiffuse({irradiance:e,reflectedLight:i}){i.indirectDiffuse.addAssign(e.mul(Ng({diffuseColor:Yn})))}indirectSpecular({radiance:e,iblIrradiance:i,reflectedLight:n}){if(this.sheen===!0&&this.sheenSpecularIndirect.addAssign(i.mul(Mg,dme({normal:ra,viewDir:Bs,roughness:D3}))),this.clearcoat===!0){const h=Ey.dot(Bs).clamp(),p=B8({dotNV:h,specularColor:oR,specularF90:lR,roughness:a_});this.clearcoatSpecularIndirect.addAssign(this.clearcoatRadiance.mul(p))}const s=Zt().toVar("singleScattering"),o=Zt().toVar("multiScattering"),l=i.mul(1/Math.PI);this.computeMultiscattering(s,o,l_);const u=s.add(o),c=Yn.mul(u.r.max(u.g).max(u.b).oneMinus());n.indirectSpecular.addAssign(e.mul(s)),n.indirectSpecular.addAssign(o.mul(l)),n.indirectDiffuse.addAssign(c.mul(l))}ambientOcclusion({ambientOcclusion:e,reflectedLight:i}){const n=ra.dot(Bs).clamp().add(e),s=$u.mul(-16).oneMinus().negate().exp2(),o=e.sub(n.pow(s).oneMinus()).clamp();this.clearcoat===!0&&this.clearcoatSpecularIndirect.mulAssign(e),this.sheen===!0&&this.sheenSpecularIndirect.mulAssign(e),i.indirectDiffuse.mulAssign(e),i.indirectSpecular.mulAssign(o)}finish(e){const{outgoingLight:i}=e;if(this.clearcoat===!0){const n=Ey.dot(Bs).clamp(),s=Dy({dotVH:n,f0:oR,f90:lR}),o=i.mul(L3.mul(s).oneMinus()).add(this.clearcoatSpecularDirect.add(this.clearcoatSpecularIndirect).mul(L3));i.assign(o)}if(this.sheen===!0){const n=Mg.r.max(Mg.g).max(Mg.b).mul(.157).oneMinus(),s=i.mul(n).add(this.sheenSpecularDirect,this.sheenSpecularIndirect);i.assign(s)}}}const W8=ei(1),cR=ei(-2),b_=ei(.8),uR=ei(-1),__=ei(.4),hR=ei(2),E_=ei(.305),dR=ei(3),Q8=ei(.21),pme=ei(4),q8=ei(4),fme=ei(16),mme=Vi(([r])=>{const e=Zt(bc(r)).toVar(),i=ei(-1).toVar();return Ga(e.x.greaterThan(e.z),()=>{Ga(e.x.greaterThan(e.y),()=>{i.assign(Yo(r.x.greaterThan(0),0,3))}).Else(()=>{i.assign(Yo(r.y.greaterThan(0),1,4))})}).Else(()=>{Ga(e.z.greaterThan(e.y),()=>{i.assign(Yo(r.z.greaterThan(0),2,5))}).Else(()=>{i.assign(Yo(r.y.greaterThan(0),1,4))})}),i}).setLayout({name:"getFace",type:"float",inputs:[{name:"direction",type:"vec3"}]}),gme=Vi(([r,e])=>{const i=Ki().toVar();return Ga(e.equal(0),()=>{i.assign(Ki(r.z,r.y).div(bc(r.x)))}).ElseIf(e.equal(1),()=>{i.assign(Ki(r.x.negate(),r.z.negate()).div(bc(r.y)))}).ElseIf(e.equal(2),()=>{i.assign(Ki(r.x.negate(),r.y).div(bc(r.z)))}).ElseIf(e.equal(3),()=>{i.assign(Ki(r.z.negate(),r.y).div(bc(r.x)))}).ElseIf(e.equal(4),()=>{i.assign(Ki(r.x.negate(),r.z).div(bc(r.y)))}).Else(()=>{i.assign(Ki(r.x,r.y).div(bc(r.z)))}),bn(.5,i.add(1))}).setLayout({name:"getUV",type:"vec2",inputs:[{name:"direction",type:"vec3"},{name:"face",type:"float"}]}),Ame=Vi(([r])=>{const e=ei(0).toVar();return Ga(r.greaterThanEqual(b_),()=>{e.assign(W8.sub(r).mul(uR.sub(cR)).div(W8.sub(b_)).add(cR))}).ElseIf(r.greaterThanEqual(__),()=>{e.assign(b_.sub(r).mul(hR.sub(uR)).div(b_.sub(__)).add(uR))}).ElseIf(r.greaterThanEqual(E_),()=>{e.assign(__.sub(r).mul(dR.sub(hR)).div(__.sub(E_)).add(hR))}).ElseIf(r.greaterThanEqual(Q8),()=>{e.assign(E_.sub(r).mul(pme.sub(dR)).div(E_.sub(Q8)).add(dR))}).Else(()=>{e.assign(ei(-2).mul(eh(bn(1.16,r))))}),e}).setLayout({name:"roughnessToMip",type:"float",inputs:[{name:"roughness",type:"float"}]}),yme=Vi(([r,e])=>{const i=r.toVar();i.assign(bn(2,i).sub(1));const n=Zt(i,1).toVar();return Ga(e.equal(0),()=>{n.assign(n.zyx)}).ElseIf(e.equal(1),()=>{n.assign(n.xzy),n.xz.mulAssign(-1)}).ElseIf(e.equal(2),()=>{n.x.mulAssign(-1)}).ElseIf(e.equal(3),()=>{n.assign(n.zyx),n.xz.mulAssign(-1)}).ElseIf(e.equal(4),()=>{n.assign(n.xzy),n.xy.mulAssign(-1)}).ElseIf(e.equal(5),()=>{n.z.mulAssign(-1)}),n}).setLayout({name:"getDirection",type:"vec3",inputs:[{name:"uv",type:"vec2"},{name:"face",type:"float"}]}),vme=Vi(([r,e,i,n,s,o])=>{const l=ei(i),u=Zt(e),c=th(Ame(l),cR,o),h=yd(c),p=Vp(c),f=Zt(pR(r,u,p,n,s,o)).toVar();return Ga(h.notEqual(0),()=>{const m=Zt(pR(r,u,p.add(1),n,s,o)).toVar();f.assign(ys(f,m,h))}),f}),pR=Vi(([r,e,i,n,s,o])=>{const l=ei(i).toVar(),u=Zt(e),c=ei(mme(u)).toVar(),h=ei(kl(q8.sub(l),0)).toVar();l.assign(kl(l,q8));const p=ei(gy(l)).toVar(),f=Ki(gme(u,c).mul(p.sub(2)).add(1)).toVar();return Ga(c.greaterThan(2),()=>{f.y.addAssign(p),c.subAssign(3)}),f.x.addAssign(c.mul(p)),f.x.addAssign(h.mul(bn(3,fme))),f.y.addAssign(bn(4,gy(o).sub(p))),f.x.mulAssign(n),f.y.mulAssign(s),r.uv(f).grad(Ki(),Ki())}),fR=Vi(({envMap:r,mipInt:e,outputDirection:i,theta:n,axis:s,CUBEUV_TEXEL_WIDTH:o,CUBEUV_TEXEL_HEIGHT:l,CUBEUV_MAX_MIP:u})=>{const c=vd(n),h=i.mul(c).add(s.cross(i).mul(xc(n))).add(s.mul(s.dot(i).mul(c.oneMinus())));return pR(r,h,e,o,l,u)}),xme=Vi(({n:r,latitudinal:e,poleAxis:i,outputDirection:n,weights:s,samples:o,dTheta:l,mipInt:u,envMap:c,CUBEUV_TEXEL_WIDTH:h,CUBEUV_TEXEL_HEIGHT:p,CUBEUV_MAX_MIP:f})=>{const m=Zt(Yo(e,i,U6(i,n))).toVar();Ga(B6(m.equals(Zt(0))),()=>{m.assign(Zt(n.z,0,n.x.negate()))}),m.assign(Ay(m));const g=Zt().toVar();return g.addAssign(s.element(ks(0)).mul(fR({theta:0,axis:m,outputDirection:n,mipInt:u,envMap:c,CUBEUV_TEXEL_WIDTH:h,CUBEUV_TEXEL_HEIGHT:p,CUBEUV_MAX_MIP:f}))),Qc({start:ks(1),end:r},({i:y})=>{Ga(y.greaterThanEqual(o),()=>{ufe()});const x=ei(l.mul(ei(y))).toVar();g.addAssign(s.element(y).mul(fR({theta:x.mul(-1),axis:m,outputDirection:n,mipInt:u,envMap:c,CUBEUV_TEXEL_WIDTH:h,CUBEUV_TEXEL_HEIGHT:p,CUBEUV_MAX_MIP:f}))),g.addAssign(s.element(y).mul(fR({theta:x,axis:m,outputDirection:n,mipInt:u,envMap:c,CUBEUV_TEXEL_WIDTH:h,CUBEUV_TEXEL_HEIGHT:p,CUBEUV_MAX_MIP:f})))}),$r(g,1)});let w_=null;const X8=new WeakMap;function bme(r){const e=Math.log2(r)-2,i=1/r;return{texelWidth:1/(3*Math.max(Math.pow(2,e),7*16)),texelHeight:i,maxMip:e}}function _me(r){let e=X8.get(r);if((e!==void 0?e.pmremVersion:-1)!==r.pmremVersion){const i=r.image;if(r.isCubeTexture)if(wme(i))e=w_.fromCubemap(r,e);else return null;else if(Cme(i))e=w_.fromEquirectangular(r,e);else return null;e.pmremVersion=r.pmremVersion,X8.set(r,e)}return e.texture}class Eme extends ta{static get type(){return"PMREMNode"}constructor(e,i=null,n=null){super("vec3"),this._value=e,this._pmrem=null,this.uvNode=i,this.levelNode=n,this._generator=null;const s=new So;s.isRenderTargetTexture=!0,this._texture=Fs(s),this._width=en(0),this._height=en(0),this._maxMip=en(0),this.updateBeforeType=dn.RENDER}set value(e){this._value=e,this._pmrem=null}get value(){return this._value}updateFromTexture(e){const i=bme(e.image.height);this._texture.value=e,this._width.value=i.texelWidth,this._height.value=i.texelHeight,this._maxMip.value=i.maxMip}updateBefore(){let e=this._pmrem;const i=e?e.pmremVersion:-1,n=this._value;i!==n.pmremVersion&&(n.isPMREMTexture===!0?e=n:e=_me(n),e!==null&&(this._pmrem=e,this.updateFromTexture(e)))}setup(e){w_===null&&(w_=e.createPMREMGenerator()),this.updateBefore(e);let i=this.uvNode;i===null&&e.context.getUV&&(i=e.context.getUV(this));const n=this.value;e.renderer.coordinateSystem===fc&&n.isPMREMTexture!==!0&&n.isRenderTargetTexture===!0&&(i=Zt(i.x.negate(),i.yz));let s=this.levelNode;return s===null&&e.context.getTextureLevel&&(s=e.context.getTextureLevel(this)),vme(this._texture,i,s,this._width,this._height,this._maxMip)}}function wme(r){if(r==null)return!1;let e=0;const i=6;for(let n=0;n<i;n++)r[n]!==void 0&&e++;return e===i}function Cme(r){return r==null?!1:r.height>0}const Y8=li(Eme),K8=new WeakMap;class Sme extends Bg{static get type(){return"EnvironmentNode"}constructor(e=null){super(),this.envNode=e}setup(e){const{material:i}=e;let n=this.envNode;if(n.isTextureNode||n.isMaterialReferenceNode){const f=n.isTextureNode?n.value:i[n.property];let m=K8.get(f);m===void 0&&(m=Y8(f),K8.set(f,m)),n=m}const s=i.envMap?Ns("envMapIntensity","float",e.material):Ns("environmentIntensity","float",e.scene),o=i.useAnisotropy===!0||i.anisotropy>0?ype:ra,l=n.context(J8($u,o)).mul(s),u=n.context(Tme(q3)).mul(Math.PI).mul(s),c=d_(l),h=d_(u);e.context.radiance.addAssign(c),e.context.iblIrradiance.addAssign(h);const p=e.context.lightingModel.clearcoatRadiance;if(p){const f=n.context(J8(a_,Ey)).mul(s),m=d_(f);p.addAssign(m)}}}const J8=(r,e)=>{let i=null;return{getUV:()=>(i===null&&(i=Bs.negate().reflect(e),i=r.mul(r).mix(i,e).normalize(),i=i.transformDirection(nh)),i),getTextureLevel:()=>r}},Tme=r=>({getUV:()=>r,getTextureLevel:()=>ei(1)}),Mme=new b3;class Z8 extends sa{static get type(){return"MeshStandardNodeMaterial"}constructor(e){super(),this.isMeshStandardNodeMaterial=!0,this.lights=!0,this.emissiveNode=null,this.metalnessNode=null,this.roughnessNode=null,this.setDefaultValues(Mme),this.setValues(e)}setupEnvironment(e){let i=super.setupEnvironment(e);return i===null&&e.environmentNode&&(i=e.environmentNode),i?new Sme(i):null}setupLightingModel(){return new H8}setupSpecular(){const e=ys(Zt(.04),Yn.rgb,s_);yl.assign(e),l_.assign(1)}setupVariants(){const e=this.metalnessNode?ei(this.metalnessNode):Npe;s_.assign(e);let i=this.roughnessNode?ei(this.roughnessNode):Bpe;i=M8({roughness:i}),$u.assign(i),this.setupSpecular(),Yn.assign($r(Yn.rgb.mul(e.oneMinus()),Yn.a))}copy(e){return this.emissiveNode=e.emissiveNode,this.metalnessNode=e.metalnessNode,this.roughnessNode=e.roughnessNode,super.copy(e)}}const Rme=new Q5;class Ime extends Z8{static get type(){return"MeshPhysicalNodeMaterial"}constructor(e){super(),this.isMeshPhysicalNodeMaterial=!0,this.clearcoatNode=null,this.clearcoatRoughnessNode=null,this.clearcoatNormalNode=null,this.sheenNode=null,this.sheenRoughnessNode=null,this.iridescenceNode=null,this.iridescenceIORNode=null,this.iridescenceThicknessNode=null,this.specularIntensityNode=null,this.specularColorNode=null,this.iorNode=null,this.transmissionNode=null,this.thicknessNode=null,this.attenuationDistanceNode=null,this.attenuationColorNode=null,this.dispersionNode=null,this.anisotropyNode=null,this.setDefaultValues(Rme),this.setValues(e)}get useClearcoat(){return this.clearcoat>0||this.clearcoatNode!==null}get useIridescence(){return this.iridescence>0||this.iridescenceNode!==null}get useSheen(){return this.sheen>0||this.sheenNode!==null}get useAnisotropy(){return this.anisotropy>0||this.anisotropyNode!==null}get useTransmission(){return this.transmission>0||this.transmissionNode!==null}get useDispersion(){return this.dispersion>0||this.dispersionNode!==null}setupSpecular(){const e=this.iorNode?ei(this.iorNode):Qpe;c_.assign(e),yl.assign(ys(yy(z6(c_.sub(1).div(c_.add(1))).mul(Ipe),Zt(1)).mul(l8),Yn.rgb,s_)),l_.assign(ys(l8,1,s_))}setupLightingModel(){return new H8(this.useClearcoat,this.useSheen,this.useIridescence,this.useAnisotropy,this.useTransmission,this.useDispersion)}setupVariants(e){if(super.setupVariants(e),this.useClearcoat){const i=this.clearcoatNode?ei(this.clearcoatNode):Dpe,n=this.clearcoatRoughnessNode?ei(this.clearcoatRoughnessNode):Ope;L3.assign(i),a_.assign(M8({roughness:n}))}if(this.useSheen){const i=this.sheenNode?Zt(this.sheenNode):Fpe,n=this.sheenRoughnessNode?ei(this.sheenRoughnessNode):Upe;Mg.assign(i),D3.assign(n)}if(this.useIridescence){const i=this.iridescenceNode?ei(this.iridescenceNode):jpe,n=this.iridescenceIORNode?ei(this.iridescenceIORNode):Vpe,s=this.iridescenceThicknessNode?ei(this.iridescenceThicknessNode):Gpe;O3.assign(i),E6.assign(n),w6.assign(s)}if(this.useAnisotropy){const i=(this.anisotropyNode?Ki(this.anisotropyNode):zpe).toVar();jp.assign(i.length()),Ga(jp.equal(0),()=>{i.assign(Ki(1,0))}).Else(()=>{i.divAssign(Ki(jp)),jp.assign(jp.saturate())}),P3.assign(jp.pow2().mix($u.pow2(),1)),o_.assign(Sy[0].mul(i.x).add(Sy[1].mul(i.y))),Rg.assign(Sy[1].mul(i.x).sub(Sy[0].mul(i.y)))}if(this.useTransmission){const i=this.transmissionNode?ei(this.transmissionNode):Hpe,n=this.thicknessNode?ei(this.thicknessNode):Wpe,s=this.attenuationDistanceNode?ei(this.attenuationDistanceNode):qpe,o=this.attenuationColorNode?Zt(this.attenuationColorNode):Xpe;if(U3.assign(i),S6.assign(n),T6.assign(s),M6.assign(o),this.useDispersion){const l=this.dispersionNode?ei(this.dispersionNode):Zpe;R6.assign(l)}}}setupClearcoatNormal(){return this.clearcoatNormalNode?Zt(this.clearcoatNormalNode):Ppe}setup(e){e.context.setupClearcoatNormal=()=>this.setupClearcoatNormal(e),super.setup(e)}copy(e){return this.clearcoatNode=e.clearcoatNode,this.clearcoatRoughnessNode=e.clearcoatRoughnessNode,this.clearcoatNormalNode=e.clearcoatNormalNode,this.sheenNode=e.sheenNode,this.sheenRoughnessNode=e.sheenRoughnessNode,this.iridescenceNode=e.iridescenceNode,this.iridescenceIORNode=e.iridescenceIORNode,this.iridescenceThicknessNode=e.iridescenceThicknessNode,this.specularIntensityNode=e.specularIntensityNode,this.specularColorNode=e.specularColorNode,this.transmissionNode=e.transmissionNode,this.thicknessNode=e.thicknessNode,this.attenuationDistanceNode=e.attenuationDistanceNode,this.attenuationColorNode=e.attenuationColorNode,this.dispersionNode=e.dispersionNode,this.anisotropyNode=e.anisotropyNode,super.copy(e)}}const Bme=Vi(({normal:r,lightDirection:e,builder:i})=>{const n=r.dot(e),s=Ki(n.mul(.5).add(.5),0);if(i.material.gradientMap){const o=bd("gradientMap","texture").context({getUV:()=>s});return Zt(o.r)}else{const o=s.fwidth().mul(.5);return ys(Zt(.7),Zt(1),Gp(ei(.7).sub(o.x),ei(.7).add(o.x),s.x))}});class Nme extends y_{direct({lightDirection:e,lightColor:i,reflectedLight:n},s,o){const l=Bme({normal:Z6,lightDirection:e,builder:o}).mul(i);n.directDiffuse.addAssign(l.mul(Ng({diffuseColor:Yn.rgb})))}indirect({ambientOcclusion:e,irradiance:i,reflectedLight:n}){n.indirectDiffuse.addAssign(i.mul(Ng({diffuseColor:Yn}))),n.indirectDiffuse.mulAssign(e)}}const Lme=new X5;class Dme extends sa{static get type(){return"MeshToonNodeMaterial"}constructor(e){super(),this.isMeshToonNodeMaterial=!0,this.lights=!0,this.setDefaultValues(Lme),this.setValues(e)}setupLightingModel(){return new Nme}}class Ome extends ta{static get type(){return"MatcapUVNode"}constructor(){super("vec2")}setup(){const e=Zt(Bs.z,0,Bs.x.negate()).normalize(),i=Bs.cross(e);return Ki(e.dot(ra),i.dot(ra)).mul(.495).add(.5)}}const Pme=Yi(Ome),kme=new J5;class Fme extends sa{static get type(){return"MeshMatcapNodeMaterial"}constructor(e){super(),this.lights=!1,this.isMeshMatcapNodeMaterial=!0,this.setDefaultValues(kme),this.setValues(e)}setupVariants(e){const i=Pme;let n;e.material.matcap?n=bd("matcap","texture").context({getUV:()=>i}):n=Zt(ys(.2,.8,i.y)),Yn.rgb.mulAssign(n.rgb)}}const Ume=new H5;class zme extends sa{static get type(){return"PointsNodeMaterial"}constructor(e){super(),this.isPointsNodeMaterial=!0,this.lights=!1,this.transparent=!0,this.sizeNode=null,this.setDefaultValues(Ume),this.setValues(e)}copy(e){return this.sizeNode=e.sizeNode,super.copy(e)}}class jme extends ta{static get type(){return"RotateNode"}constructor(e,i){super(),this.positionNode=e,this.rotationNode=i}getNodeType(e){return this.positionNode.getNodeType(e)}setup(e){const{rotationNode:i,positionNode:n}=this;if(this.getNodeType(e)==="vec2"){const s=i.cos(),o=i.sin();return N3(s,o,o.negate(),s).mul(n)}else{const s=i,o=Sg($r(1,0,0,0),$r(0,vd(s.x),xc(s.x).negate(),0),$r(0,xc(s.x),vd(s.x),0),$r(0,0,0,1)),l=Sg($r(vd(s.y),0,xc(s.y),0),$r(0,1,0,0),$r(xc(s.y).negate(),0,vd(s.y),0),$r(0,0,0,1)),u=Sg($r(vd(s.z),xc(s.z).negate(),0,0),$r(xc(s.z),vd(s.z),0,0),$r(0,0,1,0),$r(0,0,0,1));return o.mul(l).mul(u).mul($r(n,1)).xyz}}}const Vme=li(jme),Gme=new V5;class Hme extends sa{static get type(){return"SpriteNodeMaterial"}constructor(e){super(),this.isSpriteNodeMaterial=!0,this.lights=!1,this._useSizeAttenuation=!0,this.positionNode=null,this.rotationNode=null,this.scaleNode=null,this.setDefaultValues(Gme),this.setValues(e)}setupPosition({object:e,camera:i,context:n}){const s=this.sizeAttenuation,{positionNode:o,rotationNode:l,scaleNode:u}=this,c=Ha;let h=m_.mul(Zt(o||0)),p=Ki(Qp[0].xyz.length(),Qp[1].xyz.length());if(u!==null&&(p=p.mul(u)),!s)if(i.isPerspectiveCamera)p=p.mul(h.z.negate());else{const x=ei(2).div(f_.element(1).element(1));p=p.mul(x.mul(2))}let f=c.xy;if(e.center&&e.center.isVector2===!0){const x=Ode("center","vec2");f=f.sub(x.sub(.5))}f=f.mul(p);const m=ei(l||kpe),g=Vme(f,m);h=$r(h.xy.add(g),h.zw);const y=f_.mul(h);return n.vertex=c,y}copy(e){return this.positionNode=e.positionNode,this.rotationNode=e.rotationNode,this.scaleNode=e.scaleNode,super.copy(e)}get sizeAttenuation(){return this._useSizeAttenuation}set sizeAttenuation(e){this._useSizeAttenuation!==e&&(this._useSizeAttenuation=e,this.needsUpdate=!0)}}class Wme extends y_{constructor(){super(),this.shadowNode=ei(1).toVar("shadowMask")}direct({shadowMask:e}){this.shadowNode.mulAssign(e)}finish(e){Yn.a.mulAssign(this.shadowNode.oneMinus()),e.outgoingLight.rgb.assign(Yn.rgb)}}const Qme=new W5;class qme extends sa{static get type(){return"ShadowNodeMaterial"}constructor(e){super(),this.isShadowNodeMaterial=!0,this.lights=!0,this.setDefaultValues(Qme),this.setValues(e)}setupLightingModel(){return new Wme}}Vi(({texture:r,uv:e})=>{const i=Zt().toVar();return Ga(e.x.lessThan(1e-4),()=>{i.assign(Zt(1,0,0))}).ElseIf(e.y.lessThan(1e-4),()=>{i.assign(Zt(0,1,0))}).ElseIf(e.z.lessThan(1e-4),()=>{i.assign(Zt(0,0,1))}).ElseIf(e.x.greaterThan(1-1e-4),()=>{i.assign(Zt(-1,0,0))}).ElseIf(e.y.greaterThan(1-1e-4),()=>{i.assign(Zt(0,-1,0))}).ElseIf(e.z.greaterThan(1-1e-4),()=>{i.assign(Zt(0,0,-1))}).Else(()=>{const n=r.uv(e.add(Zt(-.01,0,0))).r.sub(r.uv(e.add(Zt(.01,0,0))).r),s=r.uv(e.add(Zt(0,-.01,0))).r.sub(r.uv(e.add(Zt(0,.01,0))).r),o=r.uv(e.add(Zt(0,0,-.01))).r.sub(r.uv(e.add(Zt(0,0,.01))).r);i.assign(Zt(n,s,o))}),i.normalize()});class Xme{constructor(e,i){this.nodes=e,this.info=i,this.animationLoop=null,this.requestId=null,this._init()}_init(){const e=(i,n)=>{this.requestId=self.requestAnimationFrame(e),this.info.autoReset===!0&&this.info.reset(),this.nodes.nodeFrame.update(),this.info.frame=this.nodes.nodeFrame.frameId,this.animationLoop!==null&&this.animationLoop(i,n)};e()}dispose(){self.cancelAnimationFrame(this.requestId),this.requestId=null}setAnimationLoop(e){this.animationLoop=e}}class qc{constructor(){this.weakMap=new WeakMap}get(e){let i=this.weakMap;for(let n=0;n<e.length;n++)if(i=i.get(e[n]),i===void 0)return;return i.get(e[e.length-1])}set(e,i){let n=this.weakMap;for(let s=0;s<e.length;s++){const o=e[s];n.has(o)===!1&&n.set(o,new WeakMap),n=n.get(o)}return n.set(e[e.length-1],i)}delete(e){let i=this.weakMap;for(let n=0;n<e.length;n++)if(i=i.get(e[n]),i===void 0)return!1;return i.delete(e[e.length-1])}}const mR=new gd;class gR{constructor(){this.version=0,this.globalClippingCount=0,this.localClippingCount=0,this.localClippingEnabled=!1,this.localClipIntersection=!1,this.planes=[],this.parentVersion=0,this.viewNormalMatrix=new qo,this.cacheKey=0}projectPlanes(e,i){const n=e.length,s=this.planes;for(let o=0;o<n;o++){mR.copy(e[o]).applyMatrix4(this.viewMatrix,this.viewNormalMatrix);const l=s[i+o],u=mR.normal;l.x=-u.x,l.y=-u.y,l.z=-u.z,l.w=mR.constant}}updateGlobal(e,i){const n=e.clippingPlanes;this.viewMatrix=i.matrixWorldInverse,this.viewNormalMatrix.getNormalMatrix(this.viewMatrix);let s=!1;if(Array.isArray(n)&&n.length!==0){const o=n.length;if(o!==this.globalClippingCount){const l=[];for(let u=0;u<o;u++)l.push(new es);this.globalClippingCount=o,this.planes=l,s=!0}this.projectPlanes(n,0)}else this.globalClippingCount!==0&&(this.globalClippingCount=0,this.planes=[],s=!0);e.localClippingEnabled!==this.localClippingEnabled&&(this.localClippingEnabled=e.localClippingEnabled,s=!0),s&&(this.version++,this.cacheKey=K1(this.globalClippingCount,this.localClippingEnabled===!0?1:0))}update(e,i){let n=!1;if(this!==e&&e.version!==this.parentVersion&&(this.globalClippingCount=i.isShadowNodeMaterial?0:e.globalClippingCount,this.localClippingEnabled=e.localClippingEnabled,this.planes=Array.from(e.planes),this.parentVersion=e.version,this.viewMatrix=e.viewMatrix,this.viewNormalMatrix=e.viewNormalMatrix,n=!0),this.localClippingEnabled){const s=i.clippingPlanes;if(Array.isArray(s)&&s.length!==0){const o=s.length,l=this.planes,u=this.globalClippingCount;if(n||o!==this.localClippingCount){l.length=u+o;for(let c=0;c<o;c++)l[u+c]=new es;this.localClippingCount=o,n=!0}this.projectPlanes(s,u)}else this.localClippingCount!==0&&(this.localClippingCount=0,n=!0);this.localClipIntersection!==i.clipIntersection&&(this.localClipIntersection=i.clipIntersection,n=!0)}n&&(this.version+=e.version,this.cacheKey=K1(e.cacheKey,this.localClippingCount,this.localClipIntersection===!0?1:0))}}let Yme=0;function Kme(r){const e=Object.keys(r);let i=Object.getPrototypeOf(r);for(;i;){const n=Object.getOwnPropertyDescriptors(i);for(const s in n)if(n[s]!==void 0){const o=n[s];o&&typeof o.get=="function"&&e.push(s)}i=Object.getPrototypeOf(i)}return e}class Jme{constructor(e,i,n,s,o,l,u,c,h){this._nodes=e,this._geometries=i,this.id=Yme++,this.renderer=n,this.object=s,this.material=o,this.scene=l,this.camera=u,this.lightsNode=c,this.context=h,this.geometry=s.geometry,this.version=o.version,this.drawRange=null,this.attributes=null,this.pipeline=null,this.vertexBuffers=null,this.drawParams=null,this.bundle=null,this.updateClipping(h.clippingContext),this.clippingContextVersion=this.clippingContext.version,this.initialNodesCacheKey=this.getDynamicCacheKey(),this.initialCacheKey=this.getCacheKey(),this._nodeBuilderState=null,this._bindings=null,this._monitor=null,this.onDispose=null,this.isRenderObject=!0,this.onMaterialDispose=()=>{this.dispose()},this.material.addEventListener("dispose",this.onMaterialDispose)}updateClipping(e){const i=this.material;let n=this.clippingContext;Array.isArray(i.clippingPlanes)?((n===e||!n)&&(n=new gR,this.clippingContext=n),n.update(e,i)):this.clippingContext!==e&&(this.clippingContext=e)}get clippingNeedsUpdate(){return this.clippingContext.version===this.clippingContextVersion?!1:(this.clippingContextVersion=this.clippingContext.version,!0)}getNodeBuilderState(){return this._nodeBuilderState||(this._nodeBuilderState=this._nodes.getForRender(this))}getMonitor(){return this._monitor||(this._monitor=this.getNodeBuilderState().monitor)}getBindings(){return this._bindings||(this._bindings=this.getNodeBuilderState().createBindings())}getIndex(){return this._geometries.getIndex(this)}getIndirect(){return this._geometries.getIndirect(this)}getChainArray(){return[this.object,this.material,this.context,this.lightsNode]}getAttributes(){if(this.attributes!==null)return this.attributes;const e=this.getNodeBuilderState().nodeAttributes,i=this.geometry,n=[],s=new Set;for(const o of e){const l=o.node&&o.node.attribute?o.node.attribute:i.getAttribute(o.name);if(l===void 0)continue;n.push(l);const u=l.isInterleavedBufferAttribute?l.data:l;s.add(u)}return this.attributes=n,this.vertexBuffers=Array.from(s.values()),n}getVertexBuffers(){return this.vertexBuffers===null&&this.getAttributes(),this.vertexBuffers}getDrawParameters(){const{object:e,material:i,geometry:n,group:s,drawRange:o}=this,l=this.drawParams||(this.drawParams={vertexCount:0,firstVertex:0,instanceCount:0,firstInstance:0}),u=this.getIndex(),c=u!==null,h=n.isInstancedBufferGeometry?n.instanceCount:e.count>1?e.count:1;if(h===0)return null;if(l.instanceCount=h,e.isBatchedMesh===!0)return l;let p=1;i.wireframe===!0&&!e.isPoints&&!e.isLineSegments&&!e.isLine&&!e.isLineLoop&&(p=2);let f=o.start*p,m=(o.start+o.count)*p;s!==null&&(f=Math.max(f,s.start*p),m=Math.min(m,(s.start+s.count)*p));const g=n.attributes.position;let y=1/0;c?y=u.count:g!=null&&(y=g.count),f=Math.max(f,0),m=Math.min(m,y);const x=m-f;return x<0||x===1/0?null:(l.vertexCount=x,l.firstVertex=f,l)}getGeometryCacheKey(){const{geometry:e}=this;let i="";for(const n of Object.keys(e.attributes).sort()){const s=e.attributes[n];i+=n+",",s.data&&(i+=s.data.stride+","),s.offset&&(i+=s.offset+","),s.itemSize&&(i+=s.itemSize+","),s.normalized&&(i+="n,")}return e.index&&(i+="index,"),i}getMaterialCacheKey(){const{object:e,material:i}=this;let n=i.customProgramCacheKey();for(const s of Kme(i)){if(/^(is[A-Z]|_)|^(visible|version|uuid|name|opacity|userData)$/.test(s))continue;const o=i[s];let l;if(o!==null){const u=typeof o;u==="number"?l=o!==0?"1":"0":u==="object"?(l="{",o.isTexture&&(l+=o.mapping),l+="}"):l=String(o)}else l=String(o);n+=l+","}return n+=this.clippingContext.cacheKey+",",e.geometry&&(n+=this.getGeometryCacheKey()),e.skeleton&&(n+=e.skeleton.bones.length+","),e.morphTargetInfluences&&(n+=e.morphTargetInfluences.length+","),e.isBatchedMesh&&(n+=e._matricesTexture.uuid+",",e._colorsTexture!==null&&(n+=e._colorsTexture.uuid+",")),e.count>1&&(n+=e.uuid+","),Wue(n)}get needsUpdate(){return this.initialNodesCacheKey!==this.getDynamicCacheKey()||this.clippingNeedsUpdate}getDynamicCacheKey(){let e=this._nodes.getCacheKey(this.scene,this.lightsNode);return this.object.receiveShadow&&(e+=1),e}getCacheKey(){return this.getMaterialCacheKey()+this.getDynamicCacheKey()}dispose(){this.material.removeEventListener("dispose",this.onMaterialDispose),this.onDispose()}}const Lg=[];class Zme{constructor(e,i,n,s,o,l){this.renderer=e,this.nodes=i,this.geometries=n,this.pipelines=s,this.bindings=o,this.info=l,this.chainMaps={}}get(e,i,n,s,o,l,u){const c=this.getChainMap(u);Lg[0]=e,Lg[1]=i,Lg[2]=l,Lg[3]=o;let h=c.get(Lg);return h===void 0?(h=this.createRenderObject(this.nodes,this.geometries,this.renderer,e,i,n,s,o,l,u),c.set(Lg,h)):(h.updateClipping(l.clippingContext),(h.version!==i.version||h.needsUpdate)&&(h.initialCacheKey!==h.getCacheKey()?(h.dispose(),h=this.get(e,i,n,s,o,l,u)):h.version=i.version)),h}getChainMap(e="default"){return this.chainMaps[e]||(this.chainMaps[e]=new qc)}dispose(){this.chainMaps={}}createRenderObject(e,i,n,s,o,l,u,c,h,p){const f=this.getChainMap(p),m=new Jme(e,i,n,s,o,l,u,c,h);return m.onDispose=()=>{this.pipelines.delete(m),this.bindings.delete(m),this.nodes.delete(m),f.delete(m.getChainArray())},m}}class Ed{constructor(){this.data=new WeakMap}get(e){let i=this.data.get(e);return i===void 0&&(i={},this.data.set(e,i)),i}delete(e){let i;return this.data.has(e)&&(i=this.data.get(e),this.data.delete(e)),i}has(e){return this.data.has(e)}dispose(){this.data=new WeakMap}}const Xc={VERTEX:1,INDEX:2,STORAGE:3,INDIRECT:4},wd=16,$me=211,ege=212;class tge extends Ed{constructor(e){super(),this.backend=e}delete(e){const i=super.delete(e);return i!==void 0&&this.backend.destroyAttribute(e),i}update(e,i){const n=this.get(e);if(n.version===void 0)i===Xc.VERTEX?this.backend.createAttribute(e):i===Xc.INDEX?this.backend.createIndexAttribute(e):i===Xc.STORAGE?this.backend.createStorageAttribute(e):i===Xc.INDIRECT&&this.backend.createIndirectStorageAttribute(e),n.version=this._getBufferAttribute(e).version;else{const s=this._getBufferAttribute(e);(n.version<s.version||s.usage===sg)&&(this.backend.updateAttribute(e),n.version=s.version)}}_getBufferAttribute(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}}function ige(r){for(let e=r.length-1;e>=0;--e)if(r[e]>=65535)return!0;return!1}function $8(r){return r.index!==null?r.index.version:r.attributes.position.version}function ez(r){const e=[],i=r.index,n=r.attributes.position;if(i!==null){const o=i.array;for(let l=0,u=o.length;l<u;l+=3){const c=o[l+0],h=o[l+1],p=o[l+2];e.push(c,h,h,p,p,c)}}else{const o=n.array;for(let l=0,u=o.length/3-1;l<u;l+=3){const c=l+0,h=l+1,p=l+2;e.push(c,h,h,p,p,c)}}const s=new(ige(e)?I5:R5)(e,1);return s.version=$8(r),s}class rge extends Ed{constructor(e,i){super(),this.attributes=e,this.info=i,this.wireframes=new WeakMap,this.attributeCall=new WeakMap}has(e){const i=e.geometry;return super.has(i)&&this.get(i).initialized===!0}updateForRender(e){this.has(e)===!1&&this.initGeometry(e),this.updateAttributes(e)}initGeometry(e){const i=e.geometry,n=this.get(i);n.initialized=!0,this.info.memory.geometries++;const s=()=>{this.info.memory.geometries--;const o=i.index,l=e.getAttributes();o!==null&&this.attributes.delete(o);for(const c of l)this.attributes.delete(c);const u=this.wireframes.get(i);u!==void 0&&this.attributes.delete(u),i.removeEventListener("dispose",s)};i.addEventListener("dispose",s)}updateAttributes(e){const i=e.getAttributes();for(const o of i)o.isStorageBufferAttribute||o.isStorageInstancedBufferAttribute?this.updateAttribute(o,Xc.STORAGE):this.updateAttribute(o,Xc.VERTEX);const n=this.getIndex(e);n!==null&&this.updateAttribute(n,Xc.INDEX);const s=e.geometry.indirect;s!==null&&this.updateAttribute(s,Xc.INDIRECT)}updateAttribute(e,i){const n=this.info.render.calls;e.isInterleavedBufferAttribute?this.attributeCall.get(e)===void 0?(this.attributes.update(e,i),this.attributeCall.set(e,n)):this.attributeCall.get(e.data)!==n&&(this.attributes.update(e,i),this.attributeCall.set(e.data,n),this.attributeCall.set(e,n)):this.attributeCall.get(e)!==n&&(this.attributes.update(e,i),this.attributeCall.set(e,n))}getIndirect(e){return e.geometry.indirect}getIndex(e){const{geometry:i,material:n}=e;let s=i.index;if(n.wireframe===!0){const o=this.wireframes;let l=o.get(i);l===void 0?(l=ez(i),o.set(i,l)):l.version!==$8(i)&&(this.attributes.delete(l),l=ez(i),o.set(i,l)),s=l}return s}}class nge{constructor(){this.autoReset=!0,this.frame=0,this.calls=0,this.render={calls:0,frameCalls:0,drawCalls:0,triangles:0,points:0,lines:0,timestamp:0,previousFrameCalls:0,timestampCalls:0},this.compute={calls:0,frameCalls:0,timestamp:0,previousFrameCalls:0,timestampCalls:0},this.memory={geometries:0,textures:0}}update(e,i,n){this.render.drawCalls++,e.isMesh||e.isSprite?this.render.triangles+=n*(i/3):e.isPoints?this.render.points+=n*i:e.isLineSegments?this.render.lines+=n*(i/2):e.isLine?this.render.lines+=n*(i-1):console.error("THREE.WebGPUInfo: Unknown object type.")}updateTimestamp(e,i){this[e].timestampCalls===0&&(this[e].timestamp=0),this[e].timestamp+=i,this[e].timestampCalls++,this[e].timestampCalls>=this[e].previousFrameCalls&&(this[e].timestampCalls=0)}reset(){const e=this.render.frameCalls;this.render.previousFrameCalls=e;const i=this.compute.frameCalls;this.compute.previousFrameCalls=i,this.render.drawCalls=0,this.render.frameCalls=0,this.compute.frameCalls=0,this.render.triangles=0,this.render.points=0,this.render.lines=0}dispose(){this.reset(),this.calls=0,this.render.calls=0,this.compute.calls=0,this.render.timestamp=0,this.compute.timestamp=0,this.memory.geometries=0,this.memory.textures=0}}class tz{constructor(e){this.cacheKey=e,this.usedTimes=0}}class sge extends tz{constructor(e,i,n){super(e),this.vertexProgram=i,this.fragmentProgram=n}}class age extends tz{constructor(e,i){super(e),this.computeProgram=i,this.isComputePipeline=!0}}let oge=0;class AR{constructor(e,i,n=null,s=null){this.id=oge++,this.code=e,this.stage=i,this.transforms=n,this.attributes=s,this.usedTimes=0}}class lge extends Ed{constructor(e,i){super(),this.backend=e,this.nodes=i,this.bindings=null,this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}getForCompute(e,i){const{backend:n}=this,s=this.get(e);if(this._needsComputeUpdate(e)){const o=s.pipeline;o&&(o.usedTimes--,o.computeProgram.usedTimes--);const l=this.nodes.getForCompute(e);let u=this.programs.compute.get(l.computeShader);u===void 0&&(o&&o.computeProgram.usedTimes===0&&this._releaseProgram(o.computeProgram),u=new AR(l.computeShader,"compute",l.transforms,l.nodeAttributes),this.programs.compute.set(l.computeShader,u),n.createProgram(u));const c=this._getComputeCacheKey(e,u);let h=this.caches.get(c);h===void 0&&(o&&o.usedTimes===0&&this._releasePipeline(o),h=this._getComputePipeline(e,u,c,i)),h.usedTimes++,u.usedTimes++,s.version=e.version,s.pipeline=h}return s.pipeline}getForRender(e,i=null){const{backend:n}=this,s=this.get(e);if(this._needsRenderUpdate(e)){const o=s.pipeline;o&&(o.usedTimes--,o.vertexProgram.usedTimes--,o.fragmentProgram.usedTimes--);const l=e.getNodeBuilderState();let u=this.programs.vertex.get(l.vertexShader);u===void 0&&(o&&o.vertexProgram.usedTimes===0&&this._releaseProgram(o.vertexProgram),u=new AR(l.vertexShader,"vertex"),this.programs.vertex.set(l.vertexShader,u),n.createProgram(u));let c=this.programs.fragment.get(l.fragmentShader);c===void 0&&(o&&o.fragmentProgram.usedTimes===0&&this._releaseProgram(o.fragmentProgram),c=new AR(l.fragmentShader,"fragment"),this.programs.fragment.set(l.fragmentShader,c),n.createProgram(c));const h=this._getRenderCacheKey(e,u,c);let p=this.caches.get(h);p===void 0?(o&&o.usedTimes===0&&this._releasePipeline(o),p=this._getRenderPipeline(e,u,c,h,i)):e.pipeline=p,p.usedTimes++,u.usedTimes++,c.usedTimes++,s.pipeline=p}return s.pipeline}delete(e){const i=this.get(e).pipeline;return i&&(i.usedTimes--,i.usedTimes===0&&this._releasePipeline(i),i.isComputePipeline?(i.computeProgram.usedTimes--,i.computeProgram.usedTimes===0&&this._releaseProgram(i.computeProgram)):(i.fragmentProgram.usedTimes--,i.vertexProgram.usedTimes--,i.vertexProgram.usedTimes===0&&this._releaseProgram(i.vertexProgram),i.fragmentProgram.usedTimes===0&&this._releaseProgram(i.fragmentProgram))),super.delete(e)}dispose(){super.dispose(),this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}updateForRender(e){this.getForRender(e)}_getComputePipeline(e,i,n,s){n=n||this._getComputeCacheKey(e,i);let o=this.caches.get(n);return o===void 0&&(o=new age(n,i),this.caches.set(n,o),this.backend.createComputePipeline(o,s)),o}_getRenderPipeline(e,i,n,s,o){s=s||this._getRenderCacheKey(e,i,n);let l=this.caches.get(s);return l===void 0&&(l=new sge(s,i,n),this.caches.set(s,l),e.pipeline=l,this.backend.createRenderPipeline(e,o)),l}_getComputeCacheKey(e,i){return e.id+","+i.id}_getRenderCacheKey(e,i,n){return i.id+","+n.id+","+this.backend.getRenderCacheKey(e)}_releasePipeline(e){this.caches.delete(e.cacheKey)}_releaseProgram(e){const i=e.code,n=e.stage;this.programs[n].delete(i)}_needsComputeUpdate(e){const i=this.get(e);return i.pipeline===void 0||i.version!==e.version}_needsRenderUpdate(e){return this.get(e).pipeline===void 0||this.backend.needsRenderUpdate(e)}}class cge extends Ed{constructor(e,i,n,s,o,l){super(),this.backend=e,this.textures=n,this.pipelines=o,this.attributes=s,this.nodes=i,this.info=l,this.pipelines.bindings=this}getForRender(e){const i=e.getBindings();for(const n of i){const s=this.get(n);s.bindGroup===void 0&&(this._init(n),this.backend.createBindings(n,i),s.bindGroup=n)}return i}getForCompute(e){const i=this.nodes.getForCompute(e).bindings;for(const n of i){const s=this.get(n);s.bindGroup===void 0&&(this._init(n),this.backend.createBindings(n,i),s.bindGroup=n)}return i}updateForCompute(e){this._updateBindings(this.getForCompute(e))}updateForRender(e){this._updateBindings(this.getForRender(e))}_updateBindings(e){for(const i of e)this._update(i,e)}_init(e){for(const i of e.bindings)if(i.isSampledTexture)this.textures.updateTexture(i.texture);else if(i.isStorageBuffer){const n=i.attribute,s=n.isIndirectStorageBufferAttribute?Xc.INDIRECT:Xc.STORAGE;this.attributes.update(n,s)}}_update(e,i){const{backend:n}=this;let s=!1;for(const o of e.bindings)if(!(o.isNodeUniformsGroup&&!this.nodes.updateGroup(o))){if(o.isUniformBuffer)o.update()&&n.updateBinding(o);else if(o.isSampler)o.update();else if(o.isSampledTexture){o.needsBindingsUpdate(this.textures.get(o.texture).generation)&&(s=!0);const l=o.update(),u=o.texture;l&&this.textures.updateTexture(u);const c=n.get(u);if(n.isWebGPUBackend===!0&&c.texture===void 0&&c.externalTexture===void 0&&(console.error("Bindings._update: binding should be available:",o,l,u,o.textureNode.value,s),this.textures.updateTexture(u),s=!0),u.isStorageTexture===!0){const h=this.get(u);o.store===!0?h.needsMipmap=!0:this.textures.needsMipmaps(u)&&h.needsMipmap===!0&&(this.backend.generateMipmaps(u),h.needsMipmap=!1)}}}s===!0&&this.backend.updateBindings(e,i)}}function uge(r,e){return r.groupOrder!==e.groupOrder?r.groupOrder-e.groupOrder:r.renderOrder!==e.renderOrder?r.renderOrder-e.renderOrder:r.material.id!==e.material.id?r.material.id-e.material.id:r.z!==e.z?r.z-e.z:r.id-e.id}function iz(r,e){return r.groupOrder!==e.groupOrder?r.groupOrder-e.groupOrder:r.renderOrder!==e.renderOrder?r.renderOrder-e.renderOrder:r.z!==e.z?e.z-r.z:r.id-e.id}function rz(r){return(r.transmission>0||r.transmissionNode)&&r.side===Km&&r.forceSinglePass===!1}class hge{constructor(e,i,n){this.renderItems=[],this.renderItemsIndex=0,this.opaque=[],this.transparentDoublePass=[],this.transparent=[],this.bundles=[],this.lightsNode=e.getNode(i,n),this.lightsArray=[],this.scene=i,this.camera=n,this.occlusionQueryCount=0}begin(){return this.renderItemsIndex=0,this.opaque.length=0,this.transparentDoublePass.length=0,this.transparent.length=0,this.bundles.length=0,this.lightsArray.length=0,this.occlusionQueryCount=0,this}getNextRenderItem(e,i,n,s,o,l){let u=this.renderItems[this.renderItemsIndex];return u===void 0?(u={id:e.id,object:e,geometry:i,material:n,groupOrder:s,renderOrder:e.renderOrder,z:o,group:l},this.renderItems[this.renderItemsIndex]=u):(u.id=e.id,u.object=e,u.geometry=i,u.material=n,u.groupOrder=s,u.renderOrder=e.renderOrder,u.z=o,u.group=l),this.renderItemsIndex++,u}push(e,i,n,s,o,l){const u=this.getNextRenderItem(e,i,n,s,o,l);e.occlusionTest===!0&&this.occlusionQueryCount++,n.transparent===!0||n.transmission>0?(rz(n)&&this.transparentDoublePass.push(u),this.transparent.push(u)):this.opaque.push(u)}unshift(e,i,n,s,o,l){const u=this.getNextRenderItem(e,i,n,s,o,l);n.transparent===!0||n.transmission>0?(rz(n)&&this.transparentDoublePass.unshift(u),this.transparent.unshift(u)):this.opaque.unshift(u)}pushBundle(e){this.bundles.push(e)}pushLight(e){this.lightsArray.push(e)}sort(e,i){this.opaque.length>1&&this.opaque.sort(e||uge),this.transparentDoublePass.length>1&&this.transparentDoublePass.sort(i||iz),this.transparent.length>1&&this.transparent.sort(i||iz)}finish(){this.lightsNode.setLights(this.lightsArray);for(let e=this.renderItemsIndex,i=this.renderItems.length;e<i;e++){const n=this.renderItems[e];if(n.id===null)break;n.id=null,n.object=null,n.geometry=null,n.material=null,n.groupOrder=null,n.renderOrder=null,n.z=null,n.group=null}}}class dge{constructor(e){this.lighting=e,this.lists=new qc}get(e,i){const n=this.lists,s=[e,i];let o=n.get(s);return o===void 0&&(o=new hge(this.lighting,e,i),n.set(s,o)),o}dispose(){this.lists=new qc}}let pge=0;class fge{constructor(){this.id=pge++,this.color=!0,this.clearColor=!0,this.clearColorValue={r:0,g:0,b:0,a:1},this.depth=!0,this.clearDepth=!0,this.clearDepthValue=1,this.stencil=!1,this.clearStencil=!0,this.clearStencilValue=1,this.viewport=!1,this.viewportValue=new es,this.scissor=!1,this.scissorValue=new es,this.textures=null,this.depthTexture=null,this.activeCubeFace=0,this.sampleCount=1,this.width=0,this.height=0,this.isRenderContext=!0}getCacheKey(){return nz(this)}}function nz(r){const{textures:e,activeCubeFace:i}=r,n=[i];for(const s of e)n.push(s.id);return r6(n)}class mge{constructor(){this.chainMaps={}}get(e,i,n=null){const s=[e,i];let o;if(n===null)o="default";else{const c=n.texture.format;o=`${n.textures.length}:${c}:${n.samples}:${n.depthBuffer}:${n.stencilBuffer}`}const l=this.getChainMap(o);let u=l.get(s);return u===void 0&&(u=new fge,l.set(s,u)),n!==null&&(u.sampleCount=n.samples===0?1:n.samples),u}getChainMap(e){return this.chainMaps[e]||(this.chainMaps[e]=new qc)}dispose(){this.chainMaps={}}}const gge=new Rt;class Age extends Ed{constructor(e,i,n){super(),this.renderer=e,this.backend=i,this.info=n}updateRenderTarget(e,i=0){const n=this.get(e),s=e.samples===0?1:e.samples,o=n.depthTextureMips||(n.depthTextureMips={}),l=e.textures,u=this.getSize(l[0]),c=u.width>>i,h=u.height>>i;let p=e.depthTexture||o[i];const f=e.depthBuffer===!0||e.stencilBuffer===!0;let m=!1;p===void 0&&f&&(p=new bg,p.format=e.stencilBuffer?ng:Ip,p.type=e.stencilBuffer?$A:ja,p.image.width=c,p.image.height=h,o[i]=p),(n.width!==u.width||u.height!==n.height)&&(m=!0,p&&(p.needsUpdate=!0,p.image.width=c,p.image.height=h)),n.width=u.width,n.height=u.height,n.textures=l,n.depthTexture=p||null,n.depth=e.depthBuffer,n.stencil=e.stencilBuffer,n.renderTarget=e,n.sampleCount!==s&&(m=!0,p&&(p.needsUpdate=!0),n.sampleCount=s);const g={sampleCount:s};for(let y=0;y<l.length;y++){const x=l[y];m&&(x.needsUpdate=!0),this.updateTexture(x,g)}if(p&&this.updateTexture(p,g),n.initialized!==!0){n.initialized=!0;const y=()=>{e.removeEventListener("dispose",y);for(let x=0;x<l.length;x++)this._destroyTexture(l[x]);p&&this._destroyTexture(p),this.delete(e)};e.addEventListener("dispose",y)}}updateTexture(e,i={}){const n=this.get(e);if(n.initialized===!0&&n.version===e.version)return;const s=e.isRenderTargetTexture||e.isDepthTexture||e.isFramebufferTexture,o=this.backend;if(s&&n.initialized===!0&&(o.destroySampler(e),o.destroyTexture(e)),e.isFramebufferTexture){const h=this.renderer.getRenderTarget();h?e.type=h.texture.type:e.type=od}const{width:l,height:u,depth:c}=this.getSize(e);if(i.width=l,i.height=u,i.depth=c,i.needsMipmaps=this.needsMipmaps(e),i.levels=i.needsMipmaps?this.getMipLevels(e,l,u):1,s||e.isStorageTexture===!0)o.createSampler(e),o.createTexture(e,i),n.generation=e.version;else if(n.initialized!==!0&&o.createSampler(e),e.version>0){const h=e.image;if(h===void 0)console.warn("THREE.Renderer: Texture marked for update but image is undefined.");else if(h.complete===!1)console.warn("THREE.Renderer: Texture marked for update but image is incomplete.");else{if(e.images){const p=[];for(const f of e.images)p.push(f);i.images=p}else i.image=h;(n.isDefaultTexture===void 0||n.isDefaultTexture===!0)&&(o.createTexture(e,i),n.isDefaultTexture=!1,n.generation=e.version),e.source.dataReady===!0&&o.updateTexture(e,i),i.needsMipmaps&&e.mipmaps.length===0&&o.generateMipmaps(e)}}else o.createDefaultTexture(e),n.isDefaultTexture=!0,n.generation=e.version;if(n.initialized!==!0){n.initialized=!0,n.generation=e.version,this.info.memory.textures++;const h=()=>{e.removeEventListener("dispose",h),this._destroyTexture(e),this.info.memory.textures--};e.addEventListener("dispose",h)}n.version=e.version}getSize(e,i=gge){let n=e.images?e.images[0]:e.image;return n?(n.image!==void 0&&(n=n.image),i.width=n.width,i.height=n.height,i.depth=e.isCubeTexture?6:n.depth||1):i.width=i.height=i.depth=1,i}getMipLevels(e,i,n){let s;return e.isCompressedTexture?s=e.mipmaps.length:s=Math.floor(Math.log2(Math.max(i,n)))+1,s}needsMipmaps(e){return this.isEnvironmentTexture(e)||e.isCompressedTexture===!0||e.generateMipmaps}isEnvironmentTexture(e){const i=e.mapping;return i===YA||i===KA||i===Rp||i===$m}_destroyTexture(e){this.backend.destroySampler(e),this.backend.destroyTexture(e),this.delete(e)}}class yR extends ts{constructor(e,i,n,s=1){super(e,i,n),this.a=s}set(e,i,n,s=1){return this.a=s,super.set(e,i,n)}copy(e){return e.a!==void 0&&(this.a=e.a),super.copy(e)}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}}class yge extends is{static get type(){return"ParameterNode"}constructor(e,i=null){super(e,i),this.isParameterNode=!0}getHash(){return this.uuid}generate(){return this.name}}class vge extends nn{static get type(){return"StackNode"}constructor(e=null){super(),this.nodes=[],this.outputNode=null,this.parent=e,this._currentCond=null,this.isStackNode=!0}getNodeType(e){return this.outputNode?this.outputNode.getNodeType(e):"void"}add(e){return this.nodes.push(e),this}If(e,i){const n=new t_(i);return this._currentCond=Yo(e,n),this.add(this._currentCond)}ElseIf(e,i){const n=new t_(i),s=Yo(e,n);return this._currentCond.elseNode=s,this._currentCond=s,this}Else(e){return this._currentCond.elseNode=new t_(e),this}build(e,...i){const n=y6();r_(this);for(const s of this.nodes)s.build(e,"void");return r_(n),this.outputNode?this.outputNode.build(e,...i):super.build(e,...i)}else(...e){return console.warn("TSL.StackNode: .else() has been renamed to .Else()."),this.Else(...e)}elseif(...e){return console.warn("TSL.StackNode: .elseif() has been renamed to .ElseIf()."),this.ElseIf(...e)}}const vR=li(vge);new gd,new Rt,new Rt,new Rt,new Cs,new Rt(0,0,-1),new es,new Rt,new Rt,new es,new Pn;const xge=new cg;Iy.flipX(),xge.depthTexture=new bg(1,1);const xR=new C3(-1,1,1,-1,0,1);class bge extends Pp{constructor(e=!1){super();const i=e===!1?[0,-1,0,1,2,1]:[0,2,0,0,2,0];this.setAttribute("position",new Yu([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new Yu(i,2))}}const _ge=new bge;class sz extends Fp{constructor(e=null){super(_ge,e),this.camera=xR,this.isQuadMesh=!0}renderAsync(e){return e.renderAsync(this,xR)}render(e){e.render(this,xR)}}const Oy=new Ac,bR=new Cs;class Jo extends nn{static get type(){return"SceneNode"}constructor(e=Jo.BACKGROUND_BLURRINESS,i=null){super(),this.scope=e,this.scene=i}setup(e){const i=this.scope,n=this.scene!==null?this.scene:e.scene;let s;return i===Jo.BACKGROUND_BLURRINESS?s=Ns("backgroundBlurriness","float",n):i===Jo.BACKGROUND_INTENSITY?s=Ns("backgroundIntensity","float",n):i===Jo.BACKGROUND_ROTATION?s=en("mat4").label("backgroundRotation").setGroup(Mn).onRenderUpdate(()=>{const o=n.background;return o!==null&&o.isTexture&&o.mapping!==vM?(Oy.copy(n.backgroundRotation),Oy.x*=-1,Oy.y*=-1,Oy.z*=-1,bR.makeRotationFromEuler(Oy)):bR.identity(),bR}):console.error("THREE.SceneNode: Unknown scope:",i),s}}Jo.BACKGROUND_BLURRINESS="backgroundBlurriness",Jo.BACKGROUND_INTENSITY="backgroundIntensity",Jo.BACKGROUND_ROTATION="backgroundRotation";const Ege=Yi(Jo,Jo.BACKGROUND_BLURRINESS),az=Yi(Jo,Jo.BACKGROUND_INTENSITY),wge=Yi(Jo,Jo.BACKGROUND_ROTATION),Dg={PointList:"point-list",LineList:"line-list",LineStrip:"line-strip",TriangleList:"triangle-list",TriangleStrip:"triangle-strip"},Qa={Never:"never",Less:"less",Equal:"equal",LessEqual:"less-equal",Greater:"greater",NotEqual:"not-equal",GreaterEqual:"greater-equal",Always:"always"},qa={Store:"store"},aa={Load:"load",Clear:"clear"},_R={CCW:"ccw"},ER={None:"none",Front:"front",Back:"back"},Og={Uint16:"uint16",Uint32:"uint32"},ht={R8Unorm:"r8unorm",R8Snorm:"r8snorm",R8Uint:"r8uint",R8Sint:"r8sint",R16Uint:"r16uint",R16Sint:"r16sint",R16Float:"r16float",RG8Unorm:"rg8unorm",RG8Snorm:"rg8snorm",RG8Uint:"rg8uint",RG8Sint:"rg8sint",R32Uint:"r32uint",R32Sint:"r32sint",R32Float:"r32float",RG16Uint:"rg16uint",RG16Sint:"rg16sint",RG16Float:"rg16float",RGBA8Unorm:"rgba8unorm",RGBA8UnormSRGB:"rgba8unorm-srgb",RGBA8Snorm:"rgba8snorm",RGBA8Uint:"rgba8uint",RGBA8Sint:"rgba8sint",BGRA8Unorm:"bgra8unorm",BGRA8UnormSRGB:"bgra8unorm-srgb",RGB9E5UFloat:"rgb9e5ufloat",RGB10A2Unorm:"rgb10a2unorm",RG32Uint:"rg32uint",RG32Sint:"rg32sint",RG32Float:"rg32float",RGBA16Uint:"rgba16uint",RGBA16Sint:"rgba16sint",RGBA16Float:"rgba16float",RGBA32Uint:"rgba32uint",RGBA32Sint:"rgba32sint",RGBA32Float:"rgba32float",Depth16Unorm:"depth16unorm",Depth24Plus:"depth24plus",Depth24PlusStencil8:"depth24plus-stencil8",Depth32Float:"depth32float",Depth32FloatStencil8:"depth32float-stencil8",BC1RGBAUnorm:"bc1-rgba-unorm",BC1RGBAUnormSRGB:"bc1-rgba-unorm-srgb",BC2RGBAUnorm:"bc2-rgba-unorm",BC2RGBAUnormSRGB:"bc2-rgba-unorm-srgb",BC3RGBAUnorm:"bc3-rgba-unorm",BC3RGBAUnormSRGB:"bc3-rgba-unorm-srgb",BC4RUnorm:"bc4-r-unorm",BC5RGUnorm:"bc5-rg-unorm",BC5RGSnorm:"bc5-rg-snorm",BC6HRGBUFloat:"bc6h-rgb-ufloat",BC6HRGBFloat:"bc6h-rgb-float",BC7RGBAUnorm:"bc7-rgba-unorm",BC7RGBAUnormSRGB:"bc7-rgba-srgb",ETC2RGB8Unorm:"etc2-rgb8unorm",ETC2RGB8UnormSRGB:"etc2-rgb8unorm-srgb",ETC2RGB8A1Unorm:"etc2-rgb8a1unorm",ETC2RGB8A1UnormSRGB:"etc2-rgb8a1unorm-srgb",ETC2RGBA8Unorm:"etc2-rgba8unorm",ETC2RGBA8UnormSRGB:"etc2-rgba8unorm-srgb",EACR11Unorm:"eac-r11unorm",EACR11Snorm:"eac-r11snorm",EACRG11Unorm:"eac-rg11unorm",EACRG11Snorm:"eac-rg11snorm",ASTC4x4Unorm:"astc-4x4-unorm",ASTC4x4UnormSRGB:"astc-4x4-unorm-srgb",ASTC5x4Unorm:"astc-5x4-unorm",ASTC5x4UnormSRGB:"astc-5x4-unorm-srgb",ASTC5x5Unorm:"astc-5x5-unorm",ASTC5x5UnormSRGB:"astc-5x5-unorm-srgb",ASTC6x5Unorm:"astc-6x5-unorm",ASTC6x5UnormSRGB:"astc-6x5-unorm-srgb",ASTC6x6Unorm:"astc-6x6-unorm",ASTC6x6UnormSRGB:"astc-6x6-unorm-srgb",ASTC8x5Unorm:"astc-8x5-unorm",ASTC8x5UnormSRGB:"astc-8x5-unorm-srgb",ASTC8x6Unorm:"astc-8x6-unorm",ASTC8x6UnormSRGB:"astc-8x6-unorm-srgb",ASTC8x8Unorm:"astc-8x8-unorm",ASTC8x8UnormSRGB:"astc-8x8-unorm-srgb",ASTC10x5Unorm:"astc-10x5-unorm",ASTC10x5UnormSRGB:"astc-10x5-unorm-srgb",ASTC10x6Unorm:"astc-10x6-unorm",ASTC10x6UnormSRGB:"astc-10x6-unorm-srgb",ASTC10x8Unorm:"astc-10x8-unorm",ASTC10x8UnormSRGB:"astc-10x8-unorm-srgb",ASTC10x10Unorm:"astc-10x10-unorm",ASTC10x10UnormSRGB:"astc-10x10-unorm-srgb",ASTC12x10Unorm:"astc-12x10-unorm",ASTC12x10UnormSRGB:"astc-12x10-unorm-srgb",ASTC12x12Unorm:"astc-12x12-unorm",ASTC12x12UnormSRGB:"astc-12x12-unorm-srgb"},wR={ClampToEdge:"clamp-to-edge",Repeat:"repeat",MirrorRepeat:"mirror-repeat"},qp={Linear:"linear",Nearest:"nearest"},Xr={Zero:"zero",One:"one",Src:"src",OneMinusSrc:"one-minus-src",SrcAlpha:"src-alpha",OneMinusSrcAlpha:"one-minus-src-alpha",Dst:"dst",OneMinusDstColor:"one-minus-dst",DstAlpha:"dst-alpha",OneMinusDstAlpha:"one-minus-dst-alpha",SrcAlphaSaturated:"src-alpha-saturated",Constant:"constant",OneMinusConstant:"one-minus-constant"},Xp={Add:"add",Subtract:"subtract",ReverseSubtract:"reverse-subtract",Min:"min",Max:"max"},oz={None:0,All:15},Cd={Keep:"keep",Zero:"zero",Replace:"replace",Invert:"invert",IncrementClamp:"increment-clamp",DecrementClamp:"decrement-clamp",IncrementWrap:"increment-wrap",DecrementWrap:"decrement-wrap"},CR={Storage:"storage",ReadOnlyStorage:"read-only-storage"},lz={WriteOnly:"write-only",ReadOnly:"read-only"},Py={Float:"float",UnfilterableFloat:"unfilterable-float",Depth:"depth",SInt:"sint",UInt:"uint"},cz={TwoD:"2d",ThreeD:"3d"},Fl={TwoD:"2d",TwoDArray:"2d-array",Cube:"cube",ThreeD:"3d"},Cge={All:"all"},C_={Vertex:"vertex",Instance:"instance"},SR={DepthClipControl:"depth-clip-control",Depth32FloatStencil8:"depth32float-stencil8",TextureCompressionBC:"texture-compression-bc",TextureCompressionETC2:"texture-compression-etc2",TextureCompressionASTC:"texture-compression-astc",TimestampQuery:"timestamp-query",IndirectFirstInstance:"indirect-first-instance",ShaderF16:"shader-f16",RG11B10UFloat:"rg11b10ufloat-renderable",BGRA8UNormStorage:"bgra8unorm-storage",Float32Filterable:"float32-filterable",ClipDistances:"clip-distances",DualSourceBlending:"dual-source-blending",Subgroups:"subgroups"},Sge=new Pn;class Tge extends _y{static get type(){return"PassTextureNode"}constructor(e,i){super(i),this.passNode=e,this.setUpdateMatrix(!1)}setup(e){return e.object.isQuadMesh&&this.passNode.build(e),super.setup(e)}clone(){return new this.constructor(this.passNode,this.value)}}class uz extends Tge{static get type(){return"PassMultipleTextureNode"}constructor(e,i,n=!1){super(e,null),this.textureName=i,this.previousTexture=n}updateTexture(){this.value=this.previousTexture?this.passNode.getPreviousTexture(this.textureName):this.passNode.getTexture(this.textureName)}setup(e){return this.updateTexture(),super.setup(e)}clone(){return new this.constructor(this.passNode,this.textureName,this.previousTexture)}}class S_ extends ta{static get type(){return"PassNode"}constructor(e,i,n,s={}){super("vec4"),this.scope=e,this.scene=i,this.camera=n,this.options=s,this._pixelRatio=1,this._width=1,this._height=1;const o=new bg;o.isRenderTargetTexture=!0,o.name="depth";const l=new cg(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:zu,...s});l.texture.name="output",l.depthTexture=o,this.renderTarget=l,this.updateBeforeType=dn.FRAME,this._textures={output:l.texture,depth:o},this._textureNodes={},this._linearDepthNodes={},this._viewZNodes={},this._previousTextures={},this._previousTextureNodes={},this._cameraNear=en(0),this._cameraFar=en(0),this._mrt=null,this.isPassNode=!0}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}isGlobal(){return!0}getTexture(e){let i=this._textures[e];return i===void 0&&(i=this.renderTarget.texture.clone(),i.isRenderTargetTexture=!0,i.name=e,this._textures[e]=i,this.renderTarget.textures.push(i)),i}getPreviousTexture(e){let i=this._previousTextures[e];return i===void 0&&(i=this.getTexture(e).clone(),i.isRenderTargetTexture=!0,this._previousTextures[e]=i),i}toggleTexture(e){const i=this._previousTextures[e];if(i!==void 0){const n=this._textures[e],s=this.renderTarget.textures.indexOf(n);this.renderTarget.textures[s]=i,this._textures[e]=i,this._previousTextures[e]=n,this._textureNodes[e].updateTexture(),this._previousTextureNodes[e].updateTexture()}}getTextureNode(e="output"){let i=this._textureNodes[e];return i===void 0&&(i=Ci(new uz(this,e)),i.updateTexture(),this._textureNodes[e]=i),i}getPreviousTextureNode(e="output"){let i=this._previousTextureNodes[e];return i===void 0&&(this._textureNodes[e]===void 0&&this.getTextureNode(e),i=Ci(new uz(this,e,!0)),i.updateTexture(),this._previousTextureNodes[e]=i),i}getViewZNode(e="depth"){let i=this._viewZNodes[e];if(i===void 0){const n=this._cameraNear,s=this._cameraFar;this._viewZNodes[e]=i=m8(this.getTextureNode(e),n,s)}return i}getLinearDepthNode(e="depth"){let i=this._linearDepthNodes[e];if(i===void 0){const n=this._cameraNear,s=this._cameraFar,o=this.getViewZNode(e);this._linearDepthNodes[e]=i=Ny(o,n,s)}return i}setup({renderer:e}){return this.renderTarget.samples=this.options.samples===void 0?e.samples:this.options.samples,e.backend.isWebGLBackend===!0&&(this.renderTarget.samples=0),this.renderTarget.depthTexture.isMultisampleRenderTargetTexture=this.renderTarget.samples>1,this.scope===S_.COLOR?this.getTextureNode():this.getLinearDepthNode()}updateBefore(e){const{renderer:i}=e,{scene:n,camera:s}=this;this._pixelRatio=i.getPixelRatio();const o=i.getSize(Sge);this.setSize(o.width,o.height);const l=i.getRenderTarget(),u=i.getMRT();this._cameraNear.value=s.near,this._cameraFar.value=s.far;for(const c in this._previousTextures)this.toggleTexture(c);i.setRenderTarget(this.renderTarget),i.setMRT(this._mrt),i.render(n,s),i.setRenderTarget(l),i.setMRT(u)}setSize(e,i){this._width=e,this._height=i;const n=this._width*this._pixelRatio,s=this._height*this._pixelRatio;this.renderTarget.setSize(n,s)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget.dispose()}}S_.COLOR="color",S_.DEPTH="depth";const Mge=Vi(([r,e])=>r.mul(e).clamp()).setLayout({name:"linearToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),Rge=Vi(([r,e])=>(r=r.mul(e),r.div(r.add(1)).clamp())).setLayout({name:"reinhardToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),Ige=Vi(([r,e])=>{r=r.mul(e),r=r.sub(.004).max(0);const i=r.mul(r.mul(6.2).add(.5)),n=r.mul(r.mul(6.2).add(1.7)).add(.06);return i.div(n).pow(2.2)}).setLayout({name:"cineonToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),Bge=Vi(([r])=>{const e=r.mul(r.add(.0245786)).sub(90537e-9),i=r.mul(r.add(.432951).mul(.983729)).add(.238081);return e.div(i)}),Nge=Vi(([r,e])=>{const i=Mo(.59719,.35458,.04823,.076,.90834,.01566,.0284,.13383,.83777),n=Mo(1.60475,-.53108,-.07367,-.10208,1.10813,-.00605,-.00327,-.07276,1.07602);return r=r.mul(e).div(.6),r=i.mul(r),r=Bge(r),r=n.mul(r),r.clamp()}).setLayout({name:"acesFilmicToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),Lge=Mo(Zt(1.6605,-.1246,-.0182),Zt(-.5876,1.1329,-.1006),Zt(-.0728,-.0083,1.1187)),Dge=Mo(Zt(.6274,.0691,.0164),Zt(.3293,.9195,.088),Zt(.0433,.0113,.8956)),Oge=Vi(([r])=>{const e=Zt(r).toVar(),i=Zt(e.mul(e)).toVar(),n=Zt(i.mul(i)).toVar();return ei(15.5).mul(n.mul(i)).sub(bn(40.14,n.mul(e))).add(bn(31.96,n).sub(bn(6.868,i.mul(e))).add(bn(.4298,i).add(bn(.1191,e).sub(.00232))))}),Pge=Vi(([r,e])=>{const i=Zt(r).toVar(),n=Mo(Zt(.856627153315983,.137318972929847,.11189821299995),Zt(.0951212405381588,.761241990602591,.0767994186031903),Zt(.0482516061458583,.101439036467562,.811302368396859)),s=Mo(Zt(1.1271005818144368,-.1413297634984383,-.14132976349843826),Zt(-.11060664309660323,1.157823702216272,-.11060664309660294),Zt(-.016493938717834573,-.016493938717834257,1.2519364065950405)),o=ei(-12.47393),l=ei(4.026069);return i.mulAssign(e),i.assign(Dge.mul(i)),i.assign(n.mul(i)),i.assign(kl(i,1e-10)),i.assign(eh(i)),i.assign(i.sub(o).div(l.sub(o))),i.assign(th(i,0,1)),i.assign(Oge(i)),i.assign(s.mul(i)),i.assign(u_(kl(Zt(0),i),Zt(2.2))),i.assign(Lge.mul(i)),i.assign(th(i,0,1)),i}).setLayout({name:"agxToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),kge=Vi(([r,e])=>{const i=ei(.76),n=ei(.15);r=r.mul(e);const s=yy(r.r,yy(r.g,r.b)),o=Yo(s.lessThan(.08),s.sub(bn(6.25,s.mul(s))),.04);r.subAssign(o);const l=kl(r.r,kl(r.g,r.b));Ga(l.lessThan(i),()=>r);const u=vl(1,i),c=vl(1,u.mul(u).div(l.add(u.sub(i))));r.mulAssign(c.div(l));const h=vl(1,Ad(1,n.mul(l.sub(c)).add(1)));return ys(r,Zt(c),h)}).setLayout({name:"neutralToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]});class oo extends nn{static get type(){return"CodeNode"}constructor(e="",i=[],n=""){super("code"),this.isCodeNode=!0,this.code=e,this.language=n,this.includes=i}isGlobal(){return!0}setIncludes(e){return this.includes=e,this}getIncludes(){return this.includes}generate(e){const i=this.getIncludes(e);for(const s of i)s.build(e);const n=e.getCodeFromNode(this,this.getNodeType(e));return n.code=this.code,n.code}serialize(e){super.serialize(e),e.code=this.code,e.language=this.language}deserialize(e){super.deserialize(e),this.code=e.code,this.language=e.language}}class Fge extends oo{static get type(){return"FunctionNode"}constructor(e="",i=[],n=""){super(e,i,n)}getNodeType(e){return this.getNodeFunction(e).type}getInputs(e){return this.getNodeFunction(e).inputs}getNodeFunction(e){const i=e.getDataFromNode(this);let n=i.nodeFunction;return n===void 0&&(n=e.parser.parseFunction(this.code),i.nodeFunction=n),n}generate(e,i){super.generate(e);const n=this.getNodeFunction(e),s=n.name,o=n.type,l=e.getCodeFromNode(this,o);s!==""&&(l.name=s);const u=e.getPropertyName(l),c=this.getNodeFunction(e).getCode(u);return l.code=c+`
`,i==="property"?u:e.format(`${u}()`,o,i)}}class hz extends nn{static get type(){return"FogNode"}constructor(e,i){super("float"),this.isFogNode=!0,this.colorNode=e,this.factorNode=i}getViewZNode(e){let i;const n=e.context.getViewZ;return n!==void 0&&(i=n(this)),(i||Wa.z).negate()}setup(){return this.factorNode}}class Uge extends hz{static get type(){return"FogRangeNode"}constructor(e,i,n){super(e),this.isFogRangeNode=!0,this.nearNode=i,this.farNode=n}setup(e){const i=this.getViewZNode(e);return Gp(this.nearNode,this.farNode,i)}}const zge=li(Uge);class jge extends hz{static get type(){return"FogExp2Node"}constructor(e,i){super(e),this.isFogExp2Node=!0,this.densityNode=i}setup(e){const i=this.getViewZNode(e),n=this.densityNode;return n.mul(n,i,i).negate().exp().oneMinus()}}const Vge=li(jge);class Gge extends nn{constructor(e){super(),this.scope=e}generate(e){const{scope:i}=this,{renderer:n}=e;n.backend.isWebGLBackend===!0?e.addFlowCode(`	// ${i}Barrier 
`):e.addLineFlowCode(`${i}Barrier()`,this)}}li(Gge);class Yc extends ta{static get type(){return"AtomicFunctionNode"}constructor(e,i,n,s=null){super("uint"),this.method=e,this.pointerNode=i,this.valueNode=n,this.storeNode=s}getInputType(e){return this.pointerNode.getNodeType(e)}getNodeType(e){return this.getInputType(e)}generate(e){const i=this.method,n=this.getNodeType(e),s=this.getInputType(e),o=this.pointerNode,l=this.valueNode,u=[];u.push(`&${o.build(e,s)}`),u.push(l.build(e,s));const c=`${e.getMethod(i,n)}( ${u.join(", ")} )`;if(this.storeNode!==null){const h=this.storeNode.build(e,s);e.addLineFlowCode(`${h} = ${c}`,this)}else e.addLineFlowCode(c,this)}}Yc.ATOMIC_LOAD="atomicLoad",Yc.ATOMIC_STORE="atomicStore",Yc.ATOMIC_ADD="atomicAdd",Yc.ATOMIC_SUB="atomicSub",Yc.ATOMIC_MAX="atomicMax",Yc.ATOMIC_MIN="atomicMin",Yc.ATOMIC_AND="atomicAnd",Yc.ATOMIC_OR="atomicOr",Yc.ATOMIC_XOR="atomicXor",li(Yc);let T_;function TR(r){T_=T_||new WeakMap;let e=T_.get(r);return e===void 0&&T_.set(r,e={}),e}function dz(r){const e=TR(r);return e.position||(e.position=en(new Rt).setGroup(Mn).onRenderUpdate((i,n)=>n.value.setFromMatrixPosition(r.matrixWorld)))}function Hge(r){const e=TR(r);return e.targetPosition||(e.targetPosition=en(new Rt).setGroup(Mn).onRenderUpdate((i,n)=>n.value.setFromMatrixPosition(r.target.matrixWorld)))}function MR(r){const e=TR(r);return e.viewPosition||(e.viewPosition=en(new Rt).setGroup(Mn).onRenderUpdate(({camera:i},n)=>{n.value=n.value||new Rt,n.value.setFromMatrixPosition(r.matrixWorld),n.value.applyMatrix4(i.matrixWorldInverse)}))}const pz=r=>nh.transformDirection(dz(r).sub(Hge(r))),Wge=r=>r.sort((e,i)=>e.id-i.id),Qge=(r,e)=>{for(const i of e)if(i.isAnalyticLightNode&&i.light.id===r)return i;return null},RR=new WeakMap;class fz extends nn{static get type(){return"LightsNode"}constructor(){super("vec3"),this.totalDiffuseNode=Zt().toVar("totalDiffuse"),this.totalSpecularNode=Zt().toVar("totalSpecular"),this.outgoingLightNode=Zt().toVar("outgoingLight"),this._lights=[],this._lightNodes=null,this._lightNodesHash=null,this.global=!0}getHash(e){if(this._lightNodesHash===null){this._lightNodes===null&&this.setupLightsNode(e);const i=[];for(const n of this._lightNodes)i.push(n.getSelf().getHash());this._lightNodesHash="lights-"+i.join(",")}return this._lightNodesHash}analyze(e){const i=e.getDataFromNode(this);for(const n of i.nodes)n.build(e)}setupLightsNode(e){const i=[],n=this._lightNodes,s=Wge(this._lights),o=e.renderer.library;for(const l of s)if(l.isNode)i.push(Ci(l));else{let u=null;if(n!==null&&(u=Qge(l.id,n)),u===null){const c=o.getLightNodeClass(l.constructor);if(c===null){console.warn(`LightsNode.setupNodeLights: Light node not found for ${l.constructor.name}`);continue}let h=null;RR.has(l)?h=RR.get(l):(h=Ci(new c(l)),RR.set(l,h)),i.push(h)}}this._lightNodes=i}setupLights(e,i){for(const n of i)n.build(e)}setup(e){this._lightNodes===null&&this.setupLightsNode(e);const i=e.context,n=i.lightingModel;let s=this.outgoingLightNode;if(n){const{_lightNodes:o,totalDiffuseNode:l,totalSpecularNode:u}=this;i.outgoingLight=s;const c=e.addStack(),h=e.getDataFromNode(this);h.nodes=c.nodes,n.start(i,c,e),this.setupLights(e,o),n.indirect(i,c,e);const{backdrop:p,backdropAlpha:f}=i,{directDiffuse:m,directSpecular:g,indirectDiffuse:y,indirectSpecular:x}=i.reflectedLight;let v=m.add(y);p!==null&&(f!==null?v=Zt(f.mix(v,p)):v=Zt(p),i.material.transparent=!0),l.assign(v),u.assign(g.add(x)),s.assign(l.add(u)),n.finish(i,c,e),s=s.bypass(e.removeStack())}return s}setLights(e){return this._lights=e,this._lightNodes=null,this._lightNodesHash=null,this}getLights(){return this._lights}get hasLights(){return this._lights.length>0}}const qge=Vi(({depthTexture:r,shadowCoord:e})=>Fs(r,e.xy).compare(e.z)),Xge=Vi(({depthTexture:r,shadowCoord:e,shadow:i})=>{const n=(x,v)=>Fs(r,x).compare(v),s=Ns("mapSize","vec2",i).setGroup(Mn),o=Ns("radius","float",i).setGroup(Mn),l=Ki(1).div(s),u=l.x.negate().mul(o),c=l.y.negate().mul(o),h=l.x.mul(o),p=l.y.mul(o),f=u.div(2),m=c.div(2),g=h.div(2),y=p.div(2);return Ro(n(e.xy.add(Ki(u,c)),e.z),n(e.xy.add(Ki(0,c)),e.z),n(e.xy.add(Ki(h,c)),e.z),n(e.xy.add(Ki(f,m)),e.z),n(e.xy.add(Ki(0,m)),e.z),n(e.xy.add(Ki(g,m)),e.z),n(e.xy.add(Ki(u,0)),e.z),n(e.xy.add(Ki(f,0)),e.z),n(e.xy,e.z),n(e.xy.add(Ki(g,0)),e.z),n(e.xy.add(Ki(h,0)),e.z),n(e.xy.add(Ki(f,y)),e.z),n(e.xy.add(Ki(0,y)),e.z),n(e.xy.add(Ki(g,y)),e.z),n(e.xy.add(Ki(u,p)),e.z),n(e.xy.add(Ki(0,p)),e.z),n(e.xy.add(Ki(h,p)),e.z)).mul(1/17)}),Yge=Vi(({depthTexture:r,shadowCoord:e,shadow:i})=>{const n=(p,f)=>Fs(r,p).compare(f),s=Ns("mapSize","vec2",i).setGroup(Mn),o=Ki(1).div(s),l=o.x,u=o.y,c=e.xy,h=yd(c.mul(s).add(.5));return c.subAssign(h.mul(o)),Ro(n(c,e.z),n(c.add(Ki(l,0)),e.z),n(c.add(Ki(0,u)),e.z),n(c.add(o),e.z),ys(n(c.add(Ki(l.negate(),0)),e.z),n(c.add(Ki(l.mul(2),0)),e.z),h.x),ys(n(c.add(Ki(l.negate(),u)),e.z),n(c.add(Ki(l.mul(2),u)),e.z),h.x),ys(n(c.add(Ki(0,u.negate())),e.z),n(c.add(Ki(0,u.mul(2))),e.z),h.y),ys(n(c.add(Ki(l,u.negate())),e.z),n(c.add(Ki(l,u.mul(2))),e.z),h.y),ys(ys(n(c.add(Ki(l.negate(),u.negate())),e.z),n(c.add(Ki(l.mul(2),u.negate())),e.z),h.x),ys(n(c.add(Ki(l.negate(),u.mul(2))),e.z),n(c.add(Ki(l.mul(2),u.mul(2))),e.z),h.x),h.y)).mul(1/9)}),Kge=Vi(({depthTexture:r,shadowCoord:e})=>{const i=ei(1).toVar(),n=Fs(r).uv(e.xy).rg,s=F6(e.z,n.x);return Ga(s.notEqual(ei(1)),()=>{const o=e.z.sub(n.x),l=kl(0,n.y.mul(n.y));let u=l.div(l.add(o.mul(o)));u=th(vl(u,.3).div(.95-.3)),i.assign(th(kl(s,u)))}),i}),Jge=Vi(({samples:r,radius:e,size:i,shadowPass:n})=>{const s=ei(0).toVar(),o=ei(0).toVar(),l=r.lessThanEqual(ei(1)).select(ei(0),ei(2).div(r.sub(1))),u=r.lessThanEqual(ei(1)).select(ei(0),ei(-1));Qc({start:ks(0),end:ks(r),type:"int",condition:"<"},({i:h})=>{const p=u.add(ei(h).mul(l)),f=n.uv(Ro(iR.xy,Ki(0,p).mul(e)).div(i)).x;s.addAssign(f),o.addAssign(f.mul(f))}),s.divAssign(r),o.divAssign(r);const c=z3(o.sub(s.mul(s)));return Ki(s,c)}),Zge=Vi(({samples:r,radius:e,size:i,shadowPass:n})=>{const s=ei(0).toVar(),o=ei(0).toVar(),l=r.lessThanEqual(ei(1)).select(ei(0),ei(2).div(r.sub(1))),u=r.lessThanEqual(ei(1)).select(ei(0),ei(-1));Qc({start:ks(0),end:ks(r),type:"int",condition:"<"},({i:h})=>{const p=u.add(ei(h).mul(l)),f=n.uv(Ro(iR.xy,Ki(p,0).mul(e)).div(i));s.addAssign(f.x),o.addAssign(Ro(f.y.mul(f.y),f.x.mul(f.x)))}),s.divAssign(r),o.divAssign(r);const c=z3(o.sub(s.mul(s)));return Ki(s,c)}),$ge=[qge,Xge,Yge,Kge];let Pg=null;const M_=new sz;class e0e extends nn{static get type(){return"ShadowNode"}constructor(e,i=null){super(),this.light=e,this.shadow=i||e.shadow,this.shadowMap=null,this.vsmShadowMapVertical=null,this.vsmShadowMapHorizontal=null,this.vsmMaterialVertical=null,this.vsmMaterialHorizontal=null,this.updateBeforeType=dn.RENDER,this._node=null,this.isShadowNode=!0}setupShadow(e){const{object:i,renderer:n}=e;Pg===null&&(Pg=new sa,Pg.fragmentNode=$r(0,0,0,1),Pg.isShadowNodeMaterial=!0,Pg.name="ShadowMaterial");const s=this.shadow,o=n.shadowMap.type,l=new bg(s.mapSize.width,s.mapSize.height);l.compareFunction=qM;const u=e.createRenderTarget(s.mapSize.width,s.mapSize.height);if(u.depthTexture=l,s.camera.updateProjectionMatrix(),o===A1){l.compareFunction=null,this.vsmShadowMapVertical=e.createRenderTarget(s.mapSize.width,s.mapSize.height,{format:ey,type:zu}),this.vsmShadowMapHorizontal=e.createRenderTarget(s.mapSize.width,s.mapSize.height,{format:ey,type:zu});const T=Fs(l),w=Fs(this.vsmShadowMapVertical.texture),S=Ns("blurSamples","float",s).setGroup(Mn),R=Ns("radius","float",s).setGroup(Mn),B=Ns("mapSize","vec2",s).setGroup(Mn);let I=this.vsmMaterialVertical||(this.vsmMaterialVertical=new sa);I.fragmentNode=Jge({samples:S,radius:R,size:B,shadowPass:T}).context(e.getSharedContext()),I.name="VSMVertical",I=this.vsmMaterialHorizontal||(this.vsmMaterialHorizontal=new sa),I.fragmentNode=Zge({samples:S,radius:R,size:B,shadowPass:w}).context(e.getSharedContext()),I.name="VSMHorizontal"}const c=Ns("intensity","float",s).setGroup(Mn),h=Ns("bias","float",s).setGroup(Mn),p=Ns("normalBias","float",s).setGroup(Mn),f=i.material.shadowPositionNode||Q3;let m=en(s.matrix).setGroup(Mn).mul(f.add(q3.mul(p))),g;if(s.camera.isOrthographicCamera||n.logarithmicDepthBuffer!==!0)m=m.xyz.div(m.w),g=m.z,n.coordinateSystem===Lp&&(g=g.mul(2).sub(1));else{const T=m.w;m=m.xy.div(T);const w=en("float").onRenderUpdate(()=>s.camera.near),S=en("float").onRenderUpdate(()=>s.camera.far);g=g8(T,w,S)}m=Zt(m.x,m.y.oneMinus(),g.add(h));const y=m.x.greaterThanEqual(0).and(m.x.lessThanEqual(1)).and(m.y.greaterThanEqual(0)).and(m.y.lessThanEqual(1)).and(m.z.lessThanEqual(1)),x=s.filterNode||$ge[n.shadowMap.type]||null;if(x===null)throw new Error("THREE.WebGPURenderer: Shadow map type not supported yet.");const v=Fs(u.texture,m),_=y.select(x({depthTexture:o===A1?this.vsmShadowMapHorizontal.texture:l,shadowCoord:m,shadow:s}),ei(1));return this.shadowMap=u,this.shadow.map=u,ys(1,_.rgb.mix(v,1),c.mul(v.a))}setup(e){if(e.renderer.shadowMap.enabled!==!1)return this._node!==null?this._node:this._node=this.setupShadow(e)}updateShadow(e){const{shadowMap:i,light:n,shadow:s}=this,{renderer:o,scene:l,camera:u}=e,c=o.shadowMap.type,h=i.depthTexture.version;this._depthVersionCached=h;const p=l.overrideMaterial;l.overrideMaterial=Pg,i.setSize(s.mapSize.width,s.mapSize.height),s.updateMatrices(n),s.camera.layers.mask=u.layers.mask;const f=o.getRenderTarget(),m=o.getRenderObjectFunction();o.setRenderObjectFunction((g,...y)=>{(g.castShadow===!0||g.receiveShadow&&c===A1)&&o.renderObject(g,...y)}),o.setRenderTarget(i),o.render(l,s.camera),o.setRenderObjectFunction(m),n.isPointLight!==!0&&c===A1&&this.vsmPass(o),o.setRenderTarget(f),l.overrideMaterial=p}vsmPass(e){const{shadow:i}=this;this.vsmShadowMapVertical.setSize(i.mapSize.width,i.mapSize.height),this.vsmShadowMapHorizontal.setSize(i.mapSize.width,i.mapSize.height),e.setRenderTarget(this.vsmShadowMapVertical),M_.material=this.vsmMaterialVertical,M_.render(e),e.setRenderTarget(this.vsmShadowMapHorizontal),M_.material=this.vsmMaterialHorizontal,M_.render(e)}dispose(){this.shadowMap.dispose(),this.shadowMap=null,this.vsmShadowMapVertical!==null&&(this.vsmShadowMapVertical.dispose(),this.vsmShadowMapVertical=null,this.vsmMaterialVertical.dispose(),this.vsmMaterialVertical=null),this.vsmShadowMapHorizontal!==null&&(this.vsmShadowMapHorizontal.dispose(),this.vsmShadowMapHorizontal=null,this.vsmMaterialHorizontal.dispose(),this.vsmMaterialHorizontal=null),this.updateBeforeType=dn.NONE}updateBefore(e){const{shadow:i}=this;(i.needsUpdate||i.autoUpdate)&&(this.updateShadow(e),this.shadowMap.depthTexture.version===this._depthVersionCached&&(i.needsUpdate=!1))}}const t0e=(r,e)=>Ci(new e0e(r,e));class Yp extends Bg{static get type(){return"AnalyticLightNode"}constructor(e=null){super(),this.updateType=dn.FRAME,this.light=e,this.color=new ts,this.colorNode=en(this.color).setGroup(Mn),this.baseColorNode=null,this.shadowNode=null,this.shadowColorNode=null,this.isAnalyticLightNode=!0}getCacheKey(){return K1(super.getCacheKey(),this.light.id,this.light.castShadow?1:0)}getHash(){return this.light.uuid}setupShadow(e){const{renderer:i}=e;if(i.shadowMap.enabled===!1)return;let n=this.shadowColorNode;if(n===null){const s=this.light.shadow.shadowNode;let o;s!==void 0?o=Ci(s):o=t0e(this.light),this.shadowNode=o,this.shadowColorNode=n=this.colorNode.mul(o),this.baseColorNode=this.colorNode}this.colorNode=n}setup(e){this.colorNode=this.baseColorNode||this.colorNode,this.light.castShadow?e.object.receiveShadow&&this.setupShadow(e):this.shadowNode!==null&&this.shadowNode.dispose()}update(){const{light:e}=this;this.color.copy(e.color).multiplyScalar(e.intensity)}}const mz=Vi(r=>{const{lightDistance:e,cutoffDistance:i,decayExponent:n}=r,s=e.pow(n).max(.01).reciprocal();return i.greaterThan(0).select(s.mul(e.div(i).pow4().oneMinus().clamp().pow2()),s)}),i0e=Vi(({color:r,lightViewPosition:e,cutoffDistance:i,decayExponent:n},s)=>{const o=s.context.lightingModel,l=e.sub(Wa),u=l.normalize(),c=l.length(),h=mz({lightDistance:c,cutoffDistance:i,decayExponent:n}),p=r.mul(h),f=s.context.reflectedLight;o.direct({lightDirection:u,lightColor:p,reflectedLight:f},s.stack,s)});class r0e extends Yp{static get type(){return"PointLightNode"}constructor(e=null){super(e),this.cutoffDistanceNode=en(0).setGroup(Mn),this.decayExponentNode=en(0).setGroup(Mn)}update(e){const{light:i}=this;super.update(e),this.cutoffDistanceNode.value=i.distance,this.decayExponentNode.value=i.decay}setup(){i0e({color:this.colorNode,lightViewPosition:MR(this.light),cutoffDistance:this.cutoffDistanceNode,decayExponent:this.decayExponentNode}).append()}}const n0e=Vi(([r,e])=>{const i=r.x,n=r.y,s=r.z;let o=e.element(0).mul(.886227);return o=o.add(e.element(1).mul(2*.511664).mul(n)),o=o.add(e.element(2).mul(2*.511664).mul(s)),o=o.add(e.element(3).mul(2*.511664).mul(i)),o=o.add(e.element(4).mul(2*.429043).mul(i).mul(n)),o=o.add(e.element(5).mul(2*.429043).mul(n).mul(s)),o=o.add(e.element(6).mul(s.mul(s).mul(.743125).sub(.247708))),o=o.add(e.element(7).mul(2*.429043).mul(i).mul(s)),o=o.add(e.element(8).mul(.429043).mul(bn(i,i).sub(bn(n,n)))),o}),sh=new yR;class s0e extends Ed{constructor(e,i){super(),this.renderer=e,this.nodes=i}update(e,i,n){const s=this.renderer,o=this.nodes.getBackgroundNode(e)||e.background;let l=!1;if(o===null)s._clearColor.getRGB(sh,cd),sh.a=s._clearColor.a;else if(o.isColor===!0)o.getRGB(sh,cd),sh.a=1,l=!0;else if(o.isNode===!0){const u=this.get(e),c=o;sh.copy(s._clearColor);let h=u.backgroundMesh;if(h===void 0){const f=G3($r(c).mul(az),{getUV:()=>wge.mul($6),getTextureLevel:()=>Ege});let m=Z3();m=m.setZ(m.w);const g=new sa;g.name="Background.material",g.side=pc,g.depthTest=!1,g.depthWrite=!1,g.fog=!1,g.lights=!1,g.vertexNode=m,g.colorNode=f,u.backgroundMeshNode=f,u.backgroundMesh=h=new Fp(new x3(1,32,32),g),h.frustumCulled=!1,h.name="Background.mesh",h.onBeforeRender=function(y,x,v){this.matrixWorld.copyPosition(v.matrixWorld)}}const p=c.getCacheKey();u.backgroundCacheKey!==p&&(u.backgroundMeshNode.node=$r(c).mul(az),u.backgroundMeshNode.needsUpdate=!0,h.material.needsUpdate=!0,u.backgroundCacheKey=p),i.unshift(h,h.geometry,h.material,0,0,null)}else console.error("THREE.Renderer: Unsupported background configuration.",o);if(s.autoClear===!0||l===!0){const u=n.clearColorValue;u.r=sh.r,u.g=sh.g,u.b=sh.b,u.a=sh.a,(s.backend.isWebGLBackend===!0||s.alpha===!0)&&(u.r*=u.a,u.g*=u.a,u.b*=u.a),n.depthClearValue=s._clearDepth,n.stencilClearValue=s._clearStencil,n.clearColor=s.autoClearColor===!0,n.clearDepth=s.autoClearDepth===!0,n.clearStencil=s.autoClearStencil===!0}else n.clearColor=!1,n.clearDepth=!1,n.clearStencil=!1}}let a0e=0;class IR{constructor(e="",i=[],n=0,s=[]){this.name=e,this.bindings=i,this.index=n,this.bindingsReference=s,this.id=a0e++}}class o0e{constructor(e,i,n,s,o,l,u,c,h,p=[]){this.vertexShader=e,this.fragmentShader=i,this.computeShader=n,this.transforms=p,this.nodeAttributes=s,this.bindings=o,this.updateNodes=l,this.updateBeforeNodes=u,this.updateAfterNodes=c,this.monitor=h,this.usedTimes=0}createBindings(){const e=[];for(const i of this.bindings)if(i.bindings[0].groupNode.shared!==!0){const n=new IR(i.name,[],i.index,i);e.push(n);for(const s of i.bindings)n.bindings.push(s.clone())}else e.push(i);return e}}class gz{constructor(e,i,n=null){this.isNodeAttribute=!0,this.name=e,this.type=i,this.node=n}}class l0e{constructor(e,i,n){this.isNodeUniform=!0,this.name=e,this.type=i,this.node=n.getSelf()}get value(){return this.node.value}set value(e){this.node.value=e}get id(){return this.node.id}get groupNode(){return this.node.groupNode}}class Az{constructor(e,i){this.isNodeVar=!0,this.name=e,this.type=i}}class c0e extends Az{constructor(e,i){super(e,i),this.needsInterpolation=!1,this.isNodeVarying=!0}}class u0e{constructor(e,i,n=""){this.name=e,this.type=i,this.code=n,Object.defineProperty(this,"isNodeCode",{value:!0})}}let h0e=0;class BR{constructor(e=null){this.id=h0e++,this.nodesData=new WeakMap,this.parent=e}getData(e){let i=this.nodesData.get(e);return i===void 0&&this.parent!==null&&(i=this.parent.getData(e)),i}setData(e,i){this.nodesData.set(e,i)}}class Kp{constructor(e,i){this.name=e,this.value=i,this.boundary=0,this.itemSize=0,this.offset=0}setValue(e){this.value=e}getValue(){return this.value}}class d0e extends Kp{constructor(e,i=0){super(e,i),this.isNumberUniform=!0,this.boundary=4,this.itemSize=1}}class p0e extends Kp{constructor(e,i=new Pn){super(e,i),this.isVector2Uniform=!0,this.boundary=8,this.itemSize=2}}class f0e extends Kp{constructor(e,i=new Rt){super(e,i),this.isVector3Uniform=!0,this.boundary=16,this.itemSize=3}}class m0e extends Kp{constructor(e,i=new es){super(e,i),this.isVector4Uniform=!0,this.boundary=16,this.itemSize=4}}class g0e extends Kp{constructor(e,i=new ts){super(e,i),this.isColorUniform=!0,this.boundary=16,this.itemSize=3}}class A0e extends Kp{constructor(e,i=new qo){super(e,i),this.isMatrix3Uniform=!0,this.boundary=48,this.itemSize=12}}class y0e extends Kp{constructor(e,i=new Cs){super(e,i),this.isMatrix4Uniform=!0,this.boundary=64,this.itemSize=16}}class v0e extends d0e{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}}class x0e extends p0e{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}}class b0e extends f0e{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}}class _0e extends m0e{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}}class E0e extends g0e{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}}class w0e extends A0e{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}}class C0e extends y0e{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}}const kg=4,yz=[.125,.215,.35,.446,.526,.582],Jp=20,NR=new C3(-1,1,1,-1,0,1),S0e=new Ku(90,1),vz=new ts;let LR=null,DR=0,OR=0;const Zp=(1+Math.sqrt(5))/2,Fg=1/Zp,xz=[new Rt(-Zp,Fg,0),new Rt(Zp,Fg,0),new Rt(-Fg,0,Zp),new Rt(Fg,0,Zp),new Rt(0,Zp,-Fg),new Rt(0,Zp,Fg),new Rt(-1,1,-1),new Rt(1,1,-1),new Rt(-1,1,1),new Rt(1,1,1)],T0e=[3,1,5,0,4,2],PR=yme(p_(),rh("faceIndex")).normalize(),kR=Zt(PR.x,PR.y.negate(),PR.z);class M0e{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._backgroundBox=null}fromScene(e,i=0,n=.1,s=100){LR=this._renderer.getRenderTarget(),DR=this._renderer.getActiveCubeFace(),OR=this._renderer.getActiveMipmapLevel(),this._setSize(256);const o=this._allocateTargets();return o.depthBuffer=!0,this._sceneToCubeUV(e,n,s,o),i>0&&this._blur(o,0,0,i),this._applyPMREM(o),this._cleanup(o),o}fromEquirectangular(e,i=null){return this._fromTexture(e,i)}fromCubemap(e,i=null){return this._fromTexture(e,i)}async compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=_z(),await this._compileMaterial(this._cubemapMaterial))}async compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=Ez(),await this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose(),this._backgroundBox!==null&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(LR,DR,OR),e.scissorTest=!1,R_(e,0,0,e.width,e.height)}_fromTexture(e,i){e.mapping===Rp||e.mapping===$m?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),LR=this._renderer.getRenderTarget(),DR=this._renderer.getActiveCubeFace(),OR=this._renderer.getActiveMipmapLevel();const n=i||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),i=4*this._cubeSize,n={magFilter:pl,minFilter:pl,generateMipmaps:!1,type:zu,format:rg,colorSpace:cd},s=bz(e,i,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==i){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=bz(e,i,n);const{_lodMax:o}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas,lodMeshes:this._lodMeshes}=R0e(o)),this._blurMaterial=I0e(o,e,i)}return s}async _compileMaterial(e){const i=new Fp(this._lodPlanes[0],e);await this._renderer.compile(i,NR)}_sceneToCubeUV(e,i,n,s){const o=S0e;o.near=i,o.far=n;const l=[-1,1,-1,-1,-1,-1],u=[1,1,1,-1,-1,-1],c=this._renderer,h=c.autoClear;c.getClearColor(vz),c.autoClear=!1;let p=this._backgroundBox;if(p===null){const g=new U1({name:"PMREM.Background",side:pc,depthWrite:!1,depthTest:!1});p=new Fp(new hy,g)}let f=!1;const m=e.background;m?m.isColor&&(p.material.color.copy(m),e.background=null,f=!0):(p.material.color.copy(vz),f=!0),c.setRenderTarget(s),c.clear(),f&&c.render(p,o);for(let g=0;g<6;g++){const y=g%3;y===0?(o.up.set(0,l[g],0),o.lookAt(u[g],0,0)):y===1?(o.up.set(0,0,l[g]),o.lookAt(0,u[g],0)):(o.up.set(0,l[g],0),o.lookAt(0,0,u[g]));const x=this._cubeSize;R_(s,y*x,g>2?x:0,x,x),c.render(e,o)}c.autoClear=h,e.background=m}_textureToCubeUV(e,i){const n=this._renderer,s=e.mapping===Rp||e.mapping===$m;s?this._cubemapMaterial===null&&(this._cubemapMaterial=_z(e)):this._equirectMaterial===null&&(this._equirectMaterial=Ez(e));const o=s?this._cubemapMaterial:this._equirectMaterial;o.fragmentNode.value=e;const l=this._lodMeshes[0];l.material=o;const u=this._cubeSize;R_(i,0,0,3*u,2*u),n.setRenderTarget(i),n.render(l,NR)}_applyPMREM(e){const i=this._renderer,n=i.autoClear;i.autoClear=!1;const s=this._lodPlanes.length;for(let o=1;o<s;o++){const l=Math.sqrt(this._sigmas[o]*this._sigmas[o]-this._sigmas[o-1]*this._sigmas[o-1]),u=xz[(s-o-1)%xz.length];this._blur(e,o-1,o,l,u)}i.autoClear=n}_blur(e,i,n,s,o){const l=this._pingPongRenderTarget;this._halfBlur(e,l,i,n,s,"latitudinal",o),this._halfBlur(l,e,n,n,s,"longitudinal",o)}_halfBlur(e,i,n,s,o,l,u){const c=this._renderer,h=this._blurMaterial;l!=="latitudinal"&&l!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const p=3,f=this._lodMeshes[s];f.material=h;const m=h.uniforms,g=this._sizeLods[n]-1,y=isFinite(o)?Math.PI/(2*g):2*Math.PI/(2*Jp-1),x=o/y,v=isFinite(o)?1+Math.floor(p*x):Jp;v>Jp&&console.warn(`sigmaRadians, ${o}, is too large and will clip, as it requested ${v} samples when the maximum is set to ${Jp}`);const _=[];let T=0;for(let I=0;I<Jp;++I){const D=I/x,L=Math.exp(-D*D/2);_.push(L),I===0?T+=L:I<v&&(T+=2*L)}for(let I=0;I<_.length;I++)_[I]=_[I]/T;e.texture.frame=(e.texture.frame||0)+1,m.envMap.value=e.texture,m.samples.value=v,m.weights.array=_,m.latitudinal.value=l==="latitudinal"?1:0,u&&(m.poleAxis.value=u);const{_lodMax:w}=this;m.dTheta.value=y,m.mipInt.value=w-n;const S=this._sizeLods[s],R=3*S*(s>w-kg?s-w+kg:0),B=4*(this._cubeSize-S);R_(i,R,B,3*S,2*S),c.setRenderTarget(i),c.render(f,NR)}}function R0e(r){const e=[],i=[],n=[],s=[];let o=r;const l=r-kg+1+yz.length;for(let u=0;u<l;u++){const c=Math.pow(2,o);i.push(c);let h=1/c;u>r-kg?h=yz[u-r+kg-1]:u===0&&(h=0),n.push(h);const p=1/(c-2),f=-p,m=1+p,g=[f,f,m,f,m,m,f,f,m,m,f,m],y=6,x=6,v=3,_=2,T=1,w=new Float32Array(v*x*y),S=new Float32Array(_*x*y),R=new Float32Array(T*x*y);for(let I=0;I<y;I++){const D=I%3*2/3-1,L=I>2?0:-1,O=[D,L,0,D+2/3,L,0,D+2/3,L+1,0,D,L,0,D+2/3,L+1,0,D,L+1,0],U=T0e[I];w.set(O,v*x*U),S.set(g,_*x*U);const Z=[U,U,U,U,U,U];R.set(Z,T*x*U)}const B=new Pp;B.setAttribute("position",new Ol(w,v)),B.setAttribute("uv",new Ol(S,_)),B.setAttribute("faceIndex",new Ol(R,T)),e.push(B),s.push(new Fp(B,null)),o>kg&&o--}return{lodPlanes:e,sizeLods:i,sigmas:n,lodMeshes:s}}function bz(r,e,i){const n=new cg(r,e,i);return n.texture.mapping=xM,n.texture.name="PMREM.cubeUv",n.texture.isPMREMTexture=!0,n.scissorTest=!0,n}function R_(r,e,i,n,s){r.viewport.set(e,i,n,s),r.scissor.set(e,i,n,s)}function FR(r){const e=new sa;return e.depthTest=!1,e.depthWrite=!1,e.blending=Jm,e.name=`PMREM_${r}`,e}function I0e(r,e,i){const n=Cy(new Array(Jp).fill(0)),s=en(new Rt(0,1,0)),o=en(0),l=ei(Jp),u=en(0),c=en(1),h=Fs(null),p=en(0),f=ei(1/e),m=ei(1/i),g=ei(r),y={n:l,latitudinal:u,weights:n,poleAxis:s,outputDirection:kR,dTheta:o,samples:c,envMap:h,mipInt:p,CUBEUV_TEXEL_WIDTH:f,CUBEUV_TEXEL_HEIGHT:m,CUBEUV_MAX_MIP:g},x=FR("blur");return x.uniforms=y,x.fragmentNode=xme({...y,latitudinal:u.equal(1)}),x}function _z(r){const e=FR("cubemap");return e.fragmentNode=wy(r,kR),e}function Ez(r){const e=FR("equirect");return e.fragmentNode=Fs(r,b8(kR),0),e}const wz=new WeakMap,B0e=new Map([[2,"vec2"],[3,"vec3"],[4,"vec4"],[9,"mat3"],[16,"mat4"]]),N0e=new Map([[Int8Array,"int"],[Int16Array,"int"],[Int32Array,"int"],[Uint8Array,"uint"],[Uint16Array,"uint"],[Uint32Array,"uint"],[Float32Array,"float"]]),I_=r=>/e/g.test(r)?String(r).replace(/\+/g,""):(r=Number(r),r+(r%1?"":".0"));class Cz{constructor(e,i,n){this.object=e,this.material=e&&e.material||null,this.geometry=e&&e.geometry||null,this.renderer=i,this.parser=n,this.scene=null,this.camera=null,this.nodes=[],this.sequentialNodes=[],this.updateNodes=[],this.updateBeforeNodes=[],this.updateAfterNodes=[],this.hashNodes={},this.monitor=null,this.lightsNode=null,this.environmentNode=null,this.fogNode=null,this.clippingContext=null,this.vertexShader=null,this.fragmentShader=null,this.computeShader=null,this.flowNodes={vertex:[],fragment:[],compute:[]},this.flowCode={vertex:"",fragment:"",compute:""},this.uniforms={vertex:[],fragment:[],compute:[],index:0},this.structs={vertex:[],fragment:[],compute:[],index:0},this.bindings={vertex:{},fragment:{},compute:{}},this.bindingsIndexes={},this.bindGroups=null,this.attributes=[],this.bufferAttributes=[],this.varyings=[],this.codes={},this.vars={},this.flow={code:""},this.chaining=[],this.stack=vR(),this.stacks=[],this.tab="	",this.currentFunctionNode=null,this.context={material:this.material},this.cache=new BR,this.globalCache=this.cache,this.flowsData=new WeakMap,this.shaderStage=null,this.buildStage=null,this.useComparisonMethod=!1}getBindGroupsCache(){let e=wz.get(this.renderer);return e===void 0&&(e=new qc,wz.set(this.renderer,e)),e}createRenderTarget(e,i,n){return new cg(e,i,n)}createCubeRenderTarget(e,i){return new _8(e,i)}createPMREMGenerator(){return new M0e(this.renderer)}includes(e){return this.nodes.includes(e)}_getBindGroup(e,i){const n=this.getBindGroupsCache(),s=[];let o=!0;for(const u of i)s.push(u),o=o&&u.groupNode.shared!==!0;let l;return o?(l=n.get(s),l===void 0&&(l=new IR(e,s,this.bindingsIndexes[e].group,s),n.set(s,l))):l=new IR(e,s,this.bindingsIndexes[e].group,s),l}getBindGroupArray(e,i){const n=this.bindings[i];let s=n[e];return s===void 0&&(this.bindingsIndexes[e]===void 0&&(this.bindingsIndexes[e]={binding:0,group:Object.keys(this.bindingsIndexes).length}),n[e]=s=[]),s}getBindings(){let e=this.bindGroups;if(e===null){const i={},n=this.bindings;for(const s of l6)for(const o in n[s]){const l=n[s][o];(i[o]||(i[o]=[])).push(...l)}e=[];for(const s in i){const o=i[s],l=this._getBindGroup(s,o);e.push(l)}this.bindGroups=e}return e}sortBindingGroups(){const e=this.getBindings();e.sort((i,n)=>i.bindings[0].groupNode.order-n.bindings[0].groupNode.order);for(let i=0;i<e.length;i++){const n=e[i];this.bindingsIndexes[n.name].group=i,n.index=i}}setHashNode(e,i){this.hashNodes[i]=e}addNode(e){this.nodes.includes(e)===!1&&(this.nodes.push(e),this.setHashNode(e,e.getHash(this)))}addSequentialNode(e){this.sequentialNodes.includes(e)===!1&&this.sequentialNodes.push(e)}buildUpdateNodes(){for(const e of this.nodes)e.getUpdateType()!==dn.NONE&&this.updateNodes.push(e.getSelf());for(const e of this.sequentialNodes){const i=e.getUpdateBeforeType(),n=e.getUpdateAfterType();i!==dn.NONE&&this.updateBeforeNodes.push(e.getSelf()),n!==dn.NONE&&this.updateAfterNodes.push(e.getSelf())}}get currentNode(){return this.chaining[this.chaining.length-1]}isFilteredTexture(e){return e.magFilter===pl||e.magFilter===_M||e.magFilter===tg||e.magFilter===Uu||e.minFilter===pl||e.minFilter===_M||e.minFilter===tg||e.minFilter===Uu}addChain(e){this.chaining.push(e)}removeChain(e){if(this.chaining.pop()!==e)throw new Error("NodeBuilder: Invalid node chaining!")}getMethod(e){return e}getNodeFromHash(e){return this.hashNodes[e]}addFlow(e,i){return this.flowNodes[e].push(i),i}setContext(e){this.context=e}getContext(){return this.context}getSharedContext(){return{...this.context},this.context}setCache(e){this.cache=e}getCache(){return this.cache}getCacheFromNode(e,i=!0){const n=this.getDataFromNode(e);return n.cache===void 0&&(n.cache=new BR(i?this.getCache():null)),n.cache}isAvailable(){return!1}getVertexIndex(){console.warn("Abstract function.")}getInstanceIndex(){console.warn("Abstract function.")}getDrawIndex(){console.warn("Abstract function.")}getFrontFacing(){console.warn("Abstract function.")}getFragCoord(){console.warn("Abstract function.")}isFlipY(){return!1}increaseUsage(e){const i=this.getDataFromNode(e);return i.usageCount=i.usageCount===void 0?1:i.usageCount+1,i.usageCount}generateTexture(){console.warn("Abstract function.")}generateTextureLod(){console.warn("Abstract function.")}generateConst(e,i=null){if(i===null&&(e==="float"||e==="int"||e==="uint"?i=0:e==="bool"?i=!1:e==="color"?i=new ts:e==="vec2"?i=new Pn:e==="vec3"?i=new Rt:e==="vec4"&&(i=new es)),e==="float")return I_(i);if(e==="int")return`${Math.round(i)}`;if(e==="uint")return i>=0?`${Math.round(i)}u`:"0u";if(e==="bool")return i?"true":"false";if(e==="color")return`${this.getType("vec3")}( ${I_(i.r)}, ${I_(i.g)}, ${I_(i.b)} )`;const n=this.getTypeLength(e),s=this.getComponentType(e),o=l=>this.generateConst(s,l);if(n===2)return`${this.getType(e)}( ${o(i.x)}, ${o(i.y)} )`;if(n===3)return`${this.getType(e)}( ${o(i.x)}, ${o(i.y)}, ${o(i.z)} )`;if(n===4)return`${this.getType(e)}( ${o(i.x)}, ${o(i.y)}, ${o(i.z)}, ${o(i.w)} )`;if(n>4&&i&&(i.isMatrix3||i.isMatrix4))return`${this.getType(e)}( ${i.elements.map(o).join(", ")} )`;if(n>4)return`${this.getType(e)}()`;throw new Error(`NodeBuilder: Type '${e}' not found in generate constant attempt.`)}getType(e){return e==="color"?"vec3":e}hasGeometryAttribute(e){return this.geometry&&this.geometry.getAttribute(e)!==void 0}getAttribute(e,i){const n=this.attributes;for(const o of n)if(o.name===e)return o;const s=new gz(e,i);return n.push(s),s}getPropertyName(e){return e.name}isVector(e){return/vec\d/.test(e)}isMatrix(e){return/mat\d/.test(e)}isReference(e){return e==="void"||e==="property"||e==="sampler"||e==="texture"||e==="cubeTexture"||e==="storageTexture"||e==="depthTexture"||e==="texture3D"}needsToWorkingColorSpace(){return!1}getComponentTypeFromTexture(e){const i=e.type;if(e.isDataTexture){if(i===wo)return"int";if(i===ja)return"uint"}return"float"}getElementType(e){return e==="mat2"?"vec2":e==="mat3"?"vec3":e==="mat4"?"vec4":this.getComponentType(e)}getComponentType(e){if(e=this.getVectorType(e),e==="float"||e==="bool"||e==="int"||e==="uint")return e;const i=/(b|i|u|)(vec|mat)([2-4])/.exec(e);return i===null?null:i[1]==="b"?"bool":i[1]==="i"?"int":i[1]==="u"?"uint":"float"}getVectorType(e){return e==="color"?"vec3":e==="texture"||e==="cubeTexture"||e==="storageTexture"||e==="texture3D"?"vec4":e}getTypeFromLength(e,i="float"){if(e===1)return i;const n=B0e.get(e);return(i==="float"?"":i[0])+n}getTypeFromArray(e){return N0e.get(e.constructor)}getTypeFromAttribute(e){let i=e;e.isInterleavedBufferAttribute&&(i=e.data);const n=i.array,s=e.itemSize,o=e.normalized;let l;return!(e instanceof B5)&&o!==!0&&(l=this.getTypeFromArray(n)),this.getTypeFromLength(s,l)}getTypeLength(e){const i=this.getVectorType(e),n=/vec([2-4])/.exec(i);return n!==null?Number(n[1]):i==="float"||i==="bool"||i==="int"||i==="uint"?1:/mat2/.test(e)===!0?4:/mat3/.test(e)===!0?9:/mat4/.test(e)===!0?16:0}getVectorFromMatrix(e){return e.replace("mat","vec")}changeComponentType(e,i){return this.getTypeFromLength(this.getTypeLength(e),i)}getIntegerType(e){const i=this.getComponentType(e);return i==="int"||i==="uint"?e:this.changeComponentType(e,"int")}addStack(){return this.stack=vR(this.stack),this.stacks.push(y6()||this.stack),r_(this.stack),this.stack}removeStack(){const e=this.stack;return this.stack=e.parent,r_(this.stacks.pop()),e}getDataFromNode(e,i=this.shaderStage,n=null){n=n===null?e.isGlobal(this)?this.globalCache:this.cache:n;let s=n.getData(e);return s===void 0&&(s={},n.setData(e,s)),s[i]===void 0&&(s[i]={}),s[i]}getNodeProperties(e,i="any"){const n=this.getDataFromNode(e,i);return n.properties||(n.properties={outputNode:null})}getBufferAttributeFromNode(e,i){const n=this.getDataFromNode(e);let s=n.bufferAttribute;if(s===void 0){const o=this.uniforms.index++;s=new gz("nodeAttribute"+o,i,e),this.bufferAttributes.push(s),n.bufferAttribute=s}return s}getStructTypeFromNode(e,i=this.shaderStage){const n=this.getDataFromNode(e,i);if(n.structType===void 0){const s=this.structs.index++;e.name=`StructType${s}`,this.structs[i].push(e),n.structType=e}return e}getUniformFromNode(e,i,n=this.shaderStage,s=null){const o=this.getDataFromNode(e,n,this.globalCache);let l=o.uniform;if(l===void 0){const u=this.uniforms.index++;l=new l0e(s||"nodeUniform"+u,i,e),this.uniforms[n].push(l),o.uniform=l}return l}getVarFromNode(e,i=null,n=e.getNodeType(this),s=this.shaderStage){const o=this.getDataFromNode(e,s);let l=o.variable;if(l===void 0){const u=this.vars[s]||(this.vars[s]=[]);i===null&&(i="nodeVar"+u.length),l=new Az(i,n),u.push(l),o.variable=l}return l}getVaryingFromNode(e,i=null,n=e.getNodeType(this)){const s=this.getDataFromNode(e,"any");let o=s.varying;if(o===void 0){const l=this.varyings,u=l.length;i===null&&(i="nodeVarying"+u),o=new c0e(i,n),l.push(o),s.varying=o}return o}getCodeFromNode(e,i,n=this.shaderStage){const s=this.getDataFromNode(e);let o=s.code;if(o===void 0){const l=this.codes[n]||(this.codes[n]=[]),u=l.length;o=new u0e("nodeCode"+u,i),l.push(o),s.code=o}return o}addFlowCodeHierarchy(e,i){const{flowCodes:n,flowCodeBlock:s}=this.getDataFromNode(e);let o=!0,l=i;for(;l;){if(s.get(l)===!0){o=!1;break}l=this.getDataFromNode(l).parentNodeBlock}if(o)for(const u of n)this.addLineFlowCode(u)}addLineFlowCodeBlock(e,i,n){const s=this.getDataFromNode(e),o=s.flowCodes||(s.flowCodes=[]),l=s.flowCodeBlock||(s.flowCodeBlock=new WeakMap);o.push(i),l.set(n,!0)}addLineFlowCode(e,i=null){return e===""?this:(i!==null&&this.context.nodeBlock&&this.addLineFlowCodeBlock(i,e,this.context.nodeBlock),e=this.tab+e,/;\s*$/.test(e)||(e=e+`;
`),this.flow.code+=e,this)}addFlowCode(e){return this.flow.code+=e,this}addFlowTab(){return this.tab+="	",this}removeFlowTab(){return this.tab=this.tab.slice(0,-1),this}getFlowData(e){return this.flowsData.get(e)}flowNode(e){const i=e.getNodeType(this),n=this.flowChildNode(e,i);return this.flowsData.set(e,n),n}buildFunctionNode(e){const i=new Fge,n=this.currentFunctionNode;return this.currentFunctionNode=i,i.code=this.buildFunctionCode(e),this.currentFunctionNode=n,i}flowShaderNode(e){const i=e.layout,n={[Symbol.iterator](){let l=0;const u=Object.values(this);return{next:()=>({value:u[l],done:l++>=u.length})}}};for(const l of i.inputs)n[l.name]=new yge(l.type,l.name);e.layout=null;const s=e.call(n),o=this.flowStagesNode(s,i.type);return e.layout=i,o}flowStagesNode(e,i=null){const n=this.flow,s=this.vars,o=this.cache,l=this.buildStage,u=this.stack,c={code:""};this.flow=c,this.vars={},this.cache=new BR,this.stack=vR();for(const h of o6)this.setBuildStage(h),c.result=e.build(this,i);return c.vars=this.getVars(this.shaderStage),this.flow=n,this.vars=s,this.cache=o,this.stack=u,this.setBuildStage(l),c}getFunctionOperator(){return null}flowChildNode(e,i=null){const n=this.flow,s={code:""};return this.flow=s,s.result=e.build(this,i),this.flow=n,s}flowNodeFromShaderStage(e,i,n=null,s=null){const o=this.shaderStage;this.setShaderStage(e);const l=this.flowChildNode(i,n);return s!==null&&(l.code+=`${this.tab+s} = ${l.result};
`),this.flowCode[e]=this.flowCode[e]+l.code,this.setShaderStage(o),l}getAttributesArray(){return this.attributes.concat(this.bufferAttributes)}getAttributes(){console.warn("Abstract function.")}getVaryings(){console.warn("Abstract function.")}getVar(e,i){return`${this.getType(e)} ${i}`}getVars(e){let i="";const n=this.vars[e];if(n!==void 0)for(const s of n)i+=`${this.getVar(s.type,s.name)}; `;return i}getUniforms(){console.warn("Abstract function.")}getCodes(e){const i=this.codes[e];let n="";if(i!==void 0)for(const s of i)n+=s.code+`
`;return n}getHash(){return this.vertexShader+this.fragmentShader+this.computeShader}setShaderStage(e){this.shaderStage=e}getShaderStage(){return this.shaderStage}setBuildStage(e){this.buildStage=e}getBuildStage(){return this.buildStage}buildCode(){console.warn("Abstract function.")}build(){const{object:e,material:i,renderer:n}=this;if(i!==null){let s=n.library.fromMaterial(i);s===null&&(console.error(`NodeMaterial: Material "${i.type}" is not compatible.`),s=new sa),s.build(this)}else this.addFlow("compute",e);for(const s of o6){this.setBuildStage(s),this.context.vertex&&this.context.vertex.isNode&&this.flowNodeFromShaderStage("vertex",this.context.vertex);for(const o of l6){this.setShaderStage(o);const l=this.flowNodes[o];for(const u of l)s==="generate"?this.flowNode(u):u.build(this)}}return this.setBuildStage(null),this.setShaderStage(null),this.buildCode(),this.buildUpdateNodes(),this}getNodeUniform(e,i){if(i==="float"||i==="int"||i==="uint")return new v0e(e);if(i==="vec2"||i==="ivec2"||i==="uvec2")return new x0e(e);if(i==="vec3"||i==="ivec3"||i==="uvec3")return new b0e(e);if(i==="vec4"||i==="ivec4"||i==="uvec4")return new _0e(e);if(i==="color")return new E0e(e);if(i==="mat3")return new w0e(e);if(i==="mat4")return new C0e(e);throw new Error(`Uniform "${i}" not declared.`)}createNodeMaterial(e="NodeMaterial"){throw new Error(`THREE.NodeBuilder: createNodeMaterial() was deprecated. Use new ${e}() instead.`)}format(e,i,n){if(i=this.getVectorType(i),n=this.getVectorType(n),i===n||n===null||this.isReference(n))return e;const s=this.getTypeLength(i),o=this.getTypeLength(n);return s===16&&o===9?`${this.getType(n)}(${e}[0].xyz, ${e}[1].xyz, ${e}[2].xyz)`:s===9&&o===4?`${this.getType(n)}(${e}[0].xy, ${e}[1].xy)`:s>4||o>4||o===0?e:s===o?`${this.getType(n)}( ${e} )`:s>o?this.format(`${e}.${"xyz".slice(0,o)}`,this.getTypeFromLength(o,this.getComponentType(i)),n):o===4&&s>1?`${this.getType(n)}( ${this.format(e,i,"vec3")}, 1.0 )`:s===2?`${this.getType(n)}( ${this.format(e,i,"vec2")}, 0.0 )`:(s===1&&o>1&&i!==this.getComponentType(n)&&(e=`${this.getType(this.getComponentType(n))}( ${e} )`),`${this.getType(n)}( ${e} )`)}getSignature(){return`// Three.js r${g1} - Node System
`}}class Sz{constructor(){this.time=0,this.deltaTime=0,this.frameId=0,this.renderId=0,this.startTime=null,this.updateMap=new WeakMap,this.updateBeforeMap=new WeakMap,this.updateAfterMap=new WeakMap,this.renderer=null,this.material=null,this.camera=null,this.object=null,this.scene=null}_getMaps(e,i){let n=e.get(i);return n===void 0&&(n={renderMap:new WeakMap,frameMap:new WeakMap},e.set(i,n)),n}updateBeforeNode(e){const i=e.getUpdateBeforeType(),n=e.updateReference(this);if(i===dn.FRAME){const{frameMap:s}=this._getMaps(this.updateBeforeMap,n);s.get(n)!==this.frameId&&e.updateBefore(this)!==!1&&s.set(n,this.frameId)}else if(i===dn.RENDER){const{renderMap:s}=this._getMaps(this.updateBeforeMap,n);s.get(n)!==this.renderId&&e.updateBefore(this)!==!1&&s.set(n,this.renderId)}else i===dn.OBJECT&&e.updateBefore(this)}updateAfterNode(e){const i=e.getUpdateAfterType(),n=e.updateReference(this);if(i===dn.FRAME){const{frameMap:s}=this._getMaps(this.updateAfterMap,n);s.get(n)!==this.frameId&&e.updateAfter(this)!==!1&&s.set(n,this.frameId)}else if(i===dn.RENDER){const{renderMap:s}=this._getMaps(this.updateAfterMap,n);s.get(n)!==this.renderId&&e.updateAfter(this)!==!1&&s.set(n,this.renderId)}else i===dn.OBJECT&&e.updateAfter(this)}updateNode(e){const i=e.getUpdateType(),n=e.updateReference(this);if(i===dn.FRAME){const{frameMap:s}=this._getMaps(this.updateMap,n);s.get(n)!==this.frameId&&e.update(this)!==!1&&s.set(n,this.frameId)}else if(i===dn.RENDER){const{renderMap:s}=this._getMaps(this.updateMap,n);s.get(n)!==this.renderId&&e.update(this)!==!1&&s.set(n,this.renderId)}else i===dn.OBJECT&&e.update(this)}update(){this.frameId++,this.lastTime===void 0&&(this.lastTime=performance.now()),this.deltaTime=(performance.now()-this.lastTime)/1e3,this.lastTime=performance.now(),this.time+=this.deltaTime}}class UR{constructor(e,i,n=null,s="",o=!1){this.type=e,this.name=i,this.count=n,this.qualifier=s,this.isConst=o}}UR.isNodeFunctionInput=!0;class L0e extends Yp{static get type(){return"DirectionalLightNode"}constructor(e=null){super(e)}setup(e){super.setup(e);const i=e.context.lightingModel,n=this.colorNode,s=pz(this.light),o=e.context.reflectedLight;i.direct({lightDirection:s,lightColor:n,reflectedLight:o},e.stack,e)}}const zR=new Cs,B_=new Cs;let ky=null;class D0e extends Yp{static get type(){return"RectAreaLightNode"}constructor(e=null){super(e),this.halfHeight=en(new Rt).setGroup(Mn),this.halfWidth=en(new Rt).setGroup(Mn),this.updateType=dn.RENDER}update(e){super.update(e);const{light:i}=this,n=e.camera.matrixWorldInverse;B_.identity(),zR.copy(i.matrixWorld),zR.premultiply(n),B_.extractRotation(zR),this.halfWidth.value.set(i.width*.5,0,0),this.halfHeight.value.set(0,i.height*.5,0),this.halfWidth.value.applyMatrix4(B_),this.halfHeight.value.applyMatrix4(B_)}setup(e){super.setup(e);let i,n;e.isAvailable("float32Filterable")?(i=Fs(ky.LTC_FLOAT_1),n=Fs(ky.LTC_FLOAT_2)):(i=Fs(ky.LTC_HALF_1),n=Fs(ky.LTC_HALF_2));const{colorNode:s,light:o}=this,l=e.context.lightingModel,u=MR(o),c=e.context.reflectedLight;l.directRectArea({lightColor:s,lightPosition:u,halfWidth:this.halfWidth,halfHeight:this.halfHeight,reflectedLight:c,ltc_1:i,ltc_2:n},e.stack,e)}static setLTC(e){ky=e}}class Tz extends Yp{static get type(){return"SpotLightNode"}constructor(e=null){super(e),this.coneCosNode=en(0).setGroup(Mn),this.penumbraCosNode=en(0).setGroup(Mn),this.cutoffDistanceNode=en(0).setGroup(Mn),this.decayExponentNode=en(0).setGroup(Mn)}update(e){super.update(e);const{light:i}=this;this.coneCosNode.value=Math.cos(i.angle),this.penumbraCosNode.value=Math.cos(i.angle*(1-i.penumbra)),this.cutoffDistanceNode.value=i.distance,this.decayExponentNode.value=i.decay}getSpotAttenuation(e){const{coneCosNode:i,penumbraCosNode:n}=this;return Gp(i,n,e)}setup(e){super.setup(e);const i=e.context.lightingModel,{colorNode:n,cutoffDistanceNode:s,decayExponentNode:o,light:l}=this,u=MR(l).sub(Wa),c=u.normalize(),h=c.dot(pz(l)),p=this.getSpotAttenuation(h),f=u.length(),m=mz({lightDistance:f,cutoffDistance:s,decayExponent:o}),g=n.mul(p).mul(m),y=e.context.reflectedLight;i.direct({lightDirection:c,lightColor:g,reflectedLight:y},e.stack,e)}}class O0e extends Tz{static get type(){return"IESSpotLightNode"}getSpotAttenuation(e){const i=this.light.iesMap;let n=null;if(i&&i.isTexture===!0){const s=e.acos().mul(1/Math.PI);n=Fs(i,Ki(s,0),0).r}else n=super.getSpotAttenuation(e);return n}}class P0e extends Yp{static get type(){return"AmbientLightNode"}constructor(e=null){super(e)}setup({context:e}){e.irradiance.addAssign(this.colorNode)}}class k0e extends Yp{static get type(){return"HemisphereLightNode"}constructor(e=null){super(e),this.lightPositionNode=dz(e),this.lightDirectionNode=this.lightPositionNode.normalize(),this.groundColorNode=en(new ts).setGroup(Mn)}update(e){const{light:i}=this;super.update(e),this.lightPositionNode.object3d=i,this.groundColorNode.value.copy(i.groundColor).multiplyScalar(i.intensity)}setup(e){const{colorNode:i,groundColorNode:n,lightDirectionNode:s}=this,o=Ec.dot(s).mul(.5).add(.5),l=ys(n,i,o);e.context.irradiance.addAssign(l)}}class F0e extends Yp{static get type(){return"LightProbeNode"}constructor(e=null){super(e);const i=[];for(let n=0;n<9;n++)i.push(new Rt);this.lightProbe=Cy(i)}update(e){const{light:i}=this;super.update(e);for(let n=0;n<9;n++)this.lightProbe.array[n].copy(i.sh.coefficients[n]).multiplyScalar(i.intensity)}setup(e){const i=n0e($6,this.lightProbe);e.context.irradiance.addAssign(i)}}class Mz{parseFunction(){console.warn("Abstract function.")}}class jR{constructor(e,i,n="",s=""){this.type=e,this.inputs=i,this.name=n,this.precision=s}getCode(){console.warn("Abstract function.")}}jR.isNodeFunction=!0;const U0e=/^\s*(highp|mediump|lowp)?\s*([a-z_0-9]+)\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)/i,z0e=/[a-z_0-9]+/ig,Rz="#pragma main",j0e=r=>{r=r.trim();const e=r.indexOf(Rz),i=e!==-1?r.slice(e+Rz.length):r,n=i.match(U0e);if(n!==null&&n.length===5){const s=n[4],o=[];let l=null;for(;(l=z0e.exec(s))!==null;)o.push(l);const u=[];let c=0;for(;c<o.length;){const y=o[c][0]==="const";y===!0&&c++;let x=o[c][0];x==="in"||x==="out"||x==="inout"?c++:x="";const v=o[c++][0];let _=Number.parseInt(o[c][0]);Number.isNaN(_)===!1?c++:_=null;const T=o[c++][0];u.push(new UR(v,T,_,x,y))}const h=i.substring(n[0].length),p=n[3]!==void 0?n[3]:"",f=n[2],m=n[1]!==void 0?n[1]:"",g=e!==-1?r.slice(0,e):"";return{type:f,inputs:u,name:p,precision:m,inputsCode:s,blockCode:h,headerCode:g}}else throw new Error("FunctionNode: Function is not a GLSL code.")};class V0e extends jR{constructor(e){const{type:i,inputs:n,name:s,precision:o,inputsCode:l,blockCode:u,headerCode:c}=j0e(e);super(i,n,s,o),this.inputsCode=l,this.blockCode=u,this.headerCode=c}getCode(e=this.name){let i;const n=this.blockCode;if(n!==""){const{type:s,inputsCode:o,headerCode:l,precision:u}=this;let c=`${s} ${e} ( ${o.trim()} )`;u!==""&&(c=`${u} ${c}`),i=l+c+n}else i="";return i}}class G0e extends Mz{parseFunction(e){return new V0e(e)}}const Iz=new WeakMap;class H0e extends Ed{constructor(e,i){super(),this.renderer=e,this.backend=i,this.nodeFrame=new Sz,this.nodeBuilderCache=new Map,this.callHashCache=new qc,this.groupsData=new qc}updateGroup(e){const i=e.groupNode,n=i.name;if(n===b6.name)return!0;if(n===Mn.name){const l=this.get(e),u=this.nodeFrame.renderId;return l.renderId!==u?(l.renderId=u,!0):!1}if(n===The.name){const l=this.get(e),u=this.nodeFrame.frameId;return l.frameId!==u?(l.frameId=u,!0):!1}const s=[i,e];let o=this.groupsData.get(s);return o===void 0&&this.groupsData.set(s,o={}),o.version!==i.version?(o.version=i.version,!0):!1}getForRenderCacheKey(e){return e.initialCacheKey}getForRender(e){const i=this.get(e);let n=i.nodeBuilderState;if(n===void 0){const{nodeBuilderCache:s}=this,o=this.getForRenderCacheKey(e);if(n=s.get(o),n===void 0){const l=this.backend.createNodeBuilder(e.object,this.renderer);l.scene=e.scene,l.material=e.material,l.camera=e.camera,l.context.material=e.material,l.lightsNode=e.lightsNode,l.environmentNode=this.getEnvironmentNode(e.scene),l.fogNode=this.getFogNode(e.scene),l.clippingContext=e.clippingContext,l.build(),n=this._createNodeBuilderState(l),s.set(o,n)}n.usedTimes++,i.nodeBuilderState=n}return n}delete(e){if(e.isRenderObject){const i=this.get(e).nodeBuilderState;i.usedTimes--,i.usedTimes===0&&this.nodeBuilderCache.delete(this.getForRenderCacheKey(e))}return super.delete(e)}getForCompute(e){const i=this.get(e);let n=i.nodeBuilderState;if(n===void 0){const s=this.backend.createNodeBuilder(e,this.renderer);s.build(),n=this._createNodeBuilderState(s),i.nodeBuilderState=n}return n}_createNodeBuilderState(e){return new o0e(e.vertexShader,e.fragmentShader,e.computeShader,e.getAttributesArray(),e.getBindings(),e.updateNodes,e.updateBeforeNodes,e.updateAfterNodes,e.monitor,e.transforms)}getEnvironmentNode(e){return e.environmentNode||this.get(e).environmentNode||null}getBackgroundNode(e){return e.backgroundNode||this.get(e).backgroundNode||null}getFogNode(e){return e.fogNode||this.get(e).fogNode||null}getCacheKey(e,i){const n=[e,i],s=this.renderer.info.calls;let o=this.callHashCache.get(n);if(o===void 0||o.callId!==s){const l=this.getEnvironmentNode(e),u=this.getFogNode(e),c=[];i&&c.push(i.getCacheKey(!0)),l&&c.push(l.getCacheKey()),u&&c.push(u.getCacheKey()),c.push(this.renderer.shadowMap.enabled?1:0),o={callId:s,cacheKey:r6(c)},this.callHashCache.set(n,o)}return o.cacheKey}updateScene(e){this.updateEnvironment(e),this.updateFog(e),this.updateBackground(e)}get isToneMappingState(){return!this.renderer.getRenderTarget()}updateBackground(e){const i=this.get(e),n=e.background;if(n){const s=e.backgroundBlurriness===0&&i.backgroundBlurriness>0||e.backgroundBlurriness>0&&i.backgroundBlurriness===0;if(i.background!==n||s){let o=null;if(n.isCubeTexture===!0||n.mapping===YA||n.mapping===KA||n.mapping===xM)if(e.backgroundBlurriness>0||n.mapping===xM)o=Y8(n);else{let l;n.isCubeTexture===!0?l=wy(n):l=Fs(n),o=C8(l)}else n.isTexture===!0?o=Fs(n,Iy.flipY()).setUpdateMatrix(!0):n.isColor!==!0&&console.error("WebGPUNodes: Unsupported background configuration.",n);i.backgroundNode=o,i.background=n,i.backgroundBlurriness=e.backgroundBlurriness}}else i.backgroundNode&&(delete i.backgroundNode,delete i.background)}updateFog(e){const i=this.get(e),n=e.fog;if(n){if(i.fog!==n){let s=null;if(n.isFogExp2){const o=Ns("color","color",n).setGroup(Mn),l=Ns("density","float",n).setGroup(Mn);s=Vge(o,l)}else if(n.isFog){const o=Ns("color","color",n).setGroup(Mn),l=Ns("near","float",n).setGroup(Mn),u=Ns("far","float",n).setGroup(Mn);s=zge(o,l,u)}else console.error("WebGPUNodes: Unsupported fog configuration.",n);i.fogNode=s,i.fog=n}}else delete i.fogNode,delete i.fog}updateEnvironment(e){const i=this.get(e),n=e.environment;if(n){if(i.environment!==n){let s=null;n.isCubeTexture===!0?s=wy(n):n.isTexture===!0?s=Fs(n):console.error("Nodes: Unsupported environment configuration.",n),i.environmentNode=s,i.environment=n}}else i.environmentNode&&(delete i.environmentNode,delete i.environment)}getNodeFrame(e=this.renderer,i=null,n=null,s=null,o=null){const l=this.nodeFrame;return l.renderer=e,l.scene=i,l.object=n,l.camera=s,l.material=o,l}getNodeFrameForRender(e){return this.getNodeFrame(e.renderer,e.scene,e.object,e.camera,e.material)}getOutputCacheKey(){const e=this.renderer;return e.toneMapping+","+e.currentColorSpace}hasOutputChange(e){return Iz.get(e)!==this.getOutputCacheKey()}getOutputNode(e){const i=this.renderer,n=this.getOutputCacheKey(),s=Fs(e,Iy).renderOutput(i.toneMapping,i.currentColorSpace);return Iz.set(e,n),s}updateBefore(e){const i=e.getNodeBuilderState();for(const n of i.updateBeforeNodes)this.getNodeFrameForRender(e).updateBeforeNode(n)}updateAfter(e){const i=e.getNodeBuilderState();for(const n of i.updateAfterNodes)this.getNodeFrameForRender(e).updateAfterNode(n)}updateForCompute(e){const i=this.getNodeFrame(),n=this.getForCompute(e);for(const s of n.updateNodes)i.updateNode(s)}updateForRender(e){const i=this.getNodeFrameForRender(e),n=e.getNodeBuilderState();for(const s of n.updateNodes)i.updateNode(s)}needsRefresh(e){const i=this.getNodeFrameForRender(e);return e.getMonitor().needsRefresh(e,i)}dispose(){super.dispose(),this.nodeFrame=new Sz,this.nodeBuilderCache=new Map}}class W0e{constructor(e,i){this.scene=e,this.camera=i}clone(){return Object.assign(new this.constructor,this)}}class Q0e{constructor(){this.lists=new qc}get(e,i){const n=this.lists,s=[e,i];let o=n.get(s);return o===void 0&&(o=new W0e(e,i),n.set(s,o)),o}dispose(){this.lists=new qc}}class Bz{constructor(){this.lightNodes=new WeakMap,this.materialNodes=new Map,this.toneMappingNodes=new Map}fromMaterial(e){if(e.isNodeMaterial)return e;let i=null;const n=this.getMaterialNodeClass(e.type);if(n!==null){i=new n;for(const s in e)i[s]=e[s]}return i}addToneMapping(e,i){this.addType(e,i,this.toneMappingNodes)}getToneMappingFunction(e){return this.toneMappingNodes.get(e)||null}getMaterialNodeClass(e){return this.materialNodes.get(e)||null}addMaterial(e,i){this.addType(e,i.type,this.materialNodes)}getLightNodeClass(e){return this.lightNodes.get(e)||null}addLight(e,i){this.addClass(e,i,this.lightNodes)}addType(e,i,n){if(n.has(i)){console.warn(`Redefinition of node ${i}`);return}if(typeof e!="function")throw new Error(`Node class ${e.name} is not a class.`);if(typeof i=="function"||typeof i=="object")throw new Error(`Base class ${i} is not a class.`);n.set(i,e)}addClass(e,i,n){if(n.has(i)){console.warn(`Redefinition of node ${i.name}`);return}if(typeof e!="function")throw new Error(`Node class ${e.name} is not a class.`);if(typeof i!="function")throw new Error(`Base class ${i.name} is not a class.`);n.set(i,e)}}const q0e=new fz;class X0e extends qc{constructor(){super()}createNode(e=[]){return new fz().setLights(e)}getNode(e,i){if(e.isQuadMesh)return q0e;const n=[e,i];let s=this.get(n);return s===void 0&&(s=this.createNode(),this.set(n,s)),s}}const Nz=new z5,N_=new Pn,VR=new es,GR=new G5,L_=new Cs,Sd=new es;class Y0e{constructor(e,i={}){this.isRenderer=!0;const{logarithmicDepthBuffer:n=!1,alpha:s=!0,depth:o=!0,stencil:l=!1,antialias:u=!1,samples:c=0,getFallback:h=null}=i;this.domElement=e.getDomElement(),this.backend=e,this.samples=c||u===!0?4:0,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.alpha=s,this.logarithmicDepthBuffer=n,this.outputColorSpace=Dr,this.toneMapping=Zm,this.toneMappingExposure=1,this.sortObjects=!0,this.depth=o,this.stencil=l,this.clippingPlanes=[],this.info=new nge,this.nodes={modelViewMatrix:null,modelNormalViewMatrix:null},this.library=new Bz,this.lighting=new X0e,this._getFallback=h,this._pixelRatio=1,this._width=this.domElement.width,this._height=this.domElement.height,this._viewport=new es(0,0,this._width,this._height),this._scissor=new es(0,0,this._width,this._height),this._scissorTest=!1,this._attributes=null,this._geometries=null,this._nodes=null,this._animation=null,this._bindings=null,this._objects=null,this._pipelines=null,this._bundles=null,this._renderLists=null,this._renderContexts=null,this._textures=null,this._background=null,this._quad=new sz(new sa),this._quad.material.type="Renderer_output",this._currentRenderContext=null,this._opaqueSort=null,this._transparentSort=null,this._frameBufferTarget=null;const p=this.alpha===!0?0:1;this._clearColor=new yR(0,0,0,p),this._clearDepth=1,this._clearStencil=0,this._renderTarget=null,this._activeCubeFace=0,this._activeMipmapLevel=0,this._mrt=null,this._renderObjectFunction=null,this._currentRenderObjectFunction=null,this._currentRenderBundle=null,this._handleObjectFunction=this._renderObjectDirect,this._isDeviceLost=!1,this.onDeviceLost=this._onDeviceLost,this._initialized=!1,this._initPromise=null,this._compilationPromises=null,this.transparent=!0,this.opaque=!0,this.shadowMap={enabled:!1,type:sce},this.xr={enabled:!1},this.debug={checkShaderErrors:!0,onShaderError:null,getShaderAsync:async(f,m,g)=>{await this.compileAsync(f,m);const y=this._renderLists.get(f,m),x=this._renderContexts.get(f,m,this._renderTarget),v=f.overrideMaterial||g.material,_=this._objects.get(g,v,f,m,y.lightsNode,x),{fragmentShader:T,vertexShader:w}=_.getNodeBuilderState();return{fragmentShader:T,vertexShader:w}}}}async init(){if(this._initialized)throw new Error("Renderer: Backend has already been initialized.");return this._initPromise!==null?this._initPromise:(this._initPromise=new Promise(async(e,i)=>{let n=this.backend;try{await n.init(this)}catch(s){if(this._getFallback!==null)try{this.backend=n=this._getFallback(s),await n.init(this)}catch(o){i(o);return}else{i(s);return}}this._nodes=new H0e(this,n),this._animation=new Xme(this._nodes,this.info),this._attributes=new tge(n),this._background=new s0e(this,this._nodes),this._geometries=new rge(this._attributes,this.info),this._textures=new Age(this,n,this.info),this._pipelines=new lge(n,this._nodes),this._bindings=new cge(n,this._nodes,this._textures,this._attributes,this._pipelines,this.info),this._objects=new Zme(this,this._nodes,this._geometries,this._pipelines,this._bindings,this.info),this._renderLists=new dge(this.lighting),this._bundles=new Q0e,this._renderContexts=new mge,this._initialized=!0,e()}),this._initPromise)}get coordinateSystem(){return this.backend.coordinateSystem}async compileAsync(e,i,n=null){if(this._isDeviceLost===!0)return;this._initialized===!1&&await this.init();const s=this._nodes.nodeFrame,o=s.renderId,l=this._currentRenderContext,u=this._currentRenderObjectFunction,c=this._compilationPromises,h=e.isScene===!0?e:Nz;n===null&&(n=e);const p=this._renderTarget,f=this._renderContexts.get(n,i,p),m=this._activeMipmapLevel,g=[];this._currentRenderContext=f,this._currentRenderObjectFunction=this.renderObject,this._handleObjectFunction=this._createObjectPipeline,this._compilationPromises=g,s.renderId++,s.update(),f.depth=this.depth,f.stencil=this.stencil,f.clippingContext||(f.clippingContext=new gR),f.clippingContext.updateGlobal(this,i),h.onBeforeRender(this,e,i,p);const y=this._renderLists.get(e,i);if(y.begin(),this._projectObject(e,i,0,y),n!==e&&n.traverseVisible(function(T){T.isLight&&T.layers.test(i.layers)&&y.pushLight(T)}),y.finish(),p!==null){this._textures.updateRenderTarget(p,m);const T=this._textures.get(p);f.textures=T.textures,f.depthTexture=T.depthTexture}else f.textures=null,f.depthTexture=null;this._nodes.updateScene(h),this._background.update(h,y,f);const x=y.opaque,v=y.transparent,_=y.lightsNode;this.opaque===!0&&x.length>0&&this._renderObjects(x,i,h,_),this.transparent===!0&&v.length>0&&this._renderTransparents(v,i,h,_),s.renderId=o,this._currentRenderContext=l,this._currentRenderObjectFunction=u,this._compilationPromises=c,this._handleObjectFunction=this._renderObjectDirect,await Promise.all(g)}async renderAsync(e,i){this._initialized===!1&&await this.init();const n=this._renderScene(e,i);await this.backend.resolveTimestampAsync(n,"render")}async waitForGPU(){await this.backend.waitForGPU()}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}_onDeviceLost(e){let i=`THREE.WebGPURenderer: ${e.api} Device Lost:

Message: ${e.message}`;e.reason&&(i+=`
Reason: ${e.reason}`),console.error(i),this._isDeviceLost=!0}_renderBundle(e,i,n){const{bundleGroup:s,camera:o,renderList:l}=e,u=this._currentRenderContext,c=this._bundles.get(s,o),h=this.backend.get(c);h.renderContexts===void 0&&(h.renderContexts=new Set);const p=s.version!==h.version,f=h.renderContexts.has(u)===!1||p;if(h.renderContexts.add(u),f){this.backend.beginBundle(u),(h.renderObjects===void 0||p)&&(h.renderObjects=[]),this._currentRenderBundle=c;const m=l.opaque;this.opaque===!0&&m.length>0&&this._renderObjects(m,o,i,n),this._currentRenderBundle=null,this.backend.finishBundle(u,c),h.version=s.version}else{const{renderObjects:m}=h;for(let g=0,y=m.length;g<y;g++){const x=m[g];this._nodes.needsRefresh(x)&&(this._nodes.updateBefore(x),this._nodes.updateForRender(x),this._bindings.updateForRender(x),this._nodes.updateAfter(x))}}this.backend.addBundle(u,c)}render(e,i){if(this._initialized===!1)return console.warn("THREE.Renderer: .render() called before the backend is initialized. Try using .renderAsync() instead."),this.renderAsync(e,i);this._renderScene(e,i)}_getFrameBufferTarget(){const{currentToneMapping:e,currentColorSpace:i}=this;if(e===Zm&&i===cd)return null;const{width:n,height:s}=this.getDrawingBufferSize(N_),{depth:o,stencil:l}=this;let u=this._frameBufferTarget;return u===null&&(u=new cg(n,s,{depthBuffer:o,stencilBuffer:l,type:zu,format:rg,colorSpace:cd,generateMipmaps:!1,minFilter:pl,magFilter:pl,samples:this.samples}),u.isPostProcessingRenderTarget=!0,this._frameBufferTarget=u),u.depthBuffer=o,u.stencilBuffer=l,u.setSize(n,s),u.viewport.copy(this._viewport),u.scissor.copy(this._scissor),u.viewport.multiplyScalar(this._pixelRatio),u.scissor.multiplyScalar(this._pixelRatio),u.scissorTest=this._scissorTest,u}_renderScene(e,i,n=!0){if(this._isDeviceLost===!0)return;const s=n?this._getFrameBufferTarget():null,o=this._nodes.nodeFrame,l=o.renderId,u=this._currentRenderContext,c=this._currentRenderObjectFunction,h=e.isScene===!0?e:Nz,p=this._renderTarget,f=this._activeCubeFace,m=this._activeMipmapLevel;let g;s!==null?(g=s,this.setRenderTarget(g)):g=p;const y=this._renderContexts.get(e,i,g);this._currentRenderContext=y,this._currentRenderObjectFunction=this._renderObjectFunction||this.renderObject,this.info.calls++,this.info.render.calls++,this.info.render.frameCalls++,o.renderId=this.info.calls;const x=this.coordinateSystem;i.coordinateSystem!==x&&(i.coordinateSystem=x,i.updateProjectionMatrix()),e.matrixWorldAutoUpdate===!0&&e.updateMatrixWorld(),i.parent===null&&i.matrixWorldAutoUpdate===!0&&i.updateMatrixWorld();let v=this._viewport,_=this._scissor,T=this._pixelRatio;g!==null&&(v=g.viewport,_=g.scissor,T=1),this.getDrawingBufferSize(N_),VR.set(0,0,N_.width,N_.height);const w=v.minDepth===void 0?0:v.minDepth,S=v.maxDepth===void 0?1:v.maxDepth;y.viewportValue.copy(v).multiplyScalar(T).floor(),y.viewportValue.width>>=m,y.viewportValue.height>>=m,y.viewportValue.minDepth=w,y.viewportValue.maxDepth=S,y.viewport=y.viewportValue.equals(VR)===!1,y.scissorValue.copy(_).multiplyScalar(T).floor(),y.scissor=this._scissorTest&&y.scissorValue.equals(VR)===!1,y.scissorValue.width>>=m,y.scissorValue.height>>=m,y.clippingContext||(y.clippingContext=new gR),y.clippingContext.updateGlobal(this,i),h.onBeforeRender(this,e,i,g),L_.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),GR.setFromProjectionMatrix(L_,x);const R=this._renderLists.get(e,i);if(R.begin(),this._projectObject(e,i,0,R),R.finish(),this.sortObjects===!0&&R.sort(this._opaqueSort,this._transparentSort),g!==null){this._textures.updateRenderTarget(g,m);const U=this._textures.get(g);y.textures=U.textures,y.depthTexture=U.depthTexture,y.width=U.width,y.height=U.height,y.renderTarget=g,y.depth=g.depthBuffer,y.stencil=g.stencilBuffer}else y.textures=null,y.depthTexture=null,y.width=this.domElement.width,y.height=this.domElement.height,y.depth=this.depth,y.stencil=this.stencil;y.width>>=m,y.height>>=m,y.activeCubeFace=f,y.activeMipmapLevel=m,y.occlusionQueryCount=R.occlusionQueryCount,this._nodes.updateScene(h),this._background.update(h,R,y),this.backend.beginRender(y);const{bundles:B,lightsNode:I,transparentDoublePass:D,transparent:L,opaque:O}=R;if(B.length>0&&this._renderBundles(B,h,I),this.opaque===!0&&O.length>0&&this._renderObjects(O,i,h,I),this.transparent===!0&&L.length>0&&this._renderTransparents(L,D,i,h,I),this.backend.finishRender(y),o.renderId=l,this._currentRenderContext=u,this._currentRenderObjectFunction=c,s!==null){this.setRenderTarget(p,f,m);const U=this._quad;this._nodes.hasOutputChange(g.texture)&&(U.material.fragmentNode=this._nodes.getOutputNode(g.texture),U.material.needsUpdate=!0),this._renderScene(U,U.camera,!1)}return h.onAfterRender(this,e,i,g),y}getMaxAnisotropy(){return this.backend.getMaxAnisotropy()}getActiveCubeFace(){return this._activeCubeFace}getActiveMipmapLevel(){return this._activeMipmapLevel}async setAnimationLoop(e){this._initialized===!1&&await this.init(),this._animation.setAnimationLoop(e)}async getArrayBufferAsync(e){return await this.backend.getArrayBufferAsync(e)}getContext(){return this.backend.getContext()}getPixelRatio(){return this._pixelRatio}getDrawingBufferSize(e){return e.set(this._width*this._pixelRatio,this._height*this._pixelRatio).floor()}getSize(e){return e.set(this._width,this._height)}setPixelRatio(e=1){this._pixelRatio!==e&&(this._pixelRatio=e,this.setSize(this._width,this._height,!1))}setDrawingBufferSize(e,i,n){this._width=e,this._height=i,this._pixelRatio=n,this.domElement.width=Math.floor(e*n),this.domElement.height=Math.floor(i*n),this.setViewport(0,0,e,i),this._initialized&&this.backend.updateSize()}setSize(e,i,n=!0){this._width=e,this._height=i,this.domElement.width=Math.floor(e*this._pixelRatio),this.domElement.height=Math.floor(i*this._pixelRatio),n===!0&&(this.domElement.style.width=e+"px",this.domElement.style.height=i+"px"),this.setViewport(0,0,e,i),this._initialized&&this.backend.updateSize()}setOpaqueSort(e){this._opaqueSort=e}setTransparentSort(e){this._transparentSort=e}getScissor(e){const i=this._scissor;return e.x=i.x,e.y=i.y,e.width=i.width,e.height=i.height,e}setScissor(e,i,n,s){const o=this._scissor;e.isVector4?o.copy(e):o.set(e,i,n,s)}getScissorTest(){return this._scissorTest}setScissorTest(e){this._scissorTest=e,this.backend.setScissorTest(e)}getViewport(e){return e.copy(this._viewport)}setViewport(e,i,n,s,o=0,l=1){const u=this._viewport;e.isVector4?u.copy(e):u.set(e,i,n,s),u.minDepth=o,u.maxDepth=l}getClearColor(e){return e.copy(this._clearColor)}setClearColor(e,i=1){this._clearColor.set(e),this._clearColor.a=i}getClearAlpha(){return this._clearColor.a}setClearAlpha(e){this._clearColor.a=e}getClearDepth(){return this._clearDepth}setClearDepth(e){this._clearDepth=e}getClearStencil(){return this._clearStencil}setClearStencil(e){this._clearStencil=e}isOccluded(e){const i=this._currentRenderContext;return i&&this.backend.isOccluded(i,e)}clear(e=!0,i=!0,n=!0){if(this._initialized===!1)return console.warn("THREE.Renderer: .clear() called before the backend is initialized. Try using .clearAsync() instead."),this.clearAsync(e,i,n);const s=this._renderTarget||this._getFrameBufferTarget();let o=null;if(s!==null&&(this._textures.updateRenderTarget(s),o=this._textures.get(s)),this.backend.clear(e,i,n,o),s!==null&&this._renderTarget===null){const l=this._quad;this._nodes.hasOutputChange(s.texture)&&(l.material.fragmentNode=this._nodes.getOutputNode(s.texture),l.material.needsUpdate=!0),this._renderScene(l,l.camera,!1)}}clearColor(){return this.clear(!0,!1,!1)}clearDepth(){return this.clear(!1,!0,!1)}clearStencil(){return this.clear(!1,!1,!0)}async clearAsync(e=!0,i=!0,n=!0){this._initialized===!1&&await this.init(),this.clear(e,i,n)}clearColorAsync(){return this.clearAsync(!0,!1,!1)}clearDepthAsync(){return this.clearAsync(!1,!0,!1)}clearStencilAsync(){return this.clearAsync(!1,!1,!0)}get currentToneMapping(){return this._renderTarget!==null?Zm:this.toneMapping}get currentColorSpace(){return this._renderTarget!==null?cd:this.outputColorSpace}dispose(){this.info.dispose(),this.backend.dispose(),this._animation.dispose(),this._objects.dispose(),this._pipelines.dispose(),this._nodes.dispose(),this._bindings.dispose(),this._renderLists.dispose(),this._renderContexts.dispose(),this._textures.dispose(),this.setRenderTarget(null),this.setAnimationLoop(null)}setRenderTarget(e,i=0,n=0){this._renderTarget=e,this._activeCubeFace=i,this._activeMipmapLevel=n}getRenderTarget(){return this._renderTarget}setRenderObjectFunction(e){this._renderObjectFunction=e}getRenderObjectFunction(){return this._renderObjectFunction}compute(e){if(this.isDeviceLost===!0)return;if(this._initialized===!1)return console.warn("THREE.Renderer: .compute() called before the backend is initialized. Try using .computeAsync() instead."),this.computeAsync(e);const i=this._nodes.nodeFrame,n=i.renderId;this.info.calls++,this.info.compute.calls++,this.info.compute.frameCalls++,i.renderId=this.info.calls;const s=this.backend,o=this._pipelines,l=this._bindings,u=this._nodes,c=Array.isArray(e)?e:[e];if(c[0]===void 0||c[0].isComputeNode!==!0)throw new Error("THREE.Renderer: .compute() expects a ComputeNode.");s.beginCompute(e);for(const h of c){if(o.has(h)===!1){const m=()=>{h.removeEventListener("dispose",m),o.delete(h),l.delete(h),u.delete(h)};h.addEventListener("dispose",m);const g=h.onInitFunction;g!==null&&g.call(h,{renderer:this})}u.updateForCompute(h),l.updateForCompute(h);const p=l.getForCompute(h),f=o.getForCompute(h,p);s.compute(e,h,p,f)}s.finishCompute(e),i.renderId=n}async computeAsync(e){this._initialized===!1&&await this.init(),this.compute(e),await this.backend.resolveTimestampAsync(e,"compute")}async hasFeatureAsync(e){return this._initialized===!1&&await this.init(),this.backend.hasFeature(e)}hasFeature(e){return this._initialized===!1?(console.warn("THREE.Renderer: .hasFeature() called before the backend is initialized. Try using .hasFeatureAsync() instead."),!1):this.backend.hasFeature(e)}copyFramebufferToTexture(e,i=null){if(i!==null)if(i.isVector2)i=Sd.set(i.x,i.y,e.image.width,e.image.height).floor();else if(i.isVector4)i=Sd.copy(i).floor();else{console.error("THREE.Renderer.copyFramebufferToTexture: Invalid rectangle.");return}else i=Sd.set(0,0,e.image.width,e.image.height);let n=this._currentRenderContext,s;n!==null?s=n.renderTarget:(s=this._renderTarget||this._getFrameBufferTarget(),s!==null&&(this._textures.updateRenderTarget(s),n=this._textures.get(s))),this._textures.updateTexture(e,{renderTarget:s}),this.backend.copyFramebufferToTexture(e,n,i)}copyTextureToTexture(e,i,n=null,s=null,o=0){this._textures.updateTexture(e),this._textures.updateTexture(i),this.backend.copyTextureToTexture(e,i,n,s,o)}readRenderTargetPixelsAsync(e,i,n,s,o,l=0,u=0){return this.backend.copyTextureToBuffer(e.textures[l],i,n,s,o,u)}_projectObject(e,i,n,s){if(e.visible===!1)return;if(e.layers.test(i.layers)){if(e.isGroup)n=e.renderOrder;else if(e.isLOD)e.autoUpdate===!0&&e.update(i);else if(e.isLight)s.pushLight(e);else if(e.isSprite){if(!e.frustumCulled||GR.intersectsSprite(e)){this.sortObjects===!0&&Sd.setFromMatrixPosition(e.matrixWorld).applyMatrix4(L_);const{geometry:l,material:u}=e;u.visible&&s.push(e,l,u,n,Sd.z,null)}}else if(e.isLineLoop)console.error("THREE.Renderer: Objects of type THREE.LineLoop are not supported. Please use THREE.Line or THREE.LineSegments.");else if((e.isMesh||e.isLine||e.isPoints)&&(!e.frustumCulled||GR.intersectsObject(e))){const{geometry:l,material:u}=e;if(this.sortObjects===!0&&(l.boundingSphere===null&&l.computeBoundingSphere(),Sd.copy(l.boundingSphere.center).applyMatrix4(e.matrixWorld).applyMatrix4(L_)),Array.isArray(u)){const c=l.groups;for(let h=0,p=c.length;h<p;h++){const f=c[h],m=u[f.materialIndex];m&&m.visible&&s.push(e,l,m,n,Sd.z,f)}}else u.visible&&s.push(e,l,u,n,Sd.z,null)}}if(e.isBundleGroup===!0&&this.backend.beginBundle!==void 0){const l=s;s=this._renderLists.get(e,i),s.begin(),l.pushBundle({bundleGroup:e,camera:i,renderList:s}),s.finish()}const o=e.children;for(let l=0,u=o.length;l<u;l++)this._projectObject(o[l],i,n,s)}_renderBundles(e,i,n){for(const s of e)this._renderBundle(s,i,n)}_renderTransparents(e,i,n,s,o){if(i.length>0){for(const{material:l}of i)l.side=pc;this._renderObjects(i,n,s,o,"backSide");for(const{material:l}of i)l.side=Ym;this._renderObjects(e,n,s,o);for(const{material:l}of i)l.side=Km}else this._renderObjects(e,n,s,o)}_renderObjects(e,i,n,s,o=null){for(let l=0,u=e.length;l<u;l++){const c=e[l],{object:h,geometry:p,material:f,group:m}=c;if(i.isArrayCamera){const g=i.cameras;for(let y=0,x=g.length;y<x;y++){const v=g[y];if(h.layers.test(v.layers)){const _=v.viewport,T=_.minDepth===void 0?0:_.minDepth,w=_.maxDepth===void 0?1:_.maxDepth,S=this._currentRenderContext.viewportValue;S.copy(_).multiplyScalar(this._pixelRatio).floor(),S.minDepth=T,S.maxDepth=w,this.backend.updateViewport(this._currentRenderContext),this._currentRenderObjectFunction(h,n,v,p,f,m,s,o)}}}else this._currentRenderObjectFunction(h,n,i,p,f,m,s,o)}}renderObject(e,i,n,s,o,l,u,c=null){let h,p,f;if(e.onBeforeRender(this,i,n,s,o,l),i.overrideMaterial!==null){const m=i.overrideMaterial;o.positionNode&&o.positionNode.isNode&&(h=m.positionNode,m.positionNode=o.positionNode),m.isShadowNodeMaterial&&(m.side=o.shadowSide===null?o.side:o.shadowSide,o.depthNode&&o.depthNode.isNode&&(f=m.depthNode,m.depthNode=o.depthNode),o.shadowNode&&o.shadowNode.isNode&&(p=m.fragmentNode,m.fragmentNode=o.shadowNode),this.localClippingEnabled&&(o.clipShadows?(m.clippingPlanes!==o.clippingPlanes&&(m.clippingPlanes=o.clippingPlanes,m.needsUpdate=!0),m.clipIntersection!==o.clipIntersection&&(m.clipIntersection=o.clipIntersection)):Array.isArray(m.clippingPlanes)&&(m.clippingPlanes=null,m.needsUpdate=!0))),o=m}o.transparent===!0&&o.side===Km&&o.forceSinglePass===!1?(o.side=pc,this._handleObjectFunction(e,o,i,n,u,l,"backSide"),o.side=Ym,this._handleObjectFunction(e,o,i,n,u,l,c),o.side=Km):this._handleObjectFunction(e,o,i,n,u,l,c),h!==void 0&&(i.overrideMaterial.positionNode=h),f!==void 0&&(i.overrideMaterial.depthNode=f),p!==void 0&&(i.overrideMaterial.fragmentNode=p),e.onAfterRender(this,i,n,s,o,l)}_renderObjectDirect(e,i,n,s,o,l,u){const c=this._objects.get(e,i,n,s,o,this._currentRenderContext,u);c.drawRange=e.geometry.drawRange,c.group=l;const h=this._nodes.needsRefresh(c);h&&(this._nodes.updateBefore(c),this._geometries.updateForRender(c),this._nodes.updateForRender(c),this._bindings.updateForRender(c)),this._pipelines.updateForRender(c),this._currentRenderBundle!==null&&(this.backend.get(this._currentRenderBundle).renderObjects.push(c),c.bundle=this._currentRenderBundle.scene),this.backend.draw(c,this.info),h&&this._nodes.updateAfter(c)}_createObjectPipeline(e,i,n,s,o,l){const u=this._objects.get(e,i,n,s,o,this._currentRenderContext,l);this._nodes.updateBefore(u),this._geometries.updateForRender(u),this._nodes.updateForRender(u),this._bindings.updateForRender(u),this._pipelines.getForRender(u,this._compilationPromises),this._nodes.updateAfter(u)}get compile(){return this.compileAsync}}class HR{constructor(e=""){this.name=e,this.visibility=0}setVisibility(e){this.visibility|=e}clone(){return Object.assign(new this.constructor,this)}}function K0e(r){return r+(wd-r%wd)%wd}class Lz extends HR{constructor(e,i=null){super(e),this.isBuffer=!0,this.bytesPerElement=Float32Array.BYTES_PER_ELEMENT,this._buffer=i}get byteLength(){return K0e(this._buffer.byteLength)}get buffer(){return this._buffer}update(){return!0}}class Dz extends Lz{constructor(e,i=null){super(e,i),this.isUniformBuffer=!0}}let J0e=0;class Oz extends Dz{constructor(e,i){super("UniformBuffer_"+J0e++,e?e.value:null),this.nodeUniform=e,this.groupNode=i}get buffer(){return this.nodeUniform.value}}class Z0e extends Dz{constructor(e){super(e),this.isUniformsGroup=!0,this._values=null,this.uniforms=[]}addUniform(e){return this.uniforms.push(e),this}removeUniform(e){const i=this.uniforms.indexOf(e);return i!==-1&&this.uniforms.splice(i,1),this}get values(){return this._values===null&&(this._values=Array.from(this.buffer)),this._values}get buffer(){let e=this._buffer;if(e===null){const i=this.byteLength;e=new Float32Array(new ArrayBuffer(i)),this._buffer=e}return e}get byteLength(){let e=0;for(let i=0,n=this.uniforms.length;i<n;i++){const s=this.uniforms[i],{boundary:o,itemSize:l}=s,u=e%wd,c=wd-u;u!==0&&c-o<0?e+=wd-u:u%o!==0&&(e+=u%o),s.offset=e/this.bytesPerElement,e+=l*this.bytesPerElement}return Math.ceil(e/wd)*wd}update(){let e=!1;for(const i of this.uniforms)this.updateByType(i)===!0&&(e=!0);return e}updateByType(e){if(e.isNumberUniform)return this.updateNumber(e);if(e.isVector2Uniform)return this.updateVector2(e);if(e.isVector3Uniform)return this.updateVector3(e);if(e.isVector4Uniform)return this.updateVector4(e);if(e.isColorUniform)return this.updateColor(e);if(e.isMatrix3Uniform)return this.updateMatrix3(e);if(e.isMatrix4Uniform)return this.updateMatrix4(e);console.error("THREE.WebGPUUniformsGroup: Unsupported uniform type.",e)}updateNumber(e){let i=!1;const n=this.values,s=e.getValue(),o=e.offset;if(n[o]!==s){const l=this.buffer;l[o]=n[o]=s,i=!0}return i}updateVector2(e){let i=!1;const n=this.values,s=e.getValue(),o=e.offset;if(n[o+0]!==s.x||n[o+1]!==s.y){const l=this.buffer;l[o+0]=n[o+0]=s.x,l[o+1]=n[o+1]=s.y,i=!0}return i}updateVector3(e){let i=!1;const n=this.values,s=e.getValue(),o=e.offset;if(n[o+0]!==s.x||n[o+1]!==s.y||n[o+2]!==s.z){const l=this.buffer;l[o+0]=n[o+0]=s.x,l[o+1]=n[o+1]=s.y,l[o+2]=n[o+2]=s.z,i=!0}return i}updateVector4(e){let i=!1;const n=this.values,s=e.getValue(),o=e.offset;if(n[o+0]!==s.x||n[o+1]!==s.y||n[o+2]!==s.z||n[o+4]!==s.w){const l=this.buffer;l[o+0]=n[o+0]=s.x,l[o+1]=n[o+1]=s.y,l[o+2]=n[o+2]=s.z,l[o+3]=n[o+3]=s.w,i=!0}return i}updateColor(e){let i=!1;const n=this.values,s=e.getValue(),o=e.offset;if(n[o+0]!==s.r||n[o+1]!==s.g||n[o+2]!==s.b){const l=this.buffer;l[o+0]=n[o+0]=s.r,l[o+1]=n[o+1]=s.g,l[o+2]=n[o+2]=s.b,i=!0}return i}updateMatrix3(e){let i=!1;const n=this.values,s=e.getValue().elements,o=e.offset;if(n[o+0]!==s[0]||n[o+1]!==s[1]||n[o+2]!==s[2]||n[o+4]!==s[3]||n[o+5]!==s[4]||n[o+6]!==s[5]||n[o+8]!==s[6]||n[o+9]!==s[7]||n[o+10]!==s[8]){const l=this.buffer;l[o+0]=n[o+0]=s[0],l[o+1]=n[o+1]=s[1],l[o+2]=n[o+2]=s[2],l[o+4]=n[o+4]=s[3],l[o+5]=n[o+5]=s[4],l[o+6]=n[o+6]=s[5],l[o+8]=n[o+8]=s[6],l[o+9]=n[o+9]=s[7],l[o+10]=n[o+10]=s[8],i=!0}return i}updateMatrix4(e){let i=!1;const n=this.values,s=e.getValue().elements,o=e.offset;return eAe(n,s,o)===!1&&(this.buffer.set(s,o),$0e(n,s,o),i=!0),i}}function $0e(r,e,i){for(let n=0,s=e.length;n<s;n++)r[i+n]=e[n]}function eAe(r,e,i){for(let n=0,s=e.length;n<s;n++)if(r[i+n]!==e[n])return!1;return!0}let tAe=0;class Pz extends Z0e{constructor(e,i){super(e),this.id=tAe++,this.groupNode=i,this.isNodeUniformsGroup=!0}getNodes(){const e=[];for(const i of this.uniforms){const n=i.nodeUniform.node;if(!n)throw new Error("NodeUniformsGroup: Uniform has no node.");e.push(n)}return e}}let iAe=0;class rAe extends HR{constructor(e,i){super(e),this.id=iAe++,this.texture=i,this.version=i?i.version:0,this.store=!1,this.generation=null,this.isSampledTexture=!0}needsBindingsUpdate(e){const{texture:i}=this;return e!==this.generation?(this.generation=e,!0):i.isVideoTexture}update(){const{texture:e,version:i}=this;return i!==e.version?(this.version=e.version,!0):!1}}class D_ extends rAe{constructor(e,i,n,s=null){super(e,i?i.value:null),this.textureNode=i,this.groupNode=n,this.access=s}needsBindingsUpdate(e){return this.textureNode.value!==this.texture||super.needsBindingsUpdate(e)}update(){const{textureNode:e}=this;return this.texture!==e.value?(this.texture=e.value,!0):super.update()}}class kz extends D_{constructor(e,i,n,s){super(e,i,n,s),this.isSampledCubeTexture=!0}}class Fz extends D_{constructor(e,i,n,s){super(e,i,n,s),this.isSampledTexture3D=!0}}const nAe={atan2:"atan",textureDimensions:"textureSize",equals:"equal"},sAe={low:"lowp",medium:"mediump",high:"highp"},Uz={swizzleAssign:!0,storageBuffer:!1},zz=`
precision highp float;
precision highp int;
precision highp sampler2D;
precision highp sampler3D;
precision highp samplerCube;
precision highp sampler2DArray;

precision highp usampler2D;
precision highp usampler3D;
precision highp usamplerCube;
precision highp usampler2DArray;

precision highp isampler2D;
precision highp isampler3D;
precision highp isamplerCube;
precision highp isampler2DArray;

precision lowp sampler2DShadow;
`;class aAe extends Cz{constructor(e,i){super(e,i,new G0e),this.uniformGroups={},this.transforms=[],this.extensions={},this.useComparisonMethod=!0}needsColorSpaceToLinearSRGB(e){return e.isVideoTexture===!0&&e.colorSpace!==Bp}getMethod(e){return nAe[e]||e}getOutputStructName(){return""}buildFunctionCode(e){const i=e.layout,n=this.flowShaderNode(e),s=[];for(const o of i.inputs)s.push(this.getType(o.type)+" "+o.name);return`${this.getType(i.type)} ${i.name}( ${s.join(", ")} ) {

	${n.vars}

${n.code}
	return ${n.result};

}`}setupPBO(e){const i=e.value;if(i.pbo===void 0){const n=i.array,s=i.count*i.itemSize,{itemSize:o}=i,l=i.array.constructor.name.toLowerCase().includes("int");let u=l?CM:wM;o===2?u=l?SM:ey:o===3?u=l?bce:EM:o===4&&(u=l?TM:rg);const c={Float32Array:fl,Uint8Array:od,Uint16Array:ig,Uint32Array:ja,Int8Array:JA,Int16Array:ZA,Int32Array:wo,Uint8ClampedArray:od},h=Math.pow(2,Math.ceil(Math.log2(Math.sqrt(s/o))));let p=Math.ceil(s/o/h);h*p*o<s&&p++;const f=h*p*o,m=new n.constructor(f);m.set(n,0),i.array=m;const g=new Tue(i.array,h,p,u,c[i.array.constructor.name]||fl);g.needsUpdate=!0,g.isPBOTexture=!0;const y=new _y(g,null,null);y.setPrecision("high"),i.pboNode=y,i.pbo=y.value,this.getUniformFromNode(i.pboNode,"texture",this.shaderStage,this.context.label)}}getPropertyName(e,i=this.shaderStage){return e.isNodeUniform&&e.node.isTextureNode!==!0&&e.node.isBufferNode!==!0?i.charAt(0)+"_"+e.name:super.getPropertyName(e,i)}generatePBO(e){const{node:i,indexNode:n}=e,s=i.value;if(this.renderer.backend.has(s)){const p=this.renderer.backend.get(s);p.pbo=s.pbo}const o=this.getUniformFromNode(s.pboNode,"texture",this.shaderStage,this.context.label),l=this.getPropertyName(o);this.increaseUsage(n);const u=n.build(this,"uint"),c=this.getDataFromNode(e);let h=c.propertyName;if(h===void 0){const p=this.getVarFromNode(e);h=this.getPropertyName(p);const f=this.getDataFromNode(i);let m=f.propertySizeName;m===void 0&&(m=h+"Size",this.getVarFromNode(i,m,"uint"),this.addLineFlowCode(`${m} = uint( textureSize( ${l}, 0 ).x )`,e),f.propertySizeName=m);const{itemSize:g}=s,y="."+_g.join("").slice(0,g),x=`ivec2(${u} % ${m}, ${u} / ${m})`,v=this.generateTextureLoad(null,l,x,null,"0");let _="vec4";s.pbo.type===ja?_="uvec4":s.pbo.type===wo&&(_="ivec4"),this.addLineFlowCode(`${h} = ${_}(${v})${y}`,e),c.propertyName=h}return h}generateTextureLoad(e,i,n,s,o="0"){return s?`texelFetch( ${i}, ivec3( ${n}, ${s} ), ${o} )`:`texelFetch( ${i}, ${n}, ${o} )`}generateTexture(e,i,n,s){return e.isDepthTexture?`texture( ${i}, ${n} ).x`:(s&&(n=`vec3( ${n}, ${s} )`),`texture( ${i}, ${n} )`)}generateTextureLevel(e,i,n,s){return`textureLod( ${i}, ${n}, ${s} )`}generateTextureBias(e,i,n,s){return`texture( ${i}, ${n}, ${s} )`}generateTextureGrad(e,i,n,s){return`textureGrad( ${i}, ${n}, ${s[0]}, ${s[1]} )`}generateTextureCompare(e,i,n,s,o,l=this.shaderStage){if(l==="fragment")return`texture( ${i}, vec3( ${n}, ${s} ) )`;console.error(`WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ${l} shader.`)}getVars(e){const i=[],n=this.vars[e];if(n!==void 0)for(const s of n)i.push(`${this.getVar(s.type,s.name)};`);return i.join(`
	`)}getUniforms(e){const i=this.uniforms[e],n=[],s={};for(const l of i){let u=null,c=!1;if(l.type==="texture"){const p=l.node.value;let f="";p.isDataTexture===!0&&(p.type===ja?f="u":p.type===wo&&(f="i")),p.compareFunction?u=`sampler2DShadow ${l.name};`:p.isDataArrayTexture===!0||p.isCompressedArrayTexture===!0?u=`${f}sampler2DArray ${l.name};`:u=`${f}sampler2D ${l.name};`}else if(l.type==="cubeTexture")u=`samplerCube ${l.name};`;else if(l.type==="texture3D")u=`sampler3D ${l.name};`;else if(l.type==="buffer"){const p=l.node,f=this.getType(p.bufferType),m=p.bufferCount,g=m>0?m:"";u=`${p.name} {
	${f} ${l.name}[${g}];
};
`}else u=`${this.getVectorType(l.type)} ${this.getPropertyName(l,e)};`,c=!0;const h=l.node.precision;if(h!==null&&(u=sAe[h]+" "+u),c){u="	"+u;const p=l.groupNode.name;(s[p]||(s[p]=[])).push(u)}else u="uniform "+u,n.push(u)}let o="";for(const l in s){const u=s[l];o+=this._getGLSLUniformStruct(e+"_"+l,u.join(`
`))+`
`}return o+=n.join(`
`),o}getTypeFromAttribute(e){let i=super.getTypeFromAttribute(e);if(/^[iu]/.test(i)&&e.gpuType!==wo){let n=e;e.isInterleavedBufferAttribute&&(n=e.data);const s=n.array;s instanceof Uint32Array||s instanceof Int32Array||(i=i.slice(1))}return i}getAttributes(e){let i="";if(e==="vertex"||e==="compute"){const n=this.getAttributesArray();let s=0;for(const o of n)i+=`layout( location = ${s++} ) in ${o.type} ${o.name};
`}return i}getStructMembers(e){const i=[],n=e.getMemberTypes();for(let s=0;s<n.length;s++){const o=n[s];i.push(`layout( location = ${s} ) out ${o} m${s};`)}return i.join(`
`)}getStructs(e){const i=[],n=this.structs[e];if(n.length===0)return`layout( location = 0 ) out vec4 fragColor;
`;for(let s=0,o=n.length;s<o;s++){const l=n[s];let u=`
`;u+=this.getStructMembers(l),u+=`
`,i.push(u)}return i.join(`

`)}getVaryings(e){let i="";const n=this.varyings;if(e==="vertex"||e==="compute")for(const s of n){e==="compute"&&(s.needsInterpolation=!0);const o=s.type,l=o.includes("int")||o.includes("uv")||o.includes("iv")?"flat ":"";i+=`${l}${s.needsInterpolation?"out":"/*out*/"} ${o} ${s.name};
`}else if(e==="fragment"){for(const s of n)if(s.needsInterpolation){const o=s.type,l=o.includes("int")||o.includes("uv")||o.includes("iv")?"flat ":"";i+=`${l}in ${o} ${s.name};
`}}return i}getVertexIndex(){return"uint( gl_VertexID )"}getInstanceIndex(){return"uint( gl_InstanceID )"}getInvocationLocalIndex(){return`uint( gl_InstanceID ) % ${this.object.workgroupSize.reduce((e,i)=>e*i,1)}u`}getDrawIndex(){return this.renderer.backend.extensions.has("WEBGL_multi_draw")?"uint( gl_DrawID )":null}getFrontFacing(){return"gl_FrontFacing"}getFragCoord(){return"gl_FragCoord.xy"}getFragDepth(){return"gl_FragDepth"}enableExtension(e,i,n=this.shaderStage){const s=this.extensions[n]||(this.extensions[n]=new Map);s.has(e)===!1&&s.set(e,{name:e,behavior:i})}getExtensions(e){const i=[];if(e==="vertex"){const s=this.renderer.backend.extensions;this.object.isBatchedMesh&&s.has("WEBGL_multi_draw")&&this.enableExtension("GL_ANGLE_multi_draw","require",e)}const n=this.extensions[e];if(n!==void 0)for(const{name:s,behavior:o}of n.values())i.push(`#extension ${s} : ${o}`);return i.join(`
`)}isAvailable(e){let i=Uz[e];if(i===void 0){if(e==="float32Filterable"){const n=this.renderer.backend.extensions;n.has("OES_texture_float_linear")?(n.get("OES_texture_float_linear"),i=!0):i=!1}Uz[e]=i}return i}isFlipY(){return!0}registerTransform(e,i){this.transforms.push({varyingName:e,attributeNode:i})}getTransforms(){const e=this.transforms;let i="";for(let n=0;n<e.length;n++){const s=e[n],o=this.getPropertyName(s.attributeNode);i+=`${s.varyingName} = ${o};
	`}return i}_getGLSLUniformStruct(e,i){return`
layout( std140 ) uniform ${e} {
${i}
};`}_getGLSLVertexCode(e){return`#version 300 es

${this.getSignature()}

// extensions 
${e.extensions}

// precision
${zz}

// uniforms
${e.uniforms}

// varyings
${e.varyings}

// attributes
${e.attributes}

// codes
${e.codes}

void main() {

	// vars
	${e.vars}

	// transforms
	${e.transforms}

	// flow
	${e.flow}

	gl_PointSize = 1.0;

}
`}_getGLSLFragmentCode(e){return`#version 300 es

${this.getSignature()}

// precision
${zz}

// uniforms
${e.uniforms}

// varyings
${e.varyings}

// codes
${e.codes}

${e.structs}

void main() {

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}buildCode(){const e=this.material!==null?{fragment:{},vertex:{}}:{compute:{}};this.sortBindingGroups();for(const i in e){let n=`// code

`;n+=this.flowCode[i];const s=this.flowNodes[i],o=s[s.length-1];for(const u of s){const c=this.getFlowData(u),h=u.name;h&&(n.length>0&&(n+=`
`),n+=`	// flow -> ${h}
	`),n+=`${c.code}
	`,u===o&&i!=="compute"&&(n+=`// result
	`,i==="vertex"?(n+="gl_Position = ",n+=`${c.result};`):i==="fragment"&&(u.outputNode.isOutputStructNode||(n+="fragColor = ",n+=`${c.result};`)))}const l=e[i];l.extensions=this.getExtensions(i),l.uniforms=this.getUniforms(i),l.attributes=this.getAttributes(i),l.varyings=this.getVaryings(i),l.vars=this.getVars(i),l.structs=this.getStructs(i),l.codes=this.getCodes(i),l.transforms=this.getTransforms(i),l.flow=n}this.material!==null?(this.vertexShader=this._getGLSLVertexCode(e.vertex),this.fragmentShader=this._getGLSLFragmentCode(e.fragment)):this.computeShader=this._getGLSLVertexCode(e.compute)}getUniformFromNode(e,i,n,s=null){const o=super.getUniformFromNode(e,i,n,s),l=this.getDataFromNode(e,n,this.globalCache);let u=l.uniformGPU;if(u===void 0){const c=e.groupNode,h=c.name,p=this.getBindGroupArray(h,n);if(i==="texture")u=new D_(o.name,o.node,c),p.push(u);else if(i==="cubeTexture")u=new kz(o.name,o.node,c),p.push(u);else if(i==="texture3D")u=new Fz(o.name,o.node,c),p.push(u);else if(i==="buffer"){e.name=`NodeBuffer_${e.id}`,o.name=`buffer${e.id}`;const f=new Oz(e,c);f.name=e.name,p.push(f),u=f}else{const f=this.uniformGroups[n]||(this.uniformGroups[n]={});let m=f[h];m===void 0&&(m=new Pz(n+"_"+h,c),f[h]=m,p.push(m)),u=this.getNodeUniform(o,i),m.addUniform(u)}l.uniformGPU=u}return o}}let WR=null,QR=null,Ug=null;class jz{constructor(e={}){this.parameters=Object.assign({},e),this.data=new WeakMap,this.renderer=null,this.domElement=null}async init(e){this.renderer=e}begin(){}finish(){}draw(){}createProgram(){}destroyProgram(){}createBindings(){}updateBindings(){}createRenderPipeline(){}createComputePipeline(){}destroyPipeline(){}needsRenderUpdate(){}getRenderCacheKey(){}createNodeBuilder(){}createSampler(){}createDefaultTexture(){}createTexture(){}copyTextureToBuffer(){}createAttribute(){}createIndexAttribute(){}updateAttribute(){}destroyAttribute(){}getContext(){}updateSize(){}resolveTimestampAsync(){}hasFeatureAsync(){}hasFeature(){}getInstanceCount(e){const{object:i,geometry:n}=e;return n.isInstancedBufferGeometry?n.instanceCount:i.count>1?i.count:1}getDrawingBufferSize(){return WR=WR||new Pn,this.renderer.getDrawingBufferSize(WR)}getScissor(){return QR=QR||new es,this.renderer.getScissor(QR)}setScissorTest(){}getClearColor(){const e=this.renderer;return Ug=Ug||new yR,e.getClearColor(Ug),Ug.getRGB(Ug,this.renderer.currentColorSpace),Ug}getDomElement(){let e=this.domElement;return e===null&&(e=this.parameters.canvas!==void 0?this.parameters.canvas:iue(),"setAttribute"in e&&e.setAttribute("data-engine",`three.js r${g1} webgpu`),this.domElement=e),e}set(e,i){this.data.set(e,i)}get(e){let i=this.data.get(e);return i===void 0&&(i={},this.data.set(e,i)),i}has(e){return this.data.has(e)}delete(e){this.data.delete(e)}dispose(){}}let oAe=0;class lAe{constructor(e,i){this.buffers=[e.bufferGPU,i],this.type=e.type,this.bufferType=e.bufferType,this.pbo=e.pbo,this.byteLength=e.byteLength,this.bytesPerElement=e.BYTES_PER_ELEMENT,this.version=e.version,this.isInteger=e.isInteger,this.activeBufferIndex=0,this.baseId=e.id}get id(){return`${this.baseId}|${this.activeBufferIndex}`}get bufferGPU(){return this.buffers[this.activeBufferIndex]}get transformBuffer(){return this.buffers[this.activeBufferIndex^1]}switchBuffers(){this.activeBufferIndex^=1}}class cAe{constructor(e){this.backend=e}createAttribute(e,i){const n=this.backend,{gl:s}=n,o=e.array,l=e.usage||s.STATIC_DRAW,u=e.isInterleavedBufferAttribute?e.data:e,c=n.get(u);let h=c.bufferGPU;h===void 0&&(h=this._createBuffer(s,i,o,l),c.bufferGPU=h,c.bufferType=i,c.version=u.version);let p;if(o instanceof Float32Array)p=s.FLOAT;else if(o instanceof Uint16Array)e.isFloat16BufferAttribute?p=s.HALF_FLOAT:p=s.UNSIGNED_SHORT;else if(o instanceof Int16Array)p=s.SHORT;else if(o instanceof Uint32Array)p=s.UNSIGNED_INT;else if(o instanceof Int32Array)p=s.INT;else if(o instanceof Int8Array)p=s.BYTE;else if(o instanceof Uint8Array)p=s.UNSIGNED_BYTE;else if(o instanceof Uint8ClampedArray)p=s.UNSIGNED_BYTE;else throw new Error("THREE.WebGLBackend: Unsupported buffer data format: "+o);let f={bufferGPU:h,bufferType:i,type:p,byteLength:o.byteLength,bytesPerElement:o.BYTES_PER_ELEMENT,version:e.version,pbo:e.pbo,isInteger:p===s.INT||p===s.UNSIGNED_INT||e.gpuType===wo,id:oAe++};if(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute){const m=this._createBuffer(s,i,o,l);f=new lAe(f,m)}n.set(e,f)}updateAttribute(e){const i=this.backend,{gl:n}=i,s=e.array,o=e.isInterleavedBufferAttribute?e.data:e,l=i.get(o),u=l.bufferType,c=e.isInterleavedBufferAttribute?e.data.updateRanges:e.updateRanges;if(n.bindBuffer(u,l.bufferGPU),c.length===0)n.bufferSubData(u,0,s);else{for(let h=0,p=c.length;h<p;h++){const f=c[h];n.bufferSubData(u,f.start*s.BYTES_PER_ELEMENT,s,f.start,f.count)}o.clearUpdateRanges()}n.bindBuffer(u,null),l.version=o.version}destroyAttribute(e){const i=this.backend,{gl:n}=i;e.isInterleavedBufferAttribute&&i.delete(e.data);const s=i.get(e);n.deleteBuffer(s.bufferGPU),i.delete(e)}async getArrayBufferAsync(e){const i=this.backend,{gl:n}=i,s=e.isInterleavedBufferAttribute?e.data:e,{bufferGPU:o}=i.get(s),l=e.array,u=l.byteLength;n.bindBuffer(n.COPY_READ_BUFFER,o);const c=n.createBuffer();n.bindBuffer(n.COPY_WRITE_BUFFER,c),n.bufferData(n.COPY_WRITE_BUFFER,u,n.STREAM_READ),n.copyBufferSubData(n.COPY_READ_BUFFER,n.COPY_WRITE_BUFFER,0,0,u),await i.utils._clientWaitAsync();const h=new e.array.constructor(l.length);return n.bindBuffer(n.COPY_WRITE_BUFFER,c),n.getBufferSubData(n.COPY_WRITE_BUFFER,0,h),n.deleteBuffer(c),n.bindBuffer(n.COPY_READ_BUFFER,null),n.bindBuffer(n.COPY_WRITE_BUFFER,null),h.buffer}_createBuffer(e,i,n,s){const o=e.createBuffer();return e.bindBuffer(i,o),e.bufferData(i,n,s),e.bindBuffer(i,null),o}}let Vz=!1,qR,Fy;class uAe{constructor(e){this.backend=e,this.gl=this.backend.gl,this.enabled={},this.currentFlipSided=null,this.currentCullFace=null,this.currentProgram=null,this.currentBlendingEnabled=!1,this.currentBlending=null,this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentPremultipledAlpha=null,this.currentPolygonOffsetFactor=null,this.currentPolygonOffsetUnits=null,this.currentColorMask=null,this.currentDepthFunc=null,this.currentDepthMask=null,this.currentStencilFunc=null,this.currentStencilRef=null,this.currentStencilFuncMask=null,this.currentStencilFail=null,this.currentStencilZFail=null,this.currentStencilZPass=null,this.currentStencilMask=null,this.currentLineWidth=null,this.currentBoundFramebuffers={},this.currentDrawbuffers=new WeakMap,this.maxTextures=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),this.currentTextureSlot=null,this.currentBoundTextures={},this.currentBoundBufferBases={},Vz===!1&&(this._init(this.gl),Vz=!0)}_init(e){qR={[ad]:e.FUNC_ADD,[IU]:e.FUNC_SUBTRACT,[BU]:e.FUNC_REVERSE_SUBTRACT},Fy={[NU]:e.ZERO,[LU]:e.ONE,[DU]:e.SRC_COLOR,[b1]:e.SRC_ALPHA,[zU]:e.SRC_ALPHA_SATURATE,[FU]:e.DST_COLOR,[PU]:e.DST_ALPHA,[OU]:e.ONE_MINUS_SRC_COLOR,[_1]:e.ONE_MINUS_SRC_ALPHA,[UU]:e.ONE_MINUS_DST_COLOR,[kU]:e.ONE_MINUS_DST_ALPHA}}enable(e){const{enabled:i}=this;i[e]!==!0&&(this.gl.enable(e),i[e]=!0)}disable(e){const{enabled:i}=this;i[e]!==!1&&(this.gl.disable(e),i[e]=!1)}setFlipSided(e){if(this.currentFlipSided!==e){const{gl:i}=this;e?i.frontFace(i.CW):i.frontFace(i.CCW),this.currentFlipSided=e}}setCullFace(e){const{gl:i}=this;e!==ice?(this.enable(i.CULL_FACE),e!==this.currentCullFace&&(e===rce?i.cullFace(i.BACK):e===nce?i.cullFace(i.FRONT):i.cullFace(i.FRONT_AND_BACK))):this.disable(i.CULL_FACE),this.currentCullFace=e}setLineWidth(e){const{currentLineWidth:i,gl:n}=this;e!==i&&(n.lineWidth(e),this.currentLineWidth=e)}setBlending(e,i,n,s,o,l,u,c){const{gl:h}=this;if(e===Jm){this.currentBlendingEnabled===!0&&(this.disable(h.BLEND),this.currentBlendingEnabled=!1);return}if(this.currentBlendingEnabled===!1&&(this.enable(h.BLEND),this.currentBlendingEnabled=!0),e!==RU){if(e!==this.currentBlending||c!==this.currentPremultipledAlpha){if((this.currentBlendEquation!==ad||this.currentBlendEquationAlpha!==ad)&&(h.blendEquation(h.FUNC_ADD),this.currentBlendEquation=ad,this.currentBlendEquationAlpha=ad),c)switch(e){case sd:h.blendFuncSeparate(h.ONE,h.ONE_MINUS_SRC_ALPHA,h.ONE,h.ONE_MINUS_SRC_ALPHA);break;case y1:h.blendFunc(h.ONE,h.ONE);break;case v1:h.blendFuncSeparate(h.ZERO,h.ONE_MINUS_SRC_COLOR,h.ZERO,h.ONE);break;case x1:h.blendFuncSeparate(h.ZERO,h.SRC_COLOR,h.ZERO,h.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",e);break}else switch(e){case sd:h.blendFuncSeparate(h.SRC_ALPHA,h.ONE_MINUS_SRC_ALPHA,h.ONE,h.ONE_MINUS_SRC_ALPHA);break;case y1:h.blendFunc(h.SRC_ALPHA,h.ONE);break;case v1:h.blendFuncSeparate(h.ZERO,h.ONE_MINUS_SRC_COLOR,h.ZERO,h.ONE);break;case x1:h.blendFunc(h.ZERO,h.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",e);break}this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentBlending=e,this.currentPremultipledAlpha=c}return}o=o||i,l=l||n,u=u||s,(i!==this.currentBlendEquation||o!==this.currentBlendEquationAlpha)&&(h.blendEquationSeparate(qR[i],qR[o]),this.currentBlendEquation=i,this.currentBlendEquationAlpha=o),(n!==this.currentBlendSrc||s!==this.currentBlendDst||l!==this.currentBlendSrcAlpha||u!==this.currentBlendDstAlpha)&&(h.blendFuncSeparate(Fy[n],Fy[s],Fy[l],Fy[u]),this.currentBlendSrc=n,this.currentBlendDst=s,this.currentBlendSrcAlpha=l,this.currentBlendDstAlpha=u),this.currentBlending=e,this.currentPremultipledAlpha=!1}setColorMask(e){this.currentColorMask!==e&&(this.gl.colorMask(e,e,e,e),this.currentColorMask=e)}setDepthTest(e){const{gl:i}=this;e?this.enable(i.DEPTH_TEST):this.disable(i.DEPTH_TEST)}setDepthMask(e){this.currentDepthMask!==e&&(this.gl.depthMask(e),this.currentDepthMask=e)}setDepthFunc(e){if(this.currentDepthFunc!==e){const{gl:i}=this;switch(e){case jU:i.depthFunc(i.NEVER);break;case VU:i.depthFunc(i.ALWAYS);break;case GU:i.depthFunc(i.LESS);break;case E1:i.depthFunc(i.LEQUAL);break;case HU:i.depthFunc(i.EQUAL);break;case WU:i.depthFunc(i.GEQUAL);break;case QU:i.depthFunc(i.GREATER);break;case qU:i.depthFunc(i.NOTEQUAL);break;default:i.depthFunc(i.LEQUAL)}this.currentDepthFunc=e}}setStencilTest(e){const{gl:i}=this;e?this.enable(i.STENCIL_TEST):this.disable(i.STENCIL_TEST)}setStencilMask(e){this.currentStencilMask!==e&&(this.gl.stencilMask(e),this.currentStencilMask=e)}setStencilFunc(e,i,n){(this.currentStencilFunc!==e||this.currentStencilRef!==i||this.currentStencilFuncMask!==n)&&(this.gl.stencilFunc(e,i,n),this.currentStencilFunc=e,this.currentStencilRef=i,this.currentStencilFuncMask=n)}setStencilOp(e,i,n){(this.currentStencilFail!==e||this.currentStencilZFail!==i||this.currentStencilZPass!==n)&&(this.gl.stencilOp(e,i,n),this.currentStencilFail=e,this.currentStencilZFail=i,this.currentStencilZPass=n)}setMaterial(e,i){const{gl:n}=this;e.side===Km?this.disable(n.CULL_FACE):this.enable(n.CULL_FACE);let s=e.side===pc;i&&(s=!s),this.setFlipSided(s),e.blending===sd&&e.transparent===!1?this.setBlending(Jm):this.setBlending(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),this.setDepthFunc(e.depthFunc),this.setDepthTest(e.depthTest),this.setDepthMask(e.depthWrite),this.setColorMask(e.colorWrite);const o=e.stencilWrite;this.setStencilTest(o),o&&(this.setStencilMask(e.stencilWriteMask),this.setStencilFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),this.setStencilOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),this.setPolygonOffset(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),e.alphaToCoverage===!0&&this.backend.renderer.samples>1?this.enable(n.SAMPLE_ALPHA_TO_COVERAGE):this.disable(n.SAMPLE_ALPHA_TO_COVERAGE)}setPolygonOffset(e,i,n){const{gl:s}=this;e?(this.enable(s.POLYGON_OFFSET_FILL),(this.currentPolygonOffsetFactor!==i||this.currentPolygonOffsetUnits!==n)&&(s.polygonOffset(i,n),this.currentPolygonOffsetFactor=i,this.currentPolygonOffsetUnits=n)):this.disable(s.POLYGON_OFFSET_FILL)}useProgram(e){return this.currentProgram!==e?(this.gl.useProgram(e),this.currentProgram=e,!0):!1}bindFramebuffer(e,i){const{gl:n,currentBoundFramebuffers:s}=this;return s[e]!==i?(n.bindFramebuffer(e,i),s[e]=i,e===n.DRAW_FRAMEBUFFER&&(s[n.FRAMEBUFFER]=i),e===n.FRAMEBUFFER&&(s[n.DRAW_FRAMEBUFFER]=i),!0):!1}drawBuffers(e,i){const{gl:n}=this;let s=[],o=!1;if(e.textures!==null){s=this.currentDrawbuffers.get(i),s===void 0&&(s=[],this.currentDrawbuffers.set(i,s));const l=e.textures;if(s.length!==l.length||s[0]!==n.COLOR_ATTACHMENT0){for(let u=0,c=l.length;u<c;u++)s[u]=n.COLOR_ATTACHMENT0+u;s.length=l.length,o=!0}}else s[0]!==n.BACK&&(s[0]=n.BACK,o=!0);o&&n.drawBuffers(s)}activeTexture(e){const{gl:i,currentTextureSlot:n,maxTextures:s}=this;e===void 0&&(e=i.TEXTURE0+s-1),n!==e&&(i.activeTexture(e),this.currentTextureSlot=e)}bindTexture(e,i,n){const{gl:s,currentTextureSlot:o,currentBoundTextures:l,maxTextures:u}=this;n===void 0&&(o===null?n=s.TEXTURE0+u-1:n=o);let c=l[n];c===void 0&&(c={type:void 0,texture:void 0},l[n]=c),(c.type!==e||c.texture!==i)&&(o!==n&&(s.activeTexture(n),this.currentTextureSlot=n),s.bindTexture(e,i),c.type=e,c.texture=i)}bindBufferBase(e,i,n){const{gl:s}=this,o=`${e}-${i}`;return this.currentBoundBufferBases[o]!==n?(s.bindBufferBase(e,i,n),this.currentBoundBufferBases[o]=n,!0):!1}unbindTexture(){const{gl:e,currentTextureSlot:i,currentBoundTextures:n}=this,s=n[i];s!==void 0&&s.type!==void 0&&(e.bindTexture(s.type,null),s.type=void 0,s.texture=void 0)}}class hAe{constructor(e){this.backend=e,this.gl=this.backend.gl,this.extensions=e.extensions}convert(e,i=Bp){const{gl:n,extensions:s}=this;let o;if(e===od)return n.UNSIGNED_BYTE;if(e===gce)return n.UNSIGNED_SHORT_4_4_4_4;if(e===Ace)return n.UNSIGNED_SHORT_5_5_5_1;if(e===XU)return n.UNSIGNED_INT_5_9_9_9_REV;if(e===JA)return n.BYTE;if(e===ZA)return n.SHORT;if(e===ig)return n.UNSIGNED_SHORT;if(e===wo)return n.INT;if(e===ja)return n.UNSIGNED_INT;if(e===fl)return n.FLOAT;if(e===zu)return n.HALF_FLOAT;if(e===yce)return n.ALPHA;if(e===EM)return n.RGB;if(e===rg)return n.RGBA;if(e===vce)return n.LUMINANCE;if(e===xce)return n.LUMINANCE_ALPHA;if(e===Ip)return n.DEPTH_COMPONENT;if(e===ng)return n.DEPTH_STENCIL;if(e===wM)return n.RED;if(e===CM)return n.RED_INTEGER;if(e===ey)return n.RG;if(e===SM)return n.RG_INTEGER;if(e===TM)return n.RGBA_INTEGER;if(e===MM||e===T1||e===M1||e===R1)if(i===Dr)if(o=s.get("WEBGL_compressed_texture_s3tc_srgb"),o!==null){if(e===MM)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(e===T1)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(e===M1)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(e===R1)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(o=s.get("WEBGL_compressed_texture_s3tc"),o!==null){if(e===MM)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===T1)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===M1)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===R1)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(e===YU||e===KU||e===JU||e===ZU)if(o=s.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(e===YU)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===KU)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===JU)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===ZU)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(e===$U||e===RM||e===IM)if(o=s.get("WEBGL_compressed_texture_etc"),o!==null){if(e===$U||e===RM)return i===Dr?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(e===IM)return i===Dr?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(e===BM||e===NM||e===LM||e===DM||e===OM||e===PM||e===kM||e===FM||e===UM||e===zM||e===jM||e===VM||e===GM||e===HM)if(o=s.get("WEBGL_compressed_texture_astc"),o!==null){if(e===BM)return i===Dr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(e===NM)return i===Dr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(e===LM)return i===Dr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(e===DM)return i===Dr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(e===OM)return i===Dr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(e===PM)return i===Dr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(e===kM)return i===Dr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(e===FM)return i===Dr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(e===UM)return i===Dr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(e===zM)return i===Dr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(e===jM)return i===Dr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(e===VM)return i===Dr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(e===GM)return i===Dr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(e===HM)return i===Dr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(e===WM)if(o=s.get("EXT_texture_compression_bptc"),o!==null){if(e===WM)return i===Dr?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(e===_ce||e===e5||e===t5||e===i5)if(o=s.get("EXT_texture_compression_rgtc"),o!==null){if(e===WM)return o.COMPRESSED_RED_RGTC1_EXT;if(e===e5)return o.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(e===t5)return o.COMPRESSED_RED_GREEN_RGTC2_EXT;if(e===i5)return o.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return e===$A?n.UNSIGNED_INT_24_8:n[e]!==void 0?n[e]:null}_clientWaitAsync(){const{gl:e}=this,i=e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0);return e.flush(),new Promise((n,s)=>{function o(){const l=e.clientWaitSync(i,e.SYNC_FLUSH_COMMANDS_BIT,0);if(l===e.WAIT_FAILED){e.deleteSync(i),s();return}if(l===e.TIMEOUT_EXPIRED){requestAnimationFrame(o);return}e.deleteSync(i),n()}o()})}}let Gz=!1,O_,XR,Hz;class dAe{constructor(e){this.backend=e,this.gl=e.gl,this.extensions=e.extensions,this.defaultTextures={},Gz===!1&&(this._init(this.gl),Gz=!0)}_init(e){O_={[C1]:e.REPEAT,[eg]:e.CLAMP_TO_EDGE,[S1]:e.MIRRORED_REPEAT},XR={[no]:e.NEAREST,[bM]:e.NEAREST_MIPMAP_NEAREST,[tg]:e.NEAREST_MIPMAP_LINEAR,[pl]:e.LINEAR,[_M]:e.LINEAR_MIPMAP_NEAREST,[Uu]:e.LINEAR_MIPMAP_LINEAR},Hz={[n5]:e.NEVER,[u5]:e.ALWAYS,[qM]:e.LESS,[a5]:e.LEQUAL,[s5]:e.EQUAL,[c5]:e.GEQUAL,[o5]:e.GREATER,[l5]:e.NOTEQUAL}}filterFallback(e){const{gl:i}=this;return e===no||e===bM||e===tg?i.NEAREST:i.LINEAR}getGLTextureType(e){const{gl:i}=this;let n;return e.isCubeTexture===!0?n=i.TEXTURE_CUBE_MAP:e.isDataArrayTexture===!0||e.isCompressedArrayTexture===!0?n=i.TEXTURE_2D_ARRAY:e.isData3DTexture===!0?n=i.TEXTURE_3D:n=i.TEXTURE_2D,n}getInternalFormat(e,i,n,s,o=!1){const{gl:l,extensions:u}=this;if(e!==null){if(l[e]!==void 0)return l[e];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+e+"'")}let c=i;return i===l.RED&&(n===l.FLOAT&&(c=l.R32F),n===l.HALF_FLOAT&&(c=l.R16F),n===l.UNSIGNED_BYTE&&(c=l.R8),n===l.UNSIGNED_SHORT&&(c=l.R16),n===l.UNSIGNED_INT&&(c=l.R32UI),n===l.BYTE&&(c=l.R8I),n===l.SHORT&&(c=l.R16I),n===l.INT&&(c=l.R32I)),i===l.RED_INTEGER&&(n===l.UNSIGNED_BYTE&&(c=l.R8UI),n===l.UNSIGNED_SHORT&&(c=l.R16UI),n===l.UNSIGNED_INT&&(c=l.R32UI),n===l.BYTE&&(c=l.R8I),n===l.SHORT&&(c=l.R16I),n===l.INT&&(c=l.R32I)),i===l.RG&&(n===l.FLOAT&&(c=l.RG32F),n===l.HALF_FLOAT&&(c=l.RG16F),n===l.UNSIGNED_BYTE&&(c=l.RG8),n===l.UNSIGNED_SHORT&&(c=l.RG16),n===l.UNSIGNED_INT&&(c=l.RG32UI),n===l.BYTE&&(c=l.RG8I),n===l.SHORT&&(c=l.RG16I),n===l.INT&&(c=l.RG32I)),i===l.RG_INTEGER&&(n===l.UNSIGNED_BYTE&&(c=l.RG8UI),n===l.UNSIGNED_SHORT&&(c=l.RG16UI),n===l.UNSIGNED_INT&&(c=l.RG32UI),n===l.BYTE&&(c=l.RG8I),n===l.SHORT&&(c=l.RG16I),n===l.INT&&(c=l.RG32I)),i===l.RGB&&(n===l.FLOAT&&(c=l.RGB32F),n===l.HALF_FLOAT&&(c=l.RGB16F),n===l.UNSIGNED_BYTE&&(c=l.RGB8),n===l.UNSIGNED_SHORT&&(c=l.RGB16),n===l.UNSIGNED_INT&&(c=l.RGB32UI),n===l.BYTE&&(c=l.RGB8I),n===l.SHORT&&(c=l.RGB16I),n===l.INT&&(c=l.RGB32I),n===l.UNSIGNED_BYTE&&(c=s===Dr&&o===!1?l.SRGB8:l.RGB8),n===l.UNSIGNED_SHORT_5_6_5&&(c=l.RGB565),n===l.UNSIGNED_SHORT_5_5_5_1&&(c=l.RGB5_A1),n===l.UNSIGNED_SHORT_4_4_4_4&&(c=l.RGB4),n===l.UNSIGNED_INT_5_9_9_9_REV&&(c=l.RGB9_E5)),i===l.RGB_INTEGER&&(n===l.UNSIGNED_BYTE&&(c=l.RGB8UI),n===l.UNSIGNED_SHORT&&(c=l.RGB16UI),n===l.UNSIGNED_INT&&(c=l.RGB32UI),n===l.BYTE&&(c=l.RGB8I),n===l.SHORT&&(c=l.RGB16I),n===l.INT&&(c=l.RGB32I)),i===l.RGBA&&(n===l.FLOAT&&(c=l.RGBA32F),n===l.HALF_FLOAT&&(c=l.RGBA16F),n===l.UNSIGNED_BYTE&&(c=l.RGBA8),n===l.UNSIGNED_SHORT&&(c=l.RGBA16),n===l.UNSIGNED_INT&&(c=l.RGBA32UI),n===l.BYTE&&(c=l.RGBA8I),n===l.SHORT&&(c=l.RGBA16I),n===l.INT&&(c=l.RGBA32I),n===l.UNSIGNED_BYTE&&(c=s===Dr&&o===!1?l.SRGB8_ALPHA8:l.RGBA8),n===l.UNSIGNED_SHORT_4_4_4_4&&(c=l.RGBA4),n===l.UNSIGNED_SHORT_5_5_5_1&&(c=l.RGB5_A1)),i===l.RGBA_INTEGER&&(n===l.UNSIGNED_BYTE&&(c=l.RGBA8UI),n===l.UNSIGNED_SHORT&&(c=l.RGBA16UI),n===l.UNSIGNED_INT&&(c=l.RGBA32UI),n===l.BYTE&&(c=l.RGBA8I),n===l.SHORT&&(c=l.RGBA16I),n===l.INT&&(c=l.RGBA32I)),i===l.DEPTH_COMPONENT&&(n===l.UNSIGNED_INT&&(c=l.DEPTH24_STENCIL8),n===l.FLOAT&&(c=l.DEPTH_COMPONENT32F)),i===l.DEPTH_STENCIL&&n===l.UNSIGNED_INT_24_8&&(c=l.DEPTH24_STENCIL8),(c===l.R16F||c===l.R32F||c===l.RG16F||c===l.RG32F||c===l.RGBA16F||c===l.RGBA32F)&&u.get("EXT_color_buffer_float"),c}setTextureParameters(e,i){const{gl:n,extensions:s,backend:o}=this;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,i.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,i.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,n.NONE),n.texParameteri(e,n.TEXTURE_WRAP_S,O_[i.wrapS]),n.texParameteri(e,n.TEXTURE_WRAP_T,O_[i.wrapT]),(e===n.TEXTURE_3D||e===n.TEXTURE_2D_ARRAY)&&n.texParameteri(e,n.TEXTURE_WRAP_R,O_[i.wrapR]),n.texParameteri(e,n.TEXTURE_MAG_FILTER,XR[i.magFilter]);const l=i.mipmaps!==void 0&&i.mipmaps.length>0,u=i.minFilter===pl&&l?Uu:i.minFilter;if(n.texParameteri(e,n.TEXTURE_MIN_FILTER,XR[u]),i.compareFunction&&(n.texParameteri(e,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(e,n.TEXTURE_COMPARE_FUNC,Hz[i.compareFunction])),s.has("EXT_texture_filter_anisotropic")===!0){if(i.magFilter===no||i.minFilter!==tg&&i.minFilter!==Uu||i.type===fl&&s.has("OES_texture_float_linear")===!1)return;if(i.anisotropy>1){const c=s.get("EXT_texture_filter_anisotropic");n.texParameterf(e,c.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(i.anisotropy,o.getMaxAnisotropy()))}}}createDefaultTexture(e){const{gl:i,backend:n,defaultTextures:s}=this,o=this.getGLTextureType(e);let l=s[o];l===void 0&&(l=i.createTexture(),n.state.bindTexture(o,l),i.texParameteri(o,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(o,i.TEXTURE_MAG_FILTER,i.NEAREST),s[o]=l),n.set(e,{textureGPU:l,glTextureType:o,isDefault:!0})}createTexture(e,i){const{gl:n,backend:s}=this,{levels:o,width:l,height:u,depth:c}=i,h=s.utils.convert(e.format,e.colorSpace),p=s.utils.convert(e.type),f=this.getInternalFormat(e.internalFormat,h,p,e.colorSpace,e.isVideoTexture),m=n.createTexture(),g=this.getGLTextureType(e);s.state.bindTexture(g,m),this.setTextureParameters(g,e),e.isDataArrayTexture||e.isCompressedArrayTexture?n.texStorage3D(n.TEXTURE_2D_ARRAY,o,f,l,u,c):e.isData3DTexture?n.texStorage3D(n.TEXTURE_3D,o,f,l,u,c):e.isVideoTexture||n.texStorage2D(g,o,f,l,u),s.set(e,{textureGPU:m,glTextureType:g,glFormat:h,glType:p,glInternalFormat:f})}copyBufferToTexture(e,i){const{gl:n,backend:s}=this,{textureGPU:o,glTextureType:l,glFormat:u,glType:c}=s.get(i),{width:h,height:p}=i.source.data;n.bindBuffer(n.PIXEL_UNPACK_BUFFER,e),s.state.bindTexture(l,o),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),n.texSubImage2D(l,0,0,0,h,p,u,c,0),n.bindBuffer(n.PIXEL_UNPACK_BUFFER,null),s.state.unbindTexture()}updateTexture(e,i){const{gl:n}=this,{width:s,height:o}=i,{textureGPU:l,glTextureType:u,glFormat:c,glType:h,glInternalFormat:p}=this.backend.get(e);if(e.isRenderTargetTexture||l===void 0)return;const f=m=>m.isDataTexture?m.image.data:m instanceof ImageBitmap||m instanceof OffscreenCanvas||m instanceof HTMLImageElement||m instanceof HTMLCanvasElement?m:m.data;if(this.backend.state.bindTexture(u,l),this.setTextureParameters(u,e),e.isCompressedTexture){const m=e.mipmaps,g=i.image;for(let y=0;y<m.length;y++){const x=m[y];e.isCompressedArrayTexture?e.format!==n.RGBA?c!==null?n.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,y,0,0,0,x.width,x.height,g.depth,c,x.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texSubImage3D(n.TEXTURE_2D_ARRAY,y,0,0,0,x.width,x.height,g.depth,c,h,x.data):c!==null?n.compressedTexSubImage2D(n.TEXTURE_2D,y,0,0,x.width,x.height,c,x.data):console.warn("Unsupported compressed texture format")}}else if(e.isCubeTexture){const m=i.images;for(let g=0;g<6;g++){const y=f(m[g]);n.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+g,0,0,0,s,o,c,h,y)}}else if(e.isDataArrayTexture){const m=i.image;n.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,m.width,m.height,m.depth,c,h,m.data)}else if(e.isData3DTexture){const m=i.image;n.texSubImage3D(n.TEXTURE_3D,0,0,0,0,m.width,m.height,m.depth,c,h,m.data)}else if(e.isVideoTexture)e.update(),n.texImage2D(u,0,p,c,h,i.image);else{const m=f(i.image);n.texSubImage2D(u,0,0,0,s,o,c,h,m)}}generateMipmaps(e){const{gl:i,backend:n}=this,{textureGPU:s,glTextureType:o}=n.get(e);n.state.bindTexture(o,s),i.generateMipmap(o)}deallocateRenderBuffers(e){const{gl:i,backend:n}=this;if(e){const s=n.get(e);if(s.renderBufferStorageSetup=void 0,s.framebuffers){for(const o in s.framebuffers)i.deleteFramebuffer(s.framebuffers[o]);delete s.framebuffers}if(s.depthRenderbuffer&&(i.deleteRenderbuffer(s.depthRenderbuffer),delete s.depthRenderbuffer),s.stencilRenderbuffer&&(i.deleteRenderbuffer(s.stencilRenderbuffer),delete s.stencilRenderbuffer),s.msaaFrameBuffer&&(i.deleteFramebuffer(s.msaaFrameBuffer),delete s.msaaFrameBuffer),s.msaaRenderbuffers){for(let o=0;o<s.msaaRenderbuffers.length;o++)i.deleteRenderbuffer(s.msaaRenderbuffers[o]);delete s.msaaRenderbuffers}}}destroyTexture(e){const{gl:i,backend:n}=this,{textureGPU:s,renderTarget:o}=n.get(e);this.deallocateRenderBuffers(o),i.deleteTexture(s),n.delete(e)}copyTextureToTexture(e,i,n=null,s=null,o=0){const{gl:l,backend:u}=this,{state:c}=this.backend,{textureGPU:h,glTextureType:p,glType:f,glFormat:m}=u.get(i);let g,y,x,v,_,T;n!==null?(g=n.max.x-n.min.x,y=n.max.y-n.min.y,x=n.min.x,v=n.min.y):(g=e.image.width,y=e.image.height,x=0,v=0),s!==null?(_=s.x,T=s.y):(_=0,T=0),c.bindTexture(p,h),l.pixelStorei(l.UNPACK_ALIGNMENT,i.unpackAlignment),l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,i.flipY),l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.premultiplyAlpha),l.pixelStorei(l.UNPACK_ALIGNMENT,i.unpackAlignment);const w=l.getParameter(l.UNPACK_ROW_LENGTH),S=l.getParameter(l.UNPACK_IMAGE_HEIGHT),R=l.getParameter(l.UNPACK_SKIP_PIXELS),B=l.getParameter(l.UNPACK_SKIP_ROWS),I=l.getParameter(l.UNPACK_SKIP_IMAGES),D=e.isCompressedTexture?e.mipmaps[o]:e.image;if(l.pixelStorei(l.UNPACK_ROW_LENGTH,D.width),l.pixelStorei(l.UNPACK_IMAGE_HEIGHT,D.height),l.pixelStorei(l.UNPACK_SKIP_PIXELS,x),l.pixelStorei(l.UNPACK_SKIP_ROWS,v),e.isRenderTargetTexture||e.isDepthTexture){const L=u.get(e),O=u.get(i),U=u.get(L.renderTarget),Z=u.get(O.renderTarget),G=U.framebuffers[L.cacheKey],z=Z.framebuffers[O.cacheKey];c.bindFramebuffer(l.READ_FRAMEBUFFER,G),c.bindFramebuffer(l.DRAW_FRAMEBUFFER,z);let $=l.COLOR_BUFFER_BIT;e.isDepthTexture&&($=l.DEPTH_BUFFER_BIT),l.blitFramebuffer(x,v,g,y,_,T,g,y,$,l.NEAREST),c.bindFramebuffer(l.READ_FRAMEBUFFER,null),c.bindFramebuffer(l.DRAW_FRAMEBUFFER,null)}else e.isDataTexture?l.texSubImage2D(l.TEXTURE_2D,o,_,T,g,y,m,f,D.data):e.isCompressedTexture?l.compressedTexSubImage2D(l.TEXTURE_2D,o,_,T,D.width,D.height,m,D.data):l.texSubImage2D(l.TEXTURE_2D,o,_,T,g,y,m,f,D);l.pixelStorei(l.UNPACK_ROW_LENGTH,w),l.pixelStorei(l.UNPACK_IMAGE_HEIGHT,S),l.pixelStorei(l.UNPACK_SKIP_PIXELS,R),l.pixelStorei(l.UNPACK_SKIP_ROWS,B),l.pixelStorei(l.UNPACK_SKIP_IMAGES,I),o===0&&i.generateMipmaps&&l.generateMipmap(l.TEXTURE_2D),c.unbindTexture()}copyFramebufferToTexture(e,i,n){const{gl:s}=this,{state:o}=this.backend,{textureGPU:l}=this.backend.get(e),{x:u,y:c,z:h,w:p}=n,f=e.isDepthTexture===!0||i.renderTarget&&i.renderTarget.samples>0,m=i.renderTarget?i.renderTarget.height:this.backend.gerDrawingBufferSize().y;if(f){const g=u!==0||c!==0;let y,x;if(e.isDepthTexture===!0?(y=s.DEPTH_BUFFER_BIT,x=s.DEPTH_ATTACHMENT,i.stencil&&(y|=s.STENCIL_BUFFER_BIT)):(y=s.COLOR_BUFFER_BIT,x=s.COLOR_ATTACHMENT0),g){const v=this.backend.get(i.renderTarget),_=v.framebuffers[i.getCacheKey()],T=v.msaaFrameBuffer;o.bindFramebuffer(s.DRAW_FRAMEBUFFER,_),o.bindFramebuffer(s.READ_FRAMEBUFFER,T);const w=m-c-p;s.blitFramebuffer(u,w,u+h,w+p,u,w,u+h,w+p,y,s.NEAREST),o.bindFramebuffer(s.READ_FRAMEBUFFER,_),o.bindTexture(s.TEXTURE_2D,l),s.copyTexSubImage2D(s.TEXTURE_2D,0,0,0,u,w,h,p),o.unbindTexture()}else{const v=s.createFramebuffer();o.bindFramebuffer(s.DRAW_FRAMEBUFFER,v),s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,x,s.TEXTURE_2D,l,0),s.blitFramebuffer(0,0,h,p,0,0,h,p,y,s.NEAREST),s.deleteFramebuffer(v)}}else o.bindTexture(s.TEXTURE_2D,l),s.copyTexSubImage2D(s.TEXTURE_2D,0,0,0,u,m-p-c,h,p),o.unbindTexture();e.generateMipmaps&&this.generateMipmaps(e),this.backend._setFramebuffer(i)}setupRenderBufferStorage(e,i){const{gl:n}=this,s=i.renderTarget,{samples:o,depthTexture:l,depthBuffer:u,stencilBuffer:c,width:h,height:p}=s;if(n.bindRenderbuffer(n.RENDERBUFFER,e),u&&!c){let f=n.DEPTH_COMPONENT24;o>0?(l&&l.isDepthTexture&&l.type===n.FLOAT&&(f=n.DEPTH_COMPONENT32F),n.renderbufferStorageMultisample(n.RENDERBUFFER,o,f,h,p)):n.renderbufferStorage(n.RENDERBUFFER,f,h,p),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,e)}else u&&c&&(o>0?n.renderbufferStorageMultisample(n.RENDERBUFFER,o,n.DEPTH24_STENCIL8,h,p):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,h,p),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,e))}async copyTextureToBuffer(e,i,n,s,o,l){const{backend:u,gl:c}=this,{textureGPU:h,glFormat:p,glType:f}=this.backend.get(e),m=c.createFramebuffer();c.bindFramebuffer(c.READ_FRAMEBUFFER,m);const g=e.isCubeTexture?c.TEXTURE_CUBE_MAP_POSITIVE_X+l:c.TEXTURE_2D;c.framebufferTexture2D(c.READ_FRAMEBUFFER,c.COLOR_ATTACHMENT0,g,h,0);const y=this._getTypedArrayType(f),x=this._getBytesPerTexel(f,p),v=s*o*x,_=c.createBuffer();c.bindBuffer(c.PIXEL_PACK_BUFFER,_),c.bufferData(c.PIXEL_PACK_BUFFER,v,c.STREAM_READ),c.readPixels(i,n,s,o,p,f,0),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),await u.utils._clientWaitAsync();const T=new y(v/y.BYTES_PER_ELEMENT);return c.bindBuffer(c.PIXEL_PACK_BUFFER,_),c.getBufferSubData(c.PIXEL_PACK_BUFFER,0,T),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),c.deleteFramebuffer(m),T}_getTypedArrayType(e){const{gl:i}=this;if(e===i.UNSIGNED_BYTE)return Uint8Array;if(e===i.UNSIGNED_SHORT_4_4_4_4||e===i.UNSIGNED_SHORT_5_5_5_1||e===i.UNSIGNED_SHORT_5_6_5||e===i.UNSIGNED_SHORT)return Uint16Array;if(e===i.UNSIGNED_INT)return Uint32Array;if(e===i.HALF_FLOAT)return Uint16Array;if(e===i.FLOAT)return Float32Array;throw new Error(`Unsupported WebGL type: ${e}`)}_getBytesPerTexel(e,i){const{gl:n}=this;let s=0;if(e===n.UNSIGNED_BYTE&&(s=1),(e===n.UNSIGNED_SHORT_4_4_4_4||e===n.UNSIGNED_SHORT_5_5_5_1||e===n.UNSIGNED_SHORT_5_6_5||e===n.UNSIGNED_SHORT||e===n.HALF_FLOAT)&&(s=2),(e===n.UNSIGNED_INT||e===n.FLOAT)&&(s=4),i===n.RGBA)return s*4;if(i===n.RGB)return s*3;if(i===n.ALPHA)return s}}class pAe{constructor(e){this.backend=e,this.gl=this.backend.gl,this.availableExtensions=this.gl.getSupportedExtensions(),this.extensions={}}get(e){let i=this.extensions[e];return i===void 0&&(i=this.gl.getExtension(e),this.extensions[e]=i),i}has(e){return this.availableExtensions.includes(e)}}class fAe{constructor(e){this.backend=e,this.maxAnisotropy=null}getMaxAnisotropy(){if(this.maxAnisotropy!==null)return this.maxAnisotropy;const e=this.backend.gl,i=this.backend.extensions;if(i.has("EXT_texture_filter_anisotropic")===!0){const n=i.get("EXT_texture_filter_anisotropic");this.maxAnisotropy=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else this.maxAnisotropy=0;return this.maxAnisotropy}}const Wz={WEBGL_multi_draw:"WEBGL_multi_draw",WEBGL_compressed_texture_astc:"texture-compression-astc",WEBGL_compressed_texture_etc:"texture-compression-etc2",WEBGL_compressed_texture_etc1:"texture-compression-etc1",WEBGL_compressed_texture_pvrtc:"texture-compression-pvrtc",WEBKIT_WEBGL_compressed_texture_pvrtc:"texture-compression-pvrtc",WEBGL_compressed_texture_s3tc:"texture-compression-bc",EXT_texture_compression_bptc:"texture-compression-bptc",EXT_disjoint_timer_query_webgl2:"timestamp-query"};class mAe{constructor(e){this.gl=e.gl,this.extensions=e.extensions,this.info=e.renderer.info,this.mode=null,this.index=0,this.type=null,this.object=null}render(e,i){const{gl:n,mode:s,object:o,type:l,info:u,index:c}=this;c!==0?n.drawElements(s,i,l,e):n.drawArrays(s,e,i),u.update(o,i,s,1)}renderInstances(e,i,n){const{gl:s,mode:o,type:l,index:u,object:c,info:h}=this;n!==0&&(u!==0?s.drawElementsInstanced(o,i,l,e,n):s.drawArraysInstanced(o,e,i,n),h.update(c,i,o,n))}renderMultiDraw(e,i,n){const{extensions:s,mode:o,object:l,info:u}=this;if(n===0)return;const c=s.get("WEBGL_multi_draw");if(c===null)for(let h=0;h<n;h++)this.render(e[h],i[h]);else{this.index!==0?c.multiDrawElementsWEBGL(o,i,0,this.type,e,0,n):c.multiDrawArraysWEBGL(o,e,0,i,0,n);let h=0;for(let p=0;p<n;p++)h+=i[p];u.update(l,h,o,1)}}renderMultiDrawInstances(e,i,n,s){const{extensions:o,mode:l,object:u,info:c}=this;if(n===0)return;const h=o.get("WEBGL_multi_draw");if(h===null)for(let p=0;p<n;p++)this.renderInstances(e[p],i[p],s[p]);else{this.index!==0?h.multiDrawElementsInstancedWEBGL(l,i,0,this.type,e,0,s,0,n):h.multiDrawArraysInstancedWEBGL(l,e,0,i,0,s,0,n);let p=0;for(let f=0;f<n;f++)p+=i[f]*s[f];c.update(u,p,l,1)}}}class Qz extends jz{constructor(e={}){super(e),this.isWebGLBackend=!0}init(e){super.init(e);const i=this.parameters,n=i.context!==void 0?i.context:e.domElement.getContext("webgl2");function s(o){o.preventDefault();const l={api:"WebGL",message:o.statusMessage||"Unknown reason",reason:null,originalEvent:o};e.onDeviceLost(l)}this._onContextLost=s,e.domElement.addEventListener("webglcontextlost",s,!1),this.gl=n,this.extensions=new pAe(this),this.capabilities=new fAe(this),this.attributeUtils=new cAe(this),this.textureUtils=new dAe(this),this.bufferRenderer=new mAe(this),this.state=new uAe(this),this.utils=new hAe(this),this.vaoCache={},this.transformFeedbackCache={},this.discard=!1,this.trackTimestamp=i.trackTimestamp===!0,this.extensions.get("EXT_color_buffer_float"),this.extensions.get("WEBGL_clip_cull_distance"),this.extensions.get("OES_texture_float_linear"),this.extensions.get("EXT_color_buffer_half_float"),this.extensions.get("WEBGL_multisampled_render_to_texture"),this.extensions.get("WEBGL_render_shared_exponent"),this.extensions.get("WEBGL_multi_draw"),this.disjoint=this.extensions.get("EXT_disjoint_timer_query_webgl2"),this.parallel=this.extensions.get("KHR_parallel_shader_compile"),this._knownBindings=new WeakSet,this._currentContext=null}get coordinateSystem(){return fc}async getArrayBufferAsync(e){return await this.attributeUtils.getArrayBufferAsync(e)}async waitForGPU(){await this.utils._clientWaitAsync()}initTimestampQuery(e){if(!this.disjoint||!this.trackTimestamp)return;const i=this.get(e);if(this.queryRunning){i.queryQueue||(i.queryQueue=[]),i.queryQueue.push(e);return}i.activeQuery&&(this.gl.endQuery(this.disjoint.TIME_ELAPSED_EXT),i.activeQuery=null),i.activeQuery=this.gl.createQuery(),i.activeQuery!==null&&(this.gl.beginQuery(this.disjoint.TIME_ELAPSED_EXT,i.activeQuery),this.queryRunning=!0)}prepareTimestampBuffer(e){if(!this.disjoint||!this.trackTimestamp)return;const i=this.get(e);if(i.activeQuery&&(this.gl.endQuery(this.disjoint.TIME_ELAPSED_EXT),i.gpuQueries||(i.gpuQueries=[]),i.gpuQueries.push({query:i.activeQuery}),i.activeQuery=null,this.queryRunning=!1,i.queryQueue&&i.queryQueue.length>0)){const n=i.queryQueue.shift();this.initTimestampQuery(n)}}async resolveTimestampAsync(e,i="render"){if(!this.disjoint||!this.trackTimestamp)return;const n=this.get(e);n.gpuQueries||(n.gpuQueries=[]);for(let s=0;s<n.gpuQueries.length;s++){const o=n.gpuQueries[s],l=this.gl.getQueryParameter(o.query,this.gl.QUERY_RESULT_AVAILABLE),u=this.gl.getParameter(this.disjoint.GPU_DISJOINT_EXT);if(l&&!u){const c=this.gl.getQueryParameter(o.query,this.gl.QUERY_RESULT),h=Number(c)/1e6;this.gl.deleteQuery(o.query),n.gpuQueries.splice(s,1),s--,this.renderer.info.updateTimestamp(i,h)}}}getContext(){return this.gl}beginRender(e){const{gl:i}=this,n=this.get(e);if(this.initTimestampQuery(e),n.previousContext=this._currentContext,this._currentContext=e,this._setFramebuffer(e),this.clear(e.clearColor,e.clearDepth,e.clearStencil,e,!1),e.viewport?this.updateViewport(e):i.viewport(0,0,i.drawingBufferWidth,i.drawingBufferHeight),e.scissor){const{x:o,y:l,width:u,height:c}=e.scissorValue;i.scissor(o,e.height-c-l,u,c)}const s=e.occlusionQueryCount;s>0&&(n.currentOcclusionQueries=n.occlusionQueries,n.currentOcclusionQueryObjects=n.occlusionQueryObjects,n.lastOcclusionObject=null,n.occlusionQueries=new Array(s),n.occlusionQueryObjects=new Array(s),n.occlusionQueryIndex=0)}finishRender(e){const{gl:i,state:n}=this,s=this.get(e),o=s.previousContext,l=e.occlusionQueryCount;l>0&&(l>s.occlusionQueryIndex&&i.endQuery(i.ANY_SAMPLES_PASSED),this.resolveOccludedAsync(e));const u=e.textures;if(u!==null)for(let c=0;c<u.length;c++){const h=u[c];h.generateMipmaps&&this.generateMipmaps(h)}if(this._currentContext=o,e.textures!==null&&e.renderTarget){const c=this.get(e.renderTarget),{samples:h}=e.renderTarget;if(h>0){const p=c.framebuffers[e.getCacheKey()],f=i.COLOR_BUFFER_BIT,m=c.msaaFrameBuffer,g=e.textures;n.bindFramebuffer(i.READ_FRAMEBUFFER,m),n.bindFramebuffer(i.DRAW_FRAMEBUFFER,p);for(let y=0;y<g.length;y++)if(e.scissor){const{x,y:v,width:_,height:T}=e.scissorValue,w=e.height-T-v;i.blitFramebuffer(x,w,x+_,w+T,x,w,x+_,w+T,f,i.NEAREST),i.invalidateSubFramebuffer(i.READ_FRAMEBUFFER,c.invalidationArray,x,w,_,T)}else i.blitFramebuffer(0,0,e.width,e.height,0,0,e.width,e.height,f,i.NEAREST),i.invalidateFramebuffer(i.READ_FRAMEBUFFER,c.invalidationArray)}}o!==null&&(this._setFramebuffer(o),o.viewport?this.updateViewport(o):i.viewport(0,0,i.drawingBufferWidth,i.drawingBufferHeight)),this.prepareTimestampBuffer(e)}resolveOccludedAsync(e){const i=this.get(e),{currentOcclusionQueries:n,currentOcclusionQueryObjects:s}=i;if(n&&s){const o=new WeakSet,{gl:l}=this;i.currentOcclusionQueryObjects=null,i.currentOcclusionQueries=null;const u=()=>{let c=0;for(let h=0;h<n.length;h++){const p=n[h];p!==null&&l.getQueryParameter(p,l.QUERY_RESULT_AVAILABLE)&&(l.getQueryParameter(p,l.QUERY_RESULT)>0&&o.add(s[h]),n[h]=null,l.deleteQuery(p),c++)}c<n.length?requestAnimationFrame(u):i.occluded=o};u()}}isOccluded(e,i){const n=this.get(e);return n.occluded&&n.occluded.has(i)}updateViewport(e){const i=this.gl,{x:n,y:s,width:o,height:l}=e.viewportValue;i.viewport(n,e.height-l-s,o,l)}setScissorTest(e){const i=this.gl;e?i.enable(i.SCISSOR_TEST):i.disable(i.SCISSOR_TEST)}clear(e,i,n,s=null,o=!0){const{gl:l}=this;if(s===null){const c=this.getClearColor();c.r*=c.a,c.g*=c.a,c.b*=c.a,s={textures:null,clearColorValue:c}}let u=0;if(e&&(u|=l.COLOR_BUFFER_BIT),i&&(u|=l.DEPTH_BUFFER_BIT),n&&(u|=l.STENCIL_BUFFER_BIT),u!==0){let c;if(s.clearColorValue?c=s.clearColorValue:(c=this.getClearColor(),c.r*=c.a,c.g*=c.a,c.b*=c.a),i&&this.state.setDepthMask(!0),s.textures===null)l.clearColor(c.r,c.g,c.b,c.a),l.clear(u);else{if(o&&this._setFramebuffer(s),e)for(let h=0;h<s.textures.length;h++)l.clearBufferfv(l.COLOR,h,[c.r,c.g,c.b,c.a]);i&&n?l.clearBufferfi(l.DEPTH_STENCIL,0,1,0):i?l.clearBufferfv(l.DEPTH,0,[1]):n&&l.clearBufferiv(l.STENCIL,0,[0])}}}beginCompute(e){const{state:i,gl:n}=this;i.bindFramebuffer(n.FRAMEBUFFER,null),this.initTimestampQuery(e)}compute(e,i,n,s){const{state:o,gl:l}=this;this.discard||(l.enable(l.RASTERIZER_DISCARD),this.discard=!0);const{programGPU:u,transformBuffers:c,attributes:h}=this.get(s),p=this._getVaoKey(null,h),f=this.vaoCache[p];f===void 0?this._createVao(null,h):l.bindVertexArray(f),o.useProgram(u),this._bindUniforms(n);const m=this._getTransformFeedback(c);l.bindTransformFeedback(l.TRANSFORM_FEEDBACK,m),l.beginTransformFeedback(l.POINTS),h[0].isStorageInstancedBufferAttribute?l.drawArraysInstanced(l.POINTS,0,1,i.count):l.drawArrays(l.POINTS,0,i.count),l.endTransformFeedback(),l.bindTransformFeedback(l.TRANSFORM_FEEDBACK,null);for(let g=0;g<c.length;g++){const y=c[g];y.pbo&&this.textureUtils.copyBufferToTexture(y.transformBuffer,y.pbo),y.switchBuffers()}}finishCompute(e){const i=this.gl;this.discard=!1,i.disable(i.RASTERIZER_DISCARD),this.prepareTimestampBuffer(e),this._currentContext&&this._setFramebuffer(this._currentContext)}draw(e){const{object:i,pipeline:n,material:s,context:o}=e,{programGPU:l}=this.get(n),{gl:u,state:c}=this,h=this.get(o),p=e.getDrawParameters();if(p===null)return;this._bindUniforms(e.getBindings());const f=i.isMesh&&i.matrixWorld.determinant()<0;c.setMaterial(s,f),c.useProgram(l);let m=e.staticVao;if(m===void 0){const w=this._getVaoKey(e.getIndex(),e.getAttributes());if(m=this.vaoCache[w],m===void 0){let S;({vaoGPU:m,staticVao:S}=this._createVao(e.getIndex(),e.getAttributes())),S&&(e.staticVao=m)}}u.bindVertexArray(m);const g=e.getIndex(),y=h.lastOcclusionObject;if(y!==i&&y!==void 0){if(y!==null&&y.occlusionTest===!0&&(u.endQuery(u.ANY_SAMPLES_PASSED),h.occlusionQueryIndex++),i.occlusionTest===!0){const w=u.createQuery();u.beginQuery(u.ANY_SAMPLES_PASSED,w),h.occlusionQueries[h.occlusionQueryIndex]=w,h.occlusionQueryObjects[h.occlusionQueryIndex]=i}h.lastOcclusionObject=i}const x=this.bufferRenderer;i.isPoints?x.mode=u.POINTS:i.isLineSegments?x.mode=u.LINES:i.isLine?x.mode=u.LINE_STRIP:i.isLineLoop?x.mode=u.LINE_LOOP:s.wireframe===!0?(c.setLineWidth(s.wireframeLinewidth*this.renderer.getPixelRatio()),x.mode=u.LINES):x.mode=u.TRIANGLES;const{vertexCount:v,instanceCount:_}=p;let{firstVertex:T}=p;if(x.object=i,g!==null){T*=g.array.BYTES_PER_ELEMENT;const w=this.get(g);x.index=g.count,x.type=w.type}else x.index=0;i.isBatchedMesh?i._multiDrawInstances!==null?x.renderMultiDrawInstances(i._multiDrawStarts,i._multiDrawCounts,i._multiDrawCount,i._multiDrawInstances):this.hasFeature("WEBGL_multi_draw")?x.renderMultiDraw(i._multiDrawStarts,i._multiDrawCounts,i._multiDrawCount):rue("THREE.WebGLRenderer: WEBGL_multi_draw not supported."):_>1?x.renderInstances(T,v,_):x.render(T,v),u.bindVertexArray(null)}needsRenderUpdate(){return!1}getRenderCacheKey(){return""}createDefaultTexture(e){this.textureUtils.createDefaultTexture(e)}createTexture(e,i){this.textureUtils.createTexture(e,i)}updateTexture(e,i){this.textureUtils.updateTexture(e,i)}generateMipmaps(e){this.textureUtils.generateMipmaps(e)}destroyTexture(e){this.textureUtils.destroyTexture(e)}copyTextureToBuffer(e,i,n,s,o,l){return this.textureUtils.copyTextureToBuffer(e,i,n,s,o,l)}createSampler(){}destroySampler(){}createNodeBuilder(e,i){return new aAe(e,i)}createProgram(e){const i=this.gl,{stage:n,code:s}=e,o=n==="fragment"?i.createShader(i.FRAGMENT_SHADER):i.createShader(i.VERTEX_SHADER);i.shaderSource(o,s),i.compileShader(o),this.set(e,{shaderGPU:o})}destroyProgram(){console.warn("Abstract class.")}createRenderPipeline(e,i){const n=this.gl,s=e.pipeline,{fragmentProgram:o,vertexProgram:l}=s,u=n.createProgram(),c=this.get(o).shaderGPU,h=this.get(l).shaderGPU;if(n.attachShader(u,c),n.attachShader(u,h),n.linkProgram(u),this.set(s,{programGPU:u,fragmentShader:c,vertexShader:h}),i!==null&&this.parallel){const p=new Promise(f=>{const m=this.parallel,g=()=>{n.getProgramParameter(u,m.COMPLETION_STATUS_KHR)?(this._completeCompile(e,s),f()):requestAnimationFrame(g)};g()});i.push(p);return}this._completeCompile(e,s)}_handleSource(e,i){const n=e.split(`
`),s=[],o=Math.max(i-6,0),l=Math.min(i+6,n.length);for(let u=o;u<l;u++){const c=u+1;s.push(`${c===i?">":" "} ${c}: ${n[u]}`)}return s.join(`
`)}_getShaderErrors(e,i,n){const s=e.getShaderParameter(i,e.COMPILE_STATUS),o=e.getShaderInfoLog(i).trim();if(s&&o==="")return"";const l=/ERROR: 0:(\d+)/.exec(o);if(l){const u=parseInt(l[1]);return n.toUpperCase()+`

`+o+`

`+this._handleSource(e.getShaderSource(i),u)}else return o}_logProgramError(e,i,n){if(this.renderer.debug.checkShaderErrors){const s=this.gl,o=s.getProgramInfoLog(e).trim();if(s.getProgramParameter(e,s.LINK_STATUS)===!1)if(typeof this.renderer.debug.onShaderError=="function")this.renderer.debug.onShaderError(s,e,n,i);else{const l=this._getShaderErrors(s,n,"vertex"),u=this._getShaderErrors(s,i,"fragment");console.error("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(e,s.VALIDATE_STATUS)+`

Program Info Log: `+o+`
`+l+`
`+u)}else o!==""&&console.warn("THREE.WebGLProgram: Program Info Log:",o)}}_completeCompile(e,i){const{state:n,gl:s}=this,o=this.get(i),{programGPU:l,fragmentShader:u,vertexShader:c}=o;s.getProgramParameter(l,s.LINK_STATUS)===!1&&this._logProgramError(l,u,c),n.useProgram(l);const h=e.getBindings();this._setupBindings(h,l),this.set(i,{programGPU:l})}createComputePipeline(e,i){const{state:n,gl:s}=this,o={stage:"fragment",code:`#version 300 es
precision highp float;
void main() {}`};this.createProgram(o);const{computeProgram:l}=e,u=s.createProgram(),c=this.get(o).shaderGPU,h=this.get(l).shaderGPU,p=l.transforms,f=[],m=[];for(let v=0;v<p.length;v++){const _=p[v];f.push(_.varyingName),m.push(_.attributeNode)}s.attachShader(u,c),s.attachShader(u,h),s.transformFeedbackVaryings(u,f,s.SEPARATE_ATTRIBS),s.linkProgram(u),s.getProgramParameter(u,s.LINK_STATUS)===!1&&this._logProgramError(u,c,h),n.useProgram(u),this._setupBindings(i,u);const g=l.attributes,y=[],x=[];for(let v=0;v<g.length;v++){const _=g[v].node.attribute;y.push(_),this.has(_)||this.attributeUtils.createAttribute(_,s.ARRAY_BUFFER)}for(let v=0;v<m.length;v++){const _=m[v].attribute;this.has(_)||this.attributeUtils.createAttribute(_,s.ARRAY_BUFFER);const T=this.get(_);x.push(T)}this.set(e,{programGPU:u,transformBuffers:x,attributes:y})}createBindings(e,i){if(this._knownBindings.has(i)===!1){this._knownBindings.add(i);let n=0,s=0;for(const o of i){this.set(o,{textures:s,uniformBuffers:n});for(const l of o.bindings)l.isUniformBuffer&&n++,l.isSampledTexture&&s++}}this.updateBindings(e,i)}updateBindings(e){const{gl:i}=this,n=this.get(e);let s=n.uniformBuffers,o=n.textures;for(const l of e.bindings)if(l.isUniformsGroup||l.isUniformBuffer){const u=l.buffer,c=i.createBuffer();i.bindBuffer(i.UNIFORM_BUFFER,c),i.bufferData(i.UNIFORM_BUFFER,u,i.DYNAMIC_DRAW),this.set(l,{index:s++,bufferGPU:c})}else if(l.isSampledTexture){const{textureGPU:u,glTextureType:c}=this.get(l.texture);this.set(l,{index:o++,textureGPU:u,glTextureType:c})}}updateBinding(e){const i=this.gl;if(e.isUniformsGroup||e.isUniformBuffer){const n=this.get(e).bufferGPU,s=e.buffer;i.bindBuffer(i.UNIFORM_BUFFER,n),i.bufferData(i.UNIFORM_BUFFER,s,i.DYNAMIC_DRAW)}}createIndexAttribute(e){const i=this.gl;this.attributeUtils.createAttribute(e,i.ELEMENT_ARRAY_BUFFER)}createAttribute(e){if(this.has(e))return;const i=this.gl;this.attributeUtils.createAttribute(e,i.ARRAY_BUFFER)}createStorageAttribute(e){if(this.has(e))return;const i=this.gl;this.attributeUtils.createAttribute(e,i.ARRAY_BUFFER)}updateAttribute(e){this.attributeUtils.updateAttribute(e)}destroyAttribute(e){this.attributeUtils.destroyAttribute(e)}updateSize(){}hasFeature(e){const i=Object.keys(Wz).filter(s=>Wz[s]===e),n=this.extensions;for(let s=0;s<i.length;s++)if(n.has(i[s]))return!0;return!1}getMaxAnisotropy(){return this.capabilities.getMaxAnisotropy()}copyTextureToTexture(e,i,n,s,o){this.textureUtils.copyTextureToTexture(e,i,n,s,o)}copyFramebufferToTexture(e,i,n){this.textureUtils.copyFramebufferToTexture(e,i,n)}_setFramebuffer(e){const{gl:i,state:n}=this;let s=null;if(e.textures!==null){const o=e.renderTarget,l=this.get(o),{samples:u,depthBuffer:c,stencilBuffer:h}=o,p=o.isWebGLCubeRenderTarget===!0;let f=l.msaaFrameBuffer,m=l.depthRenderbuffer;const g=nz(e);let y;if(p?(l.cubeFramebuffers||(l.cubeFramebuffers={}),y=l.cubeFramebuffers[g]):(l.framebuffers||(l.framebuffers={}),y=l.framebuffers[g]),y===void 0){y=i.createFramebuffer(),n.bindFramebuffer(i.FRAMEBUFFER,y);const x=e.textures;if(p){l.cubeFramebuffers[g]=y;const{textureGPU:v}=this.get(x[0]),_=this.renderer._activeCubeFace;i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+_,v,0)}else{l.framebuffers[g]=y;for(let v=0;v<x.length;v++){const _=x[v],T=this.get(_);T.renderTarget=e.renderTarget,T.cacheKey=g;const w=i.COLOR_ATTACHMENT0+v;i.framebufferTexture2D(i.FRAMEBUFFER,w,i.TEXTURE_2D,T.textureGPU,0)}n.drawBuffers(e,y)}if(e.depthTexture!==null){const v=this.get(e.depthTexture),_=h?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;v.renderTarget=e.renderTarget,v.cacheKey=g,i.framebufferTexture2D(i.FRAMEBUFFER,_,i.TEXTURE_2D,v.textureGPU,0)}}if(u>0){if(f===void 0){const x=[];f=i.createFramebuffer(),n.bindFramebuffer(i.FRAMEBUFFER,f);const v=[],_=e.textures;for(let T=0;T<_.length;T++){if(v[T]=i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,v[T]),x.push(i.COLOR_ATTACHMENT0+T),c){const R=h?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;x.push(R)}const w=e.textures[T],S=this.get(w);i.renderbufferStorageMultisample(i.RENDERBUFFER,u,S.glInternalFormat,e.width,e.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+T,i.RENDERBUFFER,v[T])}if(l.msaaFrameBuffer=f,l.msaaRenderbuffers=v,m===void 0){m=i.createRenderbuffer(),this.textureUtils.setupRenderBufferStorage(m,e),l.depthRenderbuffer=m;const T=h?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;x.push(T)}l.invalidationArray=x}s=l.msaaFrameBuffer}else s=y}n.bindFramebuffer(i.FRAMEBUFFER,s)}_getVaoKey(e,i){let n=[];if(e!==null){const s=this.get(e);n+=":"+s.id}for(let s=0;s<i.length;s++){const o=this.get(i[s]);n+=":"+o.id}return n}_createVao(e,i){const{gl:n}=this,s=n.createVertexArray();let o="",l=!0;if(n.bindVertexArray(s),e!==null){const u=this.get(e);n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,u.bufferGPU),o+=":"+u.id}for(let u=0;u<i.length;u++){const c=i[u],h=this.get(c);o+=":"+h.id,n.bindBuffer(n.ARRAY_BUFFER,h.bufferGPU),n.enableVertexAttribArray(u),(c.isStorageBufferAttribute||c.isStorageInstancedBufferAttribute)&&(l=!1);let p,f;c.isInterleavedBufferAttribute===!0?(p=c.data.stride*h.bytesPerElement,f=c.offset*h.bytesPerElement):(p=0,f=0),h.isInteger?n.vertexAttribIPointer(u,c.itemSize,h.type,p,f):n.vertexAttribPointer(u,c.itemSize,h.type,c.normalized,p,f),c.isInstancedBufferAttribute&&!c.isInterleavedBufferAttribute?n.vertexAttribDivisor(u,c.meshPerAttribute):c.isInterleavedBufferAttribute&&c.data.isInstancedInterleavedBuffer&&n.vertexAttribDivisor(u,c.data.meshPerAttribute)}return n.bindBuffer(n.ARRAY_BUFFER,null),this.vaoCache[o]=s,{vaoGPU:s,staticVao:l}}_getTransformFeedback(e){let i="";for(let o=0;o<e.length;o++)i+=":"+e[o].id;let n=this.transformFeedbackCache[i];if(n!==void 0)return n;const{gl:s}=this;n=s.createTransformFeedback(),s.bindTransformFeedback(s.TRANSFORM_FEEDBACK,n);for(let o=0;o<e.length;o++){const l=e[o];s.bindBufferBase(s.TRANSFORM_FEEDBACK_BUFFER,o,l.transformBuffer)}return s.bindTransformFeedback(s.TRANSFORM_FEEDBACK,null),this.transformFeedbackCache[i]=n,n}_setupBindings(e,i){const n=this.gl;for(const s of e)for(const o of s.bindings){const l=this.get(o).index;if(o.isUniformsGroup||o.isUniformBuffer){const u=n.getUniformBlockIndex(i,o.name);n.uniformBlockBinding(i,u,l)}else if(o.isSampledTexture){const u=n.getUniformLocation(i,o.name);n.uniform1i(u,l)}}}_bindUniforms(e){const{gl:i,state:n}=this;for(const s of e)for(const o of s.bindings){const l=this.get(o),u=l.index;o.isUniformsGroup||o.isUniformBuffer?n.bindBufferBase(i.UNIFORM_BUFFER,u,l.bufferGPU):o.isSampledTexture&&n.bindTexture(l.glTextureType,l.textureGPU,i.TEXTURE0+u)}}dispose(){this.renderer.domElement.removeEventListener("webglcontextlost",this._onContextLost)}}class gAe extends HR{constructor(e,i){super(e),this.texture=i,this.version=i?i.version:0,this.isSampler=!0}}class AAe extends gAe{constructor(e,i,n){super(e,i?i.value:null),this.textureNode=i,this.groupNode=n}update(){this.texture=this.textureNode.value}}class yAe extends Lz{constructor(e,i){super(e,i?i.array:null),this.attribute=i,this.isStorageBuffer=!0}}let vAe=0;class xAe extends yAe{constructor(e,i){super("StorageBuffer_"+vAe++,e?e.value:null),this.nodeUniform=e,this.access=e?e.access:CR.Storage,this.groupNode=i}get buffer(){return this.nodeUniform.value}}class bAe extends Ed{constructor(e){super(),this.device=e;const i=`
struct VarysStruct {
	@builtin( position ) Position: vec4<f32>,
	@location( 0 ) vTex : vec2<f32>
};

@vertex
fn main( @builtin( vertex_index ) vertexIndex : u32 ) -> VarysStruct {

	var Varys : VarysStruct;

	var pos = array< vec2<f32>, 4 >(
		vec2<f32>( -1.0,  1.0 ),
		vec2<f32>(  1.0,  1.0 ),
		vec2<f32>( -1.0, -1.0 ),
		vec2<f32>(  1.0, -1.0 )
	);

	var tex = array< vec2<f32>, 4 >(
		vec2<f32>( 0.0, 0.0 ),
		vec2<f32>( 1.0, 0.0 ),
		vec2<f32>( 0.0, 1.0 ),
		vec2<f32>( 1.0, 1.0 )
	);

	Varys.vTex = tex[ vertexIndex ];
	Varys.Position = vec4<f32>( pos[ vertexIndex ], 0.0, 1.0 );

	return Varys;

}
`,n=`
@group( 0 ) @binding( 0 )
var imgSampler : sampler;

@group( 0 ) @binding( 1 )
var img : texture_2d<f32>;

@fragment
fn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {

	return textureSample( img, imgSampler, vTex );

}
`,s=`
@group( 0 ) @binding( 0 )
var imgSampler : sampler;

@group( 0 ) @binding( 1 )
var img : texture_2d<f32>;

@fragment
fn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {

	return textureSample( img, imgSampler, vec2( vTex.x, 1.0 - vTex.y ) );

}
`;this.mipmapSampler=e.createSampler({minFilter:qp.Linear}),this.flipYSampler=e.createSampler({minFilter:qp.Nearest}),this.transferPipelines={},this.flipYPipelines={},this.mipmapVertexShaderModule=e.createShaderModule({label:"mipmapVertex",code:i}),this.mipmapFragmentShaderModule=e.createShaderModule({label:"mipmapFragment",code:n}),this.flipYFragmentShaderModule=e.createShaderModule({label:"flipYFragment",code:s})}getTransferPipeline(e){let i=this.transferPipelines[e];return i===void 0&&(i=this.device.createRenderPipeline({label:`mipmap-${e}`,vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.mipmapFragmentShaderModule,entryPoint:"main",targets:[{format:e}]},primitive:{topology:Dg.TriangleStrip,stripIndexFormat:Og.Uint32},layout:"auto"}),this.transferPipelines[e]=i),i}getFlipYPipeline(e){let i=this.flipYPipelines[e];return i===void 0&&(i=this.device.createRenderPipeline({label:`flipY-${e}`,vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.flipYFragmentShaderModule,entryPoint:"main",targets:[{format:e}]},primitive:{topology:Dg.TriangleStrip,stripIndexFormat:Og.Uint32},layout:"auto"}),this.flipYPipelines[e]=i),i}flipY(e,i,n=0){const s=i.format,{width:o,height:l}=i.size,u=this.getTransferPipeline(s),c=this.getFlipYPipeline(s),h=this.device.createTexture({size:{width:o,height:l,depthOrArrayLayers:1},format:s,usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING}),p=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:Fl.TwoD,baseArrayLayer:n}),f=h.createView({baseMipLevel:0,mipLevelCount:1,dimension:Fl.TwoD,baseArrayLayer:0}),m=this.device.createCommandEncoder({}),g=(y,x,v)=>{const _=y.getBindGroupLayout(0),T=this.device.createBindGroup({layout:_,entries:[{binding:0,resource:this.flipYSampler},{binding:1,resource:x}]}),w=m.beginRenderPass({colorAttachments:[{view:v,loadOp:aa.Clear,storeOp:qa.Store,clearValue:[0,0,0,0]}]});w.setPipeline(y),w.setBindGroup(0,T),w.draw(4,1,0,0),w.end()};g(u,p,f),g(c,f,p),this.device.queue.submit([m.finish()]),h.destroy()}generateMipmaps(e,i,n=0){const s=this.get(e);s.useCount===void 0&&(s.useCount=0,s.layers=[]);const o=s.layers[n]||this._mipmapCreateBundles(e,i,n),l=this.device.createCommandEncoder({});this._mipmapRunBundles(l,o),this.device.queue.submit([l.finish()]),s.useCount!==0&&(s.layers[n]=o),s.useCount++}_mipmapCreateBundles(e,i,n){const s=this.getTransferPipeline(i.format),o=s.getBindGroupLayout(0);let l=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:Fl.TwoD,baseArrayLayer:n});const u=[];for(let c=1;c<i.mipLevelCount;c++){const h=this.device.createBindGroup({layout:o,entries:[{binding:0,resource:this.mipmapSampler},{binding:1,resource:l}]}),p=e.createView({baseMipLevel:c,mipLevelCount:1,dimension:Fl.TwoD,baseArrayLayer:n}),f={colorAttachments:[{view:p,loadOp:aa.Clear,storeOp:qa.Store,clearValue:[0,0,0,0]}]},m=this.device.createRenderBundleEncoder({colorFormats:[i.format]});m.setPipeline(s),m.setBindGroup(0,h),m.draw(4,1,0,0),u.push({renderBundles:[m.finish()],passDescriptor:f}),l=p}return u}_mipmapRunBundles(e,i){const n=i.length;for(let s=0;s<n;s++){const o=i[s],l=e.beginRenderPass(o.passDescriptor);l.executeBundles(o.renderBundles),l.end()}}}const _Ae={[n5]:"never",[qM]:"less",[s5]:"equal",[a5]:"less-equal",[o5]:"greater",[c5]:"greater-equal",[u5]:"always",[l5]:"not-equal"},EAe=[0,1,3,2,4,5];class wAe{constructor(e){this.backend=e,this._passUtils=null,this.defaultTexture={},this.defaultCubeTexture={},this.defaultVideoFrame=null,this.colorBuffer=null,this.depthTexture=new bg,this.depthTexture.name="depthBuffer"}createSampler(e){const i=this.backend,n=i.device,s=i.get(e),o={addressModeU:this._convertAddressMode(e.wrapS),addressModeV:this._convertAddressMode(e.wrapT),addressModeW:this._convertAddressMode(e.wrapR),magFilter:this._convertFilterMode(e.magFilter),minFilter:this._convertFilterMode(e.minFilter),mipmapFilter:this._convertFilterMode(e.minFilter),maxAnisotropy:1};o.magFilter===qp.Linear&&o.minFilter===qp.Linear&&o.mipmapFilter===qp.Linear&&(o.maxAnisotropy=e.anisotropy),e.isDepthTexture&&e.compareFunction!==null&&(o.compare=_Ae[e.compareFunction]),s.sampler=n.createSampler(o)}createDefaultTexture(e){let i;const n=YR(e);e.isCubeTexture?i=this._getDefaultCubeTextureGPU(n):e.isVideoTexture?this.backend.get(e).externalTexture=this._getDefaultVideoFrame():i=this._getDefaultTextureGPU(n),this.backend.get(e).texture=i}createTexture(e,i={}){const n=this.backend,s=n.get(e);if(s.initialized)throw new Error("WebGPUTextureUtils: Texture already initialized.");i.needsMipmaps===void 0&&(i.needsMipmaps=!1),i.levels===void 0&&(i.levels=1),i.depth===void 0&&(i.depth=1);const{width:o,height:l,depth:u,levels:c}=i;e.isFramebufferTexture&&(i.renderTarget?i.format=this.backend.utils.getCurrentColorFormat(i.renderTarget):i.format=this.backend.utils.getPreferredCanvasFormat());const h=this._getDimension(e),p=e.internalFormat||i.format||YR(e,n.device);s.format=p;let f=i.sampleCount!==void 0?i.sampleCount:1;f=n.utils.getSampleCount(f);const m=e.isRenderTargetTexture&&!e.isMultisampleRenderTargetTexture?1:f;let g=GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.COPY_SRC;e.isStorageTexture===!0&&(g|=GPUTextureUsage.STORAGE_BINDING),e.isCompressedTexture!==!0&&e.isCompressedArrayTexture!==!0&&(g|=GPUTextureUsage.RENDER_ATTACHMENT);const y={label:e.name,size:{width:o,height:l,depthOrArrayLayers:u},mipLevelCount:c,sampleCount:m,dimension:h,format:p,usage:g};if(e.isVideoTexture){const x=e.source.data,v=new VideoFrame(x);y.size.width=v.displayWidth,y.size.height=v.displayHeight,v.close(),s.externalTexture=x}else{if(p===void 0)return console.warn("WebGPURenderer: Texture format not supported."),this.createDefaultTexture(e);s.texture=n.device.createTexture(y)}if(e.isRenderTargetTexture&&f>1&&!e.isMultisampleRenderTargetTexture){const x=Object.assign({},y);x.label=x.label+"-msaa",x.sampleCount=f,s.msaaTexture=n.device.createTexture(x)}s.initialized=!0,s.textureDescriptorGPU=y}destroyTexture(e){const i=this.backend,n=i.get(e);n.texture.destroy(),n.msaaTexture!==void 0&&n.msaaTexture.destroy(),i.delete(e)}destroySampler(e){const i=this.backend.get(e);delete i.sampler}generateMipmaps(e){const i=this.backend.get(e);if(e.isCubeTexture)for(let n=0;n<6;n++)this._generateMipmaps(i.texture,i.textureDescriptorGPU,n);else{const n=e.image.depth||1;for(let s=0;s<n;s++)this._generateMipmaps(i.texture,i.textureDescriptorGPU,s)}}getColorBuffer(){this.colorBuffer&&this.colorBuffer.destroy();const e=this.backend,{width:i,height:n}=e.getDrawingBufferSize();return this.colorBuffer=e.device.createTexture({label:"colorBuffer",size:{width:i,height:n,depthOrArrayLayers:1},sampleCount:e.utils.getSampleCount(e.renderer.samples),format:e.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC}),this.colorBuffer}getDepthBuffer(e=!0,i=!1){const n=this.backend,{width:s,height:o}=n.getDrawingBufferSize(),l=this.depthTexture,u=n.get(l).texture;let c,h;if(i?(c=ng,h=$A):e&&(c=Ip,h=ja),u!==void 0){if(l.image.width===s&&l.image.height===o&&l.format===c&&l.type===h)return u;this.destroyTexture(l)}return l.name="depthBuffer",l.format=c,l.type=h,l.image.width=s,l.image.height=o,this.createTexture(l,{sampleCount:n.utils.getSampleCount(n.renderer.samples),width:s,height:o}),n.get(l).texture}updateTexture(e,i){const n=this.backend.get(e),{textureDescriptorGPU:s}=n;if(!(e.isRenderTargetTexture||s===void 0)){if(e.isDataTexture)this._copyBufferToTexture(i.image,n.texture,s,0,e.flipY);else if(e.isDataArrayTexture||e.isData3DTexture)for(let o=0;o<i.image.depth;o++)this._copyBufferToTexture(i.image,n.texture,s,o,e.flipY,o);else if(e.isCompressedTexture||e.isCompressedArrayTexture)this._copyCompressedBufferToTexture(e.mipmaps,n.texture,s);else if(e.isCubeTexture)this._copyCubeMapToTexture(i.images,n.texture,s,e.flipY);else if(e.isVideoTexture){const o=e.source.data;n.externalTexture=o}else this._copyImageToTexture(i.image,n.texture,s,0,e.flipY);n.version=e.version,e.onUpdate&&e.onUpdate(e)}}async copyTextureToBuffer(e,i,n,s,o,l){const u=this.backend.device,c=this.backend.get(e),h=c.texture,p=c.textureDescriptorGPU.format,f=this._getBytesPerTexel(p);let m=s*f;m=Math.ceil(m/256)*256;const g=u.createBuffer({size:s*o*f,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),y=u.createCommandEncoder();y.copyTextureToBuffer({texture:h,origin:{x:i,y:n,z:l}},{buffer:g,bytesPerRow:m},{width:s,height:o});const x=this._getTypedArrayType(p);u.queue.submit([y.finish()]),await g.mapAsync(GPUMapMode.READ);const v=g.getMappedRange();return new x(v)}_isEnvironmentTexture(e){const i=e.mapping;return i===YA||i===KA||i===Rp||i===$m}_getDefaultTextureGPU(e){let i=this.defaultTexture[e];if(i===void 0){const n=new So;n.minFilter=no,n.magFilter=no,this.createTexture(n,{width:1,height:1,format:e}),this.defaultTexture[e]=i=n}return this.backend.get(i).texture}_getDefaultCubeTextureGPU(e){let i=this.defaultTexture[e];if(i===void 0){const n=new g3;n.minFilter=no,n.magFilter=no,this.createTexture(n,{width:1,height:1,depth:6}),this.defaultCubeTexture[e]=i=n}return this.backend.get(i).texture}_getDefaultVideoFrame(){let e=this.defaultVideoFrame;if(e===null){const i={timestamp:0,codedWidth:1,codedHeight:1,format:"RGBA"};this.defaultVideoFrame=e=new VideoFrame(new Uint8Array([0,0,0,255]),i)}return e}_copyCubeMapToTexture(e,i,n,s){for(let o=0;o<6;o++){const l=e[o],u=s===!0?EAe[o]:o;l.isDataTexture?this._copyBufferToTexture(l.image,i,n,u,s):this._copyImageToTexture(l,i,n,u,s)}}_copyImageToTexture(e,i,n,s,o){this.backend.device.queue.copyExternalImageToTexture({source:e},{texture:i,mipLevel:0,origin:{x:0,y:0,z:s}},{width:e.width,height:e.height,depthOrArrayLayers:1}),o===!0&&this._flipY(i,n,s)}_getPassUtils(){let e=this._passUtils;return e===null&&(this._passUtils=e=new bAe(this.backend.device)),e}_generateMipmaps(e,i,n=0){this._getPassUtils().generateMipmaps(e,i,n)}_flipY(e,i,n=0){this._getPassUtils().flipY(e,i,n)}_copyBufferToTexture(e,i,n,s,o,l=0){const u=this.backend.device,c=e.data,h=this._getBytesPerTexel(n.format),p=e.width*h;u.queue.writeTexture({texture:i,mipLevel:0,origin:{x:0,y:0,z:s}},c,{offset:e.width*e.height*h*l,bytesPerRow:p},{width:e.width,height:e.height,depthOrArrayLayers:1}),o===!0&&this._flipY(i,n,s)}_copyCompressedBufferToTexture(e,i,n){const s=this.backend.device,o=this._getBlockData(n.format),l=n.size.depthOrArrayLayers>1;for(let u=0;u<e.length;u++){const c=e[u],h=c.width,p=c.height,f=l?n.size.depthOrArrayLayers:1,m=Math.ceil(h/o.width)*o.byteLength,g=m*Math.ceil(p/o.height);for(let y=0;y<f;y++)s.queue.writeTexture({texture:i,mipLevel:u,origin:{x:0,y:0,z:y}},c.data,{offset:y*g,bytesPerRow:m,rowsPerImage:Math.ceil(p/o.height)},{width:Math.ceil(h/o.width)*o.width,height:Math.ceil(p/o.height)*o.height,depthOrArrayLayers:1})}}_getBlockData(e){if(e===ht.BC1RGBAUnorm||e===ht.BC1RGBAUnormSRGB)return{byteLength:8,width:4,height:4};if(e===ht.BC2RGBAUnorm||e===ht.BC2RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===ht.BC3RGBAUnorm||e===ht.BC3RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===ht.BC4RUnorm||e===ht.BC4RSNorm)return{byteLength:8,width:4,height:4};if(e===ht.BC5RGUnorm||e===ht.BC5RGSnorm)return{byteLength:16,width:4,height:4};if(e===ht.BC6HRGBUFloat||e===ht.BC6HRGBFloat)return{byteLength:16,width:4,height:4};if(e===ht.BC7RGBAUnorm||e===ht.BC7RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===ht.ETC2RGB8Unorm||e===ht.ETC2RGB8UnormSRGB)return{byteLength:8,width:4,height:4};if(e===ht.ETC2RGB8A1Unorm||e===ht.ETC2RGB8A1UnormSRGB)return{byteLength:8,width:4,height:4};if(e===ht.ETC2RGBA8Unorm||e===ht.ETC2RGBA8UnormSRGB)return{byteLength:16,width:4,height:4};if(e===ht.EACR11Unorm)return{byteLength:8,width:4,height:4};if(e===ht.EACR11Snorm)return{byteLength:8,width:4,height:4};if(e===ht.EACRG11Unorm)return{byteLength:16,width:4,height:4};if(e===ht.EACRG11Snorm)return{byteLength:16,width:4,height:4};if(e===ht.ASTC4x4Unorm||e===ht.ASTC4x4UnormSRGB)return{byteLength:16,width:4,height:4};if(e===ht.ASTC5x4Unorm||e===ht.ASTC5x4UnormSRGB)return{byteLength:16,width:5,height:4};if(e===ht.ASTC5x5Unorm||e===ht.ASTC5x5UnormSRGB)return{byteLength:16,width:5,height:5};if(e===ht.ASTC6x5Unorm||e===ht.ASTC6x5UnormSRGB)return{byteLength:16,width:6,height:5};if(e===ht.ASTC6x6Unorm||e===ht.ASTC6x6UnormSRGB)return{byteLength:16,width:6,height:6};if(e===ht.ASTC8x5Unorm||e===ht.ASTC8x5UnormSRGB)return{byteLength:16,width:8,height:5};if(e===ht.ASTC8x6Unorm||e===ht.ASTC8x6UnormSRGB)return{byteLength:16,width:8,height:6};if(e===ht.ASTC8x8Unorm||e===ht.ASTC8x8UnormSRGB)return{byteLength:16,width:8,height:8};if(e===ht.ASTC10x5Unorm||e===ht.ASTC10x5UnormSRGB)return{byteLength:16,width:10,height:5};if(e===ht.ASTC10x6Unorm||e===ht.ASTC10x6UnormSRGB)return{byteLength:16,width:10,height:6};if(e===ht.ASTC10x8Unorm||e===ht.ASTC10x8UnormSRGB)return{byteLength:16,width:10,height:8};if(e===ht.ASTC10x10Unorm||e===ht.ASTC10x10UnormSRGB)return{byteLength:16,width:10,height:10};if(e===ht.ASTC12x10Unorm||e===ht.ASTC12x10UnormSRGB)return{byteLength:16,width:12,height:10};if(e===ht.ASTC12x12Unorm||e===ht.ASTC12x12UnormSRGB)return{byteLength:16,width:12,height:12}}_convertAddressMode(e){let i=wR.ClampToEdge;return e===C1?i=wR.Repeat:e===S1&&(i=wR.MirrorRepeat),i}_convertFilterMode(e){let i=qp.Linear;return(e===no||e===bM||e===tg)&&(i=qp.Nearest),i}_getBytesPerTexel(e){if(e===ht.R8Unorm||e===ht.R8Snorm||e===ht.R8Uint||e===ht.R8Sint)return 1;if(e===ht.R16Uint||e===ht.R16Sint||e===ht.R16Float||e===ht.RG8Unorm||e===ht.RG8Snorm||e===ht.RG8Uint||e===ht.RG8Sint)return 2;if(e===ht.R32Uint||e===ht.R32Sint||e===ht.R32Float||e===ht.RG16Uint||e===ht.RG16Sint||e===ht.RG16Float||e===ht.RGBA8Unorm||e===ht.RGBA8UnormSRGB||e===ht.RGBA8Snorm||e===ht.RGBA8Uint||e===ht.RGBA8Sint||e===ht.BGRA8Unorm||e===ht.BGRA8UnormSRGB||e===ht.RGB9E5UFloat||e===ht.RGB10A2Unorm||e===ht.RG11B10UFloat||e===ht.Depth32Float||e===ht.Depth24Plus||e===ht.Depth24PlusStencil8||e===ht.Depth32FloatStencil8)return 4;if(e===ht.RG32Uint||e===ht.RG32Sint||e===ht.RG32Float||e===ht.RGBA16Uint||e===ht.RGBA16Sint||e===ht.RGBA16Float)return 8;if(e===ht.RGBA32Uint||e===ht.RGBA32Sint||e===ht.RGBA32Float)return 16}_getTypedArrayType(e){if(e===ht.R8Uint)return Uint8Array;if(e===ht.R8Sint)return Int8Array;if(e===ht.R8Unorm)return Uint8Array;if(e===ht.R8Snorm)return Int8Array;if(e===ht.RG8Uint)return Uint8Array;if(e===ht.RG8Sint)return Int8Array;if(e===ht.RG8Unorm)return Uint8Array;if(e===ht.RG8Snorm)return Int8Array;if(e===ht.RGBA8Uint)return Uint8Array;if(e===ht.RGBA8Sint)return Int8Array;if(e===ht.RGBA8Unorm)return Uint8Array;if(e===ht.RGBA8Snorm)return Int8Array;if(e===ht.R16Uint)return Uint16Array;if(e===ht.R16Sint)return Int16Array;if(e===ht.RG16Uint)return Uint16Array;if(e===ht.RG16Sint)return Int16Array;if(e===ht.RGBA16Uint)return Uint16Array;if(e===ht.RGBA16Sint)return Int16Array;if(e===ht.R16Float||e===ht.RG16Float||e===ht.RGBA16Float)return Uint16Array;if(e===ht.R32Uint)return Uint32Array;if(e===ht.R32Sint)return Int32Array;if(e===ht.R32Float)return Float32Array;if(e===ht.RG32Uint)return Uint32Array;if(e===ht.RG32Sint)return Int32Array;if(e===ht.RG32Float)return Float32Array;if(e===ht.RGBA32Uint)return Uint32Array;if(e===ht.RGBA32Sint)return Int32Array;if(e===ht.RGBA32Float)return Float32Array;if(e===ht.BGRA8Unorm||e===ht.BGRA8UnormSRGB)return Uint8Array;if(e===ht.RGB10A2Unorm||e===ht.RGB9E5UFloat||e===ht.RG11B10UFloat)return Uint32Array;if(e===ht.Depth32Float)return Float32Array;if(e===ht.Depth24Plus||e===ht.Depth24PlusStencil8)return Uint32Array;if(e===ht.Depth32FloatStencil8)return Float32Array}_getDimension(e){let i;return e.isData3DTexture?i=cz.ThreeD:i=cz.TwoD,i}}function YR(r,e=null){const i=r.format,n=r.type,s=r.colorSpace;let o;if(r.isCompressedTexture===!0||r.isCompressedArrayTexture===!0)switch(i){case T1:o=s===Dr?ht.BC1RGBAUnormSRGB:ht.BC1RGBAUnorm;break;case M1:o=s===Dr?ht.BC2RGBAUnormSRGB:ht.BC2RGBAUnorm;break;case R1:o=s===Dr?ht.BC3RGBAUnormSRGB:ht.BC3RGBAUnorm;break;case RM:o=s===Dr?ht.ETC2RGB8UnormSRGB:ht.ETC2RGB8Unorm;break;case IM:o=s===Dr?ht.ETC2RGBA8UnormSRGB:ht.ETC2RGBA8Unorm;break;case BM:o=s===Dr?ht.ASTC4x4UnormSRGB:ht.ASTC4x4Unorm;break;case NM:o=s===Dr?ht.ASTC5x4UnormSRGB:ht.ASTC5x4Unorm;break;case LM:o=s===Dr?ht.ASTC5x5UnormSRGB:ht.ASTC5x5Unorm;break;case DM:o=s===Dr?ht.ASTC6x5UnormSRGB:ht.ASTC6x5Unorm;break;case OM:o=s===Dr?ht.ASTC6x6UnormSRGB:ht.ASTC6x6Unorm;break;case PM:o=s===Dr?ht.ASTC8x5UnormSRGB:ht.ASTC8x5Unorm;break;case kM:o=s===Dr?ht.ASTC8x6UnormSRGB:ht.ASTC8x6Unorm;break;case FM:o=s===Dr?ht.ASTC8x8UnormSRGB:ht.ASTC8x8Unorm;break;case UM:o=s===Dr?ht.ASTC10x5UnormSRGB:ht.ASTC10x5Unorm;break;case zM:o=s===Dr?ht.ASTC10x6UnormSRGB:ht.ASTC10x6Unorm;break;case jM:o=s===Dr?ht.ASTC10x8UnormSRGB:ht.ASTC10x8Unorm;break;case VM:o=s===Dr?ht.ASTC10x10UnormSRGB:ht.ASTC10x10Unorm;break;case GM:o=s===Dr?ht.ASTC12x10UnormSRGB:ht.ASTC12x10Unorm;break;case HM:o=s===Dr?ht.ASTC12x12UnormSRGB:ht.ASTC12x12Unorm;break;default:console.error("WebGPURenderer: Unsupported texture format.",i)}else switch(i){case rg:switch(n){case JA:o=ht.RGBA8Snorm;break;case ZA:o=ht.RGBA16Sint;break;case ig:o=ht.RGBA16Uint;break;case ja:o=ht.RGBA32Uint;break;case wo:o=ht.RGBA32Sint;break;case od:o=s===Dr?ht.RGBA8UnormSRGB:ht.RGBA8Unorm;break;case zu:o=ht.RGBA16Float;break;case fl:o=ht.RGBA32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBAFormat.",n)}break;case EM:switch(n){case XU:o=ht.RGB9E5UFloat;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBFormat.",n)}break;case wM:switch(n){case JA:o=ht.R8Snorm;break;case ZA:o=ht.R16Sint;break;case ig:o=ht.R16Uint;break;case ja:o=ht.R32Uint;break;case wo:o=ht.R32Sint;break;case od:o=ht.R8Unorm;break;case zu:o=ht.R16Float;break;case fl:o=ht.R32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RedFormat.",n)}break;case ey:switch(n){case JA:o=ht.RG8Snorm;break;case ZA:o=ht.RG16Sint;break;case ig:o=ht.RG16Uint;break;case ja:o=ht.RG32Uint;break;case wo:o=ht.RG32Sint;break;case od:o=ht.RG8Unorm;break;case zu:o=ht.RG16Float;break;case fl:o=ht.RG32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RGFormat.",n)}break;case Ip:switch(n){case ig:o=ht.Depth16Unorm;break;case ja:o=ht.Depth24Plus;break;case fl:o=ht.Depth32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with DepthFormat.",n)}break;case ng:switch(n){case $A:o=ht.Depth24PlusStencil8;break;case fl:e&&e.features.has(SR.Depth32FloatStencil8)===!1&&console.error('WebGPURenderer: Depth textures with DepthStencilFormat + FloatType can only be used with the "depth32float-stencil8" GPU feature.'),o=ht.Depth32FloatStencil8;break;default:console.error("WebGPURenderer: Unsupported texture type with DepthStencilFormat.",n)}break;case CM:switch(n){case wo:o=ht.R32Sint;break;case ja:o=ht.R32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RedIntegerFormat.",n)}break;case SM:switch(n){case wo:o=ht.RG32Sint;break;case ja:o=ht.RG32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RGIntegerFormat.",n)}break;case TM:switch(n){case wo:o=ht.RGBA32Sint;break;case ja:o=ht.RGBA32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBAIntegerFormat.",n)}break;default:console.error("WebGPURenderer: Unsupported texture format.",i)}return o}const CAe=/^[fn]*\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)\s*[\-\>]*\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/i,SAe=/([a-z_0-9]+)\s*:\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/ig,qz={f32:"float",i32:"int",u32:"uint",bool:"bool","vec2<f32>":"vec2","vec2<i32>":"ivec2","vec2<u32>":"uvec2","vec2<bool>":"bvec2",vec2f:"vec2",vec2i:"ivec2",vec2u:"uvec2",vec2b:"bvec2","vec3<f32>":"vec3","vec3<i32>":"ivec3","vec3<u32>":"uvec3","vec3<bool>":"bvec3",vec3f:"vec3",vec3i:"ivec3",vec3u:"uvec3",vec3b:"bvec3","vec4<f32>":"vec4","vec4<i32>":"ivec4","vec4<u32>":"uvec4","vec4<bool>":"bvec4",vec4f:"vec4",vec4i:"ivec4",vec4u:"uvec4",vec4b:"bvec4","mat2x2<f32>":"mat2",mat2x2f:"mat2","mat3x3<f32>":"mat3",mat3x3f:"mat3","mat4x4<f32>":"mat4",mat4x4f:"mat4",sampler:"sampler",texture_1d:"texture",texture_2d:"texture",texture_2d_array:"texture",texture_multisampled_2d:"cubeTexture",texture_depth_2d:"depthTexture",texture_3d:"texture3D",texture_cube:"cubeTexture",texture_cube_array:"cubeTexture",texture_storage_1d:"storageTexture",texture_storage_2d:"storageTexture",texture_storage_2d_array:"storageTexture",texture_storage_3d:"storageTexture"},TAe=r=>{r=r.trim();const e=r.match(CAe);if(e!==null&&e.length===4){const i=e[2],n=[];let s=null;for(;(s=SAe.exec(i))!==null;)n.push({name:s[1],type:s[2]});const o=[];for(let h=0;h<n.length;h++){const{name:p,type:f}=n[h];let m=f;m.startsWith("ptr")?m="pointer":(m.startsWith("texture")&&(m=f.split("<")[0]),m=qz[m]),o.push(new UR(m,p))}const l=r.substring(e[0].length),u=e[3]||"void",c=e[1]!==void 0?e[1]:"";return{type:qz[u]||u,inputs:o,name:c,inputsCode:i,blockCode:l,outputType:u}}else throw new Error("FunctionNode: Function is not a WGSL code.")};class MAe extends jR{constructor(e){const{type:i,inputs:n,name:s,inputsCode:o,blockCode:l,outputType:u}=TAe(e);super(i,n,s),this.inputsCode=o,this.blockCode=l,this.outputType=u}getCode(e=this.name){const i=this.outputType!=="void"?"-> "+this.outputType:"";return`fn ${e} ( ${this.inputsCode.trim()} ) ${i}`+this.blockCode}}class RAe extends Mz{parseFunction(e){return new MAe(e)}}const zg=self.GPUShaderStage,P_={vertex:zg?zg.VERTEX:1,fragment:zg?zg.FRAGMENT:2,compute:zg?zg.COMPUTE:4},Xz={instance:!0,swizzleAssign:!1,storageBuffer:!0},IAe={"^^":"tsl_xor"},BAe={float:"f32",int:"i32",uint:"u32",bool:"bool",color:"vec3<f32>",vec2:"vec2<f32>",ivec2:"vec2<i32>",uvec2:"vec2<u32>",bvec2:"vec2<bool>",vec3:"vec3<f32>",ivec3:"vec3<i32>",uvec3:"vec3<u32>",bvec3:"vec3<bool>",vec4:"vec4<f32>",ivec4:"vec4<i32>",uvec4:"vec4<u32>",bvec4:"vec4<bool>",mat2:"mat2x2<f32>",mat3:"mat3x3<f32>",mat4:"mat4x4<f32>"},ah={tsl_xor:new oo("fn tsl_xor( a : bool, b : bool ) -> bool { return ( a || b ) && !( a && b ); }"),mod_float:new oo("fn tsl_mod_float( x : f32, y : f32 ) -> f32 { return x - y * floor( x / y ); }"),mod_vec2:new oo("fn tsl_mod_vec2( x : vec2f, y : vec2f ) -> vec2f { return x - y * floor( x / y ); }"),mod_vec3:new oo("fn tsl_mod_vec3( x : vec3f, y : vec3f ) -> vec3f { return x - y * floor( x / y ); }"),mod_vec4:new oo("fn tsl_mod_vec4( x : vec4f, y : vec4f ) -> vec4f { return x - y * floor( x / y ); }"),equals_bool:new oo("fn tsl_equals_bool( a : bool, b : bool ) -> bool { return a == b; }"),equals_bvec2:new oo("fn tsl_equals_bvec2( a : vec2f, b : vec2f ) -> vec2<bool> { return vec2<bool>( a.x == b.x, a.y == b.y ); }"),equals_bvec3:new oo("fn tsl_equals_bvec3( a : vec3f, b : vec3f ) -> vec3<bool> { return vec3<bool>( a.x == b.x, a.y == b.y, a.z == b.z ); }"),equals_bvec4:new oo("fn tsl_equals_bvec4( a : vec4f, b : vec4f ) -> vec4<bool> { return vec4<bool>( a.x == b.x, a.y == b.y, a.z == b.z, a.w == b.w ); }"),repeatWrapping:new oo(`
fn tsl_repeatWrapping( uv : vec2<f32>, dimension : vec2<u32> ) -> vec2<u32> {

	let uvScaled = vec2<u32>( uv * vec2<f32>( dimension ) );

	return ( ( uvScaled % dimension ) + dimension ) % dimension;

}
`),biquadraticTexture:new oo(`
fn tsl_biquadraticTexture( map : texture_2d<f32>, coord : vec2f, level : i32 ) -> vec4f {

	let iRes = vec2i( textureDimensions( map, level ) );
	let res = vec2f( iRes );

	let uvScaled = coord * res;
	let uvWrapping = ( ( uvScaled % res ) + res ) % res;

	// https://www.shadertoy.com/view/WtyXRy

	let uv = uvWrapping - 0.5;
	let iuv = floor( uv );
	let f = fract( uv );

	let rg1 = textureLoad( map, vec2i( iuv + vec2( 0.5, 0.5 ) ) % iRes, level );
	let rg2 = textureLoad( map, vec2i( iuv + vec2( 1.5, 0.5 ) ) % iRes, level );
	let rg3 = textureLoad( map, vec2i( iuv + vec2( 0.5, 1.5 ) ) % iRes, level );
	let rg4 = textureLoad( map, vec2i( iuv + vec2( 1.5, 1.5 ) ) % iRes, level );

	return mix( mix( rg1, rg2, f.x ), mix( rg3, rg4, f.x ), f.y );

}
`)},Uy={dFdx:"dpdx",dFdy:"- dpdy",mod_float:"tsl_mod_float",mod_vec2:"tsl_mod_vec2",mod_vec3:"tsl_mod_vec3",mod_vec4:"tsl_mod_vec4",equals_bool:"tsl_equals_bool",equals_bvec2:"tsl_equals_bvec2",equals_bvec3:"tsl_equals_bvec3",equals_bvec4:"tsl_equals_bvec4",inversesqrt:"inverseSqrt",bitcast:"bitcast<f32>"};/Windows/g.test(navigator.userAgent)&&(ah.pow_float=new oo("fn tsl_pow_float( a : f32, b : f32 ) -> f32 { return select( -pow( -a, b ), pow( a, b ), a > 0.0 ); }"),ah.pow_vec2=new oo("fn tsl_pow_vec2( a : vec2f, b : vec2f ) -> vec2f { return vec2f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ) ); }",[ah.pow_float]),ah.pow_vec3=new oo("fn tsl_pow_vec3( a : vec3f, b : vec3f ) -> vec3f { return vec3f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ), tsl_pow_float( a.z, b.z ) ); }",[ah.pow_float]),ah.pow_vec4=new oo("fn tsl_pow_vec4( a : vec4f, b : vec4f ) -> vec4f { return vec4f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ), tsl_pow_float( a.z, b.z ), tsl_pow_float( a.w, b.w ) ); }",[ah.pow_float]),Uy.pow_float="tsl_pow_float",Uy.pow_vec2="tsl_pow_vec2",Uy.pow_vec3="tsl_pow_vec3",Uy.pow_vec4="tsl_pow_vec4");let Yz="";/Firefox|Deno/g.test(navigator.userAgent)!==!0&&(Yz+=`diagnostic( off, derivative_uniformity );
`);class NAe extends Cz{constructor(e,i){super(e,i,new RAe),this.uniformGroups={},this.builtins={},this.directives={},this.scopedArrays=new Map}needsToWorkingColorSpace(e){return e.isVideoTexture===!0&&e.colorSpace!==Bp}_generateTextureSample(e,i,n,s,o=this.shaderStage){return o==="fragment"?s?`textureSample( ${i}, ${i}_sampler, ${n}, ${s} )`:`textureSample( ${i}, ${i}_sampler, ${n} )`:this.isFilteredTexture(e)?this.generateFilteredTexture(e,i,n):this.generateTextureLod(e,i,n,"0")}_generateVideoSample(e,i,n=this.shaderStage){if(n==="fragment")return`textureSampleBaseClampToEdge( ${e}, ${e}_sampler, vec2<f32>( ${i}.x, 1.0 - ${i}.y ) )`;console.error(`WebGPURenderer: THREE.VideoTexture does not support ${n} shader.`)}_generateTextureSampleLevel(e,i,n,s,o,l=this.shaderStage){return l==="fragment"&&this.isUnfilterable(e)===!1?`textureSampleLevel( ${i}, ${i}_sampler, ${n}, ${s} )`:this.isFilteredTexture(e)?this.generateFilteredTexture(e,i,n,s):this.generateTextureLod(e,i,n,s)}generateFilteredTexture(e,i,n,s="0"){return this._include("biquadraticTexture"),`tsl_biquadraticTexture( ${i}, ${n}, i32( ${s} ) )`}generateTextureLod(e,i,n,s="0"){this._include("repeatWrapping");const o=e.isMultisampleRenderTargetTexture===!0?`textureDimensions( ${i} )`:`textureDimensions( ${i}, 0 )`;return`textureLoad( ${i}, tsl_repeatWrapping( ${n}, ${o} ), i32( ${s} ) )`}generateTextureLoad(e,i,n,s,o="0u"){return s?`textureLoad( ${i}, ${n}, ${s}, ${o} )`:`textureLoad( ${i}, ${n}, ${o} )`}generateTextureStore(e,i,n,s){return`textureStore( ${i}, ${n}, ${s} )`}isUnfilterable(e){return this.getComponentTypeFromTexture(e)!=="float"||!this.isAvailable("float32Filterable")&&e.isDataTexture===!0&&e.type===fl||e.isMultisampleRenderTargetTexture===!0}generateTexture(e,i,n,s,o=this.shaderStage){let l=null;return e.isVideoTexture===!0?l=this._generateVideoSample(i,n,o):this.isUnfilterable(e)?l=this.generateTextureLod(e,i,n,"0",s,o):l=this._generateTextureSample(e,i,n,s,o),l}generateTextureGrad(e,i,n,s,o,l=this.shaderStage){if(l==="fragment")return`textureSampleGrad( ${i}, ${i}_sampler, ${n},  ${s[0]}, ${s[1]} )`;console.error(`WebGPURenderer: THREE.TextureNode.gradient() does not support ${l} shader.`)}generateTextureCompare(e,i,n,s,o,l=this.shaderStage){if(l==="fragment")return`textureSampleCompare( ${i}, ${i}_sampler, ${n}, ${s} )`;console.error(`WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ${l} shader.`)}generateTextureLevel(e,i,n,s,o,l=this.shaderStage){let u=null;return e.isVideoTexture===!0?u=this._generateVideoSample(i,n,l):u=this._generateTextureSampleLevel(e,i,n,s,o,l),u}generateTextureBias(e,i,n,s,o,l=this.shaderStage){if(l==="fragment")return`textureSampleBias( ${i}, ${i}_sampler, ${n}, ${s} )`;console.error(`WebGPURenderer: THREE.TextureNode.biasNode does not support ${l} shader.`)}getPropertyName(e,i=this.shaderStage){if(e.isNodeVarying===!0&&e.needsInterpolation===!0){if(i==="vertex")return`varyings.${e.name}`}else if(e.isNodeUniform===!0){const n=e.name,s=e.type;return s==="texture"||s==="cubeTexture"||s==="storageTexture"||s==="texture3D"?n:s==="buffer"||s==="storageBuffer"||s==="indirectStorageBuffer"?`NodeBuffer_${e.id}.${n}`:e.groupNode.name+"."+n}return super.getPropertyName(e)}getOutputStructName(){return"output"}_getUniformGroupCount(e){return Object.keys(this.uniforms[e]).length}getFunctionOperator(e){const i=IAe[e];return i!==void 0?(this._include(i),i):null}getStorageAccess(e){if(e.isStorageTextureNode)switch(e.access){case lz.ReadOnly:return"read";case lz.WriteOnly:return"write";default:return"read_write"}else switch(e.access){case CR.Storage:return"read_write";case CR.ReadOnlyStorage:return"read";default:return"write"}}getUniformFromNode(e,i,n,s=null){const o=super.getUniformFromNode(e,i,n,s),l=this.getDataFromNode(e,n,this.globalCache);if(l.uniformGPU===void 0){let u;const c=e.groupNode,h=c.name,p=this.getBindGroupArray(h,n);if(i==="texture"||i==="cubeTexture"||i==="storageTexture"||i==="texture3D"){let f=null;if(i==="texture"||i==="storageTexture"?f=new D_(o.name,o.node,c,e.access?e.access:null):i==="cubeTexture"?f=new kz(o.name,o.node,c,e.access?e.access:null):i==="texture3D"&&(f=new Fz(o.name,o.node,c,e.access?e.access:null)),f.store=e.isStorageTextureNode===!0,f.setVisibility(P_[n]),n==="fragment"&&this.isUnfilterable(e.value)===!1&&f.store===!1){const m=new AAe(`${o.name}_sampler`,o.node,c);m.setVisibility(P_[n]),p.push(m,f),u=[m,f]}else p.push(f),u=[f]}else if(i==="buffer"||i==="storageBuffer"||i==="indirectStorageBuffer"){const f=i==="buffer"?Oz:xAe,m=new f(e,c);m.setVisibility(P_[n]),p.push(m),u=m}else{const f=this.uniformGroups[n]||(this.uniformGroups[n]={});let m=f[h];m===void 0&&(m=new Pz(h,c),m.setVisibility(P_[n]),f[h]=m,p.push(m)),u=this.getNodeUniform(o,i),m.addUniform(u)}l.uniformGPU=u}return o}getBuiltin(e,i,n,s=this.shaderStage){const o=this.builtins[s]||(this.builtins[s]=new Map);return o.has(e)===!1&&o.set(e,{name:e,property:i,type:n}),i}hasBuiltin(e,i=this.shaderStage){return this.builtins[i]!==void 0&&this.builtins[i].has(e)}getVertexIndex(){return this.shaderStage==="vertex"?this.getBuiltin("vertex_index","vertexIndex","u32","attribute"):"vertexIndex"}buildFunctionCode(e){const i=e.layout,n=this.flowShaderNode(e),s=[];for(const l of i.inputs)s.push(l.name+" : "+this.getType(l.type));let o=`fn ${i.name}( ${s.join(", ")} ) -> ${this.getType(i.type)} {
${n.vars}
${n.code}
`;return n.result&&(o+=`	return ${n.result};
`),o+=`
}
`,o}getInstanceIndex(){return this.shaderStage==="vertex"?this.getBuiltin("instance_index","instanceIndex","u32","attribute"):"instanceIndex"}getInvocationLocalIndex(){return this.getBuiltin("local_invocation_index","invocationLocalIndex","u32","attribute")}getSubgroupSize(){return this.enableSubGroups(),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute")}getInvocationSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_invocation_id","invocationSubgroupIndex","u32","attribute")}getSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_id","subgroupIndex","u32","attribute")}getDrawIndex(){return null}getFrontFacing(){return this.getBuiltin("front_facing","isFront","bool")}getFragCoord(){return this.getBuiltin("position","fragCoord","vec4<f32>")+".xy"}getFragDepth(){return"output."+this.getBuiltin("frag_depth","depth","f32","output")}isFlipY(){return!1}enableDirective(e,i=this.shaderStage){(this.directives[i]||(this.directives[i]=new Set)).add(e)}getDirectives(e){const i=[],n=this.directives[e];if(n!==void 0)for(const s of n)i.push(`enable ${s};`);return i.join(`
`)}enableSubGroups(){this.enableDirective("subgroups")}enableSubgroupsF16(){this.enableDirective("subgroups-f16")}enableClipDistances(){this.enableDirective("clip_distances")}enableShaderF16(){this.enableDirective("f16")}enableDualSourceBlending(){this.enableDirective("dual_source_blending")}getBuiltins(e){const i=[],n=this.builtins[e];if(n!==void 0)for(const{name:s,property:o,type:l}of n.values())i.push(`@builtin( ${s} ) ${o} : ${l}`);return i.join(`,
	`)}getScopedArray(e,i,n,s){return this.scopedArrays.has(e)===!1&&this.scopedArrays.set(e,{name:e,scope:i,bufferType:n,bufferCount:s}),e}getScopedArrays(e){if(e!=="compute")return;const i=[];for(const{name:n,scope:s,bufferType:o,bufferCount:l}of this.scopedArrays.values()){const u=this.getType(o);i.push(`var<${s}> ${n}: array< ${u}, ${l} >;`)}return i.join(`
`)}getAttributes(e){const i=[];if(e==="compute"&&(this.getBuiltin("global_invocation_id","id","vec3<u32>","attribute"),this.getBuiltin("workgroup_id","workgroupId","vec3<u32>","attribute"),this.getBuiltin("local_invocation_id","localId","vec3<u32>","attribute"),this.getBuiltin("num_workgroups","numWorkgroups","vec3<u32>","attribute"),this.renderer.hasFeature("subgroups")&&(this.enableDirective("subgroups",e),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute"))),e==="vertex"||e==="compute"){const n=this.getBuiltins("attribute");n&&i.push(n);const s=this.getAttributesArray();for(let o=0,l=s.length;o<l;o++){const u=s[o],c=u.name,h=this.getType(u.type);i.push(`@location( ${o} ) ${c} : ${h}`)}}return i.join(`,
	`)}getStructMembers(e){const i=[],n=e.getMemberTypes();for(let o=0;o<n.length;o++){const l=n[o];i.push(`	@location( ${o} ) m${o} : ${l}<f32>`)}const s=this.getBuiltins("output");return s&&i.push("	"+s),i.join(`,
`)}getStructs(e){const i=[],n=this.structs[e];for(let s=0,o=n.length;s<o;s++){const l=n[s],u=l.name;let c=`struct ${u} {
`;c+=this.getStructMembers(l),c+=`
}`,i.push(c),i.push(`
var<private> output : ${u};

`)}return i.join(`

`)}getVar(e,i){return`var ${i} : ${this.getType(e)}`}getVars(e){const i=[],n=this.vars[e];if(n!==void 0)for(const s of n)i.push(`	${this.getVar(s.type,s.name)};`);return`
${i.join(`
`)}
`}getVaryings(e){const i=[];if(e==="vertex"&&this.getBuiltin("position","Vertex","vec4<f32>","vertex"),e==="vertex"||e==="fragment"){const o=this.varyings,l=this.vars[e];for(let u=0;u<o.length;u++){const c=o[u];if(c.needsInterpolation){let h=`@location( ${u} )`;/^(int|uint|ivec|uvec)/.test(c.type)&&(h+=" @interpolate( flat )"),i.push(`${h} ${c.name} : ${this.getType(c.type)}`)}else e==="vertex"&&l.includes(c)===!1&&l.push(c)}}const n=this.getBuiltins(e);n&&i.push(n);const s=i.join(`,
	`);return e==="vertex"?this._getWGSLStruct("VaryingsStruct","	"+s):s}getUniforms(e){const i=this.uniforms[e],n=[],s=[],o=[],l={};for(const c of i){const h=c.groupNode.name,p=this.bindingsIndexes[h];if(c.type==="texture"||c.type==="cubeTexture"||c.type==="storageTexture"||c.type==="texture3D"){const f=c.node.value;e==="fragment"&&this.isUnfilterable(f)===!1&&c.node.isStorageTextureNode!==!0&&(f.isDepthTexture===!0&&f.compareFunction!==null?n.push(`@binding( ${p.binding++} ) @group( ${p.group} ) var ${c.name}_sampler : sampler_comparison;`):n.push(`@binding( ${p.binding++} ) @group( ${p.group} ) var ${c.name}_sampler : sampler;`));let m,g="";if(f.isMultisampleRenderTargetTexture===!0&&(g="_multisampled"),f.isCubeTexture===!0)m="texture_cube<f32>";else if(f.isDataArrayTexture===!0||f.isCompressedArrayTexture===!0)m="texture_2d_array<f32>";else if(f.isDepthTexture===!0)m=`texture_depth${g}_2d`;else if(f.isVideoTexture===!0)m="texture_external";else if(f.isData3DTexture===!0)m="texture_3d<f32>";else if(c.node.isStorageTextureNode===!0){const y=YR(f),x=this.getStorageAccess(c.node);m=`texture_storage_2d<${y}, ${x}>`}else{const y=this.getComponentTypeFromTexture(f).charAt(0);m=`texture${g}_2d<${y}32>`}n.push(`@binding( ${p.binding++} ) @group( ${p.group} ) var ${c.name} : ${m};`)}else if(c.type==="buffer"||c.type==="storageBuffer"||c.type==="indirectStorageBuffer"){const f=c.node,m=this.getType(f.bufferType),g=f.bufferCount,y=g>0&&c.type==="buffer"?", "+g:"",x=f.isAtomic?`atomic<${m}>`:`${m}`,v=`	${c.name} : array< ${x}${y} >
`,_=f.isStorageBufferNode?`storage, ${this.getStorageAccess(f)}`:"uniform";s.push(this._getWGSLStructBinding("NodeBuffer_"+f.id,v,_,p.binding++,p.group))}else{const f=this.getType(this.getVectorType(c.type)),m=c.groupNode.name;(l[m]||(l[m]={index:p.binding++,id:p.group,snippets:[]})).snippets.push(`	${c.name} : ${f}`)}}for(const c in l){const h=l[c];o.push(this._getWGSLStructBinding(c,h.snippets.join(`,
`),"uniform",h.index,h.id))}let u=n.join(`
`);return u+=s.join(`
`),u+=o.join(`
`),u}buildCode(){const e=this.material!==null?{fragment:{},vertex:{}}:{compute:{}};this.sortBindingGroups();for(const i in e){const n=e[i];n.uniforms=this.getUniforms(i),n.attributes=this.getAttributes(i),n.varyings=this.getVaryings(i),n.structs=this.getStructs(i),n.vars=this.getVars(i),n.codes=this.getCodes(i),n.directives=this.getDirectives(i),n.scopedArrays=this.getScopedArrays(i);let s=`// code

`;s+=this.flowCode[i];const o=this.flowNodes[i],l=o[o.length-1],u=l.outputNode,c=u!==void 0&&u.isOutputStructNode===!0;for(const h of o){const p=this.getFlowData(h),f=h.name;if(f&&(s.length>0&&(s+=`
`),s+=`	// flow -> ${f}
	`),s+=`${p.code}
	`,h===l&&i!=="compute"){if(s+=`// result

	`,i==="vertex")s+=`varyings.Vertex = ${p.result};`;else if(i==="fragment")if(c)n.returnType=u.nodeType,s+=`return ${p.result};`;else{let m="	@location(0) color: vec4<f32>";const g=this.getBuiltins("output");g&&(m+=`,
	`+g),n.returnType="OutputStruct",n.structs+=this._getWGSLStruct("OutputStruct",m),n.structs+=`
var<private> output : OutputStruct;

`,s+=`output.color = ${p.result};

	return output;`}}}n.flow=s}this.material!==null?(this.vertexShader=this._getWGSLVertexCode(e.vertex),this.fragmentShader=this._getWGSLFragmentCode(e.fragment)):this.computeShader=this._getWGSLComputeCode(e.compute,(this.object.workgroupSize||[64]).join(", "))}getMethod(e,i=null){let n;return i!==null&&(n=this._getWGSLMethod(e+"_"+i)),n===void 0&&(n=this._getWGSLMethod(e)),n||e}getType(e){return BAe[e]||e}isAvailable(e){let i=Xz[e];return i===void 0&&(e==="float32Filterable"&&(i=this.renderer.hasFeature("float32-filterable")),Xz[e]=i),i}_getWGSLMethod(e){return ah[e]!==void 0&&this._include(e),Uy[e]}_include(e){const i=ah[e];return i.build(this),this.currentFunctionNode!==null&&this.currentFunctionNode.includes.push(i),i}_getWGSLVertexCode(e){return`${this.getSignature()}
// directives
${e.directives}

// uniforms
${e.uniforms}

// varyings
${e.varyings}
var<private> varyings : VaryingsStruct;

// codes
${e.codes}

@vertex
fn main( ${e.attributes} ) -> VaryingsStruct {

	// vars
	${e.vars}

	// flow
	${e.flow}

	return varyings;

}
`}_getWGSLFragmentCode(e){return`${this.getSignature()}
// global
${Yz}

// uniforms
${e.uniforms}

// structs
${e.structs}

// codes
${e.codes}

@fragment
fn main( ${e.varyings} ) -> ${e.returnType} {

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}_getWGSLComputeCode(e,i){return`${this.getSignature()}
// directives
${e.directives}

// system
var<private> instanceIndex : u32;

// locals
${e.scopedArrays}

// uniforms
${e.uniforms}

// codes
${e.codes}

@compute @workgroup_size( ${i} )
fn main( ${e.attributes} ) {

	// system
	instanceIndex = id.x + id.y * numWorkgroups.x * u32(${i}) + id.z * numWorkgroups.x * numWorkgroups.y * u32(${i});

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}_getWGSLStruct(e,i){return`
struct ${e} {
${i}
};`}_getWGSLStructBinding(e,i,n,s=0,o=0){const l=e+"Struct";return`${this._getWGSLStruct(l,i)}
@binding( ${s} ) @group( ${o} )
var<${n}> ${e} : ${l};`}}class LAe{constructor(e){this.backend=e}getCurrentDepthStencilFormat(e){let i;return e.depthTexture!==null?i=this.getTextureFormatGPU(e.depthTexture):e.depth&&e.stencil?i=ht.Depth24PlusStencil8:e.depth&&(i=ht.Depth24Plus),i}getTextureFormatGPU(e){return this.backend.get(e).format}getCurrentColorFormat(e){let i;return e.textures!==null?i=this.getTextureFormatGPU(e.textures[0]):i=this.getPreferredCanvasFormat(),i}getCurrentColorSpace(e){return e.textures!==null?e.textures[0].colorSpace:this.backend.renderer.outputColorSpace}getPrimitiveTopology(e,i){if(e.isPoints)return Dg.PointList;if(e.isLineSegments||e.isMesh&&i.wireframe===!0)return Dg.LineList;if(e.isLine)return Dg.LineStrip;if(e.isMesh)return Dg.TriangleList}getSampleCount(e){let i=1;return e>1&&(i=Math.pow(2,Math.floor(Math.log2(e))),i===2&&(i=4)),i}getSampleCountRenderContext(e){return e.textures!==null?this.getSampleCount(e.sampleCount):this.getSampleCount(this.backend.renderer.samples)}getPreferredCanvasFormat(){return navigator.userAgent.includes("Quest")?ht.BGRA8Unorm:navigator.gpu.getPreferredCanvasFormat()}}const DAe=new Map([[Int8Array,["sint8","snorm8"]],[Uint8Array,["uint8","unorm8"]],[Int16Array,["sint16","snorm16"]],[Uint16Array,["uint16","unorm16"]],[Int32Array,["sint32","snorm32"]],[Uint32Array,["uint32","unorm32"]],[Float32Array,["float32"]]]),OAe=new Map([[B5,["float16"]]]),PAe=new Map([[Int32Array,"sint32"],[Int16Array,"sint32"],[Uint32Array,"uint32"],[Uint16Array,"uint32"],[Float32Array,"float32"]]);class kAe{constructor(e){this.backend=e}createAttribute(e,i){const n=this._getBufferAttribute(e),s=this.backend,o=s.get(n);let l=o.buffer;if(l===void 0){const u=s.device;let c=n.array;if(e.normalized===!1&&(c.constructor===Int16Array||c.constructor===Uint16Array)){const p=new Uint32Array(c.length);for(let f=0;f<c.length;f++)p[f]=c[f];c=p}if(n.array=c,(n.isStorageBufferAttribute||n.isStorageInstancedBufferAttribute)&&n.itemSize===3){c=new c.constructor(n.count*4);for(let p=0;p<n.count;p++)c.set(n.array.subarray(p*3,p*3+3),p*4);n.itemSize=4,n.array=c}const h=c.byteLength+(4-c.byteLength%4)%4;l=u.createBuffer({label:n.name,size:h,usage:i,mappedAtCreation:!0}),new c.constructor(l.getMappedRange()).set(c),l.unmap(),o.buffer=l}}updateAttribute(e){const i=this._getBufferAttribute(e),n=this.backend,s=n.device,o=n.get(i).buffer,l=i.array,u=i.updateRanges;if(u.length===0)s.queue.writeBuffer(o,0,l,0);else{for(let c=0,h=u.length;c<h;c++){const p=u[c];s.queue.writeBuffer(o,0,l,p.start*l.BYTES_PER_ELEMENT,p.count*l.BYTES_PER_ELEMENT)}i.clearUpdateRanges()}}createShaderVertexBuffers(e){const i=e.getAttributes(),n=new Map;for(let s=0;s<i.length;s++){const o=i[s],l=o.array.BYTES_PER_ELEMENT,u=this._getBufferAttribute(o);let c=n.get(u);if(c===void 0){let f,m;o.isInterleavedBufferAttribute===!0?(f=o.data.stride*l,m=o.data.isInstancedInterleavedBuffer?C_.Instance:C_.Vertex):(f=o.itemSize*l,m=o.isInstancedBufferAttribute?C_.Instance:C_.Vertex),o.normalized===!1&&(o.array.constructor===Int16Array||o.array.constructor===Uint16Array)&&(f=4),c={arrayStride:f,attributes:[],stepMode:m},n.set(u,c)}const h=this._getVertexFormat(o),p=o.isInterleavedBufferAttribute===!0?o.offset*l:0;c.attributes.push({shaderLocation:s,offset:p,format:h})}return Array.from(n.values())}destroyAttribute(e){const i=this.backend;i.get(this._getBufferAttribute(e)).buffer.destroy(),i.delete(e)}async getArrayBufferAsync(e){const i=this.backend,n=i.device,s=i.get(this._getBufferAttribute(e)).buffer,o=s.size,l=n.createBuffer({label:e.name,size:o,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),u=n.createCommandEncoder({});u.copyBufferToBuffer(s,0,l,0,o),l.unmap();const c=u.finish();return n.queue.submit([c]),await l.mapAsync(GPUMapMode.READ),l.getMappedRange()}_getVertexFormat(e){const{itemSize:i,normalized:n}=e,s=e.array.constructor,o=e.constructor;let l;if(i==1)l=PAe.get(s);else{const u=(OAe.get(o)||DAe.get(s))[n?1:0];if(u){const c=s.BYTES_PER_ELEMENT*i,h=Math.floor((c+3)/4)*4/s.BYTES_PER_ELEMENT;if(h%1)throw new Error("THREE.WebGPUAttributeUtils: Bad vertex format item size.");l=`${u}x${h}`}}return l||console.error("THREE.WebGPUAttributeUtils: Vertex format not supported yet."),l}_getBufferAttribute(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}}class FAe{constructor(e){this.backend=e,this.bindGroupLayoutCache=new WeakMap}createBindingsLayout(e){const i=this.backend.device,n=[];let s=0;for(const o of e.bindings){const l={binding:s++,visibility:o.visibility};if(o.isUniformBuffer||o.isStorageBuffer){const u={};o.isStorageBuffer&&(u.type=o.access),l.buffer=u}else if(o.isSampler){const u={};o.texture.isDepthTexture&&o.texture.compareFunction!==null&&(u.type="comparison"),l.sampler=u}else if(o.isSampledTexture&&o.texture.isVideoTexture)l.externalTexture={};else if(o.isSampledTexture&&o.store){const u=this.backend.get(o.texture).texture.format,c=o.access;l.storageTexture={format:u,access:c}}else if(o.isSampledTexture){const u={};if(o.texture.isMultisampleRenderTargetTexture===!0&&(u.multisampled=!0),o.texture.isDepthTexture)u.sampleType=Py.Depth;else if(o.texture.isDataTexture||o.texture.isDataArrayTexture||o.texture.isData3DTexture){const c=o.texture.type;c===wo?u.sampleType=Py.SInt:c===ja?u.sampleType=Py.UInt:c===fl&&(this.backend.hasFeature("float32-filterable")?u.sampleType=Py.Float:u.sampleType=Py.UnfilterableFloat)}o.isSampledCubeTexture?u.viewDimension=Fl.Cube:o.texture.isDataArrayTexture||o.texture.isCompressedArrayTexture?u.viewDimension=Fl.TwoDArray:o.isSampledTexture3D&&(u.viewDimension=Fl.ThreeD),l.texture=u}else console.error(`WebGPUBindingUtils: Unsupported binding "${o}".`);n.push(l)}return i.createBindGroupLayout({entries:n})}createBindings(e){const{backend:i,bindGroupLayoutCache:n}=this,s=i.get(e);let o=n.get(e.bindingsReference);o===void 0&&(o=this.createBindingsLayout(e),n.set(e.bindingsReference,o));const l=this.createBindGroup(e,o);s.layout=o,s.group=l}updateBinding(e){const i=this.backend,n=i.device,s=e.buffer,o=i.get(e).buffer;n.queue.writeBuffer(o,0,s,0)}createBindGroup(e,i){const n=this.backend,s=n.device;let o=0;const l=[];for(const u of e.bindings){if(u.isUniformBuffer){const c=n.get(u);if(c.buffer===void 0){const h=u.byteLength,p=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,f=s.createBuffer({label:"bindingBuffer_"+u.name,size:h,usage:p});c.buffer=f}l.push({binding:o,resource:{buffer:c.buffer}})}else if(u.isStorageBuffer){const c=n.get(u);if(c.buffer===void 0){const h=u.attribute;c.buffer=n.get(h).buffer}l.push({binding:o,resource:{buffer:c.buffer}})}else if(u.isSampler){const c=n.get(u.texture);l.push({binding:o,resource:c.sampler})}else if(u.isSampledTexture){const c=n.get(u.texture);let h;if(c.externalTexture!==void 0)h=s.importExternalTexture({source:c.externalTexture});else{const p=u.store?1:c.texture.mipLevelCount,f=`view-${c.texture.width}-${c.texture.height}-${p}`;if(h=c[f],h===void 0){const m=Cge.All;let g;u.isSampledCubeTexture?g=Fl.Cube:u.isSampledTexture3D?g=Fl.ThreeD:u.texture.isDataArrayTexture||u.texture.isCompressedArrayTexture?g=Fl.TwoDArray:g=Fl.TwoD,h=c[f]=c.texture.createView({aspect:m,dimension:g,mipLevelCount:p})}}l.push({binding:o,resource:h})}o++}return s.createBindGroup({label:"bindGroup_"+e.name,layout:i,entries:l})}}class UAe{constructor(e){this.backend=e}_getSampleCount(e){return this.backend.utils.getSampleCountRenderContext(e)}createRenderPipeline(e,i){const{object:n,material:s,geometry:o,pipeline:l}=e,{vertexProgram:u,fragmentProgram:c}=l,h=this.backend,p=h.device,f=h.utils,m=h.get(l),g=[];for(const G of e.getBindings()){const z=h.get(G);g.push(z.layout)}const y=h.attributeUtils.createShaderVertexBuffers(e);let x;s.transparent===!0&&s.blending!==Jm&&(x=this._getBlending(s));let v={};s.stencilWrite===!0&&(v={compare:this._getStencilCompare(s),failOp:this._getStencilOperation(s.stencilFail),depthFailOp:this._getStencilOperation(s.stencilZFail),passOp:this._getStencilOperation(s.stencilZPass)});const _=this._getColorWriteMask(s),T=[];if(e.context.textures!==null){const G=e.context.textures;for(let z=0;z<G.length;z++){const $=f.getTextureFormatGPU(G[z]);T.push({format:$,blend:x,writeMask:_})}}else{const G=f.getCurrentColorFormat(e.context);T.push({format:G,blend:x,writeMask:_})}const w=h.get(u).module,S=h.get(c).module,R=this._getPrimitiveState(n,o,s),B=this._getDepthCompare(s),I=f.getCurrentDepthStencilFormat(e.context),D=this._getSampleCount(e.context),L={label:`renderPipeline_${s.name||s.type}_${s.id}`,vertex:Object.assign({},w,{buffers:y}),fragment:Object.assign({},S,{targets:T}),primitive:R,multisample:{count:D,alphaToCoverageEnabled:s.alphaToCoverage&&D>1},layout:p.createPipelineLayout({bindGroupLayouts:g})},O={},U=e.context.depth,Z=e.context.stencil;if((U===!0||Z===!0)&&(U===!0&&(O.format=I,O.depthWriteEnabled=s.depthWrite,O.depthCompare=B),Z===!0&&(O.stencilFront=v,O.stencilBack={},O.stencilReadMask=s.stencilFuncMask,O.stencilWriteMask=s.stencilWriteMask),L.depthStencil=O),i===null)m.pipeline=p.createRenderPipeline(L);else{const G=new Promise(z=>{p.createRenderPipelineAsync(L).then($=>{m.pipeline=$,z()})});i.push(G)}}createBundleEncoder(e){const i=this.backend,{utils:n,device:s}=i,o=n.getCurrentDepthStencilFormat(e),l=n.getCurrentColorFormat(e),u=this._getSampleCount(e),c={label:"renderBundleEncoder",colorFormats:[l],depthStencilFormat:o,sampleCount:u};return s.createRenderBundleEncoder(c)}createComputePipeline(e,i){const n=this.backend,s=n.device,o=n.get(e.computeProgram).module,l=n.get(e),u=[];for(const c of i){const h=n.get(c);u.push(h.layout)}l.pipeline=s.createComputePipeline({compute:o,layout:s.createPipelineLayout({bindGroupLayouts:u})})}_getBlending(e){let i,n;const s=e.blending,o=e.blendSrc,l=e.blendDst,u=e.blendEquation;if(s===RU){const c=e.blendSrcAlpha!==null?e.blendSrcAlpha:o,h=e.blendDstAlpha!==null?e.blendDstAlpha:l,p=e.blendEquationAlpha!==null?e.blendEquationAlpha:u;i={srcFactor:this._getBlendFactor(o),dstFactor:this._getBlendFactor(l),operation:this._getBlendOperation(u)},n={srcFactor:this._getBlendFactor(c),dstFactor:this._getBlendFactor(h),operation:this._getBlendOperation(p)}}else{const c=e.premultipliedAlpha,h=(p,f,m,g)=>{i={srcFactor:p,dstFactor:f,operation:Xp.Add},n={srcFactor:m,dstFactor:g,operation:Xp.Add}};if(c)switch(s){case sd:h(Xr.One,Xr.OneMinusSrcAlpha,Xr.One,Xr.OneMinusSrcAlpha);break;case y1:h(Xr.One,Xr.One,Xr.One,Xr.One);break;case v1:h(Xr.Zero,Xr.OneMinusSrc,Xr.Zero,Xr.One);break;case x1:h(Xr.Zero,Xr.Src,Xr.Zero,Xr.SrcAlpha);break}else switch(s){case sd:h(Xr.SrcAlpha,Xr.OneMinusSrcAlpha,Xr.One,Xr.OneMinusSrcAlpha);break;case y1:h(Xr.SrcAlpha,Xr.One,Xr.SrcAlpha,Xr.One);break;case v1:h(Xr.Zero,Xr.OneMinusSrc,Xr.Zero,Xr.One);break;case x1:h(Xr.Zero,Xr.Src,Xr.Zero,Xr.Src);break}}if(i!==void 0&&n!==void 0)return{color:i,alpha:n};console.error("THREE.WebGPURenderer: Invalid blending: ",s)}_getBlendFactor(e){let i;switch(e){case NU:i=Xr.Zero;break;case LU:i=Xr.One;break;case DU:i=Xr.Src;break;case OU:i=Xr.OneMinusSrc;break;case b1:i=Xr.SrcAlpha;break;case _1:i=Xr.OneMinusSrcAlpha;break;case FU:i=Xr.Dst;break;case UU:i=Xr.OneMinusDstColor;break;case PU:i=Xr.DstAlpha;break;case kU:i=Xr.OneMinusDstAlpha;break;case zU:i=Xr.SrcAlphaSaturated;break;case $me:i=Xr.Constant;break;case ege:i=Xr.OneMinusConstant;break;default:console.error("THREE.WebGPURenderer: Blend factor not supported.",e)}return i}_getStencilCompare(e){let i;const n=e.stencilFunc;switch(n){case Bce:i=Qa.Never;break;case QM:i=Qa.Always;break;case Nce:i=Qa.Less;break;case Dce:i=Qa.LessEqual;break;case Lce:i=Qa.Equal;break;case kce:i=Qa.GreaterEqual;break;case Oce:i=Qa.Greater;break;case Pce:i=Qa.NotEqual;break;default:console.error("THREE.WebGPURenderer: Invalid stencil function.",n)}return i}_getStencilOperation(e){let i;switch(e){case Np:i=Cd.Keep;break;case wce:i=Cd.Zero;break;case Cce:i=Cd.Replace;break;case Ice:i=Cd.Invert;break;case Sce:i=Cd.IncrementClamp;break;case Tce:i=Cd.DecrementClamp;break;case Mce:i=Cd.IncrementWrap;break;case Rce:i=Cd.DecrementWrap;break;default:console.error("THREE.WebGPURenderer: Invalid stencil operation.",i)}return i}_getBlendOperation(e){let i;switch(e){case ad:i=Xp.Add;break;case IU:i=Xp.Subtract;break;case BU:i=Xp.ReverseSubtract;break;case ace:i=Xp.Min;break;case oce:i=Xp.Max;break;default:console.error("THREE.WebGPUPipelineUtils: Blend equation not supported.",e)}return i}_getPrimitiveState(e,i,n){const s={},o=this.backend.utils;switch(s.topology=o.getPrimitiveTopology(e,n),i.index!==null&&e.isLine===!0&&e.isLineSegments!==!0&&(s.stripIndexFormat=i.index.array instanceof Uint16Array?Og.Uint16:Og.Uint32),n.side){case Ym:s.frontFace=_R.CCW,s.cullMode=ER.Back;break;case pc:s.frontFace=_R.CCW,s.cullMode=ER.Front;break;case Km:s.frontFace=_R.CCW,s.cullMode=ER.None;break;default:console.error("THREE.WebGPUPipelineUtils: Unknown material.side value.",n.side);break}return s}_getColorWriteMask(e){return e.colorWrite===!0?oz.All:oz.None}_getDepthCompare(e){let i;if(e.depthTest===!1)i=Qa.Always;else{const n=e.depthFunc;switch(n){case jU:i=Qa.Never;break;case VU:i=Qa.Always;break;case GU:i=Qa.Less;break;case E1:i=Qa.LessEqual;break;case HU:i=Qa.Equal;break;case WU:i=Qa.GreaterEqual;break;case QU:i=Qa.Greater;break;case qU:i=Qa.NotEqual;break;default:console.error("THREE.WebGPUPipelineUtils: Invalid depth function.",n)}}return i}}class zAe extends jz{constructor(e={}){super(e),this.isWebGPUBackend=!0,this.parameters.alpha=e.alpha===void 0?!0:e.alpha,this.parameters.requiredLimits=e.requiredLimits===void 0?{}:e.requiredLimits,this.trackTimestamp=e.trackTimestamp===!0,this.device=null,this.context=null,this.colorBuffer=null,this.defaultRenderPassdescriptor=null,this.utils=new LAe(this),this.attributeUtils=new kAe(this),this.bindingUtils=new FAe(this),this.pipelineUtils=new UAe(this),this.textureUtils=new wAe(this),this.occludedResolveCache=new Map}async init(e){await super.init(e);const i=this.parameters;let n;if(i.device===void 0){const l={powerPreference:i.powerPreference},u=await navigator.gpu.requestAdapter(l);if(u===null)throw new Error("WebGPUBackend: Unable to create WebGPU adapter.");const c=Object.values(SR),h=[];for(const f of c)u.features.has(f)&&h.push(f);const p={requiredFeatures:h,requiredLimits:i.requiredLimits};n=await u.requestDevice(p)}else n=i.device;n.lost.then(l=>{const u={api:"WebGPU",message:l.message||"Unknown reason",reason:l.reason||null,originalEvent:l};e.onDeviceLost(u)});const s=i.context!==void 0?i.context:e.domElement.getContext("webgpu");this.device=n,this.context=s;const o=i.alpha?"premultiplied":"opaque";this.trackTimestamp=this.trackTimestamp&&this.hasFeature(SR.TimestampQuery),this.context.configure({device:this.device,format:this.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC,alphaMode:o}),this.updateSize()}get coordinateSystem(){return Lp}async getArrayBufferAsync(e){return await this.attributeUtils.getArrayBufferAsync(e)}getContext(){return this.context}_getDefaultRenderPassDescriptor(){let e=this.defaultRenderPassdescriptor;if(e===null){const n=this.renderer;e={colorAttachments:[{view:null}]},(this.renderer.depth===!0||this.renderer.stencil===!0)&&(e.depthStencilAttachment={view:this.textureUtils.getDepthBuffer(n.depth,n.stencil).createView()});const s=e.colorAttachments[0];this.renderer.samples>0?s.view=this.colorBuffer.createView():s.resolveTarget=void 0,this.defaultRenderPassdescriptor=e}const i=e.colorAttachments[0];return this.renderer.samples>0?i.resolveTarget=this.context.getCurrentTexture().createView():i.view=this.context.getCurrentTexture().createView(),e}_getRenderPassDescriptor(e){const i=e.renderTarget,n=this.get(i);let s=n.descriptors;if(s===void 0||n.width!==i.width||n.height!==i.height||n.activeMipmapLevel!==i.activeMipmapLevel||n.samples!==i.samples){s={},n.descriptors=s;const u=()=>{i.removeEventListener("dispose",u),this.delete(i)};i.addEventListener("dispose",u)}const o=e.getCacheKey();let l=s[o];if(l===void 0){const u=e.textures,c=[];for(let h=0;h<u.length;h++){const p=this.get(u[h]),f=p.texture.createView({baseMipLevel:e.activeMipmapLevel,mipLevelCount:1,baseArrayLayer:e.activeCubeFace,dimension:Fl.TwoD});let m,g;p.msaaTexture!==void 0?(m=p.msaaTexture.createView(),g=f):(m=f,g=void 0),c.push({view:m,resolveTarget:g,loadOp:aa.Load,storeOp:qa.Store})}if(l={colorAttachments:c},e.depth){const h={view:this.get(e.depthTexture).texture.createView()};l.depthStencilAttachment=h}s[o]=l,n.width=i.width,n.height=i.height,n.samples=i.samples,n.activeMipmapLevel=i.activeMipmapLevel}return l}beginRender(e){const i=this.get(e),n=this.device,s=e.occlusionQueryCount;let o;s>0&&(i.currentOcclusionQuerySet&&i.currentOcclusionQuerySet.destroy(),i.currentOcclusionQueryBuffer&&i.currentOcclusionQueryBuffer.destroy(),i.currentOcclusionQuerySet=i.occlusionQuerySet,i.currentOcclusionQueryBuffer=i.occlusionQueryBuffer,i.currentOcclusionQueryObjects=i.occlusionQueryObjects,o=n.createQuerySet({type:"occlusion",count:s}),i.occlusionQuerySet=o,i.occlusionQueryIndex=0,i.occlusionQueryObjects=new Array(s),i.lastOcclusionObject=null);let l;e.textures===null?l=this._getDefaultRenderPassDescriptor():l=this._getRenderPassDescriptor(e),this.initTimestampQuery(e,l),l.occlusionQuerySet=o;const u=l.depthStencilAttachment;if(e.textures!==null){const p=l.colorAttachments;for(let f=0;f<p.length;f++){const m=p[f];e.clearColor?(m.clearValue=f===0?e.clearColorValue:{r:0,g:0,b:0,a:1},m.loadOp=aa.Clear,m.storeOp=qa.Store):(m.loadOp=aa.Load,m.storeOp=qa.Store)}}else{const p=l.colorAttachments[0];e.clearColor?(p.clearValue=e.clearColorValue,p.loadOp=aa.Clear,p.storeOp=qa.Store):(p.loadOp=aa.Load,p.storeOp=qa.Store)}e.depth&&(e.clearDepth?(u.depthClearValue=e.clearDepthValue,u.depthLoadOp=aa.Clear,u.depthStoreOp=qa.Store):(u.depthLoadOp=aa.Load,u.depthStoreOp=qa.Store)),e.stencil&&(e.clearStencil?(u.stencilClearValue=e.clearStencilValue,u.stencilLoadOp=aa.Clear,u.stencilStoreOp=qa.Store):(u.stencilLoadOp=aa.Load,u.stencilStoreOp=qa.Store));const c=n.createCommandEncoder({label:"renderContext_"+e.id}),h=c.beginRenderPass(l);if(i.descriptor=l,i.encoder=c,i.currentPass=h,i.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},i.renderBundles=[],e.viewport&&this.updateViewport(e),e.scissor){const{x:p,y:f,width:m,height:g}=e.scissorValue;h.setScissorRect(p,f,m,g)}}finishRender(e){const i=this.get(e),n=e.occlusionQueryCount;if(i.renderBundles.length>0&&i.currentPass.executeBundles(i.renderBundles),n>i.occlusionQueryIndex&&i.currentPass.endOcclusionQuery(),i.currentPass.end(),n>0){const s=n*8;let o=this.occludedResolveCache.get(s);o===void 0&&(o=this.device.createBuffer({size:s,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),this.occludedResolveCache.set(s,o));const l=this.device.createBuffer({size:s,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});i.encoder.resolveQuerySet(i.occlusionQuerySet,0,n,o,0),i.encoder.copyBufferToBuffer(o,0,l,0,s),i.occlusionQueryBuffer=l,this.resolveOccludedAsync(e)}if(this.prepareTimestampBuffer(e,i.encoder),this.device.queue.submit([i.encoder.finish()]),e.textures!==null){const s=e.textures;for(let o=0;o<s.length;o++){const l=s[o];l.generateMipmaps===!0&&this.textureUtils.generateMipmaps(l)}}}isOccluded(e,i){const n=this.get(e);return n.occluded&&n.occluded.has(i)}async resolveOccludedAsync(e){const i=this.get(e),{currentOcclusionQueryBuffer:n,currentOcclusionQueryObjects:s}=i;if(n&&s){const o=new WeakSet;i.currentOcclusionQueryObjects=null,i.currentOcclusionQueryBuffer=null,await n.mapAsync(GPUMapMode.READ);const l=n.getMappedRange(),u=new BigUint64Array(l);for(let c=0;c<s.length;c++)u[c]!==BigInt(0)&&o.add(s[c]);n.destroy(),i.occluded=o}}updateViewport(e){const{currentPass:i}=this.get(e),{x:n,y:s,width:o,height:l,minDepth:u,maxDepth:c}=e.viewportValue;i.setViewport(n,s,o,l,u,c)}clear(e,i,n,s=null){const o=this.device,l=this.renderer;let u=[],c,h,p,f;if(e){const g=this.getClearColor();if(this.renderer.alpha===!0){const y=g.a;h={r:g.r*y,g:g.g*y,b:g.b*y,a:y}}else h={r:g.r,g:g.g,b:g.b,a:g.a}}if(s===null){p=l.depth,f=l.stencil;const g=this._getDefaultRenderPassDescriptor();if(e){u=g.colorAttachments;const y=u[0];y.clearValue=h,y.loadOp=aa.Clear,y.storeOp=qa.Store}(p||f)&&(c=g.depthStencilAttachment)}else{if(p=s.depth,f=s.stencil,e)for(const g of s.textures){const y=this.get(g),x=y.texture.createView();let v,_;y.msaaTexture!==void 0?(v=y.msaaTexture.createView(),_=x):(v=x,_=void 0),u.push({view:v,resolveTarget:_,clearValue:h,loadOp:aa.Clear,storeOp:qa.Store})}(p||f)&&(c={view:this.get(s.depthTexture).texture.createView()})}p&&(i?(c.depthLoadOp=aa.Clear,c.depthClearValue=l.getClearDepth(),c.depthStoreOp=qa.Store):(c.depthLoadOp=aa.Load,c.depthStoreOp=qa.Store)),f&&(n?(c.stencilLoadOp=aa.Clear,c.stencilClearValue=l.getClearStencil(),c.stencilStoreOp=qa.Store):(c.stencilLoadOp=aa.Load,c.stencilStoreOp=qa.Store));const m=o.createCommandEncoder({});m.beginRenderPass({colorAttachments:u,depthStencilAttachment:c}).end(),o.queue.submit([m.finish()])}beginCompute(e){const i=this.get(e),n={};this.initTimestampQuery(e,n),i.cmdEncoderGPU=this.device.createCommandEncoder(),i.passEncoderGPU=i.cmdEncoderGPU.beginComputePass(n)}compute(e,i,n,s){const{passEncoderGPU:o}=this.get(e),l=this.get(s).pipeline;o.setPipeline(l);for(let p=0,f=n.length;p<f;p++){const m=n[p],g=this.get(m);o.setBindGroup(p,g.group)}const u=this.device.limits.maxComputeWorkgroupsPerDimension,c=this.get(i);c.dispatchSize===void 0&&(c.dispatchSize={x:0,y:1,z:1});const{dispatchSize:h}=c;i.dispatchCount>u?(h.x=Math.min(i.dispatchCount,u),h.y=Math.ceil(i.dispatchCount/u)):h.x=i.dispatchCount,o.dispatchWorkgroups(h.x,h.y,h.z)}finishCompute(e){const i=this.get(e);i.passEncoderGPU.end(),this.prepareTimestampBuffer(e,i.cmdEncoderGPU),this.device.queue.submit([i.cmdEncoderGPU.finish()])}async waitForGPU(){await this.device.queue.onSubmittedWorkDone()}draw(e,i){const{object:n,context:s,pipeline:o}=e,l=e.getBindings(),u=this.get(s),c=this.get(o).pipeline,h=u.currentSets,p=u.currentPass,f=e.getDrawParameters();if(f===null)return;h.pipeline!==c&&(p.setPipeline(c),h.pipeline=c);const m=h.bindingGroups;for(let v=0,_=l.length;v<_;v++){const T=l[v],w=this.get(T);m[T.index]!==T.id&&(p.setBindGroup(T.index,w.group),m[T.index]=T.id)}const g=e.getIndex(),y=g!==null;if(y===!0&&h.index!==g){const v=this.get(g).buffer,_=g.array instanceof Uint16Array?Og.Uint16:Og.Uint32;p.setIndexBuffer(v,_),h.index=g}const x=e.getVertexBuffers();for(let v=0,_=x.length;v<_;v++){const T=x[v];if(h.attributes[v]!==T){const w=this.get(T).buffer;p.setVertexBuffer(v,w),h.attributes[v]=T}}if(u.occlusionQuerySet!==void 0){const v=u.lastOcclusionObject;v!==n&&(v!==null&&v.occlusionTest===!0&&(p.endOcclusionQuery(),u.occlusionQueryIndex++),n.occlusionTest===!0&&(p.beginOcclusionQuery(u.occlusionQueryIndex),u.occlusionQueryObjects[u.occlusionQueryIndex]=n),u.lastOcclusionObject=n)}if(n.isBatchedMesh===!0){const v=n._multiDrawStarts,_=n._multiDrawCounts,T=n._multiDrawCount,w=n._multiDrawInstances,S=y?g.array.BYTES_PER_ELEMENT:1;for(let R=0;R<T;R++){const B=w?w[R]:1,I=B>1?0:R;p.drawIndexed(_[R],B,v[R]/S,0,I)}}else if(y===!0){const{vertexCount:v,instanceCount:_,firstVertex:T}=f,w=e.getIndirect();if(w!==null){const S=this.get(w).buffer;p.drawIndexedIndirect(S,0)}else p.drawIndexed(v,_,T,0,0);i.update(n,v,_)}else{const{vertexCount:v,instanceCount:_,firstVertex:T}=f,w=e.getIndirect();if(w!==null){const S=this.get(w).buffer;p.drawIndirect(S,0)}else p.draw(v,_,T,0);i.update(n,v,_)}}needsRenderUpdate(e){const i=this.get(e),{object:n,material:s}=e,o=this.utils,l=o.getSampleCountRenderContext(e.context),u=o.getCurrentColorSpace(e.context),c=o.getCurrentColorFormat(e.context),h=o.getCurrentDepthStencilFormat(e.context),p=o.getPrimitiveTopology(n,s);let f=!1;return(i.material!==s||i.materialVersion!==s.version||i.transparent!==s.transparent||i.blending!==s.blending||i.premultipliedAlpha!==s.premultipliedAlpha||i.blendSrc!==s.blendSrc||i.blendDst!==s.blendDst||i.blendEquation!==s.blendEquation||i.blendSrcAlpha!==s.blendSrcAlpha||i.blendDstAlpha!==s.blendDstAlpha||i.blendEquationAlpha!==s.blendEquationAlpha||i.colorWrite!==s.colorWrite||i.depthWrite!==s.depthWrite||i.depthTest!==s.depthTest||i.depthFunc!==s.depthFunc||i.stencilWrite!==s.stencilWrite||i.stencilFunc!==s.stencilFunc||i.stencilFail!==s.stencilFail||i.stencilZFail!==s.stencilZFail||i.stencilZPass!==s.stencilZPass||i.stencilFuncMask!==s.stencilFuncMask||i.stencilWriteMask!==s.stencilWriteMask||i.side!==s.side||i.alphaToCoverage!==s.alphaToCoverage||i.sampleCount!==l||i.colorSpace!==u||i.colorFormat!==c||i.depthStencilFormat!==h||i.primitiveTopology!==p||i.clippingContextCacheKey!==e.clippingContext.cacheKey)&&(i.material=s,i.materialVersion=s.version,i.transparent=s.transparent,i.blending=s.blending,i.premultipliedAlpha=s.premultipliedAlpha,i.blendSrc=s.blendSrc,i.blendDst=s.blendDst,i.blendEquation=s.blendEquation,i.blendSrcAlpha=s.blendSrcAlpha,i.blendDstAlpha=s.blendDstAlpha,i.blendEquationAlpha=s.blendEquationAlpha,i.colorWrite=s.colorWrite,i.depthWrite=s.depthWrite,i.depthTest=s.depthTest,i.depthFunc=s.depthFunc,i.stencilWrite=s.stencilWrite,i.stencilFunc=s.stencilFunc,i.stencilFail=s.stencilFail,i.stencilZFail=s.stencilZFail,i.stencilZPass=s.stencilZPass,i.stencilFuncMask=s.stencilFuncMask,i.stencilWriteMask=s.stencilWriteMask,i.side=s.side,i.alphaToCoverage=s.alphaToCoverage,i.sampleCount=l,i.colorSpace=u,i.colorFormat=c,i.depthStencilFormat=h,i.primitiveTopology=p,i.clippingContextCacheKey=e.clippingContext.cacheKey,f=!0),f}getRenderCacheKey(e){const{object:i,material:n}=e,s=this.utils,o=e.context;return[n.transparent,n.blending,n.premultipliedAlpha,n.blendSrc,n.blendDst,n.blendEquation,n.blendSrcAlpha,n.blendDstAlpha,n.blendEquationAlpha,n.colorWrite,n.depthWrite,n.depthTest,n.depthFunc,n.stencilWrite,n.stencilFunc,n.stencilFail,n.stencilZFail,n.stencilZPass,n.stencilFuncMask,n.stencilWriteMask,n.side,s.getSampleCountRenderContext(o),s.getCurrentColorSpace(o),s.getCurrentColorFormat(o),s.getCurrentDepthStencilFormat(o),s.getPrimitiveTopology(i,n),e.getGeometryCacheKey(),e.clippingContext.cacheKey].join()}createSampler(e){this.textureUtils.createSampler(e)}destroySampler(e){this.textureUtils.destroySampler(e)}createDefaultTexture(e){this.textureUtils.createDefaultTexture(e)}createTexture(e,i){this.textureUtils.createTexture(e,i)}updateTexture(e,i){this.textureUtils.updateTexture(e,i)}generateMipmaps(e){this.textureUtils.generateMipmaps(e)}destroyTexture(e){this.textureUtils.destroyTexture(e)}copyTextureToBuffer(e,i,n,s,o,l){return this.textureUtils.copyTextureToBuffer(e,i,n,s,o,l)}initTimestampQuery(e,i){if(!this.trackTimestamp)return;const n=this.get(e);if(!n.timeStampQuerySet){const s=this.device.createQuerySet({type:"timestamp",count:2});Object.assign(i,{timestampWrites:{querySet:s,beginningOfPassWriteIndex:0,endOfPassWriteIndex:1}}),n.timeStampQuerySet=s}}prepareTimestampBuffer(e,i){if(!this.trackTimestamp)return;const n=this.get(e),s=2*BigInt64Array.BYTES_PER_ELEMENT;n.currentTimestampQueryBuffers===void 0&&(n.currentTimestampQueryBuffers={resolveBuffer:this.device.createBuffer({label:"timestamp resolve buffer",size:s,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),resultBuffer:this.device.createBuffer({label:"timestamp result buffer",size:s,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),isMappingPending:!1});const{resolveBuffer:o,resultBuffer:l,isMappingPending:u}=n.currentTimestampQueryBuffers;u!==!0&&(i.resolveQuerySet(n.timeStampQuerySet,0,2,o,0),i.copyBufferToBuffer(o,0,l,0,s))}async resolveTimestampAsync(e,i="render"){if(!this.trackTimestamp)return;const n=this.get(e);if(n.currentTimestampQueryBuffers===void 0)return;const{resultBuffer:s,isMappingPending:o}=n.currentTimestampQueryBuffers;o!==!0&&(n.currentTimestampQueryBuffers.isMappingPending=!0,s.mapAsync(GPUMapMode.READ).then(()=>{const l=new BigUint64Array(s.getMappedRange()),u=Number(l[1]-l[0])/1e6;this.renderer.info.updateTimestamp(i,u),s.unmap(),n.currentTimestampQueryBuffers.isMappingPending=!1}))}createNodeBuilder(e,i){return new NAe(e,i)}createProgram(e){const i=this.get(e);i.module={module:this.device.createShaderModule({code:e.code,label:e.stage}),entryPoint:"main"}}destroyProgram(e){this.delete(e)}createRenderPipeline(e,i){this.pipelineUtils.createRenderPipeline(e,i)}createComputePipeline(e,i){this.pipelineUtils.createComputePipeline(e,i)}beginBundle(e){const i=this.get(e);i._currentPass=i.currentPass,i._currentSets=i.currentSets,i.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},i.currentPass=this.pipelineUtils.createBundleEncoder(e)}finishBundle(e,i){const n=this.get(e),s=n.currentPass.finish();this.get(i).bundleGPU=s,n.currentSets=n._currentSets,n.currentPass=n._currentPass}addBundle(e,i){this.get(e).renderBundles.push(this.get(i).bundleGPU)}createBindings(e){this.bindingUtils.createBindings(e)}updateBindings(e){this.bindingUtils.createBindings(e)}updateBinding(e){this.bindingUtils.updateBinding(e)}createIndexAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.INDEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createStorageAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createIndirectStorageAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.INDIRECT|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}updateAttribute(e){this.attributeUtils.updateAttribute(e)}destroyAttribute(e){this.attributeUtils.destroyAttribute(e)}updateSize(){this.colorBuffer=this.textureUtils.getColorBuffer(),this.defaultRenderPassdescriptor=null}getMaxAnisotropy(){return 16}hasFeature(e){return this.device.features.has(e)}copyTextureToTexture(e,i,n=null,s=null,o=0){let l=0,u=0,c=0,h=0,p=0,f=0,m=e.image.width,g=e.image.height;n!==null&&(h=n.x,p=n.y,f=n.z||0,m=n.width,g=n.height),s!==null&&(l=s.x,u=s.y,c=s.z||0);const y=this.device.createCommandEncoder({label:"copyTextureToTexture_"+e.id+"_"+i.id}),x=this.get(e).texture,v=this.get(i).texture;y.copyTextureToTexture({texture:x,mipLevel:o,origin:{x:h,y:p,z:f}},{texture:v,mipLevel:o,origin:{x:l,y:u,z:c}},[m,g,1]),this.device.queue.submit([y.finish()])}copyFramebufferToTexture(e,i,n){const s=this.get(i);let o=null;i.renderTarget?e.isDepthTexture?o=this.get(i.depthTexture).texture:o=this.get(i.textures[0]).texture:e.isDepthTexture?o=this.textureUtils.getDepthBuffer(i.depth,i.stencil):o=this.context.getCurrentTexture();const l=this.get(e).texture;if(o.format!==l.format){console.error("WebGPUBackend: copyFramebufferToTexture: Source and destination formats do not match.",o.format,l.format);return}let u;if(s.currentPass?(s.currentPass.end(),u=s.encoder):u=this.device.createCommandEncoder({label:"copyFramebufferToTexture_"+e.id}),u.copyTextureToTexture({texture:o,origin:{x:n.x,y:n.y,z:0}},{texture:l},[n.z,n.w]),e.generateMipmaps&&this.textureUtils.generateMipmaps(e),s.currentPass){const{descriptor:c}=s;for(let h=0;h<c.colorAttachments.length;h++)c.colorAttachments[h].loadOp=aa.Load;i.depth&&(c.depthStencilAttachment.depthLoadOp=aa.Load),i.stencil&&(c.depthStencilAttachment.stencilLoadOp=aa.Load),s.currentPass=u.beginRenderPass(c),s.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null}}else this.device.queue.submit([u.finish()])}}class jAe extends t6{constructor(e,i,n,s,o,l){super(e,i,n,s,o,l),this.iesMap=null}copy(e,i){return super.copy(e,i),this.iesMap=e.iesMap,this}}class VAe extends Bz{constructor(){super(),this.addMaterial(Hfe,q5),this.addMaterial(Z8,b3),this.addMaterial(Ime,Q5),this.addMaterial(Dme,X5),this.addMaterial(kfe,U1),this.addMaterial(Vfe,K5),this.addMaterial(Bfe,Y5),this.addMaterial(Fme,J5),this.addMaterial(Sfe,v3),this.addMaterial(Mfe,Z5),this.addMaterial(zme,H5),this.addMaterial(Hme,V5),this.addMaterial(qme,W5),this.addLight(r0e,Oue),this.addLight(L0e,kue),this.addLight(D0e,Uue),this.addLight(Tz,t6),this.addLight(P0e,Fue),this.addLight(k0e,Nue),this.addLight(F0e,jue),this.addLight(O0e,jAe),this.addToneMapping(Mge,uce),this.addToneMapping(Rge,hce),this.addToneMapping(Ige,dce),this.addToneMapping(Nge,pce),this.addToneMapping(Pge,fce),this.addToneMapping(kge,mce)}}class GAe extends Y0e{constructor(e={}){let i;e.forceWebGL?i=Qz:(i=zAe,e.getFallback=()=>(console.warn("THREE.WebGPURenderer: WebGPU is not available, running under WebGL2 backend."),new Qz(e)));const n=new i(e);super(n,e),this.library=new VAe,this.isWebGPURenderer=!0}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:g1}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=g1);const KR={type:"change"},JR={type:"start"},ZR={type:"end"},Kz=1e-6,Kn={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4},k_=new ji,Td=new ji,HAe=new at,F_=new at,$R=new at,jg=new Uc,Jz=new at,U_=new at,eI=new at,z_=new at;class WAe extends Gb{constructor(e,i=null){super(e,i),this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.keys=["KeyA","KeyS","KeyD"],this.mouseButtons={LEFT:Ua.ROTATE,MIDDLE:Ua.DOLLY,RIGHT:Ua.PAN},this.state=Kn.NONE,this.keyState=Kn.NONE,this.target=new at,this._lastPosition=new at,this._lastZoom=1,this._touchZoomDistanceStart=0,this._touchZoomDistanceEnd=0,this._lastAngle=0,this._eye=new at,this._movePrev=new ji,this._moveCurr=new ji,this._lastAxis=new at,this._zoomStart=new ji,this._zoomEnd=new ji,this._panStart=new ji,this._panEnd=new ji,this._pointers=[],this._pointerPositions={},this._onPointerMove=qAe.bind(this),this._onPointerDown=QAe.bind(this),this._onPointerUp=XAe.bind(this),this._onPointerCancel=YAe.bind(this),this._onContextMenu=iye.bind(this),this._onMouseWheel=tye.bind(this),this._onKeyDown=JAe.bind(this),this._onKeyUp=KAe.bind(this),this._onTouchStart=rye.bind(this),this._onTouchMove=nye.bind(this),this._onTouchEnd=sye.bind(this),this._onMouseDown=ZAe.bind(this),this._onMouseMove=$Ae.bind(this),this._onMouseUp=eye.bind(this),this._target0=this.target.clone(),this._position0=this.object.position.clone(),this._up0=this.object.up.clone(),this._zoom0=this.object.zoom,i!==null&&(this.connect(),this.handleResize()),this.update()}connect(){window.addEventListener("keydown",this._onKeyDown),window.addEventListener("keyup",this._onKeyUp),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerCancel),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="none"}disconnect(){window.removeEventListener("keydown",this._onKeyDown),window.removeEventListener("keyup",this._onKeyUp),this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerCancel),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}handleResize(){const e=this.domElement.getBoundingClientRect(),i=this.domElement.ownerDocument.documentElement;this.screen.left=e.left+window.pageXOffset-i.clientLeft,this.screen.top=e.top+window.pageYOffset-i.clientTop,this.screen.width=e.width,this.screen.height=e.height}update(){this._eye.subVectors(this.object.position,this.target),this.noRotate||this._rotateCamera(),this.noZoom||this._zoomCamera(),this.noPan||this._panCamera(),this.object.position.addVectors(this.target,this._eye),this.object.isPerspectiveCamera?(this._checkDistances(),this.object.lookAt(this.target),this._lastPosition.distanceToSquared(this.object.position)>Kz&&(this.dispatchEvent(KR),this._lastPosition.copy(this.object.position))):this.object.isOrthographicCamera?(this.object.lookAt(this.target),(this._lastPosition.distanceToSquared(this.object.position)>Kz||this._lastZoom!==this.object.zoom)&&(this.dispatchEvent(KR),this._lastPosition.copy(this.object.position),this._lastZoom=this.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type.")}reset(){this.state=Kn.NONE,this.keyState=Kn.NONE,this.target.copy(this._target0),this.object.position.copy(this._position0),this.object.up.copy(this._up0),this.object.zoom=this._zoom0,this.object.updateProjectionMatrix(),this._eye.subVectors(this.object.position,this.target),this.object.lookAt(this.target),this.dispatchEvent(KR),this._lastPosition.copy(this.object.position),this._lastZoom=this.object.zoom}_panCamera(){if(Td.copy(this._panEnd).sub(this._panStart),Td.lengthSq()){if(this.object.isOrthographicCamera){const e=(this.object.right-this.object.left)/this.object.zoom/this.domElement.clientWidth,i=(this.object.top-this.object.bottom)/this.object.zoom/this.domElement.clientWidth;Td.x*=e,Td.y*=i}Td.multiplyScalar(this._eye.length()*this.panSpeed),F_.copy(this._eye).cross(this.object.up).setLength(Td.x),F_.add(HAe.copy(this.object.up).setLength(Td.y)),this.object.position.add(F_),this.target.add(F_),this.staticMoving?this._panStart.copy(this._panEnd):this._panStart.add(Td.subVectors(this._panEnd,this._panStart).multiplyScalar(this.dynamicDampingFactor))}}_rotateCamera(){z_.set(this._moveCurr.x-this._movePrev.x,this._moveCurr.y-this._movePrev.y,0);let e=z_.length();e?(this._eye.copy(this.object.position).sub(this.target),Jz.copy(this._eye).normalize(),U_.copy(this.object.up).normalize(),eI.crossVectors(U_,Jz).normalize(),U_.setLength(this._moveCurr.y-this._movePrev.y),eI.setLength(this._moveCurr.x-this._movePrev.x),z_.copy(U_.add(eI)),$R.crossVectors(z_,this._eye).normalize(),e*=this.rotateSpeed,jg.setFromAxisAngle($R,e),this._eye.applyQuaternion(jg),this.object.up.applyQuaternion(jg),this._lastAxis.copy($R),this._lastAngle=e):!this.staticMoving&&this._lastAngle&&(this._lastAngle*=Math.sqrt(1-this.dynamicDampingFactor),this._eye.copy(this.object.position).sub(this.target),jg.setFromAxisAngle(this._lastAxis,this._lastAngle),this._eye.applyQuaternion(jg),this.object.up.applyQuaternion(jg)),this._movePrev.copy(this._moveCurr)}_zoomCamera(){let e;this.state===Kn.TOUCH_ZOOM_PAN?(e=this._touchZoomDistanceStart/this._touchZoomDistanceEnd,this._touchZoomDistanceStart=this._touchZoomDistanceEnd,this.object.isPerspectiveCamera?this._eye.multiplyScalar(e):this.object.isOrthographicCamera?(this.object.zoom=bS.clamp(this.object.zoom/e,this.minZoom,this.maxZoom),this._lastZoom!==this.object.zoom&&this.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(e=1+(this._zoomEnd.y-this._zoomStart.y)*this.zoomSpeed,e!==1&&e>0&&(this.object.isPerspectiveCamera?this._eye.multiplyScalar(e):this.object.isOrthographicCamera?(this.object.zoom=bS.clamp(this.object.zoom/e,this.minZoom,this.maxZoom),this._lastZoom!==this.object.zoom&&this.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),this.staticMoving?this._zoomStart.copy(this._zoomEnd):this._zoomStart.y+=(this._zoomEnd.y-this._zoomStart.y)*this.dynamicDampingFactor)}_getMouseOnScreen(e,i){return k_.set((e-this.screen.left)/this.screen.width,(i-this.screen.top)/this.screen.height),k_}_getMouseOnCircle(e,i){return k_.set((e-this.screen.width*.5-this.screen.left)/(this.screen.width*.5),(this.screen.height+2*(this.screen.top-i))/this.screen.width),k_}_addPointer(e){this._pointers.push(e)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let i=0;i<this._pointers.length;i++)if(this._pointers[i].pointerId==e.pointerId){this._pointers.splice(i,1);return}}_trackPointer(e){let i=this._pointerPositions[e.pointerId];i===void 0&&(i=new ji,this._pointerPositions[e.pointerId]=i),i.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){const i=e.pointerId===this._pointers[0].pointerId?this._pointers[1]:this._pointers[0];return this._pointerPositions[i.pointerId]}_checkDistances(){(!this.noZoom||!this.noPan)&&(this._eye.lengthSq()>this.maxDistance*this.maxDistance&&(this.object.position.addVectors(this.target,this._eye.setLength(this.maxDistance)),this._zoomStart.copy(this._zoomEnd)),this._eye.lengthSq()<this.minDistance*this.minDistance&&(this.object.position.addVectors(this.target,this._eye.setLength(this.minDistance)),this._zoomStart.copy(this._zoomEnd)))}}function QAe(r){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(r.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),this._addPointer(r),r.pointerType==="touch"?this._onTouchStart(r):this._onMouseDown(r))}function qAe(r){this.enabled!==!1&&(r.pointerType==="touch"?this._onTouchMove(r):this._onMouseMove(r))}function XAe(r){this.enabled!==!1&&(r.pointerType==="touch"?this._onTouchEnd(r):this._onMouseUp(),this._removePointer(r),this._pointers.length===0&&(this.domElement.releasePointerCapture(r.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp)))}function YAe(r){this._removePointer(r)}function KAe(){this.enabled!==!1&&(this.keyState=Kn.NONE,window.addEventListener("keydown",this._onKeyDown))}function JAe(r){this.enabled!==!1&&(window.removeEventListener("keydown",this._onKeyDown),this.keyState===Kn.NONE&&(r.code===this.keys[Kn.ROTATE]&&!this.noRotate?this.keyState=Kn.ROTATE:r.code===this.keys[Kn.ZOOM]&&!this.noZoom?this.keyState=Kn.ZOOM:r.code===this.keys[Kn.PAN]&&!this.noPan&&(this.keyState=Kn.PAN)))}function ZAe(r){let e;switch(r.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case Ua.DOLLY:this.state=Kn.ZOOM;break;case Ua.ROTATE:this.state=Kn.ROTATE;break;case Ua.PAN:this.state=Kn.PAN;break;default:this.state=Kn.NONE}const i=this.keyState!==Kn.NONE?this.keyState:this.state;i===Kn.ROTATE&&!this.noRotate?(this._moveCurr.copy(this._getMouseOnCircle(r.pageX,r.pageY)),this._movePrev.copy(this._moveCurr)):i===Kn.ZOOM&&!this.noZoom?(this._zoomStart.copy(this._getMouseOnScreen(r.pageX,r.pageY)),this._zoomEnd.copy(this._zoomStart)):i===Kn.PAN&&!this.noPan&&(this._panStart.copy(this._getMouseOnScreen(r.pageX,r.pageY)),this._panEnd.copy(this._panStart)),this.dispatchEvent(JR)}function $Ae(r){const e=this.keyState!==Kn.NONE?this.keyState:this.state;e===Kn.ROTATE&&!this.noRotate?(this._movePrev.copy(this._moveCurr),this._moveCurr.copy(this._getMouseOnCircle(r.pageX,r.pageY))):e===Kn.ZOOM&&!this.noZoom?this._zoomEnd.copy(this._getMouseOnScreen(r.pageX,r.pageY)):e===Kn.PAN&&!this.noPan&&this._panEnd.copy(this._getMouseOnScreen(r.pageX,r.pageY))}function eye(){this.state=Kn.NONE,this.dispatchEvent(ZR)}function tye(r){if(this.enabled!==!1&&this.noZoom!==!0){switch(r.preventDefault(),r.deltaMode){case 2:this._zoomStart.y-=r.deltaY*.025;break;case 1:this._zoomStart.y-=r.deltaY*.01;break;default:this._zoomStart.y-=r.deltaY*25e-5;break}this.dispatchEvent(JR),this.dispatchEvent(ZR)}}function iye(r){this.enabled!==!1&&r.preventDefault()}function rye(r){switch(this._trackPointer(r),this._pointers.length){case 1:this.state=Kn.TOUCH_ROTATE,this._moveCurr.copy(this._getMouseOnCircle(this._pointers[0].pageX,this._pointers[0].pageY)),this._movePrev.copy(this._moveCurr);break;default:this.state=Kn.TOUCH_ZOOM_PAN;const e=this._pointers[0].pageX-this._pointers[1].pageX,i=this._pointers[0].pageY-this._pointers[1].pageY;this._touchZoomDistanceEnd=this._touchZoomDistanceStart=Math.sqrt(e*e+i*i);const n=(this._pointers[0].pageX+this._pointers[1].pageX)/2,s=(this._pointers[0].pageY+this._pointers[1].pageY)/2;this._panStart.copy(this._getMouseOnScreen(n,s)),this._panEnd.copy(this._panStart);break}this.dispatchEvent(JR)}function nye(r){switch(this._trackPointer(r),this._pointers.length){case 1:this._movePrev.copy(this._moveCurr),this._moveCurr.copy(this._getMouseOnCircle(r.pageX,r.pageY));break;default:const e=this._getSecondPointerPosition(r),i=r.pageX-e.x,n=r.pageY-e.y;this._touchZoomDistanceEnd=Math.sqrt(i*i+n*n);const s=(r.pageX+e.x)/2,o=(r.pageY+e.y)/2;this._panEnd.copy(this._getMouseOnScreen(s,o));break}}function sye(r){switch(this._pointers.length){case 0:this.state=Kn.NONE;break;case 1:this.state=Kn.TOUCH_ROTATE,this._moveCurr.copy(this._getMouseOnCircle(r.pageX,r.pageY)),this._movePrev.copy(this._moveCurr);break;case 2:this.state=Kn.TOUCH_ZOOM_PAN;for(let e=0;e<this._pointers.length;e++)if(this._pointers[e].pointerId!==r.pointerId){const i=this._pointerPositions[this._pointers[e].pointerId];this._moveCurr.copy(this._getMouseOnCircle(i.x,i.y)),this._movePrev.copy(this._moveCurr);break}break}this.dispatchEvent(ZR)}const Zz={type:"change"},tI={type:"start"},$z={type:"end"},j_=new fb,e7=new oc,aye=Math.cos(70*bS.DEG2RAD),Aa=new at,Zo=2*Math.PI,us={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},iI=1e-6;class oye extends Gb{constructor(e,i=null){super(e,i),this.state=us.NONE,this.enabled=!0,this.target=new at,this.cursor=new at,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:Ua.ROTATE,MIDDLE:Ua.DOLLY,RIGHT:Ua.PAN},this.touches={ONE:yu.ROTATE,TWO:yu.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new at,this._lastQuaternion=new Uc,this._lastTargetPosition=new at,this._quat=new Uc().setFromUnitVectors(e.up,new at(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new l4,this._sphericalDelta=new l4,this._scale=1,this._panOffset=new at,this._rotateStart=new ji,this._rotateEnd=new ji,this._rotateDelta=new ji,this._panStart=new ji,this._panEnd=new ji,this._panDelta=new ji,this._dollyStart=new ji,this._dollyEnd=new ji,this._dollyDelta=new ji,this._dollyDirection=new at,this._mouse=new ji,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=cye.bind(this),this._onPointerDown=lye.bind(this),this._onPointerUp=uye.bind(this),this._onContextMenu=Aye.bind(this),this._onMouseWheel=pye.bind(this),this._onKeyDown=fye.bind(this),this._onTouchStart=mye.bind(this),this._onTouchMove=gye.bind(this),this._onMouseDown=hye.bind(this),this._onMouseMove=dye.bind(this),this._interceptControlDown=yye.bind(this),this._interceptControlUp=vye.bind(this),this.domElement!==null&&this.connect(),this.update()}connect(){this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=e}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(Zz),this.update(),this.state=us.NONE}update(e=null){const i=this.object.position;Aa.copy(i).sub(this.target),Aa.applyQuaternion(this._quat),this._spherical.setFromVector3(Aa),this.autoRotate&&this.state===us.NONE&&this._rotateLeft(this._getAutoRotationAngle(e)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let n=this.minAzimuthAngle,s=this.maxAzimuthAngle;isFinite(n)&&isFinite(s)&&(n<-Math.PI?n+=Zo:n>Math.PI&&(n-=Zo),s<-Math.PI?s+=Zo:s>Math.PI&&(s-=Zo),n<=s?this._spherical.theta=Math.max(n,Math.min(s,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(n+s)/2?Math.max(n,this._spherical.theta):Math.min(s,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let o=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const l=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),o=l!=this._spherical.radius}if(Aa.setFromSpherical(this._spherical),Aa.applyQuaternion(this._quatInverse),i.copy(this.target).add(Aa),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let l=null;if(this.object.isPerspectiveCamera){const u=Aa.length();l=this._clampDistance(u*this._scale);const c=u-l;this.object.position.addScaledVector(this._dollyDirection,c),this.object.updateMatrixWorld(),o=!!c}else if(this.object.isOrthographicCamera){const u=new at(this._mouse.x,this._mouse.y,0);u.unproject(this.object);const c=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),o=c!==this.object.zoom;const h=new at(this._mouse.x,this._mouse.y,0);h.unproject(this.object),this.object.position.sub(h).add(u),this.object.updateMatrixWorld(),l=Aa.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;l!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(l).add(this.object.position):(j_.origin.copy(this.object.position),j_.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(j_.direction))<aye?this.object.lookAt(this.target):(e7.setFromNormalAndCoplanarPoint(this.object.up,this.target),j_.intersectPlane(e7,this.target))))}else if(this.object.isOrthographicCamera){const l=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),l!==this.object.zoom&&(this.object.updateProjectionMatrix(),o=!0)}return this._scale=1,this._performCursorZoom=!1,o||this._lastPosition.distanceToSquared(this.object.position)>iI||8*(1-this._lastQuaternion.dot(this.object.quaternion))>iI||this._lastTargetPosition.distanceToSquared(this.target)>iI?(this.dispatchEvent(Zz),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(e){return e!==null?Zo/60*this.autoRotateSpeed*e:Zo/60/60*this.autoRotateSpeed}_getZoomScale(e){const i=Math.abs(e*.01);return Math.pow(.95,this.zoomSpeed*i)}_rotateLeft(e){this._sphericalDelta.theta-=e}_rotateUp(e){this._sphericalDelta.phi-=e}_panLeft(e,i){Aa.setFromMatrixColumn(i,0),Aa.multiplyScalar(-e),this._panOffset.add(Aa)}_panUp(e,i){this.screenSpacePanning===!0?Aa.setFromMatrixColumn(i,1):(Aa.setFromMatrixColumn(i,0),Aa.crossVectors(this.object.up,Aa)),Aa.multiplyScalar(e),this._panOffset.add(Aa)}_pan(e,i){const n=this.domElement;if(this.object.isPerspectiveCamera){const s=this.object.position;Aa.copy(s).sub(this.target);let o=Aa.length();o*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*e*o/n.clientHeight,this.object.matrix),this._panUp(2*i*o/n.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(e*(this.object.right-this.object.left)/this.object.zoom/n.clientWidth,this.object.matrix),this._panUp(i*(this.object.top-this.object.bottom)/this.object.zoom/n.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(e,i){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const n=this.domElement.getBoundingClientRect(),s=e-n.left,o=i-n.top,l=n.width,u=n.height;this._mouse.x=s/l*2-1,this._mouse.y=-(o/u)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(e){return Math.max(this.minDistance,Math.min(this.maxDistance,e))}_handleMouseDownRotate(e){this._rotateStart.set(e.clientX,e.clientY)}_handleMouseDownDolly(e){this._updateZoomParameters(e.clientX,e.clientX),this._dollyStart.set(e.clientX,e.clientY)}_handleMouseDownPan(e){this._panStart.set(e.clientX,e.clientY)}_handleMouseMoveRotate(e){this._rotateEnd.set(e.clientX,e.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const i=this.domElement;this._rotateLeft(Zo*this._rotateDelta.x/i.clientHeight),this._rotateUp(Zo*this._rotateDelta.y/i.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(e){this._dollyEnd.set(e.clientX,e.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(e){this._panEnd.set(e.clientX,e.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(e){this._updateZoomParameters(e.clientX,e.clientY),e.deltaY<0?this._dollyIn(this._getZoomScale(e.deltaY)):e.deltaY>0&&this._dollyOut(this._getZoomScale(e.deltaY)),this.update()}_handleKeyDown(e){let i=!1;switch(e.code){case this.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateUp(Zo*this.rotateSpeed/this.domElement.clientHeight):this._pan(0,this.keyPanSpeed),i=!0;break;case this.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateUp(-Zo*this.rotateSpeed/this.domElement.clientHeight):this._pan(0,-this.keyPanSpeed),i=!0;break;case this.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateLeft(Zo*this.rotateSpeed/this.domElement.clientHeight):this._pan(this.keyPanSpeed,0),i=!0;break;case this.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateLeft(-Zo*this.rotateSpeed/this.domElement.clientHeight):this._pan(-this.keyPanSpeed,0),i=!0;break}i&&(e.preventDefault(),this.update())}_handleTouchStartRotate(e){if(this._pointers.length===1)this._rotateStart.set(e.pageX,e.pageY);else{const i=this._getSecondPointerPosition(e),n=.5*(e.pageX+i.x),s=.5*(e.pageY+i.y);this._rotateStart.set(n,s)}}_handleTouchStartPan(e){if(this._pointers.length===1)this._panStart.set(e.pageX,e.pageY);else{const i=this._getSecondPointerPosition(e),n=.5*(e.pageX+i.x),s=.5*(e.pageY+i.y);this._panStart.set(n,s)}}_handleTouchStartDolly(e){const i=this._getSecondPointerPosition(e),n=e.pageX-i.x,s=e.pageY-i.y,o=Math.sqrt(n*n+s*s);this._dollyStart.set(0,o)}_handleTouchStartDollyPan(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enablePan&&this._handleTouchStartPan(e)}_handleTouchStartDollyRotate(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enableRotate&&this._handleTouchStartRotate(e)}_handleTouchMoveRotate(e){if(this._pointers.length==1)this._rotateEnd.set(e.pageX,e.pageY);else{const n=this._getSecondPointerPosition(e),s=.5*(e.pageX+n.x),o=.5*(e.pageY+n.y);this._rotateEnd.set(s,o)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const i=this.domElement;this._rotateLeft(Zo*this._rotateDelta.x/i.clientHeight),this._rotateUp(Zo*this._rotateDelta.y/i.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(e){if(this._pointers.length===1)this._panEnd.set(e.pageX,e.pageY);else{const i=this._getSecondPointerPosition(e),n=.5*(e.pageX+i.x),s=.5*(e.pageY+i.y);this._panEnd.set(n,s)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(e){const i=this._getSecondPointerPosition(e),n=e.pageX-i.x,s=e.pageY-i.y,o=Math.sqrt(n*n+s*s);this._dollyEnd.set(0,o),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const l=(e.pageX+i.x)*.5,u=(e.pageY+i.y)*.5;this._updateZoomParameters(l,u)}_handleTouchMoveDollyPan(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enablePan&&this._handleTouchMovePan(e)}_handleTouchMoveDollyRotate(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enableRotate&&this._handleTouchMoveRotate(e)}_addPointer(e){this._pointers.push(e.pointerId)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let i=0;i<this._pointers.length;i++)if(this._pointers[i]==e.pointerId){this._pointers.splice(i,1);return}}_isTrackingPointer(e){for(let i=0;i<this._pointers.length;i++)if(this._pointers[i]==e.pointerId)return!0;return!1}_trackPointer(e){let i=this._pointerPositions[e.pointerId];i===void 0&&(i=new ji,this._pointerPositions[e.pointerId]=i),i.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){const i=e.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[i]}_customWheelEvent(e){const i=e.deltaMode,n={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(i){case 1:n.deltaY*=16;break;case 2:n.deltaY*=100;break}return e.ctrlKey&&!this._controlActive&&(n.deltaY*=10),n}}function lye(r){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(r.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(r)&&(this._addPointer(r),r.pointerType==="touch"?this._onTouchStart(r):this._onMouseDown(r)))}function cye(r){this.enabled!==!1&&(r.pointerType==="touch"?this._onTouchMove(r):this._onMouseMove(r))}function uye(r){switch(this._removePointer(r),this._pointers.length){case 0:this.domElement.releasePointerCapture(r.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent($z),this.state=us.NONE;break;case 1:const e=this._pointers[0],i=this._pointerPositions[e];this._onTouchStart({pointerId:e,pageX:i.x,pageY:i.y});break}}function hye(r){let e;switch(r.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case Ua.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(r),this.state=us.DOLLY;break;case Ua.ROTATE:if(r.ctrlKey||r.metaKey||r.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(r),this.state=us.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(r),this.state=us.ROTATE}break;case Ua.PAN:if(r.ctrlKey||r.metaKey||r.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(r),this.state=us.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(r),this.state=us.PAN}break;default:this.state=us.NONE}this.state!==us.NONE&&this.dispatchEvent(tI)}function dye(r){switch(this.state){case us.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(r);break;case us.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(r);break;case us.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(r);break}}function pye(r){this.enabled===!1||this.enableZoom===!1||this.state!==us.NONE||(r.preventDefault(),this.dispatchEvent(tI),this._handleMouseWheel(this._customWheelEvent(r)),this.dispatchEvent($z))}function fye(r){this.enabled===!1||this.enablePan===!1||this._handleKeyDown(r)}function mye(r){switch(this._trackPointer(r),this._pointers.length){case 1:switch(this.touches.ONE){case yu.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(r),this.state=us.TOUCH_ROTATE;break;case yu.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(r),this.state=us.TOUCH_PAN;break;default:this.state=us.NONE}break;case 2:switch(this.touches.TWO){case yu.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(r),this.state=us.TOUCH_DOLLY_PAN;break;case yu.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(r),this.state=us.TOUCH_DOLLY_ROTATE;break;default:this.state=us.NONE}break;default:this.state=us.NONE}this.state!==us.NONE&&this.dispatchEvent(tI)}function gye(r){switch(this._trackPointer(r),this.state){case us.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(r),this.update();break;case us.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(r),this.update();break;case us.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(r),this.update();break;case us.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(r),this.update();break;default:this.state=us.NONE}}function Aye(r){this.enabled!==!1&&r.preventDefault()}function yye(r){r.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function vye(r){r.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}const xye={type:"change"},t7=1e-6,i7=new Uc;class bye extends Gb{constructor(e,i=null){super(e,i),this.movementSpeed=1,this.rollSpeed=.005,this.dragToLook=!1,this.autoForward=!1,this._moveState={up:0,down:0,left:0,right:0,forward:0,back:0,pitchUp:0,pitchDown:0,yawLeft:0,yawRight:0,rollLeft:0,rollRight:0},this._moveVector=new at(0,0,0),this._rotationVector=new at(0,0,0),this._lastQuaternion=new Uc,this._lastPosition=new at,this._status=0,this._onKeyDown=_ye.bind(this),this._onKeyUp=Eye.bind(this),this._onPointerMove=Cye.bind(this),this._onPointerDown=wye.bind(this),this._onPointerUp=Sye.bind(this),this._onPointerCancel=Tye.bind(this),this._onContextMenu=Mye.bind(this),i!==null&&this.connect()}connect(){window.addEventListener("keydown",this._onKeyDown),window.addEventListener("keyup",this._onKeyUp),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointerup",this._onPointerUp),this.domElement.addEventListener("pointercancel",this._onPointerCancel),this.domElement.addEventListener("contextmenu",this._onContextMenu)}disconnect(){window.removeEventListener("keydown",this._onKeyDown),window.removeEventListener("keyup",this._onKeyUp),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerCancel),this.domElement.removeEventListener("contextmenu",this._onContextMenu)}dispose(){this.disconnect()}update(e){if(this.enabled===!1)return;const i=this.object,n=e*this.movementSpeed,s=e*this.rollSpeed;i.translateX(this._moveVector.x*n),i.translateY(this._moveVector.y*n),i.translateZ(this._moveVector.z*n),i7.set(this._rotationVector.x*s,this._rotationVector.y*s,this._rotationVector.z*s,1).normalize(),i.quaternion.multiply(i7),(this._lastPosition.distanceToSquared(i.position)>t7||8*(1-this._lastQuaternion.dot(i.quaternion))>t7)&&(this.dispatchEvent(xye),this._lastQuaternion.copy(i.quaternion),this._lastPosition.copy(i.position))}_updateMovementVector(){const e=this._moveState.forward||this.autoForward&&!this._moveState.back?1:0;this._moveVector.x=-this._moveState.left+this._moveState.right,this._moveVector.y=-this._moveState.down+this._moveState.up,this._moveVector.z=-e+this._moveState.back}_updateRotationVector(){this._rotationVector.x=-this._moveState.pitchDown+this._moveState.pitchUp,this._rotationVector.y=-this._moveState.yawRight+this._moveState.yawLeft,this._rotationVector.z=-this._moveState.rollRight+this._moveState.rollLeft}_getContainerDimensions(){return this.domElement!=document?{size:[this.domElement.offsetWidth,this.domElement.offsetHeight],offset:[this.domElement.offsetLeft,this.domElement.offsetTop]}:{size:[window.innerWidth,window.innerHeight],offset:[0,0]}}}function _ye(r){if(!(r.altKey||this.enabled===!1)){switch(r.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=.1;break;case"KeyW":this._moveState.forward=1;break;case"KeyS":this._moveState.back=1;break;case"KeyA":this._moveState.left=1;break;case"KeyD":this._moveState.right=1;break;case"KeyR":this._moveState.up=1;break;case"KeyF":this._moveState.down=1;break;case"ArrowUp":this._moveState.pitchUp=1;break;case"ArrowDown":this._moveState.pitchDown=1;break;case"ArrowLeft":this._moveState.yawLeft=1;break;case"ArrowRight":this._moveState.yawRight=1;break;case"KeyQ":this._moveState.rollLeft=1;break;case"KeyE":this._moveState.rollRight=1;break}this._updateMovementVector(),this._updateRotationVector()}}function Eye(r){if(this.enabled!==!1){switch(r.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=1;break;case"KeyW":this._moveState.forward=0;break;case"KeyS":this._moveState.back=0;break;case"KeyA":this._moveState.left=0;break;case"KeyD":this._moveState.right=0;break;case"KeyR":this._moveState.up=0;break;case"KeyF":this._moveState.down=0;break;case"ArrowUp":this._moveState.pitchUp=0;break;case"ArrowDown":this._moveState.pitchDown=0;break;case"ArrowLeft":this._moveState.yawLeft=0;break;case"ArrowRight":this._moveState.yawRight=0;break;case"KeyQ":this._moveState.rollLeft=0;break;case"KeyE":this._moveState.rollRight=0;break}this._updateMovementVector(),this._updateRotationVector()}}function wye(r){if(this.enabled!==!1)if(this.dragToLook)this._status++;else{switch(r.button){case 0:this._moveState.forward=1;break;case 2:this._moveState.back=1;break}this._updateMovementVector()}}function Cye(r){if(this.enabled!==!1&&(!this.dragToLook||this._status>0)){const e=this._getContainerDimensions(),i=e.size[0]/2,n=e.size[1]/2;this._moveState.yawLeft=-(r.pageX-e.offset[0]-i)/i,this._moveState.pitchDown=(r.pageY-e.offset[1]-n)/n,this._updateRotationVector()}}function Sye(r){if(this.enabled!==!1){if(this.dragToLook)this._status--,this._moveState.yawLeft=this._moveState.pitchDown=0;else{switch(r.button){case 0:this._moveState.forward=0;break;case 2:this._moveState.back=0;break}this._updateMovementVector()}this._updateRotationVector()}}function Tye(){this.enabled!==!1&&(this.dragToLook?(this._status=0,this._moveState.yawLeft=this._moveState.pitchDown=0):(this._moveState.forward=0,this._moveState.back=0,this._updateMovementVector()),this._updateRotationVector())}function Mye(r){this.enabled!==!1&&r.preventDefault()}const Rye={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );
			gl_FragColor = opacity * texel;


		}`};class V_{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const Iye=new HS(-1,1,1,-1,0,1);class Bye extends Vo{constructor(){super(),this.setAttribute("position",new fa([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new fa([0,2,0,0,2,0],2))}}const Nye=new Bye;class Lye{constructor(e){this._mesh=new za(Nye,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,Iye)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}class Dye extends V_{constructor(e,i){super(),this.textureID=i!==void 0?i:"tDiffuse",e instanceof zc?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=ak.clone(e.uniforms),this.material=new zc({name:e.name!==void 0?e.name:"unspecified",defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new Lye(this.material)}render(e,i,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(i),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}class r7 extends V_{constructor(e,i){super(),this.scene=e,this.camera=i,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,i,n){const s=e.getContext(),o=e.state;o.buffers.color.setMask(!1),o.buffers.depth.setMask(!1),o.buffers.color.setLocked(!0),o.buffers.depth.setLocked(!0);let l,u;this.inverse?(l=0,u=1):(l=1,u=0),o.buffers.stencil.setTest(!0),o.buffers.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),o.buffers.stencil.setFunc(s.ALWAYS,l,4294967295),o.buffers.stencil.setClear(u),o.buffers.stencil.setLocked(!0),e.setRenderTarget(n),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(i),this.clear&&e.clear(),e.render(this.scene,this.camera),o.buffers.color.setLocked(!1),o.buffers.depth.setLocked(!1),o.buffers.color.setMask(!0),o.buffers.depth.setMask(!0),o.buffers.stencil.setLocked(!1),o.buffers.stencil.setFunc(s.EQUAL,1,4294967295),o.buffers.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),o.buffers.stencil.setLocked(!0)}}class Oye extends V_{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class Pye{constructor(e,i){if(this.renderer=e,this._pixelRatio=e.getPixelRatio(),i===void 0){const n=e.getSize(new ji);this._width=n.width,this._height=n.height,i=new Hh(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:mm}),i.texture.name="EffectComposer.rt1"}else this._width=i.width,this._height=i.height;this.renderTarget1=i,this.renderTarget2=i.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new Dye(Rye),this.copyPass.material.blending=bu,this.clock=new r4}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,i){this.passes.splice(i,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const i=this.passes.indexOf(e);i!==-1&&this.passes.splice(i,1)}isLastEnabledPass(e){for(let i=e+1;i<this.passes.length;i++)if(this.passes[i].enabled)return!1;return!0}render(e){e===void 0&&(e=this.clock.getDelta());const i=this.renderer.getRenderTarget();let n=!1;for(let s=0,o=this.passes.length;s<o;s++){const l=this.passes[s];if(l.enabled!==!1){if(l.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(s),l.render(this.renderer,this.writeBuffer,this.readBuffer,e,n),l.needsSwap){if(n){const u=this.renderer.getContext(),c=this.renderer.state.buffers.stencil;c.setFunc(u.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),c.setFunc(u.EQUAL,1,4294967295)}this.swapBuffers()}r7!==void 0&&(l instanceof r7?n=!0:l instanceof Oye&&(n=!1))}}this.renderer.setRenderTarget(i)}reset(e){if(e===void 0){const i=this.renderer.getSize(new ji);this._pixelRatio=this.renderer.getPixelRatio(),this._width=i.width,this._height=i.height,e=this.renderTarget1.clone(),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,i){this._width=e,this._height=i;const n=this._width*this._pixelRatio,s=this._height*this._pixelRatio;this.renderTarget1.setSize(n,s),this.renderTarget2.setSize(n,s);for(let o=0;o<this.passes.length;o++)this.passes[o].setSize(n,s)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}class kye extends V_{constructor(e,i,n=null,s=null,o=null){super(),this.scene=e,this.camera=i,this.overrideMaterial=n,this.clearColor=s,this.clearAlpha=o,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new Tn}render(e,i,n){const s=e.autoClear;e.autoClear=!1;let o,l;this.overrideMaterial!==null&&(l=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor!==null&&(e.getClearColor(this._oldClearColor),e.setClearColor(this.clearColor,e.getClearAlpha())),this.clearAlpha!==null&&(o=e.getClearAlpha(),e.setClearAlpha(this.clearAlpha)),this.clearDepth==!0&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:n),this.clear===!0&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor!==null&&e.setClearColor(this._oldClearColor),this.clearAlpha!==null&&e.setClearAlpha(o),this.overrideMaterial!==null&&(this.scene.overrideMaterial=l),e.autoClear=s}}var oh=Object.freeze({Linear:Object.freeze({None:function(r){return r},In:function(r){return r},Out:function(r){return r},InOut:function(r){return r}}),Quadratic:Object.freeze({In:function(r){return r*r},Out:function(r){return r*(2-r)},InOut:function(r){return(r*=2)<1?.5*r*r:-.5*(--r*(r-2)-1)}}),Cubic:Object.freeze({In:function(r){return r*r*r},Out:function(r){return--r*r*r+1},InOut:function(r){return(r*=2)<1?.5*r*r*r:.5*((r-=2)*r*r+2)}}),Quartic:Object.freeze({In:function(r){return r*r*r*r},Out:function(r){return 1- --r*r*r*r},InOut:function(r){return(r*=2)<1?.5*r*r*r*r:-.5*((r-=2)*r*r*r-2)}}),Quintic:Object.freeze({In:function(r){return r*r*r*r*r},Out:function(r){return--r*r*r*r*r+1},InOut:function(r){return(r*=2)<1?.5*r*r*r*r*r:.5*((r-=2)*r*r*r*r+2)}}),Sinusoidal:Object.freeze({In:function(r){return 1-Math.sin((1-r)*Math.PI/2)},Out:function(r){return Math.sin(r*Math.PI/2)},InOut:function(r){return .5*(1-Math.sin(Math.PI*(.5-r)))}}),Exponential:Object.freeze({In:function(r){return r===0?0:Math.pow(1024,r-1)},Out:function(r){return r===1?1:1-Math.pow(2,-10*r)},InOut:function(r){return r===0?0:r===1?1:(r*=2)<1?.5*Math.pow(1024,r-1):.5*(-Math.pow(2,-10*(r-1))+2)}}),Circular:Object.freeze({In:function(r){return 1-Math.sqrt(1-r*r)},Out:function(r){return Math.sqrt(1- --r*r)},InOut:function(r){return(r*=2)<1?-.5*(Math.sqrt(1-r*r)-1):.5*(Math.sqrt(1-(r-=2)*r)+1)}}),Elastic:Object.freeze({In:function(r){return r===0?0:r===1?1:-Math.pow(2,10*(r-1))*Math.sin((r-1.1)*5*Math.PI)},Out:function(r){return r===0?0:r===1?1:Math.pow(2,-10*r)*Math.sin((r-.1)*5*Math.PI)+1},InOut:function(r){return r===0?0:r===1?1:(r*=2,r<1?-.5*Math.pow(2,10*(r-1))*Math.sin((r-1.1)*5*Math.PI):.5*Math.pow(2,-10*(r-1))*Math.sin((r-1.1)*5*Math.PI)+1)}}),Back:Object.freeze({In:function(r){var e=1.70158;return r===1?1:r*r*((e+1)*r-e)},Out:function(r){var e=1.70158;return r===0?0:--r*r*((e+1)*r+e)+1},InOut:function(r){var e=2.5949095;return(r*=2)<1?.5*(r*r*((e+1)*r-e)):.5*((r-=2)*r*((e+1)*r+e)+2)}}),Bounce:Object.freeze({In:function(r){return 1-oh.Bounce.Out(1-r)},Out:function(r){return r<1/2.75?7.5625*r*r:r<2/2.75?7.5625*(r-=1.5/2.75)*r+.75:r<2.5/2.75?7.5625*(r-=2.25/2.75)*r+.9375:7.5625*(r-=2.625/2.75)*r+.984375},InOut:function(r){return r<.5?oh.Bounce.In(r*2)*.5:oh.Bounce.Out(r*2-1)*.5+.5}}),generatePow:function(r){return r===void 0&&(r=4),r=r<Number.EPSILON?Number.EPSILON:r,r=r>1e4?1e4:r,{In:function(e){return Math.pow(e,r)},Out:function(e){return 1-Math.pow(1-e,r)},InOut:function(e){return e<.5?Math.pow(e*2,r)/2:(1-Math.pow(2-e*2,r))/2+.5}}}}),zy=function(){return performance.now()},rI=function(){function r(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];this._tweens={},this._tweensAddedDuringUpdate={},this.add.apply(this,e)}return r.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(i){return e._tweens[i]})},r.prototype.removeAll=function(){this._tweens={}},r.prototype.add=function(){for(var e,i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];for(var s=0,o=i;s<o.length;s++){var l=o[s];(e=l._group)===null||e===void 0||e.remove(l),l._group=this,this._tweens[l.getId()]=l,this._tweensAddedDuringUpdate[l.getId()]=l}},r.prototype.remove=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];for(var n=0,s=e;n<s.length;n++){var o=s[n];o._group=void 0,delete this._tweens[o.getId()],delete this._tweensAddedDuringUpdate[o.getId()]}},r.prototype.allStopped=function(){return this.getAll().every(function(e){return!e.isPlaying()})},r.prototype.update=function(e,i){e===void 0&&(e=zy()),i===void 0&&(i=!0);var n=Object.keys(this._tweens);if(n.length!==0)for(;n.length>0;){this._tweensAddedDuringUpdate={};for(var s=0;s<n.length;s++){var o=this._tweens[n[s]],l=!i;o&&o.update(e,l)===!1&&!i&&this.remove(o)}n=Object.keys(this._tweensAddedDuringUpdate)}},r}(),nI={Linear:function(r,e){var i=r.length-1,n=i*e,s=Math.floor(n),o=nI.Utils.Linear;return e<0?o(r[0],r[1],n):e>1?o(r[i],r[i-1],i-n):o(r[s],r[s+1>i?i:s+1],n-s)},Utils:{Linear:function(r,e,i){return(e-r)*i+r}}},n7=function(){function r(){}return r.nextId=function(){return r._nextId++},r._nextId=0,r}(),sI=new rI,G_=function(){function r(e,i){this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=oh.Linear.None,this._interpolationFunction=nI.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=n7.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1,this._object=e,typeof i=="object"?(this._group=i,i.add(this)):i===!0&&(this._group=sI,sI.add(this))}return r.prototype.getId=function(){return this._id},r.prototype.isPlaying=function(){return this._isPlaying},r.prototype.isPaused=function(){return this._isPaused},r.prototype.getDuration=function(){return this._duration},r.prototype.to=function(e,i){if(i===void 0&&(i=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=i<0?0:i,this},r.prototype.duration=function(e){return e===void 0&&(e=1e3),this._duration=e<0?0:e,this},r.prototype.dynamic=function(e){return e===void 0&&(e=!1),this._isDynamic=e,this},r.prototype.start=function(e,i){if(e===void 0&&(e=zy()),i===void 0&&(i=!1),this._isPlaying)return this;if(this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var n in this._valuesStartRepeat)this._swapEndStartRepeatValues(n),this._valuesStart[n]=this._valuesStartRepeat[n]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||i){if(this._propertiesAreSetUp=!0,!this._isDynamic){var s={};for(var o in this._valuesEnd)s[o]=this._valuesEnd[o];this._valuesEnd=s}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,i)}return this},r.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},r.prototype._setupProperties=function(e,i,n,s,o){for(var l in n){var u=e[l],c=Array.isArray(u),h=c?"array":typeof u,p=!c&&Array.isArray(n[l]);if(!(h==="undefined"||h==="function")){if(p){var f=n[l];if(f.length===0)continue;for(var m=[u],g=0,y=f.length;g<y;g+=1){var x=this._handleRelativeValue(u,f[g]);if(isNaN(x)){p=!1,console.warn("Found invalid interpolation list. Skipping.");break}m.push(x)}p&&(n[l]=m)}if((h==="object"||c)&&u&&!p){i[l]=c?[]:{};var v=u;for(var _ in v)i[l][_]=v[_];s[l]=c?[]:{};var f=n[l];if(!this._isDynamic){var T={};for(var _ in f)T[_]=f[_];n[l]=f=T}this._setupProperties(v,i[l],f,s[l],o)}else(typeof i[l]>"u"||o)&&(i[l]=u),c||(i[l]*=1),p?s[l]=n[l].slice().reverse():s[l]=i[l]||0}}},r.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},r.prototype.end=function(){return this._goToEnd=!0,this.update(this._startTime+this._duration),this},r.prototype.pause=function(e){return e===void 0&&(e=zy()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=e,this)},r.prototype.resume=function(e){return e===void 0&&(e=zy()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this)},r.prototype.stopChainedTweens=function(){for(var e=0,i=this._chainedTweens.length;e<i;e++)this._chainedTweens[e].stop();return this},r.prototype.group=function(e){return e?(e.add(this),this):(console.warn("tween.group() without args has been removed, use group.add(tween) instead."),this)},r.prototype.remove=function(){var e;return(e=this._group)===null||e===void 0||e.remove(this),this},r.prototype.delay=function(e){return e===void 0&&(e=0),this._delayTime=e,this},r.prototype.repeat=function(e){return e===void 0&&(e=0),this._initialRepeat=e,this._repeat=e,this},r.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},r.prototype.yoyo=function(e){return e===void 0&&(e=!1),this._yoyo=e,this},r.prototype.easing=function(e){return e===void 0&&(e=oh.Linear.None),this._easingFunction=e,this},r.prototype.interpolation=function(e){return e===void 0&&(e=nI.Linear),this._interpolationFunction=e,this},r.prototype.chain=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];return this._chainedTweens=e,this},r.prototype.onStart=function(e){return this._onStartCallback=e,this},r.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},r.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},r.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},r.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},r.prototype.onStop=function(e){return this._onStopCallback=e,this},r.prototype.update=function(e,i){var n=this,s;if(e===void 0&&(e=zy()),i===void 0&&(i=r.autoStartOnUpdate),this._isPaused)return!0;var o;if(!this._goToEnd&&!this._isPlaying)if(i)this.start(e,!0);else return!1;if(this._goToEnd=!1,e<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var l=e-this._startTime,u=this._duration+((s=this._repeatDelayTime)!==null&&s!==void 0?s:this._delayTime),c=this._duration+this._repeat*u,h=function(){if(n._duration===0||l>c)return 1;var x=Math.trunc(l/u),v=l-x*u,_=Math.min(v/n._duration,1);return _===0&&l===n._duration?1:_},p=h(),f=this._easingFunction(p);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,f),this._onUpdateCallback&&this._onUpdateCallback(this._object,p),this._duration===0||l>=this._duration)if(this._repeat>0){var m=Math.min(Math.trunc((l-this._duration)/u)+1,this._repeat);isFinite(this._repeat)&&(this._repeat-=m);for(o in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[o]=="string"&&(this._valuesStartRepeat[o]=this._valuesStartRepeat[o]+parseFloat(this._valuesEnd[o])),this._yoyo&&this._swapEndStartRepeatValues(o),this._valuesStart[o]=this._valuesStartRepeat[o];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=u*m,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var g=0,y=this._chainedTweens.length;g<y;g++)this._chainedTweens[g].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},r.prototype._updateProperties=function(e,i,n,s){for(var o in n)if(i[o]!==void 0){var l=i[o]||0,u=n[o],c=Array.isArray(e[o]),h=Array.isArray(u),p=!c&&h;p?e[o]=this._interpolationFunction(u,s):typeof u=="object"&&u?this._updateProperties(e[o],l,u,s):(u=this._handleRelativeValue(l,u),typeof u=="number"&&(e[o]=l+(u-l)*s))}},r.prototype._handleRelativeValue=function(e,i){return typeof i!="string"?i:i.charAt(0)==="+"||i.charAt(0)==="-"?e+parseFloat(i):parseFloat(i)},r.prototype._swapEndStartRepeatValues=function(e){var i=this._valuesStartRepeat[e],n=this._valuesEnd[e];typeof n=="string"?this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(n):this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=i},r.autoStartOnUpdate=!1,r}();n7.nextId;var Kc=sI;Kc.getAll.bind(Kc),Kc.removeAll.bind(Kc),Kc.add.bind(Kc),Kc.remove.bind(Kc),Kc.update.bind(Kc);function Fye(r,e){e===void 0&&(e={});var i=e.insertAt;if(!(typeof document>"u")){var n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",i==="top"&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=r:s.appendChild(document.createTextNode(r))}}var Uye=`.scene-nav-info {
  bottom: 5px;
  width: 100%;
  text-align: center;
  color: slategrey;
  opacity: 0.7;
  font-size: 10px;
}

.scene-tooltip {
  top: 0;
  color: lavender;
  font-size: 15px;
}

.scene-nav-info, .scene-tooltip {
  position: absolute;
  font-family: sans-serif;
  pointer-events: none;
  user-select: none;
}

.scene-container canvas:focus {
  outline: none;
}`;Fye(Uye);function aI(r,e){(e==null||e>r.length)&&(e=r.length);for(var i=0,n=Array(e);i<e;i++)n[i]=r[i];return n}function zye(r){if(Array.isArray(r))return r}function jye(r){if(Array.isArray(r))return aI(r)}function Vye(r,e,i){return(e=Yye(e))in r?Object.defineProperty(r,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[e]=i,r}function Gye(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Hye(r,e){var i=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(i!=null){var n,s,o,l,u=[],c=!0,h=!1;try{if(o=(i=i.call(r)).next,e!==0)for(;!(c=(n=o.call(i)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(p){h=!0,s=p}finally{try{if(!c&&i.return!=null&&(l=i.return(),Object(l)!==l))return}finally{if(h)throw s}}return u}}function Wye(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qye(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qye(r,e){return zye(r)||Hye(r,e)||s7(r,e)||Wye()}function jy(r){return jye(r)||Gye(r)||s7(r)||Qye()}function Xye(r,e){if(typeof r!="object"||!r)return r;var i=r[Symbol.toPrimitive];if(i!==void 0){var n=i.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function Yye(r){var e=Xye(r,"string");return typeof e=="symbol"?e:e+""}function s7(r,e){if(r){if(typeof r=="string")return aI(r,e);var i={}.toString.call(r).slice(8,-1);return i==="Object"&&r.constructor&&(i=r.constructor.name),i==="Map"||i==="Set"?Array.from(r):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?aI(r,e):void 0}}var Ts=window.THREE?window.THREE:{WebGLRenderer:Mie,Scene:Rie,PerspectiveCamera:Dl,Raycaster:a4,SRGBColorSpace:zo,TextureLoader:Zie,Vector2:ji,Vector3:at,Box3:hp,Color:Tn,Mesh:za,SphereGeometry:Vb,MeshBasicMaterial:Jh,BackSide:vo,Clock:r4},a7=Ep({props:{width:{default:window.innerWidth,onChange:function(r,e,i){isNaN(r)&&(e.width=i)}},height:{default:window.innerHeight,onChange:function(r,e,i){isNaN(r)&&(e.height=i)}},backgroundColor:{default:"#000011"},backgroundImageUrl:{},onBackgroundImageLoaded:{},showNavInfo:{default:!0},skyRadius:{default:5e4},objects:{default:[]},lights:{default:[]},enablePointerInteraction:{default:!0,onChange:function(r,e){e.hoverObj=null,e.toolTipElem&&(e.toolTipElem.innerHTML="")},triggerUpdate:!1},lineHoverPrecision:{default:1,triggerUpdate:!1},hoverOrderComparator:{default:function(){return-1},triggerUpdate:!1},hoverFilter:{default:function(){return!0},triggerUpdate:!1},tooltipContent:{triggerUpdate:!1},hoverDuringDrag:{default:!1,triggerUpdate:!1},clickAfterDrag:{default:!1,triggerUpdate:!1},onHover:{default:function(){},triggerUpdate:!1},onClick:{default:function(){},triggerUpdate:!1},onRightClick:{triggerUpdate:!1}},methods:{tick:function(r){if(r.initialised){if(r.controls.update&&r.controls.update(Math.min(1,r.clock.getDelta())),r.postProcessingComposer?r.postProcessingComposer.render():r.renderer.render(r.scene,r.camera),r.extraRenderers.forEach(function(s){return s.render(r.scene,r.camera)}),r.enablePointerInteraction){var e=null;if(r.hoverDuringDrag||!r.isPointerDragging){var i=this.intersectingObjects(r.pointerPos.x,r.pointerPos.y).filter(function(s){return r.hoverFilter(s.object)}).sort(function(s,o){return r.hoverOrderComparator(s.object,o.object)}),n=i.length?i[0]:null;e=n?n.object:null,r.intersectionPoint=n?n.point:null}e!==r.hoverObj&&(r.onHover(e,r.hoverObj),r.toolTipElem.innerHTML=e&&gr(r.tooltipContent)(e)||"",r.hoverObj=e)}r.tweenGroup.update()}return this},getPointerPos:function(r){var e=r.pointerPos,i=e.x,n=e.y;return{x:i,y:n}},cameraPosition:function(r,e,i,n){var s=r.camera;if(e&&r.initialised){var o=e,l=i||{x:0,y:0,z:0};if(!n)h(o),p(l);else{var u=Object.assign({},s.position),c=f();r.tweenGroup.add(new G_(u).to(o,n).easing(oh.Quadratic.Out).onUpdate(h).start()),r.tweenGroup.add(new G_(c).to(l,n/3).easing(oh.Quadratic.Out).onUpdate(p).start())}return this}return Object.assign({},s.position,{lookAt:f()});function h(m){var g=m.x,y=m.y,x=m.z;g!==void 0&&(s.position.x=g),y!==void 0&&(s.position.y=y),x!==void 0&&(s.position.z=x)}function p(m){var g=new Ts.Vector3(m.x,m.y,m.z);r.controls.target?r.controls.target=g:s.lookAt(g)}function f(){return Object.assign(new Ts.Vector3(0,0,-1e3).applyQuaternion(s.quaternion).add(s.position))}},zoomToFit:function(r){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,n=arguments.length,s=new Array(n>3?n-3:0),o=3;o<n;o++)s[o-3]=arguments[o];return this.fitToBbox(this.getBbox.apply(this,s),e,i)},fitToBbox:function(r,e){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:10,s=r.camera;if(e){var o=new Ts.Vector3(0,0,0),l=Math.max.apply(Math,jy(Object.entries(e).map(function(m){var g=qye(m,2),y=g[0],x=g[1];return Math.max.apply(Math,jy(x.map(function(v){return Math.abs(o[y]-v)})))})))*2,u=(1-n*2/r.height)*s.fov,c=l/Math.atan(u*Math.PI/180),h=c/s.aspect,p=Math.max(c,h);if(p>0){var f=o.clone().sub(s.position).normalize().multiplyScalar(-p);this.cameraPosition(f,o,i)}}return this},getBbox:function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return!0},i=new Ts.Box3(new Ts.Vector3(0,0,0),new Ts.Vector3(0,0,0)),n=r.objects.filter(e);return n.length?(n.forEach(function(s){return i.expandByObject(s)}),Object.assign.apply(Object,jy(["x","y","z"].map(function(s){return Vye({},s,[i.min[s],i.max[s]])})))):null},getScreenCoords:function(r,e,i,n){var s=new Ts.Vector3(e,i,n);return s.project(this.camera()),{x:(s.x+1)*r.width/2,y:-(s.y-1)*r.height/2}},getSceneCoords:function(r,e,i){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=new Ts.Vector2(e/r.width*2-1,-(i/r.height)*2+1),o=new Ts.Raycaster;return o.setFromCamera(s,r.camera),Object.assign({},o.ray.at(n,new Ts.Vector3))},intersectingObjects:function(r,e,i){var n=new Ts.Vector2(e/r.width*2-1,-(i/r.height)*2+1),s=new Ts.Raycaster;return s.params.Line.threshold=r.lineHoverPrecision,s.setFromCamera(n,r.camera),s.intersectObjects(r.objects,!0)},renderer:function(r){return r.renderer},scene:function(r){return r.scene},camera:function(r){return r.camera},postProcessingComposer:function(r){return r.postProcessingComposer},controls:function(r){return r.controls},tbControls:function(r){return r.controls}},stateInit:function(){return{scene:new Ts.Scene,camera:new Ts.PerspectiveCamera,clock:new Ts.Clock,tweenGroup:new rI}},init:function(r,e){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=i.controlType,s=n===void 0?"trackball":n,o=i.useWebGPU,l=o===void 0?!1:o,u=i.rendererConfig,c=u===void 0?{}:u,h=i.extraRenderers,p=h===void 0?[]:h,f=i.waitForLoadComplete,m=f===void 0?!0:f;r.innerHTML="",r.appendChild(e.container=document.createElement("div")),e.container.className="scene-container",e.container.style.position="relative",e.container.appendChild(e.navInfo=document.createElement("div")),e.navInfo.className="scene-nav-info",e.navInfo.textContent={orbit:"Left-click: rotate, Mouse-wheel/middle-click: zoom, Right-click: pan",trackball:"Left-click: rotate, Mouse-wheel/middle-click: zoom, Right-click: pan",fly:"WASD: move, R|F: up | down, Q|E: roll, up|down: pitch, left|right: yaw"}[s]||"",e.navInfo.style.display=e.showNavInfo?null:"none",e.toolTipElem=document.createElement("div"),e.toolTipElem.classList.add("scene-tooltip"),e.container.appendChild(e.toolTipElem),e.pointerPos=new Ts.Vector2,e.pointerPos.x=-2,e.pointerPos.y=-2,["pointermove","pointerdown"].forEach(function(g){return e.container.addEventListener(g,function(y){if(g==="pointerdown"&&(e.isPointerPressed=!0),!e.isPointerDragging&&y.type==="pointermove"&&(y.pressure>0||e.isPointerPressed)&&(y.pointerType!=="touch"||y.movementX===void 0||[y.movementX,y.movementY].some(function(_){return Math.abs(_)>1}))&&(e.isPointerDragging=!0),e.enablePointerInteraction){var x=v(e.container);e.pointerPos.x=y.pageX-x.left,e.pointerPos.y=y.pageY-x.top,e.toolTipElem.style.top="".concat(e.pointerPos.y,"px"),e.toolTipElem.style.left="".concat(e.pointerPos.x,"px"),e.toolTipElem.style.transform="translate(-".concat(e.pointerPos.x/e.width*100,"%, ").concat(e.height-e.pointerPos.y<100?"calc(-100% - 8px)":"21px",")")}function v(_){var T=_.getBoundingClientRect(),w=window.pageXOffset||document.documentElement.scrollLeft,S=window.pageYOffset||document.documentElement.scrollTop;return{top:T.top+S,left:T.left+w}}},{passive:!0})}),e.container.addEventListener("pointerup",function(g){e.isPointerPressed=!1,!(e.isPointerDragging&&(e.isPointerDragging=!1,!e.clickAfterDrag))&&requestAnimationFrame(function(){g.button===0&&e.onClick(e.hoverObj||null,g,e.intersectionPoint),g.button===2&&e.onRightClick&&e.onRightClick(e.hoverObj||null,g,e.intersectionPoint)})},{passive:!0,capture:!0}),e.container.addEventListener("contextmenu",function(g){e.onRightClick&&g.preventDefault()}),e.renderer=new(l?GAe:Ts.WebGLRenderer)(Object.assign({antialias:!0,alpha:!0},c)),e.renderer.setPixelRatio(Math.min(2,window.devicePixelRatio)),e.container.appendChild(e.renderer.domElement),e.extraRenderers=p,e.extraRenderers.forEach(function(g){g.domElement.style.position="absolute",g.domElement.style.top="0px",g.domElement.style.pointerEvents="none",e.container.appendChild(g.domElement)}),e.postProcessingComposer=new Pye(e.renderer),e.postProcessingComposer.addPass(new kye(e.scene,e.camera)),e.controls=new{trackball:WAe,orbit:oye,fly:bye}[s](e.camera,e.renderer.domElement),s==="fly"&&(e.controls.movementSpeed=300,e.controls.rollSpeed=Math.PI/6,e.controls.dragToLook=!0),(s==="trackball"||s==="orbit")&&(e.controls.minDistance=.1,e.controls.maxDistance=e.skyRadius,e.controls.addEventListener("start",function(){e.controlsEngaged=!0}),e.controls.addEventListener("change",function(){e.controlsEngaged&&(e.controlsDragging=!0)}),e.controls.addEventListener("end",function(){e.controlsEngaged=!1,e.controlsDragging=!1})),[e.renderer,e.postProcessingComposer].concat(jy(e.extraRenderers)).forEach(function(g){return g.setSize(e.width,e.height)}),e.camera.aspect=e.width/e.height,e.camera.updateProjectionMatrix(),e.camera.position.z=1e3,e.scene.add(e.skysphere=new Ts.Mesh),e.skysphere.visible=!1,e.loadComplete=e.scene.visible=!m,window.scene=e.scene},update:function(r,e){if(r.width&&r.height&&(e.hasOwnProperty("width")||e.hasOwnProperty("height"))&&(r.container.style.width="".concat(r.width,"px"),r.container.style.height="".concat(r.height,"px"),[r.renderer,r.postProcessingComposer].concat(jy(r.extraRenderers)).forEach(function(s){return s.setSize(r.width,r.height)}),r.camera.aspect=r.width/r.height,r.camera.updateProjectionMatrix()),e.hasOwnProperty("skyRadius")&&r.skyRadius&&(r.controls.hasOwnProperty("maxDistance")&&e.skyRadius&&(r.controls.maxDistance=Math.min(r.controls.maxDistance,r.skyRadius)),r.camera.far=r.skyRadius*2.5,r.camera.updateProjectionMatrix(),r.skysphere.geometry=new Ts.SphereGeometry(r.skyRadius)),e.hasOwnProperty("backgroundColor")){var i=Tp(r.backgroundColor).alpha;i===void 0&&(i=1),r.renderer.setClearColor(new Ts.Color(nU(1,r.backgroundColor)),i)}e.hasOwnProperty("backgroundImageUrl")&&(r.backgroundImageUrl?new Ts.TextureLoader().load(r.backgroundImageUrl,function(s){s.colorSpace=Ts.SRGBColorSpace,r.skysphere.material=new Ts.MeshBasicMaterial({map:s,side:Ts.BackSide}),r.skysphere.visible=!0,r.onBackgroundImageLoaded&&setTimeout(r.onBackgroundImageLoaded),!r.loadComplete&&n()}):(r.skysphere.visible=!1,r.skysphere.material.map=null,!r.loadComplete&&n())),e.hasOwnProperty("showNavInfo")&&(r.navInfo.style.display=r.showNavInfo?null:"none"),e.hasOwnProperty("lights")&&((e.lights||[]).forEach(function(s){return r.scene.remove(s)}),r.lights.forEach(function(s){return r.scene.add(s)})),e.hasOwnProperty("objects")&&((e.objects||[]).forEach(function(s){return r.scene.remove(s)}),r.objects.forEach(function(s){return r.scene.add(s)}));function n(){r.loadComplete=r.scene.visible=!0}}});function Kye(r,e){e===void 0&&(e={});var i=e.insertAt;if(!(typeof document>"u")){var n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",i==="top"&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=r:s.appendChild(document.createTextNode(r))}}var Jye=`.graph-info-msg {
  top: 50%;
  width: 100%;
  text-align: center;
  color: lavender;
  opacity: 0.7;
  font-size: 22px;
  position: absolute;
  font-family: Sans-serif;
}

.scene-container .clickable {
  cursor: pointer;
}

.scene-container .grabbable {
  cursor: move;
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}

.scene-container .grabbable:active {
  cursor: grabbing;
  cursor: -moz-grabbing;
  cursor: -webkit-grabbing;
}`;Kye(Jye);function oI(r,e){(e==null||e>r.length)&&(e=r.length);for(var i=0,n=Array(e);i<e;i++)n[i]=r[i];return n}function Zye(r){if(Array.isArray(r))return oI(r)}function Vy(r,e,i){return(e=ive(e))in r?Object.defineProperty(r,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[e]=i,r}function $ye(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function eve(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function o7(r,e){var i=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),i.push.apply(i,n)}return i}function H_(r){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?arguments[e]:{};e%2?o7(Object(i),!0).forEach(function(n){Vy(r,n,i[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):o7(Object(i)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(i,n))})}return r}function W_(r){return Zye(r)||$ye(r)||rve(r)||eve()}function tve(r,e){if(typeof r!="object"||!r)return r;var i=r[Symbol.toPrimitive];if(i!==void 0){var n=i.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function ive(r){var e=tve(r,"string");return typeof e=="symbol"?e:e+""}function rve(r,e){if(r){if(typeof r=="string")return oI(r,e);var i={}.toString.call(r).slice(8,-1);return i==="Object"&&r.constructor&&(i=r.constructor.name),i==="Map"||i==="Set"?Array.from(r):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?oI(r,e):void 0}}function l7(r,e){var i=new e;return i._destructor&&i._destructor(),{linkProp:function(n){return{default:i[n](),onChange:function(s,o){o[r][n](s)},triggerUpdate:!1}},linkMethod:function(n){return function(s){for(var o=s[r],l=arguments.length,u=new Array(l>1?l-1:0),c=1;c<l;c++)u[c-1]=arguments[c];var h=o[n].apply(o,u);return h===o?this:h}}}}var lI=window.THREE?window.THREE:{AmbientLight:ire,DirectionalLight:tre,REVISION:Zx},nve=170,c7=l7("forceGraph",JT),sve=Object.assign.apply(Object,W_(["jsonUrl","graphData","numDimensions","dagMode","dagLevelDistance","dagNodeFilter","onDagError","nodeRelSize","nodeId","nodeVal","nodeResolution","nodeColor","nodeAutoColorBy","nodeOpacity","nodeVisibility","nodeThreeObject","nodeThreeObjectExtend","linkSource","linkTarget","linkVisibility","linkColor","linkAutoColorBy","linkOpacity","linkWidth","linkResolution","linkCurvature","linkCurveRotation","linkMaterial","linkThreeObject","linkThreeObjectExtend","linkPositionUpdate","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalArrowResolution","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleResolution","forceEngine","d3AlphaDecay","d3VelocityDecay","d3AlphaMin","ngraphPhysics","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"].map(function(r){return Vy({},r,c7.linkProp(r))}))),ave=Object.assign.apply(Object,W_(["refresh","getGraphBbox","d3Force","d3ReheatSimulation","emitParticle"].map(function(r){return Vy({},r,c7.linkMethod(r))}))),Q_=l7("renderObjs",a7),ove=Object.assign.apply(Object,W_(["width","height","backgroundColor","showNavInfo","enablePointerInteraction"].map(function(r){return Vy({},r,Q_.linkProp(r))}))),lve=Object.assign.apply(Object,W_(["lights","cameraPosition","postProcessingComposer"].map(function(r){return Vy({},r,Q_.linkMethod(r))})).concat([{graph2ScreenCoords:Q_.linkMethod("getScreenCoords"),screen2GraphCoords:Q_.linkMethod("getSceneCoords")}])),cve=Ep({props:H_(H_({nodeLabel:{default:"name",triggerUpdate:!1},linkLabel:{default:"name",triggerUpdate:!1},linkHoverPrecision:{default:1,onChange:function(r,e){return e.renderObjs.lineHoverPrecision(r)},triggerUpdate:!1},enableNavigationControls:{default:!0,onChange:function(r,e){var i=e.renderObjs.controls();i&&(i.enabled=r,r&&i.domElement&&i.domElement.dispatchEvent(new PointerEvent("pointerup")))},triggerUpdate:!1},enableNodeDrag:{default:!0,triggerUpdate:!1},onNodeDrag:{default:function(){},triggerUpdate:!1},onNodeDragEnd:{default:function(){},triggerUpdate:!1},onNodeClick:{triggerUpdate:!1},onNodeRightClick:{triggerUpdate:!1},onNodeHover:{triggerUpdate:!1},onLinkClick:{triggerUpdate:!1},onLinkRightClick:{triggerUpdate:!1},onLinkHover:{triggerUpdate:!1},onBackgroundClick:{triggerUpdate:!1},onBackgroundRightClick:{triggerUpdate:!1}},sve),ove),methods:H_(H_({zoomToFit:function(r,e,i){for(var n,s=arguments.length,o=new Array(s>3?s-3:0),l=3;l<s;l++)o[l-3]=arguments[l];return r.renderObjs.fitToBbox((n=r.forceGraph).getGraphBbox.apply(n,o),e,i),this},pauseAnimation:function(r){return r.animationFrameRequestId!==null&&(cancelAnimationFrame(r.animationFrameRequestId),r.animationFrameRequestId=null),this},resumeAnimation:function(r){return r.animationFrameRequestId===null&&this._animationCycle(),this},_animationCycle:function(r){r.enablePointerInteraction&&(this.renderer().domElement.style.cursor=null),r.forceGraph.tickFrame(),r.renderObjs.tick(),r.animationFrameRequestId=requestAnimationFrame(this._animationCycle)},scene:function(r){return r.renderObjs.scene()},camera:function(r){return r.renderObjs.camera()},renderer:function(r){return r.renderObjs.renderer()},controls:function(r){return r.renderObjs.controls()},tbControls:function(r){return r.renderObjs.tbControls()},_destructor:function(){this.pauseAnimation(),this.graphData({nodes:[],links:[]})}},ave),lve),stateInit:function(r){var e=r.controlType,i=r.rendererConfig,n=r.extraRenderers,s=new JT;return{forceGraph:s,renderObjs:a7({controlType:e,rendererConfig:i,extraRenderers:n}).objects([s]).lights([new lI.AmbientLight(13421772,Math.PI),new lI.DirectionalLight(16777215,.6*Math.PI)])}},init:function(r,e){r.innerHTML="",r.appendChild(e.container=document.createElement("div")),e.container.style.position="relative";var i=document.createElement("div");e.container.appendChild(i),e.renderObjs(i);var n=e.renderObjs.camera(),s=e.renderObjs.renderer(),o=e.renderObjs.controls();o.enabled=!!e.enableNavigationControls,e.lastSetCameraZ=n.position.z;var l;e.container.appendChild(l=document.createElement("div")),l.className="graph-info-msg",l.textContent="",e.forceGraph.onLoading(function(){l.textContent="Loading..."}).onFinishLoading(function(){l.textContent=""}).onUpdate(function(){e.graphData=e.forceGraph.graphData(),n.position.x===0&&n.position.y===0&&n.position.z===e.lastSetCameraZ&&e.graphData.nodes.length&&(n.lookAt(e.forceGraph.position),e.lastSetCameraZ=n.position.z=Math.cbrt(e.graphData.nodes.length)*nve)}).onFinishUpdate(function(){if(e._dragControls){var u=e.graphData.nodes.find(function(h){return h.__initialFixedPos&&!h.__disposeControlsAfterDrag});u?u.__disposeControlsAfterDrag=!0:e._dragControls.dispose(),e._dragControls=void 0}if(e.enableNodeDrag&&e.enablePointerInteraction&&e.forceEngine==="d3"){var c=e._dragControls=new Jle(e.graphData.nodes.map(function(h){return h.__threeObj}).filter(function(h){return h}),n,s.domElement);c.addEventListener("dragstart",function(h){o.enabled=!1,h.object.__initialPos=h.object.position.clone(),h.object.__prevPos=h.object.position.clone();var p=lh(h.object).__data;!p.__initialFixedPos&&(p.__initialFixedPos={fx:p.fx,fy:p.fy,fz:p.fz}),!p.__initialPos&&(p.__initialPos={x:p.x,y:p.y,z:p.z}),["x","y","z"].forEach(function(f){return p["f".concat(f)]=p[f]}),s.domElement.classList.add("grabbable")}),c.addEventListener("drag",function(h){var p=lh(h.object);if(!h.object.hasOwnProperty("__graphObjType")){var f=h.object.__initialPos,m=h.object.__prevPos,g=h.object.position;p.position.add(g.clone().sub(m)),m.copy(g),g.copy(f)}var y=p.__data,x=p.position,v={x:x.x-y.x,y:x.y-y.y,z:x.z-y.z};["x","y","z"].forEach(function(_){return y["f".concat(_)]=y[_]=x[_]}),e.forceGraph.d3AlphaTarget(.3).resetCountdown(),y.__dragged=!0,e.onNodeDrag(y,v)}),c.addEventListener("dragend",function(h){delete h.object.__initialPos,delete h.object.__prevPos;var p=lh(h.object).__data;p.__disposeControlsAfterDrag&&(c.dispose(),delete p.__disposeControlsAfterDrag);var f=p.__initialFixedPos,m=p.__initialPos,g={x:m.x-p.x,y:m.y-p.y,z:m.z-p.z};f&&(["x","y","z"].forEach(function(y){var x="f".concat(y);f[x]===void 0&&delete p[x]}),delete p.__initialFixedPos,delete p.__initialPos,p.__dragged&&(delete p.__dragged,e.onNodeDragEnd(p,g))),e.forceGraph.d3AlphaTarget(0).resetCountdown(),e.enableNavigationControls&&(o.enabled=!0,o.domElement&&o.domElement.ownerDocument&&o.domElement.ownerDocument.dispatchEvent(new PointerEvent("pointerup",{pointerType:"touch"}))),s.domElement.classList.remove("grabbable")})}}),lI.REVISION<155&&(e.renderObjs.renderer().useLegacyLights=!1),e.renderObjs.hoverOrderComparator(function(u,c){var h=lh(u);if(!h)return 1;var p=lh(c);if(!p)return-1;var f=function(m){return m.__graphObjType==="node"};return f(p)-f(h)}).tooltipContent(function(u){var c=lh(u);return c&&gr(e["".concat(c.__graphObjType,"Label")])(c.__data)||""}).hoverDuringDrag(!1).onHover(function(u){var c=lh(u);if(c!==e.hoverObj){var h=e.hoverObj?e.hoverObj.__graphObjType:null,p=e.hoverObj?e.hoverObj.__data:null,f=c?c.__graphObjType:null,m=c?c.__data:null;if(h&&h!==f){var g=e["on".concat(h==="node"?"Node":"Link","Hover")];g&&g(null,p)}if(f){var y=e["on".concat(f==="node"?"Node":"Link","Hover")];y&&y(m,h===f?p:null)}s.domElement.classList[c&&e["on".concat(f==="node"?"Node":"Link","Click")]||!c&&e.onBackgroundClick?"add":"remove"]("clickable"),e.hoverObj=c}}).clickAfterDrag(!1).onClick(function(u,c){var h=lh(u);if(h){var p=e["on".concat(h.__graphObjType==="node"?"Node":"Link","Click")];p&&p(h.__data,c)}else e.onBackgroundClick&&e.onBackgroundClick(c)}).onRightClick(function(u,c){var h=lh(u);if(h){var p=e["on".concat(h.__graphObjType==="node"?"Node":"Link","RightClick")];p&&p(h.__data,c)}else e.onBackgroundRightClick&&e.onBackgroundRightClick(c)}),this._animationCycle()}});function lh(r){for(var e=r;e&&!e.hasOwnProperty("__graphObjType");)e=e.parent;return e}var cI="http://www.w3.org/1999/xhtml";const u7={svg:"http://www.w3.org/2000/svg",xhtml:cI,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function q_(r){var e=r+="",i=e.indexOf(":");return i>=0&&(e=r.slice(0,i))!=="xmlns"&&(r=r.slice(i+1)),u7.hasOwnProperty(e)?{space:u7[e],local:r}:r}function uve(r){return function(){var e=this.ownerDocument,i=this.namespaceURI;return i===cI&&e.documentElement.namespaceURI===cI?e.createElement(r):e.createElementNS(i,r)}}function hve(r){return function(){return this.ownerDocument.createElementNS(r.space,r.local)}}function h7(r){var e=q_(r);return(e.local?hve:uve)(e)}function dve(){}function uI(r){return r==null?dve:function(){return this.querySelector(r)}}function pve(r){typeof r!="function"&&(r=uI(r));for(var e=this._groups,i=e.length,n=new Array(i),s=0;s<i;++s)for(var o=e[s],l=o.length,u=n[s]=new Array(l),c,h,p=0;p<l;++p)(c=o[p])&&(h=r.call(c,c.__data__,p,o))&&("__data__"in c&&(h.__data__=c.__data__),u[p]=h);return new bl(n,this._parents)}function fve(r){return r==null?[]:Array.isArray(r)?r:Array.from(r)}function mve(){return[]}function d7(r){return r==null?mve:function(){return this.querySelectorAll(r)}}function gve(r){return function(){return fve(r.apply(this,arguments))}}function Ave(r){typeof r=="function"?r=gve(r):r=d7(r);for(var e=this._groups,i=e.length,n=[],s=[],o=0;o<i;++o)for(var l=e[o],u=l.length,c,h=0;h<u;++h)(c=l[h])&&(n.push(r.call(c,c.__data__,h,l)),s.push(c));return new bl(n,s)}function p7(r){return function(){return this.matches(r)}}function f7(r){return function(e){return e.matches(r)}}var yve=Array.prototype.find;function vve(r){return function(){return yve.call(this.children,r)}}function xve(){return this.firstElementChild}function bve(r){return this.select(r==null?xve:vve(typeof r=="function"?r:f7(r)))}var _ve=Array.prototype.filter;function Eve(){return Array.from(this.children)}function wve(r){return function(){return _ve.call(this.children,r)}}function Cve(r){return this.selectAll(r==null?Eve:wve(typeof r=="function"?r:f7(r)))}function Sve(r){typeof r!="function"&&(r=p7(r));for(var e=this._groups,i=e.length,n=new Array(i),s=0;s<i;++s)for(var o=e[s],l=o.length,u=n[s]=[],c,h=0;h<l;++h)(c=o[h])&&r.call(c,c.__data__,h,o)&&u.push(c);return new bl(n,this._parents)}function m7(r){return new Array(r.length)}function Tve(){return new bl(this._enter||this._groups.map(m7),this._parents)}function X_(r,e){this.ownerDocument=r.ownerDocument,this.namespaceURI=r.namespaceURI,this._next=null,this._parent=r,this.__data__=e}X_.prototype={constructor:X_,appendChild:function(r){return this._parent.insertBefore(r,this._next)},insertBefore:function(r,e){return this._parent.insertBefore(r,e)},querySelector:function(r){return this._parent.querySelector(r)},querySelectorAll:function(r){return this._parent.querySelectorAll(r)}};function Mve(r){return function(){return r}}function Rve(r,e,i,n,s,o){for(var l=0,u,c=e.length,h=o.length;l<h;++l)(u=e[l])?(u.__data__=o[l],n[l]=u):i[l]=new X_(r,o[l]);for(;l<c;++l)(u=e[l])&&(s[l]=u)}function Ive(r,e,i,n,s,o,l){var u,c,h=new Map,p=e.length,f=o.length,m=new Array(p),g;for(u=0;u<p;++u)(c=e[u])&&(m[u]=g=l.call(c,c.__data__,u,e)+"",h.has(g)?s[u]=c:h.set(g,c));for(u=0;u<f;++u)g=l.call(r,o[u],u,o)+"",(c=h.get(g))?(n[u]=c,c.__data__=o[u],h.delete(g)):i[u]=new X_(r,o[u]);for(u=0;u<p;++u)(c=e[u])&&h.get(m[u])===c&&(s[u]=c)}function Bve(r){return r.__data__}function Nve(r,e){if(!arguments.length)return Array.from(this,Bve);var i=e?Ive:Rve,n=this._parents,s=this._groups;typeof r!="function"&&(r=Mve(r));for(var o=s.length,l=new Array(o),u=new Array(o),c=new Array(o),h=0;h<o;++h){var p=n[h],f=s[h],m=f.length,g=Lve(r.call(p,p&&p.__data__,h,n)),y=g.length,x=u[h]=new Array(y),v=l[h]=new Array(y),_=c[h]=new Array(m);i(p,f,x,v,_,g,e);for(var T=0,w=0,S,R;T<y;++T)if(S=x[T]){for(T>=w&&(w=T+1);!(R=v[w])&&++w<y;);S._next=R||null}}return l=new bl(l,n),l._enter=u,l._exit=c,l}function Lve(r){return typeof r=="object"&&"length"in r?r:Array.from(r)}function Dve(){return new bl(this._exit||this._groups.map(m7),this._parents)}function Ove(r,e,i){var n=this.enter(),s=this,o=this.exit();return typeof r=="function"?(n=r(n),n&&(n=n.selection())):n=n.append(r+""),e!=null&&(s=e(s),s&&(s=s.selection())),i==null?o.remove():i(o),n&&s?n.merge(s).order():s}function Pve(r){for(var e=r.selection?r.selection():r,i=this._groups,n=e._groups,s=i.length,o=n.length,l=Math.min(s,o),u=new Array(s),c=0;c<l;++c)for(var h=i[c],p=n[c],f=h.length,m=u[c]=new Array(f),g,y=0;y<f;++y)(g=h[y]||p[y])&&(m[y]=g);for(;c<s;++c)u[c]=i[c];return new bl(u,this._parents)}function kve(){for(var r=this._groups,e=-1,i=r.length;++e<i;)for(var n=r[e],s=n.length-1,o=n[s],l;--s>=0;)(l=n[s])&&(o&&l.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(l,o),o=l);return this}function Fve(r){r||(r=Uve);function e(f,m){return f&&m?r(f.__data__,m.__data__):!f-!m}for(var i=this._groups,n=i.length,s=new Array(n),o=0;o<n;++o){for(var l=i[o],u=l.length,c=s[o]=new Array(u),h,p=0;p<u;++p)(h=l[p])&&(c[p]=h);c.sort(e)}return new bl(s,this._parents).order()}function Uve(r,e){return r<e?-1:r>e?1:r>=e?0:NaN}function zve(){var r=arguments[0];return arguments[0]=this,r.apply(null,arguments),this}function jve(){return Array.from(this)}function Vve(){for(var r=this._groups,e=0,i=r.length;e<i;++e)for(var n=r[e],s=0,o=n.length;s<o;++s){var l=n[s];if(l)return l}return null}function Gve(){let r=0;for(const e of this)++r;return r}function Hve(){return!this.node()}function Wve(r){for(var e=this._groups,i=0,n=e.length;i<n;++i)for(var s=e[i],o=0,l=s.length,u;o<l;++o)(u=s[o])&&r.call(u,u.__data__,o,s);return this}function Qve(r){return function(){this.removeAttribute(r)}}function qve(r){return function(){this.removeAttributeNS(r.space,r.local)}}function Xve(r,e){return function(){this.setAttribute(r,e)}}function Yve(r,e){return function(){this.setAttributeNS(r.space,r.local,e)}}function Kve(r,e){return function(){var i=e.apply(this,arguments);i==null?this.removeAttribute(r):this.setAttribute(r,i)}}function Jve(r,e){return function(){var i=e.apply(this,arguments);i==null?this.removeAttributeNS(r.space,r.local):this.setAttributeNS(r.space,r.local,i)}}function Zve(r,e){var i=q_(r);if(arguments.length<2){var n=this.node();return i.local?n.getAttributeNS(i.space,i.local):n.getAttribute(i)}return this.each((e==null?i.local?qve:Qve:typeof e=="function"?i.local?Jve:Kve:i.local?Yve:Xve)(i,e))}function g7(r){return r.ownerDocument&&r.ownerDocument.defaultView||r.document&&r||r.defaultView}function $ve(r){return function(){this.style.removeProperty(r)}}function exe(r,e,i){return function(){this.style.setProperty(r,e,i)}}function txe(r,e,i){return function(){var n=e.apply(this,arguments);n==null?this.style.removeProperty(r):this.style.setProperty(r,n,i)}}function ixe(r,e,i){return arguments.length>1?this.each((e==null?$ve:typeof e=="function"?txe:exe)(r,e,i??"")):Vg(this.node(),r)}function Vg(r,e){return r.style.getPropertyValue(e)||g7(r).getComputedStyle(r,null).getPropertyValue(e)}function rxe(r){return function(){delete this[r]}}function nxe(r,e){return function(){this[r]=e}}function sxe(r,e){return function(){var i=e.apply(this,arguments);i==null?delete this[r]:this[r]=i}}function axe(r,e){return arguments.length>1?this.each((e==null?rxe:typeof e=="function"?sxe:nxe)(r,e)):this.node()[r]}function A7(r){return r.trim().split(/^|\s+/)}function hI(r){return r.classList||new y7(r)}function y7(r){this._node=r,this._names=A7(r.getAttribute("class")||"")}y7.prototype={add:function(r){var e=this._names.indexOf(r);e<0&&(this._names.push(r),this._node.setAttribute("class",this._names.join(" ")))},remove:function(r){var e=this._names.indexOf(r);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(r){return this._names.indexOf(r)>=0}};function v7(r,e){for(var i=hI(r),n=-1,s=e.length;++n<s;)i.add(e[n])}function x7(r,e){for(var i=hI(r),n=-1,s=e.length;++n<s;)i.remove(e[n])}function oxe(r){return function(){v7(this,r)}}function lxe(r){return function(){x7(this,r)}}function cxe(r,e){return function(){(e.apply(this,arguments)?v7:x7)(this,r)}}function uxe(r,e){var i=A7(r+"");if(arguments.length<2){for(var n=hI(this.node()),s=-1,o=i.length;++s<o;)if(!n.contains(i[s]))return!1;return!0}return this.each((typeof e=="function"?cxe:e?oxe:lxe)(i,e))}function hxe(){this.textContent=""}function dxe(r){return function(){this.textContent=r}}function pxe(r){return function(){var e=r.apply(this,arguments);this.textContent=e??""}}function fxe(r){return arguments.length?this.each(r==null?hxe:(typeof r=="function"?pxe:dxe)(r)):this.node().textContent}function mxe(){this.innerHTML=""}function gxe(r){return function(){this.innerHTML=r}}function Axe(r){return function(){var e=r.apply(this,arguments);this.innerHTML=e??""}}function yxe(r){return arguments.length?this.each(r==null?mxe:(typeof r=="function"?Axe:gxe)(r)):this.node().innerHTML}function vxe(){this.nextSibling&&this.parentNode.appendChild(this)}function xxe(){return this.each(vxe)}function bxe(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function _xe(){return this.each(bxe)}function Exe(r){var e=typeof r=="function"?r:h7(r);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function wxe(){return null}function Cxe(r,e){var i=typeof r=="function"?r:h7(r),n=e==null?wxe:typeof e=="function"?e:uI(e);return this.select(function(){return this.insertBefore(i.apply(this,arguments),n.apply(this,arguments)||null)})}function Sxe(){var r=this.parentNode;r&&r.removeChild(this)}function Txe(){return this.each(Sxe)}function Mxe(){var r=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(r,this.nextSibling):r}function Rxe(){var r=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(r,this.nextSibling):r}function Ixe(r){return this.select(r?Rxe:Mxe)}function Bxe(r){return arguments.length?this.property("__data__",r):this.node().__data__}function Nxe(r){return function(e){r.call(this,e,this.__data__)}}function Lxe(r){return r.trim().split(/^|\s+/).map(function(e){var i="",n=e.indexOf(".");return n>=0&&(i=e.slice(n+1),e=e.slice(0,n)),{type:e,name:i}})}function Dxe(r){return function(){var e=this.__on;if(e){for(var i=0,n=-1,s=e.length,o;i<s;++i)o=e[i],(!r.type||o.type===r.type)&&o.name===r.name?this.removeEventListener(o.type,o.listener,o.options):e[++n]=o;++n?e.length=n:delete this.__on}}}function Oxe(r,e,i){return function(){var n=this.__on,s,o=Nxe(e);if(n){for(var l=0,u=n.length;l<u;++l)if((s=n[l]).type===r.type&&s.name===r.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=o,s.options=i),s.value=e;return}}this.addEventListener(r.type,o,i),s={type:r.type,name:r.name,value:e,listener:o,options:i},n?n.push(s):this.__on=[s]}}function Pxe(r,e,i){var n=Lxe(r+""),s,o=n.length,l;if(arguments.length<2){var u=this.node().__on;if(u){for(var c=0,h=u.length,p;c<h;++c)for(s=0,p=u[c];s<o;++s)if((l=n[s]).type===p.type&&l.name===p.name)return p.value}return}for(u=e?Oxe:Dxe,s=0;s<o;++s)this.each(u(n[s],e,i));return this}function b7(r,e,i){var n=g7(r),s=n.CustomEvent;typeof s=="function"?s=new s(e,i):(s=n.document.createEvent("Event"),i?(s.initEvent(e,i.bubbles,i.cancelable),s.detail=i.detail):s.initEvent(e,!1,!1)),r.dispatchEvent(s)}function kxe(r,e){return function(){return b7(this,r,e)}}function Fxe(r,e){return function(){return b7(this,r,e.apply(this,arguments))}}function Uxe(r,e){return this.each((typeof e=="function"?Fxe:kxe)(r,e))}function*zxe(){for(var r=this._groups,e=0,i=r.length;e<i;++e)for(var n=r[e],s=0,o=n.length,l;s<o;++s)(l=n[s])&&(yield l)}var _7=[null];function bl(r,e){this._groups=r,this._parents=e}function Gy(){return new bl([[document.documentElement]],_7)}function jxe(){return this}bl.prototype=Gy.prototype={constructor:bl,select:pve,selectAll:Ave,selectChild:bve,selectChildren:Cve,filter:Sve,data:Nve,enter:Tve,exit:Dve,join:Ove,merge:Pve,selection:jxe,order:kve,sort:Fve,call:zve,nodes:jve,node:Vve,size:Gve,empty:Hve,each:Wve,attr:Zve,style:ixe,property:axe,classed:uxe,text:fxe,html:yxe,raise:xxe,lower:_xe,append:Exe,insert:Cxe,remove:Txe,clone:Ixe,datum:Bxe,on:Pxe,dispatch:Uxe,[Symbol.iterator]:zxe};function wc(r){return typeof r=="string"?new bl([[document.querySelector(r)]],[document.documentElement]):new bl([[r]],_7)}function Vxe(r){let e;for(;e=r.sourceEvent;)r=e;return r}function ch(r,e){if(r=Vxe(r),e===void 0&&(e=r.currentTarget),e){var i=e.ownerSVGElement||e;if(i.createSVGPoint){var n=i.createSVGPoint();return n.x=r.clientX,n.y=r.clientY,n=n.matrixTransform(e.getScreenCTM().inverse()),[n.x,n.y]}if(e.getBoundingClientRect){var s=e.getBoundingClientRect();return[r.clientX-s.left-e.clientLeft,r.clientY-s.top-e.clientTop]}}return[r.pageX,r.pageY]}const Gxe={passive:!1},Hy={capture:!0,passive:!1};function dI(r){r.stopImmediatePropagation()}function Gg(r){r.preventDefault(),r.stopImmediatePropagation()}function E7(r){var e=r.document.documentElement,i=wc(r).on("dragstart.drag",Gg,Hy);"onselectstart"in e?i.on("selectstart.drag",Gg,Hy):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function w7(r,e){var i=r.document.documentElement,n=wc(r).on("dragstart.drag",null);e&&(n.on("click.drag",Gg,Hy),setTimeout(function(){n.on("click.drag",null)},0)),"onselectstart"in i?n.on("selectstart.drag",null):(i.style.MozUserSelect=i.__noselect,delete i.__noselect)}const Y_=r=>()=>r;function pI(r,{sourceEvent:e,subject:i,target:n,identifier:s,active:o,x:l,y:u,dx:c,dy:h,dispatch:p}){Object.defineProperties(this,{type:{value:r,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:i,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:l,enumerable:!0,configurable:!0},y:{value:u,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:h,enumerable:!0,configurable:!0},_:{value:p}})}pI.prototype.on=function(){var r=this._.on.apply(this._,arguments);return r===this._?this:r};function Hxe(r){return!r.ctrlKey&&!r.button}function Wxe(){return this.parentNode}function Qxe(r,e){return e??{x:r.x,y:r.y}}function qxe(){return navigator.maxTouchPoints||"ontouchstart"in this}function Xxe(){var r=Hxe,e=Wxe,i=Qxe,n=qxe,s={},o=NA("start","drag","end"),l=0,u,c,h,p,f=0;function m(S){S.on("mousedown.drag",g).filter(n).on("touchstart.drag",v).on("touchmove.drag",_,Gxe).on("touchend.drag touchcancel.drag",T).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function g(S,R){if(!(p||!r.call(this,S,R))){var B=w(this,e.call(this,S,R),S,R,"mouse");B&&(wc(S.view).on("mousemove.drag",y,Hy).on("mouseup.drag",x,Hy),E7(S.view),dI(S),h=!1,u=S.clientX,c=S.clientY,B("start",S))}}function y(S){if(Gg(S),!h){var R=S.clientX-u,B=S.clientY-c;h=R*R+B*B>f}s.mouse("drag",S)}function x(S){wc(S.view).on("mousemove.drag mouseup.drag",null),w7(S.view,h),Gg(S),s.mouse("end",S)}function v(S,R){if(r.call(this,S,R)){var B=S.changedTouches,I=e.call(this,S,R),D=B.length,L,O;for(L=0;L<D;++L)(O=w(this,I,S,R,B[L].identifier,B[L]))&&(dI(S),O("start",S,B[L]))}}function _(S){var R=S.changedTouches,B=R.length,I,D;for(I=0;I<B;++I)(D=s[R[I].identifier])&&(Gg(S),D("drag",S,R[I]))}function T(S){var R=S.changedTouches,B=R.length,I,D;for(p&&clearTimeout(p),p=setTimeout(function(){p=null},500),I=0;I<B;++I)(D=s[R[I].identifier])&&(dI(S),D("end",S,R[I]))}function w(S,R,B,I,D,L){var O=o.copy(),U=ch(L||B,R),Z,G,z;if((z=i.call(S,new pI("beforestart",{sourceEvent:B,target:m,identifier:D,active:l,x:U[0],y:U[1],dx:0,dy:0,dispatch:O}),I))!=null)return Z=z.x-U[0]||0,G=z.y-U[1]||0,function $(Q,H,V){var ne=U,Y;switch(Q){case"start":s[D]=$,Y=l++;break;case"end":delete s[D],--l;case"drag":U=ch(V||H,R),Y=l;break}O.call(Q,S,new pI(Q,{sourceEvent:H,subject:z,target:m,identifier:D,active:Y,x:U[0]+Z,y:U[1]+G,dx:U[0]-ne[0],dy:U[1]-ne[1],dispatch:O}),I)}}return m.filter=function(S){return arguments.length?(r=typeof S=="function"?S:Y_(!!S),m):r},m.container=function(S){return arguments.length?(e=typeof S=="function"?S:Y_(S),m):e},m.subject=function(S){return arguments.length?(i=typeof S=="function"?S:Y_(S),m):i},m.touchable=function(S){return arguments.length?(n=typeof S=="function"?S:Y_(!!S),m):n},m.on=function(){var S=o.on.apply(o,arguments);return S===o?m:S},m.clickDistance=function(S){return arguments.length?(f=(S=+S)*S,m):Math.sqrt(f)},m}var Yxe=NA("start","end","cancel","interrupt"),Kxe=[],C7=0,S7=1,fI=2,K_=3,T7=4,mI=5,J_=6;function Z_(r,e,i,n,s,o){var l=r.__transition;if(!l)r.__transition={};else if(i in l)return;Jxe(r,i,{name:e,index:n,group:s,on:Yxe,tween:Kxe,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:C7})}function gI(r,e){var i=Cc(r,e);if(i.state>C7)throw new Error("too late; already scheduled");return i}function Jc(r,e){var i=Cc(r,e);if(i.state>K_)throw new Error("too late; already running");return i}function Cc(r,e){var i=r.__transition;if(!i||!(i=i[e]))throw new Error("transition not found");return i}function Jxe(r,e,i){var n=r.__transition,s;n[e]=i,i.timer=yT(o,0,i.time);function o(h){i.state=S7,i.timer.restart(l,i.delay,i.time),i.delay<=h&&l(h-i.delay)}function l(h){var p,f,m,g;if(i.state!==S7)return c();for(p in n)if(g=n[p],g.name===i.name){if(g.state===K_)return S4(l);g.state===T7?(g.state=J_,g.timer.stop(),g.on.call("interrupt",r,r.__data__,g.index,g.group),delete n[p]):+p<e&&(g.state=J_,g.timer.stop(),g.on.call("cancel",r,r.__data__,g.index,g.group),delete n[p])}if(S4(function(){i.state===K_&&(i.state=T7,i.timer.restart(u,i.delay,i.time),u(h))}),i.state=fI,i.on.call("start",r,r.__data__,i.index,i.group),i.state===fI){for(i.state=K_,s=new Array(m=i.tween.length),p=0,f=-1;p<m;++p)(g=i.tween[p].value.call(r,r.__data__,i.index,i.group))&&(s[++f]=g);s.length=f+1}}function u(h){for(var p=h<i.duration?i.ease.call(null,h/i.duration):(i.timer.restart(c),i.state=mI,1),f=-1,m=s.length;++f<m;)s[f].call(r,p);i.state===mI&&(i.on.call("end",r,r.__data__,i.index,i.group),c())}function c(){i.state=J_,i.timer.stop(),delete n[e];for(var h in n)return;delete r.__transition}}function $_(r,e){var i=r.__transition,n,s,o=!0,l;if(i){e=e==null?null:e+"";for(l in i){if((n=i[l]).name!==e){o=!1;continue}s=n.state>fI&&n.state<mI,n.state=J_,n.timer.stop(),n.on.call(s?"interrupt":"cancel",r,r.__data__,n.index,n.group),delete i[l]}o&&delete r.__transition}}function Zxe(r){return this.each(function(){$_(this,r)})}function $xe(r,e){var i,n;return function(){var s=Jc(this,r),o=s.tween;if(o!==i){n=i=o;for(var l=0,u=n.length;l<u;++l)if(n[l].name===e){n=n.slice(),n.splice(l,1);break}}s.tween=n}}function ebe(r,e,i){var n,s;if(typeof i!="function")throw new Error;return function(){var o=Jc(this,r),l=o.tween;if(l!==n){s=(n=l).slice();for(var u={name:e,value:i},c=0,h=s.length;c<h;++c)if(s[c].name===e){s[c]=u;break}c===h&&s.push(u)}o.tween=s}}function tbe(r,e){var i=this._id;if(r+="",arguments.length<2){for(var n=Cc(this.node(),i).tween,s=0,o=n.length,l;s<o;++s)if((l=n[s]).name===r)return l.value;return null}return this.each((e==null?$xe:ebe)(i,r,e))}function AI(r,e,i){var n=r._id;return r.each(function(){var s=Jc(this,n);(s.value||(s.value={}))[e]=i.apply(this,arguments)}),function(s){return Cc(s,n).value[e]}}function M7(r,e){var i;return(typeof e=="number"?td:e instanceof GA?MF:(i=GA(e))?(e=i,MF):Lae)(r,e)}function ibe(r){return function(){this.removeAttribute(r)}}function rbe(r){return function(){this.removeAttributeNS(r.space,r.local)}}function nbe(r,e,i){var n,s=i+"",o;return function(){var l=this.getAttribute(r);return l===s?null:l===n?o:o=e(n=l,i)}}function sbe(r,e,i){var n,s=i+"",o;return function(){var l=this.getAttributeNS(r.space,r.local);return l===s?null:l===n?o:o=e(n=l,i)}}function abe(r,e,i){var n,s,o;return function(){var l,u=i(this),c;return u==null?void this.removeAttribute(r):(l=this.getAttribute(r),c=u+"",l===c?null:l===n&&c===s?o:(s=c,o=e(n=l,u)))}}function obe(r,e,i){var n,s,o;return function(){var l,u=i(this),c;return u==null?void this.removeAttributeNS(r.space,r.local):(l=this.getAttributeNS(r.space,r.local),c=u+"",l===c?null:l===n&&c===s?o:(s=c,o=e(n=l,u)))}}function lbe(r,e){var i=q_(r),n=i==="transform"?kae:M7;return this.attrTween(r,typeof e=="function"?(i.local?obe:abe)(i,n,AI(this,"attr."+r,e)):e==null?(i.local?rbe:ibe)(i):(i.local?sbe:nbe)(i,n,e))}function cbe(r,e){return function(i){this.setAttribute(r,e.call(this,i))}}function ube(r,e){return function(i){this.setAttributeNS(r.space,r.local,e.call(this,i))}}function hbe(r,e){var i,n;function s(){var o=e.apply(this,arguments);return o!==n&&(i=(n=o)&&ube(r,o)),i}return s._value=e,s}function dbe(r,e){var i,n;function s(){var o=e.apply(this,arguments);return o!==n&&(i=(n=o)&&cbe(r,o)),i}return s._value=e,s}function pbe(r,e){var i="attr."+r;if(arguments.length<2)return(i=this.tween(i))&&i._value;if(e==null)return this.tween(i,null);if(typeof e!="function")throw new Error;var n=q_(r);return this.tween(i,(n.local?hbe:dbe)(n,e))}function fbe(r,e){return function(){gI(this,r).delay=+e.apply(this,arguments)}}function mbe(r,e){return e=+e,function(){gI(this,r).delay=e}}function gbe(r){var e=this._id;return arguments.length?this.each((typeof r=="function"?fbe:mbe)(e,r)):Cc(this.node(),e).delay}function Abe(r,e){return function(){Jc(this,r).duration=+e.apply(this,arguments)}}function ybe(r,e){return e=+e,function(){Jc(this,r).duration=e}}function vbe(r){var e=this._id;return arguments.length?this.each((typeof r=="function"?Abe:ybe)(e,r)):Cc(this.node(),e).duration}function xbe(r,e){if(typeof e!="function")throw new Error;return function(){Jc(this,r).ease=e}}function bbe(r){var e=this._id;return arguments.length?this.each(xbe(e,r)):Cc(this.node(),e).ease}function _be(r,e){return function(){var i=e.apply(this,arguments);if(typeof i!="function")throw new Error;Jc(this,r).ease=i}}function Ebe(r){if(typeof r!="function")throw new Error;return this.each(_be(this._id,r))}function wbe(r){typeof r!="function"&&(r=p7(r));for(var e=this._groups,i=e.length,n=new Array(i),s=0;s<i;++s)for(var o=e[s],l=o.length,u=n[s]=[],c,h=0;h<l;++h)(c=o[h])&&r.call(c,c.__data__,h,o)&&u.push(c);return new uh(n,this._parents,this._name,this._id)}function Cbe(r){if(r._id!==this._id)throw new Error;for(var e=this._groups,i=r._groups,n=e.length,s=i.length,o=Math.min(n,s),l=new Array(n),u=0;u<o;++u)for(var c=e[u],h=i[u],p=c.length,f=l[u]=new Array(p),m,g=0;g<p;++g)(m=c[g]||h[g])&&(f[g]=m);for(;u<n;++u)l[u]=e[u];return new uh(l,this._parents,this._name,this._id)}function Sbe(r){return(r+"").trim().split(/^|\s+/).every(function(e){var i=e.indexOf(".");return i>=0&&(e=e.slice(0,i)),!e||e==="start"})}function Tbe(r,e,i){var n,s,o=Sbe(e)?gI:Jc;return function(){var l=o(this,r),u=l.on;u!==n&&(s=(n=u).copy()).on(e,i),l.on=s}}function Mbe(r,e){var i=this._id;return arguments.length<2?Cc(this.node(),i).on.on(r):this.each(Tbe(i,r,e))}function Rbe(r){return function(){var e=this.parentNode;for(var i in this.__transition)if(+i!==r)return;e&&e.removeChild(this)}}function Ibe(){return this.on("end.remove",Rbe(this._id))}function Bbe(r){var e=this._name,i=this._id;typeof r!="function"&&(r=uI(r));for(var n=this._groups,s=n.length,o=new Array(s),l=0;l<s;++l)for(var u=n[l],c=u.length,h=o[l]=new Array(c),p,f,m=0;m<c;++m)(p=u[m])&&(f=r.call(p,p.__data__,m,u))&&("__data__"in p&&(f.__data__=p.__data__),h[m]=f,Z_(h[m],e,i,m,h,Cc(p,i)));return new uh(o,this._parents,e,i)}function Nbe(r){var e=this._name,i=this._id;typeof r!="function"&&(r=d7(r));for(var n=this._groups,s=n.length,o=[],l=[],u=0;u<s;++u)for(var c=n[u],h=c.length,p,f=0;f<h;++f)if(p=c[f]){for(var m=r.call(p,p.__data__,f,c),g,y=Cc(p,i),x=0,v=m.length;x<v;++x)(g=m[x])&&Z_(g,e,i,x,m,y);o.push(m),l.push(p)}return new uh(o,l,e,i)}var Lbe=Gy.prototype.constructor;function Dbe(){return new Lbe(this._groups,this._parents)}function Obe(r,e){var i,n,s;return function(){var o=Vg(this,r),l=(this.style.removeProperty(r),Vg(this,r));return o===l?null:o===i&&l===n?s:s=e(i=o,n=l)}}function R7(r){return function(){this.style.removeProperty(r)}}function Pbe(r,e,i){var n,s=i+"",o;return function(){var l=Vg(this,r);return l===s?null:l===n?o:o=e(n=l,i)}}function kbe(r,e,i){var n,s,o;return function(){var l=Vg(this,r),u=i(this),c=u+"";return u==null&&(c=u=(this.style.removeProperty(r),Vg(this,r))),l===c?null:l===n&&c===s?o:(s=c,o=e(n=l,u))}}function Fbe(r,e){var i,n,s,o="style."+e,l="end."+o,u;return function(){var c=Jc(this,r),h=c.on,p=c.value[o]==null?u||(u=R7(e)):void 0;(h!==i||s!==p)&&(n=(i=h).copy()).on(l,s=p),c.on=n}}function Ube(r,e,i){var n=(r+="")=="transform"?Pae:M7;return e==null?this.styleTween(r,Obe(r,n)).on("end.style."+r,R7(r)):typeof e=="function"?this.styleTween(r,kbe(r,n,AI(this,"style."+r,e))).each(Fbe(this._id,r)):this.styleTween(r,Pbe(r,n,e),i).on("end.style."+r,null)}function zbe(r,e,i){return function(n){this.style.setProperty(r,e.call(this,n),i)}}function jbe(r,e,i){var n,s;function o(){var l=e.apply(this,arguments);return l!==s&&(n=(s=l)&&zbe(r,l,i)),n}return o._value=e,o}function Vbe(r,e,i){var n="style."+(r+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;return this.tween(n,jbe(r,e,i??""))}function Gbe(r){return function(){this.textContent=r}}function Hbe(r){return function(){var e=r(this);this.textContent=e??""}}function Wbe(r){return this.tween("text",typeof r=="function"?Hbe(AI(this,"text",r)):Gbe(r==null?"":r+""))}function Qbe(r){return function(e){this.textContent=r.call(this,e)}}function qbe(r){var e,i;function n(){var s=r.apply(this,arguments);return s!==i&&(e=(i=s)&&Qbe(s)),e}return n._value=r,n}function Xbe(r){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(r==null)return this.tween(e,null);if(typeof r!="function")throw new Error;return this.tween(e,qbe(r))}function Ybe(){for(var r=this._name,e=this._id,i=I7(),n=this._groups,s=n.length,o=0;o<s;++o)for(var l=n[o],u=l.length,c,h=0;h<u;++h)if(c=l[h]){var p=Cc(c,e);Z_(c,r,i,h,l,{time:p.time+p.delay+p.duration,delay:0,duration:p.duration,ease:p.ease})}return new uh(n,this._parents,r,i)}function Kbe(){var r,e,i=this,n=i._id,s=i.size();return new Promise(function(o,l){var u={value:l},c={value:function(){--s===0&&o()}};i.each(function(){var h=Jc(this,n),p=h.on;p!==r&&(e=(r=p).copy(),e._.cancel.push(u),e._.interrupt.push(u),e._.end.push(c)),h.on=e}),s===0&&o()})}var Jbe=0;function uh(r,e,i,n){this._groups=r,this._parents=e,this._name=i,this._id=n}function I7(){return++Jbe}var hh=Gy.prototype;uh.prototype={constructor:uh,select:Bbe,selectAll:Nbe,selectChild:hh.selectChild,selectChildren:hh.selectChildren,filter:wbe,merge:Cbe,selection:Dbe,transition:Ybe,call:hh.call,nodes:hh.nodes,node:hh.node,size:hh.size,empty:hh.empty,each:hh.each,on:Mbe,attr:lbe,attrTween:pbe,style:Ube,styleTween:Vbe,text:Wbe,textTween:Xbe,remove:Ibe,tween:tbe,delay:gbe,duration:vbe,ease:bbe,easeVarying:Ebe,end:Kbe,[Symbol.iterator]:hh[Symbol.iterator]};function Zbe(r){return((r*=2)<=1?r*r*r:(r-=2)*r*r+2)/2}var $be={time:null,delay:0,duration:250,ease:Zbe};function e1e(r,e){for(var i;!(i=r.__transition)||!(i=i[e]);)if(!(r=r.parentNode))throw new Error(`transition ${e} not found`);return i}function t1e(r){var e,i;r instanceof uh?(e=r._id,r=r._name):(e=I7(),(i=$be).time=AT(),r=r==null?null:r+"");for(var n=this._groups,s=n.length,o=0;o<s;++o)for(var l=n[o],u=l.length,c,h=0;h<u;++h)(c=l[h])&&Z_(c,r,e,h,l,i||e1e(c,e));return new uh(n,this._parents,r,e)}Gy.prototype.interrupt=Zxe,Gy.prototype.transition=t1e;const eE=r=>()=>r;function i1e(r,{sourceEvent:e,target:i,transform:n,dispatch:s}){Object.defineProperties(this,{type:{value:r,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},transform:{value:n,enumerable:!0,configurable:!0},_:{value:s}})}function dh(r,e,i){this.k=r,this.x=e,this.y=i}dh.prototype={constructor:dh,scale:function(r){return r===1?this:new dh(this.k*r,this.x,this.y)},translate:function(r,e){return r===0&e===0?this:new dh(this.k,this.x+this.k*r,this.y+this.k*e)},apply:function(r){return[r[0]*this.k+this.x,r[1]*this.k+this.y]},applyX:function(r){return r*this.k+this.x},applyY:function(r){return r*this.k+this.y},invert:function(r){return[(r[0]-this.x)/this.k,(r[1]-this.y)/this.k]},invertX:function(r){return(r-this.x)/this.k},invertY:function(r){return(r-this.y)/this.k},rescaleX:function(r){return r.copy().domain(r.range().map(this.invertX,this).map(r.invert,r))},rescaleY:function(r){return r.copy().domain(r.range().map(this.invertY,this).map(r.invert,r))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var yI=new dh(1,0,0);Zc.prototype=dh.prototype;function Zc(r){for(;!r.__zoom;)if(!(r=r.parentNode))return yI;return r.__zoom}function vI(r){r.stopImmediatePropagation()}function Wy(r){r.preventDefault(),r.stopImmediatePropagation()}function r1e(r){return(!r.ctrlKey||r.type==="wheel")&&!r.button}function n1e(){var r=this;return r instanceof SVGElement?(r=r.ownerSVGElement||r,r.hasAttribute("viewBox")?(r=r.viewBox.baseVal,[[r.x,r.y],[r.x+r.width,r.y+r.height]]):[[0,0],[r.width.baseVal.value,r.height.baseVal.value]]):[[0,0],[r.clientWidth,r.clientHeight]]}function B7(){return this.__zoom||yI}function s1e(r){return-r.deltaY*(r.deltaMode===1?.05:r.deltaMode?1:.002)*(r.ctrlKey?10:1)}function a1e(){return navigator.maxTouchPoints||"ontouchstart"in this}function o1e(r,e,i){var n=r.invertX(e[0][0])-i[0][0],s=r.invertX(e[1][0])-i[1][0],o=r.invertY(e[0][1])-i[0][1],l=r.invertY(e[1][1])-i[1][1];return r.translate(s>n?(n+s)/2:Math.min(0,n)||Math.max(0,s),l>o?(o+l)/2:Math.min(0,o)||Math.max(0,l))}function l1e(){var r=r1e,e=n1e,i=o1e,n=s1e,s=a1e,o=[0,1/0],l=[[-1/0,-1/0],[1/0,1/0]],u=250,c=jae,h=NA("start","zoom","end"),p,f,m,g=500,y=150,x=0,v=10;function _(z){z.property("__zoom",B7).on("wheel.zoom",D,{passive:!1}).on("mousedown.zoom",L).on("dblclick.zoom",O).filter(s).on("touchstart.zoom",U).on("touchmove.zoom",Z).on("touchend.zoom touchcancel.zoom",G).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}_.transform=function(z,$,Q,H){var V=z.selection?z.selection():z;V.property("__zoom",B7),z!==V?R(z,$,Q,H):V.interrupt().each(function(){B(this,arguments).event(H).start().zoom(null,typeof $=="function"?$.apply(this,arguments):$).end()})},_.scaleBy=function(z,$,Q,H){_.scaleTo(z,function(){var V=this.__zoom.k,ne=typeof $=="function"?$.apply(this,arguments):$;return V*ne},Q,H)},_.scaleTo=function(z,$,Q,H){_.transform(z,function(){var V=e.apply(this,arguments),ne=this.__zoom,Y=Q==null?S(V):typeof Q=="function"?Q.apply(this,arguments):Q,ae=ne.invert(Y),xe=typeof $=="function"?$.apply(this,arguments):$;return i(w(T(ne,xe),Y,ae),V,l)},Q,H)},_.translateBy=function(z,$,Q,H){_.transform(z,function(){return i(this.__zoom.translate(typeof $=="function"?$.apply(this,arguments):$,typeof Q=="function"?Q.apply(this,arguments):Q),e.apply(this,arguments),l)},null,H)},_.translateTo=function(z,$,Q,H,V){_.transform(z,function(){var ne=e.apply(this,arguments),Y=this.__zoom,ae=H==null?S(ne):typeof H=="function"?H.apply(this,arguments):H;return i(yI.translate(ae[0],ae[1]).scale(Y.k).translate(typeof $=="function"?-$.apply(this,arguments):-$,typeof Q=="function"?-Q.apply(this,arguments):-Q),ne,l)},H,V)};function T(z,$){return $=Math.max(o[0],Math.min(o[1],$)),$===z.k?z:new dh($,z.x,z.y)}function w(z,$,Q){var H=$[0]-Q[0]*z.k,V=$[1]-Q[1]*z.k;return H===z.x&&V===z.y?z:new dh(z.k,H,V)}function S(z){return[(+z[0][0]+ +z[1][0])/2,(+z[0][1]+ +z[1][1])/2]}function R(z,$,Q,H){z.on("start.zoom",function(){B(this,arguments).event(H).start()}).on("interrupt.zoom end.zoom",function(){B(this,arguments).event(H).end()}).tween("zoom",function(){var V=this,ne=arguments,Y=B(V,ne).event(H),ae=e.apply(V,ne),xe=Q==null?S(ae):typeof Q=="function"?Q.apply(V,ne):Q,fe=Math.max(ae[1][0]-ae[0][0],ae[1][1]-ae[0][1]),de=V.__zoom,Ie=typeof $=="function"?$.apply(V,ne):$,Ge=c(de.invert(xe).concat(fe/de.k),Ie.invert(xe).concat(fe/Ie.k));return function(Xe){if(Xe===1)Xe=Ie;else{var $e=Ge(Xe),lt=fe/$e[2];Xe=new dh(lt,xe[0]-$e[0]*lt,xe[1]-$e[1]*lt)}Y.zoom(null,Xe)}})}function B(z,$,Q){return!Q&&z.__zooming||new I(z,$)}function I(z,$){this.that=z,this.args=$,this.active=0,this.sourceEvent=null,this.extent=e.apply(z,$),this.taps=0}I.prototype={event:function(z){return z&&(this.sourceEvent=z),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(z,$){return this.mouse&&z!=="mouse"&&(this.mouse[1]=$.invert(this.mouse[0])),this.touch0&&z!=="touch"&&(this.touch0[1]=$.invert(this.touch0[0])),this.touch1&&z!=="touch"&&(this.touch1[1]=$.invert(this.touch1[0])),this.that.__zoom=$,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(z){var $=wc(this.that).datum();h.call(z,this.that,new i1e(z,{sourceEvent:this.sourceEvent,target:_,transform:this.that.__zoom,dispatch:h}),$)}};function D(z,...$){if(!r.apply(this,arguments))return;var Q=B(this,$).event(z),H=this.__zoom,V=Math.max(o[0],Math.min(o[1],H.k*Math.pow(2,n.apply(this,arguments)))),ne=ch(z);if(Q.wheel)(Q.mouse[0][0]!==ne[0]||Q.mouse[0][1]!==ne[1])&&(Q.mouse[1]=H.invert(Q.mouse[0]=ne)),clearTimeout(Q.wheel);else{if(H.k===V)return;Q.mouse=[ne,H.invert(ne)],$_(this),Q.start()}Wy(z),Q.wheel=setTimeout(Y,y),Q.zoom("mouse",i(w(T(H,V),Q.mouse[0],Q.mouse[1]),Q.extent,l));function Y(){Q.wheel=null,Q.end()}}function L(z,...$){if(m||!r.apply(this,arguments))return;var Q=z.currentTarget,H=B(this,$,!0).event(z),V=wc(z.view).on("mousemove.zoom",xe,!0).on("mouseup.zoom",fe,!0),ne=ch(z,Q),Y=z.clientX,ae=z.clientY;E7(z.view),vI(z),H.mouse=[ne,this.__zoom.invert(ne)],$_(this),H.start();function xe(de){if(Wy(de),!H.moved){var Ie=de.clientX-Y,Ge=de.clientY-ae;H.moved=Ie*Ie+Ge*Ge>x}H.event(de).zoom("mouse",i(w(H.that.__zoom,H.mouse[0]=ch(de,Q),H.mouse[1]),H.extent,l))}function fe(de){V.on("mousemove.zoom mouseup.zoom",null),w7(de.view,H.moved),Wy(de),H.event(de).end()}}function O(z,...$){if(r.apply(this,arguments)){var Q=this.__zoom,H=ch(z.changedTouches?z.changedTouches[0]:z,this),V=Q.invert(H),ne=Q.k*(z.shiftKey?.5:2),Y=i(w(T(Q,ne),H,V),e.apply(this,$),l);Wy(z),u>0?wc(this).transition().duration(u).call(R,Y,H,z):wc(this).call(_.transform,Y,H,z)}}function U(z,...$){if(r.apply(this,arguments)){var Q=z.touches,H=Q.length,V=B(this,$,z.changedTouches.length===H).event(z),ne,Y,ae,xe;for(vI(z),Y=0;Y<H;++Y)ae=Q[Y],xe=ch(ae,this),xe=[xe,this.__zoom.invert(xe),ae.identifier],V.touch0?!V.touch1&&V.touch0[2]!==xe[2]&&(V.touch1=xe,V.taps=0):(V.touch0=xe,ne=!0,V.taps=1+!!p);p&&(p=clearTimeout(p)),ne&&(V.taps<2&&(f=xe[0],p=setTimeout(function(){p=null},g)),$_(this),V.start())}}function Z(z,...$){if(this.__zooming){var Q=B(this,$).event(z),H=z.changedTouches,V=H.length,ne,Y,ae,xe;for(Wy(z),ne=0;ne<V;++ne)Y=H[ne],ae=ch(Y,this),Q.touch0&&Q.touch0[2]===Y.identifier?Q.touch0[0]=ae:Q.touch1&&Q.touch1[2]===Y.identifier&&(Q.touch1[0]=ae);if(Y=Q.that.__zoom,Q.touch1){var fe=Q.touch0[0],de=Q.touch0[1],Ie=Q.touch1[0],Ge=Q.touch1[1],Xe=(Xe=Ie[0]-fe[0])*Xe+(Xe=Ie[1]-fe[1])*Xe,$e=($e=Ge[0]-de[0])*$e+($e=Ge[1]-de[1])*$e;Y=T(Y,Math.sqrt(Xe/$e)),ae=[(fe[0]+Ie[0])/2,(fe[1]+Ie[1])/2],xe=[(de[0]+Ge[0])/2,(de[1]+Ge[1])/2]}else if(Q.touch0)ae=Q.touch0[0],xe=Q.touch0[1];else return;Q.zoom("touch",i(w(Y,ae,xe),Q.extent,l))}}function G(z,...$){if(this.__zooming){var Q=B(this,$).event(z),H=z.changedTouches,V=H.length,ne,Y;for(vI(z),m&&clearTimeout(m),m=setTimeout(function(){m=null},g),ne=0;ne<V;++ne)Y=H[ne],Q.touch0&&Q.touch0[2]===Y.identifier?delete Q.touch0:Q.touch1&&Q.touch1[2]===Y.identifier&&delete Q.touch1;if(Q.touch1&&!Q.touch0&&(Q.touch0=Q.touch1,delete Q.touch1),Q.touch0)Q.touch0[1]=this.__zoom.invert(Q.touch0[0]);else if(Q.end(),Q.taps===2&&(Y=ch(Y,this),Math.hypot(f[0]-Y[0],f[1]-Y[1])<v)){var ae=wc(this).on("dblclick.zoom");ae&&ae.apply(this,arguments)}}}return _.wheelDelta=function(z){return arguments.length?(n=typeof z=="function"?z:eE(+z),_):n},_.filter=function(z){return arguments.length?(r=typeof z=="function"?z:eE(!!z),_):r},_.touchable=function(z){return arguments.length?(s=typeof z=="function"?z:eE(!!z),_):s},_.extent=function(z){return arguments.length?(e=typeof z=="function"?z:eE([[+z[0][0],+z[0][1]],[+z[1][0],+z[1][1]]]),_):e},_.scaleExtent=function(z){return arguments.length?(o[0]=+z[0],o[1]=+z[1],_):[o[0],o[1]]},_.translateExtent=function(z){return arguments.length?(l[0][0]=+z[0][0],l[1][0]=+z[1][0],l[0][1]=+z[0][1],l[1][1]=+z[1][1],_):[[l[0][0],l[0][1]],[l[1][0],l[1][1]]]},_.constrain=function(z){return arguments.length?(i=z,_):i},_.duration=function(z){return arguments.length?(u=+z,_):u},_.interpolate=function(z){return arguments.length?(c=z,_):c},_.on=function(){var z=h.on.apply(h,arguments);return z===h?_:z},_.clickDistance=function(z){return arguments.length?(x=(z=+z)*z,_):Math.sqrt(x)},_.tapDistance=function(z){return arguments.length?(v=+z,_):v},_}var c1e="Expected a function";function u1e(r,e,i){var n=!0,s=!0;if(typeof r!="function")throw new TypeError(c1e);return Kb(i)&&(n="leading"in i?!!i.leading:n,s="trailing"in i?!!i.trailing:s),aF(r,e,{leading:n,maxWait:e,trailing:s})}function xI(r,e){(e==null||e>r.length)&&(e=r.length);for(var i=0,n=Array(e);i<e;i++)n[i]=r[i];return n}function h1e(r){if(Array.isArray(r))return xI(r)}function N7(r,e,i){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}function d1e(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function p1e(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function Ul(r,e){return r.get(N7(r,e))}function L7(r,e,i){d1e(r,e),e.set(r,i)}function D7(r,e,i){return r.set(N7(r,e),i),i}function f1e(r,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,x1e(n.key),n)}}function m1e(r,e,i){return e&&f1e(r.prototype,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function g1e(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function A1e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function y1e(r){return h1e(r)||g1e(r)||b1e(r)||A1e()}function v1e(r,e){if(typeof r!="object"||!r)return r;var i=r[Symbol.toPrimitive];if(i!==void 0){var n=i.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}function x1e(r){var e=v1e(r,"string");return typeof e=="symbol"?e:e+""}function b1e(r,e){if(r){if(typeof r=="string")return xI(r,e);var i={}.toString.call(r).slice(8,-1);return i==="Object"&&r.constructor&&(i=r.constructor.name),i==="Map"||i==="Set"?Array.from(r):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?xI(r,e):void 0}}var _1e=123,E1e=function(r){return"#".concat(Math.min(r,Math.pow(2,24)).toString(16).padStart(6,"0"))},O7=function(r,e,i){return(r<<16)+(e<<8)+i},w1e=function(r){var e=_r(r).toRgb(),i=e.r,n=e.g,s=e.b;return O7(i,n,s)},P7=function(r,e){return r*_1e%Math.pow(2,e)},$p=new WeakMap,ph=new WeakMap,C1e=function(){function r(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:6;p1e(this,r),L7(this,$p,void 0),L7(this,ph,void 0),D7(ph,this,e),this.reset()}return m1e(r,[{key:"reset",value:function(){D7($p,this,["__reserved for background__"])}},{key:"register",value:function(e){if(Ul($p,this).length>=Math.pow(2,24-Ul(ph,this)))return null;var i=Ul($p,this).length,n=P7(i,Ul(ph,this)),s=E1e(i+(n<<24-Ul(ph,this)));return Ul($p,this).push(e),s}},{key:"lookup",value:function(e){if(!e)return null;var i=typeof e=="string"?w1e(e):O7.apply(void 0,y1e(e));if(!i)return null;var n=i&Math.pow(2,24-Ul(ph,this))-1,s=i>>24-Ul(ph,this)&Math.pow(2,Ul(ph,this))-1;return P7(n,Ul(ph,this))!==s||n>=Ul($p,this).length?null:Ul($p,this)[n]}}])}();const{abs:Qy,cos:fh,sin:Hg,acos:S1e,atan2:qy,sqrt:Md,pow:zl}=Math;function Xy(r){return r<0?-zl(-r,1/3):zl(r,1/3)}const k7=Math.PI,tE=2*k7,Rd=k7/2,T1e=1e-6,bI=Number.MAX_SAFE_INTEGER||9007199254740991,_I=Number.MIN_SAFE_INTEGER||-9007199254740991,M1e={x:0,y:0,z:0},Si={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(r,e){const i=e(r);let n=i.x*i.x+i.y*i.y;return typeof i.z<"u"&&(n+=i.z*i.z),Md(n)},compute:function(r,e,i){if(r===0)return e[0].t=0,e[0];const n=e.length-1;if(r===1)return e[n].t=1,e[n];const s=1-r;let o=e;if(n===0)return e[0].t=r,e[0];if(n===1){const u={x:s*o[0].x+r*o[1].x,y:s*o[0].y+r*o[1].y,t:r};return i&&(u.z=s*o[0].z+r*o[1].z),u}if(n<4){let u=s*s,c=r*r,h,p,f,m=0;n===2?(o=[o[0],o[1],o[2],M1e],h=u,p=s*r*2,f=c):n===3&&(h=u*s,p=u*r*3,f=s*c*3,m=r*c);const g={x:h*o[0].x+p*o[1].x+f*o[2].x+m*o[3].x,y:h*o[0].y+p*o[1].y+f*o[2].y+m*o[3].y,t:r};return i&&(g.z=h*o[0].z+p*o[1].z+f*o[2].z+m*o[3].z),g}const l=JSON.parse(JSON.stringify(e));for(;l.length>1;){for(let u=0;u<l.length-1;u++)l[u]={x:l[u].x+(l[u+1].x-l[u].x)*r,y:l[u].y+(l[u+1].y-l[u].y)*r},typeof l[u].z<"u"&&(l[u].z=l[u].z+(l[u+1].z-l[u].z)*r);l.splice(l.length-1,1)}return l[0].t=r,l[0]},computeWithRatios:function(r,e,i,n){const s=1-r,o=i,l=e;let u=o[0],c=o[1],h=o[2],p=o[3],f;if(u*=s,c*=r,l.length===2)return f=u+c,{x:(u*l[0].x+c*l[1].x)/f,y:(u*l[0].y+c*l[1].y)/f,z:n?(u*l[0].z+c*l[1].z)/f:!1,t:r};if(u*=s,c*=2*s,h*=r*r,l.length===3)return f=u+c+h,{x:(u*l[0].x+c*l[1].x+h*l[2].x)/f,y:(u*l[0].y+c*l[1].y+h*l[2].y)/f,z:n?(u*l[0].z+c*l[1].z+h*l[2].z)/f:!1,t:r};if(u*=s,c*=1.5*s,h*=3*s,p*=r*r*r,l.length===4)return f=u+c+h+p,{x:(u*l[0].x+c*l[1].x+h*l[2].x+p*l[3].x)/f,y:(u*l[0].y+c*l[1].y+h*l[2].y+p*l[3].y)/f,z:n?(u*l[0].z+c*l[1].z+h*l[2].z+p*l[3].z)/f:!1,t:r}},derive:function(r,e){const i=[];for(let n=r,s=n.length,o=s-1;s>1;s--,o--){const l=[];for(let u=0,c;u<o;u++)c={x:o*(n[u+1].x-n[u].x),y:o*(n[u+1].y-n[u].y)},e&&(c.z=o*(n[u+1].z-n[u].z)),l.push(c);i.push(l),n=l}return i},between:function(r,e,i){return e<=r&&r<=i||Si.approximately(r,e)||Si.approximately(r,i)},approximately:function(r,e,i){return Qy(r-e)<=(i||T1e)},length:function(r){const e=Si.Tvalues.length;let i=0;for(let n=0,s;n<e;n++)s=.5*Si.Tvalues[n]+.5,i+=Si.Cvalues[n]*Si.arcfn(s,r);return .5*i},map:function(r,e,i,n,s){const o=i-e,l=s-n,u=r-e,c=u/o;return n+l*c},lerp:function(r,e,i){const n={x:e.x+r*(i.x-e.x),y:e.y+r*(i.y-e.y)};return e.z!==void 0&&i.z!==void 0&&(n.z=e.z+r*(i.z-e.z)),n},pointToString:function(r){let e=r.x+"/"+r.y;return typeof r.z<"u"&&(e+="/"+r.z),e},pointsToString:function(r){return"["+r.map(Si.pointToString).join(", ")+"]"},copy:function(r){return JSON.parse(JSON.stringify(r))},angle:function(r,e,i){const n=e.x-r.x,s=e.y-r.y,o=i.x-r.x,l=i.y-r.y,u=n*l-s*o,c=n*o+s*l;return qy(u,c)},round:function(r,e){const i=""+r,n=i.indexOf(".");return parseFloat(i.substring(0,n+1+e))},dist:function(r,e){const i=r.x-e.x,n=r.y-e.y;return Md(i*i+n*n)},closest:function(r,e){let i=zl(2,63),n,s;return r.forEach(function(o,l){s=Si.dist(e,o),s<i&&(i=s,n=l)}),{mdist:i,mpos:n}},abcratio:function(r,e){if(e!==2&&e!==3)return!1;if(typeof r>"u")r=.5;else if(r===0||r===1)return r;const i=zl(r,e)+zl(1-r,e),n=i-1;return Qy(n/i)},projectionratio:function(r,e){if(e!==2&&e!==3)return!1;if(typeof r>"u")r=.5;else if(r===0||r===1)return r;const i=zl(1-r,e),n=zl(r,e)+i;return i/n},lli8:function(r,e,i,n,s,o,l,u){const c=(r*n-e*i)*(s-l)-(r-i)*(s*u-o*l),h=(r*n-e*i)*(o-u)-(e-n)*(s*u-o*l),p=(r-i)*(o-u)-(e-n)*(s-l);return p==0?!1:{x:c/p,y:h/p}},lli4:function(r,e,i,n){const s=r.x,o=r.y,l=e.x,u=e.y,c=i.x,h=i.y,p=n.x,f=n.y;return Si.lli8(s,o,l,u,c,h,p,f)},lli:function(r,e){return Si.lli4(r,r.c,e,e.c)},makeline:function(r,e){return new vs(r.x,r.y,(r.x+e.x)/2,(r.y+e.y)/2,e.x,e.y)},findbbox:function(r){let e=bI,i=bI,n=_I,s=_I;return r.forEach(function(o){const l=o.bbox();e>l.x.min&&(e=l.x.min),i>l.y.min&&(i=l.y.min),n<l.x.max&&(n=l.x.max),s<l.y.max&&(s=l.y.max)}),{x:{min:e,mid:(e+n)/2,max:n,size:n-e},y:{min:i,mid:(i+s)/2,max:s,size:s-i}}},shapeintersections:function(r,e,i,n,s){if(!Si.bboxoverlap(e,n))return[];const o=[],l=[r.startcap,r.forward,r.back,r.endcap],u=[i.startcap,i.forward,i.back,i.endcap];return l.forEach(function(c){c.virtual||u.forEach(function(h){if(h.virtual)return;const p=c.intersects(h,s);p.length>0&&(p.c1=c,p.c2=h,p.s1=r,p.s2=i,o.push(p))})}),o},makeshape:function(r,e,i){const n=e.points.length,s=r.points.length,o=Si.makeline(e.points[n-1],r.points[0]),l=Si.makeline(r.points[s-1],e.points[0]),u={startcap:o,forward:r,back:e,endcap:l,bbox:Si.findbbox([o,r,e,l])};return u.intersections=function(c){return Si.shapeintersections(u,u.bbox,c,c.bbox,i)},u},getminmax:function(r,e,i){if(!i)return{min:0,max:0};let n=bI,s=_I,o,l;i.indexOf(0)===-1&&(i=[0].concat(i)),i.indexOf(1)===-1&&i.push(1);for(let u=0,c=i.length;u<c;u++)o=i[u],l=r.get(o),l[e]<n&&(n=l[e]),l[e]>s&&(s=l[e]);return{min:n,mid:(n+s)/2,max:s,size:s-n}},align:function(r,e){const i=e.p1.x,n=e.p1.y,s=-qy(e.p2.y-n,e.p2.x-i),o=function(l){return{x:(l.x-i)*fh(s)-(l.y-n)*Hg(s),y:(l.x-i)*Hg(s)+(l.y-n)*fh(s)}};return r.map(o)},roots:function(r,e){e=e||{p1:{x:0,y:0},p2:{x:1,y:0}};const i=r.length-1,n=Si.align(r,e),s=function(I){return 0<=I&&I<=1};if(i===2){const I=n[0].y,D=n[1].y,L=n[2].y,O=I-2*D+L;if(O!==0){const U=-Md(D*D-I*L),Z=-I+D,G=-(U+Z)/O,z=-(-U+Z)/O;return[G,z].filter(s)}else if(D!==L&&O===0)return[(2*D-L)/(2*D-2*L)].filter(s);return[]}const o=n[0].y,l=n[1].y,u=n[2].y,c=n[3].y;let h=-o+3*l-3*u+c,p=3*o-6*l+3*u,f=-3*o+3*l,m=o;if(Si.approximately(h,0)){if(Si.approximately(p,0))return Si.approximately(f,0)?[]:[-m/f].filter(s);const I=Md(f*f-4*p*m),D=2*p;return[(I-f)/D,(-f-I)/D].filter(s)}p/=h,f/=h,m/=h;const g=(3*f-p*p)/3,y=g/3,x=(2*p*p*p-9*p*f+27*m)/27,v=x/2,_=v*v+y*y*y;let T,w,S,R,B;if(_<0){const I=-g/3,D=I*I*I,L=Md(D),O=-x/(2*L),U=O<-1?-1:O>1?1:O,Z=S1e(U),G=Xy(L),z=2*G;return S=z*fh(Z/3)-p/3,R=z*fh((Z+tE)/3)-p/3,B=z*fh((Z+2*tE)/3)-p/3,[S,R,B].filter(s)}else{if(_===0)return T=v<0?Xy(-v):-Xy(v),S=2*T-p/3,R=-T-p/3,[S,R].filter(s);{const I=Md(_);return T=Xy(-v+I),w=Xy(v+I),[T-w-p/3].filter(s)}}},droots:function(r){if(r.length===3){const e=r[0],i=r[1],n=r[2],s=e-2*i+n;if(s!==0){const o=-Md(i*i-e*n),l=-e+i,u=-(o+l)/s,c=-(-o+l)/s;return[u,c]}else if(i!==n&&s===0)return[(2*i-n)/(2*(i-n))];return[]}if(r.length===2){const e=r[0],i=r[1];return e!==i?[e/(e-i)]:[]}return[]},curvature:function(r,e,i,n,s){let o,l,u,c,h=0,p=0;const f=Si.compute(r,e),m=Si.compute(r,i),g=f.x*f.x+f.y*f.y;if(n?(o=Md(zl(f.y*m.z-m.y*f.z,2)+zl(f.z*m.x-m.z*f.x,2)+zl(f.x*m.y-m.x*f.y,2)),l=zl(g+f.z*f.z,3/2)):(o=f.x*m.y-f.y*m.x,l=zl(g,3/2)),o===0||l===0)return{k:0,r:0};if(h=o/l,p=l/o,!s){const y=Si.curvature(r-.001,e,i,n,!0).k,x=Si.curvature(r+.001,e,i,n,!0).k;c=(x-h+(h-y))/2,u=(Qy(x-h)+Qy(h-y))/2}return{k:h,r:p,dk:c,adk:u}},inflections:function(r){if(r.length<4)return[];const e=Si.align(r,{p1:r[0],p2:r.slice(-1)[0]}),i=e[2].x*e[1].y,n=e[3].x*e[1].y,s=e[1].x*e[2].y,o=e[3].x*e[2].y,l=18*(-3*i+2*n+3*s-o),u=18*(3*i-n-3*s),c=18*(s-i);if(Si.approximately(l,0)){if(!Si.approximately(u,0)){let m=-c/u;if(0<=m&&m<=1)return[m]}return[]}const h=2*l;if(Si.approximately(h,0))return[];const p=u*u-4*l*c;if(p<0)return[];const f=Math.sqrt(p);return[(f-u)/h,-(u+f)/h].filter(function(m){return 0<=m&&m<=1})},bboxoverlap:function(r,e){const i=["x","y"],n=i.length;for(let s=0,o,l,u,c;s<n;s++)if(o=i[s],l=r[o].mid,u=e[o].mid,c=(r[o].size+e[o].size)/2,Qy(l-u)>=c)return!1;return!0},expandbox:function(r,e){e.x.min<r.x.min&&(r.x.min=e.x.min),e.y.min<r.y.min&&(r.y.min=e.y.min),e.z&&e.z.min<r.z.min&&(r.z.min=e.z.min),e.x.max>r.x.max&&(r.x.max=e.x.max),e.y.max>r.y.max&&(r.y.max=e.y.max),e.z&&e.z.max>r.z.max&&(r.z.max=e.z.max),r.x.mid=(r.x.min+r.x.max)/2,r.y.mid=(r.y.min+r.y.max)/2,r.z&&(r.z.mid=(r.z.min+r.z.max)/2),r.x.size=r.x.max-r.x.min,r.y.size=r.y.max-r.y.min,r.z&&(r.z.size=r.z.max-r.z.min)},pairiteration:function(r,e,i){const n=r.bbox(),s=e.bbox(),o=1e5,l=i||.5;if(n.x.size+n.y.size<l&&s.x.size+s.y.size<l)return[(o*(r._t1+r._t2)/2|0)/o+"/"+(o*(e._t1+e._t2)/2|0)/o];let u=r.split(.5),c=e.split(.5),h=[{left:u.left,right:c.left},{left:u.left,right:c.right},{left:u.right,right:c.right},{left:u.right,right:c.left}];h=h.filter(function(f){return Si.bboxoverlap(f.left.bbox(),f.right.bbox())});let p=[];return h.length===0||(h.forEach(function(f){p=p.concat(Si.pairiteration(f.left,f.right,l))}),p=p.filter(function(f,m){return p.indexOf(f)===m})),p},getccenter:function(r,e,i){const n=e.x-r.x,s=e.y-r.y,o=i.x-e.x,l=i.y-e.y,u=n*fh(Rd)-s*Hg(Rd),c=n*Hg(Rd)+s*fh(Rd),h=o*fh(Rd)-l*Hg(Rd),p=o*Hg(Rd)+l*fh(Rd),f=(r.x+e.x)/2,m=(r.y+e.y)/2,g=(e.x+i.x)/2,y=(e.y+i.y)/2,x=f+u,v=m+c,_=g+h,T=y+p,w=Si.lli8(f,m,x,v,g,y,_,T),S=Si.dist(w,r);let R=qy(r.y-w.y,r.x-w.x),B=qy(e.y-w.y,e.x-w.x),I=qy(i.y-w.y,i.x-w.x),D;return R<I?((R>B||B>I)&&(R+=tE),R>I&&(D=I,I=R,R=D)):I<B&&B<R?(D=I,I=R,R=D):I+=tE,w.s=R,w.e=I,w.r=S,w},numberSort:function(r,e){return r-e}};class Yy{constructor(e){this.curves=[],this._3d=!1,e&&(this.curves=e,this._3d=this.curves[0]._3d)}valueOf(){return this.toString()}toString(){return"["+this.curves.map(function(e){return Si.pointsToString(e.points)}).join(", ")+"]"}addCurve(e){this.curves.push(e),this._3d=this._3d||e._3d}length(){return this.curves.map(function(e){return e.length()}).reduce(function(e,i){return e+i})}curve(e){return this.curves[e]}bbox(){const e=this.curves;for(var i=e[0].bbox(),n=1;n<e.length;n++)Si.expandbox(i,e[n].bbox());return i}offset(e){const i=[];return this.curves.forEach(function(n){i.push(...n.offset(e))}),new Yy(i)}}const{abs:Ky,min:F7,max:U7,cos:R1e,sin:I1e,acos:B1e,sqrt:Jy}=Math,N1e=Math.PI;class vs{constructor(e){let i=e&&e.forEach?e:Array.from(arguments).slice(),n=!1;if(typeof i[0]=="object"){n=i.length;const g=[];i.forEach(function(y){["x","y","z"].forEach(function(x){typeof y[x]<"u"&&g.push(y[x])})}),i=g}let s=!1;const o=i.length;if(n){if(n>4){if(arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");s=!0}}else if(o!==6&&o!==8&&o!==9&&o!==12&&arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");const l=this._3d=!s&&(o===9||o===12)||e&&e[0]&&typeof e[0].z<"u",u=this.points=[];for(let g=0,y=l?3:2;g<o;g+=y){var c={x:i[g],y:i[g+1]};l&&(c.z=i[g+2]),u.push(c)}const h=this.order=u.length-1,p=this.dims=["x","y"];l&&p.push("z"),this.dimlen=p.length;const f=Si.align(u,{p1:u[0],p2:u[h]}),m=Si.dist(u[0],u[h]);this._linear=f.reduce((g,y)=>g+Ky(y.y),0)<m/50,this._lut=[],this._t1=0,this._t2=1,this.update()}static quadraticFromPoints(e,i,n,s){if(typeof s>"u"&&(s=.5),s===0)return new vs(i,i,n);if(s===1)return new vs(e,i,i);const o=vs.getABC(2,e,i,n,s);return new vs(e,o.A,n)}static cubicFromPoints(e,i,n,s,o){typeof s>"u"&&(s=.5);const l=vs.getABC(3,e,i,n,s);typeof o>"u"&&(o=Si.dist(i,l.C));const u=o*(1-s)/s,c=Si.dist(e,n),h=(n.x-e.x)/c,p=(n.y-e.y)/c,f=o*h,m=o*p,g=u*h,y=u*p,x={x:i.x-f,y:i.y-m},v={x:i.x+g,y:i.y+y},_=l.A,T={x:_.x+(x.x-_.x)/(1-s),y:_.y+(x.y-_.y)/(1-s)},w={x:_.x+(v.x-_.x)/s,y:_.y+(v.y-_.y)/s},S={x:e.x+(T.x-e.x)/s,y:e.y+(T.y-e.y)/s},R={x:n.x+(w.x-n.x)/(1-s),y:n.y+(w.y-n.y)/(1-s)};return new vs(e,S,R,n)}static getUtils(){return Si}getUtils(){return vs.getUtils()}static get PolyBezier(){return Yy}valueOf(){return this.toString()}toString(){return Si.pointsToString(this.points)}toSVG(){if(this._3d)return!1;const e=this.points,i=e[0].x,n=e[0].y,s=["M",i,n,this.order===2?"Q":"C"];for(let o=1,l=e.length;o<l;o++)s.push(e[o].x),s.push(e[o].y);return s.join(" ")}setRatios(e){if(e.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=e,this._lut=[]}verify(){const e=this.coordDigest();e!==this._print&&(this._print=e,this.update())}coordDigest(){return this.points.map(function(e,i){return""+i+e.x+e.y+(e.z?e.z:0)}).join("")}update(){this._lut=[],this.dpoints=Si.derive(this.points,this._3d),this.computedirection()}computedirection(){const e=this.points,i=Si.angle(e[0],e[this.order],e[1]);this.clockwise=i>0}length(){return Si.length(this.derivative.bind(this))}static getABC(e=2,i,n,s,o=.5){const l=Si.projectionratio(o,e),u=1-l,c={x:l*i.x+u*s.x,y:l*i.y+u*s.y},h=Si.abcratio(o,e);return{A:{x:n.x+(n.x-c.x)/h,y:n.y+(n.y-c.y)/h},B:n,C:c,S:i,E:s}}getABC(e,i){i=i||this.get(e);let n=this.points[0],s=this.points[this.order];return vs.getABC(this.order,n,i,s,e)}getLUT(e){if(this.verify(),e=e||100,this._lut.length===e+1)return this._lut;this._lut=[],e++,this._lut=[];for(let i=0,n,s;i<e;i++)s=i/(e-1),n=this.compute(s),n.t=s,this._lut.push(n);return this._lut}on(e,i){i=i||5;const n=this.getLUT(),s=[];for(let o=0,l,u=0;o<n.length;o++)l=n[o],Si.dist(l,e)<i&&(s.push(l),u+=o/n.length);return s.length?t/=s.length:!1}project(e){const i=this.getLUT(),n=i.length-1,s=Si.closest(i,e),o=s.mpos,l=(o-1)/n,u=(o+1)/n,c=.1/n;let h=s.mdist,p=l,f=p,m;h+=1;for(let g;p<u+c;p+=c)m=this.compute(p),g=Si.dist(e,m),g<h&&(h=g,f=p);return f=f<0?0:f>1?1:f,m=this.compute(f),m.t=f,m.d=h,m}get(e){return this.compute(e)}point(e){return this.points[e]}compute(e){return this.ratios?Si.computeWithRatios(e,this.points,this.ratios,this._3d):Si.compute(e,this.points,this._3d,this.ratios)}raise(){const e=this.points,i=[e[0]],n=e.length;for(let s=1,o,l;s<n;s++)o=e[s],l=e[s-1],i[s]={x:(n-s)/n*o.x+s/n*l.x,y:(n-s)/n*o.y+s/n*l.y};return i[n]=e[n-1],new vs(i)}derivative(e){return Si.compute(e,this.dpoints[0],this._3d)}dderivative(e){return Si.compute(e,this.dpoints[1],this._3d)}align(){let e=this.points;return new vs(Si.align(e,{p1:e[0],p2:e[e.length-1]}))}curvature(e){return Si.curvature(e,this.dpoints[0],this.dpoints[1],this._3d)}inflections(){return Si.inflections(this.points)}normal(e){return this._3d?this.__normal3(e):this.__normal2(e)}__normal2(e){const i=this.derivative(e),n=Jy(i.x*i.x+i.y*i.y);return{t:e,x:-i.y/n,y:i.x/n}}__normal3(e){const i=this.derivative(e),n=this.derivative(e+.01),s=Jy(i.x*i.x+i.y*i.y+i.z*i.z),o=Jy(n.x*n.x+n.y*n.y+n.z*n.z);i.x/=s,i.y/=s,i.z/=s,n.x/=o,n.y/=o,n.z/=o;const l={x:n.y*i.z-n.z*i.y,y:n.z*i.x-n.x*i.z,z:n.x*i.y-n.y*i.x},u=Jy(l.x*l.x+l.y*l.y+l.z*l.z);l.x/=u,l.y/=u,l.z/=u;const c=[l.x*l.x,l.x*l.y-l.z,l.x*l.z+l.y,l.x*l.y+l.z,l.y*l.y,l.y*l.z-l.x,l.x*l.z-l.y,l.y*l.z+l.x,l.z*l.z];return{t:e,x:c[0]*i.x+c[1]*i.y+c[2]*i.z,y:c[3]*i.x+c[4]*i.y+c[5]*i.z,z:c[6]*i.x+c[7]*i.y+c[8]*i.z}}hull(e){let i=this.points,n=[],s=[],o=0;for(s[o++]=i[0],s[o++]=i[1],s[o++]=i[2],this.order===3&&(s[o++]=i[3]);i.length>1;){n=[];for(let l=0,u,c=i.length-1;l<c;l++)u=Si.lerp(e,i[l],i[l+1]),s[o++]=u,n.push(u);i=n}return s}split(e,i){if(e===0&&i)return this.split(i).left;if(i===1)return this.split(e).right;const n=this.hull(e),s={left:this.order===2?new vs([n[0],n[3],n[5]]):new vs([n[0],n[4],n[7],n[9]]),right:this.order===2?new vs([n[5],n[4],n[2]]):new vs([n[9],n[8],n[6],n[3]]),span:n};return s.left._t1=Si.map(0,0,1,this._t1,this._t2),s.left._t2=Si.map(e,0,1,this._t1,this._t2),s.right._t1=Si.map(e,0,1,this._t1,this._t2),s.right._t2=Si.map(1,0,1,this._t1,this._t2),i?(i=Si.map(i,e,1,0,1),s.right.split(i).left):s}extrema(){const e={};let i=[];return this.dims.forEach((function(n){let s=function(l){return l[n]},o=this.dpoints[0].map(s);e[n]=Si.droots(o),this.order===3&&(o=this.dpoints[1].map(s),e[n]=e[n].concat(Si.droots(o))),e[n]=e[n].filter(function(l){return l>=0&&l<=1}),i=i.concat(e[n].sort(Si.numberSort))}).bind(this)),e.values=i.sort(Si.numberSort).filter(function(n,s){return i.indexOf(n)===s}),e}bbox(){const e=this.extrema(),i={};return this.dims.forEach((function(n){i[n]=Si.getminmax(this,n,e[n])}).bind(this)),i}overlaps(e){const i=this.bbox(),n=e.bbox();return Si.bboxoverlap(i,n)}offset(e,i){if(typeof i<"u"){const n=this.get(e),s=this.normal(e),o={c:n,n:s,x:n.x+s.x*i,y:n.y+s.y*i};return this._3d&&(o.z=n.z+s.z*i),o}if(this._linear){const n=this.normal(0),s=this.points.map(function(o){const l={x:o.x+e*n.x,y:o.y+e*n.y};return o.z&&n.z&&(l.z=o.z+e*n.z),l});return[new vs(s)]}return this.reduce().map(function(n){return n._linear?n.offset(e)[0]:n.scale(e)})}simple(){if(this.order===3){const s=Si.angle(this.points[0],this.points[3],this.points[1]),o=Si.angle(this.points[0],this.points[3],this.points[2]);if(s>0&&o<0||s<0&&o>0)return!1}const e=this.normal(0),i=this.normal(1);let n=e.x*i.x+e.y*i.y;return this._3d&&(n+=e.z*i.z),Ky(B1e(n))<N1e/3}reduce(){let e,i=0,n=0,s=.01,o,l=[],u=[],c=this.extrema().values;for(c.indexOf(0)===-1&&(c=[0].concat(c)),c.indexOf(1)===-1&&c.push(1),i=c[0],e=1;e<c.length;e++)n=c[e],o=this.split(i,n),o._t1=i,o._t2=n,l.push(o),i=n;return l.forEach(function(h){for(i=0,n=0;n<=1;)for(n=i+s;n<=1+s;n+=s)if(o=h.split(i,n),!o.simple()){if(n-=s,Ky(i-n)<s)return[];o=h.split(i,n),o._t1=Si.map(i,0,1,h._t1,h._t2),o._t2=Si.map(n,0,1,h._t1,h._t2),u.push(o),i=n;break}i<1&&(o=h.split(i,1),o._t1=Si.map(i,0,1,h._t1,h._t2),o._t2=h._t2,u.push(o))}),u}translate(e,i,n){n=typeof n=="number"?n:i;const s=this.order;let o=this.points.map((l,u)=>(1-u/s)*i+u/s*n);return new vs(this.points.map((l,u)=>({x:l.x+e.x*o[u],y:l.y+e.y*o[u]})))}scale(e){const i=this.order;let n=!1;if(typeof e=="function"&&(n=e),n&&i===2)return this.raise().scale(n);const s=this.clockwise,o=this.points;if(this._linear)return this.translate(this.normal(0),n?n(0):e,n?n(1):e);const l=n?n(0):e,u=n?n(1):e,c=[this.offset(0,10),this.offset(1,10)],h=[],p=Si.lli4(c[0],c[0].c,c[1],c[1].c);if(!p)throw new Error("cannot scale this curve. Try reducing it first.");return[0,1].forEach(function(f){const m=h[f*i]=Si.copy(o[f*i]);m.x+=(f?u:l)*c[f].n.x,m.y+=(f?u:l)*c[f].n.y}),n?([0,1].forEach(function(f){if(!(i===2&&f)){var m=o[f+1],g={x:m.x-p.x,y:m.y-p.y},y=n?n((f+1)/i):e;n&&!s&&(y=-y);var x=Jy(g.x*g.x+g.y*g.y);g.x/=x,g.y/=x,h[f+1]={x:m.x+y*g.x,y:m.y+y*g.y}}}),new vs(h)):([0,1].forEach(f=>{if(i===2&&f)return;const m=h[f*i],g=this.derivative(f),y={x:m.x+g.x,y:m.y+g.y};h[f+1]=Si.lli4(m,y,p,o[f+1])}),new vs(h))}outline(e,i,n,s){if(i=i===void 0?e:i,this._linear){const R=this.normal(0),B=this.points[0],I=this.points[this.points.length-1];let D,L,O;n===void 0&&(n=e,s=i),D={x:B.x+R.x*e,y:B.y+R.y*e},O={x:I.x+R.x*n,y:I.y+R.y*n},L={x:(D.x+O.x)/2,y:(D.y+O.y)/2};const U=[D,L,O];D={x:B.x-R.x*i,y:B.y-R.y*i},O={x:I.x-R.x*s,y:I.y-R.y*s},L={x:(D.x+O.x)/2,y:(D.y+O.y)/2};const Z=[O,L,D],G=Si.makeline(Z[2],U[0]),z=Si.makeline(U[2],Z[0]),$=[G,new vs(U),z,new vs(Z)];return new Yy($)}const o=this.reduce(),l=o.length,u=[];let c=[],h,p=0,f=this.length();const m=typeof n<"u"&&typeof s<"u";function g(R,B,I,D,L){return function(O){const U=D/I,Z=(D+L)/I,G=B-R;return Si.map(O,0,1,R+U*G,R+Z*G)}}o.forEach(function(R){const B=R.length();m?(u.push(R.scale(g(e,n,f,p,B))),c.push(R.scale(g(-i,-s,f,p,B)))):(u.push(R.scale(e)),c.push(R.scale(-i))),p+=B}),c=c.map(function(R){return h=R.points,h[3]?R.points=[h[3],h[2],h[1],h[0]]:R.points=[h[2],h[1],h[0]],R}).reverse();const y=u[0].points[0],x=u[l-1].points[u[l-1].points.length-1],v=c[l-1].points[c[l-1].points.length-1],_=c[0].points[0],T=Si.makeline(v,y),w=Si.makeline(x,_),S=[T].concat(u).concat([w]).concat(c);return new Yy(S)}outlineshapes(e,i,n){i=i||e;const s=this.outline(e,i).curves,o=[];for(let l=1,u=s.length;l<u/2;l++){const c=Si.makeshape(s[l],s[u-l],n);c.startcap.virtual=l>1,c.endcap.virtual=l<u/2-1,o.push(c)}return o}intersects(e,i){return e?e.p1&&e.p2?this.lineIntersects(e):(e instanceof vs&&(e=e.reduce()),this.curveintersects(this.reduce(),e,i)):this.selfintersects(i)}lineIntersects(e){const i=F7(e.p1.x,e.p2.x),n=F7(e.p1.y,e.p2.y),s=U7(e.p1.x,e.p2.x),o=U7(e.p1.y,e.p2.y);return Si.roots(this.points,e).filter(l=>{var u=this.get(l);return Si.between(u.x,i,s)&&Si.between(u.y,n,o)})}selfintersects(e){const i=this.reduce(),n=i.length-2,s=[];for(let o=0,l,u,c;o<n;o++)u=i.slice(o,o+1),c=i.slice(o+2),l=this.curveintersects(u,c,e),s.push(...l);return s}curveintersects(e,i,n){const s=[];e.forEach(function(l){i.forEach(function(u){l.overlaps(u)&&s.push({left:l,right:u})})});let o=[];return s.forEach(function(l){const u=Si.pairiteration(l.left,l.right,n);u.length>0&&(o=o.concat(u))}),o}arcs(e){return e=e||.5,this._iterate(e,[])}_error(e,i,n,s){const o=(s-n)/4,l=this.get(n+o),u=this.get(s-o),c=Si.dist(e,i),h=Si.dist(e,l),p=Si.dist(e,u);return Ky(h-c)+Ky(p-c)}_iterate(e,i){let n=0,s=1,o;do{o=0,s=1;let l=this.get(n),u,c,h,p,f=!1,m=!1,g,y=s,x=1;do if(m=f,p=h,y=(n+s)/2,u=this.get(y),c=this.get(s),h=Si.getccenter(l,u,c),h.interval={start:n,end:s},f=this._error(h,l,n,s)<=e,g=m&&!f,g||(x=s),f){if(s>=1){if(h.interval.end=x=1,p=h,s>1){let v={x:h.x+h.r*R1e(h.e),y:h.y+h.r*I1e(h.e)};h.e+=Si.angle({x:h.x,y:h.y},v,this.get(1))}break}s=s+(s-n)/2}else s=y;while(!g&&o++<100);if(o>=100)break;p=p||h,i.push(p),n=x}while(s<1);return i}}function L1e(r,e){e===void 0&&(e={});var i=e.insertAt;if(!(typeof document>"u")){var n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",i==="top"&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=r:s.appendChild(document.createTextNode(r))}}var D1e=`.force-graph-container canvas {
  display: block;
  user-select: none;
  outline: none;
  -webkit-tap-highlight-color: transparent;
}

.force-graph-container .graph-tooltip {
  position: absolute;
  top: 0;
  font-family: sans-serif;
  font-size: 16px;
  padding: 4px;
  border-radius: 3px;
  color: #eee;
  background: rgba(0,0,0,0.65);
  visibility: hidden; /* by default */
}

.force-graph-container .clickable {
  cursor: pointer;
}

.force-graph-container .grabbable {
  cursor: move;
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}

.force-graph-container .grabbable:active {
  cursor: grabbing;
  cursor: -moz-grabbing;
  cursor: -webkit-grabbing;
}
`;L1e(D1e);function EI(r,e){(e==null||e>r.length)&&(e=r.length);for(var i=0,n=Array(e);i<e;i++)n[i]=r[i];return n}function O1e(r){if(Array.isArray(r))return r}function P1e(r){if(Array.isArray(r))return EI(r)}function z7(r,e,i){if(j7())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var s=new(r.bind.apply(r,n));return s}function Zy(r,e,i){return(e=V1e(e))in r?Object.defineProperty(r,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[e]=i,r}function j7(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(j7=function(){return!!r})()}function k1e(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function F1e(r,e){var i=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(i!=null){var n,s,o,l,u=[],c=!0,h=!1;try{if(o=(i=i.call(r)).next,e!==0)for(;!(c=(n=o.call(i)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(p){h=!0,s=p}finally{try{if(!c&&i.return!=null&&(l=i.return(),Object(l)!==l))return}finally{if(h)throw s}}return u}}function U1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function z1e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function V7(r,e){var i=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),i.push.apply(i,n)}return i}function Wg(r){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?arguments[e]:{};e%2?V7(Object(i),!0).forEach(function(n){Zy(r,n,i[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):V7(Object(i)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(i,n))})}return r}function $y(r,e){return O1e(r)||F1e(r,e)||G7(r,e)||U1e()}function jl(r){return P1e(r)||k1e(r)||G7(r)||z1e()}function j1e(r,e){if(typeof r!="object"||!r)return r;var i=r[Symbol.toPrimitive];if(i!==void 0){var n=i.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function V1e(r){var e=j1e(r,"string");return typeof e=="symbol"?e:e+""}function wI(r){"@babel/helpers - typeof";return wI=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wI(r)}function G7(r,e){if(r){if(typeof r=="string")return EI(r,e);var i={}.toString.call(r).slice(8,-1);return i==="Object"&&r.constructor&&(i=r.constructor.name),i==="Map"||i==="Set"?Array.from(r):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?EI(r,e):void 0}}var G1e=PT(DF);function H7(r,e,i){!e||typeof i!="string"||r.filter(function(n){return!n[i]}).forEach(function(n){n[i]=G1e(e(n))})}function H1e(r,e){var i=r.nodes,n=r.links,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=s.nodeFilter,l=o===void 0?function(){return!0}:o,u=s.onLoopError,c=u===void 0?function(g){throw"Invalid DAG structure! Found cycle in node path: ".concat(g.join(" -> "),".")}:u,h={};i.forEach(function(g){return h[e(g)]={data:g,out:[],depth:-1,skip:!l(g)}}),n.forEach(function(g){var y=g.source,x=g.target,v=S(y),_=S(x);if(!h.hasOwnProperty(v))throw"Missing source node with id: ".concat(v);if(!h.hasOwnProperty(_))throw"Missing target node with id: ".concat(_);var T=h[v],w=h[_];T.out.push(w);function S(R){return wI(R)==="object"?e(R):R}});var p=[];m(Object.values(h));var f=Object.assign.apply(Object,[{}].concat(jl(Object.entries(h).filter(function(g){var y=$y(g,2),x=y[1];return!x.skip}).map(function(g){var y=$y(g,2),x=y[0],v=y[1];return Zy({},x,v.depth)}))));return f;function m(g){for(var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],x=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,v=function(){var w=g[_];if(y.indexOf(w)!==-1){var S=[].concat(jl(y.slice(y.indexOf(w))),[w]).map(function(R){return e(R.data)});return p.some(function(R){return R.length===S.length&&R.every(function(B,I){return B===S[I]})})||(p.push(S),c(S)),1}x>w.depth&&(w.depth=x,m(w.out,[].concat(jl(y),[w]),x+(w.skip?0:1)))},_=0,T=g.length;_<T;_++)v()}}var W1e=2,lo=function(r,e){return e.onNeedsRedraw&&e.onNeedsRedraw()},W7=function(r,e){if(!e.isShadow){var i=gr(e.linkDirectionalParticles);e.graphData.links.forEach(function(n){var s=Math.round(Math.abs(i(n)));s?n.__photons=jl(Array(s)).map(function(){return{}}):delete n.__photons})}},iE=Ep({props:{graphData:{default:{nodes:[],links:[]},onChange:function(r,e){e.engineRunning=!1,W7(r,e)}},dagMode:{onChange:function(r,e){!r&&(e.graphData.nodes||[]).forEach(function(i){return i.fx=i.fy=void 0})}},dagLevelDistance:{},dagNodeFilter:{default:function(r){return!0}},onDagError:{triggerUpdate:!1},nodeRelSize:{default:4,triggerUpdate:!1,onChange:lo},nodeId:{default:"id"},nodeVal:{default:"val",triggerUpdate:!1,onChange:lo},nodeColor:{default:"color",triggerUpdate:!1,onChange:lo},nodeAutoColorBy:{},nodeCanvasObject:{triggerUpdate:!1,onChange:lo},nodeCanvasObjectMode:{default:function(){return"replace"},triggerUpdate:!1,onChange:lo},nodeVisibility:{default:!0,triggerUpdate:!1,onChange:lo},linkSource:{default:"source"},linkTarget:{default:"target"},linkVisibility:{default:!0,triggerUpdate:!1,onChange:lo},linkColor:{default:"color",triggerUpdate:!1,onChange:lo},linkAutoColorBy:{},linkLineDash:{triggerUpdate:!1,onChange:lo},linkWidth:{default:1,triggerUpdate:!1,onChange:lo},linkCurvature:{default:0,triggerUpdate:!1,onChange:lo},linkCanvasObject:{triggerUpdate:!1,onChange:lo},linkCanvasObjectMode:{default:function(){return"replace"},triggerUpdate:!1,onChange:lo},linkDirectionalArrowLength:{default:0,triggerUpdate:!1,onChange:lo},linkDirectionalArrowColor:{triggerUpdate:!1,onChange:lo},linkDirectionalArrowRelPos:{default:.5,triggerUpdate:!1,onChange:lo},linkDirectionalParticles:{default:0,triggerUpdate:!1,onChange:W7},linkDirectionalParticleSpeed:{default:.01,triggerUpdate:!1},linkDirectionalParticleWidth:{default:4,triggerUpdate:!1},linkDirectionalParticleColor:{triggerUpdate:!1},globalScale:{default:1,triggerUpdate:!1},d3AlphaMin:{default:0,triggerUpdate:!1},d3AlphaDecay:{default:.0228,triggerUpdate:!1,onChange:function(r,e){e.forceLayout.alphaDecay(r)}},d3AlphaTarget:{default:0,triggerUpdate:!1,onChange:function(r,e){e.forceLayout.alphaTarget(r)}},d3VelocityDecay:{default:.4,triggerUpdate:!1,onChange:function(r,e){e.forceLayout.velocityDecay(r)}},warmupTicks:{default:0,triggerUpdate:!1},cooldownTicks:{default:1/0,triggerUpdate:!1},cooldownTime:{default:15e3,triggerUpdate:!1},onUpdate:{default:function(){},triggerUpdate:!1},onFinishUpdate:{default:function(){},triggerUpdate:!1},onEngineTick:{default:function(){},triggerUpdate:!1},onEngineStop:{default:function(){},triggerUpdate:!1},onNeedsRedraw:{triggerUpdate:!1},isShadow:{default:!1,triggerUpdate:!1}},methods:{d3Force:function(r,e,i){return i===void 0?r.forceLayout.force(e):(r.forceLayout.force(e,i),this)},d3ReheatSimulation:function(r){return r.forceLayout.alpha(1),this.resetCountdown(),this},resetCountdown:function(r){return r.cntTicks=0,r.startTickTime=new Date,r.engineRunning=!0,this},isEngineRunning:function(r){return!!r.engineRunning},tickFrame:function(r){return!r.isShadow&&e(),n(),!r.isShadow&&s(),!r.isShadow&&o(),i(),this;function e(){r.engineRunning&&(++r.cntTicks>r.cooldownTicks||new Date-r.startTickTime>r.cooldownTime||r.d3AlphaMin>0&&r.forceLayout.alpha()<r.d3AlphaMin?(r.engineRunning=!1,r.onEngineStop()):(r.forceLayout.tick(),r.onEngineTick()))}function i(){var l=gr(r.nodeVisibility),u=gr(r.nodeVal),c=gr(r.nodeColor),h=gr(r.nodeCanvasObjectMode),p=r.ctx,f=r.isShadow/r.globalScale,m=r.graphData.nodes.filter(l);p.save(),m.forEach(function(g){var y=h(g);if(r.nodeCanvasObject&&(y==="before"||y==="replace")&&(r.nodeCanvasObject(g,p,r.globalScale),y==="replace")){p.restore();return}var x=Math.sqrt(Math.max(0,u(g)||1))*r.nodeRelSize+f;p.beginPath(),p.arc(g.x,g.y,x,0,2*Math.PI,!1),p.fillStyle=c(g)||"rgba(31, 120, 180, 0.92)",p.fill(),r.nodeCanvasObject&&y==="after"&&r.nodeCanvasObject(g,r.ctx,r.globalScale)}),p.restore()}function n(){var l=gr(r.linkVisibility),u=gr(r.linkColor),c=gr(r.linkWidth),h=gr(r.linkLineDash),p=gr(r.linkCurvature),f=gr(r.linkCanvasObjectMode),m=r.ctx,g=r.isShadow*2,y=r.graphData.links.filter(l);y.forEach(R);var x=[],v=[],_=y;if(r.linkCanvasObject){var T=[],w=[];y.forEach(function(B){return({before:x,after:v,replace:T}[f(B)]||w).push(B)}),_=[].concat(jl(x),v,w),x=x.concat(T)}m.save(),x.forEach(function(B){return r.linkCanvasObject(B,m,r.globalScale)}),m.restore();var S=DT(_,[u,c,h]);m.save(),Object.entries(S).forEach(function(B){var I=$y(B,2),D=I[0],L=I[1],O=!D||D==="undefined"?"rgba(0,0,0,0.15)":D;Object.entries(L).forEach(function(U){var Z=$y(U,2),G=Z[0],z=Z[1],$=(G||1)/r.globalScale+g;Object.entries(z).forEach(function(Q){var H=$y(Q,2);H[0];var V=H[1],ne=h(V[0]);m.beginPath(),V.forEach(function(Y){var ae=Y.source,xe=Y.target;if(!(!ae||!xe||!ae.hasOwnProperty("x")||!xe.hasOwnProperty("x"))){m.moveTo(ae.x,ae.y);var fe=Y.__controlPoints;fe?m[fe.length===2?"quadraticCurveTo":"bezierCurveTo"].apply(m,jl(fe).concat([xe.x,xe.y])):m.lineTo(xe.x,xe.y)}}),m.strokeStyle=O,m.lineWidth=$,m.setLineDash(ne||[]),m.stroke()})})}),m.restore(),m.save(),v.forEach(function(B){return r.linkCanvasObject(B,m,r.globalScale)}),m.restore();function R(B){var I=p(B);if(!I){B.__controlPoints=null;return}var D=B.source,L=B.target;if(!(!D||!L||!D.hasOwnProperty("x")||!L.hasOwnProperty("x"))){var O=Math.sqrt(Math.pow(L.x-D.x,2)+Math.pow(L.y-D.y,2));if(O>0){var U=Math.atan2(L.y-D.y,L.x-D.x),Z=O*I,G={x:(D.x+L.x)/2+Z*Math.cos(U-Math.PI/2),y:(D.y+L.y)/2+Z*Math.sin(U-Math.PI/2)};B.__controlPoints=[G.x,G.y]}else{var z=I*70;B.__controlPoints=[L.x,L.y-z,L.x+z,L.y]}}}}function s(){var l=1.6,u=.2,c=gr(r.linkDirectionalArrowLength),h=gr(r.linkDirectionalArrowRelPos),p=gr(r.linkVisibility),f=gr(r.linkDirectionalArrowColor||r.linkColor),m=gr(r.nodeVal),g=r.ctx;g.save(),r.graphData.links.filter(p).forEach(function(y){var x=c(y);if(!(!x||x<0)){var v=y.source,_=y.target;if(!(!v||!_||!v.hasOwnProperty("x")||!_.hasOwnProperty("x"))){var T=Math.sqrt(Math.max(0,m(v)||1))*r.nodeRelSize,w=Math.sqrt(Math.max(0,m(_)||1))*r.nodeRelSize,S=Math.min(1,Math.max(0,h(y))),R=f(y)||"rgba(0,0,0,0.28)",B=x/l/2,I=y.__controlPoints&&z7(vs,[v.x,v.y].concat(jl(y.__controlPoints),[_.x,_.y])),D=I?function($){return I.get($)}:function($){return{x:v.x+(_.x-v.x)*$||0,y:v.y+(_.y-v.y)*$||0}},L=I?I.length():Math.sqrt(Math.pow(_.x-v.x,2)+Math.pow(_.y-v.y,2)),O=T+x+(L-T-w-x)*S,U=D(O/L),Z=D((O-x)/L),G=D((O-x*(1-u))/L),z=Math.atan2(U.y-Z.y,U.x-Z.x)-Math.PI/2;g.beginPath(),g.moveTo(U.x,U.y),g.lineTo(Z.x+B*Math.cos(z),Z.y+B*Math.sin(z)),g.lineTo(G.x,G.y),g.lineTo(Z.x-B*Math.cos(z),Z.y-B*Math.sin(z)),g.fillStyle=R,g.fill()}}}),g.restore()}function o(){var l=gr(r.linkDirectionalParticles),u=gr(r.linkDirectionalParticleSpeed),c=gr(r.linkDirectionalParticleWidth),h=gr(r.linkVisibility),p=gr(r.linkDirectionalParticleColor||r.linkColor),f=r.ctx;f.save(),r.graphData.links.filter(h).forEach(function(m){var g=l(m);if(!(!m.hasOwnProperty("__photons")||!m.__photons.length)){var y=m.source,x=m.target;if(!(!y||!x||!y.hasOwnProperty("x")||!x.hasOwnProperty("x"))){var v=u(m),_=m.__photons||[],T=Math.max(0,c(m)/2)/Math.sqrt(r.globalScale),w=p(m)||"rgba(0,0,0,0.28)";f.fillStyle=w;var S=m.__controlPoints?z7(vs,[y.x,y.y].concat(jl(m.__controlPoints),[x.x,x.y])):null,R=0,B=!1;_.forEach(function(I){var D=!!I.__singleHop;if(I.hasOwnProperty("__progressRatio")||(I.__progressRatio=D?0:R/g),!D&&R++,I.__progressRatio+=v,I.__progressRatio>=1)if(!D)I.__progressRatio=I.__progressRatio%1;else{B=!0;return}var L=I.__progressRatio,O=S?S.get(L):{x:y.x+(x.x-y.x)*L||0,y:y.y+(x.y-y.y)*L||0};f.beginPath(),f.arc(O.x,O.y,T,0,2*Math.PI,!1),f.fill()}),B&&(m.__photons=m.__photons.filter(function(I){return!I.__singleHop||I.__progressRatio<=1}))}}}),f.restore()}},emitParticle:function(r,e){return e&&(!e.__photons&&(e.__photons=[]),e.__photons.push({__singleHop:!0})),this}},stateInit:function(){return{forceLayout:I4().force("link",b4()).force("charge",B4()).force("center",u4()).force("dagRadial",null).stop(),engineRunning:!1}},init:function(r,e){e.ctx=r},update:function(r,e){r.engineRunning=!1,r.onUpdate(),r.nodeAutoColorBy!==null&&H7(r.graphData.nodes,gr(r.nodeAutoColorBy),r.nodeColor),r.linkAutoColorBy!==null&&H7(r.graphData.links,gr(r.linkAutoColorBy),r.linkColor),r.graphData.links.forEach(function(f){f.source=f[r.linkSource],f.target=f[r.linkTarget]}),r.forceLayout.stop().alpha(1).nodes(r.graphData.nodes);var i=r.forceLayout.force("link");i&&i.id(function(f){return f[r.nodeId]}).links(r.graphData.links);var n=r.dagMode&&H1e(r.graphData,function(f){return f[r.nodeId]},{nodeFilter:r.dagNodeFilter,onLoopError:r.onDagError||void 0}),s=Math.max.apply(Math,jl(Object.values(n||[]))),o=r.dagLevelDistance||r.graphData.nodes.length/(s||1)*W1e*(["radialin","radialout"].indexOf(r.dagMode)!==-1?.7:1);if(["lr","rl","td","bu"].includes(e.dagMode)){var l=["lr","rl"].includes(e.dagMode)?"fx":"fy";r.graphData.nodes.filter(r.dagNodeFilter).forEach(function(f){return delete f[l]})}if(["lr","rl","td","bu"].includes(r.dagMode)){var u=["rl","bu"].includes(r.dagMode),c=function(f){return(n[f[r.nodeId]]-s/2)*o*(u?-1:1)},h=["lr","rl"].includes(r.dagMode)?"fx":"fy";r.graphData.nodes.filter(r.dagNodeFilter).forEach(function(f){return f[h]=c(f)})}r.forceLayout.force("dagRadial",["radialin","radialout"].indexOf(r.dagMode)!==-1?N4(function(f){var m=n[f[r.nodeId]]||-1;return(r.dagMode==="radialin"?s-m:m)*o}).strength(function(f){return r.dagNodeFilter(f)?1:0}):null);for(var p=0;p<r.warmupTicks&&!(r.d3AlphaMin>0&&r.forceLayout.alpha()<r.d3AlphaMin);p++)r.forceLayout.tick();this.resetCountdown(),r.onFinishUpdate()}});function Q7(r,e){var i=r instanceof Array?r:[r],n=new e;return n._destructor&&n._destructor(),{linkProp:function(s){return{default:n[s](),onChange:function(o,l){i.forEach(function(u){return l[u][s](o)})},triggerUpdate:!1}},linkMethod:function(s){return function(o){for(var l=arguments.length,u=new Array(l>1?l-1:0),c=1;c<l;c++)u[c-1]=arguments[c];var h=[];return i.forEach(function(p){var f=o[p],m=f[s].apply(f,u);m!==f&&h.push(m)}),h.length?h[0]:this}}}}var Q1e=800,q1e=4,q7=Q7("forceGraph",iE),X1e=Q7(["forceGraph","shadowGraph"],iE),Y1e=Object.assign.apply(Object,jl(["nodeColor","nodeAutoColorBy","nodeCanvasObject","nodeCanvasObjectMode","linkColor","linkAutoColorBy","linkLineDash","linkWidth","linkCanvasObject","linkCanvasObjectMode","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleWidth","linkDirectionalParticleColor","dagMode","dagLevelDistance","dagNodeFilter","onDagError","d3AlphaMin","d3AlphaDecay","d3VelocityDecay","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"].map(function(r){return Zy({},r,q7.linkProp(r))})).concat(jl(["nodeRelSize","nodeId","nodeVal","nodeVisibility","linkSource","linkTarget","linkVisibility","linkCurvature"].map(function(r){return Zy({},r,X1e.linkProp(r))})))),K1e=Object.assign.apply(Object,jl(["d3Force","d3ReheatSimulation","emitParticle"].map(function(r){return Zy({},r,q7.linkMethod(r))})));function CI(r){if(r.canvas){var e=r.canvas.width,i=r.canvas.height;e===300&&i===150&&(e=i=0);var n=window.devicePixelRatio;e/=n,i/=n,[r.canvas,r.shadowCanvas].forEach(function(o){o.style.width="".concat(r.width,"px"),o.style.height="".concat(r.height,"px"),o.width=r.width*n,o.height=r.height*n,!e&&!i&&o.getContext("2d").scale(n,n)});var s=Zc(r.canvas).k;r.zoom.translateBy(r.zoom.__baseElem,(r.width-e)/2/s,(r.height-i)/2/s),r.needsRedraw=!0}}function X7(r){var e=window.devicePixelRatio;r.setTransform(e,0,0,e,0,0)}function Y7(r,e,i){r.save(),X7(r),r.clearRect(0,0,e,i),r.restore()}var J1e=Ep({props:Wg({width:{default:window.innerWidth,onChange:function(r,e){return CI(e)},triggerUpdate:!1},height:{default:window.innerHeight,onChange:function(r,e){return CI(e)},triggerUpdate:!1},graphData:{default:{nodes:[],links:[]},onChange:function(r,e){[r.nodes,r.links].every(function(n){return(n||[]).every(function(s){return!s.hasOwnProperty("__indexColor")})})&&e.colorTracker.reset(),[{type:"Node",objs:r.nodes},{type:"Link",objs:r.links}].forEach(i),e.forceGraph.graphData(r),e.shadowGraph.graphData(r);function i(n){var s=n.type,o=n.objs;o.filter(function(l){if(!l.hasOwnProperty("__indexColor"))return!0;var u=e.colorTracker.lookup(l.__indexColor);return!u||!u.hasOwnProperty("d")||u.d!==l}).forEach(function(l){l.__indexColor=e.colorTracker.register({type:s,d:l})})}},triggerUpdate:!1},backgroundColor:{onChange:function(r,e){e.canvas&&r&&(e.canvas.style.background=r)},triggerUpdate:!1},nodeLabel:{default:"name",triggerUpdate:!1},nodePointerAreaPaint:{onChange:function(r,e){e.shadowGraph.nodeCanvasObject(r?function(i,n,s){return r(i,i.__indexColor,n,s)}:null),e.flushShadowCanvas&&e.flushShadowCanvas()},triggerUpdate:!1},linkPointerAreaPaint:{onChange:function(r,e){e.shadowGraph.linkCanvasObject(r?function(i,n,s){return r(i,i.__indexColor,n,s)}:null),e.flushShadowCanvas&&e.flushShadowCanvas()},triggerUpdate:!1},linkLabel:{default:"name",triggerUpdate:!1},linkHoverPrecision:{default:4,triggerUpdate:!1},minZoom:{default:.01,onChange:function(r,e){e.zoom.scaleExtent([r,e.zoom.scaleExtent()[1]])},triggerUpdate:!1},maxZoom:{default:1e3,onChange:function(r,e){e.zoom.scaleExtent([e.zoom.scaleExtent()[0],r])},triggerUpdate:!1},enableNodeDrag:{default:!0,triggerUpdate:!1},enableZoomInteraction:{default:!0,triggerUpdate:!1},enablePanInteraction:{default:!0,triggerUpdate:!1},enableZoomPanInteraction:{default:!0,triggerUpdate:!1},enablePointerInteraction:{default:!0,onChange:function(r,e){e.hoverObj=null},triggerUpdate:!1},autoPauseRedraw:{default:!0,triggerUpdate:!1},onNodeDrag:{default:function(){},triggerUpdate:!1},onNodeDragEnd:{default:function(){},triggerUpdate:!1},onNodeClick:{triggerUpdate:!1},onNodeRightClick:{triggerUpdate:!1},onNodeHover:{triggerUpdate:!1},onLinkClick:{triggerUpdate:!1},onLinkRightClick:{triggerUpdate:!1},onLinkHover:{triggerUpdate:!1},onBackgroundClick:{triggerUpdate:!1},onBackgroundRightClick:{triggerUpdate:!1},onZoom:{triggerUpdate:!1},onZoomEnd:{triggerUpdate:!1},onRenderFramePre:{triggerUpdate:!1},onRenderFramePost:{triggerUpdate:!1}},Y1e),aliases:{stopAnimation:"pauseAnimation"},methods:Wg({graph2ScreenCoords:function(r,e,i){var n=Zc(r.canvas);return{x:e*n.k+n.x,y:i*n.k+n.y}},screen2GraphCoords:function(r,e,i){var n=Zc(r.canvas);return{x:(e-n.x)/n.k,y:(i-n.y)/n.k}},centerAt:function(r,e,i,n){if(!r.canvas)return null;if(e!==void 0||i!==void 0){var s=Object.assign({},e!==void 0?{x:e}:{},i!==void 0?{y:i}:{});return n?r.tweenGroup.add(new G_(o()).to(s,n).easing(oh.Quadratic.Out).onUpdate(l).start()):l(s),this}return o();function o(){var u=Zc(r.canvas);return{x:(r.width/2-u.x)/u.k,y:(r.height/2-u.y)/u.k}}function l(u){var c=u.x,h=u.y;r.zoom.translateTo(r.zoom.__baseElem,c===void 0?o().x:c,h===void 0?o().y:h),r.needsRedraw=!0}},zoom:function(r,e,i){if(!r.canvas)return null;if(e!==void 0)return i?r.tweenGroup.add(new G_({k:n()}).to({k:e},i).easing(oh.Quadratic.Out).onUpdate(function(o){var l=o.k;return s(l)}).start()):s(e),this;return n();function n(){return Zc(r.canvas).k}function s(o){r.zoom.scaleTo(r.zoom.__baseElem,o),r.needsRedraw=!0}},zoomToFit:function(r){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,n=arguments.length,s=new Array(n>3?n-3:0),o=3;o<n;o++)s[o-3]=arguments[o];var l=this.getGraphBbox.apply(this,s);if(l){var u={x:(l.x[0]+l.x[1])/2,y:(l.y[0]+l.y[1])/2},c=Math.max(1e-12,Math.min(1e12,(r.width-i*2)/(l.x[1]-l.x[0]),(r.height-i*2)/(l.y[1]-l.y[0])));this.centerAt(u.x,u.y,e),this.zoom(c,e)}return this},getGraphBbox:function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return!0},i=gr(r.nodeVal),n=function(o){return Math.sqrt(Math.max(0,i(o)||1))*r.nodeRelSize},s=r.graphData.nodes.filter(e).map(function(o){return{x:o.x,y:o.y,r:n(o)}});return s.length?{x:[NT(s,function(o){return o.x-o.r}),BT(s,function(o){return o.x+o.r})],y:[NT(s,function(o){return o.y-o.r}),BT(s,function(o){return o.y+o.r})]}:null},pauseAnimation:function(r){return r.animationFrameRequestId&&(cancelAnimationFrame(r.animationFrameRequestId),r.animationFrameRequestId=null),this},resumeAnimation:function(r){return r.animationFrameRequestId||this._animationCycle(),this},_destructor:function(){this.pauseAnimation(),this.graphData({nodes:[],links:[]})}},K1e),stateInit:function(){return{lastSetZoom:1,zoom:l1e(),forceGraph:new iE,shadowGraph:new iE().cooldownTicks(0).nodeColor("__indexColor").linkColor("__indexColor").isShadow(!0),colorTracker:new C1e,tweenGroup:new rI}},init:function(r,e){var i=this;r.innerHTML="";var n=document.createElement("div");n.classList.add("force-graph-container"),n.style.position="relative",r.appendChild(n),e.canvas=document.createElement("canvas"),e.backgroundColor&&(e.canvas.style.background=e.backgroundColor),n.appendChild(e.canvas),e.shadowCanvas=document.createElement("canvas");var s=e.canvas.getContext("2d"),o=e.shadowCanvas.getContext("2d",{willReadFrequently:!0}),l={x:-1e12,y:-1e12},u=function(){var p=null,f=window.devicePixelRatio,m=l.x>0&&l.y>0?o.getImageData(l.x*f,l.y*f,1,1):null;return m&&(p=e.colorTracker.lookup(m.data)),p};wc(e.canvas).call(Xxe().subject(function(){if(!e.enableNodeDrag)return null;var p=u();return p&&p.type==="Node"?p.d:null}).on("start",function(p){var f=p.subject;f.__initialDragPos={x:f.x,y:f.y,fx:f.fx,fy:f.fy},p.active||(f.fx=f.x,f.fy=f.y),e.canvas.classList.add("grabbable")}).on("drag",function(p){var f=p.subject,m=f.__initialDragPos,g=p,y=Zc(e.canvas).k,x={x:m.x+(g.x-m.x)/y-f.x,y:m.y+(g.y-m.y)/y-f.y};["x","y"].forEach(function(v){return f["f".concat(v)]=f[v]=m[v]+(g[v]-m[v])/y}),e.forceGraph.d3AlphaTarget(.3).resetCountdown(),e.isPointerDragging=!0,f.__dragged=!0,e.onNodeDrag(f,x)}).on("end",function(p){var f=p.subject,m=f.__initialDragPos,g={x:f.x-m.x,y:f.y-m.y};m.fx===void 0&&(f.fx=void 0),m.fy===void 0&&(f.fy=void 0),delete f.__initialDragPos,e.forceGraph.d3AlphaTarget()&&e.forceGraph.d3AlphaTarget(0).resetCountdown(),e.canvas.classList.remove("grabbable"),e.isPointerDragging=!1,f.__dragged&&(delete f.__dragged,e.onNodeDragEnd(f,g))})),e.zoom(e.zoom.__baseElem=wc(e.canvas)),e.zoom.__baseElem.on("dblclick.zoom",null),e.zoom.filter(function(p){return!p.button&&e.enableZoomPanInteraction&&(p.type!=="wheel"||gr(e.enableZoomInteraction)(p))&&(p.type==="wheel"||gr(e.enablePanInteraction)(p))}).on("zoom",function(p){var f=p.transform;[s,o].forEach(function(m){X7(m),m.translate(f.x,f.y),m.scale(f.k,f.k)}),e.onZoom&&e.onZoom(Wg(Wg({},f),i.centerAt())),e.needsRedraw=!0}).on("end",function(p){return e.onZoomEnd&&e.onZoomEnd(Wg(Wg({},p.transform),i.centerAt()))}),CI(e),e.forceGraph.onNeedsRedraw(function(){return e.needsRedraw=!0}).onFinishUpdate(function(){Zc(e.canvas).k===e.lastSetZoom&&e.graphData.nodes.length&&(e.zoom.scaleTo(e.zoom.__baseElem,e.lastSetZoom=q1e/Math.cbrt(e.graphData.nodes.length)),e.needsRedraw=!0)});var c=document.createElement("div");c.classList.add("graph-tooltip"),n.appendChild(c),["pointermove","pointerdown"].forEach(function(p){return n.addEventListener(p,function(f){p==="pointerdown"&&(e.isPointerPressed=!0,e.pointerDownEvent=f),!e.isPointerDragging&&f.type==="pointermove"&&e.onBackgroundClick&&(f.pressure>0||e.isPointerPressed)&&(f.pointerType!=="touch"||f.movementX===void 0||[f.movementX,f.movementY].some(function(y){return Math.abs(y)>1}))&&(e.isPointerDragging=!0);var m=g(n);l.x=f.pageX-m.left,l.y=f.pageY-m.top,c.style.top="".concat(l.y,"px"),c.style.left="".concat(l.x,"px"),c.style.transform="translate(-".concat(l.x/e.width*100,"%, ").concat(e.height-l.y<100?"calc(-100% - 8px)":"21px",")");function g(y){var x=y.getBoundingClientRect(),v=window.pageXOffset||document.documentElement.scrollLeft,_=window.pageYOffset||document.documentElement.scrollTop;return{top:x.top+_,left:x.left+v}}},{passive:!0})}),n.addEventListener("pointerup",function(p){if(e.isPointerPressed=!1,e.isPointerDragging){e.isPointerDragging=!1;return}var f=[p,e.pointerDownEvent];requestAnimationFrame(function(){if(p.button===0)if(e.hoverObj){var m=e["on".concat(e.hoverObj.type,"Click")];m&&m.apply(void 0,[e.hoverObj.d].concat(f))}else e.onBackgroundClick&&e.onBackgroundClick.apply(e,f);if(p.button===2)if(e.hoverObj){var g=e["on".concat(e.hoverObj.type,"RightClick")];g&&g.apply(void 0,[e.hoverObj.d].concat(f))}else e.onBackgroundRightClick&&e.onBackgroundRightClick.apply(e,f)})},{passive:!0}),n.addEventListener("contextmenu",function(p){return!e.onBackgroundRightClick&&!e.onNodeRightClick&&!e.onLinkRightClick?!0:(p.preventDefault(),!1)}),e.forceGraph(s),e.shadowGraph(o);var h=u1e(function(){Y7(o,e.width,e.height),e.shadowGraph.linkWidth(function(f){return gr(e.linkWidth)(f)+e.linkHoverPrecision});var p=Zc(e.canvas);e.shadowGraph.globalScale(p.k).tickFrame()},Q1e);e.flushShadowCanvas=h.flush,(this._animationCycle=function p(){var f=!e.autoPauseRedraw||!!e.needsRedraw||e.forceGraph.isEngineRunning()||e.graphData.links.some(function(S){return S.__photons&&S.__photons.length});if(e.needsRedraw=!1,e.enablePointerInteraction){var m=e.isPointerDragging?null:u();if(m!==e.hoverObj){var g=e.hoverObj,y=g?g.type:null,x=m?m.type:null;if(y&&y!==x){var v=e["on".concat(y,"Hover")];v&&v(null,g.d)}if(x){var _=e["on".concat(x,"Hover")];_&&_(m.d,y===x?g.d:null)}var T=m&&gr(e["".concat(m.type.toLowerCase(),"Label")])(m.d)||"";c.style.visibility=T?"visible":"hidden",c.innerHTML=T,e.canvas.classList[m&&e["on".concat(x,"Click")]||!m&&e.onBackgroundClick?"add":"remove"]("clickable"),e.hoverObj=m}f&&h()}if(f){Y7(s,e.width,e.height);var w=Zc(e.canvas).k;e.onRenderFramePre&&e.onRenderFramePre(s,w),e.forceGraph.globalScale(w).tickFrame(),e.onRenderFramePost&&e.onRenderFramePost(s,w)}e.tweenGroup.update(),e.animationFrameRequestId=requestAnimationFrame(p)})()},update:function(r){}}),rE={width:xt.number,height:xt.number,graphData:xt.shape({nodes:xt.arrayOf(xt.object).isRequired,links:xt.arrayOf(xt.object).isRequired}),backgroundColor:xt.string,nodeRelSize:xt.number,nodeId:xt.string,nodeLabel:xt.oneOfType([xt.string,xt.func]),nodeVal:xt.oneOfType([xt.number,xt.string,xt.func]),nodeVisibility:xt.oneOfType([xt.bool,xt.string,xt.func]),nodeColor:xt.oneOfType([xt.string,xt.func]),nodeAutoColorBy:xt.oneOfType([xt.string,xt.func]),onNodeHover:xt.func,onNodeClick:xt.func,linkSource:xt.string,linkTarget:xt.string,linkLabel:xt.oneOfType([xt.string,xt.func]),linkVisibility:xt.oneOfType([xt.bool,xt.string,xt.func]),linkColor:xt.oneOfType([xt.string,xt.func]),linkAutoColorBy:xt.oneOfType([xt.string,xt.func]),linkWidth:xt.oneOfType([xt.number,xt.string,xt.func]),linkCurvature:xt.oneOfType([xt.number,xt.string,xt.func]),linkDirectionalArrowLength:xt.oneOfType([xt.number,xt.string,xt.func]),linkDirectionalArrowColor:xt.oneOfType([xt.string,xt.func]),linkDirectionalArrowRelPos:xt.oneOfType([xt.number,xt.string,xt.func]),linkDirectionalParticles:xt.oneOfType([xt.number,xt.string,xt.func]),linkDirectionalParticleSpeed:xt.oneOfType([xt.number,xt.string,xt.func]),linkDirectionalParticleWidth:xt.oneOfType([xt.number,xt.string,xt.func]),linkDirectionalParticleColor:xt.oneOfType([xt.string,xt.func]),onLinkHover:xt.func,onLinkClick:xt.func,dagMode:xt.oneOf(["td","bu","lr","rl","zin","zout","radialin","radialout"]),dagLevelDistance:xt.number,dagNodeFilter:xt.func,onDagError:xt.func,d3AlphaMin:xt.number,d3AlphaDecay:xt.number,d3VelocityDecay:xt.number,warmupTicks:xt.number,cooldownTicks:xt.number,cooldownTime:xt.number,onEngineTick:xt.func,onEngineStop:xt.func,getGraphBbox:xt.func},K7={zoomToFit:xt.func,onNodeRightClick:xt.func,onNodeDrag:xt.func,onNodeDragEnd:xt.func,onLinkRightClick:xt.func,linkHoverPrecision:xt.number,onBackgroundClick:xt.func,onBackgroundRightClick:xt.func,enablePointerInteraction:xt.bool,enableNodeDrag:xt.bool},SI={showNavInfo:xt.bool,nodeOpacity:xt.number,nodeResolution:xt.number,nodeThreeObject:xt.oneOfType([xt.object,xt.string,xt.func]),nodeThreeObjectExtend:xt.oneOfType([xt.bool,xt.string,xt.func]),linkOpacity:xt.number,linkResolution:xt.number,linkCurveRotation:xt.oneOfType([xt.number,xt.string,xt.func]),linkMaterial:xt.oneOfType([xt.object,xt.string,xt.func]),linkThreeObject:xt.oneOfType([xt.object,xt.string,xt.func]),linkThreeObjectExtend:xt.oneOfType([xt.bool,xt.string,xt.func]),linkPositionUpdate:xt.func,linkDirectionalArrowResolution:xt.number,linkDirectionalParticleResolution:xt.number,forceEngine:xt.oneOf(["d3","ngraph"]),ngraphPhysics:xt.object,numDimensions:xt.oneOf([1,2,3])},Z1e=Object.assign({},rE,K7,{linkLineDash:xt.oneOfType([xt.arrayOf(xt.number),xt.string,xt.func]),nodeCanvasObjectMode:xt.oneOfType([xt.string,xt.func]),nodeCanvasObject:xt.func,nodePointerAreaPaint:xt.func,linkCanvasObjectMode:xt.oneOfType([xt.string,xt.func]),linkCanvasObject:xt.func,linkPointerAreaPaint:xt.func,autoPauseRedraw:xt.bool,minZoom:xt.number,maxZoom:xt.number,enableZoomInteraction:xt.oneOfType([xt.bool,xt.func]),enablePanInteraction:xt.oneOfType([xt.bool,xt.func]),onZoom:xt.func,onZoomEnd:xt.func,onRenderFramePre:xt.func,onRenderFramePost:xt.func}),$1e=Object.assign({},rE,K7,SI,{enableNavigationControls:xt.bool,controlType:xt.oneOf(["trackball","orbit","fly"]),rendererConfig:xt.object,extraRenderers:xt.arrayOf(xt.shape({render:xt.func.isRequired}))}),e_e=Object.assign({},rE,SI,{nodeDesc:xt.oneOfType([xt.string,xt.func]),linkDesc:xt.oneOfType([xt.string,xt.func])}),t_e=Object.assign({},rE,SI,{markerAttrs:xt.object,yOffset:xt.number,glScale:xt.number});const J7=ux(lU,{methodNames:["getGraphBbox","emitParticle","d3Force","d3ReheatSimulation","refresh"]});J7.displayName="ForceGraphVR",J7.propTypes=e_e;const Z7=ux(Kle,{methodNames:["getGraphBbox","emitParticle","d3Force","d3ReheatSimulation","refresh"],initPropNames:["markerAttrs"]});Z7.displayName="ForceGraphAR",Z7.propTypes=t_e;const TI=ux(cve,{methodNames:["emitParticle","d3Force","d3ReheatSimulation","stopAnimation","pauseAnimation","resumeAnimation","cameraPosition","zoomToFit","getGraphBbox","screen2GraphCoords","graph2ScreenCoords","postProcessingComposer","lights","scene","camera","renderer","controls","refresh"],initPropNames:["controlType","rendererConfig","extraRenderers"]});TI.displayName="ForceGraph3D",TI.propTypes=$1e;const MI=ux(J1e,{methodNames:["emitParticle","d3Force","d3ReheatSimulation","stopAnimation","pauseAnimation","resumeAnimation","centerAt","zoom","zoomToFit","getGraphBbox","screen2GraphCoords","graph2ScreenCoords"]});MI.displayName="ForceGraph2D",MI.propTypes=Z1e;function RI(r,e){(e==null||e>r.length)&&(e=r.length);for(var i=0,n=Array(e);i<e;i++)n[i]=r[i];return n}function i_e(r){if(Array.isArray(r))return r}function r_e(r){if(Array.isArray(r))return RI(r)}function n_e(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function s_e(r,e,i){return e=nE(e),f_e(r,$7()?Reflect.construct(e,i||[],nE(r).constructor):e.apply(r,i))}function a_e(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function o_e(r,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,g_e(n.key),n)}}function l_e(r,e,i){return e&&o_e(r.prototype,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function nE(r){return nE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},nE(r)}function c_e(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&II(r,e)}function $7(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return($7=function(){return!!r})()}function u_e(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function h_e(r,e){var i=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(i!=null){var n,s,o,l,u=[],c=!0,h=!1;try{if(o=(i=i.call(r)).next,e===0){if(Object(i)!==i)return;c=!1}else for(;!(c=(n=o.call(i)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(p){h=!0,s=p}finally{try{if(!c&&i.return!=null&&(l=i.return(),Object(l)!==l))return}finally{if(h)throw s}}return u}}function d_e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function p_e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function f_e(r,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return n_e(r)}function II(r,e){return II=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,n){return i.__proto__=n,i},II(r,e)}function e9(r,e){return i_e(r)||h_e(r,e)||t9(r,e)||d_e()}function sE(r){return r_e(r)||u_e(r)||t9(r)||p_e()}function m_e(r,e){if(typeof r!="object"||!r)return r;var i=r[Symbol.toPrimitive];if(i!==void 0){var n=i.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}function g_e(r){var e=m_e(r,"string");return typeof e=="symbol"?e:e+""}function t9(r,e){if(r){if(typeof r=="string")return RI(r,e);var i={}.toString.call(r).slice(8,-1);return i==="Object"&&r.constructor&&(i=r.constructor.name),i==="Map"||i==="Set"?Array.from(r):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?RI(r,e):void 0}}var ev=typeof window<"u"&&window.THREE?window.THREE:{CanvasTexture:Nie,Sprite:Bie,SpriteMaterial:Gk,SRGBColorSpace:zo},A_e=function(r){function e(){var i,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:10,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"rgba(255, 255, 255, 1)";return a_e(this,e),i=s_e(this,e,[new ev.SpriteMaterial]),i._text="".concat(n),i._textHeight=s,i._color=o,i._backgroundColor=!1,i._padding=0,i._borderWidth=0,i._borderRadius=0,i._borderColor="white",i._strokeWidth=0,i._strokeColor="white",i._fontFace="system-ui",i._fontSize=90,i._fontWeight="normal",i._canvas=document.createElement("canvas"),i._genCanvas(),i}return c_e(e,r),l_e(e,[{key:"text",get:function(){return this._text},set:function(i){this._text=i,this._genCanvas()}},{key:"textHeight",get:function(){return this._textHeight},set:function(i){this._textHeight=i,this._genCanvas()}},{key:"color",get:function(){return this._color},set:function(i){this._color=i,this._genCanvas()}},{key:"backgroundColor",get:function(){return this._backgroundColor},set:function(i){this._backgroundColor=i,this._genCanvas()}},{key:"padding",get:function(){return this._padding},set:function(i){this._padding=i,this._genCanvas()}},{key:"borderWidth",get:function(){return this._borderWidth},set:function(i){this._borderWidth=i,this._genCanvas()}},{key:"borderRadius",get:function(){return this._borderRadius},set:function(i){this._borderRadius=i,this._genCanvas()}},{key:"borderColor",get:function(){return this._borderColor},set:function(i){this._borderColor=i,this._genCanvas()}},{key:"fontFace",get:function(){return this._fontFace},set:function(i){this._fontFace=i,this._genCanvas()}},{key:"fontSize",get:function(){return this._fontSize},set:function(i){this._fontSize=i,this._genCanvas()}},{key:"fontWeight",get:function(){return this._fontWeight},set:function(i){this._fontWeight=i,this._genCanvas()}},{key:"strokeWidth",get:function(){return this._strokeWidth},set:function(i){this._strokeWidth=i,this._genCanvas()}},{key:"strokeColor",get:function(){return this._strokeColor},set:function(i){this._strokeColor=i,this._genCanvas()}},{key:"_genCanvas",value:function(){var i=this,n=this._canvas,s=n.getContext("2d"),o=1/this.textHeight,l=Array.isArray(this.borderWidth)?this.borderWidth:[this.borderWidth,this.borderWidth],u=l.map(function(I){return I*i.fontSize*o}),c=Array.isArray(this.borderRadius)?this.borderRadius:[this.borderRadius,this.borderRadius,this.borderRadius,this.borderRadius],h=c.map(function(I){return I*i.fontSize*o}),p=Array.isArray(this.padding)?this.padding:[this.padding,this.padding],f=p.map(function(I){return I*i.fontSize*o}),m=this.text.split(`
`),g="".concat(this.fontWeight," ").concat(this.fontSize,"px ").concat(this.fontFace);s.font=g;var y=Math.max.apply(Math,sE(m.map(function(I){return s.measureText(I).width}))),x=this.fontSize*m.length;if(n.width=y+u[0]*2+f[0]*2,n.height=x+u[1]*2+f[1]*2,this.borderWidth){if(s.strokeStyle=this.borderColor,u[0]){var v=u[0]/2;s.lineWidth=u[0],s.beginPath(),s.moveTo(v,h[0]),s.lineTo(v,n.height-h[3]),s.moveTo(n.width-v,h[1]),s.lineTo(n.width-v,n.height-h[2]),s.stroke()}if(u[1]){var _=u[1]/2;s.lineWidth=u[1],s.beginPath(),s.moveTo(Math.max(u[0],h[0]),_),s.lineTo(n.width-Math.max(u[0],h[1]),_),s.moveTo(Math.max(u[0],h[3]),n.height-_),s.lineTo(n.width-Math.max(u[0],h[2]),n.height-_),s.stroke()}if(this.borderRadius){var T=Math.max.apply(Math,sE(u)),w=T/2;s.lineWidth=T,s.beginPath(),[!!h[0]&&[h[0],w,w,h[0]],!!h[1]&&[n.width-h[1],n.width-w,w,h[1]],!!h[2]&&[n.width-h[2],n.width-w,n.height-w,n.height-h[2]],!!h[3]&&[h[3],w,n.height-w,n.height-h[3]]].filter(function(I){return I}).forEach(function(I){var D=e9(I,4),L=D[0],O=D[1],U=D[2],Z=D[3];s.moveTo(L,U),s.quadraticCurveTo(O,U,O,Z)}),s.stroke()}}this.backgroundColor&&(s.fillStyle=this.backgroundColor,this.borderRadius?(s.beginPath(),s.moveTo(u[0],h[0]),[[u[0],h[0],n.width-h[1],u[1],u[1],u[1]],[n.width-u[0],n.width-u[0],n.width-u[0],u[1],h[1],n.height-h[2]],[n.width-u[0],n.width-h[2],h[3],n.height-u[1],n.height-u[1],n.height-u[1]],[u[0],u[0],u[0],n.height-u[1],n.height-h[3],h[0]]].forEach(function(I){var D=e9(I,6),L=D[0],O=D[1],U=D[2],Z=D[3],G=D[4],z=D[5];s.quadraticCurveTo(L,Z,O,G),s.lineTo(U,z)}),s.closePath(),s.fill()):s.fillRect(u[0],u[1],n.width-u[0]*2,n.height-u[1]*2)),s.translate.apply(s,sE(u)),s.translate.apply(s,sE(f)),s.font=g,s.fillStyle=this.color,s.textBaseline="bottom";var S=this.strokeWidth>0;S&&(s.lineWidth=this.strokeWidth*this.fontSize/10,s.strokeStyle=this.strokeColor),m.forEach(function(I,D){var L=(y-s.measureText(I).width)/2,O=(D+1)*i.fontSize;S&&s.strokeText(I,L,O),s.fillText(I,L,O)}),this.material.map&&this.material.map.dispose();var R=this.material.map=new ev.CanvasTexture(n);R.colorSpace=ev.SRGBColorSpace;var B=this.textHeight*m.length+l[1]*2+p[1]*2;this.scale.set(B*n.width/n.height,B,0)}},{key:"clone",value:function(){return new this.constructor(this.text,this.textHeight,this.color).copy(this)}},{key:"copy",value:function(i){return ev.Sprite.prototype.copy.call(this,i),this.color=i.color,this.backgroundColor=i.backgroundColor,this.padding=i.padding,this.borderWidth=i.borderWidth,this.borderColor=i.borderColor,this.fontFace=i.fontFace,this.fontSize=i.fontSize,this.fontWeight=i.fontWeight,this.strokeWidth=i.strokeWidth,this.strokeColor=i.strokeColor,this}}])}(ev.Sprite);class Qg extends Error{constructor(e,i){const n=`${Qg.extractMessage(e)}: ${JSON.stringify({response:e,request:i})}`;super(n),H0(this,"response"),H0(this,"request"),Object.setPrototypeOf(this,Qg.prototype),this.response=e,this.request=i,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Qg)}static extractMessage(e){var i,n;return((n=(i=e.errors)==null?void 0:i[0])==null?void 0:n.message)??`GraphQL Error (Code: ${String(e.status)})`}}const i9=r=>r.toUpperCase(),BI=r=>typeof r=="function"?r():r,r9=(r,e)=>r.map((i,n)=>[i,e[n]]),qg=r=>{let e={};return r instanceof Headers?e=y_e(r):Array.isArray(r)?r.forEach(([i,n])=>{i&&n!==void 0&&(e[i]=n)}):r&&(e=r),e},y_e=r=>{const e={};return r.forEach((i,n)=>{e[n]=i}),e},v_e=r=>{try{const e=r();return x_e(e)?e.catch(i=>n9(i)):e}catch(e){return n9(e)}},n9=r=>r instanceof Error?r:new Error(String(r)),x_e=r=>typeof r=="object"&&r!==null&&"then"in r&&typeof r.then=="function"&&"catch"in r&&typeof r.catch=="function"&&"finally"in r&&typeof r.finally=="function",NI=r=>{throw new Error(`Unhandled case: ${String(r)}`)},aE=r=>typeof r=="object"&&r!==null&&!Array.isArray(r),b_e=(r,e)=>r.documents?r:{documents:r,requestHeaders:e,signal:void 0},__e=(r,e,i)=>r.query?r:{query:r,variables:e,requestHeaders:i,signal:void 0};function oE(r,e){throw new Error(e)}function E_e(r){return typeof r=="object"&&r!==null}function w_e(r,e){throw new Error("Unexpected invariant triggered.")}const C_e=/\r\n|[\n\r]/g;function LI(r,e){let i=0,n=1;for(const s of r.body.matchAll(C_e)){if(typeof s.index=="number"||w_e(),s.index>=e)break;i=s.index+s[0].length,n+=1}return{line:n,column:e+1-i}}function S_e(r){return s9(r.source,LI(r.source,r.start))}function s9(r,e){const i=r.locationOffset.column-1,n="".padStart(i)+r.body,s=e.line-1,o=r.locationOffset.line-1,l=e.line+o,u=e.line===1?i:0,c=e.column+u,h=`${r.name}:${l}:${c}
`,p=n.split(/\r\n|[\n\r]/g),f=p[s];if(f.length>120){const m=Math.floor(c/80),g=c%80,y=[];for(let x=0;x<f.length;x+=80)y.push(f.slice(x,x+80));return h+a9([[`${l} |`,y[0]],...y.slice(1,m+1).map(x=>["|",x]),["|","^".padStart(g)],["|",y[m+1]]])}return h+a9([[`${l-1} |`,p[s-1]],[`${l} |`,f],["|","^".padStart(c)],[`${l+1} |`,p[s+1]]])}function a9(r){const e=r.filter(([n,s])=>s!==void 0),i=Math.max(...e.map(([n])=>n.length));return e.map(([n,s])=>n.padStart(i)+(s?" "+s:"")).join(`
`)}function T_e(r){const e=r[0];return e==null||"kind"in e||"length"in e?{nodes:e,source:r[1],positions:r[2],path:r[3],originalError:r[4],extensions:r[5]}:e}class DI extends Error{constructor(e,...i){var n,s,o;const{nodes:l,source:u,positions:c,path:h,originalError:p,extensions:f}=T_e(i);super(e),this.name="GraphQLError",this.path=h??void 0,this.originalError=p??void 0,this.nodes=o9(Array.isArray(l)?l:l?[l]:void 0);const m=o9((n=this.nodes)===null||n===void 0?void 0:n.map(y=>y.loc).filter(y=>y!=null));this.source=u??(m==null||(s=m[0])===null||s===void 0?void 0:s.source),this.positions=c??(m==null?void 0:m.map(y=>y.start)),this.locations=c&&u?c.map(y=>LI(u,y)):m==null?void 0:m.map(y=>LI(y.source,y.start));const g=E_e(p==null?void 0:p.extensions)?p==null?void 0:p.extensions:void 0;this.extensions=(o=f??g)!==null&&o!==void 0?o:Object.create(null),Object.defineProperties(this,{message:{writable:!0,enumerable:!0},name:{enumerable:!1},nodes:{enumerable:!1},source:{enumerable:!1},positions:{enumerable:!1},originalError:{enumerable:!1}}),p!=null&&p.stack?Object.defineProperty(this,"stack",{value:p.stack,writable:!0,configurable:!0}):Error.captureStackTrace?Error.captureStackTrace(this,DI):Object.defineProperty(this,"stack",{value:Error().stack,writable:!0,configurable:!0})}get[Symbol.toStringTag](){return"GraphQLError"}toString(){let e=this.message;if(this.nodes)for(const i of this.nodes)i.loc&&(e+=`

`+S_e(i.loc));else if(this.source&&this.locations)for(const i of this.locations)e+=`

`+s9(this.source,i);return e}toJSON(){const e={message:this.message};return this.locations!=null&&(e.locations=this.locations),this.path!=null&&(e.path=this.path),this.extensions!=null&&Object.keys(this.extensions).length>0&&(e.extensions=this.extensions),e}}function o9(r){return r===void 0||r.length===0?void 0:r}function Ba(r,e,i){return new DI(`Syntax Error: ${i}`,{source:r,positions:[e]})}class M_e{constructor(e,i,n){this.start=e.start,this.end=i.end,this.startToken=e,this.endToken=i,this.source=n}get[Symbol.toStringTag](){return"Location"}toJSON(){return{start:this.start,end:this.end}}}class l9{constructor(e,i,n,s,o,l){this.kind=e,this.start=i,this.end=n,this.line=s,this.column=o,this.value=l,this.prev=null,this.next=null}get[Symbol.toStringTag](){return"Token"}toJSON(){return{kind:this.kind,value:this.value,line:this.line,column:this.column}}}const c9={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]},R_e=new Set(Object.keys(c9));function u9(r){const e=r==null?void 0:r.kind;return typeof e=="string"&&R_e.has(e)}var ef;(function(r){r.QUERY="query",r.MUTATION="mutation",r.SUBSCRIPTION="subscription"})(ef||(ef={}));var OI;(function(r){r.QUERY="QUERY",r.MUTATION="MUTATION",r.SUBSCRIPTION="SUBSCRIPTION",r.FIELD="FIELD",r.FRAGMENT_DEFINITION="FRAGMENT_DEFINITION",r.FRAGMENT_SPREAD="FRAGMENT_SPREAD",r.INLINE_FRAGMENT="INLINE_FRAGMENT",r.VARIABLE_DEFINITION="VARIABLE_DEFINITION",r.SCHEMA="SCHEMA",r.SCALAR="SCALAR",r.OBJECT="OBJECT",r.FIELD_DEFINITION="FIELD_DEFINITION",r.ARGUMENT_DEFINITION="ARGUMENT_DEFINITION",r.INTERFACE="INTERFACE",r.UNION="UNION",r.ENUM="ENUM",r.ENUM_VALUE="ENUM_VALUE",r.INPUT_OBJECT="INPUT_OBJECT",r.INPUT_FIELD_DEFINITION="INPUT_FIELD_DEFINITION"})(OI||(OI={}));var kr;(function(r){r.NAME="Name",r.DOCUMENT="Document",r.OPERATION_DEFINITION="OperationDefinition",r.VARIABLE_DEFINITION="VariableDefinition",r.SELECTION_SET="SelectionSet",r.FIELD="Field",r.ARGUMENT="Argument",r.FRAGMENT_SPREAD="FragmentSpread",r.INLINE_FRAGMENT="InlineFragment",r.FRAGMENT_DEFINITION="FragmentDefinition",r.VARIABLE="Variable",r.INT="IntValue",r.FLOAT="FloatValue",r.STRING="StringValue",r.BOOLEAN="BooleanValue",r.NULL="NullValue",r.ENUM="EnumValue",r.LIST="ListValue",r.OBJECT="ObjectValue",r.OBJECT_FIELD="ObjectField",r.DIRECTIVE="Directive",r.NAMED_TYPE="NamedType",r.LIST_TYPE="ListType",r.NON_NULL_TYPE="NonNullType",r.SCHEMA_DEFINITION="SchemaDefinition",r.OPERATION_TYPE_DEFINITION="OperationTypeDefinition",r.SCALAR_TYPE_DEFINITION="ScalarTypeDefinition",r.OBJECT_TYPE_DEFINITION="ObjectTypeDefinition",r.FIELD_DEFINITION="FieldDefinition",r.INPUT_VALUE_DEFINITION="InputValueDefinition",r.INTERFACE_TYPE_DEFINITION="InterfaceTypeDefinition",r.UNION_TYPE_DEFINITION="UnionTypeDefinition",r.ENUM_TYPE_DEFINITION="EnumTypeDefinition",r.ENUM_VALUE_DEFINITION="EnumValueDefinition",r.INPUT_OBJECT_TYPE_DEFINITION="InputObjectTypeDefinition",r.DIRECTIVE_DEFINITION="DirectiveDefinition",r.SCHEMA_EXTENSION="SchemaExtension",r.SCALAR_TYPE_EXTENSION="ScalarTypeExtension",r.OBJECT_TYPE_EXTENSION="ObjectTypeExtension",r.INTERFACE_TYPE_EXTENSION="InterfaceTypeExtension",r.UNION_TYPE_EXTENSION="UnionTypeExtension",r.ENUM_TYPE_EXTENSION="EnumTypeExtension",r.INPUT_OBJECT_TYPE_EXTENSION="InputObjectTypeExtension"})(kr||(kr={}));function PI(r){return r===9||r===32}function tv(r){return r>=48&&r<=57}function h9(r){return r>=97&&r<=122||r>=65&&r<=90}function d9(r){return h9(r)||r===95}function I_e(r){return h9(r)||tv(r)||r===95}function B_e(r){var e;let i=Number.MAX_SAFE_INTEGER,n=null,s=-1;for(let l=0;l<r.length;++l){var o;const u=r[l],c=N_e(u);c!==u.length&&(n=(o=n)!==null&&o!==void 0?o:l,s=l,l!==0&&c<i&&(i=c))}return r.map((l,u)=>u===0?l:l.slice(i)).slice((e=n)!==null&&e!==void 0?e:0,s+1)}function N_e(r){let e=0;for(;e<r.length&&PI(r.charCodeAt(e));)++e;return e}function L_e(r,e){const i=r.replace(/"""/g,'\\"""'),n=i.split(/\r\n|[\n\r]/g),s=n.length===1,o=n.length>1&&n.slice(1).every(g=>g.length===0||PI(g.charCodeAt(0))),l=i.endsWith('\\"""'),u=r.endsWith('"')&&!l,c=r.endsWith("\\"),h=u||c,p=!s||r.length>70||h||o||l;let f="";const m=s&&PI(r.charCodeAt(0));return(p&&!m||o)&&(f+=`
`),f+=i,(p||h)&&(f+=`
`),'"""'+f+'"""'}var ri;(function(r){r.SOF="<SOF>",r.EOF="<EOF>",r.BANG="!",r.DOLLAR="$",r.AMP="&",r.PAREN_L="(",r.PAREN_R=")",r.SPREAD="...",r.COLON=":",r.EQUALS="=",r.AT="@",r.BRACKET_L="[",r.BRACKET_R="]",r.BRACE_L="{",r.PIPE="|",r.BRACE_R="}",r.NAME="Name",r.INT="Int",r.FLOAT="Float",r.STRING="String",r.BLOCK_STRING="BlockString",r.COMMENT="Comment"})(ri||(ri={}));class D_e{constructor(e){const i=new l9(ri.SOF,0,0,0,0);this.source=e,this.lastToken=i,this.token=i,this.line=1,this.lineStart=0}get[Symbol.toStringTag](){return"Lexer"}advance(){return this.lastToken=this.token,this.token=this.lookahead()}lookahead(){let e=this.token;if(e.kind!==ri.EOF)do if(e.next)e=e.next;else{const i=P_e(this,e.end);e.next=i,i.prev=e,e=i}while(e.kind===ri.COMMENT);return e}}function O_e(r){return r===ri.BANG||r===ri.DOLLAR||r===ri.AMP||r===ri.PAREN_L||r===ri.PAREN_R||r===ri.SPREAD||r===ri.COLON||r===ri.EQUALS||r===ri.AT||r===ri.BRACKET_L||r===ri.BRACKET_R||r===ri.BRACE_L||r===ri.PIPE||r===ri.BRACE_R}function Xg(r){return r>=0&&r<=55295||r>=57344&&r<=1114111}function lE(r,e){return p9(r.charCodeAt(e))&&f9(r.charCodeAt(e+1))}function p9(r){return r>=55296&&r<=56319}function f9(r){return r>=56320&&r<=57343}function tf(r,e){const i=r.source.body.codePointAt(e);if(i===void 0)return ri.EOF;if(i>=32&&i<=126){const n=String.fromCodePoint(i);return n==='"'?`'"'`:`"${n}"`}return"U+"+i.toString(16).toUpperCase().padStart(4,"0")}function oa(r,e,i,n,s){const o=r.line,l=1+i-r.lineStart;return new l9(e,i,n,o,l,s)}function P_e(r,e){const i=r.source.body,n=i.length;let s=e;for(;s<n;){const o=i.charCodeAt(s);switch(o){case 65279:case 9:case 32:case 44:++s;continue;case 10:++s,++r.line,r.lineStart=s;continue;case 13:i.charCodeAt(s+1)===10?s+=2:++s,++r.line,r.lineStart=s;continue;case 35:return k_e(r,s);case 33:return oa(r,ri.BANG,s,s+1);case 36:return oa(r,ri.DOLLAR,s,s+1);case 38:return oa(r,ri.AMP,s,s+1);case 40:return oa(r,ri.PAREN_L,s,s+1);case 41:return oa(r,ri.PAREN_R,s,s+1);case 46:if(i.charCodeAt(s+1)===46&&i.charCodeAt(s+2)===46)return oa(r,ri.SPREAD,s,s+3);break;case 58:return oa(r,ri.COLON,s,s+1);case 61:return oa(r,ri.EQUALS,s,s+1);case 64:return oa(r,ri.AT,s,s+1);case 91:return oa(r,ri.BRACKET_L,s,s+1);case 93:return oa(r,ri.BRACKET_R,s,s+1);case 123:return oa(r,ri.BRACE_L,s,s+1);case 124:return oa(r,ri.PIPE,s,s+1);case 125:return oa(r,ri.BRACE_R,s,s+1);case 34:return i.charCodeAt(s+1)===34&&i.charCodeAt(s+2)===34?G_e(r,s):U_e(r,s)}if(tv(o)||o===45)return F_e(r,s,o);if(d9(o))return H_e(r,s);throw Ba(r.source,s,o===39?`Unexpected single quote character ('), did you mean to use a double quote (")?`:Xg(o)||lE(i,s)?`Unexpected character: ${tf(r,s)}.`:`Invalid character: ${tf(r,s)}.`)}return oa(r,ri.EOF,n,n)}function k_e(r,e){const i=r.source.body,n=i.length;let s=e+1;for(;s<n;){const o=i.charCodeAt(s);if(o===10||o===13)break;if(Xg(o))++s;else if(lE(i,s))s+=2;else break}return oa(r,ri.COMMENT,e,s,i.slice(e+1,s))}function F_e(r,e,i){const n=r.source.body;let s=e,o=i,l=!1;if(o===45&&(o=n.charCodeAt(++s)),o===48){if(o=n.charCodeAt(++s),tv(o))throw Ba(r.source,s,`Invalid number, unexpected digit after 0: ${tf(r,s)}.`)}else s=kI(r,s,o),o=n.charCodeAt(s);if(o===46&&(l=!0,o=n.charCodeAt(++s),s=kI(r,s,o),o=n.charCodeAt(s)),(o===69||o===101)&&(l=!0,o=n.charCodeAt(++s),(o===43||o===45)&&(o=n.charCodeAt(++s)),s=kI(r,s,o),o=n.charCodeAt(s)),o===46||d9(o))throw Ba(r.source,s,`Invalid number, expected digit but got: ${tf(r,s)}.`);return oa(r,l?ri.FLOAT:ri.INT,e,s,n.slice(e,s))}function kI(r,e,i){if(!tv(i))throw Ba(r.source,e,`Invalid number, expected digit but got: ${tf(r,e)}.`);const n=r.source.body;let s=e+1;for(;tv(n.charCodeAt(s));)++s;return s}function U_e(r,e){const i=r.source.body,n=i.length;let s=e+1,o=s,l="";for(;s<n;){const u=i.charCodeAt(s);if(u===34)return l+=i.slice(o,s),oa(r,ri.STRING,e,s+1,l);if(u===92){l+=i.slice(o,s);const c=i.charCodeAt(s+1)===117?i.charCodeAt(s+2)===123?z_e(r,s):j_e(r,s):V_e(r,s);l+=c.value,s+=c.size,o=s;continue}if(u===10||u===13)break;if(Xg(u))++s;else if(lE(i,s))s+=2;else throw Ba(r.source,s,`Invalid character within String: ${tf(r,s)}.`)}throw Ba(r.source,s,"Unterminated string.")}function z_e(r,e){const i=r.source.body;let n=0,s=3;for(;s<12;){const o=i.charCodeAt(e+s++);if(o===125){if(s<5||!Xg(n))break;return{value:String.fromCodePoint(n),size:s}}if(n=n<<4|iv(o),n<0)break}throw Ba(r.source,e,`Invalid Unicode escape sequence: "${i.slice(e,e+s)}".`)}function j_e(r,e){const i=r.source.body,n=m9(i,e+2);if(Xg(n))return{value:String.fromCodePoint(n),size:6};if(p9(n)&&i.charCodeAt(e+6)===92&&i.charCodeAt(e+7)===117){const s=m9(i,e+8);if(f9(s))return{value:String.fromCodePoint(n,s),size:12}}throw Ba(r.source,e,`Invalid Unicode escape sequence: "${i.slice(e,e+6)}".`)}function m9(r,e){return iv(r.charCodeAt(e))<<12|iv(r.charCodeAt(e+1))<<8|iv(r.charCodeAt(e+2))<<4|iv(r.charCodeAt(e+3))}function iv(r){return r>=48&&r<=57?r-48:r>=65&&r<=70?r-55:r>=97&&r<=102?r-87:-1}function V_e(r,e){const i=r.source.body;switch(i.charCodeAt(e+1)){case 34:return{value:'"',size:2};case 92:return{value:"\\",size:2};case 47:return{value:"/",size:2};case 98:return{value:"\b",size:2};case 102:return{value:"\f",size:2};case 110:return{value:`
`,size:2};case 114:return{value:"\r",size:2};case 116:return{value:"	",size:2}}throw Ba(r.source,e,`Invalid character escape sequence: "${i.slice(e,e+2)}".`)}function G_e(r,e){const i=r.source.body,n=i.length;let s=r.lineStart,o=e+3,l=o,u="";const c=[];for(;o<n;){const h=i.charCodeAt(o);if(h===34&&i.charCodeAt(o+1)===34&&i.charCodeAt(o+2)===34){u+=i.slice(l,o),c.push(u);const p=oa(r,ri.BLOCK_STRING,e,o+3,B_e(c).join(`
`));return r.line+=c.length-1,r.lineStart=s,p}if(h===92&&i.charCodeAt(o+1)===34&&i.charCodeAt(o+2)===34&&i.charCodeAt(o+3)===34){u+=i.slice(l,o),l=o+1,o+=4;continue}if(h===10||h===13){u+=i.slice(l,o),c.push(u),h===13&&i.charCodeAt(o+1)===10?o+=2:++o,u="",l=o,s=o;continue}if(Xg(h))++o;else if(lE(i,o))o+=2;else throw Ba(r.source,o,`Invalid character within String: ${tf(r,o)}.`)}throw Ba(r.source,o,"Unterminated string.")}function H_e(r,e){const i=r.source.body,n=i.length;let s=e+1;for(;s<n;){const o=i.charCodeAt(s);if(I_e(o))++s;else break}return oa(r,ri.NAME,e,s,i.slice(e,s))}const W_e=10,g9=2;function FI(r){return cE(r,[])}function cE(r,e){switch(typeof r){case"string":return JSON.stringify(r);case"function":return r.name?`[function ${r.name}]`:"[function]";case"object":return Q_e(r,e);default:return String(r)}}function Q_e(r,e){if(r===null)return"null";if(e.includes(r))return"[Circular]";const i=[...e,r];if(q_e(r)){const n=r.toJSON();if(n!==r)return typeof n=="string"?n:cE(n,i)}else if(Array.isArray(r))return Y_e(r,i);return X_e(r,i)}function q_e(r){return typeof r.toJSON=="function"}function X_e(r,e){const i=Object.entries(r);return i.length===0?"{}":e.length>g9?"["+K_e(r)+"]":"{ "+i.map(([n,s])=>n+": "+cE(s,e)).join(", ")+" }"}function Y_e(r,e){if(r.length===0)return"[]";if(e.length>g9)return"[Array]";const i=Math.min(W_e,r.length),n=r.length-i,s=[];for(let o=0;o<i;++o)s.push(cE(r[o],e));return n===1?s.push("... 1 more item"):n>1&&s.push(`... ${n} more items`),"["+s.join(", ")+"]"}function K_e(r){const e=Object.prototype.toString.call(r).replace(/^\[object /,"").replace(/]$/,"");if(e==="Object"&&typeof r.constructor=="function"){const i=r.constructor.name;if(typeof i=="string"&&i!=="")return i}return e}const J_e=globalThis.process&&process.env.NODE_ENV==="production",Z_e=J_e?function(r,e){return r instanceof e}:function(r,e){if(r instanceof e)return!0;if(typeof r=="object"&&r!==null){var i;const n=e.prototype[Symbol.toStringTag],s=Symbol.toStringTag in r?r[Symbol.toStringTag]:(i=r.constructor)===null||i===void 0?void 0:i.name;if(n===s){const o=FI(r);throw new Error(`Cannot use ${n} "${o}" from another module or realm.

Ensure that there is only one instance of "graphql" in the node_modules
directory. If different versions of "graphql" are the dependencies of other
relied on modules, use "resolutions" to ensure only one version is installed.

https://yarnpkg.com/en/docs/selective-version-resolutions

Duplicate "graphql" modules cannot be used at the same time since different
versions may have different capabilities and behavior. The data from one
version used in the function from another could produce confusing and
spurious results.`)}}return!1};class A9{constructor(e,i="GraphQL request",n={line:1,column:1}){typeof e=="string"||oE(!1,`Body must be a string. Received: ${FI(e)}.`),this.body=e,this.name=i,this.locationOffset=n,this.locationOffset.line>0||oE(!1,"line in locationOffset is 1-indexed and must be positive."),this.locationOffset.column>0||oE(!1,"column in locationOffset is 1-indexed and must be positive.")}get[Symbol.toStringTag](){return"Source"}}function $_e(r){return Z_e(r,A9)}function eEe(r,e){return new tEe(r,e).parseDocument()}class tEe{constructor(e,i={}){const n=$_e(e)?e:new A9(e);this._lexer=new D_e(n),this._options=i,this._tokenCounter=0}parseName(){const e=this.expectToken(ri.NAME);return this.node(e,{kind:kr.NAME,value:e.value})}parseDocument(){return this.node(this._lexer.token,{kind:kr.DOCUMENT,definitions:this.many(ri.SOF,this.parseDefinition,ri.EOF)})}parseDefinition(){if(this.peek(ri.BRACE_L))return this.parseOperationDefinition();const e=this.peekDescription(),i=e?this._lexer.lookahead():this._lexer.token;if(i.kind===ri.NAME){switch(i.value){case"schema":return this.parseSchemaDefinition();case"scalar":return this.parseScalarTypeDefinition();case"type":return this.parseObjectTypeDefinition();case"interface":return this.parseInterfaceTypeDefinition();case"union":return this.parseUnionTypeDefinition();case"enum":return this.parseEnumTypeDefinition();case"input":return this.parseInputObjectTypeDefinition();case"directive":return this.parseDirectiveDefinition()}if(e)throw Ba(this._lexer.source,this._lexer.token.start,"Unexpected description, descriptions are supported only on type definitions.");switch(i.value){case"query":case"mutation":case"subscription":return this.parseOperationDefinition();case"fragment":return this.parseFragmentDefinition();case"extend":return this.parseTypeSystemExtension()}}throw this.unexpected(i)}parseOperationDefinition(){const e=this._lexer.token;if(this.peek(ri.BRACE_L))return this.node(e,{kind:kr.OPERATION_DEFINITION,operation:ef.QUERY,name:void 0,variableDefinitions:[],directives:[],selectionSet:this.parseSelectionSet()});const i=this.parseOperationType();let n;return this.peek(ri.NAME)&&(n=this.parseName()),this.node(e,{kind:kr.OPERATION_DEFINITION,operation:i,name:n,variableDefinitions:this.parseVariableDefinitions(),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseOperationType(){const e=this.expectToken(ri.NAME);switch(e.value){case"query":return ef.QUERY;case"mutation":return ef.MUTATION;case"subscription":return ef.SUBSCRIPTION}throw this.unexpected(e)}parseVariableDefinitions(){return this.optionalMany(ri.PAREN_L,this.parseVariableDefinition,ri.PAREN_R)}parseVariableDefinition(){return this.node(this._lexer.token,{kind:kr.VARIABLE_DEFINITION,variable:this.parseVariable(),type:(this.expectToken(ri.COLON),this.parseTypeReference()),defaultValue:this.expectOptionalToken(ri.EQUALS)?this.parseConstValueLiteral():void 0,directives:this.parseConstDirectives()})}parseVariable(){const e=this._lexer.token;return this.expectToken(ri.DOLLAR),this.node(e,{kind:kr.VARIABLE,name:this.parseName()})}parseSelectionSet(){return this.node(this._lexer.token,{kind:kr.SELECTION_SET,selections:this.many(ri.BRACE_L,this.parseSelection,ri.BRACE_R)})}parseSelection(){return this.peek(ri.SPREAD)?this.parseFragment():this.parseField()}parseField(){const e=this._lexer.token,i=this.parseName();let n,s;return this.expectOptionalToken(ri.COLON)?(n=i,s=this.parseName()):s=i,this.node(e,{kind:kr.FIELD,alias:n,name:s,arguments:this.parseArguments(!1),directives:this.parseDirectives(!1),selectionSet:this.peek(ri.BRACE_L)?this.parseSelectionSet():void 0})}parseArguments(e){const i=e?this.parseConstArgument:this.parseArgument;return this.optionalMany(ri.PAREN_L,i,ri.PAREN_R)}parseArgument(e=!1){const i=this._lexer.token,n=this.parseName();return this.expectToken(ri.COLON),this.node(i,{kind:kr.ARGUMENT,name:n,value:this.parseValueLiteral(e)})}parseConstArgument(){return this.parseArgument(!0)}parseFragment(){const e=this._lexer.token;this.expectToken(ri.SPREAD);const i=this.expectOptionalKeyword("on");return!i&&this.peek(ri.NAME)?this.node(e,{kind:kr.FRAGMENT_SPREAD,name:this.parseFragmentName(),directives:this.parseDirectives(!1)}):this.node(e,{kind:kr.INLINE_FRAGMENT,typeCondition:i?this.parseNamedType():void 0,directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentDefinition(){const e=this._lexer.token;return this.expectKeyword("fragment"),this._options.allowLegacyFragmentVariables===!0?this.node(e,{kind:kr.FRAGMENT_DEFINITION,name:this.parseFragmentName(),variableDefinitions:this.parseVariableDefinitions(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()}):this.node(e,{kind:kr.FRAGMENT_DEFINITION,name:this.parseFragmentName(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentName(){if(this._lexer.token.value==="on")throw this.unexpected();return this.parseName()}parseValueLiteral(e){const i=this._lexer.token;switch(i.kind){case ri.BRACKET_L:return this.parseList(e);case ri.BRACE_L:return this.parseObject(e);case ri.INT:return this.advanceLexer(),this.node(i,{kind:kr.INT,value:i.value});case ri.FLOAT:return this.advanceLexer(),this.node(i,{kind:kr.FLOAT,value:i.value});case ri.STRING:case ri.BLOCK_STRING:return this.parseStringLiteral();case ri.NAME:switch(this.advanceLexer(),i.value){case"true":return this.node(i,{kind:kr.BOOLEAN,value:!0});case"false":return this.node(i,{kind:kr.BOOLEAN,value:!1});case"null":return this.node(i,{kind:kr.NULL});default:return this.node(i,{kind:kr.ENUM,value:i.value})}case ri.DOLLAR:if(e)if(this.expectToken(ri.DOLLAR),this._lexer.token.kind===ri.NAME){const n=this._lexer.token.value;throw Ba(this._lexer.source,i.start,`Unexpected variable "$${n}" in constant value.`)}else throw this.unexpected(i);return this.parseVariable();default:throw this.unexpected()}}parseConstValueLiteral(){return this.parseValueLiteral(!0)}parseStringLiteral(){const e=this._lexer.token;return this.advanceLexer(),this.node(e,{kind:kr.STRING,value:e.value,block:e.kind===ri.BLOCK_STRING})}parseList(e){const i=()=>this.parseValueLiteral(e);return this.node(this._lexer.token,{kind:kr.LIST,values:this.any(ri.BRACKET_L,i,ri.BRACKET_R)})}parseObject(e){const i=()=>this.parseObjectField(e);return this.node(this._lexer.token,{kind:kr.OBJECT,fields:this.any(ri.BRACE_L,i,ri.BRACE_R)})}parseObjectField(e){const i=this._lexer.token,n=this.parseName();return this.expectToken(ri.COLON),this.node(i,{kind:kr.OBJECT_FIELD,name:n,value:this.parseValueLiteral(e)})}parseDirectives(e){const i=[];for(;this.peek(ri.AT);)i.push(this.parseDirective(e));return i}parseConstDirectives(){return this.parseDirectives(!0)}parseDirective(e){const i=this._lexer.token;return this.expectToken(ri.AT),this.node(i,{kind:kr.DIRECTIVE,name:this.parseName(),arguments:this.parseArguments(e)})}parseTypeReference(){const e=this._lexer.token;let i;if(this.expectOptionalToken(ri.BRACKET_L)){const n=this.parseTypeReference();this.expectToken(ri.BRACKET_R),i=this.node(e,{kind:kr.LIST_TYPE,type:n})}else i=this.parseNamedType();return this.expectOptionalToken(ri.BANG)?this.node(e,{kind:kr.NON_NULL_TYPE,type:i}):i}parseNamedType(){return this.node(this._lexer.token,{kind:kr.NAMED_TYPE,name:this.parseName()})}peekDescription(){return this.peek(ri.STRING)||this.peek(ri.BLOCK_STRING)}parseDescription(){if(this.peekDescription())return this.parseStringLiteral()}parseSchemaDefinition(){const e=this._lexer.token,i=this.parseDescription();this.expectKeyword("schema");const n=this.parseConstDirectives(),s=this.many(ri.BRACE_L,this.parseOperationTypeDefinition,ri.BRACE_R);return this.node(e,{kind:kr.SCHEMA_DEFINITION,description:i,directives:n,operationTypes:s})}parseOperationTypeDefinition(){const e=this._lexer.token,i=this.parseOperationType();this.expectToken(ri.COLON);const n=this.parseNamedType();return this.node(e,{kind:kr.OPERATION_TYPE_DEFINITION,operation:i,type:n})}parseScalarTypeDefinition(){const e=this._lexer.token,i=this.parseDescription();this.expectKeyword("scalar");const n=this.parseName(),s=this.parseConstDirectives();return this.node(e,{kind:kr.SCALAR_TYPE_DEFINITION,description:i,name:n,directives:s})}parseObjectTypeDefinition(){const e=this._lexer.token,i=this.parseDescription();this.expectKeyword("type");const n=this.parseName(),s=this.parseImplementsInterfaces(),o=this.parseConstDirectives(),l=this.parseFieldsDefinition();return this.node(e,{kind:kr.OBJECT_TYPE_DEFINITION,description:i,name:n,interfaces:s,directives:o,fields:l})}parseImplementsInterfaces(){return this.expectOptionalKeyword("implements")?this.delimitedMany(ri.AMP,this.parseNamedType):[]}parseFieldsDefinition(){return this.optionalMany(ri.BRACE_L,this.parseFieldDefinition,ri.BRACE_R)}parseFieldDefinition(){const e=this._lexer.token,i=this.parseDescription(),n=this.parseName(),s=this.parseArgumentDefs();this.expectToken(ri.COLON);const o=this.parseTypeReference(),l=this.parseConstDirectives();return this.node(e,{kind:kr.FIELD_DEFINITION,description:i,name:n,arguments:s,type:o,directives:l})}parseArgumentDefs(){return this.optionalMany(ri.PAREN_L,this.parseInputValueDef,ri.PAREN_R)}parseInputValueDef(){const e=this._lexer.token,i=this.parseDescription(),n=this.parseName();this.expectToken(ri.COLON);const s=this.parseTypeReference();let o;this.expectOptionalToken(ri.EQUALS)&&(o=this.parseConstValueLiteral());const l=this.parseConstDirectives();return this.node(e,{kind:kr.INPUT_VALUE_DEFINITION,description:i,name:n,type:s,defaultValue:o,directives:l})}parseInterfaceTypeDefinition(){const e=this._lexer.token,i=this.parseDescription();this.expectKeyword("interface");const n=this.parseName(),s=this.parseImplementsInterfaces(),o=this.parseConstDirectives(),l=this.parseFieldsDefinition();return this.node(e,{kind:kr.INTERFACE_TYPE_DEFINITION,description:i,name:n,interfaces:s,directives:o,fields:l})}parseUnionTypeDefinition(){const e=this._lexer.token,i=this.parseDescription();this.expectKeyword("union");const n=this.parseName(),s=this.parseConstDirectives(),o=this.parseUnionMemberTypes();return this.node(e,{kind:kr.UNION_TYPE_DEFINITION,description:i,name:n,directives:s,types:o})}parseUnionMemberTypes(){return this.expectOptionalToken(ri.EQUALS)?this.delimitedMany(ri.PIPE,this.parseNamedType):[]}parseEnumTypeDefinition(){const e=this._lexer.token,i=this.parseDescription();this.expectKeyword("enum");const n=this.parseName(),s=this.parseConstDirectives(),o=this.parseEnumValuesDefinition();return this.node(e,{kind:kr.ENUM_TYPE_DEFINITION,description:i,name:n,directives:s,values:o})}parseEnumValuesDefinition(){return this.optionalMany(ri.BRACE_L,this.parseEnumValueDefinition,ri.BRACE_R)}parseEnumValueDefinition(){const e=this._lexer.token,i=this.parseDescription(),n=this.parseEnumValueName(),s=this.parseConstDirectives();return this.node(e,{kind:kr.ENUM_VALUE_DEFINITION,description:i,name:n,directives:s})}parseEnumValueName(){if(this._lexer.token.value==="true"||this._lexer.token.value==="false"||this._lexer.token.value==="null")throw Ba(this._lexer.source,this._lexer.token.start,`${uE(this._lexer.token)} is reserved and cannot be used for an enum value.`);return this.parseName()}parseInputObjectTypeDefinition(){const e=this._lexer.token,i=this.parseDescription();this.expectKeyword("input");const n=this.parseName(),s=this.parseConstDirectives(),o=this.parseInputFieldsDefinition();return this.node(e,{kind:kr.INPUT_OBJECT_TYPE_DEFINITION,description:i,name:n,directives:s,fields:o})}parseInputFieldsDefinition(){return this.optionalMany(ri.BRACE_L,this.parseInputValueDef,ri.BRACE_R)}parseTypeSystemExtension(){const e=this._lexer.lookahead();if(e.kind===ri.NAME)switch(e.value){case"schema":return this.parseSchemaExtension();case"scalar":return this.parseScalarTypeExtension();case"type":return this.parseObjectTypeExtension();case"interface":return this.parseInterfaceTypeExtension();case"union":return this.parseUnionTypeExtension();case"enum":return this.parseEnumTypeExtension();case"input":return this.parseInputObjectTypeExtension()}throw this.unexpected(e)}parseSchemaExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("schema");const i=this.parseConstDirectives(),n=this.optionalMany(ri.BRACE_L,this.parseOperationTypeDefinition,ri.BRACE_R);if(i.length===0&&n.length===0)throw this.unexpected();return this.node(e,{kind:kr.SCHEMA_EXTENSION,directives:i,operationTypes:n})}parseScalarTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("scalar");const i=this.parseName(),n=this.parseConstDirectives();if(n.length===0)throw this.unexpected();return this.node(e,{kind:kr.SCALAR_TYPE_EXTENSION,name:i,directives:n})}parseObjectTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("type");const i=this.parseName(),n=this.parseImplementsInterfaces(),s=this.parseConstDirectives(),o=this.parseFieldsDefinition();if(n.length===0&&s.length===0&&o.length===0)throw this.unexpected();return this.node(e,{kind:kr.OBJECT_TYPE_EXTENSION,name:i,interfaces:n,directives:s,fields:o})}parseInterfaceTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("interface");const i=this.parseName(),n=this.parseImplementsInterfaces(),s=this.parseConstDirectives(),o=this.parseFieldsDefinition();if(n.length===0&&s.length===0&&o.length===0)throw this.unexpected();return this.node(e,{kind:kr.INTERFACE_TYPE_EXTENSION,name:i,interfaces:n,directives:s,fields:o})}parseUnionTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("union");const i=this.parseName(),n=this.parseConstDirectives(),s=this.parseUnionMemberTypes();if(n.length===0&&s.length===0)throw this.unexpected();return this.node(e,{kind:kr.UNION_TYPE_EXTENSION,name:i,directives:n,types:s})}parseEnumTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("enum");const i=this.parseName(),n=this.parseConstDirectives(),s=this.parseEnumValuesDefinition();if(n.length===0&&s.length===0)throw this.unexpected();return this.node(e,{kind:kr.ENUM_TYPE_EXTENSION,name:i,directives:n,values:s})}parseInputObjectTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("input");const i=this.parseName(),n=this.parseConstDirectives(),s=this.parseInputFieldsDefinition();if(n.length===0&&s.length===0)throw this.unexpected();return this.node(e,{kind:kr.INPUT_OBJECT_TYPE_EXTENSION,name:i,directives:n,fields:s})}parseDirectiveDefinition(){const e=this._lexer.token,i=this.parseDescription();this.expectKeyword("directive"),this.expectToken(ri.AT);const n=this.parseName(),s=this.parseArgumentDefs(),o=this.expectOptionalKeyword("repeatable");this.expectKeyword("on");const l=this.parseDirectiveLocations();return this.node(e,{kind:kr.DIRECTIVE_DEFINITION,description:i,name:n,arguments:s,repeatable:o,locations:l})}parseDirectiveLocations(){return this.delimitedMany(ri.PIPE,this.parseDirectiveLocation)}parseDirectiveLocation(){const e=this._lexer.token,i=this.parseName();if(Object.prototype.hasOwnProperty.call(OI,i.value))return i;throw this.unexpected(e)}node(e,i){return this._options.noLocation!==!0&&(i.loc=new M_e(e,this._lexer.lastToken,this._lexer.source)),i}peek(e){return this._lexer.token.kind===e}expectToken(e){const i=this._lexer.token;if(i.kind===e)return this.advanceLexer(),i;throw Ba(this._lexer.source,i.start,`Expected ${y9(e)}, found ${uE(i)}.`)}expectOptionalToken(e){return this._lexer.token.kind===e?(this.advanceLexer(),!0):!1}expectKeyword(e){const i=this._lexer.token;if(i.kind===ri.NAME&&i.value===e)this.advanceLexer();else throw Ba(this._lexer.source,i.start,`Expected "${e}", found ${uE(i)}.`)}expectOptionalKeyword(e){const i=this._lexer.token;return i.kind===ri.NAME&&i.value===e?(this.advanceLexer(),!0):!1}unexpected(e){const i=e??this._lexer.token;return Ba(this._lexer.source,i.start,`Unexpected ${uE(i)}.`)}any(e,i,n){this.expectToken(e);const s=[];for(;!this.expectOptionalToken(n);)s.push(i.call(this));return s}optionalMany(e,i,n){if(this.expectOptionalToken(e)){const s=[];do s.push(i.call(this));while(!this.expectOptionalToken(n));return s}return[]}many(e,i,n){this.expectToken(e);const s=[];do s.push(i.call(this));while(!this.expectOptionalToken(n));return s}delimitedMany(e,i){this.expectOptionalToken(e);const n=[];do n.push(i.call(this));while(this.expectOptionalToken(e));return n}advanceLexer(){const{maxTokens:e}=this._options,i=this._lexer.advance();if(e!==void 0&&i.kind!==ri.EOF&&(++this._tokenCounter,this._tokenCounter>e))throw Ba(this._lexer.source,i.start,`Document contains more that ${e} tokens. Parsing aborted.`)}}function uE(r){const e=r.value;return y9(r.kind)+(e!=null?` "${e}"`:"")}function y9(r){return O_e(r)?`"${r}"`:r}function iEe(r){return`"${r.replace(rEe,nEe)}"`}const rEe=/[\x00-\x1f\x22\x5c\x7f-\x9f]/g;function nEe(r){return sEe[r.charCodeAt(0)]}const sEe=["\\u0000","\\u0001","\\u0002","\\u0003","\\u0004","\\u0005","\\u0006","\\u0007","\\b","\\t","\\n","\\u000B","\\f","\\r","\\u000E","\\u000F","\\u0010","\\u0011","\\u0012","\\u0013","\\u0014","\\u0015","\\u0016","\\u0017","\\u0018","\\u0019","\\u001A","\\u001B","\\u001C","\\u001D","\\u001E","\\u001F","","",'\\"',"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\\\","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\u007F","\\u0080","\\u0081","\\u0082","\\u0083","\\u0084","\\u0085","\\u0086","\\u0087","\\u0088","\\u0089","\\u008A","\\u008B","\\u008C","\\u008D","\\u008E","\\u008F","\\u0090","\\u0091","\\u0092","\\u0093","\\u0094","\\u0095","\\u0096","\\u0097","\\u0098","\\u0099","\\u009A","\\u009B","\\u009C","\\u009D","\\u009E","\\u009F"],aEe=Object.freeze({});function oEe(r,e,i=c9){const n=new Map;for(const _ of Object.values(kr))n.set(_,lEe(e,_));let s,o=Array.isArray(r),l=[r],u=-1,c=[],h=r,p,f;const m=[],g=[];do{u++;const _=u===l.length,T=_&&c.length!==0;if(_){if(p=g.length===0?void 0:m[m.length-1],h=f,f=g.pop(),T)if(o){h=h.slice();let S=0;for(const[R,B]of c){const I=R-S;B===null?(h.splice(I,1),S++):h[I]=B}}else{h=Object.defineProperties({},Object.getOwnPropertyDescriptors(h));for(const[S,R]of c)h[S]=R}u=s.index,l=s.keys,c=s.edits,o=s.inArray,s=s.prev}else if(f){if(p=o?u:l[u],h=f[p],h==null)continue;m.push(p)}let w;if(!Array.isArray(h)){var y,x;u9(h)||oE(!1,`Invalid AST Node: ${FI(h)}.`);const S=_?(y=n.get(h.kind))===null||y===void 0?void 0:y.leave:(x=n.get(h.kind))===null||x===void 0?void 0:x.enter;if(w=S==null?void 0:S.call(e,h,p,f,m,g),w===aEe)break;if(w===!1){if(!_){m.pop();continue}}else if(w!==void 0&&(c.push([p,w]),!_))if(u9(w))h=w;else{m.pop();continue}}if(w===void 0&&T&&c.push([p,h]),_)m.pop();else{var v;s={inArray:o,index:u,keys:l,edits:c,prev:s},o=Array.isArray(h),l=o?h:(v=i[h.kind])!==null&&v!==void 0?v:[],u=-1,c=[],f&&g.push(f),f=h}}while(s!==void 0);return c.length!==0?c[c.length-1][1]:r}function lEe(r,e){const i=r[e];return typeof i=="object"?i:typeof i=="function"?{enter:i,leave:void 0}:{enter:r.enter,leave:r.leave}}function cEe(r){return oEe(r,hEe)}const uEe=80,hEe={Name:{leave:r=>r.value},Variable:{leave:r=>"$"+r.name},Document:{leave:r=>Ar(r.definitions,`

`)},OperationDefinition:{leave(r){const e=Rn("(",Ar(r.variableDefinitions,", "),")"),i=Ar([r.operation,Ar([r.name,e]),Ar(r.directives," ")]," ");return(i==="query"?"":i+" ")+r.selectionSet}},VariableDefinition:{leave:({variable:r,type:e,defaultValue:i,directives:n})=>r+": "+e+Rn(" = ",i)+Rn(" ",Ar(n," "))},SelectionSet:{leave:({selections:r})=>Sc(r)},Field:{leave({alias:r,name:e,arguments:i,directives:n,selectionSet:s}){const o=Rn("",r,": ")+e;let l=o+Rn("(",Ar(i,", "),")");return l.length>uEe&&(l=o+Rn(`(
`,hE(Ar(i,`
`)),`
)`)),Ar([l,Ar(n," "),s]," ")}},Argument:{leave:({name:r,value:e})=>r+": "+e},FragmentSpread:{leave:({name:r,directives:e})=>"..."+r+Rn(" ",Ar(e," "))},InlineFragment:{leave:({typeCondition:r,directives:e,selectionSet:i})=>Ar(["...",Rn("on ",r),Ar(e," "),i]," ")},FragmentDefinition:{leave:({name:r,typeCondition:e,variableDefinitions:i,directives:n,selectionSet:s})=>`fragment ${r}${Rn("(",Ar(i,", "),")")} on ${e} ${Rn("",Ar(n," ")," ")}`+s},IntValue:{leave:({value:r})=>r},FloatValue:{leave:({value:r})=>r},StringValue:{leave:({value:r,block:e})=>e?L_e(r):iEe(r)},BooleanValue:{leave:({value:r})=>r?"true":"false"},NullValue:{leave:()=>"null"},EnumValue:{leave:({value:r})=>r},ListValue:{leave:({values:r})=>"["+Ar(r,", ")+"]"},ObjectValue:{leave:({fields:r})=>"{"+Ar(r,", ")+"}"},ObjectField:{leave:({name:r,value:e})=>r+": "+e},Directive:{leave:({name:r,arguments:e})=>"@"+r+Rn("(",Ar(e,", "),")")},NamedType:{leave:({name:r})=>r},ListType:{leave:({type:r})=>"["+r+"]"},NonNullType:{leave:({type:r})=>r+"!"},SchemaDefinition:{leave:({description:r,directives:e,operationTypes:i})=>Rn("",r,`
`)+Ar(["schema",Ar(e," "),Sc(i)]," ")},OperationTypeDefinition:{leave:({operation:r,type:e})=>r+": "+e},ScalarTypeDefinition:{leave:({description:r,name:e,directives:i})=>Rn("",r,`
`)+Ar(["scalar",e,Ar(i," ")]," ")},ObjectTypeDefinition:{leave:({description:r,name:e,interfaces:i,directives:n,fields:s})=>Rn("",r,`
`)+Ar(["type",e,Rn("implements ",Ar(i," & ")),Ar(n," "),Sc(s)]," ")},FieldDefinition:{leave:({description:r,name:e,arguments:i,type:n,directives:s})=>Rn("",r,`
`)+e+(v9(i)?Rn(`(
`,hE(Ar(i,`
`)),`
)`):Rn("(",Ar(i,", "),")"))+": "+n+Rn(" ",Ar(s," "))},InputValueDefinition:{leave:({description:r,name:e,type:i,defaultValue:n,directives:s})=>Rn("",r,`
`)+Ar([e+": "+i,Rn("= ",n),Ar(s," ")]," ")},InterfaceTypeDefinition:{leave:({description:r,name:e,interfaces:i,directives:n,fields:s})=>Rn("",r,`
`)+Ar(["interface",e,Rn("implements ",Ar(i," & ")),Ar(n," "),Sc(s)]," ")},UnionTypeDefinition:{leave:({description:r,name:e,directives:i,types:n})=>Rn("",r,`
`)+Ar(["union",e,Ar(i," "),Rn("= ",Ar(n," | "))]," ")},EnumTypeDefinition:{leave:({description:r,name:e,directives:i,values:n})=>Rn("",r,`
`)+Ar(["enum",e,Ar(i," "),Sc(n)]," ")},EnumValueDefinition:{leave:({description:r,name:e,directives:i})=>Rn("",r,`
`)+Ar([e,Ar(i," ")]," ")},InputObjectTypeDefinition:{leave:({description:r,name:e,directives:i,fields:n})=>Rn("",r,`
`)+Ar(["input",e,Ar(i," "),Sc(n)]," ")},DirectiveDefinition:{leave:({description:r,name:e,arguments:i,repeatable:n,locations:s})=>Rn("",r,`
`)+"directive @"+e+(v9(i)?Rn(`(
`,hE(Ar(i,`
`)),`
)`):Rn("(",Ar(i,", "),")"))+(n?" repeatable":"")+" on "+Ar(s," | ")},SchemaExtension:{leave:({directives:r,operationTypes:e})=>Ar(["extend schema",Ar(r," "),Sc(e)]," ")},ScalarTypeExtension:{leave:({name:r,directives:e})=>Ar(["extend scalar",r,Ar(e," ")]," ")},ObjectTypeExtension:{leave:({name:r,interfaces:e,directives:i,fields:n})=>Ar(["extend type",r,Rn("implements ",Ar(e," & ")),Ar(i," "),Sc(n)]," ")},InterfaceTypeExtension:{leave:({name:r,interfaces:e,directives:i,fields:n})=>Ar(["extend interface",r,Rn("implements ",Ar(e," & ")),Ar(i," "),Sc(n)]," ")},UnionTypeExtension:{leave:({name:r,directives:e,types:i})=>Ar(["extend union",r,Ar(e," "),Rn("= ",Ar(i," | "))]," ")},EnumTypeExtension:{leave:({name:r,directives:e,values:i})=>Ar(["extend enum",r,Ar(e," "),Sc(i)]," ")},InputObjectTypeExtension:{leave:({name:r,directives:e,fields:i})=>Ar(["extend input",r,Ar(e," "),Sc(i)]," ")}};function Ar(r,e=""){var i;return(i=r==null?void 0:r.filter(n=>n).join(e))!==null&&i!==void 0?i:""}function Sc(r){return Rn(`{
`,hE(Ar(r,`
`)),`
}`)}function Rn(r,e,i=""){return e!=null&&e!==""?r+e+i:""}function hE(r){return Rn("  ",r.replace(/\n/g,`
  `))}function v9(r){var e;return(e=r==null?void 0:r.some(i=>i.includes(`
`)))!==null&&e!==void 0?e:!1}const x9="Accept",UI="Content-Type",zI="application/json",b9="application/graphql-response+json",_9=r=>r.replace(/([\s,]|#[^\n\r]+)+/g," ").trim(),dEe=r=>{const e=r.toLowerCase();return e.includes(b9)||e.includes(zI)},E9=r=>{try{if(Array.isArray(r))return{_tag:"Batch",executionResults:r.map(w9)};if(aE(r))return{_tag:"Single",executionResult:w9(r)};throw new Error(`Invalid execution result: result is not object or array. 
Got:
${String(r)}`)}catch(e){return e}},w9=r=>{if(typeof r!="object"||r===null)throw new Error("Invalid execution result: result is not object");let e,i,n;if("errors"in r){if(!aE(r.errors)&&!Array.isArray(r.errors))throw new Error("Invalid execution result: errors is not plain object OR array");e=r.errors}if("data"in r){if(!aE(r.data)&&r.data!==null)throw new Error("Invalid execution result: data is not plain object");i=r.data}if("extensions"in r){if(!aE(r.extensions))throw new Error("Invalid execution result: extensions is not plain object");n=r.extensions}return{data:i,errors:e,extensions:n}},pEe=r=>r._tag==="Batch"?r.executionResults.some(C9):C9(r.executionResult),C9=r=>Array.isArray(r.errors)?r.errors.length>0:!!r.errors,S9=r=>typeof r=="object"&&r!==null&&"kind"in r&&r.kind===kr.OPERATION_DEFINITION,fEe=r=>{var e;let i;const n=r.definitions.filter(S9);return n.length===1&&(i=(e=n[0].name)==null?void 0:e.value),i},mEe=r=>{let e=!1;const i=r.definitions.filter(S9);return i.length===1&&(e=i[0].operation===ef.MUTATION),e},jI=(r,e)=>{const i=typeof r=="string"?r:cEe(r);let n=!1,s;if(e)return{expression:i,isMutation:n,operationName:s};const o=v_e(()=>typeof r=="string"?eEe(r):r);return o instanceof Error?{expression:i,isMutation:n,operationName:s}:(s=fEe(o),n=mEe(o),{expression:i,operationName:s,isMutation:n})},VI=JSON,GI=async r=>{const e={...r,method:r.request._tag==="Single"?r.request.document.isMutation?"POST":i9(r.method??"post"):r.request.hasMutations?"POST":i9(r.method??"post"),fetchOptions:{...r.fetchOptions,errorPolicy:r.fetchOptions.errorPolicy??"none"}},i=await AEe(e.method)(e);if(!i.ok)return new Qg({status:i.status,headers:i.headers},{query:r.request._tag==="Single"?r.request.document.expression:r.request.query,variables:r.request.variables});const n=await gEe(i,r.fetchOptions.jsonSerializer??VI);if(n instanceof Error)throw n;const s={status:i.status,headers:i.headers};if(pEe(n)&&e.fetchOptions.errorPolicy==="none"){const o=n._tag==="Batch"?{...n.executionResults,...s}:{...n.executionResult,...s};return new Qg(o,{query:r.request._tag==="Single"?r.request.document.expression:r.request.query,variables:r.request.variables})}switch(n._tag){case"Single":return{...s,...T9(e)(n.executionResult)};case"Batch":return{...s,data:n.executionResults.map(T9(e))};default:NI(n)}},T9=r=>e=>({extensions:e.extensions,data:e.data,errors:r.fetchOptions.errorPolicy==="all"?e.errors:void 0}),gEe=async(r,e)=>{const i=r.headers.get(UI),n=await r.text();return i&&dEe(i)?E9(e.parse(n)):E9(n)},AEe=r=>async e=>{const i=new Headers(e.headers);let n=null,s;i.has(x9)||i.set(x9,[b9,zI].join(", ")),r==="POST"?(s=(e.fetchOptions.jsonSerializer??VI).stringify(yEe(e)),typeof s=="string"&&!i.has(UI)&&i.set(UI,zI)):n=vEe(e);const o={method:r,headers:i,body:s,...e.fetchOptions};let l=new URL(e.url),u=o;if(e.middleware){const c=await Promise.resolve(e.middleware({...o,url:e.url,operationName:e.request._tag==="Single"?e.request.document.operationName:void 0,variables:e.request.variables})),{url:h,...p}=c;l=new URL(h),u=p}return n&&n.forEach((c,h)=>{l.searchParams.append(h,c)}),await(e.fetch??fetch)(l,u)},yEe=r=>{switch(r.request._tag){case"Single":return{query:r.request.document.expression,variables:r.request.variables,operationName:r.request.document.operationName};case"Batch":return r9(r.request.query,r.request.variables??[]).map(([e,i])=>({query:e,variables:i}));default:throw NI(r.request)}},vEe=r=>{var e;const i=r.fetchOptions.jsonSerializer??VI,n=new URLSearchParams;switch(r.request._tag){case"Single":return n.append("query",_9(r.request.document.expression)),r.request.variables&&n.append("variables",i.stringify(r.request.variables)),r.request.document.operationName&&n.append("operationName",r.request.document.operationName),n;case"Batch":{const s=((e=r.request.variables)==null?void 0:e.map(u=>i.stringify(u)))??[],o=r.request.query.map(_9),l=r9(o,s).map(([u,c])=>({query:u,variables:c}));return n.append("query",i.stringify(l)),n}default:throw NI(r.request)}};class M9{constructor(e,i={}){H0(this,"url"),H0(this,"requestConfig"),H0(this,"rawRequest",async(...n)=>{const[s,o,l]=n,u=__e(s,o,l),{headers:c,fetch:h=globalThis.fetch,method:p="POST",requestMiddleware:f,responseMiddleware:m,excludeOperationName:g,...y}=this.requestConfig,{url:x}=this;u.signal!==void 0&&(y.signal=u.signal);const v=jI(u.query,g),_=await GI({url:x,request:{_tag:"Single",document:v,variables:u.variables},headers:{...qg(BI(c)),...qg(u.requestHeaders)},fetch:h,method:p,fetchOptions:y,middleware:f});if(m&&await m(_,{operationName:v.operationName,variables:o,url:this.url}),_ instanceof Error)throw _;return _}),this.url=e,this.requestConfig=i}async request(e,...i){const[n,s]=i,o=xEe(e,n,s),{headers:l,fetch:u=globalThis.fetch,method:c="POST",requestMiddleware:h,responseMiddleware:p,excludeOperationName:f,...m}=this.requestConfig,{url:g}=this;o.signal!==void 0&&(m.signal=o.signal);const y=jI(o.document,f),x=await GI({url:g,request:{_tag:"Single",document:y,variables:o.variables},headers:{...qg(BI(l)),...qg(o.requestHeaders)},fetch:u,method:c,fetchOptions:m,middleware:h});if(p&&await p(x,{operationName:y.operationName,variables:o.variables,url:this.url}),x instanceof Error)throw x;return x.data}async batchRequests(e,i){const n=b_e(e,i),{headers:s,excludeOperationName:o,...l}=this.requestConfig;n.signal!==void 0&&(l.signal=n.signal);const u=n.documents.map(({document:m})=>jI(m,o)),c=u.map(({expression:m})=>m),h=u.some(({isMutation:m})=>m),p=n.documents.map(({variables:m})=>m),f=await GI({url:this.url,request:{_tag:"Batch",operationName:void 0,query:c,hasMutations:h,variables:p},headers:{...qg(BI(s)),...qg(n.requestHeaders)},fetch:this.requestConfig.fetch??globalThis.fetch,method:this.requestConfig.method||"POST",fetchOptions:l,middleware:this.requestConfig.requestMiddleware});if(this.requestConfig.responseMiddleware&&await this.requestConfig.responseMiddleware(f,{operationName:void 0,variables:p,url:this.url}),f instanceof Error)throw f;return f.data}setHeaders(e){return this.requestConfig.headers=e,this}setHeader(e,i){const{headers:n}=this.requestConfig;return n?n[e]=i:this.requestConfig.headers={[e]:i},this}setEndpoint(e){return this.url=e,this}}const xEe=(r,e,i)=>r.document?r:{document:r,variables:e,requestHeaders:i,signal:void 0},Id=(r,...e)=>r.reduce((i,n,s)=>`${i}${n}${s in e?String(e[s]):""}`,""),R9={base:{url:" https://prod.base.intuition-api.com/v1/graphql",displayName:"Base Mainnet"}},rv=r=>new M9(R9[r].url),bEe=async(r,e="baseSepolia")=>{const i=rv(e);let n;n=Id`
    query GetAtom($atomId: numeric!) {
      atom(id: $atomId) {
        id
        image
        label
        emoji
        type
        creator_id
        vault {
          total_shares
        }
      }
    }
  `;const s={atomId:r};try{return(await i.request(n,s)).atom}catch(o){throw console.error("Error fetching atom details:",o),o}},_Ee=async(r="baseSepolia")=>{const e=rv(r);let i,n;return i=Id`
    query {
      triples(limit: 1000) {
        id
        subject {
          label
          id
          creator_id
          type
        }
        predicate {
          label
          id
          creator_id
          type
        }
        object {
          label
          id
          creator_id
          type
        }
      }
    }
  `,n=await e.request(i),{items:n.triples}.items},EEe=async(r,e="baseSepolia")=>{const i=rv(e);let n,s,o;return n=Id`
    query Triples($where: triples_bool_exp) {
      triples(where: $where) {
        id
        subject {
          label
          id
          creator_id
          type
        }
        predicate {
          label
          id
          creator_id
          type
        }
        object {
          label
          id
          creator_id
          type
        }
      }
    }
  `,o={where:{_or:[{predicate_id:{_eq:r}},{subject_id:{_eq:r}},{object_id:{_eq:r}}]}},s=await i.request(n,o),s.triples},wEe=async(r,e="baseSepolia")=>{const i=rv(e),n=Id`
    query SearchTriples($where: triples_bool_exp) {
      triples(where: $where) {
        id
        subject {
          label
          id
          creator_id
          type
        }
        predicate {
          label
          id
          creator_id
          type
        }
        object {
          label
          id
          creator_id
          type
        }
      }
    }
  `,s={_and:[]};r.subject&&s._and.push({subject:{label:{_ilike:`%${r.subject}%`}}}),r.predicate&&s._and.push({predicate:{label:{_ilike:`%${r.predicate}%`}}}),r.object&&s._and.push({object:{label:{_ilike:`%${r.object}%`}}});const o={where:s._and.length>0?s:{}};console.log("Executing search query with variables:",o);try{const l=await i.request(n,o);return console.log("Search query response:",l),l.triples}catch(l){throw console.error("Error executing search query:",l),l}},I9=Object.freeze(Object.defineProperty({__proto__:null,ENDPOINTS:R9,createClient:rv,fetchAtomDetails:bEe,fetchTriples:_Ee,fetchTriplesForNode:EEe,searchTriples:wEe},Symbol.toStringTag,{value:"Module"})),B9={baseSepolia:{url:" https://dev.base.intuition-api.com/v1/graphql",displayName:"Base Testnet"}},nv=r=>new M9(B9[r].url),CEe=async(r,e="baseSepolia")=>{const i=nv(e);let n;n=Id`
    query GetAtom($atomId: numeric!) {
      atom(id: $atomId) {
        id
        image
        label
        emoji
        type
        creator_id
        vault {
          total_shares
        }
      }
    }
  `;const s={atomId:r};try{return(await i.request(n,s)).atom}catch(o){throw console.error("Error fetching atom details:",o),o}},SEe=async(r="baseSepolia")=>{const e=nv(r);let i,n;return i=Id`
    query {
      triples(limit: 1000) {
        id
        subject {
          label
          id
          creator_id
          type
        }
        predicate {
          label
          id
          creator_id
          type
        }
        object {
          label
          id
          creator_id
          type
        }
      }
    }
  `,n=await e.request(i),{items:n.triples}.items},TEe=async(r,e="baseSepolia")=>{const i=nv(e);let n,s,o;return n=Id`
    query Triples($where: triples_bool_exp) {
      triples(where: $where) {
        id
        subject {
          label
          id
          creator_id
          type
        }
        predicate {
          label
          id
          creator_id
          type
        }
        object {
          label
          id
          creator_id
          type
        }
      }
    }
  `,o={where:{_or:[{predicate_id:{_eq:r}},{subject_id:{_eq:r}},{object_id:{_eq:r}}]}},s=await i.request(n,o),s.triples},MEe=async(r,e="baseSepolia")=>{const i=nv(e),n=Id`
    query SearchTriples($where: triples_bool_exp) {
      triples(where: $where) {
        id
        subject {
          label
          id
          creator_id
          type
        }
        predicate {
          label
          id
          creator_id
          type
        }
        object {
          label
          id
          creator_id
          type
        }
      }
    }
  `,s={_and:[]};r.subject&&s._and.push({subject:{label:{_ilike:`%${r.subject}%`}}}),r.predicate&&s._and.push({predicate:{label:{_ilike:`%${r.predicate}%`}}}),r.object&&s._and.push({object:{label:{_ilike:`%${r.object}%`}}});const o={where:s._and.length>0?s:{}};console.log("Executing search query with variables:",o);try{const l=await i.request(n,o);return console.log("Search query response:",l),l.triples}catch(l){throw console.error("Error executing search query:",l),l}},REe=Object.freeze(Object.defineProperty({__proto__:null,ENDPOINTS:B9,createClient:nv,fetchAtomDetails:CEe,fetchTriples:SEe,fetchTriplesForNode:TEe,searchTriples:MEe},Symbol.toStringTag,{value:"Module"})),sv={railsMockApi:{url:"https://api-i7n.thp-lab.org/api/v1/graph",displayName:"[OffChain] Playground API",module:I9},baseSepolia:{url:"https://api.i7n.dev/v1/graphql",displayName:"Base Testnet",module:REe},base:{url:"https://prod.base.intuition-api.com/v1/graphql",displayName:"Base Mainnet",module:I9}},dE=r=>{if(!sv[r]||!sv[r].module)throw new Error(`No module defined for endpoint '${r}'.`);return sv[r].module},N9=async(r="base")=>{const e=dE(r);try{return e.fetchTriples(r)}catch(i){throw console.error(`Error fetching triples for endpoint ${r}:`,i),i}},IEe=async(r,e="base")=>{const i=dE(e);try{return i.fetchTriplesForNode(r,e)}catch(n){throw console.error(`Error fetching triples for node ${r} with endpoint ${e}:`,n),n}},BEe=async(r,e="base")=>{const i=dE(e);try{return i.fetchAtomDetails(r,e)}catch(n){throw console.error(`Error fetching atom details for ${r} with endpoint ${e}:`,n),n}},NEe=async(r,e="base")=>{const i=dE(e);try{return i.searchTriples(r,e)}catch(n){throw console.error(`Error searching triples with endpoint ${e}:`,n),n}},rf={SUBJECT:"#4361EE",PREDICATE:"#FF7300",OBJECT:"#9D4EDD",CREATOR:"#00FF00"},HI=r=>{switch(r){case"subject":return rf.SUBJECT;case"predicate":return rf.PREDICATE;case"object":return rf.OBJECT;case"creator":return rf.CREATOR;default:return rf.DEFAULT}},WI=r=>{const e=[],i=[],n=new Map;return r.forEach(({subject:s,predicate:o,object:l})=>{if(!n.has(s.id)){const u={id:s.id,label:s.label,isTriple:!1,color:HI("subject"),role:"subject"};n.set(s.id,u),e.push(u)}if(!n.has(o.id)){const u={id:o.id,label:o.label,isTriple:!1,color:HI("predicate"),role:"predicate"};n.set(o.id,u),e.push(u)}if(!n.has(l.id)){const u={id:l.id,label:l.label,isTriple:!1,color:HI("object"),role:"object"};n.set(l.id,u),e.push(u)}i.push({source:s.id,target:o.id,type:"subject-to-predicate"}),i.push({source:o.id,target:l.id,type:"predicate-to-object"})}),{nodes:e,links:i}},LEe=({showCreators:r=!1})=>{const e=Object.entries(rf).filter(([i])=>i!=="CREATOR"||r).map(([i,n])=>({role:i.toLowerCase(),color:n}));return rr.jsxs("div",{style:{position:"absolute",bottom:"20px",right:"10px",zIndex:10,background:"#222",color:"#fff",padding:"10px",borderRadius:"4px",boxShadow:"0px 4px 6px rgba(0, 0, 0, 0.2)",fontSize:"14px"},children:[rr.jsx("h4",{style:{margin:"0 0 10px 0",fontSize:"16px"},children:"Graph Legend"}),rr.jsx("ul",{style:{listStyle:"none",padding:0,margin:0},children:e.map(({role:i,color:n})=>rr.jsxs("li",{style:{display:"flex",alignItems:"center",marginBottom:"5px"},children:[rr.jsx("span",{style:{width:"15px",height:"15px",backgroundColor:n,borderRadius:"50%",display:"inline-block",marginRight:"10px"}}),i.charAt(0).toUpperCase()+i.slice(1)]},i))})]})},DEe=({graphData:r,onNodeClick:e})=>{const i=gi.useRef();return gi.useEffect(()=>{if(i.current){const n=lU()(i.current);n.graphData(r),n.nodeLabel(s=>s.label||s.id).nodeAutoColorBy("group"),e&&n.onNodeClick(e)}},[r,e]),rr.jsx("div",{ref:i,style:{width:"100vw",height:"100vh",overflow:"hidden"}})},OEe=({triple:r,endpoint:e,onClose:i})=>{var n,s;const[o,l]=gi.useState(null),[u,c]=gi.useState(null),[h,p]=gi.useState(!1),[f,m]=gi.useState(null);gi.useEffect(()=>{r&&(p(!0),m(null),c(null),(async()=>{try{console.log("Received triple:",r);const y=(await N9(e)).filter(x=>{var v,_,T;return x.id===r.id||((v=x.subject)==null?void 0:v.id)===r.id||((_=x.predicate)==null?void 0:_.id)===r.id||((T=x.object)==null?void 0:T.id)===r.id});if(l(y),r.id){console.log("Fetching atom details for ID:",r.id);const x=await BEe(parseInt(r.id),e);console.log("Received atom details:",x),c(x)}}catch(y){console.error("Error fetching sidebar data:",y),m("Failed to fetch data")}finally{p(!1)}})())},[r,e]);const g=y=>`${(y/1e18).toFixed(4)} ETH`;return r?(console.log("Rendering sidebar with triple:",r),rr.jsxs("div",{className:"node-details-sidebar",children:[rr.jsxs("h2",{children:[r.label||"No Label"," Details"]}),h&&rr.jsx("p",{children:"Loading..."}),f&&rr.jsx("p",{children:f}),u&&rr.jsxs(rr.Fragment,{children:[rr.jsx("h4",{children:"Atom Info"}),rr.jsxs("p",{children:[rr.jsx("strong",{children:"ID:"})," ",u.id]}),rr.jsxs("p",{children:[rr.jsx("strong",{children:"Label:"})," ",u.label]}),rr.jsxs("p",{children:[rr.jsx("strong",{children:"Type:"})," ",u.type]}),rr.jsxs("p",{children:[rr.jsx("strong",{children:"Emoji:"})," ",u.emoji||"N/A"]}),rr.jsxs("p",{children:[rr.jsx("strong",{children:"Creator:"})," ",((n=u.creator)==null?void 0:n.label)||"Unknown"]}),rr.jsxs("p",{children:[rr.jsx("strong",{children:"Vault Shares:"})," ",g(((s=u.vault)==null?void 0:s.total_shares)||0)]})]}),o&&o.length>0?rr.jsxs("div",{className:"related-triples",children:[rr.jsx("h4",{children:"Related Data:"}),rr.jsx("ul",{children:o.map(y=>{var x,v,_;return rr.jsxs("li",{children:[rr.jsx("strong",{children:"Subject:"})," ",(x=y.subject)==null?void 0:x.label," |"," ",rr.jsx("strong",{children:"Predicate:"})," ",(v=y.predicate)==null?void 0:v.label," |"," ",rr.jsx("strong",{children:"Object:"})," ",(_=y.object)==null?void 0:_.label]},y.id)})})]}):!h&&rr.jsx("p",{children:"No additional related data found."}),rr.jsx("button",{onClick:i,children:"Close"})]})):(console.log("No triple provided to sidebar"),null)},L9=()=>{const[r,e]=gi.useState([]),i=200;gi.useEffect(()=>{let s;const o=()=>{const l=Date.now()/1e3,u=[];for(let c=0;c<3;c++){const h=l*.8+c*2*Math.PI/3;u.push({x:Math.cos(h)*150+200,y:Math.sin(h)*150+200,color:"#00fff2"})}for(let c=0;c<3;c++){const h=-l*1.2+c*2*Math.PI/3;u.push({x:Math.cos(h)*100+200,y:Math.sin(h)*100+200,color:"#ff00ff"})}for(let c=0;c<3;c++){const h=l*1.5+c*2*Math.PI/3;u.push({x:Math.cos(h)*50+200,y:Math.sin(h)*50+200,color:"#ffff00"})}e(u),s=requestAnimationFrame(o)};return o(),()=>cancelAnimationFrame(s)},[]);const n=r.flatMap((s,o)=>r.slice(o+1).map((l,u)=>{const c=l.x-s.x,h=l.y-s.y,p=Math.sqrt(c*c+h*h);if(p<i){const f=1-p/i;return{x1:s.x,y1:s.y,x2:l.x,y2:l.y,opacity:f*.8,gradient:`link-gradient-${o}-${u}`,color1:s.color,color2:l.color}}return null}).filter(Boolean));return rr.jsxs("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",background:"rgba(0, 0, 0, 0.9)",zIndex:1e3,overflow:"hidden"},children:[rr.jsxs("div",{style:{position:"relative",width:"400px",height:"400px",display:"flex",flexDirection:"column",alignItems:"center"},children:[rr.jsxs("svg",{width:"400",height:"400",children:[rr.jsx("defs",{children:n.map(s=>rr.jsxs("linearGradient",{id:s.gradient,x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[rr.jsx("stop",{offset:"0%",stopColor:s.color1,stopOpacity:s.opacity}),rr.jsx("stop",{offset:"100%",stopColor:s.color2,stopOpacity:s.opacity})]},s.gradient))}),n.map((s,o)=>rr.jsx("line",{x1:s.x1,y1:s.y1,x2:s.x2,y2:s.y2,stroke:`url(#${s.gradient})`,strokeWidth:"3",style:{filter:"brightness(1.5) blur(1px)"}},o))]}),rr.jsx("div",{style:{color:"#00fff2",fontSize:"40px",fontFamily:"sans-serif",letterSpacing:"-2px",textShadow:`
            0 0 5px #00fff2,
            0 0 10px #00fff2,
            0 0 20px #00fff2,
            0 0 40px #00fff2
          `,animation:"textPulse 1.5s ease-in-out infinite",whiteSpace:"nowrap",marginTop:"20px"},children:"Connecting I7n Dots..."})]}),rr.jsx("style",{children:`
          @keyframes textPulse {
            0% { 
              opacity: 0.5;
              transform: scale(0.98) translateY(0);
            }
            50% { 
              opacity: 1;
              transform: scale(1.02) translateY(-5px);
            }
            100% { 
              opacity: 0.5;
              transform: scale(0.98) translateY(0);
            }
          }
        `})]})},PEe=({endpoint:r})=>{const[e,i]=gi.useState({nodes:[],links:[]}),[n,s]=gi.useState(null),[o,l]=gi.useState(!0),[u,c]=gi.useState("2D"),[h,p]=gi.useState(null),[f,m]=gi.useState(!1),[g,y]=gi.useState(!1),x=gi.useRef(),[v,_]=gi.useState([]),[T,w]=gi.useState(0),S=gi.useRef(null),[R,B]=gi.useState(""),[I,D]=gi.useState(""),[L,O]=gi.useState(""),[U,Z]=gi.useState(!1),[G,z]=gi.useState(!1),$=gi.useCallback((fe,de)=>{const Ie=[],Ge=[];return de.forEach(Xe=>{[Xe.subject,Xe.predicate,Xe.object].forEach($e=>{$e.creator_id&&(Ie.find(lt=>lt.id===`creator-${$e.creator_id}`)||Ie.push({id:`creator-${$e.creator_id}`,label:`${$e.creator_id}`,type:"creator",color:rf.CREATOR}),Ge.push({source:`creator-${$e.creator_id}`,target:$e.id,label:"created"}))})}),{nodes:[...fe.nodes,...Ie],links:[...fe.links,...Ge]}},[]);gi.useEffect(()=>{(async()=>{y(!0);try{const fe=await N9(r);let de=WI(fe);f&&(de=$(de,fe)),i(de),s(de)}catch(fe){console.error("Error loading graph data:",fe)}finally{y(!1)}})()},[f,r,$]);const Q=gi.useCallback(()=>{i(n),p(null),B(""),D(""),O(""),z(!1)},[n]),H=gi.useCallback(async fe=>{if(console.log("Node clicked:",fe),p(fe),x.current)try{const de={x:fe.x,y:fe.y,z:fe.z||0},Ie=await IEe(fe.id,r),Ge=WI(Ie),Xe=Ge.nodes.find($e=>$e.id===fe.id);Xe&&(Xe.x=de.x,Xe.y=de.y,u==="3D"&&(Xe.z=de.z),Xe.fx=de.x,Xe.fy=de.y,u==="3D"&&(Xe.fz=de.z)),_($e=>{const lt=$e.slice(0,T+1);return lt.push({graphData:e,selectedTriple:fe}),lt}),w($e=>$e+1),i(Ge)}catch(de){console.error("Error fetching triples:",de)}},[u,e,T,r]),V=gi.useCallback(()=>{o&&x.current&&l(!1)},[o]),ne=gi.useCallback(()=>{if(T>0){const{graphData:fe,selectedTriple:de}=v[T-1];i(fe),p(de),w(Ie=>Ie-1)}},[T,v]),Y=gi.useCallback(()=>{if(T<v.length-1){const{graphData:fe,selectedTriple:de}=v[T+1];i(fe),p(de),w(Ie=>Ie+1)}},[T,v]),ae=gi.useCallback(async()=>{if(G){if(console.log("Applying filters:",{subjectFilter:R,predicateFilter:I,objectFilter:L}),!R&&!I&&!L){Q();return}Z(!0);try{const fe={subject:R,predicate:I,object:L};console.log("Sending search request with filters:",fe);const de=await NEe(fe,r);if(console.log("Search results:",de),!de||de.length===0){console.log("No results found"),i({nodes:[],links:[]});return}const Ie=WI(de);if(console.log("Transformed graph data:",Ie),f){const Ge=$(Ie,de);console.log("Enhanced graph data with creators:",Ge),i(Ge)}else i(Ie);_(Ge=>{const Xe=Ge.slice(0,T+1);return Xe.push({graphData:Ie,selectedTriple:null}),Xe}),w(Ge=>Ge+1)}catch(fe){console.error("Error searching triples:",fe)}finally{Z(!1),z(!1)}}},[R,I,L,r,f,$,Q,T,G]),xe=gi.useCallback((fe,de)=>{switch(console.log(`Search input changed - type: ${fe}, value: ${de}`),S.current&&clearTimeout(S.current),fe){case"subject":B(de);break;case"predicate":D(de);break;case"object":O(de);break}S.current=setTimeout(()=>{z(!0)},500)},[]);return gi.useEffect(()=>{G&&ae()},[G,ae]),rr.jsxs("div",{children:[(g||U)&&rr.jsx(L9,{}),rr.jsx("button",{className:"navigation-button",onClick:Q,style:{position:"absolute",top:"75px",left:"10px",zIndex:50,width:"143px"},children:"Return to initial graph"}),rr.jsx("button",{className:"navigation-button",onClick:ne,style:{position:"absolute",top:"110px",left:"10px",width:"70px",zIndex:50},disabled:T<=0,children:"Previous"}),rr.jsx("button",{className:"navigation-button",onClick:Y,style:{position:"absolute",top:"110px",left:"83px",width:"70px",zIndex:50},disabled:T>=v.length-1,children:"Next"}),rr.jsxs("div",{style:{position:"absolute",top:"10px",right:"10px",zIndex:10,display:"flex",alignItems:"center",gap:"10px",background:"#444",color:"black",padding:"10px",borderRadius:"4px"},children:[rr.jsx("label",{htmlFor:"viewMode",style:{fontSize:"14px"},children:"View Mode:"}),rr.jsxs("select",{id:"viewMode",value:u,onChange:fe=>c(fe.target.value),style:{padding:"5px",borderRadius:"4px",border:"none",cursor:"pointer",fontSize:"14px"},children:[rr.jsx("option",{value:"2D",children:"2D"}),rr.jsx("option",{value:"3D",children:"3D"}),rr.jsx("option",{value:"VR",children:"VR"})]}),rr.jsxs("label",{style:{fontSize:"14px",marginLeft:"10px"},children:["Show Creators",rr.jsx("input",{type:"checkbox",checked:f,onChange:fe=>m(fe.target.checked),style:{marginLeft:"8px"}})]}),rr.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[rr.jsx("input",{type:"text",value:R,onChange:fe=>xe("subject",fe.target.value),placeholder:"Subject",style:{padding:"5px",borderRadius:"4px",border:"1px solid #ccc",fontSize:"14px",width:"100px"}}),rr.jsx("input",{type:"text",value:I,onChange:fe=>xe("predicate",fe.target.value),placeholder:"Predicate",style:{padding:"5px",borderRadius:"4px",border:"1px solid #ccc",fontSize:"14px",width:"100px"}}),rr.jsx("input",{type:"text",value:L,onChange:fe=>xe("object",fe.target.value),placeholder:"Object",style:{padding:"5px",borderRadius:"4px",border:"1px solid #ccc",fontSize:"14px",width:"100px"}})]})]}),u==="2D"&&rr.jsx(MI,{ref:fe=>x.current=fe,graphData:e,nodeCanvasObject:(fe,de,Ie)=>{const Ge=fe.label||"",Xe=12/Ie;de.font=`${Xe}px Sans-Serif`;const $e=de.measureText(Ge).width,lt=10/Ie,At=5/Ie;de.fillStyle=fe.color+"CC";const Gt=fe.x-$e/2-lt,gt=fe.y-Xe/2-lt,xi=$e+lt*2,Ze=Xe+lt*2,Ui=[xi,Ze];de.beginPath(),de.arc(Gt+At,gt+At,At,Math.PI,1.5*Math.PI),de.arc(Gt+xi-At,gt+At,At,1.5*Math.PI,2*Math.PI),de.arc(Gt+xi-At,gt+Ze-At,At,0,.5*Math.PI),de.arc(Gt+At,gt+Ze-At,At,.5*Math.PI,Math.PI),de.closePath(),de.fill(),de.fillStyle="#fff",de.textAlign="center",de.textBaseline="middle",de.fillText(Ge,fe.x,fe.y),fe.__bckgDimensions=Ui},nodePointerAreaPaint:(fe,de,Ie)=>{Ie.fillStyle=de;const Ge=fe.__bckgDimensions;Ge&&Ie.fillRect(fe.x-Ge[0]/2,fe.y-Ge[1]/2,...Ge)},linkColor:()=>"#666",linkDirectionalParticles:1,linkDirectionalParticleSpeed:.02,linkDirectionalParticleColor:()=>"#fff",nodeAutoColorBy:"type",onNodeClick:H,onEngineStop:V}),u==="3D"&&rr.jsx(TI,{ref:fe=>x.current=fe,graphData:e,controlType:"fly",nodeLabel:"label",onNodeClick:H,linkColor:()=>"#666",linkDirectionalParticles:2,linkDirectionalParticleSpeed:.005,nodeAutoColorBy:"type",nodeThreeObject:fe=>{const de=new A_e(fe.label||"");return de.borderRadius=1,de.backgroundColor=fe.color+"CC",de.padding=1,de.color="#fff",de.textHeight=2,de},onEngineStop:V}),u==="VR"&&rr.jsx(DEe,{graphData:e,onNodeClick:H,onBack:ne,onForward:Y,selectedTriple:h}),rr.jsx(LEe,{showCreators:f}),h&&rr.jsx(OEe,{triple:h,endpoint:r,onClose:()=>p(null)})]})},kEe=({currentEndpoint:r,onEndpointChange:e})=>rr.jsxs("div",{style:{position:"absolute",top:"10px",left:"10px",zIndex:10,display:"flex",alignItems:"center",gap:"10px",background:"#444",color:"black",padding:"10px",borderRadius:"4px",width:"270px",height:"25px"},children:[rr.jsx("label",{htmlFor:"endpoint",style:{fontSize:"14px"},children:"Endpoint:"}),rr.jsx("select",{id:"endpoint",value:r,onChange:i=>e(i.target.value),style:{padding:"5px",borderRadius:"4px",border:"none",cursor:"pointer",fontSize:"14px",flex:1},children:Object.entries(sv).map(([i,n])=>rr.jsx("option",{value:i,children:n.displayName},i))})]}),FEe=()=>{const[r,e]=gi.useState(null),[i,n]=gi.useState("base"),[s,o]=gi.useState(!1);return Bt.jsx("div",{style:{display:"flex",minHeight:"100vh",backgroundColor:"#101020"},children:Bt.jsxs("div",{style:{flex:1,position:"relative"},children:[Bt.jsx("div",{style:{position:"absolute",top:20,left:20,zIndex:1},children:Bt.jsx(kEe,{endpoints:sv,selectedEndpoint:i,onEndpointChange:n})}),Bt.jsx(PEe,{endpoint:i,onNodeSelect:e,onLoadingChange:o}),s&&Bt.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:2},children:Bt.jsx(L9,{})})]})})};class Yg extends Error{constructor(i,n){const s=`${Yg.extractMessage(i)}: ${JSON.stringify({response:i,request:n})}`;super(s);N0(this,"response");N0(this,"request");Object.setPrototypeOf(this,Yg.prototype),this.response=i,this.request=n,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Yg)}static extractMessage(i){var n,s;return((s=(n=i.errors)==null?void 0:n[0])==null?void 0:s.message)??`GraphQL Error (Code: ${String(i.status)})`}}const D9=r=>r.toUpperCase(),QI=r=>typeof r=="function"?r():r,O9=(r,e)=>r.map((i,n)=>[i,e[n]]),Kg=r=>{let e={};return r instanceof Headers?e=UEe(r):Array.isArray(r)?r.forEach(([i,n])=>{i&&n!==void 0&&(e[i]=n)}):r&&(e=r),e},UEe=r=>{const e={};return r.forEach((i,n)=>{e[n]=i}),e},zEe=r=>{try{const e=r();return jEe(e)?e.catch(i=>P9(i)):e}catch(e){return P9(e)}},P9=r=>r instanceof Error?r:new Error(String(r)),jEe=r=>typeof r=="object"&&r!==null&&"then"in r&&typeof r.then=="function"&&"catch"in r&&typeof r.catch=="function"&&"finally"in r&&typeof r.finally=="function",qI=r=>{throw new Error(`Unhandled case: ${String(r)}`)},pE=r=>typeof r=="object"&&r!==null&&!Array.isArray(r),VEe=(r,e)=>r.documents?r:{documents:r,requestHeaders:e,signal:void 0},GEe=(r,e,i)=>r.query?r:{query:r,variables:e,requestHeaders:i,signal:void 0};function fE(r,e){if(!!!r)throw new Error(e)}function HEe(r){return typeof r=="object"&&r!==null}function WEe(r,e){if(!!!r)throw new Error("Unexpected invariant triggered.")}const QEe=/\r\n|[\n\r]/g;function XI(r,e){let i=0,n=1;for(const s of r.body.matchAll(QEe)){if(typeof s.index=="number"||WEe(!1),s.index>=e)break;i=s.index+s[0].length,n+=1}return{line:n,column:e+1-i}}function qEe(r){return k9(r.source,XI(r.source,r.start))}function k9(r,e){const i=r.locationOffset.column-1,n="".padStart(i)+r.body,s=e.line-1,o=r.locationOffset.line-1,l=e.line+o,u=e.line===1?i:0,c=e.column+u,h=`${r.name}:${l}:${c}
`,p=n.split(/\r\n|[\n\r]/g),f=p[s];if(f.length>120){const m=Math.floor(c/80),g=c%80,y=[];for(let x=0;x<f.length;x+=80)y.push(f.slice(x,x+80));return h+F9([[`${l} |`,y[0]],...y.slice(1,m+1).map(x=>["|",x]),["|","^".padStart(g)],["|",y[m+1]]])}return h+F9([[`${l-1} |`,p[s-1]],[`${l} |`,f],["|","^".padStart(c)],[`${l+1} |`,p[s+1]]])}function F9(r){const e=r.filter(([n,s])=>s!==void 0),i=Math.max(...e.map(([n])=>n.length));return e.map(([n,s])=>n.padStart(i)+(s?" "+s:"")).join(`
`)}function XEe(r){const e=r[0];return e==null||"kind"in e||"length"in e?{nodes:e,source:r[1],positions:r[2],path:r[3],originalError:r[4],extensions:r[5]}:e}class YI extends Error{constructor(e,...i){var n,s,o;const{nodes:l,source:u,positions:c,path:h,originalError:p,extensions:f}=XEe(i);super(e),this.name="GraphQLError",this.path=h??void 0,this.originalError=p??void 0,this.nodes=U9(Array.isArray(l)?l:l?[l]:void 0);const m=U9((n=this.nodes)===null||n===void 0?void 0:n.map(y=>y.loc).filter(y=>y!=null));this.source=u??(m==null||(s=m[0])===null||s===void 0?void 0:s.source),this.positions=c??(m==null?void 0:m.map(y=>y.start)),this.locations=c&&u?c.map(y=>XI(u,y)):m==null?void 0:m.map(y=>XI(y.source,y.start));const g=HEe(p==null?void 0:p.extensions)?p==null?void 0:p.extensions:void 0;this.extensions=(o=f??g)!==null&&o!==void 0?o:Object.create(null),Object.defineProperties(this,{message:{writable:!0,enumerable:!0},name:{enumerable:!1},nodes:{enumerable:!1},source:{enumerable:!1},positions:{enumerable:!1},originalError:{enumerable:!1}}),p!=null&&p.stack?Object.defineProperty(this,"stack",{value:p.stack,writable:!0,configurable:!0}):Error.captureStackTrace?Error.captureStackTrace(this,YI):Object.defineProperty(this,"stack",{value:Error().stack,writable:!0,configurable:!0})}get[Symbol.toStringTag](){return"GraphQLError"}toString(){let e=this.message;if(this.nodes)for(const i of this.nodes)i.loc&&(e+=`

`+qEe(i.loc));else if(this.source&&this.locations)for(const i of this.locations)e+=`

`+k9(this.source,i);return e}toJSON(){const e={message:this.message};return this.locations!=null&&(e.locations=this.locations),this.path!=null&&(e.path=this.path),this.extensions!=null&&Object.keys(this.extensions).length>0&&(e.extensions=this.extensions),e}}function U9(r){return r===void 0||r.length===0?void 0:r}function Na(r,e,i){return new YI(`Syntax Error: ${i}`,{source:r,positions:[e]})}class YEe{constructor(e,i,n){this.start=e.start,this.end=i.end,this.startToken=e,this.endToken=i,this.source=n}get[Symbol.toStringTag](){return"Location"}toJSON(){return{start:this.start,end:this.end}}}class z9{constructor(e,i,n,s,o,l){this.kind=e,this.start=i,this.end=n,this.line=s,this.column=o,this.value=l,this.prev=null,this.next=null}get[Symbol.toStringTag](){return"Token"}toJSON(){return{kind:this.kind,value:this.value,line:this.line,column:this.column}}}const j9={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]},KEe=new Set(Object.keys(j9));function V9(r){const e=r==null?void 0:r.kind;return typeof e=="string"&&KEe.has(e)}var nf;(function(r){r.QUERY="query",r.MUTATION="mutation",r.SUBSCRIPTION="subscription"})(nf||(nf={}));var KI;(function(r){r.QUERY="QUERY",r.MUTATION="MUTATION",r.SUBSCRIPTION="SUBSCRIPTION",r.FIELD="FIELD",r.FRAGMENT_DEFINITION="FRAGMENT_DEFINITION",r.FRAGMENT_SPREAD="FRAGMENT_SPREAD",r.INLINE_FRAGMENT="INLINE_FRAGMENT",r.VARIABLE_DEFINITION="VARIABLE_DEFINITION",r.SCHEMA="SCHEMA",r.SCALAR="SCALAR",r.OBJECT="OBJECT",r.FIELD_DEFINITION="FIELD_DEFINITION",r.ARGUMENT_DEFINITION="ARGUMENT_DEFINITION",r.INTERFACE="INTERFACE",r.UNION="UNION",r.ENUM="ENUM",r.ENUM_VALUE="ENUM_VALUE",r.INPUT_OBJECT="INPUT_OBJECT",r.INPUT_FIELD_DEFINITION="INPUT_FIELD_DEFINITION"})(KI||(KI={}));var Fr;(function(r){r.NAME="Name",r.DOCUMENT="Document",r.OPERATION_DEFINITION="OperationDefinition",r.VARIABLE_DEFINITION="VariableDefinition",r.SELECTION_SET="SelectionSet",r.FIELD="Field",r.ARGUMENT="Argument",r.FRAGMENT_SPREAD="FragmentSpread",r.INLINE_FRAGMENT="InlineFragment",r.FRAGMENT_DEFINITION="FragmentDefinition",r.VARIABLE="Variable",r.INT="IntValue",r.FLOAT="FloatValue",r.STRING="StringValue",r.BOOLEAN="BooleanValue",r.NULL="NullValue",r.ENUM="EnumValue",r.LIST="ListValue",r.OBJECT="ObjectValue",r.OBJECT_FIELD="ObjectField",r.DIRECTIVE="Directive",r.NAMED_TYPE="NamedType",r.LIST_TYPE="ListType",r.NON_NULL_TYPE="NonNullType",r.SCHEMA_DEFINITION="SchemaDefinition",r.OPERATION_TYPE_DEFINITION="OperationTypeDefinition",r.SCALAR_TYPE_DEFINITION="ScalarTypeDefinition",r.OBJECT_TYPE_DEFINITION="ObjectTypeDefinition",r.FIELD_DEFINITION="FieldDefinition",r.INPUT_VALUE_DEFINITION="InputValueDefinition",r.INTERFACE_TYPE_DEFINITION="InterfaceTypeDefinition",r.UNION_TYPE_DEFINITION="UnionTypeDefinition",r.ENUM_TYPE_DEFINITION="EnumTypeDefinition",r.ENUM_VALUE_DEFINITION="EnumValueDefinition",r.INPUT_OBJECT_TYPE_DEFINITION="InputObjectTypeDefinition",r.DIRECTIVE_DEFINITION="DirectiveDefinition",r.SCHEMA_EXTENSION="SchemaExtension",r.SCALAR_TYPE_EXTENSION="ScalarTypeExtension",r.OBJECT_TYPE_EXTENSION="ObjectTypeExtension",r.INTERFACE_TYPE_EXTENSION="InterfaceTypeExtension",r.UNION_TYPE_EXTENSION="UnionTypeExtension",r.ENUM_TYPE_EXTENSION="EnumTypeExtension",r.INPUT_OBJECT_TYPE_EXTENSION="InputObjectTypeExtension"})(Fr||(Fr={}));function JI(r){return r===9||r===32}function av(r){return r>=48&&r<=57}function G9(r){return r>=97&&r<=122||r>=65&&r<=90}function H9(r){return G9(r)||r===95}function JEe(r){return G9(r)||av(r)||r===95}function ZEe(r){var e;let i=Number.MAX_SAFE_INTEGER,n=null,s=-1;for(let l=0;l<r.length;++l){var o;const u=r[l],c=$Ee(u);c!==u.length&&(n=(o=n)!==null&&o!==void 0?o:l,s=l,l!==0&&c<i&&(i=c))}return r.map((l,u)=>u===0?l:l.slice(i)).slice((e=n)!==null&&e!==void 0?e:0,s+1)}function $Ee(r){let e=0;for(;e<r.length&&JI(r.charCodeAt(e));)++e;return e}function ewe(r,e){const i=r.replace(/"""/g,'\\"""'),n=i.split(/\r\n|[\n\r]/g),s=n.length===1,o=n.length>1&&n.slice(1).every(g=>g.length===0||JI(g.charCodeAt(0))),l=i.endsWith('\\"""'),u=r.endsWith('"')&&!l,c=r.endsWith("\\"),h=u||c,p=!s||r.length>70||h||o||l;let f="";const m=s&&JI(r.charCodeAt(0));return(p&&!m||o)&&(f+=`
`),f+=i,(p||h)&&(f+=`
`),'"""'+f+'"""'}var ni;(function(r){r.SOF="<SOF>",r.EOF="<EOF>",r.BANG="!",r.DOLLAR="$",r.AMP="&",r.PAREN_L="(",r.PAREN_R=")",r.SPREAD="...",r.COLON=":",r.EQUALS="=",r.AT="@",r.BRACKET_L="[",r.BRACKET_R="]",r.BRACE_L="{",r.PIPE="|",r.BRACE_R="}",r.NAME="Name",r.INT="Int",r.FLOAT="Float",r.STRING="String",r.BLOCK_STRING="BlockString",r.COMMENT="Comment"})(ni||(ni={}));class twe{constructor(e){const i=new z9(ni.SOF,0,0,0,0);this.source=e,this.lastToken=i,this.token=i,this.line=1,this.lineStart=0}get[Symbol.toStringTag](){return"Lexer"}advance(){return this.lastToken=this.token,this.token=this.lookahead()}lookahead(){let e=this.token;if(e.kind!==ni.EOF)do if(e.next)e=e.next;else{const i=rwe(this,e.end);e.next=i,i.prev=e,e=i}while(e.kind===ni.COMMENT);return e}}function iwe(r){return r===ni.BANG||r===ni.DOLLAR||r===ni.AMP||r===ni.PAREN_L||r===ni.PAREN_R||r===ni.SPREAD||r===ni.COLON||r===ni.EQUALS||r===ni.AT||r===ni.BRACKET_L||r===ni.BRACKET_R||r===ni.BRACE_L||r===ni.PIPE||r===ni.BRACE_R}function Jg(r){return r>=0&&r<=55295||r>=57344&&r<=1114111}function mE(r,e){return W9(r.charCodeAt(e))&&Q9(r.charCodeAt(e+1))}function W9(r){return r>=55296&&r<=56319}function Q9(r){return r>=56320&&r<=57343}function sf(r,e){const i=r.source.body.codePointAt(e);if(i===void 0)return ni.EOF;if(i>=32&&i<=126){const n=String.fromCodePoint(i);return n==='"'?`'"'`:`"${n}"`}return"U+"+i.toString(16).toUpperCase().padStart(4,"0")}function la(r,e,i,n,s){const o=r.line,l=1+i-r.lineStart;return new z9(e,i,n,o,l,s)}function rwe(r,e){const i=r.source.body,n=i.length;let s=e;for(;s<n;){const o=i.charCodeAt(s);switch(o){case 65279:case 9:case 32:case 44:++s;continue;case 10:++s,++r.line,r.lineStart=s;continue;case 13:i.charCodeAt(s+1)===10?s+=2:++s,++r.line,r.lineStart=s;continue;case 35:return nwe(r,s);case 33:return la(r,ni.BANG,s,s+1);case 36:return la(r,ni.DOLLAR,s,s+1);case 38:return la(r,ni.AMP,s,s+1);case 40:return la(r,ni.PAREN_L,s,s+1);case 41:return la(r,ni.PAREN_R,s,s+1);case 46:if(i.charCodeAt(s+1)===46&&i.charCodeAt(s+2)===46)return la(r,ni.SPREAD,s,s+3);break;case 58:return la(r,ni.COLON,s,s+1);case 61:return la(r,ni.EQUALS,s,s+1);case 64:return la(r,ni.AT,s,s+1);case 91:return la(r,ni.BRACKET_L,s,s+1);case 93:return la(r,ni.BRACKET_R,s,s+1);case 123:return la(r,ni.BRACE_L,s,s+1);case 124:return la(r,ni.PIPE,s,s+1);case 125:return la(r,ni.BRACE_R,s,s+1);case 34:return i.charCodeAt(s+1)===34&&i.charCodeAt(s+2)===34?uwe(r,s):awe(r,s)}if(av(o)||o===45)return swe(r,s,o);if(H9(o))return hwe(r,s);throw Na(r.source,s,o===39?`Unexpected single quote character ('), did you mean to use a double quote (")?`:Jg(o)||mE(i,s)?`Unexpected character: ${sf(r,s)}.`:`Invalid character: ${sf(r,s)}.`)}return la(r,ni.EOF,n,n)}function nwe(r,e){const i=r.source.body,n=i.length;let s=e+1;for(;s<n;){const o=i.charCodeAt(s);if(o===10||o===13)break;if(Jg(o))++s;else if(mE(i,s))s+=2;else break}return la(r,ni.COMMENT,e,s,i.slice(e+1,s))}function swe(r,e,i){const n=r.source.body;let s=e,o=i,l=!1;if(o===45&&(o=n.charCodeAt(++s)),o===48){if(o=n.charCodeAt(++s),av(o))throw Na(r.source,s,`Invalid number, unexpected digit after 0: ${sf(r,s)}.`)}else s=ZI(r,s,o),o=n.charCodeAt(s);if(o===46&&(l=!0,o=n.charCodeAt(++s),s=ZI(r,s,o),o=n.charCodeAt(s)),(o===69||o===101)&&(l=!0,o=n.charCodeAt(++s),(o===43||o===45)&&(o=n.charCodeAt(++s)),s=ZI(r,s,o),o=n.charCodeAt(s)),o===46||H9(o))throw Na(r.source,s,`Invalid number, expected digit but got: ${sf(r,s)}.`);return la(r,l?ni.FLOAT:ni.INT,e,s,n.slice(e,s))}function ZI(r,e,i){if(!av(i))throw Na(r.source,e,`Invalid number, expected digit but got: ${sf(r,e)}.`);const n=r.source.body;let s=e+1;for(;av(n.charCodeAt(s));)++s;return s}function awe(r,e){const i=r.source.body,n=i.length;let s=e+1,o=s,l="";for(;s<n;){const u=i.charCodeAt(s);if(u===34)return l+=i.slice(o,s),la(r,ni.STRING,e,s+1,l);if(u===92){l+=i.slice(o,s);const c=i.charCodeAt(s+1)===117?i.charCodeAt(s+2)===123?owe(r,s):lwe(r,s):cwe(r,s);l+=c.value,s+=c.size,o=s;continue}if(u===10||u===13)break;if(Jg(u))++s;else if(mE(i,s))s+=2;else throw Na(r.source,s,`Invalid character within String: ${sf(r,s)}.`)}throw Na(r.source,s,"Unterminated string.")}function owe(r,e){const i=r.source.body;let n=0,s=3;for(;s<12;){const o=i.charCodeAt(e+s++);if(o===125){if(s<5||!Jg(n))break;return{value:String.fromCodePoint(n),size:s}}if(n=n<<4|ov(o),n<0)break}throw Na(r.source,e,`Invalid Unicode escape sequence: "${i.slice(e,e+s)}".`)}function lwe(r,e){const i=r.source.body,n=q9(i,e+2);if(Jg(n))return{value:String.fromCodePoint(n),size:6};if(W9(n)&&i.charCodeAt(e+6)===92&&i.charCodeAt(e+7)===117){const s=q9(i,e+8);if(Q9(s))return{value:String.fromCodePoint(n,s),size:12}}throw Na(r.source,e,`Invalid Unicode escape sequence: "${i.slice(e,e+6)}".`)}function q9(r,e){return ov(r.charCodeAt(e))<<12|ov(r.charCodeAt(e+1))<<8|ov(r.charCodeAt(e+2))<<4|ov(r.charCodeAt(e+3))}function ov(r){return r>=48&&r<=57?r-48:r>=65&&r<=70?r-55:r>=97&&r<=102?r-87:-1}function cwe(r,e){const i=r.source.body;switch(i.charCodeAt(e+1)){case 34:return{value:'"',size:2};case 92:return{value:"\\",size:2};case 47:return{value:"/",size:2};case 98:return{value:"\b",size:2};case 102:return{value:"\f",size:2};case 110:return{value:`
`,size:2};case 114:return{value:"\r",size:2};case 116:return{value:"	",size:2}}throw Na(r.source,e,`Invalid character escape sequence: "${i.slice(e,e+2)}".`)}function uwe(r,e){const i=r.source.body,n=i.length;let s=r.lineStart,o=e+3,l=o,u="";const c=[];for(;o<n;){const h=i.charCodeAt(o);if(h===34&&i.charCodeAt(o+1)===34&&i.charCodeAt(o+2)===34){u+=i.slice(l,o),c.push(u);const p=la(r,ni.BLOCK_STRING,e,o+3,ZEe(c).join(`
`));return r.line+=c.length-1,r.lineStart=s,p}if(h===92&&i.charCodeAt(o+1)===34&&i.charCodeAt(o+2)===34&&i.charCodeAt(o+3)===34){u+=i.slice(l,o),l=o+1,o+=4;continue}if(h===10||h===13){u+=i.slice(l,o),c.push(u),h===13&&i.charCodeAt(o+1)===10?o+=2:++o,u="",l=o,s=o;continue}if(Jg(h))++o;else if(mE(i,o))o+=2;else throw Na(r.source,o,`Invalid character within String: ${sf(r,o)}.`)}throw Na(r.source,o,"Unterminated string.")}function hwe(r,e){const i=r.source.body,n=i.length;let s=e+1;for(;s<n;){const o=i.charCodeAt(s);if(JEe(o))++s;else break}return la(r,ni.NAME,e,s,i.slice(e,s))}const dwe=10,X9=2;function $I(r){return gE(r,[])}function gE(r,e){switch(typeof r){case"string":return JSON.stringify(r);case"function":return r.name?`[function ${r.name}]`:"[function]";case"object":return pwe(r,e);default:return String(r)}}function pwe(r,e){if(r===null)return"null";if(e.includes(r))return"[Circular]";const i=[...e,r];if(fwe(r)){const n=r.toJSON();if(n!==r)return typeof n=="string"?n:gE(n,i)}else if(Array.isArray(r))return gwe(r,i);return mwe(r,i)}function fwe(r){return typeof r.toJSON=="function"}function mwe(r,e){const i=Object.entries(r);return i.length===0?"{}":e.length>X9?"["+Awe(r)+"]":"{ "+i.map(([s,o])=>s+": "+gE(o,e)).join(", ")+" }"}function gwe(r,e){if(r.length===0)return"[]";if(e.length>X9)return"[Array]";const i=Math.min(dwe,r.length),n=r.length-i,s=[];for(let o=0;o<i;++o)s.push(gE(r[o],e));return n===1?s.push("... 1 more item"):n>1&&s.push(`... ${n} more items`),"["+s.join(", ")+"]"}function Awe(r){const e=Object.prototype.toString.call(r).replace(/^\[object /,"").replace(/]$/,"");if(e==="Object"&&typeof r.constructor=="function"){const i=r.constructor.name;if(typeof i=="string"&&i!=="")return i}return e}const ywe=globalThis.process&&process.env.NODE_ENV==="production"?function(e,i){return e instanceof i}:function(e,i){if(e instanceof i)return!0;if(typeof e=="object"&&e!==null){var n;const s=i.prototype[Symbol.toStringTag],o=Symbol.toStringTag in e?e[Symbol.toStringTag]:(n=e.constructor)===null||n===void 0?void 0:n.name;if(s===o){const l=$I(e);throw new Error(`Cannot use ${s} "${l}" from another module or realm.

Ensure that there is only one instance of "graphql" in the node_modules
directory. If different versions of "graphql" are the dependencies of other
relied on modules, use "resolutions" to ensure only one version is installed.

https://yarnpkg.com/en/docs/selective-version-resolutions

Duplicate "graphql" modules cannot be used at the same time since different
versions may have different capabilities and behavior. The data from one
version used in the function from another could produce confusing and
spurious results.`)}}return!1};class Y9{constructor(e,i="GraphQL request",n={line:1,column:1}){typeof e=="string"||fE(!1,`Body must be a string. Received: ${$I(e)}.`),this.body=e,this.name=i,this.locationOffset=n,this.locationOffset.line>0||fE(!1,"line in locationOffset is 1-indexed and must be positive."),this.locationOffset.column>0||fE(!1,"column in locationOffset is 1-indexed and must be positive.")}get[Symbol.toStringTag](){return"Source"}}function vwe(r){return ywe(r,Y9)}function xwe(r,e){const i=new bwe(r,e),n=i.parseDocument();return Object.defineProperty(n,"tokenCount",{enumerable:!1,value:i.tokenCount}),n}class bwe{constructor(e,i={}){const n=vwe(e)?e:new Y9(e);this._lexer=new twe(n),this._options=i,this._tokenCounter=0}get tokenCount(){return this._tokenCounter}parseName(){const e=this.expectToken(ni.NAME);return this.node(e,{kind:Fr.NAME,value:e.value})}parseDocument(){return this.node(this._lexer.token,{kind:Fr.DOCUMENT,definitions:this.many(ni.SOF,this.parseDefinition,ni.EOF)})}parseDefinition(){if(this.peek(ni.BRACE_L))return this.parseOperationDefinition();const e=this.peekDescription(),i=e?this._lexer.lookahead():this._lexer.token;if(i.kind===ni.NAME){switch(i.value){case"schema":return this.parseSchemaDefinition();case"scalar":return this.parseScalarTypeDefinition();case"type":return this.parseObjectTypeDefinition();case"interface":return this.parseInterfaceTypeDefinition();case"union":return this.parseUnionTypeDefinition();case"enum":return this.parseEnumTypeDefinition();case"input":return this.parseInputObjectTypeDefinition();case"directive":return this.parseDirectiveDefinition()}if(e)throw Na(this._lexer.source,this._lexer.token.start,"Unexpected description, descriptions are supported only on type definitions.");switch(i.value){case"query":case"mutation":case"subscription":return this.parseOperationDefinition();case"fragment":return this.parseFragmentDefinition();case"extend":return this.parseTypeSystemExtension()}}throw this.unexpected(i)}parseOperationDefinition(){const e=this._lexer.token;if(this.peek(ni.BRACE_L))return this.node(e,{kind:Fr.OPERATION_DEFINITION,operation:nf.QUERY,name:void 0,variableDefinitions:[],directives:[],selectionSet:this.parseSelectionSet()});const i=this.parseOperationType();let n;return this.peek(ni.NAME)&&(n=this.parseName()),this.node(e,{kind:Fr.OPERATION_DEFINITION,operation:i,name:n,variableDefinitions:this.parseVariableDefinitions(),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseOperationType(){const e=this.expectToken(ni.NAME);switch(e.value){case"query":return nf.QUERY;case"mutation":return nf.MUTATION;case"subscription":return nf.SUBSCRIPTION}throw this.unexpected(e)}parseVariableDefinitions(){return this.optionalMany(ni.PAREN_L,this.parseVariableDefinition,ni.PAREN_R)}parseVariableDefinition(){return this.node(this._lexer.token,{kind:Fr.VARIABLE_DEFINITION,variable:this.parseVariable(),type:(this.expectToken(ni.COLON),this.parseTypeReference()),defaultValue:this.expectOptionalToken(ni.EQUALS)?this.parseConstValueLiteral():void 0,directives:this.parseConstDirectives()})}parseVariable(){const e=this._lexer.token;return this.expectToken(ni.DOLLAR),this.node(e,{kind:Fr.VARIABLE,name:this.parseName()})}parseSelectionSet(){return this.node(this._lexer.token,{kind:Fr.SELECTION_SET,selections:this.many(ni.BRACE_L,this.parseSelection,ni.BRACE_R)})}parseSelection(){return this.peek(ni.SPREAD)?this.parseFragment():this.parseField()}parseField(){const e=this._lexer.token,i=this.parseName();let n,s;return this.expectOptionalToken(ni.COLON)?(n=i,s=this.parseName()):s=i,this.node(e,{kind:Fr.FIELD,alias:n,name:s,arguments:this.parseArguments(!1),directives:this.parseDirectives(!1),selectionSet:this.peek(ni.BRACE_L)?this.parseSelectionSet():void 0})}parseArguments(e){const i=e?this.parseConstArgument:this.parseArgument;return this.optionalMany(ni.PAREN_L,i,ni.PAREN_R)}parseArgument(e=!1){const i=this._lexer.token,n=this.parseName();return this.expectToken(ni.COLON),this.node(i,{kind:Fr.ARGUMENT,name:n,value:this.parseValueLiteral(e)})}parseConstArgument(){return this.parseArgument(!0)}parseFragment(){const e=this._lexer.token;this.expectToken(ni.SPREAD);const i=this.expectOptionalKeyword("on");return!i&&this.peek(ni.NAME)?this.node(e,{kind:Fr.FRAGMENT_SPREAD,name:this.parseFragmentName(),directives:this.parseDirectives(!1)}):this.node(e,{kind:Fr.INLINE_FRAGMENT,typeCondition:i?this.parseNamedType():void 0,directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentDefinition(){const e=this._lexer.token;return this.expectKeyword("fragment"),this._options.allowLegacyFragmentVariables===!0?this.node(e,{kind:Fr.FRAGMENT_DEFINITION,name:this.parseFragmentName(),variableDefinitions:this.parseVariableDefinitions(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()}):this.node(e,{kind:Fr.FRAGMENT_DEFINITION,name:this.parseFragmentName(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentName(){if(this._lexer.token.value==="on")throw this.unexpected();return this.parseName()}parseValueLiteral(e){const i=this._lexer.token;switch(i.kind){case ni.BRACKET_L:return this.parseList(e);case ni.BRACE_L:return this.parseObject(e);case ni.INT:return this.advanceLexer(),this.node(i,{kind:Fr.INT,value:i.value});case ni.FLOAT:return this.advanceLexer(),this.node(i,{kind:Fr.FLOAT,value:i.value});case ni.STRING:case ni.BLOCK_STRING:return this.parseStringLiteral();case ni.NAME:switch(this.advanceLexer(),i.value){case"true":return this.node(i,{kind:Fr.BOOLEAN,value:!0});case"false":return this.node(i,{kind:Fr.BOOLEAN,value:!1});case"null":return this.node(i,{kind:Fr.NULL});default:return this.node(i,{kind:Fr.ENUM,value:i.value})}case ni.DOLLAR:if(e)if(this.expectToken(ni.DOLLAR),this._lexer.token.kind===ni.NAME){const n=this._lexer.token.value;throw Na(this._lexer.source,i.start,`Unexpected variable "$${n}" in constant value.`)}else throw this.unexpected(i);return this.parseVariable();default:throw this.unexpected()}}parseConstValueLiteral(){return this.parseValueLiteral(!0)}parseStringLiteral(){const e=this._lexer.token;return this.advanceLexer(),this.node(e,{kind:Fr.STRING,value:e.value,block:e.kind===ni.BLOCK_STRING})}parseList(e){const i=()=>this.parseValueLiteral(e);return this.node(this._lexer.token,{kind:Fr.LIST,values:this.any(ni.BRACKET_L,i,ni.BRACKET_R)})}parseObject(e){const i=()=>this.parseObjectField(e);return this.node(this._lexer.token,{kind:Fr.OBJECT,fields:this.any(ni.BRACE_L,i,ni.BRACE_R)})}parseObjectField(e){const i=this._lexer.token,n=this.parseName();return this.expectToken(ni.COLON),this.node(i,{kind:Fr.OBJECT_FIELD,name:n,value:this.parseValueLiteral(e)})}parseDirectives(e){const i=[];for(;this.peek(ni.AT);)i.push(this.parseDirective(e));return i}parseConstDirectives(){return this.parseDirectives(!0)}parseDirective(e){const i=this._lexer.token;return this.expectToken(ni.AT),this.node(i,{kind:Fr.DIRECTIVE,name:this.parseName(),arguments:this.parseArguments(e)})}parseTypeReference(){const e=this._lexer.token;let i;if(this.expectOptionalToken(ni.BRACKET_L)){const n=this.parseTypeReference();this.expectToken(ni.BRACKET_R),i=this.node(e,{kind:Fr.LIST_TYPE,type:n})}else i=this.parseNamedType();return this.expectOptionalToken(ni.BANG)?this.node(e,{kind:Fr.NON_NULL_TYPE,type:i}):i}parseNamedType(){return this.node(this._lexer.token,{kind:Fr.NAMED_TYPE,name:this.parseName()})}peekDescription(){return this.peek(ni.STRING)||this.peek(ni.BLOCK_STRING)}parseDescription(){if(this.peekDescription())return this.parseStringLiteral()}parseSchemaDefinition(){const e=this._lexer.token,i=this.parseDescription();this.expectKeyword("schema");const n=this.parseConstDirectives(),s=this.many(ni.BRACE_L,this.parseOperationTypeDefinition,ni.BRACE_R);return this.node(e,{kind:Fr.SCHEMA_DEFINITION,description:i,directives:n,operationTypes:s})}parseOperationTypeDefinition(){const e=this._lexer.token,i=this.parseOperationType();this.expectToken(ni.COLON);const n=this.parseNamedType();return this.node(e,{kind:Fr.OPERATION_TYPE_DEFINITION,operation:i,type:n})}parseScalarTypeDefinition(){const e=this._lexer.token,i=this.parseDescription();this.expectKeyword("scalar");const n=this.parseName(),s=this.parseConstDirectives();return this.node(e,{kind:Fr.SCALAR_TYPE_DEFINITION,description:i,name:n,directives:s})}parseObjectTypeDefinition(){const e=this._lexer.token,i=this.parseDescription();this.expectKeyword("type");const n=this.parseName(),s=this.parseImplementsInterfaces(),o=this.parseConstDirectives(),l=this.parseFieldsDefinition();return this.node(e,{kind:Fr.OBJECT_TYPE_DEFINITION,description:i,name:n,interfaces:s,directives:o,fields:l})}parseImplementsInterfaces(){return this.expectOptionalKeyword("implements")?this.delimitedMany(ni.AMP,this.parseNamedType):[]}parseFieldsDefinition(){return this.optionalMany(ni.BRACE_L,this.parseFieldDefinition,ni.BRACE_R)}parseFieldDefinition(){const e=this._lexer.token,i=this.parseDescription(),n=this.parseName(),s=this.parseArgumentDefs();this.expectToken(ni.COLON);const o=this.parseTypeReference(),l=this.parseConstDirectives();return this.node(e,{kind:Fr.FIELD_DEFINITION,description:i,name:n,arguments:s,type:o,directives:l})}parseArgumentDefs(){return this.optionalMany(ni.PAREN_L,this.parseInputValueDef,ni.PAREN_R)}parseInputValueDef(){const e=this._lexer.token,i=this.parseDescription(),n=this.parseName();this.expectToken(ni.COLON);const s=this.parseTypeReference();let o;this.expectOptionalToken(ni.EQUALS)&&(o=this.parseConstValueLiteral());const l=this.parseConstDirectives();return this.node(e,{kind:Fr.INPUT_VALUE_DEFINITION,description:i,name:n,type:s,defaultValue:o,directives:l})}parseInterfaceTypeDefinition(){const e=this._lexer.token,i=this.parseDescription();this.expectKeyword("interface");const n=this.parseName(),s=this.parseImplementsInterfaces(),o=this.parseConstDirectives(),l=this.parseFieldsDefinition();return this.node(e,{kind:Fr.INTERFACE_TYPE_DEFINITION,description:i,name:n,interfaces:s,directives:o,fields:l})}parseUnionTypeDefinition(){const e=this._lexer.token,i=this.parseDescription();this.expectKeyword("union");const n=this.parseName(),s=this.parseConstDirectives(),o=this.parseUnionMemberTypes();return this.node(e,{kind:Fr.UNION_TYPE_DEFINITION,description:i,name:n,directives:s,types:o})}parseUnionMemberTypes(){return this.expectOptionalToken(ni.EQUALS)?this.delimitedMany(ni.PIPE,this.parseNamedType):[]}parseEnumTypeDefinition(){const e=this._lexer.token,i=this.parseDescription();this.expectKeyword("enum");const n=this.parseName(),s=this.parseConstDirectives(),o=this.parseEnumValuesDefinition();return this.node(e,{kind:Fr.ENUM_TYPE_DEFINITION,description:i,name:n,directives:s,values:o})}parseEnumValuesDefinition(){return this.optionalMany(ni.BRACE_L,this.parseEnumValueDefinition,ni.BRACE_R)}parseEnumValueDefinition(){const e=this._lexer.token,i=this.parseDescription(),n=this.parseEnumValueName(),s=this.parseConstDirectives();return this.node(e,{kind:Fr.ENUM_VALUE_DEFINITION,description:i,name:n,directives:s})}parseEnumValueName(){if(this._lexer.token.value==="true"||this._lexer.token.value==="false"||this._lexer.token.value==="null")throw Na(this._lexer.source,this._lexer.token.start,`${AE(this._lexer.token)} is reserved and cannot be used for an enum value.`);return this.parseName()}parseInputObjectTypeDefinition(){const e=this._lexer.token,i=this.parseDescription();this.expectKeyword("input");const n=this.parseName(),s=this.parseConstDirectives(),o=this.parseInputFieldsDefinition();return this.node(e,{kind:Fr.INPUT_OBJECT_TYPE_DEFINITION,description:i,name:n,directives:s,fields:o})}parseInputFieldsDefinition(){return this.optionalMany(ni.BRACE_L,this.parseInputValueDef,ni.BRACE_R)}parseTypeSystemExtension(){const e=this._lexer.lookahead();if(e.kind===ni.NAME)switch(e.value){case"schema":return this.parseSchemaExtension();case"scalar":return this.parseScalarTypeExtension();case"type":return this.parseObjectTypeExtension();case"interface":return this.parseInterfaceTypeExtension();case"union":return this.parseUnionTypeExtension();case"enum":return this.parseEnumTypeExtension();case"input":return this.parseInputObjectTypeExtension()}throw this.unexpected(e)}parseSchemaExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("schema");const i=this.parseConstDirectives(),n=this.optionalMany(ni.BRACE_L,this.parseOperationTypeDefinition,ni.BRACE_R);if(i.length===0&&n.length===0)throw this.unexpected();return this.node(e,{kind:Fr.SCHEMA_EXTENSION,directives:i,operationTypes:n})}parseScalarTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("scalar");const i=this.parseName(),n=this.parseConstDirectives();if(n.length===0)throw this.unexpected();return this.node(e,{kind:Fr.SCALAR_TYPE_EXTENSION,name:i,directives:n})}parseObjectTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("type");const i=this.parseName(),n=this.parseImplementsInterfaces(),s=this.parseConstDirectives(),o=this.parseFieldsDefinition();if(n.length===0&&s.length===0&&o.length===0)throw this.unexpected();return this.node(e,{kind:Fr.OBJECT_TYPE_EXTENSION,name:i,interfaces:n,directives:s,fields:o})}parseInterfaceTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("interface");const i=this.parseName(),n=this.parseImplementsInterfaces(),s=this.parseConstDirectives(),o=this.parseFieldsDefinition();if(n.length===0&&s.length===0&&o.length===0)throw this.unexpected();return this.node(e,{kind:Fr.INTERFACE_TYPE_EXTENSION,name:i,interfaces:n,directives:s,fields:o})}parseUnionTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("union");const i=this.parseName(),n=this.parseConstDirectives(),s=this.parseUnionMemberTypes();if(n.length===0&&s.length===0)throw this.unexpected();return this.node(e,{kind:Fr.UNION_TYPE_EXTENSION,name:i,directives:n,types:s})}parseEnumTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("enum");const i=this.parseName(),n=this.parseConstDirectives(),s=this.parseEnumValuesDefinition();if(n.length===0&&s.length===0)throw this.unexpected();return this.node(e,{kind:Fr.ENUM_TYPE_EXTENSION,name:i,directives:n,values:s})}parseInputObjectTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("input");const i=this.parseName(),n=this.parseConstDirectives(),s=this.parseInputFieldsDefinition();if(n.length===0&&s.length===0)throw this.unexpected();return this.node(e,{kind:Fr.INPUT_OBJECT_TYPE_EXTENSION,name:i,directives:n,fields:s})}parseDirectiveDefinition(){const e=this._lexer.token,i=this.parseDescription();this.expectKeyword("directive"),this.expectToken(ni.AT);const n=this.parseName(),s=this.parseArgumentDefs(),o=this.expectOptionalKeyword("repeatable");this.expectKeyword("on");const l=this.parseDirectiveLocations();return this.node(e,{kind:Fr.DIRECTIVE_DEFINITION,description:i,name:n,arguments:s,repeatable:o,locations:l})}parseDirectiveLocations(){return this.delimitedMany(ni.PIPE,this.parseDirectiveLocation)}parseDirectiveLocation(){const e=this._lexer.token,i=this.parseName();if(Object.prototype.hasOwnProperty.call(KI,i.value))return i;throw this.unexpected(e)}node(e,i){return this._options.noLocation!==!0&&(i.loc=new YEe(e,this._lexer.lastToken,this._lexer.source)),i}peek(e){return this._lexer.token.kind===e}expectToken(e){const i=this._lexer.token;if(i.kind===e)return this.advanceLexer(),i;throw Na(this._lexer.source,i.start,`Expected ${K9(e)}, found ${AE(i)}.`)}expectOptionalToken(e){return this._lexer.token.kind===e?(this.advanceLexer(),!0):!1}expectKeyword(e){const i=this._lexer.token;if(i.kind===ni.NAME&&i.value===e)this.advanceLexer();else throw Na(this._lexer.source,i.start,`Expected "${e}", found ${AE(i)}.`)}expectOptionalKeyword(e){const i=this._lexer.token;return i.kind===ni.NAME&&i.value===e?(this.advanceLexer(),!0):!1}unexpected(e){const i=e??this._lexer.token;return Na(this._lexer.source,i.start,`Unexpected ${AE(i)}.`)}any(e,i,n){this.expectToken(e);const s=[];for(;!this.expectOptionalToken(n);)s.push(i.call(this));return s}optionalMany(e,i,n){if(this.expectOptionalToken(e)){const s=[];do s.push(i.call(this));while(!this.expectOptionalToken(n));return s}return[]}many(e,i,n){this.expectToken(e);const s=[];do s.push(i.call(this));while(!this.expectOptionalToken(n));return s}delimitedMany(e,i){this.expectOptionalToken(e);const n=[];do n.push(i.call(this));while(this.expectOptionalToken(e));return n}advanceLexer(){const{maxTokens:e}=this._options,i=this._lexer.advance();if(i.kind!==ni.EOF&&(++this._tokenCounter,e!==void 0&&this._tokenCounter>e))throw Na(this._lexer.source,i.start,`Document contains more that ${e} tokens. Parsing aborted.`)}}function AE(r){const e=r.value;return K9(r.kind)+(e!=null?` "${e}"`:"")}function K9(r){return iwe(r)?`"${r}"`:r}function _we(r){return`"${r.replace(Ewe,wwe)}"`}const Ewe=/[\x00-\x1f\x22\x5c\x7f-\x9f]/g;function wwe(r){return Cwe[r.charCodeAt(0)]}const Cwe=["\\u0000","\\u0001","\\u0002","\\u0003","\\u0004","\\u0005","\\u0006","\\u0007","\\b","\\t","\\n","\\u000B","\\f","\\r","\\u000E","\\u000F","\\u0010","\\u0011","\\u0012","\\u0013","\\u0014","\\u0015","\\u0016","\\u0017","\\u0018","\\u0019","\\u001A","\\u001B","\\u001C","\\u001D","\\u001E","\\u001F","","",'\\"',"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\\\","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\u007F","\\u0080","\\u0081","\\u0082","\\u0083","\\u0084","\\u0085","\\u0086","\\u0087","\\u0088","\\u0089","\\u008A","\\u008B","\\u008C","\\u008D","\\u008E","\\u008F","\\u0090","\\u0091","\\u0092","\\u0093","\\u0094","\\u0095","\\u0096","\\u0097","\\u0098","\\u0099","\\u009A","\\u009B","\\u009C","\\u009D","\\u009E","\\u009F"],Swe=Object.freeze({});function Twe(r,e,i=j9){const n=new Map;for(const _ of Object.values(Fr))n.set(_,Mwe(e,_));let s,o=Array.isArray(r),l=[r],u=-1,c=[],h=r,p,f;const m=[],g=[];do{u++;const _=u===l.length,T=_&&c.length!==0;if(_){if(p=g.length===0?void 0:m[m.length-1],h=f,f=g.pop(),T)if(o){h=h.slice();let S=0;for(const[R,B]of c){const I=R-S;B===null?(h.splice(I,1),S++):h[I]=B}}else{h={...h};for(const[S,R]of c)h[S]=R}u=s.index,l=s.keys,c=s.edits,o=s.inArray,s=s.prev}else if(f){if(p=o?u:l[u],h=f[p],h==null)continue;m.push(p)}let w;if(!Array.isArray(h)){var y,x;V9(h)||fE(!1,`Invalid AST Node: ${$I(h)}.`);const S=_?(y=n.get(h.kind))===null||y===void 0?void 0:y.leave:(x=n.get(h.kind))===null||x===void 0?void 0:x.enter;if(w=S==null?void 0:S.call(e,h,p,f,m,g),w===Swe)break;if(w===!1){if(!_){m.pop();continue}}else if(w!==void 0&&(c.push([p,w]),!_))if(V9(w))h=w;else{m.pop();continue}}if(w===void 0&&T&&c.push([p,h]),_)m.pop();else{var v;s={inArray:o,index:u,keys:l,edits:c,prev:s},o=Array.isArray(h),l=o?h:(v=i[h.kind])!==null&&v!==void 0?v:[],u=-1,c=[],f&&g.push(f),f=h}}while(s!==void 0);return c.length!==0?c[c.length-1][1]:r}function Mwe(r,e){const i=r[e];return typeof i=="object"?i:typeof i=="function"?{enter:i,leave:void 0}:{enter:r.enter,leave:r.leave}}function Rwe(r){return Twe(r,Bwe)}const Iwe=80,Bwe={Name:{leave:r=>r.value},Variable:{leave:r=>"$"+r.name},Document:{leave:r=>yr(r.definitions,`

`)},OperationDefinition:{leave(r){const e=In("(",yr(r.variableDefinitions,", "),")"),i=yr([r.operation,yr([r.name,e]),yr(r.directives," ")]," ");return(i==="query"?"":i+" ")+r.selectionSet}},VariableDefinition:{leave:({variable:r,type:e,defaultValue:i,directives:n})=>r+": "+e+In(" = ",i)+In(" ",yr(n," "))},SelectionSet:{leave:({selections:r})=>Tc(r)},Field:{leave({alias:r,name:e,arguments:i,directives:n,selectionSet:s}){const o=In("",r,": ")+e;let l=o+In("(",yr(i,", "),")");return l.length>Iwe&&(l=o+In(`(
`,yE(yr(i,`
`)),`
)`)),yr([l,yr(n," "),s]," ")}},Argument:{leave:({name:r,value:e})=>r+": "+e},FragmentSpread:{leave:({name:r,directives:e})=>"..."+r+In(" ",yr(e," "))},InlineFragment:{leave:({typeCondition:r,directives:e,selectionSet:i})=>yr(["...",In("on ",r),yr(e," "),i]," ")},FragmentDefinition:{leave:({name:r,typeCondition:e,variableDefinitions:i,directives:n,selectionSet:s})=>`fragment ${r}${In("(",yr(i,", "),")")} on ${e} ${In("",yr(n," ")," ")}`+s},IntValue:{leave:({value:r})=>r},FloatValue:{leave:({value:r})=>r},StringValue:{leave:({value:r,block:e})=>e?ewe(r):_we(r)},BooleanValue:{leave:({value:r})=>r?"true":"false"},NullValue:{leave:()=>"null"},EnumValue:{leave:({value:r})=>r},ListValue:{leave:({values:r})=>"["+yr(r,", ")+"]"},ObjectValue:{leave:({fields:r})=>"{"+yr(r,", ")+"}"},ObjectField:{leave:({name:r,value:e})=>r+": "+e},Directive:{leave:({name:r,arguments:e})=>"@"+r+In("(",yr(e,", "),")")},NamedType:{leave:({name:r})=>r},ListType:{leave:({type:r})=>"["+r+"]"},NonNullType:{leave:({type:r})=>r+"!"},SchemaDefinition:{leave:({description:r,directives:e,operationTypes:i})=>In("",r,`
`)+yr(["schema",yr(e," "),Tc(i)]," ")},OperationTypeDefinition:{leave:({operation:r,type:e})=>r+": "+e},ScalarTypeDefinition:{leave:({description:r,name:e,directives:i})=>In("",r,`
`)+yr(["scalar",e,yr(i," ")]," ")},ObjectTypeDefinition:{leave:({description:r,name:e,interfaces:i,directives:n,fields:s})=>In("",r,`
`)+yr(["type",e,In("implements ",yr(i," & ")),yr(n," "),Tc(s)]," ")},FieldDefinition:{leave:({description:r,name:e,arguments:i,type:n,directives:s})=>In("",r,`
`)+e+(J9(i)?In(`(
`,yE(yr(i,`
`)),`
)`):In("(",yr(i,", "),")"))+": "+n+In(" ",yr(s," "))},InputValueDefinition:{leave:({description:r,name:e,type:i,defaultValue:n,directives:s})=>In("",r,`
`)+yr([e+": "+i,In("= ",n),yr(s," ")]," ")},InterfaceTypeDefinition:{leave:({description:r,name:e,interfaces:i,directives:n,fields:s})=>In("",r,`
`)+yr(["interface",e,In("implements ",yr(i," & ")),yr(n," "),Tc(s)]," ")},UnionTypeDefinition:{leave:({description:r,name:e,directives:i,types:n})=>In("",r,`
`)+yr(["union",e,yr(i," "),In("= ",yr(n," | "))]," ")},EnumTypeDefinition:{leave:({description:r,name:e,directives:i,values:n})=>In("",r,`
`)+yr(["enum",e,yr(i," "),Tc(n)]," ")},EnumValueDefinition:{leave:({description:r,name:e,directives:i})=>In("",r,`
`)+yr([e,yr(i," ")]," ")},InputObjectTypeDefinition:{leave:({description:r,name:e,directives:i,fields:n})=>In("",r,`
`)+yr(["input",e,yr(i," "),Tc(n)]," ")},DirectiveDefinition:{leave:({description:r,name:e,arguments:i,repeatable:n,locations:s})=>In("",r,`
`)+"directive @"+e+(J9(i)?In(`(
`,yE(yr(i,`
`)),`
)`):In("(",yr(i,", "),")"))+(n?" repeatable":"")+" on "+yr(s," | ")},SchemaExtension:{leave:({directives:r,operationTypes:e})=>yr(["extend schema",yr(r," "),Tc(e)]," ")},ScalarTypeExtension:{leave:({name:r,directives:e})=>yr(["extend scalar",r,yr(e," ")]," ")},ObjectTypeExtension:{leave:({name:r,interfaces:e,directives:i,fields:n})=>yr(["extend type",r,In("implements ",yr(e," & ")),yr(i," "),Tc(n)]," ")},InterfaceTypeExtension:{leave:({name:r,interfaces:e,directives:i,fields:n})=>yr(["extend interface",r,In("implements ",yr(e," & ")),yr(i," "),Tc(n)]," ")},UnionTypeExtension:{leave:({name:r,directives:e,types:i})=>yr(["extend union",r,yr(e," "),In("= ",yr(i," | "))]," ")},EnumTypeExtension:{leave:({name:r,directives:e,values:i})=>yr(["extend enum",r,yr(e," "),Tc(i)]," ")},InputObjectTypeExtension:{leave:({name:r,directives:e,fields:i})=>yr(["extend input",r,yr(e," "),Tc(i)]," ")}};function yr(r,e=""){var i;return(i=r==null?void 0:r.filter(n=>n).join(e))!==null&&i!==void 0?i:""}function Tc(r){return In(`{
`,yE(yr(r,`
`)),`
}`)}function In(r,e,i=""){return e!=null&&e!==""?r+e+i:""}function yE(r){return In("  ",r.replace(/\n/g,`
  `))}function J9(r){var e;return(e=r==null?void 0:r.some(i=>i.includes(`
`)))!==null&&e!==void 0?e:!1}const Z9="Accept",eB="Content-Type",tB="application/json",$9="application/graphql-response+json",ej=r=>r.replace(/([\s,]|#[^\n\r]+)+/g," ").trim(),Nwe=r=>{const e=r.toLowerCase();return e.includes($9)||e.includes(tB)},tj=r=>{try{if(Array.isArray(r))return{_tag:"Batch",executionResults:r.map(ij)};if(pE(r))return{_tag:"Single",executionResult:ij(r)};throw new Error(`Invalid execution result: result is not object or array. 
Got:
${String(r)}`)}catch(e){return e}},ij=r=>{if(typeof r!="object"||r===null)throw new Error("Invalid execution result: result is not object");let e,i,n;if("errors"in r){if(!pE(r.errors)&&!Array.isArray(r.errors))throw new Error("Invalid execution result: errors is not plain object OR array");e=r.errors}if("data"in r){if(!pE(r.data)&&r.data!==null)throw new Error("Invalid execution result: data is not plain object");i=r.data}if("extensions"in r){if(!pE(r.extensions))throw new Error("Invalid execution result: extensions is not plain object");n=r.extensions}return{data:i,errors:e,extensions:n}},Lwe=r=>r._tag==="Batch"?r.executionResults.some(rj):rj(r.executionResult),rj=r=>Array.isArray(r.errors)?r.errors.length>0:!!r.errors,nj=r=>typeof r=="object"&&r!==null&&"kind"in r&&r.kind===Fr.OPERATION_DEFINITION,Dwe=r=>{var n;let e;const i=r.definitions.filter(nj);return i.length===1&&(e=(n=i[0].name)==null?void 0:n.value),e},Owe=r=>{let e=!1;const i=r.definitions.filter(nj);return i.length===1&&(e=i[0].operation===nf.MUTATION),e},iB=(r,e)=>{const i=typeof r=="string"?r:Rwe(r);let n=!1,s;if(e)return{expression:i,isMutation:n,operationName:s};const o=zEe(()=>typeof r=="string"?xwe(r):r);return o instanceof Error?{expression:i,isMutation:n,operationName:s}:(s=Dwe(o),n=Owe(o),{expression:i,operationName:s,isMutation:n})},rB=JSON,nB=async r=>{const e={...r,method:r.request._tag==="Single"?r.request.document.isMutation?"POST":D9(r.method??"post"):r.request.hasMutations?"POST":D9(r.method??"post"),fetchOptions:{...r.fetchOptions,errorPolicy:r.fetchOptions.errorPolicy??"none"}},n=await kwe(e.method)(e);if(!n.ok)return new Yg({status:n.status,headers:n.headers},{query:r.request._tag==="Single"?r.request.document.expression:r.request.query,variables:r.request.variables});const s=await Pwe(n,r.fetchOptions.jsonSerializer??rB);if(s instanceof Error)throw s;const o={status:n.status,headers:n.headers};if(Lwe(s)&&e.fetchOptions.errorPolicy==="none"){const l=s._tag==="Batch"?{...s.executionResults,...o}:{...s.executionResult,...o};return new Yg(l,{query:r.request._tag==="Single"?r.request.document.expression:r.request.query,variables:r.request.variables})}switch(s._tag){case"Single":return{...o,...sj(e)(s.executionResult)};case"Batch":return{...o,data:s.executionResults.map(sj(e))};default:qI(s)}},sj=r=>e=>({extensions:e.extensions,data:e.data,errors:r.fetchOptions.errorPolicy==="all"?e.errors:void 0}),Pwe=async(r,e)=>{const i=r.headers.get(eB),n=await r.text();return i&&Nwe(i)?tj(e.parse(n)):tj(n)},kwe=r=>async e=>{const i=new Headers(e.headers);let n=null,s;i.has(Z9)||i.set(Z9,[$9,tB].join(", ")),r==="POST"?(s=(e.fetchOptions.jsonSerializer??rB).stringify(Fwe(e)),typeof s=="string"&&!i.has(eB)&&i.set(eB,tB)):n=Uwe(e);const o={method:r,headers:i,body:s,...e.fetchOptions};let l=new URL(e.url),u=o;if(e.middleware){const h=await Promise.resolve(e.middleware({...o,url:e.url,operationName:e.request._tag==="Single"?e.request.document.operationName:void 0,variables:e.request.variables})),{url:p,...f}=h;l=new URL(p),u=f}return n&&n.forEach((h,p)=>{l.searchParams.append(p,h)}),await(e.fetch??fetch)(l,u)},Fwe=r=>{switch(r.request._tag){case"Single":return{query:r.request.document.expression,variables:r.request.variables,operationName:r.request.document.operationName};case"Batch":return O9(r.request.query,r.request.variables??[]).map(([e,i])=>({query:e,variables:i}));default:throw qI(r.request)}},Uwe=r=>{var n;const e=r.fetchOptions.jsonSerializer??rB,i=new URLSearchParams;switch(r.request._tag){case"Single":return i.append("query",ej(r.request.document.expression)),r.request.variables&&i.append("variables",e.stringify(r.request.variables)),r.request.document.operationName&&i.append("operationName",r.request.document.operationName),i;case"Batch":{const s=((n=r.request.variables)==null?void 0:n.map(u=>e.stringify(u)))??[],o=r.request.query.map(ej),l=O9(o,s).map(([u,c])=>({query:u,variables:c}));return i.append("query",e.stringify(l)),i}default:throw qI(r.request)}};class zwe{constructor(e,i={}){N0(this,"url");N0(this,"requestConfig");N0(this,"rawRequest",async(...e)=>{const[i,n,s]=e,o=GEe(i,n,s),{headers:l,fetch:u=globalThis.fetch,method:c="POST",requestMiddleware:h,responseMiddleware:p,excludeOperationName:f,...m}=this.requestConfig,{url:g}=this;o.signal!==void 0&&(m.signal=o.signal);const y=iB(o.query,f),x=await nB({url:g,request:{_tag:"Single",document:y,variables:o.variables},headers:{...Kg(QI(l)),...Kg(o.requestHeaders)},fetch:u,method:c,fetchOptions:m,middleware:h});if(p&&await p(x,{operationName:y.operationName,variables:n,url:this.url}),x instanceof Error)throw x;return x});this.url=e,this.requestConfig=i}async request(e,...i){const[n,s]=i,o=jwe(e,n,s),{headers:l,fetch:u=globalThis.fetch,method:c="POST",requestMiddleware:h,responseMiddleware:p,excludeOperationName:f,...m}=this.requestConfig,{url:g}=this;o.signal!==void 0&&(m.signal=o.signal);const y=iB(o.document,f),x=await nB({url:g,request:{_tag:"Single",document:y,variables:o.variables},headers:{...Kg(QI(l)),...Kg(o.requestHeaders)},fetch:u,method:c,fetchOptions:m,middleware:h});if(p&&await p(x,{operationName:y.operationName,variables:o.variables,url:this.url}),x instanceof Error)throw x;return x.data}async batchRequests(e,i){const n=VEe(e,i),{headers:s,excludeOperationName:o,...l}=this.requestConfig;n.signal!==void 0&&(l.signal=n.signal);const u=n.documents.map(({document:m})=>iB(m,o)),c=u.map(({expression:m})=>m),h=u.some(({isMutation:m})=>m),p=n.documents.map(({variables:m})=>m),f=await nB({url:this.url,request:{_tag:"Batch",operationName:void 0,query:c,hasMutations:h,variables:p},headers:{...Kg(QI(s)),...Kg(n.requestHeaders)},fetch:this.requestConfig.fetch??globalThis.fetch,method:this.requestConfig.method||"POST",fetchOptions:l,middleware:this.requestConfig.requestMiddleware});if(this.requestConfig.responseMiddleware&&await this.requestConfig.responseMiddleware(f,{operationName:void 0,variables:p,url:this.url}),f instanceof Error)throw f;return f.data}setHeaders(e){return this.requestConfig.headers=e,this}setHeader(e,i){const{headers:n}=this.requestConfig;return n?n[e]=i:this.requestConfig.headers={[e]:i},this}setEndpoint(e){return this.url=e,this}}const jwe=(r,e,i)=>r.document?r:{document:r,variables:e,requestHeaders:i,signal:void 0};var Vwe="https://prod.base.intuition-api.com/v1/graphql",Gwe=Vwe,Hwe={apiUrl:Gwe};function Wwe(r){return{headers:{...r,"Content-Type":"application/json"},apiUrl:Hwe.apiUrl}}function Qwe({token:r}){const e=Wwe(r);if(!e.apiUrl)throw new Error("GraphQL API URL not configured. Call configureClient first.");return new zwe(e.apiUrl,e)}const qwe=r=>{const[e,i]=gi.useState(null),[n,s]=gi.useState(!0),[o,l]=gi.useState(null);return gi.useEffect(()=>{(async()=>{try{const c=await oj(r,Mc.MAINNET);i(c),s(!1)}catch(c){console.error(`[MAINNET] Erreur lors de la récupération de l'atome ID=${r}:`,c),l(c instanceof Error?c.message:"Une erreur inconnue est survenue"),s(!1)}})()},[r]),{data:e,loading:n,error:o,network:Mc.MAINNET}},Xwe=r=>{const[e,i]=gi.useState(null),[n,s]=gi.useState(!0),[o,l]=gi.useState(null);return gi.useEffect(()=>{(async()=>{try{const c=await lj(r,Mc.MAINNET);c.atoms&&c.atoms.length>0?i(c.atoms[0]):l(`Aucun atome trouvé avec ce label sur ${Mc.MAINNET}`),s(!1)}catch(c){console.error(`[MAINNET] Erreur lors de la récupération de l'atome label="${r}":`,c),l(c instanceof Error?c.message:"Une erreur inconnue est survenue"),s(!1)}})()},[r]),{data:e,loading:n,error:o,network:Mc.MAINNET}},Ywe=r=>{const[e,i]=gi.useState(null),[n,s]=gi.useState(!0),[o,l]=gi.useState(null);return gi.useEffect(()=>{(async()=>{try{const c=await oj(r,Mc.TESTNET);i(c),s(!1)}catch(c){console.error(`[TESTNET] Erreur lors de la récupération de l'atome ID=${r}:`,c),l(c instanceof Error?c.message:"Une erreur inconnue est survenue"),s(!1)}})()},[r]),{data:e,loading:n,error:o,network:Mc.TESTNET}},Kwe=r=>{const[e,i]=gi.useState(null),[n,s]=gi.useState(!0),[o,l]=gi.useState(null);return gi.useEffect(()=>{(async()=>{try{const c=await lj(r,Mc.TESTNET);c.atoms&&c.atoms.length>0?i(c.atoms[0]):l(`Aucun atome trouvé avec ce label sur ${Mc.TESTNET}`),s(!1)}catch(c){console.error(`[TESTNET] Erreur lors de la récupération de l'atome label="${r}":`,c),l(c instanceof Error?c.message:"Une erreur inconnue est survenue"),s(!1)}})()},[r]),{data:e,loading:n,error:o,network:Mc.TESTNET}};var Mc=(r=>(r.MAINNET="mainnet",r.TESTNET="testnet",r))(Mc||{});const aj=(r="mainnet")=>Qwe({token:void 0}),oj=async(r,e="mainnet")=>{const i=aj(e),n=`
    query GetAtomById($id: numeric!) {
      atom(id: $id) {
        id
        label
        type
        data
        emoji
        image
        creator_id
        creator {
          id
          label
        }
        value {
          id
        }
        block_number
        block_timestamp
        transaction_hash
      }
    }
  `,s={id:r};return await i.request(n,s)},lj=async(r,e="mainnet")=>{const i=aj(e),n=`
    query GetAtomByLabel($label: String!) {
      atoms(where: { label: { _eq: $label } }, limit: 1) {
        id
        label
        type
        data
        emoji
        image
        creator_id
        creator {
          id
          label
        }
        value {
          id
        }
        block_number
        block_timestamp
        transaction_hash
      }
    }
  `,s={label:r};return await i.request(n,s)},cj=async(r,e,i)=>{const n=r==="testnet"?"https://dev.base-sepolia.intuition-api.com/v1/graphql":"https://prod.base.intuition-api.com/v1/graphql";let s="",o={};if(e!==void 0)s=`
      query GetAtomById($id: numeric!) {
        atom(id: $id) {
          id
          label
          type
          data
          emoji
          image
          creator_id
          creator {
            id
            label
          }
          value {
            id
          }
          block_number
          block_timestamp
          transaction_hash
        }
      }
    `,o={id:e};else if(i!==void 0)s=`
      query GetAtomByLabel($label: String!) {
        atoms(where: { label: { _eq: $label } }, limit: 1) {
          id
          label
          type
          data
          emoji
          image
          creator_id
          creator {
            id
            label
          }
          value {
            id
          }
          block_number
          block_timestamp
          transaction_hash
        }
      }
    `,o={label:i};else throw new Error("Vous devez spécifier un ID ou un label");try{return await(await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:s,variables:o})})).json()}catch(l){throw console.error(`Erreur lors de la requête ${r}:`,l),l}},Jwe=({walletAddress:r})=>{const[e,i]=gi.useState(3),[n,s]=gi.useState(1),[o,l]=gi.useState("has tag"),[u,c]=gi.useState("has tag"),[h,p]=gi.useState(null),[f,m]=gi.useState(!1),{data:g,loading:y,error:x}=qwe(e),{data:v,loading:_,error:T}=Xwe(o),{data:w,loading:S,error:R}=Ywe(n),{data:B,loading:I,error:D}=Kwe(u),L=()=>{i(z=>z),s(z=>z),l(z=>z),c(z=>z)},O=async(z,$)=>{m(!0);try{let Q;$?Q=await cj(z,z==="mainnet"?e:n):Q=await cj(z,void 0,z==="mainnet"?o:u),p(Q)}catch(Q){console.error("Erreur lors du test direct:",Q),p({error:String(Q)})}finally{m(!1)}},U=()=>Bt.jsxs("div",{style:{marginBottom:"20px",padding:"15px",border:"1px solid #6a6a9a",borderRadius:"5px",backgroundColor:"#1a1a2e"},children:[Bt.jsx("h3",{children:"Test Direct des API GraphQL"}),Bt.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"10px"},children:[Bt.jsxs("button",{onClick:()=>O("mainnet",!0),style:{padding:"8px 15px",backgroundColor:"#FFD32A",color:"#000",border:"none",borderRadius:"4px",cursor:"pointer"},disabled:f,children:["Tester Mainnet (ID: ",e,")"]}),Bt.jsxs("button",{onClick:()=>O("mainnet",!1),style:{padding:"8px 15px",backgroundColor:"#FFD32A",color:"#000",border:"none",borderRadius:"4px",cursor:"pointer"},disabled:f,children:["Tester Mainnet (Label: ",o,")"]})]}),Bt.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"10px"},children:[Bt.jsxs("button",{onClick:()=>O("testnet",!0),style:{padding:"8px 15px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer"},disabled:f,children:["Tester Testnet (ID: ",n,")"]}),Bt.jsxs("button",{onClick:()=>O("testnet",!1),style:{padding:"8px 15px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer"},disabled:f,children:["Tester Testnet (Label: ",u,")"]})]}),f&&Bt.jsx("p",{children:"Test en cours..."}),h&&Bt.jsxs("div",{children:[Bt.jsx("h4",{children:"Résultats du test direct:"}),Bt.jsx("pre",{style:{backgroundColor:"#0a0a15",padding:"10px",borderRadius:"4px",overflow:"auto",maxHeight:"200px",fontSize:"12px"},children:JSON.stringify(h,null,2)})]}),Bt.jsx("p",{style:{marginTop:"10px",fontSize:"0.8em",color:"#aaa"},children:"Ces boutons testent directement les API GraphQL sans passer par les hooks. Les résultats complets de la requête apparaîtront ici et dans la console du navigateur."})]}),Z=()=>Bt.jsxs("div",{style:{flex:"1 1 400px",border:"1px solid #FFD32A",padding:"15px",borderRadius:"5px",backgroundColor:"#151525"},children:[Bt.jsx("h2",{style:{color:"#FFD32A"},children:"Mainnet"}),Bt.jsxs("div",{style:{marginBottom:"15px"},children:[Bt.jsx("label",{style:{marginRight:"10px"},children:"ID à rechercher:"}),Bt.jsx("input",{type:"number",value:e,onChange:z=>i(Number(z.target.value)),style:{padding:"5px 10px",backgroundColor:"#1e1e30",border:"1px solid #333",color:"#fff",borderRadius:"4px"}})]}),Bt.jsxs("div",{style:{marginBottom:"15px"},children:[Bt.jsx("label",{style:{marginRight:"10px"},children:"Label à rechercher:"}),Bt.jsx("input",{type:"text",value:o,onChange:z=>l(z.target.value),style:{padding:"5px 10px",backgroundColor:"#1e1e30",border:"1px solid #333",color:"#fff",borderRadius:"4px"}})]}),y?Bt.jsx("p",{children:"Chargement des données mainnet par ID..."}):x?Bt.jsxs("p",{children:["Erreur mainnet (ID): ",x]}):Bt.jsxs(Bt.Fragment,{children:[Bt.jsxs("h3",{children:["Atome par ID (",e,")"]}),g&&g.atom?Bt.jsxs("div",{children:[Bt.jsxs("pre",{children:["id : ",JSON.stringify(g.atom.id,null,2)]}),Bt.jsxs("pre",{children:["label :"," ",JSON.stringify(g.atom.label,null,2)]}),Bt.jsxs("pre",{children:["creator :"," ",JSON.stringify(g.atom.creator,null,2)]})]}):Bt.jsx("p",{children:"Aucun atome trouvé avec cet ID sur mainnet"})]}),_?Bt.jsx("p",{children:"Chargement des données mainnet par label..."}):T?Bt.jsxs("p",{children:["Erreur mainnet (Label): ",T]}):Bt.jsxs(Bt.Fragment,{children:[Bt.jsxs("h3",{children:["Atome par Label (",o,")"]}),v?Bt.jsxs("div",{children:[Bt.jsxs("pre",{children:["id : ",JSON.stringify(v.id,null,2)]}),Bt.jsxs("pre",{children:["label : ",JSON.stringify(v.label,null,2)]}),Bt.jsxs("pre",{children:["creator :"," ",JSON.stringify(v.creator,null,2)]})]}):Bt.jsx("p",{children:"Aucun atome trouvé avec ce label sur mainnet"})]})]}),G=()=>Bt.jsxs("div",{style:{flex:"1 1 400px",border:"1px solid #4CAF50",padding:"15px",borderRadius:"5px",backgroundColor:"#151525"},children:[Bt.jsx("h2",{style:{color:"#4CAF50"},children:"Testnet"}),Bt.jsxs("div",{style:{marginBottom:"15px"},children:[Bt.jsx("label",{style:{marginRight:"10px"},children:"ID à rechercher:"}),Bt.jsx("input",{type:"number",value:n,onChange:z=>s(Number(z.target.value)),style:{padding:"5px 10px",backgroundColor:"#1e1e30",border:"1px solid #333",color:"#fff",borderRadius:"4px"}})]}),Bt.jsxs("div",{style:{marginBottom:"15px"},children:[Bt.jsx("label",{style:{marginRight:"10px"},children:"Label à rechercher:"}),Bt.jsx("input",{type:"text",value:u,onChange:z=>c(z.target.value),style:{padding:"5px 10px",backgroundColor:"#1e1e30",border:"1px solid #333",color:"#fff",borderRadius:"4px"}})]}),S?Bt.jsx("p",{children:"Chargement des données testnet par ID..."}):R?Bt.jsxs("div",{children:[Bt.jsxs("p",{children:["Erreur testnet (ID): ",R]}),Bt.jsx("p",{style:{fontSize:"0.8em",color:"#aaa"},children:"Note: L'API du testnet pourrait avoir un schéma différent ou nécessiter une authentification."})]}):Bt.jsxs(Bt.Fragment,{children:[Bt.jsxs("h3",{children:["Atome par ID (",n,")"]}),w&&w.atom?Bt.jsxs("div",{children:[Bt.jsxs("div",{style:{backgroundColor:"#202035",padding:"10px",borderRadius:"4px",marginBottom:"10px"},children:[Bt.jsx("p",{style:{fontSize:"0.8em",color:"#4CAF50",margin:"0 0 5px 0"},children:"Réseau: testnet"}),Bt.jsxs("pre",{children:["id : ",JSON.stringify(w.atom.id,null,2)]}),Bt.jsxs("pre",{children:["label :"," ",JSON.stringify(w.atom.label,null,2)]}),Bt.jsxs("pre",{children:["type :"," ",JSON.stringify(w.atom.type,null,2)]}),Bt.jsxs("pre",{children:["data :"," ",JSON.stringify(w.atom.data,null,2)]}),Bt.jsxs("pre",{children:["emoji :"," ",JSON.stringify(w.atom.emoji,null,2)]}),Bt.jsxs("pre",{children:["image :"," ",JSON.stringify(w.atom.image,null,2)]}),Bt.jsxs("pre",{children:["creator :"," ",JSON.stringify(w.atom.creator,null,2)]})]}),Bt.jsx("button",{onClick:()=>{},style:{padding:"4px 10px",backgroundColor:"#202035",color:"#aaa",border:"1px solid #444",borderRadius:"4px",cursor:"pointer",fontSize:"0.8em"},children:"Log complet dans la console"})]}):Bt.jsx("p",{children:"Aucun atome trouvé avec cet ID sur testnet"})]}),I?Bt.jsx("p",{children:"Chargement des données testnet par label..."}):D?Bt.jsxs("div",{children:[Bt.jsxs("p",{children:["Erreur testnet (Label): ",D]}),Bt.jsx("p",{style:{fontSize:"0.8em",color:"#aaa"},children:"Note: L'API du testnet pourrait avoir un schéma différent ou nécessiter une authentification."})]}):Bt.jsxs(Bt.Fragment,{children:[Bt.jsxs("h3",{children:["Atome par Label (",u,")"]}),B?Bt.jsxs("div",{children:[Bt.jsxs("pre",{children:["id : ",JSON.stringify(B.id,null,2)]}),Bt.jsxs("pre",{children:["label : ",JSON.stringify(B.label,null,2)]}),Bt.jsxs("pre",{children:["creator :"," ",JSON.stringify(B.creator,null,2)]})]}):Bt.jsx("p",{children:"Aucun atome trouvé avec ce label sur testnet"})]})]});return Bt.jsxs("div",{style:{margin:"20px 0",padding:"15px",border:"1px solid #333",borderRadius:"5px",backgroundColor:"#101020"},children:[Bt.jsx("h2",{children:"Player Map Data"}),Bt.jsxs("div",{style:{marginBottom:"10px"},children:[Bt.jsxs("h3",{children:["Wallet Address: ",r||"Non connecté"]}),Bt.jsx("button",{onClick:L,style:{padding:"8px 15px",backgroundColor:"#2e2e40",color:"#fff",border:"1px solid #333",borderRadius:"4px",cursor:"pointer",marginTop:"10px"},children:"Rafraîchir les données"})]}),U(),Bt.jsxs("div",{style:{display:"flex",gap:"20px",flexWrap:"wrap"},children:[Z(),G()]})]})},Zwe={init:r=>{if(!r.apiUrl)throw new Error("L'URL de l'API est obligatoire pour initialiser Player-map");return TQ(r),!0},get:lx},$we={setAuthToken:AD,getAuthToken:g2,isAuthenticated:ax,clearAuthToken:SQ,initialize:r=>r?(AD(r),!0):!1};da.GraphComponent=Jwe,da.PlayerMapConfig=Zwe,da.PlayerMapGraph=FEe,da.PlayerMapHome=xD,da.RegistrationForm=vD,da.auth=$we,da.default=xD,Object.defineProperties(da,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
